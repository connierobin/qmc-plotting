--------------------------------------------------------------------------
WARNING: No preset parameters were found for the device that Open MPI
detected:

  Local host:            n0257.savio3
  Device name:           mlx5_0
  Device vendor ID:      0x02c9
  Device vendor part ID: 4123

Default device parameters will be used, which may result in lower
performance.  You can edit any of the files specified by the
btl_openib_device_param_files MCA parameter to set values for your
device.

NOTE: You can turn off this warning by setting the MCA parameter
      btl_openib_warn_no_device_params_found to 0.
--------------------------------------------------------------------------
Rank =    0  Free Memory = 89972 MB
Rank =    1  Free Memory = 89970 MB
Rank =    2  Free Memory = 89970 MB
Rank =    3  Free Memory = 89969 MB
Rank =    4  Free Memory = 89969 MB
Rank =    5  Free Memory = 89969 MB
Rank =    6  Free Memory = 89969 MB
Rank =    7  Free Memory = 89969 MB
Rank =    8  Free Memory = 89969 MB
Rank =    9  Free Memory = 89969 MB
Rank =   10  Free Memory = 89969 MB
Rank =   11  Free Memory = 89969 MB
Rank =   12  Free Memory = 89969 MB
Rank =   13  Free Memory = 89969 MB
Rank =   14  Free Memory = 89969 MB
Rank =   15  Free Memory = 89969 MB
Rank =   16  Free Memory = 89969 MB
Rank =   17  Free Memory = 89969 MB
Rank =   18  Free Memory = 89969 MB
Rank =   19  Free Memory = 89969 MB
Rank =   20  Free Memory = 89969 MB
Rank =   21  Free Memory = 89969 MB
Rank =   22  Free Memory = 89969 MB
Rank =   23  Free Memory = 89969 MB
Rank =   24  Free Memory = 89969 MB
Rank =   25  Free Memory = 89969 MB
Rank =   26  Free Memory = 89969 MB
Rank =   27  Free Memory = 89969 MB
Rank =   28  Free Memory = 89969 MB
Rank =   29  Free Memory = 89969 MB
Rank =   30  Free Memory = 89969 MB
Rank =   31  Free Memory = 89969 MB
Rank =   32  Free Memory = 89969 MB
Rank =   33  Free Memory = 89969 MB
Rank =   34  Free Memory = 89969 MB
Rank =   35  Free Memory = 89969 MB
Rank =   36  Free Memory = 89969 MB
Rank =   37  Free Memory = 89969 MB
Rank =   38  Free Memory = 89969 MB
Rank =   39  Free Memory = 89968 MB
Rank =   40  Free Memory = 84677 MB
Rank =   41  Free Memory = 84677 MB
Rank =   42  Free Memory = 84677 MB
Rank =   43  Free Memory = 84677 MB
Rank =   44  Free Memory = 84677 MB
Rank =   45  Free Memory = 84677 MB
Rank =   46  Free Memory = 84677 MB
Rank =   47  Free Memory = 84677 MB
Rank =   48  Free Memory = 84677 MB
Rank =   49  Free Memory = 84677 MB
Rank =   50  Free Memory = 84677 MB
Rank =   51  Free Memory = 84677 MB
Rank =   52  Free Memory = 84677 MB
Rank =   53  Free Memory = 84677 MB
Rank =   54  Free Memory = 84677 MB
Rank =   55  Free Memory = 84677 MB
Rank =   56  Free Memory = 84677 MB
Rank =   57  Free Memory = 84677 MB
Rank =   58  Free Memory = 84676 MB
Rank =   59  Free Memory = 84676 MB
Rank =   60  Free Memory = 84676 MB
Rank =   61  Free Memory = 84676 MB
Rank =   62  Free Memory = 84676 MB
Rank =   63  Free Memory = 84676 MB
Rank =   64  Free Memory = 84676 MB
Rank =   65  Free Memory = 84675 MB
Rank =   66  Free Memory = 84675 MB
Rank =   67  Free Memory = 84675 MB
Rank =   68  Free Memory = 84675 MB
Rank =   69  Free Memory = 84675 MB
Rank =   70  Free Memory = 84675 MB
Rank =   71  Free Memory = 84675 MB
Rank =   72  Free Memory = 84675 MB
Rank =   73  Free Memory = 84675 MB
Rank =   74  Free Memory = 84675 MB
Rank =   75  Free Memory = 84675 MB
Rank =   76  Free Memory = 84675 MB
Rank =   77  Free Memory = 84675 MB
Rank =   78  Free Memory = 84675 MB
Rank =   79  Free Memory = 84675 MB
Rank =   80  Free Memory = 89735 MB
Rank =   81  Free Memory = 89735 MB
Rank =   82  Free Memory = 89735 MB
Rank =   83  Free Memory = 89735 MB
Rank =   84  Free Memory = 89735 MB
Rank =   85  Free Memory = 89735 MB
Rank =   86  Free Memory = 89735 MB
Rank =   87  Free Memory = 89735 MB
Rank =   88  Free Memory = 89735 MB
Rank =   89  Free Memory = 89735 MB
Rank =   90  Free Memory = 89735 MB
Rank =   91  Free Memory = 89735 MB
Rank =   92  Free Memory = 89735 MB
Rank =   93  Free Memory = 89735 MB
Rank =   94  Free Memory = 89735 MB
Rank =   95  Free Memory = 89735 MB
Rank =   96  Free Memory = 89735 MB
Rank =   97  Free Memory = 89735 MB
Rank =   98  Free Memory = 89735 MB
Rank =   99  Free Memory = 89735 MB
Rank =  100  Free Memory = 89735 MB
Rank =  101  Free Memory = 89735 MB
Rank =  102  Free Memory = 89735 MB
Rank =  103  Free Memory = 89735 MB
Rank =  104  Free Memory = 89735 MB
Rank =  105  Free Memory = 89735 MB
Rank =  106  Free Memory = 89735 MB
Rank =  107  Free Memory = 89735 MB
Rank =  108  Free Memory = 89735 MB
Rank =  109  Free Memory = 89735 MB
Rank =  110  Free Memory = 89735 MB
Rank =  111  Free Memory = 89735 MB
Rank =  112  Free Memory = 89735 MB
Rank =  113  Free Memory = 89735 MB
Rank =  114  Free Memory = 89735 MB
Rank =  115  Free Memory = 89735 MB
Rank =  116  Free Memory = 89735 MB
Rank =  117  Free Memory = 89735 MB
Rank =  118  Free Memory = 89735 MB
Rank =  119  Free Memory = 89735 MB
  Input file(s): opt_h2o_1b1_lmtt_run001c.xml 
Rank =  120  Free Memory = 84594 MB
Rank =  121  Free Memory = 84594 MB
Rank =  127  Free Memory = 84594 MB
Rank =  122  Free Memory = 84594 MB
Rank =  123  Free Memory = 84594 MB
Rank =  124  Free Memory = 84594 MB
Rank =  125  Free Memory = 84594 MB
Rank =  126  Free Memory = 84594 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 40
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmtt_run001c.xml

  Project = H2O
  date    = 2023-03-02 18:08:51 PST
  host    = n0256.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 691

  Range of prime numbers to use as seeds over processors and threads = 5209-6311


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.939727e-01    1         1 OFF
     uu_1                 1.268714e-01    1         1 OFF
     uu_2                 2.511361e-02    1         1 OFF
     uu_3                -3.765314e-02    1         1 OFF
     uu_4                -8.377567e-02    1         1 OFF
     uu_5                -1.194542e-01    1         1 OFF
     uu_6                -1.477551e-01    1         1 OFF
     uu_7                -1.625913e-01    1         1 OFF
     uu_8                -1.558903e-01    1         1 OFF
     uu_9                -1.294336e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.514442e-01    1         1 OFF
     ud_1                 1.875180e-01    1         1 OFF
     ud_2                 7.110476e-02    1         1 OFF
     ud_3                 1.963062e-03    1         1 OFF
     ud_4                -5.677585e-02    1         1 OFF
     ud_5                -1.002695e-01    1         1 OFF
     ud_6                -1.294631e-01    1         1 OFF
     ud_7                -1.471627e-01    1         1 OFF
     ud_8                -1.500961e-01    1         1 OFF
     ud_9                -1.420891e-01    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.028053e-01    1         1 OFF
     eO_1                -3.863429e-01    1         1 OFF
     eO_2                 2.622157e-02    1         1 OFF
     eO_3                 3.416126e-01    1         1 OFF
     eO_4                 5.667955e-01    1         1 OFF
     eO_5                 5.257711e-01    1         1 OFF
     eO_6                 2.818478e-01    1         1 OFF
     eO_7                -6.463996e-02    1         1 OFF
     eO_8                -3.275256e-01    1         1 OFF
     eO_9                -2.231919e-01    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.869674e-01    1         1 OFF
     eH1_1                -1.872401e-01    1         1 OFF
     eH1_2                -1.411186e-01    1         1 OFF
     eH1_3                -8.601401e-02    1         1 OFF
     eH1_4                -3.553048e-02    1         1 OFF
     eH1_5                 3.933155e-03    1         1 OFF
     eH1_6                 7.335098e-02    1         1 OFF
     eH1_7                 1.570701e-01    1         1 OFF
     eH1_8                 2.273965e-01    1         1 OFF
     eH1_9                 2.092299e-01    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.851993e-01    1         1 OFF
     eH2_1                -1.854240e-01    1         1 OFF
     eH2_2                -1.390374e-01    1         1 OFF
     eH2_3                -8.396609e-02    1         1 OFF
     eH2_4                -3.377951e-02    1         1 OFF
     eH2_5                 5.156767e-03    1         1 OFF
     eH2_6                 7.402433e-02    1         1 OFF
     eH2_7                 1.557694e-01    1         1 OFF
     eH2_8                 2.244667e-01    1         1 OFF
     eH2_9                 2.357714e-01    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.930414e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.7843e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 74
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
[n0256.savio3:246029] 127 more processes have sent help message help-mpi-btl-openib.txt / no device params found
[n0256.savio3:246029] Set MCA parameter "orte_base_help_aggregate" to 0 to see all help / error messages
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9702
    reference variance = 0.23154
====================================================
  Execution time = 1.5162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3487e-01
  Total weights = 1.951980302e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323569171934
                                         uncertainty =       0.002468538980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323569171934
                                         uncertainty =       0.002468538980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402177118
  error estimate for blocks of size 2^( 2) =       0.000414931437
  error estimate for blocks of size 2^( 3) =       0.000428261522
  error estimate for blocks of size 2^( 4) =       0.000440404130
  error estimate for blocks of size 2^( 5) =       0.000451139495
  error estimate for blocks of size 2^( 6) =       0.000459310379
  error estimate for blocks of size 2^( 7) =       0.000463910819

      target function =                  N/A
              le_mean =     -16.906130105086
             les_mean =     286.152107729369
             stat err =       0.000453691206
             autocorr =       1.272582676645
              std dev =       0.568764334468
             le_variance =       0.323492868162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690613010509e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906130105091       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906271340175       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906274965026       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906274535833       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274637174       residual = 7.29e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.531077e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906130105091       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906185793503       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906186291765       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906186320386       residual = 1.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 6.120523e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906130105091       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906146374750       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906146492523       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906146519804       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 4.0000e+00 is 1.800244e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133312 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7996e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001 7.004223e-01                 3 1 ON  0
ci_0002 7.003843e-01                 3 1 ON  1
ci_0003 -2.993834e-02                3 1 ON  2
ci_0004 -3.001642e-02                3 1 ON  3
ci_0005 -3.356263e-02                3 1 ON  4
ci_0006 -3.399988e-02                3 1 ON  5
ci_0007 -2.262003e-02                3 1 ON  6
ci_0008 -2.260046e-02                3 1 ON  7
ci_0009 -1.952541e-02                3 1 ON  8
ci_0010 -1.969478e-02                3 1 ON  9
ci_0011 -1.457737e-02                3 1 ON  10
ci_0012 -1.475572e-02                3 1 ON  11
ci_0013 1.510576e-02                 3 1 ON  12
ci_0014 1.581990e-02                 3 1 ON  13
ci_0015 1.517844e-02                 3 1 ON  14
ci_0016 1.514698e-02                 3 1 ON  15
ci_0017 1.378175e-02                 3 1 ON  16
ci_0018 1.340341e-02                 3 1 ON  17
ci_0019 1.183523e-02                 3 1 ON  18
ci_0020 1.145168e-02                 3 1 ON  19
ci_0021 6.443385e-03                 3 1 ON  20
ci_0022 7.671240e-03                 3 1 ON  21
ci_0023 -1.151007e-02                3 1 ON  22
ci_0024 -1.172178e-02                3 1 ON  23
ci_0025 -1.137780e-02                3 1 ON  24
ci_0026 -1.181524e-02                3 1 ON  25
ci_0027 -1.124836e-02                3 1 ON  26
ci_0028 -1.141444e-02                3 1 ON  27
ci_0029 -1.036826e-02                3 1 ON  28
ci_0030 -1.063247e-02                3 1 ON  29
ci_0031 1.855234e-02                 3 1 ON  30
ci_0032 1.915262e-02                 3 1 ON  31
ci_0033 1.105151e-02                 3 1 ON  32
ci_0034 1.080242e-02                 3 1 ON  33
ci_0035 6.943410e-03                 3 1 ON  34
ci_0036 7.112444e-03                 3 1 ON  35
ci_0037 -1.121566e-02                3 1 ON  36
ci_0038 -1.112255e-02                3 1 ON  37
ci_0039 -3.459022e-03                3 1 ON  38
ci_0040 -3.593568e-03                3 1 ON  39
ci_0041 8.515160e-03                 3 1 ON  40
ci_0042 8.159774e-03                 3 1 ON  41
ci_0043 -1.445251e-02                3 1 ON  42
ci_0044 -1.398915e-02                3 1 ON  43
ci_0045 8.177327e-03                 3 1 ON  44
ci_0046 8.558579e-03                 3 1 ON  45
ci_0047 -2.784543e-03                3 1 ON  46
ci_0048 -3.083196e-03                3 1 ON  47
ci_0049 -6.508272e-03                3 1 ON  48
ci_0050 -6.366953e-03                3 1 ON  49
ci_0051 -4.382856e-03                3 1 ON  50
ci_0052 -4.471792e-03                3 1 ON  51
ci_0053 -5.920411e-03                3 1 ON  52
ci_0054 -5.921226e-03                3 1 ON  53
ci_0055 6.833474e-03                 3 1 ON  54
ci_0056 7.199642e-03                 3 1 ON  55
ci_0057 5.129432e-03                 3 1 ON  56
ci_0058 5.086026e-03                 3 1 ON  57
ci_0059 -5.866260e-03                3 1 ON  58
ci_0060 -5.370139e-03                3 1 ON  59
ci_0061 -3.874436e-03                3 1 ON  60
ci_0062 -3.623787e-03                3 1 ON  61
ci_0063 -8.971979e-03                3 1 ON  62
ci_0064 -8.806627e-03                3 1 ON  63
ci_0065 -6.449508e-03                3 1 ON  64
ci_0066 -6.639707e-03                3 1 ON  65
ci_0067 -5.913079e-03                3 1 ON  66
ci_0068 -6.077260e-03                3 1 ON  67
ci_0069 5.491302e-03                 3 1 ON  68
ci_0070 5.415198e-03                 3 1 ON  69
ci_0071 4.143201e-03                 3 1 ON  70
ci_0072 4.181018e-03                 3 1 ON  71
ci_0073 5.160447e-03                 3 1 ON  72
ci_0074 4.989111e-03                 3 1 ON  73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.211784
====================================================
  Execution time = 1.4552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2951e-01
  Total weights = 1.9518e+06
  Execution time = 1.9174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319347506287
                                         uncertainty =       0.002158167680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319347506287
                                         uncertainty =       0.002158167680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399662796
  error estimate for blocks of size 2^( 2) =       0.000412664633
  error estimate for blocks of size 2^( 3) =       0.000425871301
  error estimate for blocks of size 2^( 4) =       0.000438159153
  error estimate for blocks of size 2^( 5) =       0.000448586123
  error estimate for blocks of size 2^( 6) =       0.000457090758
  error estimate for blocks of size 2^( 7) =       0.000460945510

      target function =                  N/A
              le_mean =     -16.906326161192
             les_mean =     286.154529360562
             stat err =       0.000451195386
             autocorr =       1.274505915507
              std dev =       0.565208546059
             le_variance =       0.319460700539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317751920394
                                         uncertainty =       0.002115083371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317751920394
                                         uncertainty =       0.002115083371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398663266
  error estimate for blocks of size 2^( 2) =       0.000411736875
  error estimate for blocks of size 2^( 3) =       0.000425016678
  error estimate for blocks of size 2^( 4) =       0.000437389645
  error estimate for blocks of size 2^( 5) =       0.000447905416
  error estimate for blocks of size 2^( 6) =       0.000456399707
  error estimate for blocks of size 2^( 7) =       0.000460270689

      target function =                  N/A
              le_mean =     -16.906363357592
             les_mean =     286.154835104162
             stat err =       0.000450491364
             autocorr =       1.276910618360
              std dev =       0.563794998107
             le_variance =       0.317864799891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317978064783
                                         uncertainty =       0.002128587367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317978064783
                                         uncertainty =       0.002128587367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398805042
  error estimate for blocks of size 2^( 2) =       0.000411862489
  error estimate for blocks of size 2^( 3) =       0.000425127435
  error estimate for blocks of size 2^( 4) =       0.000437483625
  error estimate for blocks of size 2^( 5) =       0.000447977907
  error estimate for blocks of size 2^( 6) =       0.000456476688
  error estimate for blocks of size 2^( 7) =       0.000460341897

      target function =                  N/A
              le_mean =     -16.906343088927
             les_mean =     286.153535247485
             stat err =       0.000450570029
             autocorr =       1.276448568592
              std dev =       0.563995498686
             le_variance =       0.318090922538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319107182536
                                         uncertainty =       0.002153662758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319107182536
                                         uncertainty =       0.002153662758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399512390
  error estimate for blocks of size 2^( 2) =       0.000412521133
  error estimate for blocks of size 2^( 3) =       0.000425735299
  error estimate for blocks of size 2^( 4) =       0.000438033020
  error estimate for blocks of size 2^( 5) =       0.000448470328
  error estimate for blocks of size 2^( 6) =       0.000456975391
  error estimate for blocks of size 2^( 7) =       0.000460831293

      target function =                  N/A
              le_mean =     -16.906322480283
             les_mean =     286.154431162864
             stat err =       0.000451077508
             autocorr =       1.274799370788
              std dev =       0.564995839662
             le_variance =       0.319220298835


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906326161192        initial
     2.5000e-01     2.5000e+00             1.5311e-03       -16.906363357592  <--
     1.0000e+00     1.0000e+01             6.1205e-04       -16.906343088927
     4.0000e+00     4.0000e+01             1.8002e-04       -16.906322480283

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.4193e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_0001                 7.003941e-01 3 1  ON 0
ci_0002                 7.007014e-01 3 1  ON 1
ci_0003                -2.922688e-02 3 1  ON 2
ci_0004                -2.909037e-02 3 1  ON 3
ci_0005                -3.380532e-02 3 1  ON 4
ci_0006                -3.411073e-02 3 1  ON 5
ci_0007                -2.258935e-02 3 1  ON 6
ci_0008                -2.237353e-02 3 1  ON 7
ci_0009                -1.899962e-02 3 1  ON 8
ci_0010                -1.908578e-02 3 1  ON 9
ci_0011                -1.391016e-02 3 1  ON 10
ci_0012                -1.406013e-02 3 1  ON 11
ci_0013                 1.430421e-02 3 1  ON 12
ci_0014                 1.512064e-02 3 1  ON 13
ci_0015                 1.485235e-02 3 1  ON 14
ci_0016                 1.448427e-02 3 1  ON 15
ci_0017                 1.286273e-02 3 1  ON 16
ci_0018                 1.271442e-02 3 1  ON 17
ci_0019                 1.176620e-02 3 1  ON 18
ci_0020                 1.148651e-02 3 1  ON 19
ci_0021                 5.581694e-03 3 1  ON 20
ci_0022                 7.083590e-03 3 1  ON 21
ci_0023                -1.133792e-02 3 1  ON 22
ci_0024                -1.166459e-02 3 1  ON 23
ci_0025                -1.137454e-02 3 1  ON 24
ci_0026                -1.148716e-02 3 1  ON 25
ci_0027                -1.145835e-02 3 1  ON 26
ci_0028                -1.144693e-02 3 1  ON 27
ci_0029                -1.013540e-02 3 1  ON 28
ci_0030                -1.016592e-02 3 1  ON 29
ci_0031                 1.905345e-02 3 1  ON 30
ci_0032                 1.942589e-02 3 1  ON 31
ci_0033                 1.079339e-02 3 1  ON 32
ci_0034                 1.111889e-02 3 1  ON 33
ci_0035                 7.147781e-03 3 1  ON 34
ci_0036                 7.201329e-03 3 1  ON 35
ci_0037                -1.065711e-02 3 1  ON 36
ci_0038                -1.109618e-02 3 1  ON 37
ci_0039                -3.172756e-03 3 1  ON 38
ci_0040                -3.020656e-03 3 1  ON 39
ci_0041                 8.027339e-03 3 1  ON 40
ci_0042                 8.052358e-03 3 1  ON 41
ci_0043                -1.494950e-02 3 1  ON 42
ci_0044                -1.423558e-02 3 1  ON 43
ci_0045                 7.746685e-03 3 1  ON 44
ci_0046                 8.227245e-03 3 1  ON 45
ci_0047                -2.312354e-03 3 1  ON 46
ci_0048                -2.582693e-03 3 1  ON 47
ci_0049                -6.306607e-03 3 1  ON 48
ci_0050                -6.089874e-03 3 1  ON 49
ci_0051                -4.136586e-03 3 1  ON 50
ci_0052                -4.280425e-03 3 1  ON 51
ci_0053                -5.350493e-03 3 1  ON 52
ci_0054                -5.784202e-03 3 1  ON 53
ci_0055                 6.609032e-03 3 1  ON 54
ci_0056                 7.142542e-03 3 1  ON 55
ci_0057                 5.032378e-03 3 1  ON 56
ci_0058                 4.826760e-03 3 1  ON 57
ci_0059                -5.527317e-03 3 1  ON 58
ci_0060                -5.129424e-03 3 1  ON 59
ci_0061                -3.992799e-03 3 1  ON 60
ci_0062                -3.797436e-03 3 1  ON 61
ci_0063                -8.639492e-03 3 1  ON 62
ci_0064                -8.820659e-03 3 1  ON 63
ci_0065                -6.461873e-03 3 1  ON 64
ci_0066                -6.394864e-03 3 1  ON 65
ci_0067                -5.859496e-03 3 1  ON 66
ci_0068                -5.938292e-03 3 1  ON 67
ci_0069                 5.218174e-03 3 1  ON 68
ci_0070                 5.105491e-03 3 1  ON 69
ci_0071                 3.256735e-03 3 1  ON 70
ci_0072                 3.578101e-03 3 1  ON 71
ci_0073                 5.071818e-03 3 1  ON 72
ci_0074                 4.841372e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8413
    reference variance = 0.255413
====================================================
  Execution time = 1.4550e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5211e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3083e-01
  Total weights = 1.951501287e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318243982413
                                         uncertainty =       0.002218519102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318243982413
                                         uncertainty =       0.002218519102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398998150
  error estimate for blocks of size 2^( 2) =       0.000412177874
  error estimate for blocks of size 2^( 3) =       0.000425734381
  error estimate for blocks of size 2^( 4) =       0.000438349473
  error estimate for blocks of size 2^( 5) =       0.000448836861
  error estimate for blocks of size 2^( 6) =       0.000458897579
  error estimate for blocks of size 2^( 7) =       0.000466042565

      target function =                  N/A
              le_mean =     -16.905416981032
             les_mean =     286.123955495814
             stat err =       0.000453031619
             autocorr =       1.289185064662
              std dev =       0.564268595043
             le_variance =       0.318399047352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690541698103e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905416981008       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905487421899       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905488213713       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905491425586       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905492457965       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905492481495       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905492197202       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-02 is 2.772155e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905416981008       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905458365480       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905457477823       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905458026091       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905458102064       residual = 6.33e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e-01 is 1.223404e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905416981008       residual = 2.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905432597834       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905432190208       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905432278218       residual = 3.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+00 is 3.765926e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7195e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.008619e-01 3 1  ON 0
ci_0002                 7.004825e-01 3 1  ON 1
ci_0003                -2.882480e-02 3 1  ON 2
ci_0004                -2.847837e-02 3 1  ON 3
ci_0005                -3.407888e-02 3 1  ON 4
ci_0006                -3.405418e-02 3 1  ON 5
ci_0007                -2.258004e-02 3 1  ON 6
ci_0008                -2.262967e-02 3 1  ON 7
ci_0009                -1.857747e-02 3 1  ON 8
ci_0010                -1.869605e-02 3 1  ON 9
ci_0011                -1.323386e-02 3 1  ON 10
ci_0012                -1.389269e-02 3 1  ON 11
ci_0013                 1.394326e-02 3 1  ON 12
ci_0014                 1.439789e-02 3 1  ON 13
ci_0015                 1.417959e-02 3 1  ON 14
ci_0016                 1.356827e-02 3 1  ON 15
ci_0017                 1.220227e-02 3 1  ON 16
ci_0018                 1.233361e-02 3 1  ON 17
ci_0019                 1.147110e-02 3 1  ON 18
ci_0020                 1.155278e-02 3 1  ON 19
ci_0021                 4.385750e-03 3 1  ON 20
ci_0022                 5.860185e-03 3 1  ON 21
ci_0023                -1.118191e-02 3 1  ON 22
ci_0024                -1.097458e-02 3 1  ON 23
ci_0025                -1.067131e-02 3 1  ON 24
ci_0026                -1.122253e-02 3 1  ON 25
ci_0027                -1.108566e-02 3 1  ON 26
ci_0028                -1.134315e-02 3 1  ON 27
ci_0029                -1.001987e-02 3 1  ON 28
ci_0030                -1.022761e-02 3 1  ON 29
ci_0031                 1.961423e-02 3 1  ON 30
ci_0032                 1.966455e-02 3 1  ON 31
ci_0033                 1.077885e-02 3 1  ON 32
ci_0034                 1.098520e-02 3 1  ON 33
ci_0035                 7.097440e-03 3 1  ON 34
ci_0036                 7.065806e-03 3 1  ON 35
ci_0037                -1.008213e-02 3 1  ON 36
ci_0038                -1.055800e-02 3 1  ON 37
ci_0039                -2.896954e-03 3 1  ON 38
ci_0040                -2.890536e-03 3 1  ON 39
ci_0041                 7.984753e-03 3 1  ON 40
ci_0042                 7.497294e-03 3 1  ON 41
ci_0043                -1.528741e-02 3 1  ON 42
ci_0044                -1.447982e-02 3 1  ON 43
ci_0045                 7.553974e-03 3 1  ON 44
ci_0046                 7.747666e-03 3 1  ON 45
ci_0047                -2.273640e-03 3 1  ON 46
ci_0048                -2.368349e-03 3 1  ON 47
ci_0049                -5.832571e-03 3 1  ON 48
ci_0050                -5.848202e-03 3 1  ON 49
ci_0051                -3.881438e-03 3 1  ON 50
ci_0052                -4.023035e-03 3 1  ON 51
ci_0053                -5.350619e-03 3 1  ON 52
ci_0054                -5.738063e-03 3 1  ON 53
ci_0055                 6.676300e-03 3 1  ON 54
ci_0056                 6.912445e-03 3 1  ON 55
ci_0057                 4.775351e-03 3 1  ON 56
ci_0058                 4.342301e-03 3 1  ON 57
ci_0059                -4.987303e-03 3 1  ON 58
ci_0060                -4.956477e-03 3 1  ON 59
ci_0061                -4.536267e-03 3 1  ON 60
ci_0062                -4.268871e-03 3 1  ON 61
ci_0063                -8.693176e-03 3 1  ON 62
ci_0064                -8.556654e-03 3 1  ON 63
ci_0065                -6.365557e-03 3 1  ON 64
ci_0066                -5.865221e-03 3 1  ON 65
ci_0067                -5.589830e-03 3 1  ON 66
ci_0068                -5.734127e-03 3 1  ON 67
ci_0069                 4.673696e-03 3 1  ON 68
ci_0070                 5.169973e-03 3 1  ON 69
ci_0071                 2.896225e-03 3 1  ON 70
ci_0072                 2.787238e-03 3 1  ON 71
ci_0073                 4.788217e-03 3 1  ON 72
ci_0074                 4.623187e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9651
    reference variance = 0.394598
====================================================
  Execution time = 1.4574e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5122e-01
  Total weights = 1.9517e+06
  Execution time = 1.9106e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.106125
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337170213752
                                         uncertainty =       0.009603452293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337170213752
                                         uncertainty =       0.009603452293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410571452
  error estimate for blocks of size 2^( 2) =       0.000423606430
  error estimate for blocks of size 2^( 3) =       0.000436856021
  error estimate for blocks of size 2^( 4) =       0.000449043070
  error estimate for blocks of size 2^( 5) =       0.000459100267
  error estimate for blocks of size 2^( 6) =       0.000469584332
  error estimate for blocks of size 2^( 7) =       0.000475200791

      target function =                  N/A
              le_mean =     -16.905367436262
             les_mean =     287.510815990623
             stat err =       0.000463232115
             autocorr =       1.272974848471
              std dev =       0.580635716255
             le_variance =       0.337137834991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334257243597
                                         uncertainty =       0.011180364215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334257243597
                                         uncertainty =       0.011180364215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408794872
  error estimate for blocks of size 2^( 2) =       0.000421896182
  error estimate for blocks of size 2^( 3) =       0.000435330032
  error estimate for blocks of size 2^( 4) =       0.000447704480
  error estimate for blocks of size 2^( 5) =       0.000457829685
  error estimate for blocks of size 2^( 6) =       0.000468394876
  error estimate for blocks of size 2^( 7) =       0.000474068687

      target function =                  N/A
              le_mean =     -16.905303473192
             les_mean =     286.163102833263
             stat err =       0.000461999432
             autocorr =       1.277238508561
              std dev =       0.578123252860
             le_variance =       0.334226495498

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.109629
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867166447
                                         uncertainty =       0.011167766340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867166447
                                         uncertainty =       0.011167766340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408556426
  error estimate for blocks of size 2^( 2) =       0.000421692690
  error estimate for blocks of size 2^( 3) =       0.000435151516
  error estimate for blocks of size 2^( 4) =       0.000447551323
  error estimate for blocks of size 2^( 5) =       0.000457689441
  error estimate for blocks of size 2^( 6) =       0.000468268539
  error estimate for blocks of size 2^( 7) =       0.000473941892

      target function =                  N/A
              le_mean =     -16.905323905540
             les_mean =     286.154449739102
             stat err =       0.000461862798
             autocorr =       1.277973575114
              std dev =       0.577786038600
             le_variance =       0.333836706401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333543795982
                                         uncertainty =       0.009729274207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333543795982
                                         uncertainty =       0.009729274207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408359606
  error estimate for blocks of size 2^( 2) =       0.000421463741
  error estimate for blocks of size 2^( 3) =       0.000434811706
  error estimate for blocks of size 2^( 4) =       0.000447135689
  error estimate for blocks of size 2^( 5) =       0.000457207349
  error estimate for blocks of size 2^( 6) =       0.000467770741
  error estimate for blocks of size 2^( 7) =       0.000473456405

      target function =                  N/A
              le_mean =     -16.905291452732
             les_mean =     286.168411265924
             stat err =       0.000461392546
             autocorr =       1.276602224191
              std dev =       0.577507692632
             le_variance =       0.333515135049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905367436262        initial  <--
     6.2500e-02     6.2500e-01             2.7722e-03       -16.905303473192
     2.5000e-01     2.5000e+00             1.2234e-03       -16.905323905540
     1.0000e+00     1.0000e+01             3.7659e-04       -16.905291452732

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1896
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_0001                 7.003941e-01 3 1  ON 0
ci_0002                 7.007014e-01 3 1  ON 1
ci_0003                -2.922688e-02 3 1  ON 2
ci_0004                -2.909037e-02 3 1  ON 3
ci_0005                -3.380532e-02 3 1  ON 4
ci_0006                -3.411073e-02 3 1  ON 5
ci_0007                -2.258935e-02 3 1  ON 6
ci_0008                -2.237353e-02 3 1  ON 7
ci_0009                -1.899962e-02 3 1  ON 8
ci_0010                -1.908578e-02 3 1  ON 9
ci_0011                -1.391016e-02 3 1  ON 10
ci_0012                -1.406013e-02 3 1  ON 11
ci_0013                 1.430421e-02 3 1  ON 12
ci_0014                 1.512064e-02 3 1  ON 13
ci_0015                 1.485235e-02 3 1  ON 14
ci_0016                 1.448427e-02 3 1  ON 15
ci_0017                 1.286273e-02 3 1  ON 16
ci_0018                 1.271442e-02 3 1  ON 17
ci_0019                 1.176620e-02 3 1  ON 18
ci_0020                 1.148651e-02 3 1  ON 19
ci_0021                 5.581694e-03 3 1  ON 20
ci_0022                 7.083590e-03 3 1  ON 21
ci_0023                -1.133792e-02 3 1  ON 22
ci_0024                -1.166459e-02 3 1  ON 23
ci_0025                -1.137454e-02 3 1  ON 24
ci_0026                -1.148716e-02 3 1  ON 25
ci_0027                -1.145835e-02 3 1  ON 26
ci_0028                -1.144693e-02 3 1  ON 27
ci_0029                -1.013540e-02 3 1  ON 28
ci_0030                -1.016592e-02 3 1  ON 29
ci_0031                 1.905345e-02 3 1  ON 30
ci_0032                 1.942589e-02 3 1  ON 31
ci_0033                 1.079339e-02 3 1  ON 32
ci_0034                 1.111889e-02 3 1  ON 33
ci_0035                 7.147781e-03 3 1  ON 34
ci_0036                 7.201329e-03 3 1  ON 35
ci_0037                -1.065711e-02 3 1  ON 36
ci_0038                -1.109618e-02 3 1  ON 37
ci_0039                -3.172756e-03 3 1  ON 38
ci_0040                -3.020656e-03 3 1  ON 39
ci_0041                 8.027339e-03 3 1  ON 40
ci_0042                 8.052358e-03 3 1  ON 41
ci_0043                -1.494950e-02 3 1  ON 42
ci_0044                -1.423558e-02 3 1  ON 43
ci_0045                 7.746685e-03 3 1  ON 44
ci_0046                 8.227245e-03 3 1  ON 45
ci_0047                -2.312354e-03 3 1  ON 46
ci_0048                -2.582693e-03 3 1  ON 47
ci_0049                -6.306607e-03 3 1  ON 48
ci_0050                -6.089874e-03 3 1  ON 49
ci_0051                -4.136586e-03 3 1  ON 50
ci_0052                -4.280425e-03 3 1  ON 51
ci_0053                -5.350493e-03 3 1  ON 52
ci_0054                -5.784202e-03 3 1  ON 53
ci_0055                 6.609032e-03 3 1  ON 54
ci_0056                 7.142542e-03 3 1  ON 55
ci_0057                 5.032378e-03 3 1  ON 56
ci_0058                 4.826760e-03 3 1  ON 57
ci_0059                -5.527317e-03 3 1  ON 58
ci_0060                -5.129424e-03 3 1  ON 59
ci_0061                -3.992799e-03 3 1  ON 60
ci_0062                -3.797436e-03 3 1  ON 61
ci_0063                -8.639492e-03 3 1  ON 62
ci_0064                -8.820659e-03 3 1  ON 63
ci_0065                -6.461873e-03 3 1  ON 64
ci_0066                -6.394864e-03 3 1  ON 65
ci_0067                -5.859496e-03 3 1  ON 66
ci_0068                -5.938292e-03 3 1  ON 67
ci_0069                 5.218174e-03 3 1  ON 68
ci_0070                 5.105491e-03 3 1  ON 69
ci_0071                 3.256735e-03 3 1  ON 70
ci_0072                 3.578101e-03 3 1  ON 71
ci_0073                 5.071818e-03 3 1  ON 72
ci_0074                 4.841372e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1391e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.304641
====================================================
  Execution time = 1.4538e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3373e-01
  Total weights = 1.951541924e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696641875
                                         uncertainty =       0.002261985442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320696641875
                                         uncertainty =       0.002261985442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400453577
  error estimate for blocks of size 2^( 2) =       0.000412977864
  error estimate for blocks of size 2^( 3) =       0.000425775269
  error estimate for blocks of size 2^( 4) =       0.000437372780
  error estimate for blocks of size 2^( 5) =       0.000446997127
  error estimate for blocks of size 2^( 6) =       0.000454645947
  error estimate for blocks of size 2^( 7) =       0.000458397431

      target function =                  N/A
              le_mean =     -16.906480247903
             les_mean =     286.162800975565
             stat err =       0.000449353321
             autocorr =       1.259132859843
              std dev =       0.566326879431
             le_variance =       0.320726134366


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648024790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480247905       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906508322940       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906508074069       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906508202927       residual = 8.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 6.548335e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480247905       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906489001536       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906489087227       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906489117061       residual = 4.67e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 2.085893e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480247905       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906482580449       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906482621271       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906482628550       residual = 7.08e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.0000e+01 is 5.598544e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7153e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.004005e-01 3 1  ON 0
ci_0002                 7.007353e-01 3 1  ON 1
ci_0003                -2.917687e-02 3 1  ON 2
ci_0004                -2.894454e-02 3 1  ON 3
ci_0005                -3.385805e-02 3 1  ON 4
ci_0006                -3.411499e-02 3 1  ON 5
ci_0007                -2.265213e-02 3 1  ON 6
ci_0008                -2.234982e-02 3 1  ON 7
ci_0009                -1.879103e-02 3 1  ON 8
ci_0010                -1.908378e-02 3 1  ON 9
ci_0011                -1.383941e-02 3 1  ON 10
ci_0012                -1.396861e-02 3 1  ON 11
ci_0013                 1.423385e-02 3 1  ON 12
ci_0014                 1.496831e-02 3 1  ON 13
ci_0015                 1.476631e-02 3 1  ON 14
ci_0016                 1.447634e-02 3 1  ON 15
ci_0017                 1.274234e-02 3 1  ON 16
ci_0018                 1.269681e-02 3 1  ON 17
ci_0019                 1.174271e-02 3 1  ON 18
ci_0020                 1.145910e-02 3 1  ON 19
ci_0021                 5.470452e-03 3 1  ON 20
ci_0022                 6.955262e-03 3 1  ON 21
ci_0023                -1.139379e-02 3 1  ON 22
ci_0024                -1.168096e-02 3 1  ON 23
ci_0025                -1.130431e-02 3 1  ON 24
ci_0026                -1.142096e-02 3 1  ON 25
ci_0027                -1.138621e-02 3 1  ON 26
ci_0028                -1.133659e-02 3 1  ON 27
ci_0029                -1.011234e-02 3 1  ON 28
ci_0030                -1.011276e-02 3 1  ON 29
ci_0031                 1.902594e-02 3 1  ON 30
ci_0032                 1.943053e-02 3 1  ON 31
ci_0033                 1.083426e-02 3 1  ON 32
ci_0034                 1.105463e-02 3 1  ON 33
ci_0035                 7.104795e-03 3 1  ON 34
ci_0036                 7.231852e-03 3 1  ON 35
ci_0037                -1.053937e-02 3 1  ON 36
ci_0038                -1.112160e-02 3 1  ON 37
ci_0039                -3.102185e-03 3 1  ON 38
ci_0040                -2.963005e-03 3 1  ON 39
ci_0041                 7.910272e-03 3 1  ON 40
ci_0042                 8.040488e-03 3 1  ON 41
ci_0043                -1.499004e-02 3 1  ON 42
ci_0044                -1.435369e-02 3 1  ON 43
ci_0045                 7.732206e-03 3 1  ON 44
ci_0046                 8.185195e-03 3 1  ON 45
ci_0047                -2.317921e-03 3 1  ON 46
ci_0048                -2.564529e-03 3 1  ON 47
ci_0049                -6.170213e-03 3 1  ON 48
ci_0050                -6.106105e-03 3 1  ON 49
ci_0051                -4.032646e-03 3 1  ON 50
ci_0052                -4.172910e-03 3 1  ON 51
ci_0053                -5.330499e-03 3 1  ON 52
ci_0054                -5.687056e-03 3 1  ON 53
ci_0055                 6.613938e-03 3 1  ON 54
ci_0056                 7.129456e-03 3 1  ON 55
ci_0057                 5.009011e-03 3 1  ON 56
ci_0058                 4.851098e-03 3 1  ON 57
ci_0059                -5.428374e-03 3 1  ON 58
ci_0060                -5.144158e-03 3 1  ON 59
ci_0061                -3.896909e-03 3 1  ON 60
ci_0062                -3.723911e-03 3 1  ON 61
ci_0063                -8.701607e-03 3 1  ON 62
ci_0064                -8.895108e-03 3 1  ON 63
ci_0065                -6.434772e-03 3 1  ON 64
ci_0066                -6.380961e-03 3 1  ON 65
ci_0067                -5.842633e-03 3 1  ON 66
ci_0068                -5.787874e-03 3 1  ON 67
ci_0069                 5.220382e-03 3 1  ON 68
ci_0070                 5.021529e-03 3 1  ON 69
ci_0071                 3.181207e-03 3 1  ON 70
ci_0072                 3.414395e-03 3 1  ON 71
ci_0073                 4.996001e-03 3 1  ON 72
ci_0074                 4.783242e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9027
    reference variance = 0.273664
====================================================
  Execution time = 1.4740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3542e-01
  Total weights = 1.9521e+06
  Execution time = 1.9057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322043431987
                                         uncertainty =       0.002268681695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322043431987
                                         uncertainty =       0.002268681695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401339191
  error estimate for blocks of size 2^( 2) =       0.000414213460
  error estimate for blocks of size 2^( 3) =       0.000427260817
  error estimate for blocks of size 2^( 4) =       0.000439779078
  error estimate for blocks of size 2^( 5) =       0.000450566976
  error estimate for blocks of size 2^( 6) =       0.000457738243
  error estimate for blocks of size 2^( 7) =       0.000461523537

      target function =                  N/A
              le_mean =     -16.905822078878
             les_mean =     286.142635959974
             stat err =       0.000452401958
             autocorr =       1.270649616379
              std dev =       0.567579327656
             le_variance =       0.322146293183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321414869927
                                         uncertainty =       0.002251870959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321414869927
                                         uncertainty =       0.002251870959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400949703
  error estimate for blocks of size 2^( 2) =       0.000413846214
  error estimate for blocks of size 2^( 3) =       0.000426928239
  error estimate for blocks of size 2^( 4) =       0.000439456625
  error estimate for blocks of size 2^( 5) =       0.000450237991
  error estimate for blocks of size 2^( 6) =       0.000457418934
  error estimate for blocks of size 2^( 7) =       0.000461212533

      target function =                  N/A
              le_mean =     -16.905835987817
             les_mean =     286.143101611119
             stat err =       0.000452081521
             autocorr =       1.271316602017
              std dev =       0.567028507495
             le_variance =       0.321521328312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321621167685
                                         uncertainty =       0.002257208455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321621167685
                                         uncertainty =       0.002257208455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401077540
  error estimate for blocks of size 2^( 2) =       0.000413966691
  error estimate for blocks of size 2^( 3) =       0.000427036991
  error estimate for blocks of size 2^( 4) =       0.000439560827
  error estimate for blocks of size 2^( 5) =       0.000450343583
  error estimate for blocks of size 2^( 6) =       0.000457524185
  error estimate for blocks of size 2^( 7) =       0.000461312768

      target function =                  N/A
              le_mean =     -16.905827502127
             les_mean =     286.159068704483
             stat err =       0.000452185341
             autocorr =       1.271089914199
              std dev =       0.567209296459
             le_variance =       0.321726385990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321982813156
                                         uncertainty =       0.002267080299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321982813156
                                         uncertainty =       0.002267080299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401301629
  error estimate for blocks of size 2^( 2) =       0.000414177763
  error estimate for blocks of size 2^( 3) =       0.000427228111
  error estimate for blocks of size 2^( 4) =       0.000439747353
  error estimate for blocks of size 2^( 5) =       0.000450534673
  error estimate for blocks of size 2^( 6) =       0.000457706913
  error estimate for blocks of size 2^( 7) =       0.000461493187

      target function =                  N/A
              le_mean =     -16.905822530014
             les_mean =     286.142470871078
             stat err =       0.000452370532
             autocorr =       1.270710933605
              std dev =       0.567526206614
             le_variance =       0.322085995194


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905822078878        initial
     6.2500e-01     6.2500e+00             6.5483e-04       -16.905835987817  <--
     2.5000e+00     2.5000e+01             2.0859e-04       -16.905827502127
     1.0000e+01     1.0000e+02             5.5985e-05       -16.905822530014

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.4355e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_0001                 7.003991e-01 3 1  ON 0
ci_0002                 7.008230e-01 3 1  ON 1
ci_0003                -2.906583e-02 3 1  ON 2
ci_0004                -2.861003e-02 3 1  ON 3
ci_0005                -3.398521e-02 3 1  ON 4
ci_0006                -3.411765e-02 3 1  ON 5
ci_0007                -2.281365e-02 3 1  ON 6
ci_0008                -2.228839e-02 3 1  ON 7
ci_0009                -1.834479e-02 3 1  ON 8
ci_0010                -1.908502e-02 3 1  ON 9
ci_0011                -1.368228e-02 3 1  ON 10
ci_0012                -1.376641e-02 3 1  ON 11
ci_0013                 1.408115e-02 3 1  ON 12
ci_0014                 1.463361e-02 3 1  ON 13
ci_0015                 1.457837e-02 3 1  ON 14
ci_0016                 1.446393e-02 3 1  ON 15
ci_0017                 1.248456e-02 3 1  ON 16
ci_0018                 1.266024e-02 3 1  ON 17
ci_0019                 1.169668e-02 3 1  ON 18
ci_0020                 1.140458e-02 3 1  ON 19
ci_0021                 5.175215e-03 3 1  ON 20
ci_0022                 6.612908e-03 3 1  ON 21
ci_0023                -1.152439e-02 3 1  ON 22
ci_0024                -1.172636e-02 3 1  ON 23
ci_0025                -1.115060e-02 3 1  ON 24
ci_0026                -1.127880e-02 3 1  ON 25
ci_0027                -1.123197e-02 3 1  ON 26
ci_0028                -1.110058e-02 3 1  ON 27
ci_0029                -1.007576e-02 3 1  ON 28
ci_0030                -1.000536e-02 3 1  ON 29
ci_0031                 1.895574e-02 3 1  ON 30
ci_0032                 1.944616e-02 3 1  ON 31
ci_0033                 1.094206e-02 3 1  ON 32
ci_0034                 1.089143e-02 3 1  ON 33
ci_0035                 7.010728e-03 3 1  ON 34
ci_0036                 7.305308e-03 3 1  ON 35
ci_0037                -1.025787e-02 3 1  ON 36
ci_0038                -1.117866e-02 3 1  ON 37
ci_0039                -2.969825e-03 3 1  ON 38
ci_0040                -2.855588e-03 3 1  ON 39
ci_0041                 7.646024e-03 3 1  ON 40
ci_0042                 8.014260e-03 3 1  ON 41
ci_0043                -1.509379e-02 3 1  ON 42
ci_0044                -1.465691e-02 3 1  ON 43
ci_0045                 7.696238e-03 3 1  ON 44
ci_0046                 8.082458e-03 3 1  ON 45
ci_0047                -2.330829e-03 3 1  ON 46
ci_0048                -2.530499e-03 3 1  ON 47
ci_0049                -5.865839e-03 3 1  ON 48
ci_0050                -6.140873e-03 3 1  ON 49
ci_0051                -3.826707e-03 3 1  ON 50
ci_0052                -3.962259e-03 3 1  ON 51
ci_0053                -5.287570e-03 3 1  ON 52
ci_0054                -5.488370e-03 3 1  ON 53
ci_0055                 6.622597e-03 3 1  ON 54
ci_0056                 7.100993e-03 3 1  ON 55
ci_0057                 4.956722e-03 3 1  ON 56
ci_0058                 4.908989e-03 3 1  ON 57
ci_0059                -5.227396e-03 3 1  ON 58
ci_0060                -5.173343e-03 3 1  ON 59
ci_0061                -3.678333e-03 3 1  ON 60
ci_0062                -3.557866e-03 3 1  ON 61
ci_0063                -8.827163e-03 3 1  ON 62
ci_0064                -9.045212e-03 3 1  ON 63
ci_0065                -6.376194e-03 3 1  ON 64
ci_0066                -6.350919e-03 3 1  ON 65
ci_0067                -5.807249e-03 3 1  ON 66
ci_0068                -5.489353e-03 3 1  ON 67
ci_0069                 5.224342e-03 3 1  ON 68
ci_0070                 4.858065e-03 3 1  ON 69
ci_0071                 3.014097e-03 3 1  ON 70
ci_0072                 3.038282e-03 3 1  ON 71
ci_0073                 4.849770e-03 3 1  ON 72
ci_0074                 4.669204e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1515e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9752
    reference variance = 0.569939
====================================================
  Execution time = 1.4681e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3756e-01
  Total weights = 1.951801062e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323118121923
                                         uncertainty =       0.002302075000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323118121923
                                         uncertainty =       0.002302075000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401975274
  error estimate for blocks of size 2^( 2) =       0.000414569314
  error estimate for blocks of size 2^( 3) =       0.000427602937
  error estimate for blocks of size 2^( 4) =       0.000440454907
  error estimate for blocks of size 2^( 5) =       0.000451466320
  error estimate for blocks of size 2^( 6) =       0.000458216303
  error estimate for blocks of size 2^( 7) =       0.000464815138

      target function =                  N/A
              le_mean =     -16.905993720851
             les_mean =     286.150187147550
             stat err =       0.000453738167
             autocorr =       1.274124728057
              std dev =       0.568478884143
             le_variance =       0.323168241716


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599372085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993720859       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023888330       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906028589149       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906027407489       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906027556349       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906027533088       residual = 7.52e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 1.736737e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993720859       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906007009992       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906007143511       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006968516       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 6.110017e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905993720859       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905997825029       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905997627395       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905997609366       residual = 5.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.5000e+00 is 1.703744e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7309e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.006862e-01 3 1  ON 0
ci_0002                 7.006210e-01 3 1  ON 1
ci_0003                -2.880287e-02 3 1  ON 2
ci_0004                -2.854115e-02 3 1  ON 3
ci_0005                -3.389700e-02 3 1  ON 4
ci_0006                -3.435755e-02 3 1  ON 5
ci_0007                -2.260766e-02 3 1  ON 6
ci_0008                -2.203378e-02 3 1  ON 7
ci_0009                -1.816219e-02 3 1  ON 8
ci_0010                -1.871347e-02 3 1  ON 9
ci_0011                -1.314748e-02 3 1  ON 10
ci_0012                -1.370474e-02 3 1  ON 11
ci_0013                 1.414303e-02 3 1  ON 12
ci_0014                 1.466270e-02 3 1  ON 13
ci_0015                 1.431750e-02 3 1  ON 14
ci_0016                 1.431928e-02 3 1  ON 15
ci_0017                 1.246748e-02 3 1  ON 16
ci_0018                 1.226419e-02 3 1  ON 17
ci_0019                 1.166175e-02 3 1  ON 18
ci_0020                 1.130164e-02 3 1  ON 19
ci_0021                 4.846636e-03 3 1  ON 20
ci_0022                 6.001907e-03 3 1  ON 21
ci_0023                -1.151963e-02 3 1  ON 22
ci_0024                -1.182159e-02 3 1  ON 23
ci_0025                -1.095216e-02 3 1  ON 24
ci_0026                -1.094090e-02 3 1  ON 25
ci_0027                -1.120577e-02 3 1  ON 26
ci_0028                -1.112168e-02 3 1  ON 27
ci_0029                -1.020244e-02 3 1  ON 28
ci_0030                -1.037197e-02 3 1  ON 29
ci_0031                 1.912473e-02 3 1  ON 30
ci_0032                 1.961980e-02 3 1  ON 31
ci_0033                 1.096436e-02 3 1  ON 32
ci_0034                 1.081916e-02 3 1  ON 33
ci_0035                 6.895325e-03 3 1  ON 34
ci_0036                 7.178646e-03 3 1  ON 35
ci_0037                -1.040873e-02 3 1  ON 36
ci_0038                -1.115789e-02 3 1  ON 37
ci_0039                -2.897187e-03 3 1  ON 38
ci_0040                -2.732854e-03 3 1  ON 39
ci_0041                 7.868944e-03 3 1  ON 40
ci_0042                 8.018316e-03 3 1  ON 41
ci_0043                -1.505761e-02 3 1  ON 42
ci_0044                -1.496232e-02 3 1  ON 43
ci_0045                 7.635585e-03 3 1  ON 44
ci_0046                 8.163895e-03 3 1  ON 45
ci_0047                -2.294772e-03 3 1  ON 46
ci_0048                -2.354668e-03 3 1  ON 47
ci_0049                -5.704426e-03 3 1  ON 48
ci_0050                -5.702960e-03 3 1  ON 49
ci_0051                -3.920351e-03 3 1  ON 50
ci_0052                -3.784344e-03 3 1  ON 51
ci_0053                -4.838787e-03 3 1  ON 52
ci_0054                -5.221473e-03 3 1  ON 53
ci_0055                 6.433751e-03 3 1  ON 54
ci_0056                 7.242298e-03 3 1  ON 55
ci_0057                 4.742718e-03 3 1  ON 56
ci_0058                 4.835940e-03 3 1  ON 57
ci_0059                -5.107404e-03 3 1  ON 58
ci_0060                -5.238554e-03 3 1  ON 59
ci_0061                -3.657050e-03 3 1  ON 60
ci_0062                -3.184709e-03 3 1  ON 61
ci_0063                -9.054650e-03 3 1  ON 62
ci_0064                -8.869246e-03 3 1  ON 63
ci_0065                -6.054191e-03 3 1  ON 64
ci_0066                -6.298016e-03 3 1  ON 65
ci_0067                -5.570162e-03 3 1  ON 66
ci_0068                -5.343990e-03 3 1  ON 67
ci_0069                 4.954634e-03 3 1  ON 68
ci_0070                 4.986205e-03 3 1  ON 69
ci_0071                 2.857801e-03 3 1  ON 70
ci_0072                 2.770575e-03 3 1  ON 71
ci_0073                 4.560282e-03 3 1  ON 72
ci_0074                 4.577135e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9094
    reference variance = 0.290881
====================================================
  Execution time = 1.4425e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3465e-01
  Total weights = 1.9519e+06
  Execution time = 1.9235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321079984693
                                         uncertainty =       0.002278040142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321079984693
                                         uncertainty =       0.002278040142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700310
  error estimate for blocks of size 2^( 2) =       0.000413630523
  error estimate for blocks of size 2^( 3) =       0.000426666305
  error estimate for blocks of size 2^( 4) =       0.000438868966
  error estimate for blocks of size 2^( 5) =       0.000449756665
  error estimate for blocks of size 2^( 6) =       0.000458076159
  error estimate for blocks of size 2^( 7) =       0.000461105409

      target function =                  N/A
              le_mean =     -16.906765356615
             les_mean =     286.174678721577
             stat err =       0.000451951800
             autocorr =       1.272169221432
              std dev =       0.566675812224
             le_variance =       0.321121476160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125997726
                                         uncertainty =       0.002249424623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320125997726
                                         uncertainty =       0.002249424623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400104718
  error estimate for blocks of size 2^( 2) =       0.000413066635
  error estimate for blocks of size 2^( 3) =       0.000426150366
  error estimate for blocks of size 2^( 4) =       0.000438398773
  error estimate for blocks of size 2^( 5) =       0.000449315807
  error estimate for blocks of size 2^( 6) =       0.000457687716
  error estimate for blocks of size 2^( 7) =       0.000460699345

      target function =                  N/A
              le_mean =     -16.906773809457
             les_mean =     286.207327191690
             stat err =       0.000451525410
             autocorr =       1.273553069035
              std dev =       0.565833518340
             le_variance =       0.320167570477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320069135420
                                         uncertainty =       0.002228754531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320069135420
                                         uncertainty =       0.002228754531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400069229
  error estimate for blocks of size 2^( 2) =       0.000413033444
  error estimate for blocks of size 2^( 3) =       0.000426108050
  error estimate for blocks of size 2^( 4) =       0.000438348233
  error estimate for blocks of size 2^( 5) =       0.000449268599
  error estimate for blocks of size 2^( 6) =       0.000457626281
  error estimate for blocks of size 2^( 7) =       0.000460654000

      target function =                  N/A
              le_mean =     -16.906762321068
             les_mean =     286.172827148780
             stat err =       0.000451474278
             autocorr =       1.273490546382
              std dev =       0.565783330031
             le_variance =       0.320110776541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320887310721
                                         uncertainty =       0.002267795823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320887310721
                                         uncertainty =       0.002267795823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400580101
  error estimate for blocks of size 2^( 2) =       0.000413515573
  error estimate for blocks of size 2^( 3) =       0.000426557120
  error estimate for blocks of size 2^( 4) =       0.000438765751
  error estimate for blocks of size 2^( 5) =       0.000449658565
  error estimate for blocks of size 2^( 6) =       0.000457984996
  error estimate for blocks of size 2^( 7) =       0.000461018359

      target function =                  N/A
              le_mean =     -16.906760875829
             les_mean =     286.174152094725
             stat err =       0.000451856918
             autocorr =       1.272398439085
              std dev =       0.566505811843
             le_variance =       0.320928834852


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906765356615        initial
     1.5625e-01     1.5625e+00             1.7367e-03       -16.906773809457  <--
     6.2500e-01     6.2500e+00             6.1100e-04       -16.906762321068
     2.5000e+00     2.5000e+01             1.7037e-04       -16.906760875829

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.4085e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_0001                 7.014407e-01 3 1  ON 0
ci_0002                 6.999778e-01 3 1  ON 1
ci_0003                -2.844633e-02 3 1  ON 2
ci_0004                -2.841502e-02 3 1  ON 3
ci_0005                -3.374966e-02 3 1  ON 4
ci_0006                -3.469727e-02 3 1  ON 5
ci_0007                -2.221423e-02 3 1  ON 6
ci_0008                -2.155112e-02 3 1  ON 7
ci_0009                -1.795292e-02 3 1  ON 8
ci_0010                -1.826630e-02 3 1  ON 9
ci_0011                -1.246472e-02 3 1  ON 10
ci_0012                -1.359564e-02 3 1  ON 11
ci_0013                 1.423935e-02 3 1  ON 12
ci_0014                 1.468178e-02 3 1  ON 13
ci_0015                 1.399703e-02 3 1  ON 14
ci_0016                 1.412899e-02 3 1  ON 15
ci_0017                 1.246171e-02 3 1  ON 16
ci_0018                 1.178906e-02 3 1  ON 17
ci_0019                 1.167907e-02 3 1  ON 18
ci_0020                 1.118451e-02 3 1  ON 19
ci_0021                 4.196801e-03 3 1  ON 20
ci_0022                 4.876171e-03 3 1  ON 21
ci_0023                -1.154600e-02 3 1  ON 22
ci_0024                -1.194179e-02 3 1  ON 23
ci_0025                -1.071404e-02 3 1  ON 24
ci_0026                -1.051999e-02 3 1  ON 25
ci_0027                -1.121605e-02 3 1  ON 26
ci_0028                -1.116440e-02 3 1  ON 27
ci_0029                -1.041843e-02 3 1  ON 28
ci_0030                -1.086994e-02 3 1  ON 29
ci_0031                 1.938422e-02 3 1  ON 30
ci_0032                 1.988255e-02 3 1  ON 31
ci_0033                 1.100581e-02 3 1  ON 32
ci_0034                 1.069797e-02 3 1  ON 33
ci_0035                 6.745154e-03 3 1  ON 34
ci_0036                 7.010064e-03 3 1  ON 35
ci_0037                -1.063251e-02 3 1  ON 36
ci_0038                -1.113607e-02 3 1  ON 37
ci_0039                -2.837107e-03 3 1  ON 38
ci_0040                -2.625778e-03 3 1  ON 39
ci_0041                 8.138072e-03 3 1  ON 40
ci_0042                 7.993216e-03 3 1  ON 41
ci_0043                -1.498785e-02 3 1  ON 42
ci_0044                -1.548496e-02 3 1  ON 43
ci_0045                 7.548327e-03 3 1  ON 44
ci_0046                 8.282086e-03 3 1  ON 45
ci_0047                -2.257615e-03 3 1  ON 46
ci_0048                -2.198866e-03 3 1  ON 47
ci_0049                -5.506494e-03 3 1  ON 48
ci_0050                -5.168398e-03 3 1  ON 49
ci_0051                -4.007495e-03 3 1  ON 50
ci_0052                -3.605700e-03 3 1  ON 51
ci_0053                -4.381780e-03 3 1  ON 52
ci_0054                -4.932876e-03 3 1  ON 53
ci_0055                 6.157793e-03 3 1  ON 54
ci_0056                 7.459858e-03 3 1  ON 55
ci_0057                 4.456710e-03 3 1  ON 56
ci_0058                 4.747422e-03 3 1  ON 57
ci_0059                -4.988385e-03 3 1  ON 58
ci_0060                -5.284990e-03 3 1  ON 59
ci_0061                -3.635936e-03 3 1  ON 60
ci_0062                -2.693691e-03 3 1  ON 61
ci_0063                -9.290114e-03 3 1  ON 62
ci_0064                -8.666280e-03 3 1  ON 63
ci_0065                -5.668755e-03 3 1  ON 64
ci_0066                -6.219536e-03 3 1  ON 65
ci_0067                -5.347728e-03 3 1  ON 66
ci_0068                -5.190373e-03 3 1  ON 67
ci_0069                 4.700690e-03 3 1  ON 68
ci_0070                 5.100764e-03 3 1  ON 69
ci_0071                 2.615617e-03 3 1  ON 70
ci_0072                 2.430820e-03 3 1  ON 71
ci_0073                 4.286653e-03 3 1  ON 72
ci_0074                 4.483886e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1401e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9493
    reference variance = 0.277176
====================================================
  Execution time = 1.4851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3568e-01
  Total weights = 1.951661235e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322935806795
                                         uncertainty =       0.002436173639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322935806795
                                         uncertainty =       0.002436173639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401855213
  error estimate for blocks of size 2^( 2) =       0.000414959139
  error estimate for blocks of size 2^( 3) =       0.000428609055
  error estimate for blocks of size 2^( 4) =       0.000439963357
  error estimate for blocks of size 2^( 5) =       0.000449956838
  error estimate for blocks of size 2^( 6) =       0.000458637795
  error estimate for blocks of size 2^( 7) =       0.000461491546

      target function =                  N/A
              le_mean =     -16.905841784416
             les_mean =     286.143170776197
             stat err =       0.000452512384
             autocorr =       1.268007214384
              std dev =       0.568309092837
             le_variance =       0.322975225001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584178442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905841784433       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905869570186       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905876651573       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905877851408       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905878238754       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905878151433       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905878414642       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-02 is 2.041704e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905841784433       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905860896471       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905863649241       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905863744739       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905863805418       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 1.241033e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905841784433       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905850283726       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905850744878       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905850732214       residual = 3.83e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 5.341539e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140236 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7467e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.012043e-01 3 1  ON 0
ci_0002                 7.003288e-01 3 1  ON 1
ci_0003                -2.845661e-02 3 1  ON 2
ci_0004                -2.763811e-02 3 1  ON 3
ci_0005                -3.349752e-02 3 1  ON 4
ci_0006                -3.494658e-02 3 1  ON 5
ci_0007                -2.138608e-02 3 1  ON 6
ci_0008                -2.157167e-02 3 1  ON 7
ci_0009                -1.788749e-02 3 1  ON 8
ci_0010                -1.792282e-02 3 1  ON 9
ci_0011                -1.262808e-02 3 1  ON 10
ci_0012                -1.357411e-02 3 1  ON 11
ci_0013                 1.369491e-02 3 1  ON 12
ci_0014                 1.428765e-02 3 1  ON 13
ci_0015                 1.415501e-02 3 1  ON 14
ci_0016                 1.403726e-02 3 1  ON 15
ci_0017                 1.230523e-02 3 1  ON 16
ci_0018                 1.185014e-02 3 1  ON 17
ci_0019                 1.214166e-02 3 1  ON 18
ci_0020                 1.157888e-02 3 1  ON 19
ci_0021                 3.161192e-03 3 1  ON 20
ci_0022                 4.820456e-03 3 1  ON 21
ci_0023                -1.129886e-02 3 1  ON 22
ci_0024                -1.119590e-02 3 1  ON 23
ci_0025                -1.122908e-02 3 1  ON 24
ci_0026                -1.051387e-02 3 1  ON 25
ci_0027                -1.178244e-02 3 1  ON 26
ci_0028                -1.086672e-02 3 1  ON 27
ci_0029                -1.046229e-02 3 1  ON 28
ci_0030                -1.062418e-02 3 1  ON 29
ci_0031                 1.954133e-02 3 1  ON 30
ci_0032                 2.009906e-02 3 1  ON 31
ci_0033                 1.072272e-02 3 1  ON 32
ci_0034                 1.068249e-02 3 1  ON 33
ci_0035                 6.931942e-03 3 1  ON 34
ci_0036                 7.186710e-03 3 1  ON 35
ci_0037                -1.050153e-02 3 1  ON 36
ci_0038                -1.057292e-02 3 1  ON 37
ci_0039                -2.798493e-03 3 1  ON 38
ci_0040                -2.852654e-03 3 1  ON 39
ci_0041                 7.517607e-03 3 1  ON 40
ci_0042                 7.593256e-03 3 1  ON 41
ci_0043                -1.453350e-02 3 1  ON 42
ci_0044                -1.607674e-02 3 1  ON 43
ci_0045                 7.445398e-03 3 1  ON 44
ci_0046                 8.024670e-03 3 1  ON 45
ci_0047                -2.242282e-03 3 1  ON 46
ci_0048                -1.940945e-03 3 1  ON 47
ci_0049                -5.745131e-03 3 1  ON 48
ci_0050                -5.817421e-03 3 1  ON 49
ci_0051                -3.595073e-03 3 1  ON 50
ci_0052                -3.610918e-03 3 1  ON 51
ci_0053                -4.596328e-03 3 1  ON 52
ci_0054                -5.109663e-03 3 1  ON 53
ci_0055                 6.843880e-03 3 1  ON 54
ci_0056                 6.885801e-03 3 1  ON 55
ci_0057                 4.368822e-03 3 1  ON 56
ci_0058                 4.845656e-03 3 1  ON 57
ci_0059                -4.910991e-03 3 1  ON 58
ci_0060                -5.061763e-03 3 1  ON 59
ci_0061                -3.548934e-03 3 1  ON 60
ci_0062                -3.934724e-03 3 1  ON 61
ci_0063                -8.946516e-03 3 1  ON 62
ci_0064                -7.913182e-03 3 1  ON 63
ci_0065                -5.776109e-03 3 1  ON 64
ci_0066                -5.567852e-03 3 1  ON 65
ci_0067                -5.675080e-03 3 1  ON 66
ci_0068                -5.140597e-03 3 1  ON 67
ci_0069                 4.428370e-03 3 1  ON 68
ci_0070                 4.497286e-03 3 1  ON 69
ci_0071                 2.253478e-03 3 1  ON 70
ci_0072                 2.118445e-03 3 1  ON 71
ci_0073                 4.555341e-03 3 1  ON 72
ci_0074                 4.442139e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9856
    reference variance = 0.297039
====================================================
  Execution time = 1.4376e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3773e-01
  Total weights = 1.9522e+06
  Execution time = 1.9101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325733502351
                                         uncertainty =       0.002654754800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325733502351
                                         uncertainty =       0.002654754800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403579887
  error estimate for blocks of size 2^( 2) =       0.000416640439
  error estimate for blocks of size 2^( 3) =       0.000430246278
  error estimate for blocks of size 2^( 4) =       0.000443306893
  error estimate for blocks of size 2^( 5) =       0.000455488676
  error estimate for blocks of size 2^( 6) =       0.000463974436
  error estimate for blocks of size 2^( 7) =       0.000469682365

      target function =                  N/A
              le_mean =     -16.906037977614
             les_mean =     286.211782719448
             stat err =       0.000458113093
             autocorr =       1.288505800526
              std dev =       0.570748150211
             le_variance =       0.325753450970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325405570503
                                         uncertainty =       0.002696377732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325405570503
                                         uncertainty =       0.002696377732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403375533
  error estimate for blocks of size 2^( 2) =       0.000416488208
  error estimate for blocks of size 2^( 3) =       0.000430167975
  error estimate for blocks of size 2^( 4) =       0.000443248970
  error estimate for blocks of size 2^( 5) =       0.000455414685
  error estimate for blocks of size 2^( 6) =       0.000463890280
  error estimate for blocks of size 2^( 7) =       0.000469387018

      target function =                  N/A
              le_mean =     -16.906041723727
             les_mean =     286.157433549920
             stat err =       0.000457985238
             autocorr =       1.289091829401
              std dev =       0.570459149529
             le_variance =       0.325423641282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325717082784
                                         uncertainty =       0.002719034824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325717082784
                                         uncertainty =       0.002719034824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403568877
  error estimate for blocks of size 2^( 2) =       0.000416702671
  error estimate for blocks of size 2^( 3) =       0.000430405293
  error estimate for blocks of size 2^( 4) =       0.000443493566
  error estimate for blocks of size 2^( 5) =       0.000455647176
  error estimate for blocks of size 2^( 6) =       0.000464126964
  error estimate for blocks of size 2^( 7) =       0.000469615011

      target function =                  N/A
              le_mean =     -16.906058488363
             les_mean =     286.158938478635
             stat err =       0.000458220679
             autocorr =       1.289181414722
              std dev =       0.570732579906
             le_variance =       0.325735677766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325193201712
                                         uncertainty =       0.002681669368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325193201712
                                         uncertainty =       0.002681669368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403244426
  error estimate for blocks of size 2^( 2) =       0.000416324010
  error estimate for blocks of size 2^( 3) =       0.000429962716
  error estimate for blocks of size 2^( 4) =       0.000443022581
  error estimate for blocks of size 2^( 5) =       0.000455197498
  error estimate for blocks of size 2^( 6) =       0.000463705144
  error estimate for blocks of size 2^( 7) =       0.000469282491

      target function =                  N/A
              le_mean =     -16.906039505643
             les_mean =     286.153481834192
             stat err =       0.000457801928
             autocorr =       1.288897820483
              std dev =       0.570273736349
             le_variance =       0.325212134369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906037977614        initial
     3.9062e-02     3.9062e-01             2.0417e-03       -16.906041723727
     1.5625e-01     1.5625e+00             1.2410e-03       -16.906058488363  <--
     6.2500e-01     6.2500e+00             5.3415e-04       -16.906039505643

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.4160e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_0001                 7.012043e-01 3 1  ON 0
ci_0002                 7.003288e-01 3 1  ON 1
ci_0003                -2.845661e-02 3 1  ON 2
ci_0004                -2.763811e-02 3 1  ON 3
ci_0005                -3.349752e-02 3 1  ON 4
ci_0006                -3.494658e-02 3 1  ON 5
ci_0007                -2.138608e-02 3 1  ON 6
ci_0008                -2.157167e-02 3 1  ON 7
ci_0009                -1.788749e-02 3 1  ON 8
ci_0010                -1.792282e-02 3 1  ON 9
ci_0011                -1.262808e-02 3 1  ON 10
ci_0012                -1.357411e-02 3 1  ON 11
ci_0013                 1.369491e-02 3 1  ON 12
ci_0014                 1.428765e-02 3 1  ON 13
ci_0015                 1.415501e-02 3 1  ON 14
ci_0016                 1.403726e-02 3 1  ON 15
ci_0017                 1.230523e-02 3 1  ON 16
ci_0018                 1.185014e-02 3 1  ON 17
ci_0019                 1.214166e-02 3 1  ON 18
ci_0020                 1.157888e-02 3 1  ON 19
ci_0021                 3.161192e-03 3 1  ON 20
ci_0022                 4.820456e-03 3 1  ON 21
ci_0023                -1.129886e-02 3 1  ON 22
ci_0024                -1.119590e-02 3 1  ON 23
ci_0025                -1.122908e-02 3 1  ON 24
ci_0026                -1.051387e-02 3 1  ON 25
ci_0027                -1.178244e-02 3 1  ON 26
ci_0028                -1.086672e-02 3 1  ON 27
ci_0029                -1.046229e-02 3 1  ON 28
ci_0030                -1.062418e-02 3 1  ON 29
ci_0031                 1.954133e-02 3 1  ON 30
ci_0032                 2.009906e-02 3 1  ON 31
ci_0033                 1.072272e-02 3 1  ON 32
ci_0034                 1.068249e-02 3 1  ON 33
ci_0035                 6.931942e-03 3 1  ON 34
ci_0036                 7.186710e-03 3 1  ON 35
ci_0037                -1.050153e-02 3 1  ON 36
ci_0038                -1.057292e-02 3 1  ON 37
ci_0039                -2.798493e-03 3 1  ON 38
ci_0040                -2.852654e-03 3 1  ON 39
ci_0041                 7.517607e-03 3 1  ON 40
ci_0042                 7.593256e-03 3 1  ON 41
ci_0043                -1.453350e-02 3 1  ON 42
ci_0044                -1.607674e-02 3 1  ON 43
ci_0045                 7.445398e-03 3 1  ON 44
ci_0046                 8.024670e-03 3 1  ON 45
ci_0047                -2.242282e-03 3 1  ON 46
ci_0048                -1.940945e-03 3 1  ON 47
ci_0049                -5.745131e-03 3 1  ON 48
ci_0050                -5.817421e-03 3 1  ON 49
ci_0051                -3.595073e-03 3 1  ON 50
ci_0052                -3.610918e-03 3 1  ON 51
ci_0053                -4.596328e-03 3 1  ON 52
ci_0054                -5.109663e-03 3 1  ON 53
ci_0055                 6.843880e-03 3 1  ON 54
ci_0056                 6.885801e-03 3 1  ON 55
ci_0057                 4.368822e-03 3 1  ON 56
ci_0058                 4.845656e-03 3 1  ON 57
ci_0059                -4.910991e-03 3 1  ON 58
ci_0060                -5.061763e-03 3 1  ON 59
ci_0061                -3.548934e-03 3 1  ON 60
ci_0062                -3.934724e-03 3 1  ON 61
ci_0063                -8.946516e-03 3 1  ON 62
ci_0064                -7.913182e-03 3 1  ON 63
ci_0065                -5.776109e-03 3 1  ON 64
ci_0066                -5.567852e-03 3 1  ON 65
ci_0067                -5.675080e-03 3 1  ON 66
ci_0068                -5.140597e-03 3 1  ON 67
ci_0069                 4.428370e-03 3 1  ON 68
ci_0070                 4.497286e-03 3 1  ON 69
ci_0071                 2.253478e-03 3 1  ON 70
ci_0072                 2.118445e-03 3 1  ON 71
ci_0073                 4.555341e-03 3 1  ON 72
ci_0074                 4.442139e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9362
    reference variance = 0.396793
====================================================
  Execution time = 1.6865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3844e-01
  Total weights = 1.951542114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628749563
                                         uncertainty =       0.002682177950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628749563
                                         uncertainty =       0.002682177950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402262848
  error estimate for blocks of size 2^( 2) =       0.000415242976
  error estimate for blocks of size 2^( 3) =       0.000428399736
  error estimate for blocks of size 2^( 4) =       0.000441096544
  error estimate for blocks of size 2^( 5) =       0.000452962590
  error estimate for blocks of size 2^( 6) =       0.000463056002
  error estimate for blocks of size 2^( 7) =       0.000468085932

      target function =                  N/A
              le_mean =     -16.905285055469
             les_mean =     286.127105675025
             stat err =       0.000456300267
             autocorr =       1.286712732040
              std dev =       0.568885574998
             le_variance =       0.323630797440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528505547e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905285055455       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905271540032       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905285747551       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905288753063       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905288484523       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905288215998       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-02 is 2.801559e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905285055455       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905274182047       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905283597150       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905285038895       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905285101960       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e-01 is 2.262377e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905285055455       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905278953398       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905282890605       residual = 8.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905283312191       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905283354498       residual = 2.26e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e-01 is 1.276078e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.144832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9475e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.012641e-01 3 1  ON 0
ci_0002                 7.003346e-01 3 1  ON 1
ci_0003                -2.819140e-02 3 1  ON 2
ci_0004                -2.786728e-02 3 1  ON 3
ci_0005                -3.437409e-02 3 1  ON 4
ci_0006                -3.490258e-02 3 1  ON 5
ci_0007                -2.169170e-02 3 1  ON 6
ci_0008                -2.161676e-02 3 1  ON 7
ci_0009                -1.814205e-02 3 1  ON 8
ci_0010                -1.781549e-02 3 1  ON 9
ci_0011                -1.288273e-02 3 1  ON 10
ci_0012                -1.311181e-02 3 1  ON 11
ci_0013                 1.355474e-02 3 1  ON 12
ci_0014                 1.397589e-02 3 1  ON 13
ci_0015                 1.405504e-02 3 1  ON 14
ci_0016                 1.304809e-02 3 1  ON 15
ci_0017                 1.201153e-02 3 1  ON 16
ci_0018                 1.168819e-02 3 1  ON 17
ci_0019                 1.163662e-02 3 1  ON 18
ci_0020                 1.084663e-02 3 1  ON 19
ci_0021                 3.404118e-03 3 1  ON 20
ci_0022                 3.969160e-03 3 1  ON 21
ci_0023                -1.135225e-02 3 1  ON 22
ci_0024                -1.129018e-02 3 1  ON 23
ci_0025                -1.076924e-02 3 1  ON 24
ci_0026                -1.013156e-02 3 1  ON 25
ci_0027                -1.124407e-02 3 1  ON 26
ci_0028                -1.106393e-02 3 1  ON 27
ci_0029                -1.064396e-02 3 1  ON 28
ci_0030                -1.060541e-02 3 1  ON 29
ci_0031                 1.888525e-02 3 1  ON 30
ci_0032                 1.987968e-02 3 1  ON 31
ci_0033                 1.046414e-02 3 1  ON 32
ci_0034                 1.085242e-02 3 1  ON 33
ci_0035                 6.436669e-03 3 1  ON 34
ci_0036                 6.670927e-03 3 1  ON 35
ci_0037                -1.055978e-02 3 1  ON 36
ci_0038                -1.051665e-02 3 1  ON 37
ci_0039                -2.800803e-03 3 1  ON 38
ci_0040                -3.038357e-03 3 1  ON 39
ci_0041                 7.460476e-03 3 1  ON 40
ci_0042                 7.496927e-03 3 1  ON 41
ci_0043                -1.500244e-02 3 1  ON 42
ci_0044                -1.571503e-02 3 1  ON 43
ci_0045                 7.231946e-03 3 1  ON 44
ci_0046                 8.047701e-03 3 1  ON 45
ci_0047                 2.009499e-05 3 1  ON 46
ci_0048                -2.522308e-03 3 1  ON 47
ci_0049                -5.929286e-03 3 1  ON 48
ci_0050                -5.746185e-03 3 1  ON 49
ci_0051                -3.763227e-03 3 1  ON 50
ci_0052                -3.957970e-03 3 1  ON 51
ci_0053                -4.939536e-03 3 1  ON 52
ci_0054                -5.032333e-03 3 1  ON 53
ci_0055                 6.866912e-03 3 1  ON 54
ci_0056                 7.207399e-03 3 1  ON 55
ci_0057                 5.076250e-03 3 1  ON 56
ci_0058                 5.402229e-03 3 1  ON 57
ci_0059                -4.800043e-03 3 1  ON 58
ci_0060                -5.337348e-03 3 1  ON 59
ci_0061                -3.570295e-03 3 1  ON 60
ci_0062                -4.391138e-03 3 1  ON 61
ci_0063                -8.654827e-03 3 1  ON 62
ci_0064                -8.222039e-03 3 1  ON 63
ci_0065                -5.324057e-03 3 1  ON 64
ci_0066                -5.527094e-03 3 1  ON 65
ci_0067                -5.207629e-03 3 1  ON 66
ci_0068                -4.750160e-03 3 1  ON 67
ci_0069                 4.697309e-03 3 1  ON 68
ci_0070                 4.639942e-03 3 1  ON 69
ci_0071                 1.848037e-03 3 1  ON 70
ci_0072                 2.260881e-03 3 1  ON 71
ci_0073                 4.057183e-03 3 1  ON 72
ci_0074                 4.428257e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.0685
    reference variance = 0.646928
====================================================
  Execution time = 1.4343e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3287e-01
  Total weights = 1.9518e+06
  Execution time = 1.9116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319852419672
                                         uncertainty =       0.002432684929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319852419672
                                         uncertainty =       0.002432684929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399915032
  error estimate for blocks of size 2^( 2) =       0.000413016705
  error estimate for blocks of size 2^( 3) =       0.000426813723
  error estimate for blocks of size 2^( 4) =       0.000439105068
  error estimate for blocks of size 2^( 5) =       0.000450923646
  error estimate for blocks of size 2^( 6) =       0.000460883657
  error estimate for blocks of size 2^( 7) =       0.000468016510

      target function =                  N/A
              le_mean =     -16.905866561609
             les_mean =     286.159104158405
             stat err =       0.000454732221
             autocorr =       1.292932933777
              std dev =       0.565565262033
             le_variance =       0.319864065619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319585974800
                                         uncertainty =       0.002416800198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319585974800
                                         uncertainty =       0.002416800198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399748837
  error estimate for blocks of size 2^( 2) =       0.000412897528
  error estimate for blocks of size 2^( 3) =       0.000426730328
  error estimate for blocks of size 2^( 4) =       0.000439064718
  error estimate for blocks of size 2^( 5) =       0.000450880708
  error estimate for blocks of size 2^( 6) =       0.000460823969
  error estimate for blocks of size 2^( 7) =       0.000467973079

      target function =                  N/A
              le_mean =     -16.905830350878
             les_mean =     286.146661210166
             stat err =       0.000454685618
             autocorr =       1.293743011303
              std dev =       0.565330227264
             le_variance =       0.319598265859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319830200042
                                         uncertainty =       0.002414110929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319830200042
                                         uncertainty =       0.002414110929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399901591
  error estimate for blocks of size 2^( 2) =       0.000413068212
  error estimate for blocks of size 2^( 3) =       0.000426909983
  error estimate for blocks of size 2^( 4) =       0.000439259727
  error estimate for blocks of size 2^( 5) =       0.000451072324
  error estimate for blocks of size 2^( 6) =       0.000460991741
  error estimate for blocks of size 2^( 7) =       0.000468153192

      target function =                  N/A
              le_mean =     -16.905859280624
             les_mean =     286.150692732083
             stat err =       0.000454869246
             autocorr =       1.293799222506
              std dev =       0.565546253481
             le_variance =       0.319842564827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319644634471
                                         uncertainty =       0.002421986503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319644634471
                                         uncertainty =       0.002421986503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399785322
  error estimate for blocks of size 2^( 2) =       0.000412900594
  error estimate for blocks of size 2^( 3) =       0.000426708020
  error estimate for blocks of size 2^( 4) =       0.000439016344
  error estimate for blocks of size 2^( 5) =       0.000450842277
  error estimate for blocks of size 2^( 6) =       0.000460802427
  error estimate for blocks of size 2^( 7) =       0.000467947419

      target function =                  N/A
              le_mean =     -16.905834808828
             les_mean =     286.145303952881
             stat err =       0.000454652117
             autocorr =       1.293316279819
              std dev =       0.565381824443
             le_variance =       0.319656607410


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905866561609        initial  <--
     3.9062e-02     3.9062e-01             2.8016e-03       -16.905830350878
     1.5625e-01     1.5625e+00             2.2624e-03       -16.905859280624
     6.2500e-01     6.2500e+00             1.2761e-03       -16.905834808828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0361
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_0001                 7.012043e-01 3 1  ON 0
ci_0002                 7.003288e-01 3 1  ON 1
ci_0003                -2.845661e-02 3 1  ON 2
ci_0004                -2.763811e-02 3 1  ON 3
ci_0005                -3.349752e-02 3 1  ON 4
ci_0006                -3.494658e-02 3 1  ON 5
ci_0007                -2.138608e-02 3 1  ON 6
ci_0008                -2.157167e-02 3 1  ON 7
ci_0009                -1.788749e-02 3 1  ON 8
ci_0010                -1.792282e-02 3 1  ON 9
ci_0011                -1.262808e-02 3 1  ON 10
ci_0012                -1.357411e-02 3 1  ON 11
ci_0013                 1.369491e-02 3 1  ON 12
ci_0014                 1.428765e-02 3 1  ON 13
ci_0015                 1.415501e-02 3 1  ON 14
ci_0016                 1.403726e-02 3 1  ON 15
ci_0017                 1.230523e-02 3 1  ON 16
ci_0018                 1.185014e-02 3 1  ON 17
ci_0019                 1.214166e-02 3 1  ON 18
ci_0020                 1.157888e-02 3 1  ON 19
ci_0021                 3.161192e-03 3 1  ON 20
ci_0022                 4.820456e-03 3 1  ON 21
ci_0023                -1.129886e-02 3 1  ON 22
ci_0024                -1.119590e-02 3 1  ON 23
ci_0025                -1.122908e-02 3 1  ON 24
ci_0026                -1.051387e-02 3 1  ON 25
ci_0027                -1.178244e-02 3 1  ON 26
ci_0028                -1.086672e-02 3 1  ON 27
ci_0029                -1.046229e-02 3 1  ON 28
ci_0030                -1.062418e-02 3 1  ON 29
ci_0031                 1.954133e-02 3 1  ON 30
ci_0032                 2.009906e-02 3 1  ON 31
ci_0033                 1.072272e-02 3 1  ON 32
ci_0034                 1.068249e-02 3 1  ON 33
ci_0035                 6.931942e-03 3 1  ON 34
ci_0036                 7.186710e-03 3 1  ON 35
ci_0037                -1.050153e-02 3 1  ON 36
ci_0038                -1.057292e-02 3 1  ON 37
ci_0039                -2.798493e-03 3 1  ON 38
ci_0040                -2.852654e-03 3 1  ON 39
ci_0041                 7.517607e-03 3 1  ON 40
ci_0042                 7.593256e-03 3 1  ON 41
ci_0043                -1.453350e-02 3 1  ON 42
ci_0044                -1.607674e-02 3 1  ON 43
ci_0045                 7.445398e-03 3 1  ON 44
ci_0046                 8.024670e-03 3 1  ON 45
ci_0047                -2.242282e-03 3 1  ON 46
ci_0048                -1.940945e-03 3 1  ON 47
ci_0049                -5.745131e-03 3 1  ON 48
ci_0050                -5.817421e-03 3 1  ON 49
ci_0051                -3.595073e-03 3 1  ON 50
ci_0052                -3.610918e-03 3 1  ON 51
ci_0053                -4.596328e-03 3 1  ON 52
ci_0054                -5.109663e-03 3 1  ON 53
ci_0055                 6.843880e-03 3 1  ON 54
ci_0056                 6.885801e-03 3 1  ON 55
ci_0057                 4.368822e-03 3 1  ON 56
ci_0058                 4.845656e-03 3 1  ON 57
ci_0059                -4.910991e-03 3 1  ON 58
ci_0060                -5.061763e-03 3 1  ON 59
ci_0061                -3.548934e-03 3 1  ON 60
ci_0062                -3.934724e-03 3 1  ON 61
ci_0063                -8.946516e-03 3 1  ON 62
ci_0064                -7.913182e-03 3 1  ON 63
ci_0065                -5.776109e-03 3 1  ON 64
ci_0066                -5.567852e-03 3 1  ON 65
ci_0067                -5.675080e-03 3 1  ON 66
ci_0068                -5.140597e-03 3 1  ON 67
ci_0069                 4.428370e-03 3 1  ON 68
ci_0070                 4.497286e-03 3 1  ON 69
ci_0071                 2.253478e-03 3 1  ON 70
ci_0072                 2.118445e-03 3 1  ON 71
ci_0073                 4.555341e-03 3 1  ON 72
ci_0074                 4.442139e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3525e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6940e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8402
    reference variance = 0.20746
====================================================
  Execution time = 1.4737e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3287e-01
  Total weights = 1.951635415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321377783815
                                         uncertainty =       0.002315888779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321377783815
                                         uncertainty =       0.002315888779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400849943
  error estimate for blocks of size 2^( 2) =       0.000413778113
  error estimate for blocks of size 2^( 3) =       0.000426425123
  error estimate for blocks of size 2^( 4) =       0.000438642868
  error estimate for blocks of size 2^( 5) =       0.000449516122
  error estimate for blocks of size 2^( 6) =       0.000459742643
  error estimate for blocks of size 2^( 7) =       0.000464281112

      target function =                  N/A
              le_mean =     -16.905743086850
             les_mean =     286.137020446788
             stat err =       0.000453045687
             autocorr =       1.277380689589
              std dev =       0.566887426379
             le_variance =       0.321361354187


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690574308685e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905743086850       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905749207362       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905749121936       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905749146301       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e-01 is 6.270397e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905743086850       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905745174179       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905745185076       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+00 is 2.047610e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905743086850       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905743660947       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905743670172       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+00 is 5.562387e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145910 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7343e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.011895e-01 3 1  ON 0
ci_0002                 7.003432e-01 3 1  ON 1
ci_0003                -2.848495e-02 3 1  ON 2
ci_0004                -2.764539e-02 3 1  ON 3
ci_0005                -3.355123e-02 3 1  ON 4
ci_0006                -3.490951e-02 3 1  ON 5
ci_0007                -2.150446e-02 3 1  ON 6
ci_0008                -2.162211e-02 3 1  ON 7
ci_0009                -1.786815e-02 3 1  ON 8
ci_0010                -1.790896e-02 3 1  ON 9
ci_0011                -1.252686e-02 3 1  ON 10
ci_0012                -1.342545e-02 3 1  ON 11
ci_0013                 1.375607e-02 3 1  ON 12
ci_0014                 1.422208e-02 3 1  ON 13
ci_0015                 1.403127e-02 3 1  ON 14
ci_0016                 1.405692e-02 3 1  ON 15
ci_0017                 1.229932e-02 3 1  ON 16
ci_0018                 1.173094e-02 3 1  ON 17
ci_0019                 1.215400e-02 3 1  ON 18
ci_0020                 1.162403e-02 3 1  ON 19
ci_0021                 3.190300e-03 3 1  ON 20
ci_0022                 4.681491e-03 3 1  ON 21
ci_0023                -1.129883e-02 3 1  ON 22
ci_0024                -1.124423e-02 3 1  ON 23
ci_0025                -1.110295e-02 3 1  ON 24
ci_0026                -1.058489e-02 3 1  ON 25
ci_0027                -1.174261e-02 3 1  ON 26
ci_0028                -1.100848e-02 3 1  ON 27
ci_0029                -1.052683e-02 3 1  ON 28
ci_0030                -1.064161e-02 3 1  ON 29
ci_0031                 1.954273e-02 3 1  ON 30
ci_0032                 2.011745e-02 3 1  ON 31
ci_0033                 1.078347e-02 3 1  ON 32
ci_0034                 1.055077e-02 3 1  ON 33
ci_0035                 6.950207e-03 3 1  ON 34
ci_0036                 7.262252e-03 3 1  ON 35
ci_0037                -1.042910e-02 3 1  ON 36
ci_0038                -1.060425e-02 3 1  ON 37
ci_0039                -2.816141e-03 3 1  ON 38
ci_0040                -2.859308e-03 3 1  ON 39
ci_0041                 7.458654e-03 3 1  ON 40
ci_0042                 7.517400e-03 3 1  ON 41
ci_0043                -1.465993e-02 3 1  ON 42
ci_0044                -1.607936e-02 3 1  ON 43
ci_0045                 7.459204e-03 3 1  ON 44
ci_0046                 7.946929e-03 3 1  ON 45
ci_0047                -2.131880e-03 3 1  ON 46
ci_0048                -1.953976e-03 3 1  ON 47
ci_0049                -5.806684e-03 3 1  ON 48
ci_0050                -5.845754e-03 3 1  ON 49
ci_0051                -3.619607e-03 3 1  ON 50
ci_0052                -3.574599e-03 3 1  ON 51
ci_0053                -4.589659e-03 3 1  ON 52
ci_0054                -5.144964e-03 3 1  ON 53
ci_0055                 6.747841e-03 3 1  ON 54
ci_0056                 6.857397e-03 3 1  ON 55
ci_0057                 4.420571e-03 3 1  ON 56
ci_0058                 5.050417e-03 3 1  ON 57
ci_0059                -4.990714e-03 3 1  ON 58
ci_0060                -5.048641e-03 3 1  ON 59
ci_0061                -3.419239e-03 3 1  ON 60
ci_0062                -3.842699e-03 3 1  ON 61
ci_0063                -8.787848e-03 3 1  ON 62
ci_0064                -7.959830e-03 3 1  ON 63
ci_0065                -5.749006e-03 3 1  ON 64
ci_0066                -5.608758e-03 3 1  ON 65
ci_0067                -5.574953e-03 3 1  ON 66
ci_0068                -5.232307e-03 3 1  ON 67
ci_0069                 4.465506e-03 3 1  ON 68
ci_0070                 4.684641e-03 3 1  ON 69
ci_0071                 2.212453e-03 3 1  ON 70
ci_0072                 2.278614e-03 3 1  ON 71
ci_0073                 4.566539e-03 3 1  ON 72
ci_0074                 4.316097e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8339
    reference variance = 0.239437
====================================================
  Execution time = 1.4599e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2944e-01
  Total weights = 1.9519e+06
  Execution time = 1.9094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316794223573
                                         uncertainty =       0.001849227970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316794223573
                                         uncertainty =       0.001849227970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397993002
  error estimate for blocks of size 2^( 2) =       0.000410469924
  error estimate for blocks of size 2^( 3) =       0.000423500823
  error estimate for blocks of size 2^( 4) =       0.000434594821
  error estimate for blocks of size 2^( 5) =       0.000445006936
  error estimate for blocks of size 2^( 6) =       0.000452674047
  error estimate for blocks of size 2^( 7) =       0.000457282927

      target function =                  N/A
              le_mean =     -16.906555646558
             les_mean =     286.161347053446
             stat err =       0.000447389683
             autocorr =       1.263633283659
              std dev =       0.562847101848
             le_variance =       0.316796860059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316764806675
                                         uncertainty =       0.001826063721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316764806675
                                         uncertainty =       0.001826063721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397974907
  error estimate for blocks of size 2^( 2) =       0.000410453935
  error estimate for blocks of size 2^( 3) =       0.000423487289
  error estimate for blocks of size 2^( 4) =       0.000434583149
  error estimate for blocks of size 2^( 5) =       0.000445002502
  error estimate for blocks of size 2^( 6) =       0.000452641010
  error estimate for blocks of size 2^( 7) =       0.000457272101

      target function =                  N/A
              le_mean =     -16.906555032470
             les_mean =     286.162528432843
             stat err =       0.000447374690
             autocorr =       1.263663502233
              std dev =       0.562821510848
             le_variance =       0.316768053073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316755639424
                                         uncertainty =       0.001830919301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316755639424
                                         uncertainty =       0.001830919301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397969028
  error estimate for blocks of size 2^( 2) =       0.000410447548
  error estimate for blocks of size 2^( 3) =       0.000423480279
  error estimate for blocks of size 2^( 4) =       0.000434575995
  error estimate for blocks of size 2^( 5) =       0.000444993461
  error estimate for blocks of size 2^( 6) =       0.000452639385
  error estimate for blocks of size 2^( 7) =       0.000457265652

      target function =                  N/A
              le_mean =     -16.906553401558
             les_mean =     286.161096949549
             stat err =       0.000447368623
             autocorr =       1.263666562901
              std dev =       0.562813196571
             le_variance =       0.316758694235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316784340062
                                         uncertainty =       0.001846317520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316784340062
                                         uncertainty =       0.001846317520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397986832
  error estimate for blocks of size 2^( 2) =       0.000410463970
  error estimate for blocks of size 2^( 3) =       0.000423495082
  error estimate for blocks of size 2^( 4) =       0.000434589409
  error estimate for blocks of size 2^( 5) =       0.000445002459
  error estimate for blocks of size 2^( 6) =       0.000452666521
  error estimate for blocks of size 2^( 7) =       0.000457278118

      target function =                  N/A
              le_mean =     -16.906554880993
             les_mean =     286.161226042430
             stat err =       0.000447384127
             autocorr =       1.263641082952
              std dev =       0.562838375037
             le_variance =       0.316787036414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906555646558        initial  <--
     3.9062e-01     3.9062e+00             6.2704e-04       -16.906555032470
     1.5625e+00     1.5625e+01             2.0476e-04       -16.906553401558
     6.2500e+00     6.2500e+01             5.5624e-05       -16.906554880993

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.2959
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_0001                 7.012043e-01 3 1  ON 0
ci_0002                 7.003288e-01 3 1  ON 1
ci_0003                -2.845661e-02 3 1  ON 2
ci_0004                -2.763811e-02 3 1  ON 3
ci_0005                -3.349752e-02 3 1  ON 4
ci_0006                -3.494658e-02 3 1  ON 5
ci_0007                -2.138608e-02 3 1  ON 6
ci_0008                -2.157167e-02 3 1  ON 7
ci_0009                -1.788749e-02 3 1  ON 8
ci_0010                -1.792282e-02 3 1  ON 9
ci_0011                -1.262808e-02 3 1  ON 10
ci_0012                -1.357411e-02 3 1  ON 11
ci_0013                 1.369491e-02 3 1  ON 12
ci_0014                 1.428765e-02 3 1  ON 13
ci_0015                 1.415501e-02 3 1  ON 14
ci_0016                 1.403726e-02 3 1  ON 15
ci_0017                 1.230523e-02 3 1  ON 16
ci_0018                 1.185014e-02 3 1  ON 17
ci_0019                 1.214166e-02 3 1  ON 18
ci_0020                 1.157888e-02 3 1  ON 19
ci_0021                 3.161192e-03 3 1  ON 20
ci_0022                 4.820456e-03 3 1  ON 21
ci_0023                -1.129886e-02 3 1  ON 22
ci_0024                -1.119590e-02 3 1  ON 23
ci_0025                -1.122908e-02 3 1  ON 24
ci_0026                -1.051387e-02 3 1  ON 25
ci_0027                -1.178244e-02 3 1  ON 26
ci_0028                -1.086672e-02 3 1  ON 27
ci_0029                -1.046229e-02 3 1  ON 28
ci_0030                -1.062418e-02 3 1  ON 29
ci_0031                 1.954133e-02 3 1  ON 30
ci_0032                 2.009906e-02 3 1  ON 31
ci_0033                 1.072272e-02 3 1  ON 32
ci_0034                 1.068249e-02 3 1  ON 33
ci_0035                 6.931942e-03 3 1  ON 34
ci_0036                 7.186710e-03 3 1  ON 35
ci_0037                -1.050153e-02 3 1  ON 36
ci_0038                -1.057292e-02 3 1  ON 37
ci_0039                -2.798493e-03 3 1  ON 38
ci_0040                -2.852654e-03 3 1  ON 39
ci_0041                 7.517607e-03 3 1  ON 40
ci_0042                 7.593256e-03 3 1  ON 41
ci_0043                -1.453350e-02 3 1  ON 42
ci_0044                -1.607674e-02 3 1  ON 43
ci_0045                 7.445398e-03 3 1  ON 44
ci_0046                 8.024670e-03 3 1  ON 45
ci_0047                -2.242282e-03 3 1  ON 46
ci_0048                -1.940945e-03 3 1  ON 47
ci_0049                -5.745131e-03 3 1  ON 48
ci_0050                -5.817421e-03 3 1  ON 49
ci_0051                -3.595073e-03 3 1  ON 50
ci_0052                -3.610918e-03 3 1  ON 51
ci_0053                -4.596328e-03 3 1  ON 52
ci_0054                -5.109663e-03 3 1  ON 53
ci_0055                 6.843880e-03 3 1  ON 54
ci_0056                 6.885801e-03 3 1  ON 55
ci_0057                 4.368822e-03 3 1  ON 56
ci_0058                 4.845656e-03 3 1  ON 57
ci_0059                -4.910991e-03 3 1  ON 58
ci_0060                -5.061763e-03 3 1  ON 59
ci_0061                -3.548934e-03 3 1  ON 60
ci_0062                -3.934724e-03 3 1  ON 61
ci_0063                -8.946516e-03 3 1  ON 62
ci_0064                -7.913182e-03 3 1  ON 63
ci_0065                -5.776109e-03 3 1  ON 64
ci_0066                -5.567852e-03 3 1  ON 65
ci_0067                -5.675080e-03 3 1  ON 66
ci_0068                -5.140597e-03 3 1  ON 67
ci_0069                 4.428370e-03 3 1  ON 68
ci_0070                 4.497286e-03 3 1  ON 69
ci_0071                 2.253478e-03 3 1  ON 70
ci_0072                 2.118445e-03 3 1  ON 71
ci_0073                 4.555341e-03 3 1  ON 72
ci_0074                 4.442139e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1647e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9692
    reference variance = 0.329937
====================================================
  Execution time = 1.5149e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4003e-01
  Total weights = 1.952109114e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328666553897
                                         uncertainty =       0.008471318066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328666553897
                                         uncertainty =       0.008471318066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405353312
  error estimate for blocks of size 2^( 2) =       0.000418196371
  error estimate for blocks of size 2^( 3) =       0.000430395702
  error estimate for blocks of size 2^( 4) =       0.000442162883
  error estimate for blocks of size 2^( 5) =       0.000452490283
  error estimate for blocks of size 2^( 6) =       0.000459573344
  error estimate for blocks of size 2^( 7) =       0.000460995640

      target function =                  N/A
              le_mean =     -16.906344966100
             les_mean =     286.164527503556
             stat err =       0.000453805538
             autocorr =       1.253349319602
              std dev =       0.573256151912
             le_variance =       0.328622615705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634496610e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906344966098       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906346394326       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906346479505       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906346476603       residual = 2.22e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 8.899449e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906344966098       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345337444       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345359414       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345358789       residual = 2.61e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 2.308974e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906344966098       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345059873       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345065414       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906345065268       residual = 2.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.2500e+01 is 5.827576e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7733e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.012039e-01 3 1  ON 0
ci_0002                 7.003285e-01 3 1  ON 1
ci_0003                -2.845337e-02 3 1  ON 2
ci_0004                -2.764799e-02 3 1  ON 3
ci_0005                -3.350204e-02 3 1  ON 4
ci_0006                -3.494689e-02 3 1  ON 5
ci_0007                -2.139323e-02 3 1  ON 6
ci_0008                -2.157716e-02 3 1  ON 7
ci_0009                -1.789834e-02 3 1  ON 8
ci_0010                -1.793772e-02 3 1  ON 9
ci_0011                -1.263099e-02 3 1  ON 10
ci_0012                -1.357042e-02 3 1  ON 11
ci_0013                 1.368754e-02 3 1  ON 12
ci_0014                 1.427165e-02 3 1  ON 13
ci_0015                 1.414225e-02 3 1  ON 14
ci_0016                 1.403276e-02 3 1  ON 15
ci_0017                 1.230301e-02 3 1  ON 16
ci_0018                 1.185862e-02 3 1  ON 17
ci_0019                 1.212953e-02 3 1  ON 18
ci_0020                 1.158530e-02 3 1  ON 19
ci_0021                 3.160181e-03 3 1  ON 20
ci_0022                 4.808018e-03 3 1  ON 21
ci_0023                -1.130075e-02 3 1  ON 22
ci_0024                -1.120250e-02 3 1  ON 23
ci_0025                -1.124341e-02 3 1  ON 24
ci_0026                -1.052389e-02 3 1  ON 25
ci_0027                -1.177643e-02 3 1  ON 26
ci_0028                -1.087351e-02 3 1  ON 27
ci_0029                -1.045566e-02 3 1  ON 28
ci_0030                -1.062493e-02 3 1  ON 29
ci_0031                 1.955566e-02 3 1  ON 30
ci_0032                 2.009923e-02 3 1  ON 31
ci_0033                 1.072213e-02 3 1  ON 32
ci_0034                 1.067081e-02 3 1  ON 33
ci_0035                 6.930948e-03 3 1  ON 34
ci_0036                 7.172044e-03 3 1  ON 35
ci_0037                -1.050392e-02 3 1  ON 36
ci_0038                -1.056580e-02 3 1  ON 37
ci_0039                -2.800898e-03 3 1  ON 38
ci_0040                -2.853486e-03 3 1  ON 39
ci_0041                 7.516866e-03 3 1  ON 40
ci_0042                 7.585371e-03 3 1  ON 41
ci_0043                -1.453144e-02 3 1  ON 42
ci_0044                -1.607698e-02 3 1  ON 43
ci_0045                 7.443670e-03 3 1  ON 44
ci_0046                 8.005171e-03 3 1  ON 45
ci_0047                -2.247416e-03 3 1  ON 46
ci_0048                -1.942239e-03 3 1  ON 47
ci_0049                -5.750544e-03 3 1  ON 48
ci_0050                -5.815610e-03 3 1  ON 49
ci_0051                -3.587023e-03 3 1  ON 50
ci_0052                -3.610956e-03 3 1  ON 51
ci_0053                -4.611307e-03 3 1  ON 52
ci_0054                -5.099173e-03 3 1  ON 53
ci_0055                 6.853417e-03 3 1  ON 54
ci_0056                 6.890254e-03 3 1  ON 55
ci_0057                 4.381846e-03 3 1  ON 56
ci_0058                 4.852719e-03 3 1  ON 57
ci_0059                -4.919854e-03 3 1  ON 58
ci_0060                -5.050162e-03 3 1  ON 59
ci_0061                -3.556084e-03 3 1  ON 60
ci_0062                -3.911634e-03 3 1  ON 61
ci_0063                -8.938044e-03 3 1  ON 62
ci_0064                -7.919026e-03 3 1  ON 63
ci_0065                -5.777779e-03 3 1  ON 64
ci_0066                -5.563700e-03 3 1  ON 65
ci_0067                -5.679066e-03 3 1  ON 66
ci_0068                -5.128395e-03 3 1  ON 67
ci_0069                 4.438664e-03 3 1  ON 68
ci_0070                 4.496179e-03 3 1  ON 69
ci_0071                 2.249042e-03 3 1  ON 70
ci_0072                 2.113568e-03 3 1  ON 71
ci_0073                 4.559213e-03 3 1  ON 72
ci_0074                 4.429803e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8505
    reference variance = 0.291983
====================================================
  Execution time = 1.4687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3061e-01
  Total weights = 1.9517e+06
  Execution time = 1.9133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319989481335
                                         uncertainty =       0.001962576582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319989481335
                                         uncertainty =       0.001962576582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399985996
  error estimate for blocks of size 2^( 2) =       0.000413086490
  error estimate for blocks of size 2^( 3) =       0.000426850882
  error estimate for blocks of size 2^( 4) =       0.000440767894
  error estimate for blocks of size 2^( 5) =       0.000451725739
  error estimate for blocks of size 2^( 6) =       0.000461552146
  error estimate for blocks of size 2^( 7) =       0.000468500917

      target function =                  N/A
              le_mean =     -16.905147676577
             les_mean =     286.114625345948
             stat err =       0.000455636674
             autocorr =       1.297620722513
              std dev =       0.565665620658
             le_variance =       0.319977594395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320024646335
                                         uncertainty =       0.001964437139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320024646335
                                         uncertainty =       0.001964437139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400007954
  error estimate for blocks of size 2^( 2) =       0.000413108041
  error estimate for blocks of size 2^( 3) =       0.000426872360
  error estimate for blocks of size 2^( 4) =       0.000440790811
  error estimate for blocks of size 2^( 5) =       0.000451747842
  error estimate for blocks of size 2^( 6) =       0.000461570776
  error estimate for blocks of size 2^( 7) =       0.000468516680

      target function =                  N/A
              le_mean =     -16.905148147851
             les_mean =     286.114725085097
             stat err =       0.000455656528
             autocorr =       1.297591341076
              std dev =       0.565696673034
             le_variance =       0.320012725882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007466565
                                         uncertainty =       0.001963542700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320007466565
                                         uncertainty =       0.001963542700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399997226
  error estimate for blocks of size 2^( 2) =       0.000413097514
  error estimate for blocks of size 2^( 3) =       0.000426861857
  error estimate for blocks of size 2^( 4) =       0.000440779633
  error estimate for blocks of size 2^( 5) =       0.000451737088
  error estimate for blocks of size 2^( 6) =       0.000461561697
  error estimate for blocks of size 2^( 7) =       0.000468509026

      target function =                  N/A
              le_mean =     -16.905147894376
             les_mean =     286.114637794086
             stat err =       0.000455646861
             autocorr =       1.297605883830
              std dev =       0.565681501875
             le_variance =       0.319995561563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319991714858
                                         uncertainty =       0.001962697548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319991714858
                                         uncertainty =       0.001962697548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399987391
  error estimate for blocks of size 2^( 2) =       0.000413087858
  error estimate for blocks of size 2^( 3) =       0.000426852244
  error estimate for blocks of size 2^( 4) =       0.000440769353
  error estimate for blocks of size 2^( 5) =       0.000451727150
  error estimate for blocks of size 2^( 6) =       0.000461553329
  error estimate for blocks of size 2^( 7) =       0.000468501920

      target function =                  N/A
              le_mean =     -16.905147699719
             les_mean =     286.114626337388
             stat err =       0.000455637938
             autocorr =       1.297618873966
              std dev =       0.565667592873
             le_variance =       0.319979825627


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905147676577        initial
     3.9062e+00     3.9062e+01             8.8994e-05       -16.905148147851  <--
     1.5625e+01     1.5625e+02             2.3090e-05       -16.905147894376
     6.2500e+01     6.2500e+02             5.8276e-06       -16.905147699719

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.4458e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_0001                 7.012028e-01 3 1  ON 0
ci_0002                 7.003276e-01 3 1  ON 1
ci_0003                -2.844440e-02 3 1  ON 2
ci_0004                -2.767630e-02 3 1  ON 3
ci_0005                -3.351537e-02 3 1  ON 4
ci_0006                -3.494775e-02 3 1  ON 5
ci_0007                -2.141428e-02 3 1  ON 6
ci_0008                -2.159327e-02 3 1  ON 7
ci_0009                -1.792913e-02 3 1  ON 8
ci_0010                -1.797978e-02 3 1  ON 9
ci_0011                -1.263938e-02 3 1  ON 10
ci_0012                -1.355976e-02 3 1  ON 11
ci_0013                 1.366659e-02 3 1  ON 12
ci_0014                 1.422601e-02 3 1  ON 13
ci_0015                 1.410617e-02 3 1  ON 14
ci_0016                 1.401972e-02 3 1  ON 15
ci_0017                 1.229675e-02 3 1  ON 16
ci_0018                 1.188254e-02 3 1  ON 17
ci_0019                 1.209502e-02 3 1  ON 18
ci_0020                 1.160358e-02 3 1  ON 19
ci_0021                 3.157066e-03 3 1  ON 20
ci_0022                 4.771453e-03 3 1  ON 21
ci_0023                -1.130604e-02 3 1  ON 22
ci_0024                -1.122121e-02 3 1  ON 23
ci_0025                -1.128404e-02 3 1  ON 24
ci_0026                -1.055235e-02 3 1  ON 25
ci_0027                -1.175941e-02 3 1  ON 26
ci_0028                -1.089287e-02 3 1  ON 27
ci_0029                -1.043683e-02 3 1  ON 28
ci_0030                -1.062727e-02 3 1  ON 29
ci_0031                 1.959733e-02 3 1  ON 30
ci_0032                 2.009969e-02 3 1  ON 31
ci_0033                 1.072041e-02 3 1  ON 32
ci_0034                 1.063688e-02 3 1  ON 33
ci_0035                 6.928051e-03 3 1  ON 34
ci_0036                 7.130049e-03 3 1  ON 35
ci_0037                -1.051077e-02 3 1  ON 36
ci_0038                -1.054514e-02 3 1  ON 37
ci_0039                -2.807506e-03 3 1  ON 38
ci_0040                -2.855763e-03 3 1  ON 39
ci_0041                 7.514821e-03 3 1  ON 40
ci_0042                 7.562890e-03 3 1  ON 41
ci_0043                -1.452557e-02 3 1  ON 42
ci_0044                -1.607738e-02 3 1  ON 43
ci_0045                 7.438631e-03 3 1  ON 44
ci_0046                 7.948701e-03 3 1  ON 45
ci_0047                -2.261495e-03 3 1  ON 46
ci_0048                -1.945822e-03 3 1  ON 47
ci_0049                -5.765845e-03 3 1  ON 48
ci_0050                -5.810396e-03 3 1  ON 49
ci_0051                -3.564832e-03 3 1  ON 50
ci_0052                -3.610977e-03 3 1  ON 51
ci_0053                -4.652882e-03 3 1  ON 52
ci_0054                -5.069878e-03 3 1  ON 53
ci_0055                 6.880906e-03 3 1  ON 54
ci_0056                 6.903070e-03 3 1  ON 55
ci_0057                 4.419193e-03 3 1  ON 56
ci_0058                 4.872957e-03 3 1  ON 57
ci_0059                -4.944498e-03 3 1  ON 58
ci_0060                -5.017868e-03 3 1  ON 59
ci_0061                -3.576460e-03 3 1  ON 60
ci_0062                -3.845729e-03 3 1  ON 61
ci_0063                -8.914439e-03 3 1  ON 62
ci_0064                -7.935281e-03 3 1  ON 63
ci_0065                -5.782422e-03 3 1  ON 64
ci_0066                -5.551968e-03 3 1  ON 65
ci_0067                -5.690055e-03 3 1  ON 66
ci_0068                -5.094620e-03 3 1  ON 67
ci_0069                 4.467044e-03 3 1  ON 68
ci_0070                 4.493144e-03 3 1  ON 69
ci_0071                 2.236739e-03 3 1  ON 70
ci_0072                 2.099411e-03 3 1  ON 71
ci_0073                 4.569838e-03 3 1  ON 72
ci_0074                 4.395779e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8922
    reference variance = 0.173625
====================================================
  Execution time = 1.4955e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3743e-01
  Total weights = 1.951843126e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322000801761
                                         uncertainty =       0.002182246272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322000801761
                                         uncertainty =       0.002182246272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401351573
  error estimate for blocks of size 2^( 2) =       0.000413727446
  error estimate for blocks of size 2^( 3) =       0.000426284086
  error estimate for blocks of size 2^( 4) =       0.000437959984
  error estimate for blocks of size 2^( 5) =       0.000448565709
  error estimate for blocks of size 2^( 6) =       0.000454362325
  error estimate for blocks of size 2^( 7) =       0.000459243324

      target function =                  N/A
              le_mean =     -16.906004482451
             les_mean =     286.150413697235
             stat err =       0.000450032835
             autocorr =       1.257298693107
              std dev =       0.567596838519
             le_variance =       0.322166171097


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600448245e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906004482448       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906012284822       residual = 7.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906012674814       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906012666075       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 4.726224e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906004482448       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906006750312       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906006848218       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006849727       residual = 1.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.256323e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906004482448       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005073446       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005098774       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005099274       residual = 8.66e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5625e+01 is 3.193138e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7561e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.011981e-01 3 1  ON 0
ci_0002                 7.003335e-01 3 1  ON 1
ci_0003                -2.846762e-02 3 1  ON 2
ci_0004                -2.767329e-02 3 1  ON 3
ci_0005                -3.356002e-02 3 1  ON 4
ci_0006                -3.494940e-02 3 1  ON 5
ci_0007                -2.147091e-02 3 1  ON 6
ci_0008                -2.160170e-02 3 1  ON 7
ci_0009                -1.791529e-02 3 1  ON 8
ci_0010                -1.793310e-02 3 1  ON 9
ci_0011                -1.268075e-02 3 1  ON 10
ci_0012                -1.350581e-02 3 1  ON 11
ci_0013                 1.365922e-02 3 1  ON 12
ci_0014                 1.417957e-02 3 1  ON 13
ci_0015                 1.412272e-02 3 1  ON 14
ci_0016                 1.406288e-02 3 1  ON 15
ci_0017                 1.217923e-02 3 1  ON 16
ci_0018                 1.187219e-02 3 1  ON 17
ci_0019                 1.204232e-02 3 1  ON 18
ci_0020                 1.162351e-02 3 1  ON 19
ci_0021                 3.083157e-03 3 1  ON 20
ci_0022                 4.645821e-03 3 1  ON 21
ci_0023                -1.133505e-02 3 1  ON 22
ci_0024                -1.117897e-02 3 1  ON 23
ci_0025                -1.129431e-02 3 1  ON 24
ci_0026                -1.056177e-02 3 1  ON 25
ci_0027                -1.172078e-02 3 1  ON 26
ci_0028                -1.088787e-02 3 1  ON 27
ci_0029                -1.048214e-02 3 1  ON 28
ci_0030                -1.066326e-02 3 1  ON 29
ci_0031                 1.963764e-02 3 1  ON 30
ci_0032                 2.008736e-02 3 1  ON 31
ci_0033                 1.067304e-02 3 1  ON 32
ci_0034                 1.056731e-02 3 1  ON 33
ci_0035                 6.947962e-03 3 1  ON 34
ci_0036                 7.131383e-03 3 1  ON 35
ci_0037                -1.047099e-02 3 1  ON 36
ci_0038                -1.057773e-02 3 1  ON 37
ci_0039                -2.826754e-03 3 1  ON 38
ci_0040                -2.773083e-03 3 1  ON 39
ci_0041                 7.510328e-03 3 1  ON 40
ci_0042                 7.553270e-03 3 1  ON 41
ci_0043                -1.456640e-02 3 1  ON 42
ci_0044                -1.603470e-02 3 1  ON 43
ci_0045                 7.461292e-03 3 1  ON 44
ci_0046                 7.929703e-03 3 1  ON 45
ci_0047                -2.234527e-03 3 1  ON 46
ci_0048                -2.004164e-03 3 1  ON 47
ci_0049                -5.721297e-03 3 1  ON 48
ci_0050                -5.874491e-03 3 1  ON 49
ci_0051                -3.578209e-03 3 1  ON 50
ci_0052                -3.608347e-03 3 1  ON 51
ci_0053                -4.660932e-03 3 1  ON 52
ci_0054                -5.032535e-03 3 1  ON 53
ci_0055                 6.874279e-03 3 1  ON 54
ci_0056                 6.878741e-03 3 1  ON 55
ci_0057                 4.435295e-03 3 1  ON 56
ci_0058                 4.943103e-03 3 1  ON 57
ci_0059                -4.943042e-03 3 1  ON 58
ci_0060                -5.024059e-03 3 1  ON 59
ci_0061                -3.575273e-03 3 1  ON 60
ci_0062                -3.808036e-03 3 1  ON 61
ci_0063                -8.842166e-03 3 1  ON 62
ci_0064                -8.012605e-03 3 1  ON 63
ci_0065                -5.744108e-03 3 1  ON 64
ci_0066                -5.537426e-03 3 1  ON 65
ci_0067                -5.668143e-03 3 1  ON 66
ci_0068                -5.111008e-03 3 1  ON 67
ci_0069                 4.527250e-03 3 1  ON 68
ci_0070                 4.486511e-03 3 1  ON 69
ci_0071                 2.286317e-03 3 1  ON 70
ci_0072                 2.138030e-03 3 1  ON 71
ci_0073                 4.549408e-03 3 1  ON 72
ci_0074                 4.429658e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8861
    reference variance = 0.730865
====================================================
  Execution time = 1.4204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3740e-01
  Total weights = 1.9518e+06
  Execution time = 1.9091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324573228128
                                         uncertainty =       0.003578779229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324573228128
                                         uncertainty =       0.003578779229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402907189
  error estimate for blocks of size 2^( 2) =       0.000415541793
  error estimate for blocks of size 2^( 3) =       0.000428316178
  error estimate for blocks of size 2^( 4) =       0.000439560329
  error estimate for blocks of size 2^( 5) =       0.000449936292
  error estimate for blocks of size 2^( 6) =       0.000456572896
  error estimate for blocks of size 2^( 7) =       0.000459194326

      target function =                  N/A
              le_mean =     -16.905865424156
             les_mean =     286.146006259022
             stat err =       0.000451315960
             autocorr =       1.254733089659
              std dev =       0.569796811293
             le_variance =       0.324668406159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324351720199
                                         uncertainty =       0.003518890557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324351720199
                                         uncertainty =       0.003518890557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402770186
  error estimate for blocks of size 2^( 2) =       0.000415417706
  error estimate for blocks of size 2^( 3) =       0.000428203194
  error estimate for blocks of size 2^( 4) =       0.000439460538
  error estimate for blocks of size 2^( 5) =       0.000449845177
  error estimate for blocks of size 2^( 6) =       0.000456476976
  error estimate for blocks of size 2^( 7) =       0.000459095441

      target function =                  N/A
              le_mean =     -16.905868523784
             les_mean =     286.146157325428
             stat err =       0.000451219533
             autocorr =       1.255050359532
              std dev =       0.569603059286
             le_variance =       0.324447645148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324431751082
                                         uncertainty =       0.003540776051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324431751082
                                         uncertainty =       0.003540776051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402819680
  error estimate for blocks of size 2^( 2) =       0.000415462129
  error estimate for blocks of size 2^( 3) =       0.000428243533
  error estimate for blocks of size 2^( 4) =       0.000439495258
  error estimate for blocks of size 2^( 5) =       0.000449876584
  error estimate for blocks of size 2^( 6) =       0.000456509964
  error estimate for blocks of size 2^( 7) =       0.000459130509

      target function =                  N/A
              le_mean =     -16.905866751969
             les_mean =     286.145855776688
             stat err =       0.000451253079
             autocorr =       1.254928538482
              std dev =       0.569673055062
             le_variance =       0.324527389663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324553109027
                                         uncertainty =       0.003573444576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324553109027
                                         uncertainty =       0.003573444576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402894745
  error estimate for blocks of size 2^( 2) =       0.000415530398
  error estimate for blocks of size 2^( 3) =       0.000428305708
  error estimate for blocks of size 2^( 4) =       0.000439550845
  error estimate for blocks of size 2^( 5) =       0.000449927494
  error estimate for blocks of size 2^( 6) =       0.000456563569
  error estimate for blocks of size 2^( 7) =       0.000459184811

      target function =                  N/A
              le_mean =     -16.905865463029
             les_mean =     286.145873360135
             stat err =       0.000451306680
             autocorr =       1.254758996028
              std dev =       0.569779212259
             le_variance =       0.324648350722


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905865424156        initial
     9.7656e-01     9.7656e+00             4.7262e-04       -16.905868523784  <--
     3.9062e+00     3.9062e+01             1.2563e-04       -16.905866751969
     1.5625e+01     1.5625e+02             3.1931e-05       -16.905865463029

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.3882e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_0001                 7.011855e-01 3 1  ON 0
ci_0002                 7.003483e-01 3 1  ON 1
ci_0003                -2.852683e-02 3 1  ON 2
ci_0004                -2.766454e-02 3 1  ON 3
ci_0005                -3.367870e-02 3 1  ON 4
ci_0006                -3.495335e-02 3 1  ON 5
ci_0007                -2.162854e-02 3 1  ON 6
ci_0008                -2.162549e-02 3 1  ON 7
ci_0009                -1.788312e-02 3 1  ON 8
ci_0010                -1.782102e-02 3 1  ON 9
ci_0011                -1.278237e-02 3 1  ON 10
ci_0012                -1.337141e-02 3 1  ON 11
ci_0013                 1.364003e-02 3 1  ON 12
ci_0014                 1.406595e-02 3 1  ON 13
ci_0015                 1.416432e-02 3 1  ON 14
ci_0016                 1.416963e-02 3 1  ON 15
ci_0017                 1.189569e-02 3 1  ON 16
ci_0018                 1.184777e-02 3 1  ON 17
ci_0019                 1.191391e-02 3 1  ON 18
ci_0020                 1.167511e-02 3 1  ON 19
ci_0021                 2.881702e-03 3 1  ON 20
ci_0022                 4.298831e-03 3 1  ON 21
ci_0023                -1.140738e-02 3 1  ON 22
ci_0024                -1.107888e-02 3 1  ON 23
ci_0025                -1.131995e-02 3 1  ON 24
ci_0026                -1.058788e-02 3 1  ON 25
ci_0027                -1.162464e-02 3 1  ON 26
ci_0028                -1.087701e-02 3 1  ON 27
ci_0029                -1.059412e-02 3 1  ON 28
ci_0030                -1.075457e-02 3 1  ON 29
ci_0031                 1.974519e-02 3 1  ON 30
ci_0032                 2.005466e-02 3 1  ON 31
ci_0033                 1.054716e-02 3 1  ON 32
ci_0034                 1.038179e-02 3 1  ON 33
ci_0035                 6.993037e-03 3 1  ON 34
ci_0036                 7.134254e-03 3 1  ON 35
ci_0037                -1.036995e-02 3 1  ON 36
ci_0038                -1.066039e-02 3 1  ON 37
ci_0039                -2.870211e-03 3 1  ON 38
ci_0040                -2.603854e-03 3 1  ON 39
ci_0041                 7.497565e-03 3 1  ON 40
ci_0042                 7.528881e-03 3 1  ON 41
ci_0043                -1.467663e-02 3 1  ON 42
ci_0044                -1.590911e-02 3 1  ON 43
ci_0045                 7.519385e-03 3 1  ON 44
ci_0046                 7.879984e-03 3 1  ON 45
ci_0047                -2.172287e-03 3 1  ON 46
ci_0048                -2.128923e-03 3 1  ON 47
ci_0049                -5.614477e-03 3 1  ON 48
ci_0050                -6.032754e-03 3 1  ON 49
ci_0051                -3.607605e-03 3 1  ON 50
ci_0052                -3.601450e-03 3 1  ON 51
ci_0053                -4.680149e-03 3 1  ON 52
ci_0054                -4.948958e-03 3 1  ON 53
ci_0055                 6.856229e-03 3 1  ON 54
ci_0056                 6.815377e-03 3 1  ON 55
ci_0057                 4.475917e-03 3 1  ON 56
ci_0058                 5.118850e-03 3 1  ON 57
ci_0059                -4.938031e-03 3 1  ON 58
ci_0060                -5.041429e-03 3 1  ON 59
ci_0061                -3.572971e-03 3 1  ON 60
ci_0062                -3.717095e-03 3 1  ON 61
ci_0063                -8.674363e-03 3 1  ON 62
ci_0064                -8.190184e-03 3 1  ON 63
ci_0065                -5.650586e-03 3 1  ON 64
ci_0066                -5.502793e-03 3 1  ON 65
ci_0067                -5.618278e-03 3 1  ON 66
ci_0068                -5.149041e-03 3 1  ON 67
ci_0069                 4.660907e-03 3 1  ON 68
ci_0070                 4.472831e-03 3 1  ON 69
ci_0071                 2.410444e-03 3 1  ON 70
ci_0072                 2.233944e-03 3 1  ON 71
ci_0073                 4.503465e-03 3 1  ON 72
ci_0074                 4.505108e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1450e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9735
    reference variance = 0.183912
====================================================
  Execution time = 1.4919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3700e-01
  Total weights = 1.951581538e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321784031435
                                         uncertainty =       0.002151423675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321784031435
                                         uncertainty =       0.002151423675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401077573
  error estimate for blocks of size 2^( 2) =       0.000413995006
  error estimate for blocks of size 2^( 3) =       0.000426665547
  error estimate for blocks of size 2^( 4) =       0.000438963966
  error estimate for blocks of size 2^( 5) =       0.000450302177
  error estimate for blocks of size 2^( 6) =       0.000457678292
  error estimate for blocks of size 2^( 7) =       0.000463943524

      target function =                  N/A
              le_mean =     -16.905650112860
             les_mean =     286.138005431721
             stat err =       0.000452721990
             autocorr =       1.274108530328
              std dev =       0.567209342975
             le_variance =       0.321726438758


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565011286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905650112822       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905659715908       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905658886865       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905659117271       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905659043104       residual = 7.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 1.292841e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905650112822       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905653897815       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905653788596       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905653823547       residual = 4.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 5.296857e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905650112822       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905651218437       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905651219988       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905651229466       residual = 1.87e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.9062e+00 is 1.578875e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149942 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7534e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.010746e-01 3 1  ON 0
ci_0002                 7.004616e-01 3 1  ON 1
ci_0003                -2.831867e-02 3 1  ON 2
ci_0004                -2.807261e-02 3 1  ON 3
ci_0005                -3.368335e-02 3 1  ON 4
ci_0006                -3.497625e-02 3 1  ON 5
ci_0007                -2.159163e-02 3 1  ON 6
ci_0008                -2.160263e-02 3 1  ON 7
ci_0009                -1.795547e-02 3 1  ON 8
ci_0010                -1.800077e-02 3 1  ON 9
ci_0011                -1.274133e-02 3 1  ON 10
ci_0012                -1.292331e-02 3 1  ON 11
ci_0013                 1.375091e-02 3 1  ON 12
ci_0014                 1.405077e-02 3 1  ON 13
ci_0015                 1.429982e-02 3 1  ON 14
ci_0016                 1.410903e-02 3 1  ON 15
ci_0017                 1.195666e-02 3 1  ON 16
ci_0018                 1.192024e-02 3 1  ON 17
ci_0019                 1.185783e-02 3 1  ON 18
ci_0020                 1.178088e-02 3 1  ON 19
ci_0021                 2.813700e-03 3 1  ON 20
ci_0022                 4.254699e-03 3 1  ON 21
ci_0023                -1.139378e-02 3 1  ON 22
ci_0024                -1.114603e-02 3 1  ON 23
ci_0025                -1.122526e-02 3 1  ON 24
ci_0026                -1.051948e-02 3 1  ON 25
ci_0027                -1.146932e-02 3 1  ON 26
ci_0028                -1.116317e-02 3 1  ON 27
ci_0029                -1.068872e-02 3 1  ON 28
ci_0030                -1.063910e-02 3 1  ON 29
ci_0031                 1.973520e-02 3 1  ON 30
ci_0032                 2.011304e-02 3 1  ON 31
ci_0033                 1.056961e-02 3 1  ON 32
ci_0034                 1.037930e-02 3 1  ON 33
ci_0035                 6.828434e-03 3 1  ON 34
ci_0036                 6.877929e-03 3 1  ON 35
ci_0037                -1.046436e-02 3 1  ON 36
ci_0038                -1.088500e-02 3 1  ON 37
ci_0039                -2.729830e-03 3 1  ON 38
ci_0040                -2.674432e-03 3 1  ON 39
ci_0041                 7.430333e-03 3 1  ON 40
ci_0042                 7.303093e-03 3 1  ON 41
ci_0043                -1.464359e-02 3 1  ON 42
ci_0044                -1.577758e-02 3 1  ON 43
ci_0045                 7.598424e-03 3 1  ON 44
ci_0046                 7.858483e-03 3 1  ON 45
ci_0047                -2.217439e-03 3 1  ON 46
ci_0048                -2.037631e-03 3 1  ON 47
ci_0049                -5.747918e-03 3 1  ON 48
ci_0050                -6.257247e-03 3 1  ON 49
ci_0051                -3.705288e-03 3 1  ON 50
ci_0052                -3.773871e-03 3 1  ON 51
ci_0053                -4.588835e-03 3 1  ON 52
ci_0054                -4.579492e-03 3 1  ON 53
ci_0055                 6.806201e-03 3 1  ON 54
ci_0056                 6.689316e-03 3 1  ON 55
ci_0057                 4.386618e-03 3 1  ON 56
ci_0058                 4.976362e-03 3 1  ON 57
ci_0059                -4.841807e-03 3 1  ON 58
ci_0060                -4.701532e-03 3 1  ON 59
ci_0061                -3.992428e-03 3 1  ON 60
ci_0062                -3.589361e-03 3 1  ON 61
ci_0063                -8.786746e-03 3 1  ON 62
ci_0064                -7.660499e-03 3 1  ON 63
ci_0065                -5.484795e-03 3 1  ON 64
ci_0066                -5.524660e-03 3 1  ON 65
ci_0067                -5.513303e-03 3 1  ON 66
ci_0068                -5.419804e-03 3 1  ON 67
ci_0069                 4.750456e-03 3 1  ON 68
ci_0070                 4.520129e-03 3 1  ON 69
ci_0071                 2.251528e-03 3 1  ON 70
ci_0072                 2.291336e-03 3 1  ON 71
ci_0073                 4.543078e-03 3 1  ON 72
ci_0074                 4.521648e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9022
    reference variance = 0.320029
====================================================
  Execution time = 1.4365e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4618e-01
  Total weights = 1.9519e+06
  Execution time = 1.8997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329690620731
                                         uncertainty =       0.006618034159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329690620731
                                         uncertainty =       0.006618034159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405990421
  error estimate for blocks of size 2^( 2) =       0.000418721452
  error estimate for blocks of size 2^( 3) =       0.000431551660
  error estimate for blocks of size 2^( 4) =       0.000443823069
  error estimate for blocks of size 2^( 5) =       0.000454502080
  error estimate for blocks of size 2^( 6) =       0.000461379070
  error estimate for blocks of size 2^( 7) =       0.000466639946

      target function =                  N/A
              le_mean =     -16.907585363814
             les_mean =     286.215285653061
             stat err =       0.000456586041
             autocorr =       1.264776204944
              std dev =       0.574157159847
             le_variance =       0.329656444204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329623820335
                                         uncertainty =       0.006823465209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329623820335
                                         uncertainty =       0.006823465209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405948196
  error estimate for blocks of size 2^( 2) =       0.000418690512
  error estimate for blocks of size 2^( 3) =       0.000431511869
  error estimate for blocks of size 2^( 4) =       0.000443793732
  error estimate for blocks of size 2^( 5) =       0.000454488691
  error estimate for blocks of size 2^( 6) =       0.000461378717
  error estimate for blocks of size 2^( 7) =       0.000466694202

      target function =                  N/A
              le_mean =     -16.907600036922
             les_mean =     286.214526809454
             stat err =       0.000456588835
             autocorr =       1.265054815406
              std dev =       0.574097444333
             le_variance =       0.329587875589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329585806627
                                         uncertainty =       0.006745572648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329585806627
                                         uncertainty =       0.006745572648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405925126
  error estimate for blocks of size 2^( 2) =       0.000418665950
  error estimate for blocks of size 2^( 3) =       0.000431488426
  error estimate for blocks of size 2^( 4) =       0.000443769912
  error estimate for blocks of size 2^( 5) =       0.000454462544
  error estimate for blocks of size 2^( 6) =       0.000461345618
  error estimate for blocks of size 2^( 7) =       0.000466652432

      target function =                  N/A
              le_mean =     -16.907592389819
             les_mean =     286.213726572908
             stat err =       0.000456557627
             autocorr =       1.265025660495
              std dev =       0.574064818870
             le_variance =       0.329550416264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329800236189
                                         uncertainty =       0.006628150606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329800236189
                                         uncertainty =       0.006628150606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406057823
  error estimate for blocks of size 2^( 2) =       0.000418780360
  error estimate for blocks of size 2^( 3) =       0.000431590984
  error estimate for blocks of size 2^( 4) =       0.000443859752
  error estimate for blocks of size 2^( 5) =       0.000454532681
  error estimate for blocks of size 2^( 6) =       0.000461457622
  error estimate for blocks of size 2^( 7) =       0.000466706925

      target function =                  N/A
              le_mean =     -16.907576128485
             les_mean =     286.449762735948
             stat err =       0.000456639245
             autocorr =       1.264651034886
              std dev =       0.574252479735
             le_variance =       0.329765910482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907585363814        initial
     2.4414e-01     2.4414e+00             1.2928e-03       -16.907600036922  <--
     9.7656e-01     9.7656e+00             5.2969e-04       -16.907592389819
     3.9062e+00     3.9062e+01             1.5789e-04       -16.907576128485

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.3953e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_0001                 7.007364e-01 3 1  ON 0
ci_0002                 7.008040e-01 3 1  ON 1
ci_0003                -2.795030e-02 3 1  ON 2
ci_0004                -2.880006e-02 3 1  ON 3
ci_0005                -3.368251e-02 3 1  ON 4
ci_0006                -3.503870e-02 3 1  ON 5
ci_0007                -2.151951e-02 3 1  ON 6
ci_0008                -2.155815e-02 3 1  ON 7
ci_0009                -1.805583e-02 3 1  ON 8
ci_0010                -1.826864e-02 3 1  ON 9
ci_0011                -1.267073e-02 3 1  ON 10
ci_0012                -1.218923e-02 3 1  ON 11
ci_0013                 1.393548e-02 3 1  ON 12
ci_0014                 1.402728e-02 3 1  ON 13
ci_0015                 1.451817e-02 3 1  ON 14
ci_0016                 1.399500e-02 3 1  ON 15
ci_0017                 1.204990e-02 3 1  ON 16
ci_0018                 1.203801e-02 3 1  ON 17
ci_0019                 1.177911e-02 3 1  ON 18
ci_0020                 1.196081e-02 3 1  ON 19
ci_0021                 2.659404e-03 3 1  ON 20
ci_0022                 4.125687e-03 3 1  ON 21
ci_0023                -1.136803e-02 3 1  ON 22
ci_0024                -1.123724e-02 3 1  ON 23
ci_0025                -1.107280e-02 3 1  ON 24
ci_0026                -1.041431e-02 3 1  ON 25
ci_0027                -1.121473e-02 3 1  ON 26
ci_0028                -1.161422e-02 3 1  ON 27
ci_0029                -1.083727e-02 3 1  ON 28
ci_0030                -1.046612e-02 3 1  ON 29
ci_0031                 1.971550e-02 3 1  ON 30
ci_0032                 2.023775e-02 3 1  ON 31
ci_0033                 1.061147e-02 3 1  ON 32
ci_0034                 1.036846e-02 3 1  ON 33
ci_0035                 6.540590e-03 3 1  ON 34
ci_0036                 6.447806e-03 3 1  ON 35
ci_0037                -1.062874e-02 3 1  ON 36
ci_0038                -1.131202e-02 3 1  ON 37
ci_0039                -2.564206e-03 3 1  ON 38
ci_0040                -2.762911e-03 3 1  ON 39
ci_0041                 7.320937e-03 3 1  ON 40
ci_0042                 6.934850e-03 3 1  ON 41
ci_0043                -1.455770e-02 3 1  ON 42
ci_0044                -1.547991e-02 3 1  ON 43
ci_0045                 7.752764e-03 3 1  ON 44
ci_0046                 7.831417e-03 3 1  ON 45
ci_0047                -2.271619e-03 3 1  ON 46
ci_0048                -1.926532e-03 3 1  ON 47
ci_0049                -5.967658e-03 3 1  ON 48
ci_0050                -6.623657e-03 3 1  ON 49
ci_0051                -3.831085e-03 3 1  ON 50
ci_0052                -3.986416e-03 3 1  ON 51
ci_0053                -4.464510e-03 3 1  ON 52
ci_0054                -4.074055e-03 3 1  ON 53
ci_0055                 6.711717e-03 3 1  ON 54
ci_0056                 6.459164e-03 3 1  ON 55
ci_0057                 4.230238e-03 3 1  ON 56
ci_0058                 4.739614e-03 3 1  ON 57
ci_0059                -4.709356e-03 3 1  ON 58
ci_0060                -4.245868e-03 3 1  ON 59
ci_0061                -4.684946e-03 3 1  ON 60
ci_0062                -3.382286e-03 3 1  ON 61
ci_0063                -8.942109e-03 3 1  ON 62
ci_0064                -6.897343e-03 3 1  ON 63
ci_0065                -5.226746e-03 3 1  ON 64
ci_0066                -5.561512e-03 3 1  ON 65
ci_0067                -5.370242e-03 3 1  ON 66
ci_0068                -5.770031e-03 3 1  ON 67
ci_0069                 4.861310e-03 3 1  ON 68
ci_0070                 4.580382e-03 3 1  ON 69
ci_0071                 1.990915e-03 3 1  ON 70
ci_0072                 2.382163e-03 3 1  ON 71
ci_0073                 4.590349e-03 3 1  ON 72
ci_0074                 4.547819e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9064
    reference variance = 0.306193
====================================================
  Execution time = 1.4763e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3406e-01
  Total weights = 1.951745156e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320971901246
                                         uncertainty =       0.002016444954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320971901246
                                         uncertainty =       0.002016444954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400539885
  error estimate for blocks of size 2^( 2) =       0.000413394554
  error estimate for blocks of size 2^( 3) =       0.000426083679
  error estimate for blocks of size 2^( 4) =       0.000437815040
  error estimate for blocks of size 2^( 5) =       0.000448023085
  error estimate for blocks of size 2^( 6) =       0.000455317052
  error estimate for blocks of size 2^( 7) =       0.000460253057

      target function =                  N/A
              le_mean =     -16.906264569672
             les_mean =     286.155841171992
             stat err =       0.000450352058
             autocorr =       1.264191212565
              std dev =       0.566448937137
             le_variance =       0.320864398384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626456967e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906264569698       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304785182       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906299364626       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906297696081       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906297323383       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906297326274       residual = 9.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-02 is 1.752971e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906264569698       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906289417980       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287074872       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906286813079       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e-01 is 8.760662e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906264569698       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906274397000       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273982642       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273956365       residual = 1.56e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e-01 is 3.729993e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7363e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.006541e-01 3 1  ON 0
ci_0002                 7.009468e-01 3 1  ON 1
ci_0003                -2.791973e-02 3 1  ON 2
ci_0004                -2.846596e-02 3 1  ON 3
ci_0005                -3.356165e-02 3 1  ON 4
ci_0006                -3.456234e-02 3 1  ON 5
ci_0007                -2.221492e-02 3 1  ON 6
ci_0008                -2.212544e-02 3 1  ON 7
ci_0009                -1.788615e-02 3 1  ON 8
ci_0010                -1.772063e-02 3 1  ON 9
ci_0011                -1.290263e-02 3 1  ON 10
ci_0012                -1.254309e-02 3 1  ON 11
ci_0013                 1.366386e-02 3 1  ON 12
ci_0014                 1.378992e-02 3 1  ON 13
ci_0015                 1.447103e-02 3 1  ON 14
ci_0016                 1.360085e-02 3 1  ON 15
ci_0017                 1.160867e-02 3 1  ON 16
ci_0018                 1.194043e-02 3 1  ON 17
ci_0019                 1.140233e-02 3 1  ON 18
ci_0020                 1.153450e-02 3 1  ON 19
ci_0021                 2.866089e-03 3 1  ON 20
ci_0022                 4.382273e-03 3 1  ON 21
ci_0023                -1.146289e-02 3 1  ON 22
ci_0024                -1.141891e-02 3 1  ON 23
ci_0025                -1.109719e-02 3 1  ON 24
ci_0026                -1.025103e-02 3 1  ON 25
ci_0027                -1.157772e-02 3 1  ON 26
ci_0028                -1.124888e-02 3 1  ON 27
ci_0029                -1.040044e-02 3 1  ON 28
ci_0030                -1.069985e-02 3 1  ON 29
ci_0031                 1.965338e-02 3 1  ON 30
ci_0032                 2.046559e-02 3 1  ON 31
ci_0033                 1.060680e-02 3 1  ON 32
ci_0034                 9.539948e-03 3 1  ON 33
ci_0035                 6.329450e-03 3 1  ON 34
ci_0036                 6.701866e-03 3 1  ON 35
ci_0037                -1.036519e-02 3 1  ON 36
ci_0038                -1.116192e-02 3 1  ON 37
ci_0039                -2.423761e-03 3 1  ON 38
ci_0040                -2.739805e-03 3 1  ON 39
ci_0041                 7.508866e-03 3 1  ON 40
ci_0042                 7.274653e-03 3 1  ON 41
ci_0043                -1.498947e-02 3 1  ON 42
ci_0044                -1.531114e-02 3 1  ON 43
ci_0045                 7.634920e-03 3 1  ON 44
ci_0046                 7.712744e-03 3 1  ON 45
ci_0047                -1.879885e-03 3 1  ON 46
ci_0048                -1.675472e-03 3 1  ON 47
ci_0049                -5.802832e-03 3 1  ON 48
ci_0050                -6.200920e-03 3 1  ON 49
ci_0051                -3.528910e-03 3 1  ON 50
ci_0052                -3.708108e-03 3 1  ON 51
ci_0053                -4.855485e-03 3 1  ON 52
ci_0054                -4.950122e-03 3 1  ON 53
ci_0055                 6.471464e-03 3 1  ON 54
ci_0056                 6.310148e-03 3 1  ON 55
ci_0057                 3.869302e-03 3 1  ON 56
ci_0058                 4.734826e-03 3 1  ON 57
ci_0059                -5.022466e-03 3 1  ON 58
ci_0060                -4.598412e-03 3 1  ON 59
ci_0061                -4.128860e-03 3 1  ON 60
ci_0062                -3.602798e-03 3 1  ON 61
ci_0063                -8.889245e-03 3 1  ON 62
ci_0064                -7.707540e-03 3 1  ON 63
ci_0065                -5.547564e-03 3 1  ON 64
ci_0066                -6.093625e-03 3 1  ON 65
ci_0067                -5.383543e-03 3 1  ON 66
ci_0068                -5.443191e-03 3 1  ON 67
ci_0069                 4.417310e-03 3 1  ON 68
ci_0070                 4.623489e-03 3 1  ON 69
ci_0071                 2.148903e-03 3 1  ON 70
ci_0072                 2.262019e-03 3 1  ON 71
ci_0073                 4.530931e-03 3 1  ON 72
ci_0074                 4.478983e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8779
    reference variance = 0.244875
====================================================
  Execution time = 1.4467e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3064e-01
  Total weights = 1.9518e+06
  Execution time = 1.9146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491142153
                                         uncertainty =       0.002187047191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491142153
                                         uncertainty =       0.002187047191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399019464
  error estimate for blocks of size 2^( 2) =       0.000412098516
  error estimate for blocks of size 2^( 3) =       0.000425023354
  error estimate for blocks of size 2^( 4) =       0.000436600925
  error estimate for blocks of size 2^( 5) =       0.000447358388
  error estimate for blocks of size 2^( 6) =       0.000455515372
  error estimate for blocks of size 2^( 7) =       0.000458540693

      target function =                  N/A
              le_mean =     -16.906775231994
             les_mean =     286.251687493437
             stat err =       0.000449503845
             autocorr =       1.269049787293
              std dev =       0.564298737069
             le_variance =       0.318433064657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317869441610
                                         uncertainty =       0.002111682925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317869441610
                                         uncertainty =       0.002111682925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398632581
  error estimate for blocks of size 2^( 2) =       0.000411710954
  error estimate for blocks of size 2^( 3) =       0.000424624419
  error estimate for blocks of size 2^( 4) =       0.000436187789
  error estimate for blocks of size 2^( 5) =       0.000446913509
  error estimate for blocks of size 2^( 6) =       0.000455089209
  error estimate for blocks of size 2^( 7) =       0.000458150608

      target function =                  N/A
              le_mean =     -16.906752573708
             les_mean =     286.173948016928
             stat err =       0.000449085278
             autocorr =       1.269147368033
              std dev =       0.563751602892
             le_variance =       0.317815869763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317820082951
                                         uncertainty =       0.002109366298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317820082951
                                         uncertainty =       0.002109366298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398601545
  error estimate for blocks of size 2^( 2) =       0.000411683720
  error estimate for blocks of size 2^( 3) =       0.000424603660
  error estimate for blocks of size 2^( 4) =       0.000436167655
  error estimate for blocks of size 2^( 5) =       0.000446878699
  error estimate for blocks of size 2^( 6) =       0.000455055313
  error estimate for blocks of size 2^( 7) =       0.000458096969

      target function =                  N/A
              le_mean =     -16.906760061444
             les_mean =     286.173113052101
             stat err =       0.000449049659
             autocorr =       1.269143662245
              std dev =       0.563707711533
             le_variance =       0.317766384042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317745240819
                                         uncertainty =       0.002087641734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317745240819
                                         uncertainty =       0.002087641734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398555429
  error estimate for blocks of size 2^( 2) =       0.000411646310
  error estimate for blocks of size 2^( 3) =       0.000424578013
  error estimate for blocks of size 2^( 4) =       0.000436153770
  error estimate for blocks of size 2^( 5) =       0.000446916337
  error estimate for blocks of size 2^( 6) =       0.000455100585
  error estimate for blocks of size 2^( 7) =       0.000458137412

      target function =                  N/A
              le_mean =     -16.906745914691
             les_mean =     286.168850829190
             stat err =       0.000449077026
             autocorr =       1.269592117947
              std dev =       0.563642492479
             le_variance =       0.317692859328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906775231994        initial  <--
     6.1035e-02     6.1035e-01             1.7530e-03       -16.906752573708
     2.4414e-01     2.4414e+00             8.7607e-04       -16.906760061444
     9.7656e-01     9.7656e+00             3.7300e-04       -16.906745914691

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1190
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_0001                 7.007364e-01 3 1  ON 0
ci_0002                 7.008040e-01 3 1  ON 1
ci_0003                -2.795030e-02 3 1  ON 2
ci_0004                -2.880006e-02 3 1  ON 3
ci_0005                -3.368251e-02 3 1  ON 4
ci_0006                -3.503870e-02 3 1  ON 5
ci_0007                -2.151951e-02 3 1  ON 6
ci_0008                -2.155815e-02 3 1  ON 7
ci_0009                -1.805583e-02 3 1  ON 8
ci_0010                -1.826864e-02 3 1  ON 9
ci_0011                -1.267073e-02 3 1  ON 10
ci_0012                -1.218923e-02 3 1  ON 11
ci_0013                 1.393548e-02 3 1  ON 12
ci_0014                 1.402728e-02 3 1  ON 13
ci_0015                 1.451817e-02 3 1  ON 14
ci_0016                 1.399500e-02 3 1  ON 15
ci_0017                 1.204990e-02 3 1  ON 16
ci_0018                 1.203801e-02 3 1  ON 17
ci_0019                 1.177911e-02 3 1  ON 18
ci_0020                 1.196081e-02 3 1  ON 19
ci_0021                 2.659404e-03 3 1  ON 20
ci_0022                 4.125687e-03 3 1  ON 21
ci_0023                -1.136803e-02 3 1  ON 22
ci_0024                -1.123724e-02 3 1  ON 23
ci_0025                -1.107280e-02 3 1  ON 24
ci_0026                -1.041431e-02 3 1  ON 25
ci_0027                -1.121473e-02 3 1  ON 26
ci_0028                -1.161422e-02 3 1  ON 27
ci_0029                -1.083727e-02 3 1  ON 28
ci_0030                -1.046612e-02 3 1  ON 29
ci_0031                 1.971550e-02 3 1  ON 30
ci_0032                 2.023775e-02 3 1  ON 31
ci_0033                 1.061147e-02 3 1  ON 32
ci_0034                 1.036846e-02 3 1  ON 33
ci_0035                 6.540590e-03 3 1  ON 34
ci_0036                 6.447806e-03 3 1  ON 35
ci_0037                -1.062874e-02 3 1  ON 36
ci_0038                -1.131202e-02 3 1  ON 37
ci_0039                -2.564206e-03 3 1  ON 38
ci_0040                -2.762911e-03 3 1  ON 39
ci_0041                 7.320937e-03 3 1  ON 40
ci_0042                 6.934850e-03 3 1  ON 41
ci_0043                -1.455770e-02 3 1  ON 42
ci_0044                -1.547991e-02 3 1  ON 43
ci_0045                 7.752764e-03 3 1  ON 44
ci_0046                 7.831417e-03 3 1  ON 45
ci_0047                -2.271619e-03 3 1  ON 46
ci_0048                -1.926532e-03 3 1  ON 47
ci_0049                -5.967658e-03 3 1  ON 48
ci_0050                -6.623657e-03 3 1  ON 49
ci_0051                -3.831085e-03 3 1  ON 50
ci_0052                -3.986416e-03 3 1  ON 51
ci_0053                -4.464510e-03 3 1  ON 52
ci_0054                -4.074055e-03 3 1  ON 53
ci_0055                 6.711717e-03 3 1  ON 54
ci_0056                 6.459164e-03 3 1  ON 55
ci_0057                 4.230238e-03 3 1  ON 56
ci_0058                 4.739614e-03 3 1  ON 57
ci_0059                -4.709356e-03 3 1  ON 58
ci_0060                -4.245868e-03 3 1  ON 59
ci_0061                -4.684946e-03 3 1  ON 60
ci_0062                -3.382286e-03 3 1  ON 61
ci_0063                -8.942109e-03 3 1  ON 62
ci_0064                -6.897343e-03 3 1  ON 63
ci_0065                -5.226746e-03 3 1  ON 64
ci_0066                -5.561512e-03 3 1  ON 65
ci_0067                -5.370242e-03 3 1  ON 66
ci_0068                -5.770031e-03 3 1  ON 67
ci_0069                 4.861310e-03 3 1  ON 68
ci_0070                 4.580382e-03 3 1  ON 69
ci_0071                 1.990915e-03 3 1  ON 70
ci_0072                 2.382163e-03 3 1  ON 71
ci_0073                 4.590349e-03 3 1  ON 72
ci_0074                 4.547819e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1494e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9713
    reference variance = 0.219507
====================================================
  Execution time = 1.4709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3715e-01
  Total weights = 1.952166479e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6057e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323285667074
                                         uncertainty =       0.002407575774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323285667074
                                         uncertainty =       0.002407575774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402028067
  error estimate for blocks of size 2^( 2) =       0.000414976216
  error estimate for blocks of size 2^( 3) =       0.000428064708
  error estimate for blocks of size 2^( 4) =       0.000440044146
  error estimate for blocks of size 2^( 5) =       0.000449705136
  error estimate for blocks of size 2^( 6) =       0.000458088133
  error estimate for blocks of size 2^( 7) =       0.000461679222

      target function =                  N/A
              le_mean =     -16.907180274475
             les_mean =     286.189898253438
             stat err =       0.000452379160
             autocorr =       1.266171199113
              std dev =       0.568553545190
             le_variance =       0.323253133749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690718027448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907180274487       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907190672013       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907189842411       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907189949885       residual = 9.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 6.038766e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907180274487       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907183505792       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907183262461       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907183294589       residual = 3.78e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 1.982402e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907180274487       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907181134587       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907181073944       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907181081014       residual = 4.81e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 5.375710e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.152661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7321e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.007354e-01 3 1  ON 0
ci_0002                 7.008260e-01 3 1  ON 1
ci_0003                -2.794749e-02 3 1  ON 2
ci_0004                -2.873625e-02 3 1  ON 3
ci_0005                -3.370110e-02 3 1  ON 4
ci_0006                -3.502863e-02 3 1  ON 5
ci_0007                -2.154899e-02 3 1  ON 6
ci_0008                -2.154245e-02 3 1  ON 7
ci_0009                -1.801387e-02 3 1  ON 8
ci_0010                -1.821049e-02 3 1  ON 9
ci_0011                -1.260300e-02 3 1  ON 10
ci_0012                -1.218947e-02 3 1  ON 11
ci_0013                 1.384866e-02 3 1  ON 12
ci_0014                 1.399214e-02 3 1  ON 13
ci_0015                 1.444532e-02 3 1  ON 14
ci_0016                 1.394506e-02 3 1  ON 15
ci_0017                 1.209255e-02 3 1  ON 16
ci_0018                 1.200269e-02 3 1  ON 17
ci_0019                 1.177016e-02 3 1  ON 18
ci_0020                 1.192758e-02 3 1  ON 19
ci_0021                 2.574982e-03 3 1  ON 20
ci_0022                 4.052096e-03 3 1  ON 21
ci_0023                -1.135853e-02 3 1  ON 22
ci_0024                -1.126146e-02 3 1  ON 23
ci_0025                -1.098770e-02 3 1  ON 24
ci_0026                -1.033683e-02 3 1  ON 25
ci_0027                -1.126572e-02 3 1  ON 26
ci_0028                -1.159071e-02 3 1  ON 27
ci_0029                -1.071540e-02 3 1  ON 28
ci_0030                -1.050578e-02 3 1  ON 29
ci_0031                 1.965111e-02 3 1  ON 30
ci_0032                 2.015027e-02 3 1  ON 31
ci_0033                 1.054551e-02 3 1  ON 32
ci_0034                 1.035665e-02 3 1  ON 33
ci_0035                 6.495869e-03 3 1  ON 34
ci_0036                 6.411715e-03 3 1  ON 35
ci_0037                -1.060903e-02 3 1  ON 36
ci_0038                -1.128775e-02 3 1  ON 37
ci_0039                -2.573348e-03 3 1  ON 38
ci_0040                -2.816092e-03 3 1  ON 39
ci_0041                 7.367843e-03 3 1  ON 40
ci_0042                 6.956748e-03 3 1  ON 41
ci_0043                -1.456315e-02 3 1  ON 42
ci_0044                -1.556706e-02 3 1  ON 43
ci_0045                 7.603515e-03 3 1  ON 44
ci_0046                 7.848541e-03 3 1  ON 45
ci_0047                -2.227377e-03 3 1  ON 46
ci_0048                -1.898865e-03 3 1  ON 47
ci_0049                -5.860908e-03 3 1  ON 48
ci_0050                -6.549134e-03 3 1  ON 49
ci_0051                -3.889069e-03 3 1  ON 50
ci_0052                -3.992012e-03 3 1  ON 51
ci_0053                -4.536814e-03 3 1  ON 52
ci_0054                -4.114273e-03 3 1  ON 53
ci_0055                 6.720891e-03 3 1  ON 54
ci_0056                 6.450771e-03 3 1  ON 55
ci_0057                 4.152806e-03 3 1  ON 56
ci_0058                 4.812074e-03 3 1  ON 57
ci_0059                -4.720282e-03 3 1  ON 58
ci_0060                -4.232451e-03 3 1  ON 59
ci_0061                -4.568607e-03 3 1  ON 60
ci_0062                -3.418316e-03 3 1  ON 61
ci_0063                -8.832646e-03 3 1  ON 62
ci_0064                -7.095583e-03 3 1  ON 63
ci_0065                -5.288707e-03 3 1  ON 64
ci_0066                -5.633896e-03 3 1  ON 65
ci_0067                -5.349977e-03 3 1  ON 66
ci_0068                -5.770975e-03 3 1  ON 67
ci_0069                 4.779176e-03 3 1  ON 68
ci_0070                 4.524581e-03 3 1  ON 69
ci_0071                 1.987690e-03 3 1  ON 70
ci_0072                 2.397043e-03 3 1  ON 71
ci_0073                 4.598586e-03 3 1  ON 72
ci_0074                 4.604040e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9957
    reference variance = 0.321062
====================================================
  Execution time = 1.4572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3473e-01
  Total weights = 1.9518e+06
  Execution time = 1.9100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00178023
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321766429024
                                         uncertainty =       0.002424823717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321766429024
                                         uncertainty =       0.002424823717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401067923
  error estimate for blocks of size 2^( 2) =       0.000414115655
  error estimate for blocks of size 2^( 3) =       0.000427310082
  error estimate for blocks of size 2^( 4) =       0.000440004284
  error estimate for blocks of size 2^( 5) =       0.000450460497
  error estimate for blocks of size 2^( 6) =       0.000459246202
  error estimate for blocks of size 2^( 7) =       0.000464380076

      target function =                  N/A
              le_mean =     -16.905789723584
             les_mean =     286.140916000394
             stat err =       0.000453522765
             autocorr =       1.278681331801
              std dev =       0.567195696524
             le_variance =       0.321710958155

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000233592
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647074061
                                         uncertainty =       0.002454987851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647074061
                                         uncertainty =       0.002454987851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400993585
  error estimate for blocks of size 2^( 2) =       0.000414035241
  error estimate for blocks of size 2^( 3) =       0.000427239022
  error estimate for blocks of size 2^( 4) =       0.000439924655
  error estimate for blocks of size 2^( 5) =       0.000450335510
  error estimate for blocks of size 2^( 6) =       0.000459166978
  error estimate for blocks of size 2^( 7) =       0.000464290736

      target function =                  N/A
              le_mean =     -16.905789977957
             les_mean =     286.323842977665
             stat err =       0.000453429470
             autocorr =       1.278629252092
              std dev =       0.567090566268
             le_variance =       0.321591710350

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00179698
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321598825184
                                         uncertainty =       0.002435077948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321598825184
                                         uncertainty =       0.002435077948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400963519
  error estimate for blocks of size 2^( 2) =       0.000414016905
  error estimate for blocks of size 2^( 3) =       0.000427216756
  error estimate for blocks of size 2^( 4) =       0.000439906423
  error estimate for blocks of size 2^( 5) =       0.000450368274
  error estimate for blocks of size 2^( 6) =       0.000459169353
  error estimate for blocks of size 2^( 7) =       0.000464299112

      target function =                  N/A
              le_mean =     -16.905793565583
             les_mean =     286.140354699583
             stat err =       0.000453435791
             autocorr =       1.278856670232
              std dev =       0.567048046195
             le_variance =       0.321543486693

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00515226
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321741616435
                                         uncertainty =       0.002426190370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321741616435
                                         uncertainty =       0.002426190370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401052468
  error estimate for blocks of size 2^( 2) =       0.000414100897
  error estimate for blocks of size 2^( 3) =       0.000427295927
  error estimate for blocks of size 2^( 4) =       0.000439989772
  error estimate for blocks of size 2^( 5) =       0.000450447794
  error estimate for blocks of size 2^( 6) =       0.000459235240
  error estimate for blocks of size 2^( 7) =       0.000464364884

      target function =                  N/A
              le_mean =     -16.905789565441
             les_mean =     286.155394281191
             stat err =       0.000453509422
             autocorr =       1.278704645999
              std dev =       0.567173839099
             le_variance =       0.321686163758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905789723584        initial
     6.1035e-01     6.1035e+00             6.0388e-04       -16.905789977957
     2.4414e+00     2.4414e+01             1.9824e-04       -16.905793565583  <--
     9.7656e+00     9.7656e+01             5.3757e-05       -16.905789565441

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.4255e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_0001                 7.007354e-01 3 1  ON 0
ci_0002                 7.008260e-01 3 1  ON 1
ci_0003                -2.794749e-02 3 1  ON 2
ci_0004                -2.873625e-02 3 1  ON 3
ci_0005                -3.370110e-02 3 1  ON 4
ci_0006                -3.502863e-02 3 1  ON 5
ci_0007                -2.154899e-02 3 1  ON 6
ci_0008                -2.154245e-02 3 1  ON 7
ci_0009                -1.801387e-02 3 1  ON 8
ci_0010                -1.821049e-02 3 1  ON 9
ci_0011                -1.260300e-02 3 1  ON 10
ci_0012                -1.218947e-02 3 1  ON 11
ci_0013                 1.384866e-02 3 1  ON 12
ci_0014                 1.399214e-02 3 1  ON 13
ci_0015                 1.444532e-02 3 1  ON 14
ci_0016                 1.394506e-02 3 1  ON 15
ci_0017                 1.209255e-02 3 1  ON 16
ci_0018                 1.200269e-02 3 1  ON 17
ci_0019                 1.177016e-02 3 1  ON 18
ci_0020                 1.192758e-02 3 1  ON 19
ci_0021                 2.574982e-03 3 1  ON 20
ci_0022                 4.052096e-03 3 1  ON 21
ci_0023                -1.135853e-02 3 1  ON 22
ci_0024                -1.126146e-02 3 1  ON 23
ci_0025                -1.098770e-02 3 1  ON 24
ci_0026                -1.033683e-02 3 1  ON 25
ci_0027                -1.126572e-02 3 1  ON 26
ci_0028                -1.159071e-02 3 1  ON 27
ci_0029                -1.071540e-02 3 1  ON 28
ci_0030                -1.050578e-02 3 1  ON 29
ci_0031                 1.965111e-02 3 1  ON 30
ci_0032                 2.015027e-02 3 1  ON 31
ci_0033                 1.054551e-02 3 1  ON 32
ci_0034                 1.035665e-02 3 1  ON 33
ci_0035                 6.495869e-03 3 1  ON 34
ci_0036                 6.411715e-03 3 1  ON 35
ci_0037                -1.060903e-02 3 1  ON 36
ci_0038                -1.128775e-02 3 1  ON 37
ci_0039                -2.573348e-03 3 1  ON 38
ci_0040                -2.816092e-03 3 1  ON 39
ci_0041                 7.367843e-03 3 1  ON 40
ci_0042                 6.956748e-03 3 1  ON 41
ci_0043                -1.456315e-02 3 1  ON 42
ci_0044                -1.556706e-02 3 1  ON 43
ci_0045                 7.603515e-03 3 1  ON 44
ci_0046                 7.848541e-03 3 1  ON 45
ci_0047                -2.227377e-03 3 1  ON 46
ci_0048                -1.898865e-03 3 1  ON 47
ci_0049                -5.860908e-03 3 1  ON 48
ci_0050                -6.549134e-03 3 1  ON 49
ci_0051                -3.889069e-03 3 1  ON 50
ci_0052                -3.992012e-03 3 1  ON 51
ci_0053                -4.536814e-03 3 1  ON 52
ci_0054                -4.114273e-03 3 1  ON 53
ci_0055                 6.720891e-03 3 1  ON 54
ci_0056                 6.450771e-03 3 1  ON 55
ci_0057                 4.152806e-03 3 1  ON 56
ci_0058                 4.812074e-03 3 1  ON 57
ci_0059                -4.720282e-03 3 1  ON 58
ci_0060                -4.232451e-03 3 1  ON 59
ci_0061                -4.568607e-03 3 1  ON 60
ci_0062                -3.418316e-03 3 1  ON 61
ci_0063                -8.832646e-03 3 1  ON 62
ci_0064                -7.095583e-03 3 1  ON 63
ci_0065                -5.288707e-03 3 1  ON 64
ci_0066                -5.633896e-03 3 1  ON 65
ci_0067                -5.349977e-03 3 1  ON 66
ci_0068                -5.770975e-03 3 1  ON 67
ci_0069                 4.779176e-03 3 1  ON 68
ci_0070                 4.524581e-03 3 1  ON 69
ci_0071                 1.987690e-03 3 1  ON 70
ci_0072                 2.397043e-03 3 1  ON 71
ci_0073                 4.598586e-03 3 1  ON 72
ci_0074                 4.604040e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8453
    reference variance = 0.39964
====================================================
  Execution time = 1.7080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2935e-01
  Total weights = 1.951891947e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6143e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317791873075
                                         uncertainty =       0.002321542502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317791873075
                                         uncertainty =       0.002321542502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398746914
  error estimate for blocks of size 2^( 2) =       0.000411380022
  error estimate for blocks of size 2^( 3) =       0.000423594538
  error estimate for blocks of size 2^( 4) =       0.000434452913
  error estimate for blocks of size 2^( 5) =       0.000444962159
  error estimate for blocks of size 2^( 6) =       0.000451485195
  error estimate for blocks of size 2^( 7) =       0.000456747571

      target function =                  N/A
              le_mean =     -16.906899563088
             les_mean =     286.172598816210
             stat err =       0.000446911959
             autocorr =       1.256172506639
              std dev =       0.563913293157
             le_variance =       0.317998202199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689956309e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906899563123       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906903398139       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906903885968       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906903787137       residual = 8.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 8.278636e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906899563123       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906900768072       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906900916062       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906900908212       residual = 3.94e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 2.720241e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906899563123       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906899885025       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906899923847       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906899923985       residual = 4.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.7656e+00 is 7.377356e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.154000 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9726e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.007895e-01 3 1  ON 0
ci_0002                 7.007784e-01 3 1  ON 1
ci_0003                -2.803000e-02 3 1  ON 2
ci_0004                -2.873057e-02 3 1  ON 3
ci_0005                -3.375260e-02 3 1  ON 4
ci_0006                -3.501645e-02 3 1  ON 5
ci_0007                -2.160389e-02 3 1  ON 6
ci_0008                -2.145535e-02 3 1  ON 7
ci_0009                -1.800221e-02 3 1  ON 8
ci_0010                -1.824152e-02 3 1  ON 9
ci_0011                -1.262469e-02 3 1  ON 10
ci_0012                -1.224937e-02 3 1  ON 11
ci_0013                 1.381108e-02 3 1  ON 12
ci_0014                 1.388983e-02 3 1  ON 13
ci_0015                 1.446052e-02 3 1  ON 14
ci_0016                 1.387742e-02 3 1  ON 15
ci_0017                 1.202185e-02 3 1  ON 16
ci_0018                 1.201139e-02 3 1  ON 17
ci_0019                 1.174643e-02 3 1  ON 18
ci_0020                 1.195746e-02 3 1  ON 19
ci_0021                 2.557600e-03 3 1  ON 20
ci_0022                 4.004730e-03 3 1  ON 21
ci_0023                -1.136480e-02 3 1  ON 22
ci_0024                -1.122929e-02 3 1  ON 23
ci_0025                -1.092794e-02 3 1  ON 24
ci_0026                -1.028758e-02 3 1  ON 25
ci_0027                -1.129570e-02 3 1  ON 26
ci_0028                -1.150514e-02 3 1  ON 27
ci_0029                -1.070507e-02 3 1  ON 28
ci_0030                -1.041743e-02 3 1  ON 29
ci_0031                 1.952993e-02 3 1  ON 30
ci_0032                 2.009580e-02 3 1  ON 31
ci_0033                 1.048477e-02 3 1  ON 32
ci_0034                 1.029963e-02 3 1  ON 33
ci_0035                 6.458742e-03 3 1  ON 34
ci_0036                 6.365764e-03 3 1  ON 35
ci_0037                -1.066410e-02 3 1  ON 36
ci_0038                -1.125661e-02 3 1  ON 37
ci_0039                -2.608823e-03 3 1  ON 38
ci_0040                -2.824051e-03 3 1  ON 39
ci_0041                 7.372283e-03 3 1  ON 40
ci_0042                 6.997776e-03 3 1  ON 41
ci_0043                -1.458596e-02 3 1  ON 42
ci_0044                -1.560223e-02 3 1  ON 43
ci_0045                 7.629306e-03 3 1  ON 44
ci_0046                 7.855189e-03 3 1  ON 45
ci_0047                -2.212146e-03 3 1  ON 46
ci_0048                -1.814658e-03 3 1  ON 47
ci_0049                -5.800413e-03 3 1  ON 48
ci_0050                -6.530162e-03 3 1  ON 49
ci_0051                -3.883835e-03 3 1  ON 50
ci_0052                -3.952239e-03 3 1  ON 51
ci_0053                -4.576041e-03 3 1  ON 52
ci_0054                -4.264251e-03 3 1  ON 53
ci_0055                 6.699045e-03 3 1  ON 54
ci_0056                 6.506443e-03 3 1  ON 55
ci_0057                 4.166272e-03 3 1  ON 56
ci_0058                 4.854472e-03 3 1  ON 57
ci_0059                -4.749012e-03 3 1  ON 58
ci_0060                -4.268763e-03 3 1  ON 59
ci_0061                -4.425999e-03 3 1  ON 60
ci_0062                -3.547405e-03 3 1  ON 61
ci_0063                -8.785253e-03 3 1  ON 62
ci_0064                -7.367607e-03 3 1  ON 63
ci_0065                -5.233639e-03 3 1  ON 64
ci_0066                -5.611312e-03 3 1  ON 65
ci_0067                -5.425674e-03 3 1  ON 66
ci_0068                -5.723733e-03 3 1  ON 67
ci_0069                 4.766157e-03 3 1  ON 68
ci_0070                 4.544382e-03 3 1  ON 69
ci_0071                 1.984057e-03 3 1  ON 70
ci_0072                 2.308715e-03 3 1  ON 71
ci_0073                 4.531628e-03 3 1  ON 72
ci_0074                 4.661205e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9185
    reference variance = 0.306033
====================================================
  Execution time = 1.4713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3438e-01
  Total weights = 1.9518e+06
  Execution time = 1.9142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323179118777
                                         uncertainty =       0.002671402035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323179118777
                                         uncertainty =       0.002671402035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401968967
  error estimate for blocks of size 2^( 2) =       0.000415259370
  error estimate for blocks of size 2^( 3) =       0.000428636075
  error estimate for blocks of size 2^( 4) =       0.000441092014
  error estimate for blocks of size 2^( 5) =       0.000453095368
  error estimate for blocks of size 2^( 6) =       0.000460730691
  error estimate for blocks of size 2^( 7) =       0.000466583536

      target function =                  N/A
              le_mean =     -16.905877785556
             les_mean =     286.143277596233
             stat err =       0.000455375402
             autocorr =       1.283376502146
              std dev =       0.568469965424
             le_variance =       0.323158101589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323107082975
                                         uncertainty =       0.002666011930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323107082975
                                         uncertainty =       0.002666011930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401924433
  error estimate for blocks of size 2^( 2) =       0.000415212801
  error estimate for blocks of size 2^( 3) =       0.000428588753
  error estimate for blocks of size 2^( 4) =       0.000441042613
  error estimate for blocks of size 2^( 5) =       0.000453046233
  error estimate for blocks of size 2^( 6) =       0.000460680441
  error estimate for blocks of size 2^( 7) =       0.000466544312

      target function =                  N/A
              le_mean =     -16.905881795774
             les_mean =     286.143890494803
             stat err =       0.000455328400
             autocorr =       1.283395941200
              std dev =       0.568406984777
             le_variance =       0.323086500343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323124450860
                                         uncertainty =       0.002667236616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323124450860
                                         uncertainty =       0.002667236616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401935118
  error estimate for blocks of size 2^( 2) =       0.000415222598
  error estimate for blocks of size 2^( 3) =       0.000428598541
  error estimate for blocks of size 2^( 4) =       0.000441052229
  error estimate for blocks of size 2^( 5) =       0.000453056686
  error estimate for blocks of size 2^( 6) =       0.000460692990
  error estimate for blocks of size 2^( 7) =       0.000466553190

      target function =                  N/A
              le_mean =     -16.905878240594
             les_mean =     286.143753629856
             stat err =       0.000455338774
             autocorr =       1.283386186160
              std dev =       0.568422095655
             le_variance =       0.323103678828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323169182946
                                         uncertainty =       0.002670765011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323169182946
                                         uncertainty =       0.002670765011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401962809
  error estimate for blocks of size 2^( 2) =       0.000415252940
  error estimate for blocks of size 2^( 3) =       0.000428629574
  error estimate for blocks of size 2^( 4) =       0.000441085284
  error estimate for blocks of size 2^( 5) =       0.000453088922
  error estimate for blocks of size 2^( 6) =       0.000460724842
  error estimate for blocks of size 2^( 7) =       0.000466578694

      target function =                  N/A
              le_mean =     -16.905877690949
             les_mean =     286.146552602983
             stat err =       0.000455369435
             autocorr =       1.283382197040
              std dev =       0.568461255393
             le_variance =       0.323148198883


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905877785556        initial
     6.1035e-01     6.1035e+00             8.2786e-04       -16.905881795774  <--
     2.4414e+00     2.4414e+01             2.7202e-04       -16.905878240594
     9.7656e+00     9.7656e+01             7.3774e-05       -16.905877690949

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.4365e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_0001                 7.009494e-01 3 1  ON 0
ci_0002                 7.006352e-01 3 1  ON 1
ci_0003                -2.822192e-02 3 1  ON 2
ci_0004                -2.871032e-02 3 1  ON 3
ci_0005                -3.388038e-02 3 1  ON 4
ci_0006                -3.497897e-02 3 1  ON 5
ci_0007                -2.174654e-02 3 1  ON 6
ci_0008                -2.122215e-02 3 1  ON 7
ci_0009                -1.797792e-02 3 1  ON 8
ci_0010                -1.831426e-02 3 1  ON 9
ci_0011                -1.267466e-02 3 1  ON 10
ci_0012                -1.238648e-02 3 1  ON 11
ci_0013                 1.372695e-02 3 1  ON 12
ci_0014                 1.366393e-02 3 1  ON 13
ci_0015                 1.449609e-02 3 1  ON 14
ci_0016                 1.373073e-02 3 1  ON 15
ci_0017                 1.187062e-02 3 1  ON 16
ci_0018                 1.202949e-02 3 1  ON 17
ci_0019                 1.169186e-02 3 1  ON 18
ci_0020                 1.202283e-02 3 1  ON 19
ci_0021                 2.516934e-03 3 1  ON 20
ci_0022                 3.883429e-03 3 1  ON 21
ci_0023                -1.138093e-02 3 1  ON 22
ci_0024                -1.115931e-02 3 1  ON 23
ci_0025                -1.079621e-02 3 1  ON 24
ci_0026                -1.017724e-02 3 1  ON 25
ci_0027                -1.136193e-02 3 1  ON 26
ci_0028                -1.131592e-02 3 1  ON 27
ci_0029                -1.068482e-02 3 1  ON 28
ci_0030                -1.021995e-02 3 1  ON 29
ci_0031                 1.922646e-02 3 1  ON 30
ci_0032                 1.996288e-02 3 1  ON 31
ci_0033                 1.033400e-02 3 1  ON 32
ci_0034                 1.015793e-02 3 1  ON 33
ci_0035                 6.376158e-03 3 1  ON 34
ci_0036                 6.258279e-03 3 1  ON 35
ci_0037                -1.079554e-02 3 1  ON 36
ci_0038                -1.117170e-02 3 1  ON 37
ci_0039                -2.675624e-03 3 1  ON 38
ci_0040                -2.838421e-03 3 1  ON 39
ci_0041                 7.384897e-03 3 1  ON 40
ci_0042                 7.094854e-03 3 1  ON 41
ci_0043                -1.464341e-02 3 1  ON 42
ci_0044                -1.568733e-02 3 1  ON 43
ci_0045                 7.691342e-03 3 1  ON 44
ci_0046                 7.868402e-03 3 1  ON 45
ci_0047                -2.182994e-03 3 1  ON 46
ci_0048                -1.653706e-03 3 1  ON 47
ci_0049                -5.666560e-03 3 1  ON 48
ci_0050                -6.487548e-03 3 1  ON 49
ci_0051                -3.873887e-03 3 1  ON 50
ci_0052                -3.877380e-03 3 1  ON 51
ci_0053                -4.653084e-03 3 1  ON 52
ci_0054                -4.564185e-03 3 1  ON 53
ci_0055                 6.648587e-03 3 1  ON 54
ci_0056                 6.640339e-03 3 1  ON 55
ci_0057                 4.198724e-03 3 1  ON 56
ci_0058                 4.953088e-03 3 1  ON 57
ci_0059                -4.806342e-03 3 1  ON 58
ci_0060                -4.343740e-03 3 1  ON 59
ci_0061                -4.101783e-03 3 1  ON 60
ci_0062                -3.842196e-03 3 1  ON 61
ci_0063                -8.684724e-03 3 1  ON 62
ci_0064                -7.923447e-03 3 1  ON 63
ci_0065                -5.114390e-03 3 1  ON 64
ci_0066                -5.563517e-03 3 1  ON 65
ci_0067                -5.574775e-03 3 1  ON 66
ci_0068                -5.627031e-03 3 1  ON 67
ci_0069                 4.738582e-03 3 1  ON 68
ci_0070                 4.580908e-03 3 1  ON 69
ci_0071                 1.982678e-03 3 1  ON 70
ci_0072                 2.118013e-03 3 1  ON 71
ci_0073                 4.401442e-03 3 1  ON 72
ci_0074                 4.770494e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4097e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9474
    reference variance = 0.219466
====================================================
  Execution time = 1.4815e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3959e-01
  Total weights = 1.951724304e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325838082533
                                         uncertainty =       0.004220975701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325838082533
                                         uncertainty =       0.004220975701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403618923
  error estimate for blocks of size 2^( 2) =       0.000417028762
  error estimate for blocks of size 2^( 3) =       0.000429799523
  error estimate for blocks of size 2^( 4) =       0.000442240316
  error estimate for blocks of size 2^( 5) =       0.000453562987
  error estimate for blocks of size 2^( 6) =       0.000462831183
  error estimate for blocks of size 2^( 7) =       0.000467597158

      target function =                  N/A
              le_mean =     -16.906184312098
             les_mean =     286.158660308912
             stat err =       0.000456557911
             autocorr =       1.279524797486
              std dev =       0.570803354305
             le_variance =       0.325816469286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618431210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184312117       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194290690       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906195165885       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906196104918       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906195984873       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 4.029344e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184312117       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906188402595       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906189543083       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906189572755       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 1.368104e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906184312117       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906185529413       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906185988146       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906185977755       residual = 1.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.4414e+00 is 3.763944e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7427e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.008648e-01 3 1  ON 0
ci_0002                 7.006550e-01 3 1  ON 1
ci_0003                -2.827593e-02 3 1  ON 2
ci_0004                -2.854426e-02 3 1  ON 3
ci_0005                -3.399858e-02 3 1  ON 4
ci_0006                -3.496964e-02 3 1  ON 5
ci_0007                -2.224046e-02 3 1  ON 6
ci_0008                -2.259026e-02 3 1  ON 7
ci_0009                -1.793538e-02 3 1  ON 8
ci_0010                -1.827649e-02 3 1  ON 9
ci_0011                -1.316767e-02 3 1  ON 10
ci_0012                -1.268453e-02 3 1  ON 11
ci_0013                 1.375004e-02 3 1  ON 12
ci_0014                 1.348144e-02 3 1  ON 13
ci_0015                 1.424015e-02 3 1  ON 14
ci_0016                 1.365361e-02 3 1  ON 15
ci_0017                 1.216922e-02 3 1  ON 16
ci_0018                 1.197955e-02 3 1  ON 17
ci_0019                 1.197272e-02 3 1  ON 18
ci_0020                 1.163549e-02 3 1  ON 19
ci_0021                 2.818673e-03 3 1  ON 20
ci_0022                 3.735564e-03 3 1  ON 21
ci_0023                -1.140372e-02 3 1  ON 22
ci_0024                -1.092008e-02 3 1  ON 23
ci_0025                -1.077093e-02 3 1  ON 24
ci_0026                -1.023508e-02 3 1  ON 25
ci_0027                -1.165248e-02 3 1  ON 26
ci_0028                -1.127248e-02 3 1  ON 27
ci_0029                -1.078111e-02 3 1  ON 28
ci_0030                -1.041377e-02 3 1  ON 29
ci_0031                 1.939113e-02 3 1  ON 30
ci_0032                 1.983934e-02 3 1  ON 31
ci_0033                 1.044991e-02 3 1  ON 32
ci_0034                 1.047998e-02 3 1  ON 33
ci_0035                 7.048917e-03 3 1  ON 34
ci_0036                 6.364010e-03 3 1  ON 35
ci_0037                -1.058910e-02 3 1  ON 36
ci_0038                -1.071652e-02 3 1  ON 37
ci_0039                -2.750782e-03 3 1  ON 38
ci_0040                -2.681588e-03 3 1  ON 39
ci_0041                 7.503485e-03 3 1  ON 40
ci_0042                 7.027084e-03 3 1  ON 41
ci_0043                -1.465930e-02 3 1  ON 42
ci_0044                -1.563724e-02 3 1  ON 43
ci_0045                 7.431981e-03 3 1  ON 44
ci_0046                 7.843704e-03 3 1  ON 45
ci_0047                -2.175547e-03 3 1  ON 46
ci_0048                -2.164458e-03 3 1  ON 47
ci_0049                -5.548817e-03 3 1  ON 48
ci_0050                -6.144648e-03 3 1  ON 49
ci_0051                -3.922472e-03 3 1  ON 50
ci_0052                -3.953444e-03 3 1  ON 51
ci_0053                -4.721901e-03 3 1  ON 52
ci_0054                -4.677814e-03 3 1  ON 53
ci_0055                 6.757669e-03 3 1  ON 54
ci_0056                 6.667174e-03 3 1  ON 55
ci_0057                 3.909364e-03 3 1  ON 56
ci_0058                 5.117550e-03 3 1  ON 57
ci_0059                -4.654569e-03 3 1  ON 58
ci_0060                -4.098947e-03 3 1  ON 59
ci_0061                -3.653110e-03 3 1  ON 60
ci_0062                -3.498264e-03 3 1  ON 61
ci_0063                -8.925956e-03 3 1  ON 62
ci_0064                -8.368985e-03 3 1  ON 63
ci_0065                -5.396218e-03 3 1  ON 64
ci_0066                -5.312851e-03 3 1  ON 65
ci_0067                -5.573381e-03 3 1  ON 66
ci_0068                -5.628548e-03 3 1  ON 67
ci_0069                 4.681431e-03 3 1  ON 68
ci_0070                 4.393732e-03 3 1  ON 69
ci_0071                 2.087709e-03 3 1  ON 70
ci_0072                 2.123378e-03 3 1  ON 71
ci_0073                 4.439440e-03 3 1  ON 72
ci_0074                 4.398871e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8542
    reference variance = 0.166959
====================================================
  Execution time = 1.4340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3447e-01
  Total weights = 1.9517e+06
  Execution time = 1.9142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322270500955
                                         uncertainty =       0.002372092873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322270500955
                                         uncertainty =       0.002372092873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401364087
  error estimate for blocks of size 2^( 2) =       0.000414278921
  error estimate for blocks of size 2^( 3) =       0.000427724384
  error estimate for blocks of size 2^( 4) =       0.000440311923
  error estimate for blocks of size 2^( 5) =       0.000451487443
  error estimate for blocks of size 2^( 6) =       0.000458374190
  error estimate for blocks of size 2^( 7) =       0.000464735083

      target function =                  N/A
              le_mean =     -16.905678015502
             les_mean =     286.151716298792
             stat err =       0.000453727160
             autocorr =       1.277946085326
              std dev =       0.567614535769
             le_variance =       0.322186261216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322497221501
                                         uncertainty =       0.002394856815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322497221501
                                         uncertainty =       0.002394856815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401505615
  error estimate for blocks of size 2^( 2) =       0.000414413011
  error estimate for blocks of size 2^( 3) =       0.000427841025
  error estimate for blocks of size 2^( 4) =       0.000440401003
  error estimate for blocks of size 2^( 5) =       0.000451543688
  error estimate for blocks of size 2^( 6) =       0.000458401182
  error estimate for blocks of size 2^( 7) =       0.000464717822

      target function =                  N/A
              le_mean =     -16.905703352952
             les_mean =     286.139111811849
             stat err =       0.000453765924
             autocorr =       1.277263526973
              std dev =       0.567814686616
             le_variance =       0.322413518337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322416092424
                                         uncertainty =       0.002388297426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322416092424
                                         uncertainty =       0.002388297426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401454798
  error estimate for blocks of size 2^( 2) =       0.000414361374
  error estimate for blocks of size 2^( 3) =       0.000427788003
  error estimate for blocks of size 2^( 4) =       0.000440335484
  error estimate for blocks of size 2^( 5) =       0.000451482792
  error estimate for blocks of size 2^( 6) =       0.000458352362
  error estimate for blocks of size 2^( 7) =       0.000464677688

      target function =                  N/A
              le_mean =     -16.905696463336
             les_mean =     286.174127842731
             stat err =       0.000453712082
             autocorr =       1.277283737292
              std dev =       0.567742819912
             le_variance =       0.322331909562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322159600970
                                         uncertainty =       0.002372855464

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322159600970
                                         uncertainty =       0.002372855464

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401295083
  error estimate for blocks of size 2^( 2) =       0.000414211054
  error estimate for blocks of size 2^( 3) =       0.000427654898
  error estimate for blocks of size 2^( 4) =       0.000440238355
  error estimate for blocks of size 2^( 5) =       0.000451403917
  error estimate for blocks of size 2^( 6) =       0.000458264085
  error estimate for blocks of size 2^( 7) =       0.000464613293

      target function =                  N/A
              le_mean =     -16.905680076564
             les_mean =     286.136891643667
             stat err =       0.000453629912
             autocorr =       1.277837687146
              std dev =       0.567516948351
             le_variance =       0.322075486666


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905678015502        initial
     1.5259e-01     1.5259e+00             4.0293e-03       -16.905703352952  <--
     6.1035e-01     6.1035e+00             1.3681e-03       -16.905696463336
     2.4414e+00     2.4414e+01             3.7639e-04       -16.905680076564

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.4007e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_0001                 7.007682e-01 3 1  ON 0
ci_0002                 7.006314e-01 3 1  ON 1
ci_0003                -2.832988e-02 3 1  ON 2
ci_0004                -2.831324e-02 3 1  ON 3
ci_0005                -3.419800e-02 3 1  ON 4
ci_0006                -3.497019e-02 3 1  ON 5
ci_0007                -2.318488e-02 3 1  ON 6
ci_0008                -2.525150e-02 3 1  ON 7
ci_0009                -1.788268e-02 3 1  ON 8
ci_0010                -1.823703e-02 3 1  ON 9
ci_0011                -1.377394e-02 3 1  ON 10
ci_0012                -1.307205e-02 3 1  ON 11
ci_0013                 1.374600e-02 3 1  ON 12
ci_0014                 1.324062e-02 3 1  ON 13
ci_0015                 1.388766e-02 3 1  ON 14
ci_0016                 1.355449e-02 3 1  ON 15
ci_0017                 1.251542e-02 3 1  ON 16
ci_0018                 1.192922e-02 3 1  ON 17
ci_0019                 1.230387e-02 3 1  ON 18
ci_0020                 1.115227e-02 3 1  ON 19
ci_0021                 3.402150e-03 3 1  ON 20
ci_0022                 3.447220e-03 3 1  ON 21
ci_0023                -1.139835e-02 3 1  ON 22
ci_0024                -1.064565e-02 3 1  ON 23
ci_0025                -1.074475e-02 3 1  ON 24
ci_0026                -1.033988e-02 3 1  ON 25
ci_0027                -1.201550e-02 3 1  ON 26
ci_0028                -1.124453e-02 3 1  ON 27
ci_0029                -1.088427e-02 3 1  ON 28
ci_0030                -1.067134e-02 3 1  ON 29
ci_0031                 1.969856e-02 3 1  ON 30
ci_0032                 1.964813e-02 3 1  ON 31
ci_0033                 1.064975e-02 3 1  ON 32
ci_0034                 1.105128e-02 3 1  ON 33
ci_0035                 7.955010e-03 3 1  ON 34
ci_0036                 6.497265e-03 3 1  ON 35
ci_0037                -1.029584e-02 3 1  ON 36
ci_0038                -1.004630e-02 3 1  ON 37
ci_0039                -2.816470e-03 3 1  ON 38
ci_0040                -2.544611e-03 3 1  ON 39
ci_0041                 7.651141e-03 3 1  ON 40
ci_0042                 6.942063e-03 3 1  ON 41
ci_0043                -1.464268e-02 3 1  ON 42
ci_0044                -1.550618e-02 3 1  ON 43
ci_0045                 7.022122e-03 3 1  ON 44
ci_0046                 7.798781e-03 3 1  ON 45
ci_0047                -2.170248e-03 3 1  ON 46
ci_0048                -2.634367e-03 3 1  ON 47
ci_0049                -5.380372e-03 3 1  ON 48
ci_0050                -5.711229e-03 3 1  ON 49
ci_0051                -3.955310e-03 3 1  ON 50
ci_0052                -4.027879e-03 3 1  ON 51
ci_0053                -4.791774e-03 3 1  ON 52
ci_0054                -4.805022e-03 3 1  ON 53
ci_0055                 6.919670e-03 3 1  ON 54
ci_0056                 6.694946e-03 3 1  ON 55
ci_0057                 3.524357e-03 3 1  ON 56
ci_0058                 5.346440e-03 3 1  ON 57
ci_0059                -4.504265e-03 3 1  ON 58
ci_0060                -3.854699e-03 3 1  ON 59
ci_0061                -3.069240e-03 3 1  ON 60
ci_0062                -3.043798e-03 3 1  ON 61
ci_0063                -9.197037e-03 3 1  ON 62
ci_0064                -8.855989e-03 3 1  ON 63
ci_0065                -5.721928e-03 3 1  ON 64
ci_0066                -5.014173e-03 3 1  ON 65
ci_0067                -5.567754e-03 3 1  ON 66
ci_0068                -5.633320e-03 3 1  ON 67
ci_0069                 4.628080e-03 3 1  ON 68
ci_0070                 4.219739e-03 3 1  ON 69
ci_0071                 2.212824e-03 3 1  ON 70
ci_0072                 2.124617e-03 3 1  ON 71
ci_0073                 4.473468e-03 3 1  ON 72
ci_0074                 4.038026e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8643
    reference variance = 0.224317
====================================================
  Execution time = 1.4699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3361e-01
  Total weights = 1.952281990e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322880103795
                                         uncertainty =       0.003294745874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322880103795
                                         uncertainty =       0.003294745874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401778415
  error estimate for blocks of size 2^( 2) =       0.000414533883
  error estimate for blocks of size 2^( 3) =       0.000427431123
  error estimate for blocks of size 2^( 4) =       0.000439007112
  error estimate for blocks of size 2^( 5) =       0.000448298522
  error estimate for blocks of size 2^( 6) =       0.000455073634
  error estimate for blocks of size 2^( 7) =       0.000461116242

      target function =                  N/A
              le_mean =     -16.906261692518
             les_mean =     286.155295489096
             stat err =       0.000450873878
             autocorr =       1.259322451217
              std dev =       0.568200483634
             le_variance =       0.322851789602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626169252e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906261692532       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906310632395       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906317320441       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906319072663       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906318860709       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906318690952       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-02 is 2.559715e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906261692532       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906295909488       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906298406652       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906298861600       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906298800066       residual = 1.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e-01 is 1.332933e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906261692532       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277222002       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906277564846       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906277607598       residual = 7.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e-01 is 4.906836e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7305e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.009152e-01 3 1  ON 0
ci_0002                 7.005225e-01 3 1  ON 1
ci_0003                -2.852249e-02 3 1  ON 2
ci_0004                -2.863197e-02 3 1  ON 3
ci_0005                -3.430076e-02 3 1  ON 4
ci_0006                -3.488644e-02 3 1  ON 5
ci_0007                -2.282890e-02 3 1  ON 6
ci_0008                -2.391856e-02 3 1  ON 7
ci_0009                -1.782345e-02 3 1  ON 8
ci_0010                -1.838321e-02 3 1  ON 9
ci_0011                -1.331564e-02 3 1  ON 10
ci_0012                -1.274332e-02 3 1  ON 11
ci_0013                 1.363103e-02 3 1  ON 12
ci_0014                 1.331483e-02 3 1  ON 13
ci_0015                 1.443067e-02 3 1  ON 14
ci_0016                 1.364914e-02 3 1  ON 15
ci_0017                 1.202636e-02 3 1  ON 16
ci_0018                 1.177849e-02 3 1  ON 17
ci_0019                 1.133520e-02 3 1  ON 18
ci_0020                 1.099643e-02 3 1  ON 19
ci_0021                 3.209863e-03 3 1  ON 20
ci_0022                 2.622138e-03 3 1  ON 21
ci_0023                -1.176729e-02 3 1  ON 22
ci_0024                -1.132602e-02 3 1  ON 23
ci_0025                -1.075862e-02 3 1  ON 24
ci_0026                -1.104468e-02 3 1  ON 25
ci_0027                -1.142018e-02 3 1  ON 26
ci_0028                -1.139535e-02 3 1  ON 27
ci_0029                -1.090576e-02 3 1  ON 28
ci_0030                -1.065145e-02 3 1  ON 29
ci_0031                 1.983003e-02 3 1  ON 30
ci_0032                 1.972089e-02 3 1  ON 31
ci_0033                 1.059770e-02 3 1  ON 32
ci_0034                 1.155351e-02 3 1  ON 33
ci_0035                 7.701085e-03 3 1  ON 34
ci_0036                 6.471304e-03 3 1  ON 35
ci_0037                -1.045334e-02 3 1  ON 36
ci_0038                -1.038336e-02 3 1  ON 37
ci_0039                -2.659084e-03 3 1  ON 38
ci_0040                -2.624920e-03 3 1  ON 39
ci_0041                 7.063128e-03 3 1  ON 40
ci_0042                 7.252969e-03 3 1  ON 41
ci_0043                -1.457347e-02 3 1  ON 42
ci_0044                -1.551436e-02 3 1  ON 43
ci_0045                 7.376091e-03 3 1  ON 44
ci_0046                 8.068495e-03 3 1  ON 45
ci_0047                -1.968520e-03 3 1  ON 46
ci_0048                -2.040864e-03 3 1  ON 47
ci_0049                -6.193744e-03 3 1  ON 48
ci_0050                -5.083420e-03 3 1  ON 49
ci_0051                -3.379342e-03 3 1  ON 50
ci_0052                -3.535655e-03 3 1  ON 51
ci_0053                -4.425446e-03 3 1  ON 52
ci_0054                -5.066946e-03 3 1  ON 53
ci_0055                 7.033425e-03 3 1  ON 54
ci_0056                 5.984521e-03 3 1  ON 55
ci_0057                 4.074265e-03 3 1  ON 56
ci_0058                 5.479734e-03 3 1  ON 57
ci_0059                -4.990221e-03 3 1  ON 58
ci_0060                -4.309183e-03 3 1  ON 59
ci_0061                -3.817892e-03 3 1  ON 60
ci_0062                -3.388353e-03 3 1  ON 61
ci_0063                -8.667153e-03 3 1  ON 62
ci_0064                -8.700536e-03 3 1  ON 63
ci_0065                -5.874181e-03 3 1  ON 64
ci_0066                -6.070728e-03 3 1  ON 65
ci_0067                -5.380094e-03 3 1  ON 66
ci_0068                -5.699837e-03 3 1  ON 67
ci_0069                 4.522162e-03 3 1  ON 68
ci_0070                 4.227729e-03 3 1  ON 69
ci_0071                 2.053550e-03 3 1  ON 70
ci_0072                 2.097486e-03 3 1  ON 71
ci_0073                 4.759757e-03 3 1  ON 72
ci_0074                 4.029311e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.143141
====================================================
  Execution time = 1.4619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3413e-01
  Total weights = 1.9519e+06
  Execution time = 1.9010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322609461428
                                         uncertainty =       0.003663062934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322609461428
                                         uncertainty =       0.003663062934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401590338
  error estimate for blocks of size 2^( 2) =       0.000414939627
  error estimate for blocks of size 2^( 3) =       0.000427932038
  error estimate for blocks of size 2^( 4) =       0.000440305501
  error estimate for blocks of size 2^( 5) =       0.000450760188
  error estimate for blocks of size 2^( 6) =       0.000459696891
  error estimate for blocks of size 2^( 7) =       0.000463507171

      target function =                  N/A
              le_mean =     -16.906605423452
             les_mean =     286.178959221057
             stat err =       0.000453567438
             autocorr =       1.275607975217
              std dev =       0.567934502484
             le_variance =       0.322549599112

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322580057493
                                         uncertainty =       0.003638049804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322580057493
                                         uncertainty =       0.003638049804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401571409
  error estimate for blocks of size 2^( 2) =       0.000414952137
  error estimate for blocks of size 2^( 3) =       0.000427969446
  error estimate for blocks of size 2^( 4) =       0.000440360320
  error estimate for blocks of size 2^( 5) =       0.000450770764
  error estimate for blocks of size 2^( 6) =       0.000459798055
  error estimate for blocks of size 2^( 7) =       0.000463621504

      target function =                  N/A
              le_mean =     -16.906589036918
             les_mean =     286.171519945705
             stat err =       0.000453637661
             autocorr =       1.276123293001
              std dev =       0.567907732816
             le_variance =       0.322519192992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008664264
                                         uncertainty =       0.010891749870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333008664264
                                         uncertainty =       0.010891749870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408011480
  error estimate for blocks of size 2^( 2) =       0.000421175549
  error estimate for blocks of size 2^( 3) =       0.000434065633
  error estimate for blocks of size 2^( 4) =       0.000446165595
  error estimate for blocks of size 2^( 5) =       0.000456421123
  error estimate for blocks of size 2^( 6) =       0.000465288853
  error estimate for blocks of size 2^( 7) =       0.000469053656

      target function =                  N/A
              le_mean =     -16.906526547472
             les_mean =     286.337966484881
             stat err =       0.000459232307
             autocorr =       1.266835137224
              std dev =       0.577015368472
             le_variance =       0.332946735452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322446309477
                                         uncertainty =       0.003646456295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322446309477
                                         uncertainty =       0.003646456295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401488686
  error estimate for blocks of size 2^( 2) =       0.000414849468
  error estimate for blocks of size 2^( 3) =       0.000427857166
  error estimate for blocks of size 2^( 4) =       0.000440242532
  error estimate for blocks of size 2^( 5) =       0.000450684181
  error estimate for blocks of size 2^( 6) =       0.000459656126
  error estimate for blocks of size 2^( 7) =       0.000463495940

      target function =                  N/A
              le_mean =     -16.906593861715
             les_mean =     286.169937518944
             stat err =       0.000453519695
             autocorr =       1.275985327153
              std dev =       0.567790745055
             le_variance =       0.322386330170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906605423452        initial  <--
     3.8147e-02     3.8147e-01             2.5597e-03       -16.906589036918
     1.5259e-01     1.5259e+00             1.3329e-03       -16.906526547472
     6.1035e-01     6.1035e+00             4.9068e-04       -16.906593861715

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.2677
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_0001                 7.007682e-01 3 1  ON 0
ci_0002                 7.006314e-01 3 1  ON 1
ci_0003                -2.832988e-02 3 1  ON 2
ci_0004                -2.831324e-02 3 1  ON 3
ci_0005                -3.419800e-02 3 1  ON 4
ci_0006                -3.497019e-02 3 1  ON 5
ci_0007                -2.318488e-02 3 1  ON 6
ci_0008                -2.525150e-02 3 1  ON 7
ci_0009                -1.788268e-02 3 1  ON 8
ci_0010                -1.823703e-02 3 1  ON 9
ci_0011                -1.377394e-02 3 1  ON 10
ci_0012                -1.307205e-02 3 1  ON 11
ci_0013                 1.374600e-02 3 1  ON 12
ci_0014                 1.324062e-02 3 1  ON 13
ci_0015                 1.388766e-02 3 1  ON 14
ci_0016                 1.355449e-02 3 1  ON 15
ci_0017                 1.251542e-02 3 1  ON 16
ci_0018                 1.192922e-02 3 1  ON 17
ci_0019                 1.230387e-02 3 1  ON 18
ci_0020                 1.115227e-02 3 1  ON 19
ci_0021                 3.402150e-03 3 1  ON 20
ci_0022                 3.447220e-03 3 1  ON 21
ci_0023                -1.139835e-02 3 1  ON 22
ci_0024                -1.064565e-02 3 1  ON 23
ci_0025                -1.074475e-02 3 1  ON 24
ci_0026                -1.033988e-02 3 1  ON 25
ci_0027                -1.201550e-02 3 1  ON 26
ci_0028                -1.124453e-02 3 1  ON 27
ci_0029                -1.088427e-02 3 1  ON 28
ci_0030                -1.067134e-02 3 1  ON 29
ci_0031                 1.969856e-02 3 1  ON 30
ci_0032                 1.964813e-02 3 1  ON 31
ci_0033                 1.064975e-02 3 1  ON 32
ci_0034                 1.105128e-02 3 1  ON 33
ci_0035                 7.955010e-03 3 1  ON 34
ci_0036                 6.497265e-03 3 1  ON 35
ci_0037                -1.029584e-02 3 1  ON 36
ci_0038                -1.004630e-02 3 1  ON 37
ci_0039                -2.816470e-03 3 1  ON 38
ci_0040                -2.544611e-03 3 1  ON 39
ci_0041                 7.651141e-03 3 1  ON 40
ci_0042                 6.942063e-03 3 1  ON 41
ci_0043                -1.464268e-02 3 1  ON 42
ci_0044                -1.550618e-02 3 1  ON 43
ci_0045                 7.022122e-03 3 1  ON 44
ci_0046                 7.798781e-03 3 1  ON 45
ci_0047                -2.170248e-03 3 1  ON 46
ci_0048                -2.634367e-03 3 1  ON 47
ci_0049                -5.380372e-03 3 1  ON 48
ci_0050                -5.711229e-03 3 1  ON 49
ci_0051                -3.955310e-03 3 1  ON 50
ci_0052                -4.027879e-03 3 1  ON 51
ci_0053                -4.791774e-03 3 1  ON 52
ci_0054                -4.805022e-03 3 1  ON 53
ci_0055                 6.919670e-03 3 1  ON 54
ci_0056                 6.694946e-03 3 1  ON 55
ci_0057                 3.524357e-03 3 1  ON 56
ci_0058                 5.346440e-03 3 1  ON 57
ci_0059                -4.504265e-03 3 1  ON 58
ci_0060                -3.854699e-03 3 1  ON 59
ci_0061                -3.069240e-03 3 1  ON 60
ci_0062                -3.043798e-03 3 1  ON 61
ci_0063                -9.197037e-03 3 1  ON 62
ci_0064                -8.855989e-03 3 1  ON 63
ci_0065                -5.721928e-03 3 1  ON 64
ci_0066                -5.014173e-03 3 1  ON 65
ci_0067                -5.567754e-03 3 1  ON 66
ci_0068                -5.633320e-03 3 1  ON 67
ci_0069                 4.628080e-03 3 1  ON 68
ci_0070                 4.219739e-03 3 1  ON 69
ci_0071                 2.212824e-03 3 1  ON 70
ci_0072                 2.124617e-03 3 1  ON 71
ci_0073                 4.473468e-03 3 1  ON 72
ci_0074                 4.038026e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 0.241481
====================================================
  Execution time = 1.4731e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3916e-01
  Total weights = 1.951965920e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326193979789
                                         uncertainty =       0.006535557360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326193979789
                                         uncertainty =       0.006535557360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403805905
  error estimate for blocks of size 2^( 2) =       0.000416757049
  error estimate for blocks of size 2^( 3) =       0.000430048890
  error estimate for blocks of size 2^( 4) =       0.000441579427
  error estimate for blocks of size 2^( 5) =       0.000453023045
  error estimate for blocks of size 2^( 6) =       0.000462052539
  error estimate for blocks of size 2^( 7) =       0.000469302662

      target function =                  N/A
              le_mean =     -16.906191530460
             les_mean =     286.158476280884
             stat err =       0.000456489418
             autocorr =       1.277956583778
              std dev =       0.571067786771
             le_variance =       0.326118417087


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619153046e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906191530484       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906211710661       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906212993679       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906212934880       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-01 is 7.686654e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906191530484       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906198526907       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906198806009       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906198799442       residual = 3.03e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 2.922199e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906191530484       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906193466828       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906193534456       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906193536382       residual = 4.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 6.1035e+00 is 8.404045e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7349e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.007968e-01 3 1  ON 0
ci_0002                 7.006245e-01 3 1  ON 1
ci_0003                -2.828428e-02 3 1  ON 2
ci_0004                -2.840117e-02 3 1  ON 3
ci_0005                -3.408451e-02 3 1  ON 4
ci_0006                -3.489053e-02 3 1  ON 5
ci_0007                -2.313003e-02 3 1  ON 6
ci_0008                -2.508770e-02 3 1  ON 7
ci_0009                -1.794051e-02 3 1  ON 8
ci_0010                -1.816904e-02 3 1  ON 9
ci_0011                -1.374770e-02 3 1  ON 10
ci_0012                -1.302301e-02 3 1  ON 11
ci_0013                 1.362962e-02 3 1  ON 12
ci_0014                 1.328148e-02 3 1  ON 13
ci_0015                 1.383940e-02 3 1  ON 14
ci_0016                 1.363726e-02 3 1  ON 15
ci_0017                 1.243357e-02 3 1  ON 16
ci_0018                 1.191325e-02 3 1  ON 17
ci_0019                 1.220524e-02 3 1  ON 18
ci_0020                 1.120039e-02 3 1  ON 19
ci_0021                 3.222387e-03 3 1  ON 20
ci_0022                 3.424660e-03 3 1  ON 21
ci_0023                -1.140798e-02 3 1  ON 22
ci_0024                -1.080275e-02 3 1  ON 23
ci_0025                -1.065697e-02 3 1  ON 24
ci_0026                -1.040645e-02 3 1  ON 25
ci_0027                -1.197065e-02 3 1  ON 26
ci_0028                -1.124100e-02 3 1  ON 27
ci_0029                -1.096326e-02 3 1  ON 28
ci_0030                -1.065382e-02 3 1  ON 29
ci_0031                 1.967598e-02 3 1  ON 30
ci_0032                 1.960723e-02 3 1  ON 31
ci_0033                 1.051140e-02 3 1  ON 32
ci_0034                 1.092118e-02 3 1  ON 33
ci_0035                 7.741577e-03 3 1  ON 34
ci_0036                 6.525190e-03 3 1  ON 35
ci_0037                -1.037014e-02 3 1  ON 36
ci_0038                -1.012331e-02 3 1  ON 37
ci_0039                -2.790763e-03 3 1  ON 38
ci_0040                -2.573812e-03 3 1  ON 39
ci_0041                 7.737328e-03 3 1  ON 40
ci_0042                 7.008388e-03 3 1  ON 41
ci_0043                -1.460717e-02 3 1  ON 42
ci_0044                -1.545786e-02 3 1  ON 43
ci_0045                 7.068504e-03 3 1  ON 44
ci_0046                 7.762524e-03 3 1  ON 45
ci_0047                -2.079381e-03 3 1  ON 46
ci_0048                -2.459786e-03 3 1  ON 47
ci_0049                -5.391079e-03 3 1  ON 48
ci_0050                -5.846795e-03 3 1  ON 49
ci_0051                -3.966066e-03 3 1  ON 50
ci_0052                -3.980035e-03 3 1  ON 51
ci_0053                -4.809657e-03 3 1  ON 52
ci_0054                -4.886572e-03 3 1  ON 53
ci_0055                 6.873019e-03 3 1  ON 54
ci_0056                 6.707901e-03 3 1  ON 55
ci_0057                 3.709058e-03 3 1  ON 56
ci_0058                 5.348673e-03 3 1  ON 57
ci_0059                -4.658138e-03 3 1  ON 58
ci_0060                -4.146919e-03 3 1  ON 59
ci_0061                -3.204553e-03 3 1  ON 60
ci_0062                -3.046726e-03 3 1  ON 61
ci_0063                -9.076038e-03 3 1  ON 62
ci_0064                -8.815915e-03 3 1  ON 63
ci_0065                -5.785996e-03 3 1  ON 64
ci_0066                -5.040443e-03 3 1  ON 65
ci_0067                -5.534462e-03 3 1  ON 66
ci_0068                -5.585995e-03 3 1  ON 67
ci_0069                 4.619874e-03 3 1  ON 68
ci_0070                 4.378997e-03 3 1  ON 69
ci_0071                 2.109621e-03 3 1  ON 70
ci_0072                 2.156994e-03 3 1  ON 71
ci_0073                 4.546505e-03 3 1  ON 72
ci_0074                 4.089437e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.406215
====================================================
  Execution time = 1.4589e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3484e-01
  Total weights = 1.9524e+06
  Execution time = 1.9044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320556926890
                                         uncertainty =       0.002762969871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320556926890
                                         uncertainty =       0.002762969871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400447808
  error estimate for blocks of size 2^( 2) =       0.000412934848
  error estimate for blocks of size 2^( 3) =       0.000426104805
  error estimate for blocks of size 2^( 4) =       0.000437767168
  error estimate for blocks of size 2^( 5) =       0.000448019927
  error estimate for blocks of size 2^( 6) =       0.000453888487
  error estimate for blocks of size 2^( 7) =       0.000457846547

      target function =                  N/A
              le_mean =     -16.906707928784
             les_mean =     286.171926535334
             stat err =       0.000449380532
             autocorr =       1.259321645291
              std dev =       0.566318720592
             le_variance =       0.320716893293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320556212799
                                         uncertainty =       0.002752983661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320556212799
                                         uncertainty =       0.002752983661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400449799
  error estimate for blocks of size 2^( 2) =       0.000412926104
  error estimate for blocks of size 2^( 3) =       0.000426095679
  error estimate for blocks of size 2^( 4) =       0.000437753047
  error estimate for blocks of size 2^( 5) =       0.000448015954
  error estimate for blocks of size 2^( 6) =       0.000453890043
  error estimate for blocks of size 2^( 7) =       0.000457832569

      target function =                  N/A
              le_mean =     -16.906711081273
             les_mean =     286.188338009969
             stat err =       0.000449372903
             autocorr =       1.259266363674
              std dev =       0.566321536566
             le_variance =       0.320720082779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320542451037
                                         uncertainty =       0.002754393516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320542451037
                                         uncertainty =       0.002754393516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400440445
  error estimate for blocks of size 2^( 2) =       0.000412918915
  error estimate for blocks of size 2^( 3) =       0.000426090184
  error estimate for blocks of size 2^( 4) =       0.000437744478
  error estimate for blocks of size 2^( 5) =       0.000448006183
  error estimate for blocks of size 2^( 6) =       0.000453877101
  error estimate for blocks of size 2^( 7) =       0.000457824145

      target function =                  N/A
              le_mean =     -16.906710515598
             les_mean =     286.172241114860
             stat err =       0.000449362977
             autocorr =       1.259269559103
              std dev =       0.566308308139
             le_variance =       0.320705099867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320549869269
                                         uncertainty =       0.002761614236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320549869269
                                         uncertainty =       0.002761614236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400443630
  error estimate for blocks of size 2^( 2) =       0.000412929447
  error estimate for blocks of size 2^( 3) =       0.000426099641
  error estimate for blocks of size 2^( 4) =       0.000437761180
  error estimate for blocks of size 2^( 5) =       0.000448015305
  error estimate for blocks of size 2^( 6) =       0.000453883439
  error estimate for blocks of size 2^( 7) =       0.000457840587

      target function =                  N/A
              le_mean =     -16.906707461245
             les_mean =     286.171606695761
             stat err =       0.000449375128
             autocorr =       1.259317630981
              std dev =       0.566312812082
             le_variance =       0.320710201128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906707928784        initial
     3.8147e-01     3.8147e+00             7.6867e-04       -16.906711081273  <--
     1.5259e+00     1.5259e+01             2.9222e-04       -16.906710515598
     6.1035e+00     6.1035e+01             8.4040e-05       -16.906707461245

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.4254e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_0001                 7.008498e-01 3 1  ON 0
ci_0002                 7.006246e-01 3 1  ON 1
ci_0003                -2.819741e-02 3 1  ON 2
ci_0004                -2.858139e-02 3 1  ON 3
ci_0005                -3.382035e-02 3 1  ON 4
ci_0006                -3.470618e-02 3 1  ON 5
ci_0007                -2.299573e-02 3 1  ON 6
ci_0008                -2.468527e-02 3 1  ON 7
ci_0009                -1.804920e-02 3 1  ON 8
ci_0010                -1.804138e-02 3 1  ON 9
ci_0011                -1.370227e-02 3 1  ON 10
ci_0012                -1.292007e-02 3 1  ON 11
ci_0013                 1.340546e-02 3 1  ON 12
ci_0014                 1.336095e-02 3 1  ON 13
ci_0015                 1.374849e-02 3 1  ON 14
ci_0016                 1.379943e-02 3 1  ON 15
ci_0017                 1.227984e-02 3 1  ON 16
ci_0018                 1.188184e-02 3 1  ON 17
ci_0019                 1.202228e-02 3 1  ON 18
ci_0020                 1.129335e-02 3 1  ON 19
ci_0021                 2.778339e-03 3 1  ON 20
ci_0022                 3.368044e-03 3 1  ON 21
ci_0023                -1.143387e-02 3 1  ON 22
ci_0024                -1.109195e-02 3 1  ON 23
ci_0025                -1.048921e-02 3 1  ON 24
ci_0026                -1.052752e-02 3 1  ON 25
ci_0027                -1.189164e-02 3 1  ON 26
ci_0028                -1.121875e-02 3 1  ON 27
ci_0029                -1.112154e-02 3 1  ON 28
ci_0030                -1.061123e-02 3 1  ON 29
ci_0031                 1.962593e-02 3 1  ON 30
ci_0032                 1.950172e-02 3 1  ON 31
ci_0033                 1.019279e-02 3 1  ON 32
ci_0034                 1.062193e-02 3 1  ON 33
ci_0035                 7.304469e-03 3 1  ON 34
ci_0036                 6.576190e-03 3 1  ON 35
ci_0037                -1.052796e-02 3 1  ON 36
ci_0038                -1.028885e-02 3 1  ON 37
ci_0039                -2.751549e-03 3 1  ON 38
ci_0040                -2.619931e-03 3 1  ON 39
ci_0041                 7.904642e-03 3 1  ON 40
ci_0042                 7.136269e-03 3 1  ON 41
ci_0043                -1.451801e-02 3 1  ON 42
ci_0044                -1.534078e-02 3 1  ON 43
ci_0045                 7.167802e-03 3 1  ON 44
ci_0046                 7.678981e-03 3 1  ON 45
ci_0047                -1.936439e-03 3 1  ON 46
ci_0048                -2.188172e-03 3 1  ON 47
ci_0049                -5.417571e-03 3 1  ON 48
ci_0050                -6.110752e-03 3 1  ON 49
ci_0051                -3.986154e-03 3 1  ON 50
ci_0052                -3.909770e-03 3 1  ON 51
ci_0053                -4.837430e-03 3 1  ON 52
ci_0054                -5.022835e-03 3 1  ON 53
ci_0055                 6.774506e-03 3 1  ON 54
ci_0056                 6.735170e-03 3 1  ON 55
ci_0057                 4.089562e-03 3 1  ON 56
ci_0058                 5.358365e-03 3 1  ON 57
ci_0059                -4.913926e-03 3 1  ON 58
ci_0060                -4.623364e-03 3 1  ON 59
ci_0061                -3.479212e-03 3 1  ON 60
ci_0062                -3.056622e-03 3 1  ON 61
ci_0063                -8.867599e-03 3 1  ON 62
ci_0064                -8.745423e-03 3 1  ON 63
ci_0065                -5.906552e-03 3 1  ON 64
ci_0066                -5.090122e-03 3 1  ON 65
ci_0067                -5.480697e-03 3 1  ON 66
ci_0068                -5.509012e-03 3 1  ON 67
ci_0069                 4.607640e-03 3 1  ON 68
ci_0070                 4.631475e-03 3 1  ON 69
ci_0071                 1.910336e-03 3 1  ON 70
ci_0072                 2.225232e-03 3 1  ON 71
ci_0073                 4.660613e-03 3 1  ON 72
ci_0074                 4.173352e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1609e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9222
    reference variance = 0.229082
====================================================
  Execution time = 1.4835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3700e-01
  Total weights = 1.951995678e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324066944219
                                         uncertainty =       0.002438514440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324066944219
                                         uncertainty =       0.002438514440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402652173
  error estimate for blocks of size 2^( 2) =       0.000415180629
  error estimate for blocks of size 2^( 3) =       0.000428387891
  error estimate for blocks of size 2^( 4) =       0.000440278389
  error estimate for blocks of size 2^( 5) =       0.000451171563
  error estimate for blocks of size 2^( 6) =       0.000459614861
  error estimate for blocks of size 2^( 7) =       0.000466713882

      target function =                  N/A
              le_mean =     -16.906743687995
             les_mean =     286.174984102152
             stat err =       0.000454444674
             autocorr =       1.273802045689
              std dev =       0.569436163275
             le_variance =       0.324257544046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674368799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743687972       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906758249148       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906758177710       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906758752454       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906758867449       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906758833835       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          5 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e-02 is 1.919272e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743687972       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906751100613       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906750765789       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906750867954       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-01 is 8.088498e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906743687972       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906746189092       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906746065725       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906746100856       residual = 1.95e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 2.450385e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.159604 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7435e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.011282e-01 3 1  ON 0
ci_0002                 7.004183e-01 3 1  ON 1
ci_0003                -2.812546e-02 3 1  ON 2
ci_0004                -2.821530e-02 3 1  ON 3
ci_0005                -3.414789e-02 3 1  ON 4
ci_0006                -3.465031e-02 3 1  ON 5
ci_0007                -2.235493e-02 3 1  ON 6
ci_0008                -2.435673e-02 3 1  ON 7
ci_0009                -1.797377e-02 3 1  ON 8
ci_0010                -1.808611e-02 3 1  ON 9
ci_0011                -1.329058e-02 3 1  ON 10
ci_0012                -1.280328e-02 3 1  ON 11
ci_0013                 1.325642e-02 3 1  ON 12
ci_0014                 1.366821e-02 3 1  ON 13
ci_0015                 1.365578e-02 3 1  ON 14
ci_0016                 1.339614e-02 3 1  ON 15
ci_0017                 1.220344e-02 3 1  ON 16
ci_0018                 1.209249e-02 3 1  ON 17
ci_0019                 1.214220e-02 3 1  ON 18
ci_0020                 1.125805e-02 3 1  ON 19
ci_0021                 2.456131e-03 3 1  ON 20
ci_0022                 3.227904e-03 3 1  ON 21
ci_0023                -1.138926e-02 3 1  ON 22
ci_0024                -1.125077e-02 3 1  ON 23
ci_0025                -1.054880e-02 3 1  ON 24
ci_0026                -1.070249e-02 3 1  ON 25
ci_0027                -1.175780e-02 3 1  ON 26
ci_0028                -1.143110e-02 3 1  ON 27
ci_0029                -1.087605e-02 3 1  ON 28
ci_0030                -1.075424e-02 3 1  ON 29
ci_0031                 1.956892e-02 3 1  ON 30
ci_0032                 1.944895e-02 3 1  ON 31
ci_0033                 9.383939e-03 3 1  ON 32
ci_0034                 1.059457e-02 3 1  ON 33
ci_0035                 6.901246e-03 3 1  ON 34
ci_0036                 6.559591e-03 3 1  ON 35
ci_0037                -9.925103e-03 3 1  ON 36
ci_0038                -1.002145e-02 3 1  ON 37
ci_0039                -2.772047e-03 3 1  ON 38
ci_0040                -2.743137e-03 3 1  ON 39
ci_0041                 8.061215e-03 3 1  ON 40
ci_0042                 7.377814e-03 3 1  ON 41
ci_0043                -1.462687e-02 3 1  ON 42
ci_0044                -1.550045e-02 3 1  ON 43
ci_0045                 7.219635e-03 3 1  ON 44
ci_0046                 7.719807e-03 3 1  ON 45
ci_0047                -2.185122e-03 3 1  ON 46
ci_0048                -1.933021e-03 3 1  ON 47
ci_0049                -5.372730e-03 3 1  ON 48
ci_0050                -6.044660e-03 3 1  ON 49
ci_0051                -3.655272e-03 3 1  ON 50
ci_0052                -3.816301e-03 3 1  ON 51
ci_0053                -4.693310e-03 3 1  ON 52
ci_0054                -4.983721e-03 3 1  ON 53
ci_0055                 6.162170e-03 3 1  ON 54
ci_0056                 6.751936e-03 3 1  ON 55
ci_0057                 4.143367e-03 3 1  ON 56
ci_0058                 5.104020e-03 3 1  ON 57
ci_0059                -5.239979e-03 3 1  ON 58
ci_0060                -4.766831e-03 3 1  ON 59
ci_0061                -3.543494e-03 3 1  ON 60
ci_0062                -2.927897e-03 3 1  ON 61
ci_0063                -9.038563e-03 3 1  ON 62
ci_0064                -8.847014e-03 3 1  ON 63
ci_0065                -5.898442e-03 3 1  ON 64
ci_0066                -5.125811e-03 3 1  ON 65
ci_0067                -5.437728e-03 3 1  ON 66
ci_0068                -5.585217e-03 3 1  ON 67
ci_0069                 5.107456e-03 3 1  ON 68
ci_0070                 4.538629e-03 3 1  ON 69
ci_0071                 1.669367e-03 3 1  ON 70
ci_0072                 2.269975e-03 3 1  ON 71
ci_0073                 4.863571e-03 3 1  ON 72
ci_0074                 4.057720e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.0216
    reference variance = 0.242898
====================================================
  Execution time = 1.4735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2911e-01
  Total weights = 1.9515e+06
  Execution time = 1.9096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317731876943
                                         uncertainty =       0.002235201886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317731876943
                                         uncertainty =       0.002235201886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398594269
  error estimate for blocks of size 2^( 2) =       0.000411794819
  error estimate for blocks of size 2^( 3) =       0.000424754770
  error estimate for blocks of size 2^( 4) =       0.000437428740
  error estimate for blocks of size 2^( 5) =       0.000448727672
  error estimate for blocks of size 2^( 6) =       0.000457438037
  error estimate for blocks of size 2^( 7) =       0.000464241646

      target function =                  N/A
              le_mean =     -16.905959925673
             les_mean =     286.142060522205
             stat err =       0.000451959024
             autocorr =       1.285689282906
              std dev =       0.563697420847
             le_variance =       0.317754782270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317499622646
                                         uncertainty =       0.002212353915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317499622646
                                         uncertainty =       0.002212353915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398448102
  error estimate for blocks of size 2^( 2) =       0.000411672344
  error estimate for blocks of size 2^( 3) =       0.000424662712
  error estimate for blocks of size 2^( 4) =       0.000437363531
  error estimate for blocks of size 2^( 5) =       0.000448683375
  error estimate for blocks of size 2^( 6) =       0.000457434978
  error estimate for blocks of size 2^( 7) =       0.000464262160

      target function =                  N/A
              le_mean =     -16.905965837463
             les_mean =     286.143590515994
             stat err =       0.000451936011
             autocorr =       1.286501717861
              std dev =       0.563490710129
             le_variance =       0.317521780402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569298668
                                         uncertainty =       0.002224093560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317569298668
                                         uncertainty =       0.002224093560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398491708
  error estimate for blocks of size 2^( 2) =       0.000411715029
  error estimate for blocks of size 2^( 3) =       0.000424700116
  error estimate for blocks of size 2^( 4) =       0.000437396731
  error estimate for blocks of size 2^( 5) =       0.000448715785
  error estimate for blocks of size 2^( 6) =       0.000457470818
  error estimate for blocks of size 2^( 7) =       0.000464296745

      target function =                  N/A
              le_mean =     -16.905967441310
             les_mean =     286.143588747027
             stat err =       0.000451970020
             autocorr =       1.286413763596
              std dev =       0.563552377923
             le_variance =       0.317591282662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318413749024
                                         uncertainty =       0.002373413002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318413749024
                                         uncertainty =       0.002373413002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399020999
  error estimate for blocks of size 2^( 2) =       0.000412182867
  error estimate for blocks of size 2^( 3) =       0.000425141244
  error estimate for blocks of size 2^( 4) =       0.000437779311
  error estimate for blocks of size 2^( 5) =       0.000449053915
  error estimate for blocks of size 2^( 6) =       0.000457715696
  error estimate for blocks of size 2^( 7) =       0.000464489449

      target function =                  N/A
              le_mean =     -16.905935386538
             les_mean =     287.602998241806
             stat err =       0.000452259593
             autocorr =       1.284647785670
              std dev =       0.564300907978
             le_variance =       0.318435514745


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905959925673        initial
     9.5367e-02     9.5367e-01             1.9193e-03       -16.905965837463
     3.8147e-01     3.8147e+00             8.0885e-04       -16.905967441310  <--
     1.5259e+00     1.5259e+01             2.4504e-04       -16.905935386538

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 2.4359e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_0001                 7.011282e-01 3 1  ON 0
ci_0002                 7.004183e-01 3 1  ON 1
ci_0003                -2.812546e-02 3 1  ON 2
ci_0004                -2.821530e-02 3 1  ON 3
ci_0005                -3.414789e-02 3 1  ON 4
ci_0006                -3.465031e-02 3 1  ON 5
ci_0007                -2.235493e-02 3 1  ON 6
ci_0008                -2.435673e-02 3 1  ON 7
ci_0009                -1.797377e-02 3 1  ON 8
ci_0010                -1.808611e-02 3 1  ON 9
ci_0011                -1.329058e-02 3 1  ON 10
ci_0012                -1.280328e-02 3 1  ON 11
ci_0013                 1.325642e-02 3 1  ON 12
ci_0014                 1.366821e-02 3 1  ON 13
ci_0015                 1.365578e-02 3 1  ON 14
ci_0016                 1.339614e-02 3 1  ON 15
ci_0017                 1.220344e-02 3 1  ON 16
ci_0018                 1.209249e-02 3 1  ON 17
ci_0019                 1.214220e-02 3 1  ON 18
ci_0020                 1.125805e-02 3 1  ON 19
ci_0021                 2.456131e-03 3 1  ON 20
ci_0022                 3.227904e-03 3 1  ON 21
ci_0023                -1.138926e-02 3 1  ON 22
ci_0024                -1.125077e-02 3 1  ON 23
ci_0025                -1.054880e-02 3 1  ON 24
ci_0026                -1.070249e-02 3 1  ON 25
ci_0027                -1.175780e-02 3 1  ON 26
ci_0028                -1.143110e-02 3 1  ON 27
ci_0029                -1.087605e-02 3 1  ON 28
ci_0030                -1.075424e-02 3 1  ON 29
ci_0031                 1.956892e-02 3 1  ON 30
ci_0032                 1.944895e-02 3 1  ON 31
ci_0033                 9.383939e-03 3 1  ON 32
ci_0034                 1.059457e-02 3 1  ON 33
ci_0035                 6.901246e-03 3 1  ON 34
ci_0036                 6.559591e-03 3 1  ON 35
ci_0037                -9.925103e-03 3 1  ON 36
ci_0038                -1.002145e-02 3 1  ON 37
ci_0039                -2.772047e-03 3 1  ON 38
ci_0040                -2.743137e-03 3 1  ON 39
ci_0041                 8.061215e-03 3 1  ON 40
ci_0042                 7.377814e-03 3 1  ON 41
ci_0043                -1.462687e-02 3 1  ON 42
ci_0044                -1.550045e-02 3 1  ON 43
ci_0045                 7.219635e-03 3 1  ON 44
ci_0046                 7.719807e-03 3 1  ON 45
ci_0047                -2.185122e-03 3 1  ON 46
ci_0048                -1.933021e-03 3 1  ON 47
ci_0049                -5.372730e-03 3 1  ON 48
ci_0050                -6.044660e-03 3 1  ON 49
ci_0051                -3.655272e-03 3 1  ON 50
ci_0052                -3.816301e-03 3 1  ON 51
ci_0053                -4.693310e-03 3 1  ON 52
ci_0054                -4.983721e-03 3 1  ON 53
ci_0055                 6.162170e-03 3 1  ON 54
ci_0056                 6.751936e-03 3 1  ON 55
ci_0057                 4.143367e-03 3 1  ON 56
ci_0058                 5.104020e-03 3 1  ON 57
ci_0059                -5.239979e-03 3 1  ON 58
ci_0060                -4.766831e-03 3 1  ON 59
ci_0061                -3.543494e-03 3 1  ON 60
ci_0062                -2.927897e-03 3 1  ON 61
ci_0063                -9.038563e-03 3 1  ON 62
ci_0064                -8.847014e-03 3 1  ON 63
ci_0065                -5.898442e-03 3 1  ON 64
ci_0066                -5.125811e-03 3 1  ON 65
ci_0067                -5.437728e-03 3 1  ON 66
ci_0068                -5.585217e-03 3 1  ON 67
ci_0069                 5.107456e-03 3 1  ON 68
ci_0070                 4.538629e-03 3 1  ON 69
ci_0071                 1.669367e-03 3 1  ON 70
ci_0072                 2.269975e-03 3 1  ON 71
ci_0073                 4.863571e-03 3 1  ON 72
ci_0074                 4.057720e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1801e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8893
    reference variance = 0.420797
====================================================
  Execution time = 1.5048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3053e-01
  Total weights = 1.951648547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320695081842
                                         uncertainty =       0.001937069773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320695081842
                                         uncertainty =       0.001937069773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400440564
  error estimate for blocks of size 2^( 2) =       0.000412960937
  error estimate for blocks of size 2^( 3) =       0.000426305844
  error estimate for blocks of size 2^( 4) =       0.000438316012
  error estimate for blocks of size 2^( 5) =       0.000449320508
  error estimate for blocks of size 2^( 6) =       0.000455927778
  error estimate for blocks of size 2^( 7) =       0.000461380622

      target function =                  N/A
              le_mean =     -16.907117650089
             les_mean =     286.181158454006
             stat err =       0.000451236230
             autocorr =       1.269789684979
              std dev =       0.566308477170
             le_variance =       0.320705291314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690711765009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907117650110       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907124012228       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907125305502       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907125896210       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907125877047       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e-02 is 1.587842e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907117650110       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907120978144       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907121255361       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907121282988       residual = 9.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e-01 is 7.234363e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907117650110       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907118794710       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907118811625       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907118797819       residual = 1.64e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+00 is 2.272684e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.161002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7649e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.012051e-01 3 1  ON 0
ci_0002                 7.003593e-01 3 1  ON 1
ci_0003                -2.792513e-02 3 1  ON 2
ci_0004                -2.844201e-02 3 1  ON 3
ci_0005                -3.419925e-02 3 1  ON 4
ci_0006                -3.494239e-02 3 1  ON 5
ci_0007                -2.212446e-02 3 1  ON 6
ci_0008                -2.388636e-02 3 1  ON 7
ci_0009                -1.820019e-02 3 1  ON 8
ci_0010                -1.767574e-02 3 1  ON 9
ci_0011                -1.308559e-02 3 1  ON 10
ci_0012                -1.287436e-02 3 1  ON 11
ci_0013                 1.324024e-02 3 1  ON 12
ci_0014                 1.377738e-02 3 1  ON 13
ci_0015                 1.376474e-02 3 1  ON 14
ci_0016                 1.354043e-02 3 1  ON 15
ci_0017                 1.208433e-02 3 1  ON 16
ci_0018                 1.213801e-02 3 1  ON 17
ci_0019                 1.190216e-02 3 1  ON 18
ci_0020                 1.131101e-02 3 1  ON 19
ci_0021                 2.418969e-03 3 1  ON 20
ci_0022                 3.137289e-03 3 1  ON 21
ci_0023                -1.125407e-02 3 1  ON 22
ci_0024                -1.139448e-02 3 1  ON 23
ci_0025                -1.058658e-02 3 1  ON 24
ci_0026                -1.031990e-02 3 1  ON 25
ci_0027                -1.152273e-02 3 1  ON 26
ci_0028                -1.094009e-02 3 1  ON 27
ci_0029                -1.063247e-02 3 1  ON 28
ci_0030                -1.095157e-02 3 1  ON 29
ci_0031                 1.963124e-02 3 1  ON 30
ci_0032                 1.911707e-02 3 1  ON 31
ci_0033                 9.488835e-03 3 1  ON 32
ci_0034                 1.072220e-02 3 1  ON 33
ci_0035                 6.861953e-03 3 1  ON 34
ci_0036                 6.452118e-03 3 1  ON 35
ci_0037                -1.022129e-02 3 1  ON 36
ci_0038                -1.051444e-02 3 1  ON 37
ci_0039                -2.806574e-03 3 1  ON 38
ci_0040                -2.671990e-03 3 1  ON 39
ci_0041                 7.688372e-03 3 1  ON 40
ci_0042                 7.517721e-03 3 1  ON 41
ci_0043                -1.494729e-02 3 1  ON 42
ci_0044                -1.559067e-02 3 1  ON 43
ci_0045                 7.943072e-03 3 1  ON 44
ci_0046                 7.597835e-03 3 1  ON 45
ci_0047                -2.478068e-03 3 1  ON 46
ci_0048                -1.688077e-03 3 1  ON 47
ci_0049                -5.257845e-03 3 1  ON 48
ci_0050                -5.514218e-03 3 1  ON 49
ci_0051                -3.608740e-03 3 1  ON 50
ci_0052                -3.807879e-03 3 1  ON 51
ci_0053                -4.881223e-03 3 1  ON 52
ci_0054                -4.668485e-03 3 1  ON 53
ci_0055                 5.925032e-03 3 1  ON 54
ci_0056                 6.538012e-03 3 1  ON 55
ci_0057                 4.389316e-03 3 1  ON 56
ci_0058                 4.845311e-03 3 1  ON 57
ci_0059                -5.342298e-03 3 1  ON 58
ci_0060                -4.982339e-03 3 1  ON 59
ci_0061                -3.824255e-03 3 1  ON 60
ci_0062                -2.864963e-03 3 1  ON 61
ci_0063                -9.192645e-03 3 1  ON 62
ci_0064                -8.859043e-03 3 1  ON 63
ci_0065                -5.964318e-03 3 1  ON 64
ci_0066                -5.461843e-03 3 1  ON 65
ci_0067                -5.643768e-03 3 1  ON 66
ci_0068                -5.532334e-03 3 1  ON 67
ci_0069                 4.920533e-03 3 1  ON 68
ci_0070                 4.357667e-03 3 1  ON 69
ci_0071                 1.842330e-03 3 1  ON 70
ci_0072                 2.198522e-03 3 1  ON 71
ci_0073                 4.339514e-03 3 1  ON 72
ci_0074                 4.259281e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9076
    reference variance = 0.191816
====================================================
  Execution time = 1.4622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6162e-01
  Total weights = 1.9517e+06
  Execution time = 1.9047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334125005011
                                         uncertainty =       0.009257099309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334125005011
                                         uncertainty =       0.009257099309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408709054
  error estimate for blocks of size 2^( 2) =       0.000421862214
  error estimate for blocks of size 2^( 3) =       0.000434502883
  error estimate for blocks of size 2^( 4) =       0.000445403727
  error estimate for blocks of size 2^( 5) =       0.000455540573
  error estimate for blocks of size 2^( 6) =       0.000460549604
  error estimate for blocks of size 2^( 7) =       0.000467981794

      target function =                  N/A
              le_mean =     -16.906111885913
             les_mean =     286.185811354502
             stat err =       0.000457368924
             autocorr =       1.252289648323
              std dev =       0.578001886609
             le_variance =       0.334086180924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692960287
                                         uncertainty =       0.009262052530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333692960287
                                         uncertainty =       0.009262052530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408444398
  error estimate for blocks of size 2^( 2) =       0.000421629345
  error estimate for blocks of size 2^( 3) =       0.000434303353
  error estimate for blocks of size 2^( 4) =       0.000445234068
  error estimate for blocks of size 2^( 5) =       0.000455390905
  error estimate for blocks of size 2^( 6) =       0.000460435233
  error estimate for blocks of size 2^( 7) =       0.000467880956

      target function =                  N/A
              le_mean =     -16.906096627797
             les_mean =     286.177485868796
             stat err =       0.000457235291
             autocorr =       1.253180414688
              std dev =       0.577627606745
             le_variance =       0.333653652074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333693191842
                                         uncertainty =       0.009255596169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333693191842
                                         uncertainty =       0.009255596169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408444312
  error estimate for blocks of size 2^( 2) =       0.000421630844
  error estimate for blocks of size 2^( 3) =       0.000434305498
  error estimate for blocks of size 2^( 4) =       0.000445236728
  error estimate for blocks of size 2^( 5) =       0.000455399363
  error estimate for blocks of size 2^( 6) =       0.000460440459
  error estimate for blocks of size 2^( 7) =       0.000467889204

      target function =                  N/A
              le_mean =     -16.906097228460
             les_mean =     286.185020173264
             stat err =       0.000457241438
             autocorr =       1.253214642716
              std dev =       0.577627484974
             le_variance =       0.333653511398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333997671144
                                         uncertainty =       0.009250767226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333997671144
                                         uncertainty =       0.009250767226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408631058
  error estimate for blocks of size 2^( 2) =       0.000421790294
  error estimate for blocks of size 2^( 3) =       0.000434436661
  error estimate for blocks of size 2^( 4) =       0.000445342313
  error estimate for blocks of size 2^( 5) =       0.000455485910
  error estimate for blocks of size 2^( 6) =       0.000460502138
  error estimate for blocks of size 2^( 7) =       0.000467940886

      target function =                  N/A
              le_mean =     -16.906102067016
             les_mean =     286.179303665532
             stat err =       0.000457317812
             autocorr =       1.252487755946
              std dev =       0.577891584499
             le_variance =       0.333958683435


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906111885913        initial  <--
     9.5367e-02     9.5367e-01             1.5878e-03       -16.906096627797
     3.8147e-01     3.8147e+00             7.2344e-04       -16.906097228460
     1.5259e+00     1.5259e+01             2.2727e-04       -16.906102067016

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.2533
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_0001                 7.011282e-01 3 1  ON 0
ci_0002                 7.004183e-01 3 1  ON 1
ci_0003                -2.812546e-02 3 1  ON 2
ci_0004                -2.821530e-02 3 1  ON 3
ci_0005                -3.414789e-02 3 1  ON 4
ci_0006                -3.465031e-02 3 1  ON 5
ci_0007                -2.235493e-02 3 1  ON 6
ci_0008                -2.435673e-02 3 1  ON 7
ci_0009                -1.797377e-02 3 1  ON 8
ci_0010                -1.808611e-02 3 1  ON 9
ci_0011                -1.329058e-02 3 1  ON 10
ci_0012                -1.280328e-02 3 1  ON 11
ci_0013                 1.325642e-02 3 1  ON 12
ci_0014                 1.366821e-02 3 1  ON 13
ci_0015                 1.365578e-02 3 1  ON 14
ci_0016                 1.339614e-02 3 1  ON 15
ci_0017                 1.220344e-02 3 1  ON 16
ci_0018                 1.209249e-02 3 1  ON 17
ci_0019                 1.214220e-02 3 1  ON 18
ci_0020                 1.125805e-02 3 1  ON 19
ci_0021                 2.456131e-03 3 1  ON 20
ci_0022                 3.227904e-03 3 1  ON 21
ci_0023                -1.138926e-02 3 1  ON 22
ci_0024                -1.125077e-02 3 1  ON 23
ci_0025                -1.054880e-02 3 1  ON 24
ci_0026                -1.070249e-02 3 1  ON 25
ci_0027                -1.175780e-02 3 1  ON 26
ci_0028                -1.143110e-02 3 1  ON 27
ci_0029                -1.087605e-02 3 1  ON 28
ci_0030                -1.075424e-02 3 1  ON 29
ci_0031                 1.956892e-02 3 1  ON 30
ci_0032                 1.944895e-02 3 1  ON 31
ci_0033                 9.383939e-03 3 1  ON 32
ci_0034                 1.059457e-02 3 1  ON 33
ci_0035                 6.901246e-03 3 1  ON 34
ci_0036                 6.559591e-03 3 1  ON 35
ci_0037                -9.925103e-03 3 1  ON 36
ci_0038                -1.002145e-02 3 1  ON 37
ci_0039                -2.772047e-03 3 1  ON 38
ci_0040                -2.743137e-03 3 1  ON 39
ci_0041                 8.061215e-03 3 1  ON 40
ci_0042                 7.377814e-03 3 1  ON 41
ci_0043                -1.462687e-02 3 1  ON 42
ci_0044                -1.550045e-02 3 1  ON 43
ci_0045                 7.219635e-03 3 1  ON 44
ci_0046                 7.719807e-03 3 1  ON 45
ci_0047                -2.185122e-03 3 1  ON 46
ci_0048                -1.933021e-03 3 1  ON 47
ci_0049                -5.372730e-03 3 1  ON 48
ci_0050                -6.044660e-03 3 1  ON 49
ci_0051                -3.655272e-03 3 1  ON 50
ci_0052                -3.816301e-03 3 1  ON 51
ci_0053                -4.693310e-03 3 1  ON 52
ci_0054                -4.983721e-03 3 1  ON 53
ci_0055                 6.162170e-03 3 1  ON 54
ci_0056                 6.751936e-03 3 1  ON 55
ci_0057                 4.143367e-03 3 1  ON 56
ci_0058                 5.104020e-03 3 1  ON 57
ci_0059                -5.239979e-03 3 1  ON 58
ci_0060                -4.766831e-03 3 1  ON 59
ci_0061                -3.543494e-03 3 1  ON 60
ci_0062                -2.927897e-03 3 1  ON 61
ci_0063                -9.038563e-03 3 1  ON 62
ci_0064                -8.847014e-03 3 1  ON 63
ci_0065                -5.898442e-03 3 1  ON 64
ci_0066                -5.125811e-03 3 1  ON 65
ci_0067                -5.437728e-03 3 1  ON 66
ci_0068                -5.585217e-03 3 1  ON 67
ci_0069                 5.107456e-03 3 1  ON 68
ci_0070                 4.538629e-03 3 1  ON 69
ci_0071                 1.669367e-03 3 1  ON 70
ci_0072                 2.269975e-03 3 1  ON 71
ci_0073                 4.863571e-03 3 1  ON 72
ci_0074                 4.057720e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8833
    reference variance = 0.188345
====================================================
  Execution time = 1.4853e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3464e-01
  Total weights = 1.951812580e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5928e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321729420049
                                         uncertainty =       0.002358602802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321729420049
                                         uncertainty =       0.002358602802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401070050
  error estimate for blocks of size 2^( 2) =       0.000413897779
  error estimate for blocks of size 2^( 3) =       0.000427304633
  error estimate for blocks of size 2^( 4) =       0.000439582239
  error estimate for blocks of size 2^( 5) =       0.000451555925
  error estimate for blocks of size 2^( 6) =       0.000461671784
  error estimate for blocks of size 2^( 7) =       0.000467719322

      target function =                  N/A
              le_mean =     -16.906162438227
             les_mean =     286.152972174015
             stat err =       0.000455132317
             autocorr =       1.287759864065
              std dev =       0.567198703572
             le_variance =       0.321714369334


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616243823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162438238       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906166788964       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906166966806       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906166959851       residual = 2.93e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e-01 is 3.434956e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162438238       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906163703590       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906163751979       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906163751972       residual = 1.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+00 is 9.592577e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906162438238       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906162768044       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906162780619       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906162780902       residual = 2.12e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+01 is 2.470714e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162250 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7452e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.011348e-01 3 1  ON 0
ci_0002                 7.004171e-01 3 1  ON 1
ci_0003                -2.810861e-02 3 1  ON 2
ci_0004                -2.818136e-02 3 1  ON 3
ci_0005                -3.411476e-02 3 1  ON 4
ci_0006                -3.464493e-02 3 1  ON 5
ci_0007                -2.233153e-02 3 1  ON 6
ci_0008                -2.431063e-02 3 1  ON 7
ci_0009                -1.799504e-02 3 1  ON 8
ci_0010                -1.807461e-02 3 1  ON 9
ci_0011                -1.324106e-02 3 1  ON 10
ci_0012                -1.280342e-02 3 1  ON 11
ci_0013                 1.332462e-02 3 1  ON 12
ci_0014                 1.370709e-02 3 1  ON 13
ci_0015                 1.363180e-02 3 1  ON 14
ci_0016                 1.343152e-02 3 1  ON 15
ci_0017                 1.217674e-02 3 1  ON 16
ci_0018                 1.209893e-02 3 1  ON 17
ci_0019                 1.211361e-02 3 1  ON 18
ci_0020                 1.128844e-02 3 1  ON 19
ci_0021                 2.443231e-03 3 1  ON 20
ci_0022                 3.190982e-03 3 1  ON 21
ci_0023                -1.140675e-02 3 1  ON 22
ci_0024                -1.122696e-02 3 1  ON 23
ci_0025                -1.055673e-02 3 1  ON 24
ci_0026                -1.071552e-02 3 1  ON 25
ci_0027                -1.176388e-02 3 1  ON 26
ci_0028                -1.140643e-02 3 1  ON 27
ci_0029                -1.081281e-02 3 1  ON 28
ci_0030                -1.074747e-02 3 1  ON 29
ci_0031                 1.954386e-02 3 1  ON 30
ci_0032                 1.949265e-02 3 1  ON 31
ci_0033                 9.403771e-03 3 1  ON 32
ci_0034                 1.060589e-02 3 1  ON 33
ci_0035                 6.907991e-03 3 1  ON 34
ci_0036                 6.546281e-03 3 1  ON 35
ci_0037                -9.911428e-03 3 1  ON 36
ci_0038                -1.002733e-02 3 1  ON 37
ci_0039                -2.774881e-03 3 1  ON 38
ci_0040                -2.729774e-03 3 1  ON 39
ci_0041                 8.035017e-03 3 1  ON 40
ci_0042                 7.397722e-03 3 1  ON 41
ci_0043                -1.465117e-02 3 1  ON 42
ci_0044                -1.549354e-02 3 1  ON 43
ci_0045                 7.190379e-03 3 1  ON 44
ci_0046                 7.728090e-03 3 1  ON 45
ci_0047                -2.141618e-03 3 1  ON 46
ci_0048                -1.936832e-03 3 1  ON 47
ci_0049                -5.402150e-03 3 1  ON 48
ci_0050                -6.064087e-03 3 1  ON 49
ci_0051                -3.673024e-03 3 1  ON 50
ci_0052                -3.774621e-03 3 1  ON 51
ci_0053                -4.770599e-03 3 1  ON 52
ci_0054                -4.963073e-03 3 1  ON 53
ci_0055                 6.258096e-03 3 1  ON 54
ci_0056                 6.761716e-03 3 1  ON 55
ci_0057                 4.197674e-03 3 1  ON 56
ci_0058                 5.044494e-03 3 1  ON 57
ci_0059                -5.258520e-03 3 1  ON 58
ci_0060                -4.769434e-03 3 1  ON 59
ci_0061                -3.527916e-03 3 1  ON 60
ci_0062                -2.933315e-03 3 1  ON 61
ci_0063                -9.018769e-03 3 1  ON 62
ci_0064                -8.797216e-03 3 1  ON 63
ci_0065                -5.853810e-03 3 1  ON 64
ci_0066                -5.150023e-03 3 1  ON 65
ci_0067                -5.422536e-03 3 1  ON 66
ci_0068                -5.591814e-03 3 1  ON 67
ci_0069                 5.053114e-03 3 1  ON 68
ci_0070                 4.523920e-03 3 1  ON 69
ci_0071                 1.712395e-03 3 1  ON 70
ci_0072                 2.301521e-03 3 1  ON 71
ci_0073                 4.829962e-03 3 1  ON 72
ci_0074                 4.138280e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9587
    reference variance = 0.14497
====================================================
  Execution time = 1.4379e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3518e-01
  Total weights = 1.9516e+06
  Execution time = 1.9033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321836847196
                                         uncertainty =       0.002538129604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321836847196
                                         uncertainty =       0.002538129604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401097093
  error estimate for blocks of size 2^( 2) =       0.000413444618
  error estimate for blocks of size 2^( 3) =       0.000426176868
  error estimate for blocks of size 2^( 4) =       0.000437509103
  error estimate for blocks of size 2^( 5) =       0.000447785400
  error estimate for blocks of size 2^( 6) =       0.000454374424
  error estimate for blocks of size 2^( 7) =       0.000458203268

      target function =                  N/A
              le_mean =     -16.906967301184
             les_mean =     286.180737021070
             stat err =       0.000449468049
             autocorr =       1.255736793244
              std dev =       0.567236949294
             le_variance =       0.321757756644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321881259770
                                         uncertainty =       0.002539406242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321881259770
                                         uncertainty =       0.002539406242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124753
  error estimate for blocks of size 2^( 2) =       0.000413474721
  error estimate for blocks of size 2^( 3) =       0.000426208581
  error estimate for blocks of size 2^( 4) =       0.000437544574
  error estimate for blocks of size 2^( 5) =       0.000447818909
  error estimate for blocks of size 2^( 6) =       0.000454420375
  error estimate for blocks of size 2^( 7) =       0.000458230438

      target function =                  N/A
              le_mean =     -16.906964981040
             les_mean =     286.301965561259
             stat err =       0.000449503574
             autocorr =       1.255762101776
              std dev =       0.567276066553
             le_variance =       0.321802135683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321851943048
                                         uncertainty =       0.002538717889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321851943048
                                         uncertainty =       0.002538717889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401106504
  error estimate for blocks of size 2^( 2) =       0.000413455364
  error estimate for blocks of size 2^( 3) =       0.000426188102
  error estimate for blocks of size 2^( 4) =       0.000437522631
  error estimate for blocks of size 2^( 5) =       0.000447796102
  error estimate for blocks of size 2^( 6) =       0.000454388656
  error estimate for blocks of size 2^( 7) =       0.000458212150

      target function =                  N/A
              le_mean =     -16.906966746773
             les_mean =     286.180844145422
             stat err =       0.000449479885
             autocorr =       1.255744005309
              std dev =       0.567250257754
             le_variance =       0.321772854922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321838026073
                                         uncertainty =       0.002538185319

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321838026073
                                         uncertainty =       0.002538185319

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401097829
  error estimate for blocks of size 2^( 2) =       0.000413445555
  error estimate for blocks of size 2^( 3) =       0.000426177881
  error estimate for blocks of size 2^( 4) =       0.000437510476
  error estimate for blocks of size 2^( 5) =       0.000447786448
  error estimate for blocks of size 2^( 6) =       0.000454375998
  error estimate for blocks of size 2^( 7) =       0.000458204140

      target function =                  N/A
              le_mean =     -16.906967135152
             les_mean =     286.180692270294
             stat err =       0.000449469265
             autocorr =       1.255738986318
              std dev =       0.567237989582
             le_variance =       0.321758936826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906967301184        initial  <--
     9.5367e-01     9.5367e+00             3.4350e-04       -16.906964981040
     3.8147e+00     3.8147e+01             9.5926e-05       -16.906966746773
     1.5259e+01     1.5259e+02             2.4707e-05       -16.906967135152

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0219
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_0001                 7.011282e-01 3 1  ON 0
ci_0002                 7.004183e-01 3 1  ON 1
ci_0003                -2.812546e-02 3 1  ON 2
ci_0004                -2.821530e-02 3 1  ON 3
ci_0005                -3.414789e-02 3 1  ON 4
ci_0006                -3.465031e-02 3 1  ON 5
ci_0007                -2.235493e-02 3 1  ON 6
ci_0008                -2.435673e-02 3 1  ON 7
ci_0009                -1.797377e-02 3 1  ON 8
ci_0010                -1.808611e-02 3 1  ON 9
ci_0011                -1.329058e-02 3 1  ON 10
ci_0012                -1.280328e-02 3 1  ON 11
ci_0013                 1.325642e-02 3 1  ON 12
ci_0014                 1.366821e-02 3 1  ON 13
ci_0015                 1.365578e-02 3 1  ON 14
ci_0016                 1.339614e-02 3 1  ON 15
ci_0017                 1.220344e-02 3 1  ON 16
ci_0018                 1.209249e-02 3 1  ON 17
ci_0019                 1.214220e-02 3 1  ON 18
ci_0020                 1.125805e-02 3 1  ON 19
ci_0021                 2.456131e-03 3 1  ON 20
ci_0022                 3.227904e-03 3 1  ON 21
ci_0023                -1.138926e-02 3 1  ON 22
ci_0024                -1.125077e-02 3 1  ON 23
ci_0025                -1.054880e-02 3 1  ON 24
ci_0026                -1.070249e-02 3 1  ON 25
ci_0027                -1.175780e-02 3 1  ON 26
ci_0028                -1.143110e-02 3 1  ON 27
ci_0029                -1.087605e-02 3 1  ON 28
ci_0030                -1.075424e-02 3 1  ON 29
ci_0031                 1.956892e-02 3 1  ON 30
ci_0032                 1.944895e-02 3 1  ON 31
ci_0033                 9.383939e-03 3 1  ON 32
ci_0034                 1.059457e-02 3 1  ON 33
ci_0035                 6.901246e-03 3 1  ON 34
ci_0036                 6.559591e-03 3 1  ON 35
ci_0037                -9.925103e-03 3 1  ON 36
ci_0038                -1.002145e-02 3 1  ON 37
ci_0039                -2.772047e-03 3 1  ON 38
ci_0040                -2.743137e-03 3 1  ON 39
ci_0041                 8.061215e-03 3 1  ON 40
ci_0042                 7.377814e-03 3 1  ON 41
ci_0043                -1.462687e-02 3 1  ON 42
ci_0044                -1.550045e-02 3 1  ON 43
ci_0045                 7.219635e-03 3 1  ON 44
ci_0046                 7.719807e-03 3 1  ON 45
ci_0047                -2.185122e-03 3 1  ON 46
ci_0048                -1.933021e-03 3 1  ON 47
ci_0049                -5.372730e-03 3 1  ON 48
ci_0050                -6.044660e-03 3 1  ON 49
ci_0051                -3.655272e-03 3 1  ON 50
ci_0052                -3.816301e-03 3 1  ON 51
ci_0053                -4.693310e-03 3 1  ON 52
ci_0054                -4.983721e-03 3 1  ON 53
ci_0055                 6.162170e-03 3 1  ON 54
ci_0056                 6.751936e-03 3 1  ON 55
ci_0057                 4.143367e-03 3 1  ON 56
ci_0058                 5.104020e-03 3 1  ON 57
ci_0059                -5.239979e-03 3 1  ON 58
ci_0060                -4.766831e-03 3 1  ON 59
ci_0061                -3.543494e-03 3 1  ON 60
ci_0062                -2.927897e-03 3 1  ON 61
ci_0063                -9.038563e-03 3 1  ON 62
ci_0064                -8.847014e-03 3 1  ON 63
ci_0065                -5.898442e-03 3 1  ON 64
ci_0066                -5.125811e-03 3 1  ON 65
ci_0067                -5.437728e-03 3 1  ON 66
ci_0068                -5.585217e-03 3 1  ON 67
ci_0069                 5.107456e-03 3 1  ON 68
ci_0070                 4.538629e-03 3 1  ON 69
ci_0071                 1.669367e-03 3 1  ON 70
ci_0072                 2.269975e-03 3 1  ON 71
ci_0073                 4.863571e-03 3 1  ON 72
ci_0074                 4.057720e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1480e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8401
    reference variance = 0.546134
====================================================
  Execution time = 1.5211e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3965e-01
  Total weights = 1.951372188e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 3.0958e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322694494615
                                         uncertainty =       0.002587801580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322694494615
                                         uncertainty =       0.002587801580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401650240
  error estimate for blocks of size 2^( 2) =       0.000414260493
  error estimate for blocks of size 2^( 3) =       0.000427629586
  error estimate for blocks of size 2^( 4) =       0.000440548920
  error estimate for blocks of size 2^( 5) =       0.000450420165
  error estimate for blocks of size 2^( 6) =       0.000458994818
  error estimate for blocks of size 2^( 7) =       0.000464498909

      target function =                  N/A
              le_mean =     -16.906127401908
             les_mean =     286.156792667970
             stat err =       0.000453615703
             autocorr =       1.275498933191
              std dev =       0.568019216467
             le_variance =       0.322645830276


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612740191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127401942       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127382633       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127424658       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127426565       residual = 3.57e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+00 is 4.265705e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127401942       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127397035       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127407388       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127407992       residual = 3.90e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+01 is 1.087023e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127401942       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127400710       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127403288       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127403447       residual = 4.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+02 is 2.730743e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163568 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9920e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.011299e-01 3 1  ON 0
ci_0002                 7.004167e-01 3 1  ON 1
ci_0003                -2.813132e-02 3 1  ON 2
ci_0004                -2.821775e-02 3 1  ON 3
ci_0005                -3.414620e-02 3 1  ON 4
ci_0006                -3.465020e-02 3 1  ON 5
ci_0007                -2.235892e-02 3 1  ON 6
ci_0008                -2.435264e-02 3 1  ON 7
ci_0009                -1.796744e-02 3 1  ON 8
ci_0010                -1.808339e-02 3 1  ON 9
ci_0011                -1.328881e-02 3 1  ON 10
ci_0012                -1.279923e-02 3 1  ON 11
ci_0013                 1.326414e-02 3 1  ON 12
ci_0014                 1.366749e-02 3 1  ON 13
ci_0015                 1.365401e-02 3 1  ON 14
ci_0016                 1.339551e-02 3 1  ON 15
ci_0017                 1.220139e-02 3 1  ON 16
ci_0018                 1.209235e-02 3 1  ON 17
ci_0019                 1.214070e-02 3 1  ON 18
ci_0020                 1.125842e-02 3 1  ON 19
ci_0021                 2.454512e-03 3 1  ON 20
ci_0022                 3.222281e-03 3 1  ON 21
ci_0023                -1.138260e-02 3 1  ON 22
ci_0024                -1.124606e-02 3 1  ON 23
ci_0025                -1.055313e-02 3 1  ON 24
ci_0026                -1.070785e-02 3 1  ON 25
ci_0027                -1.175338e-02 3 1  ON 26
ci_0028                -1.142920e-02 3 1  ON 27
ci_0029                -1.087701e-02 3 1  ON 28
ci_0030                -1.075787e-02 3 1  ON 29
ci_0031                 1.956425e-02 3 1  ON 30
ci_0032                 1.944702e-02 3 1  ON 31
ci_0033                 9.390900e-03 3 1  ON 32
ci_0034                 1.059341e-02 3 1  ON 33
ci_0035                 6.896182e-03 3 1  ON 34
ci_0036                 6.561706e-03 3 1  ON 35
ci_0037                -9.924799e-03 3 1  ON 36
ci_0038                -1.002405e-02 3 1  ON 37
ci_0039                -2.770780e-03 3 1  ON 38
ci_0040                -2.746065e-03 3 1  ON 39
ci_0041                 8.052224e-03 3 1  ON 40
ci_0042                 7.378645e-03 3 1  ON 41
ci_0043                -1.462841e-02 3 1  ON 42
ci_0044                -1.550008e-02 3 1  ON 43
ci_0045                 7.223705e-03 3 1  ON 44
ci_0046                 7.716785e-03 3 1  ON 45
ci_0047                -2.182542e-03 3 1  ON 46
ci_0048                -1.934229e-03 3 1  ON 47
ci_0049                -5.373874e-03 3 1  ON 48
ci_0050                -6.039967e-03 3 1  ON 49
ci_0051                -3.654189e-03 3 1  ON 50
ci_0052                -3.818123e-03 3 1  ON 51
ci_0053                -4.694433e-03 3 1  ON 52
ci_0054                -4.984697e-03 3 1  ON 53
ci_0055                 6.165345e-03 3 1  ON 54
ci_0056                 6.750759e-03 3 1  ON 55
ci_0057                 4.149626e-03 3 1  ON 56
ci_0058                 5.108468e-03 3 1  ON 57
ci_0059                -5.235067e-03 3 1  ON 58
ci_0060                -4.770602e-03 3 1  ON 59
ci_0061                -3.539481e-03 3 1  ON 60
ci_0062                -2.929852e-03 3 1  ON 61
ci_0063                -9.042142e-03 3 1  ON 62
ci_0064                -8.853034e-03 3 1  ON 63
ci_0065                -5.893083e-03 3 1  ON 64
ci_0066                -5.136681e-03 3 1  ON 65
ci_0067                -5.438625e-03 3 1  ON 66
ci_0068                -5.586369e-03 3 1  ON 67
ci_0069                 5.107085e-03 3 1  ON 68
ci_0070                 4.540281e-03 3 1  ON 69
ci_0071                 1.673111e-03 3 1  ON 70
ci_0072                 2.276751e-03 3 1  ON 71
ci_0073                 4.854876e-03 3 1  ON 72
ci_0074                 4.060253e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9932
    reference variance = 0.336229
====================================================
  Execution time = 1.4533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3947e-01
  Total weights = 1.9519e+06
  Execution time = 1.9171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324222664976
                                         uncertainty =       0.002016855003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324222664976
                                         uncertainty =       0.002016855003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402646664
  error estimate for blocks of size 2^( 2) =       0.000415617100
  error estimate for blocks of size 2^( 3) =       0.000428491833
  error estimate for blocks of size 2^( 4) =       0.000440776926
  error estimate for blocks of size 2^( 5) =       0.000451899785
  error estimate for blocks of size 2^( 6) =       0.000460331894
  error estimate for blocks of size 2^( 7) =       0.000466949823

      target function =                  N/A
              le_mean =     -16.906333864297
             les_mean =     286.163578945399
             stat err =       0.000454989607
             autocorr =       1.276893697891
              std dev =       0.569428372678
             le_variance =       0.324248671611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324232381180
                                         uncertainty =       0.002017027618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324232381180
                                         uncertainty =       0.002017027618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402652742
  error estimate for blocks of size 2^( 2) =       0.000415623418
  error estimate for blocks of size 2^( 3) =       0.000428498127
  error estimate for blocks of size 2^( 4) =       0.000440783864
  error estimate for blocks of size 2^( 5) =       0.000451906638
  error estimate for blocks of size 2^( 6) =       0.000460339120
  error estimate for blocks of size 2^( 7) =       0.000466957093

      target function =                  N/A
              le_mean =     -16.906333852570
             les_mean =     286.163673610091
             stat err =       0.000454996679
             autocorr =       1.276894837087
              std dev =       0.569436968795
             le_variance =       0.324258461431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324227537911
                                         uncertainty =       0.002016941936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324227537911
                                         uncertainty =       0.002016941936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402649712
  error estimate for blocks of size 2^( 2) =       0.000415620273
  error estimate for blocks of size 2^( 3) =       0.000428494993
  error estimate for blocks of size 2^( 4) =       0.000440780411
  error estimate for blocks of size 2^( 5) =       0.000451903235
  error estimate for blocks of size 2^( 6) =       0.000460335543
  error estimate for blocks of size 2^( 7) =       0.000466953491

      target function =                  N/A
              le_mean =     -16.906333850398
             les_mean =     286.163617896281
             stat err =       0.000454993170
             autocorr =       1.276894358821
              std dev =       0.569432684215
             le_variance =       0.324253581852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324223268133
                                         uncertainty =       0.002016865628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324223268133
                                         uncertainty =       0.002016865628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402647041
  error estimate for blocks of size 2^( 2) =       0.000415617494
  error estimate for blocks of size 2^( 3) =       0.000428492225
  error estimate for blocks of size 2^( 4) =       0.000440777358
  error estimate for blocks of size 2^( 5) =       0.000451900214
  error estimate for blocks of size 2^( 6) =       0.000460332349
  error estimate for blocks of size 2^( 7) =       0.000466950280

      target function =                  N/A
              le_mean =     -16.906333861527
             les_mean =     286.163582810618
             stat err =       0.000454990050
             autocorr =       1.276893790937
              std dev =       0.569428906372
             le_variance =       0.324249279412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906333864297        initial  <--
     9.5367e+00     9.5367e+01             4.2657e-05       -16.906333852570
     3.8147e+01     3.8147e+02             1.0870e-05       -16.906333850398
     1.5259e+02     1.5259e+03             2.7307e-06       -16.906333861527

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.2438
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_0001                 7.011282e-01 3 1  ON 0
ci_0002                 7.004183e-01 3 1  ON 1
ci_0003                -2.812546e-02 3 1  ON 2
ci_0004                -2.821530e-02 3 1  ON 3
ci_0005                -3.414789e-02 3 1  ON 4
ci_0006                -3.465031e-02 3 1  ON 5
ci_0007                -2.235493e-02 3 1  ON 6
ci_0008                -2.435673e-02 3 1  ON 7
ci_0009                -1.797377e-02 3 1  ON 8
ci_0010                -1.808611e-02 3 1  ON 9
ci_0011                -1.329058e-02 3 1  ON 10
ci_0012                -1.280328e-02 3 1  ON 11
ci_0013                 1.325642e-02 3 1  ON 12
ci_0014                 1.366821e-02 3 1  ON 13
ci_0015                 1.365578e-02 3 1  ON 14
ci_0016                 1.339614e-02 3 1  ON 15
ci_0017                 1.220344e-02 3 1  ON 16
ci_0018                 1.209249e-02 3 1  ON 17
ci_0019                 1.214220e-02 3 1  ON 18
ci_0020                 1.125805e-02 3 1  ON 19
ci_0021                 2.456131e-03 3 1  ON 20
ci_0022                 3.227904e-03 3 1  ON 21
ci_0023                -1.138926e-02 3 1  ON 22
ci_0024                -1.125077e-02 3 1  ON 23
ci_0025                -1.054880e-02 3 1  ON 24
ci_0026                -1.070249e-02 3 1  ON 25
ci_0027                -1.175780e-02 3 1  ON 26
ci_0028                -1.143110e-02 3 1  ON 27
ci_0029                -1.087605e-02 3 1  ON 28
ci_0030                -1.075424e-02 3 1  ON 29
ci_0031                 1.956892e-02 3 1  ON 30
ci_0032                 1.944895e-02 3 1  ON 31
ci_0033                 9.383939e-03 3 1  ON 32
ci_0034                 1.059457e-02 3 1  ON 33
ci_0035                 6.901246e-03 3 1  ON 34
ci_0036                 6.559591e-03 3 1  ON 35
ci_0037                -9.925103e-03 3 1  ON 36
ci_0038                -1.002145e-02 3 1  ON 37
ci_0039                -2.772047e-03 3 1  ON 38
ci_0040                -2.743137e-03 3 1  ON 39
ci_0041                 8.061215e-03 3 1  ON 40
ci_0042                 7.377814e-03 3 1  ON 41
ci_0043                -1.462687e-02 3 1  ON 42
ci_0044                -1.550045e-02 3 1  ON 43
ci_0045                 7.219635e-03 3 1  ON 44
ci_0046                 7.719807e-03 3 1  ON 45
ci_0047                -2.185122e-03 3 1  ON 46
ci_0048                -1.933021e-03 3 1  ON 47
ci_0049                -5.372730e-03 3 1  ON 48
ci_0050                -6.044660e-03 3 1  ON 49
ci_0051                -3.655272e-03 3 1  ON 50
ci_0052                -3.816301e-03 3 1  ON 51
ci_0053                -4.693310e-03 3 1  ON 52
ci_0054                -4.983721e-03 3 1  ON 53
ci_0055                 6.162170e-03 3 1  ON 54
ci_0056                 6.751936e-03 3 1  ON 55
ci_0057                 4.143367e-03 3 1  ON 56
ci_0058                 5.104020e-03 3 1  ON 57
ci_0059                -5.239979e-03 3 1  ON 58
ci_0060                -4.766831e-03 3 1  ON 59
ci_0061                -3.543494e-03 3 1  ON 60
ci_0062                -2.927897e-03 3 1  ON 61
ci_0063                -9.038563e-03 3 1  ON 62
ci_0064                -8.847014e-03 3 1  ON 63
ci_0065                -5.898442e-03 3 1  ON 64
ci_0066                -5.125811e-03 3 1  ON 65
ci_0067                -5.437728e-03 3 1  ON 66
ci_0068                -5.585217e-03 3 1  ON 67
ci_0069                 5.107456e-03 3 1  ON 68
ci_0070                 4.538629e-03 3 1  ON 69
ci_0071                 1.669367e-03 3 1  ON 70
ci_0072                 2.269975e-03 3 1  ON 71
ci_0073                 4.863571e-03 3 1  ON 72
ci_0074                 4.057720e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4170e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8845
    reference variance = 0.226422
====================================================
  Execution time = 1.4973e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3982e-01
  Total weights = 1.951761683e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324115573959
                                         uncertainty =       0.002720204507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324115573959
                                         uncertainty =       0.002720204507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402530684
  error estimate for blocks of size 2^( 2) =       0.000415316447
  error estimate for blocks of size 2^( 3) =       0.000428565953
  error estimate for blocks of size 2^( 4) =       0.000441196658
  error estimate for blocks of size 2^( 5) =       0.000452937914
  error estimate for blocks of size 2^( 6) =       0.000462295564
  error estimate for blocks of size 2^( 7) =       0.000470078220

      target function =                  N/A
              le_mean =     -16.905456034548
             les_mean =     286.134261329191
             stat err =       0.000456627089
             autocorr =       1.286842401524
              std dev =       0.569264352078
             le_variance =       0.324061902547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545603455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905456034537       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905456071376       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905456071251       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905456071949       residual = 2.17e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 5.375425e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905456034537       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905456043760       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905456043727       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905456043901       residual = 2.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.344783e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905456034537       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905456036843       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905456036835       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905456036878       residual = 2.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.5259e+03 is 3.362538e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164836 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7584e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.011282e-01 3 1  ON 0
ci_0002                 7.004184e-01 3 1  ON 1
ci_0003                -2.812498e-02 3 1  ON 2
ci_0004                -2.821504e-02 3 1  ON 3
ci_0005                -3.414826e-02 3 1  ON 4
ci_0006                -3.465049e-02 3 1  ON 5
ci_0007                -2.235428e-02 3 1  ON 6
ci_0008                -2.435538e-02 3 1  ON 7
ci_0009                -1.797369e-02 3 1  ON 8
ci_0010                -1.808620e-02 3 1  ON 9
ci_0011                -1.328964e-02 3 1  ON 10
ci_0012                -1.280259e-02 3 1  ON 11
ci_0013                 1.325676e-02 3 1  ON 12
ci_0014                 1.366820e-02 3 1  ON 13
ci_0015                 1.365649e-02 3 1  ON 14
ci_0016                 1.339640e-02 3 1  ON 15
ci_0017                 1.220290e-02 3 1  ON 16
ci_0018                 1.209255e-02 3 1  ON 17
ci_0019                 1.214256e-02 3 1  ON 18
ci_0020                 1.125813e-02 3 1  ON 19
ci_0021                 2.455934e-03 3 1  ON 20
ci_0022                 3.227694e-03 3 1  ON 21
ci_0023                -1.138936e-02 3 1  ON 22
ci_0024                -1.125067e-02 3 1  ON 23
ci_0025                -1.054913e-02 3 1  ON 24
ci_0026                -1.070366e-02 3 1  ON 25
ci_0027                -1.175744e-02 3 1  ON 26
ci_0028                -1.143104e-02 3 1  ON 27
ci_0029                -1.087644e-02 3 1  ON 28
ci_0030                -1.075412e-02 3 1  ON 29
ci_0031                 1.956835e-02 3 1  ON 30
ci_0032                 1.944843e-02 3 1  ON 31
ci_0033                 9.384882e-03 3 1  ON 32
ci_0034                 1.059485e-02 3 1  ON 33
ci_0035                 6.901943e-03 3 1  ON 34
ci_0036                 6.559168e-03 3 1  ON 35
ci_0037                -9.924802e-03 3 1  ON 36
ci_0038                -1.002177e-02 3 1  ON 37
ci_0039                -2.772058e-03 3 1  ON 38
ci_0040                -2.743072e-03 3 1  ON 39
ci_0041                 8.061394e-03 3 1  ON 40
ci_0042                 7.377626e-03 3 1  ON 41
ci_0043                -1.462734e-02 3 1  ON 42
ci_0044                -1.550045e-02 3 1  ON 43
ci_0045                 7.219715e-03 3 1  ON 44
ci_0046                 7.719793e-03 3 1  ON 45
ci_0047                -2.184975e-03 3 1  ON 46
ci_0048                -1.932675e-03 3 1  ON 47
ci_0049                -5.373244e-03 3 1  ON 48
ci_0050                -6.044035e-03 3 1  ON 49
ci_0051                -3.655140e-03 3 1  ON 50
ci_0052                -3.815821e-03 3 1  ON 51
ci_0053                -4.693708e-03 3 1  ON 52
ci_0054                -4.983290e-03 3 1  ON 53
ci_0055                 6.162985e-03 3 1  ON 54
ci_0056                 6.751814e-03 3 1  ON 55
ci_0057                 4.142572e-03 3 1  ON 56
ci_0058                 5.103831e-03 3 1  ON 57
ci_0059                -5.240099e-03 3 1  ON 58
ci_0060                -4.766955e-03 3 1  ON 59
ci_0061                -3.543482e-03 3 1  ON 60
ci_0062                -2.927951e-03 3 1  ON 61
ci_0063                -9.037994e-03 3 1  ON 62
ci_0064                -8.846593e-03 3 1  ON 63
ci_0065                -5.898382e-03 3 1  ON 64
ci_0066                -5.126257e-03 3 1  ON 65
ci_0067                -5.437889e-03 3 1  ON 66
ci_0068                -5.584517e-03 3 1  ON 67
ci_0069                 5.106614e-03 3 1  ON 68
ci_0070                 4.538914e-03 3 1  ON 69
ci_0071                 1.669910e-03 3 1  ON 70
ci_0072                 2.269982e-03 3 1  ON 71
ci_0073                 4.863039e-03 3 1  ON 72
ci_0074                 4.057891e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9417
    reference variance = 0.123547
====================================================
  Execution time = 1.4400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2879e-01
  Total weights = 1.9513e+06
  Execution time = 1.9214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674767199
                                         uncertainty =       0.001991076332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674767199
                                         uncertainty =       0.001991076332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399160431
  error estimate for blocks of size 2^( 2) =       0.000412251910
  error estimate for blocks of size 2^( 3) =       0.000425920811
  error estimate for blocks of size 2^( 4) =       0.000438239801
  error estimate for blocks of size 2^( 5) =       0.000449805026
  error estimate for blocks of size 2^( 6) =       0.000459932167
  error estimate for blocks of size 2^( 7) =       0.000466039279

      target function =                  N/A
              le_mean =     -16.905719865623
             les_mean =     286.132150239237
             stat err =       0.000453504068
             autocorr =       1.290825121979
              std dev =       0.564498094898
             le_variance =       0.318658099143

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674852117
                                         uncertainty =       0.001991101707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674852117
                                         uncertainty =       0.001991101707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399160491
  error estimate for blocks of size 2^( 2) =       0.000412252035
  error estimate for blocks of size 2^( 3) =       0.000425921021
  error estimate for blocks of size 2^( 4) =       0.000438239952
  error estimate for blocks of size 2^( 5) =       0.000449805266
  error estimate for blocks of size 2^( 6) =       0.000459932355
  error estimate for blocks of size 2^( 7) =       0.000466039815

      target function =                  N/A
              le_mean =     -16.905719866366
             les_mean =     286.132150504093
             stat err =       0.000453504347
             autocorr =       1.290826322901
              std dev =       0.564498179609
             le_variance =       0.318658194782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674808398
                                         uncertainty =       0.001991089038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674808398
                                         uncertainty =       0.001991089038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399160460
  error estimate for blocks of size 2^( 2) =       0.000412251972
  error estimate for blocks of size 2^( 3) =       0.000425920915
  error estimate for blocks of size 2^( 4) =       0.000438239876
  error estimate for blocks of size 2^( 5) =       0.000449805145
  error estimate for blocks of size 2^( 6) =       0.000459932260
  error estimate for blocks of size 2^( 7) =       0.000466039547

      target function =                  N/A
              le_mean =     -16.905719865848
             les_mean =     286.132150176436
             stat err =       0.000453504207
             autocorr =       1.290825724702
              std dev =       0.564498136146
             le_variance =       0.318658145713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674772235
                                         uncertainty =       0.001991077920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318674772235
                                         uncertainty =       0.001991077920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399160434
  error estimate for blocks of size 2^( 2) =       0.000412251918
  error estimate for blocks of size 2^( 3) =       0.000425920824
  error estimate for blocks of size 2^( 4) =       0.000438239811
  error estimate for blocks of size 2^( 5) =       0.000449805041
  error estimate for blocks of size 2^( 6) =       0.000459932179
  error estimate for blocks of size 2^( 7) =       0.000466039312

      target function =                  N/A
              le_mean =     -16.905719865636
             les_mean =     286.132150216084
             stat err =       0.000453504085
             autocorr =       1.290825197453
              std dev =       0.564498099953
             le_variance =       0.318658104850


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905719865623        initial
     9.5367e+01     9.5367e+02             5.3754e-06       -16.905719866366  <--
     3.8147e+02     3.8147e+03             1.3448e-06       -16.905719865848
     1.5259e+03     1.5259e+04             3.3625e-07       -16.905719865636

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.4134e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_0001                 7.011280e-01 3 1  ON 0
ci_0002                 7.004188e-01 3 1  ON 1
ci_0003                -2.812354e-02 3 1  ON 2
ci_0004                -2.821427e-02 3 1  ON 3
ci_0005                -3.414937e-02 3 1  ON 4
ci_0006                -3.465104e-02 3 1  ON 5
ci_0007                -2.235231e-02 3 1  ON 6
ci_0008                -2.435135e-02 3 1  ON 7
ci_0009                -1.797344e-02 3 1  ON 8
ci_0010                -1.808646e-02 3 1  ON 9
ci_0011                -1.328684e-02 3 1  ON 10
ci_0012                -1.280053e-02 3 1  ON 11
ci_0013                 1.325779e-02 3 1  ON 12
ci_0014                 1.366816e-02 3 1  ON 13
ci_0015                 1.365863e-02 3 1  ON 14
ci_0016                 1.339719e-02 3 1  ON 15
ci_0017                 1.220130e-02 3 1  ON 16
ci_0018                 1.209274e-02 3 1  ON 17
ci_0019                 1.214363e-02 3 1  ON 18
ci_0020                 1.125837e-02 3 1  ON 19
ci_0021                 2.455344e-03 3 1  ON 20
ci_0022                 3.227067e-03 3 1  ON 21
ci_0023                -1.138965e-02 3 1  ON 22
ci_0024                -1.125039e-02 3 1  ON 23
ci_0025                -1.055012e-02 3 1  ON 24
ci_0026                -1.070717e-02 3 1  ON 25
ci_0027                -1.175637e-02 3 1  ON 26
ci_0028                -1.143087e-02 3 1  ON 27
ci_0029                -1.087761e-02 3 1  ON 28
ci_0030                -1.075377e-02 3 1  ON 29
ci_0031                 1.956664e-02 3 1  ON 30
ci_0032                 1.944688e-02 3 1  ON 31
ci_0033                 9.387709e-03 3 1  ON 32
ci_0034                 1.059567e-02 3 1  ON 33
ci_0035                 6.904030e-03 3 1  ON 34
ci_0036                 6.557901e-03 3 1  ON 35
ci_0037                -9.923900e-03 3 1  ON 36
ci_0038                -1.002272e-02 3 1  ON 37
ci_0039                -2.772092e-03 3 1  ON 38
ci_0040                -2.742876e-03 3 1  ON 39
ci_0041                 8.061930e-03 3 1  ON 40
ci_0042                 7.377066e-03 3 1  ON 41
ci_0043                -1.462874e-02 3 1  ON 42
ci_0044                -1.550044e-02 3 1  ON 43
ci_0045                 7.219951e-03 3 1  ON 44
ci_0046                 7.719752e-03 3 1  ON 45
ci_0047                -2.184535e-03 3 1  ON 46
ci_0048                -1.931642e-03 3 1  ON 47
ci_0049                -5.374783e-03 3 1  ON 48
ci_0050                -6.042162e-03 3 1  ON 49
ci_0051                -3.654747e-03 3 1  ON 50
ci_0052                -3.814383e-03 3 1  ON 51
ci_0053                -4.694901e-03 3 1  ON 52
ci_0054                -4.981999e-03 3 1  ON 53
ci_0055                 6.165427e-03 3 1  ON 54
ci_0056                 6.751450e-03 3 1  ON 55
ci_0057                 4.140189e-03 3 1  ON 56
ci_0058                 5.103268e-03 3 1  ON 57
ci_0059                -5.240459e-03 3 1  ON 58
ci_0060                -4.767323e-03 3 1  ON 59
ci_0061                -3.543449e-03 3 1  ON 60
ci_0062                -2.928113e-03 3 1  ON 61
ci_0063                -9.036290e-03 3 1  ON 62
ci_0064                -8.845335e-03 3 1  ON 63
ci_0065                -5.898202e-03 3 1  ON 64
ci_0066                -5.127594e-03 3 1  ON 65
ci_0067                -5.438371e-03 3 1  ON 66
ci_0068                -5.582426e-03 3 1  ON 67
ci_0069                 5.104095e-03 3 1  ON 68
ci_0070                 4.539767e-03 3 1  ON 69
ci_0071                 1.671535e-03 3 1  ON 70
ci_0072                 2.270003e-03 3 1  ON 71
ci_0073                 4.861450e-03 3 1  ON 72
ci_0074                 4.058403e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8506
    reference variance = 0.257026
====================================================
  Execution time = 1.4730e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3863e-01
  Total weights = 1.951583806e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325358677568
                                         uncertainty =       0.004595509029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325358677568
                                         uncertainty =       0.004595509029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403280000
  error estimate for blocks of size 2^( 2) =       0.000416258926
  error estimate for blocks of size 2^( 3) =       0.000429676688
  error estimate for blocks of size 2^( 4) =       0.000442284205
  error estimate for blocks of size 2^( 5) =       0.000452006019
  error estimate for blocks of size 2^( 6) =       0.000460884877
  error estimate for blocks of size 2^( 7) =       0.000463518603

      target function =                  N/A
              le_mean =     -16.905803829220
             les_mean =     286.144830049160
             stat err =       0.000454673426
             autocorr =       1.271117724537
              std dev =       0.570324045872
             le_variance =       0.325269517300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580382922e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905803829227       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905803924152       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905803924820       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905803927473       residual = 2.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.768986e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905803829227       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905803853106       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905803853145       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905803853826       residual = 2.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 4.449715e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905803829227       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905803835206       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905803835208       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905803835379       residual = 2.91e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.8147e+02 is 1.114145e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7341e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.011282e-01 3 1  ON 0
ci_0002                 7.004188e-01 3 1  ON 1
ci_0003                -2.812282e-02 3 1  ON 2
ci_0004                -2.821513e-02 3 1  ON 3
ci_0005                -3.414939e-02 3 1  ON 4
ci_0006                -3.465187e-02 3 1  ON 5
ci_0007                -2.235172e-02 3 1  ON 6
ci_0008                -2.434756e-02 3 1  ON 7
ci_0009                -1.797171e-02 3 1  ON 8
ci_0010                -1.808697e-02 3 1  ON 9
ci_0011                -1.328639e-02 3 1  ON 10
ci_0012                -1.280294e-02 3 1  ON 11
ci_0013                 1.325830e-02 3 1  ON 12
ci_0014                 1.366744e-02 3 1  ON 13
ci_0015                 1.365840e-02 3 1  ON 14
ci_0016                 1.339786e-02 3 1  ON 15
ci_0017                 1.220133e-02 3 1  ON 16
ci_0018                 1.209227e-02 3 1  ON 17
ci_0019                 1.214185e-02 3 1  ON 18
ci_0020                 1.125782e-02 3 1  ON 19
ci_0021                 2.455076e-03 3 1  ON 20
ci_0022                 3.227616e-03 3 1  ON 21
ci_0023                -1.138987e-02 3 1  ON 22
ci_0024                -1.125111e-02 3 1  ON 23
ci_0025                -1.055165e-02 3 1  ON 24
ci_0026                -1.070770e-02 3 1  ON 25
ci_0027                -1.175453e-02 3 1  ON 26
ci_0028                -1.143061e-02 3 1  ON 27
ci_0029                -1.087606e-02 3 1  ON 28
ci_0030                -1.075542e-02 3 1  ON 29
ci_0031                 1.956607e-02 3 1  ON 30
ci_0032                 1.944620e-02 3 1  ON 31
ci_0033                 9.387408e-03 3 1  ON 32
ci_0034                 1.059682e-02 3 1  ON 33
ci_0035                 6.902643e-03 3 1  ON 34
ci_0036                 6.557869e-03 3 1  ON 35
ci_0037                -9.923794e-03 3 1  ON 36
ci_0038                -1.002419e-02 3 1  ON 37
ci_0039                -2.772531e-03 3 1  ON 38
ci_0040                -2.743631e-03 3 1  ON 39
ci_0041                 8.062199e-03 3 1  ON 40
ci_0042                 7.376729e-03 3 1  ON 41
ci_0043                -1.463031e-02 3 1  ON 42
ci_0044                -1.550088e-02 3 1  ON 43
ci_0045                 7.220080e-03 3 1  ON 44
ci_0046                 7.720310e-03 3 1  ON 45
ci_0047                -2.185332e-03 3 1  ON 46
ci_0048                -1.931012e-03 3 1  ON 47
ci_0049                -5.374514e-03 3 1  ON 48
ci_0050                -6.038794e-03 3 1  ON 49
ci_0051                -3.653871e-03 3 1  ON 50
ci_0052                -3.813142e-03 3 1  ON 51
ci_0053                -4.696947e-03 3 1  ON 52
ci_0054                -4.980699e-03 3 1  ON 53
ci_0055                 6.166491e-03 3 1  ON 54
ci_0056                 6.749575e-03 3 1  ON 55
ci_0057                 4.140904e-03 3 1  ON 56
ci_0058                 5.101994e-03 3 1  ON 57
ci_0059                -5.238331e-03 3 1  ON 58
ci_0060                -4.768340e-03 3 1  ON 59
ci_0061                -3.547898e-03 3 1  ON 60
ci_0062                -2.929912e-03 3 1  ON 61
ci_0063                -9.035413e-03 3 1  ON 62
ci_0064                -8.844706e-03 3 1  ON 63
ci_0065                -5.900737e-03 3 1  ON 64
ci_0066                -5.127290e-03 3 1  ON 65
ci_0067                -5.437419e-03 3 1  ON 66
ci_0068                -5.579605e-03 3 1  ON 67
ci_0069                 5.103577e-03 3 1  ON 68
ci_0070                 4.540119e-03 3 1  ON 69
ci_0071                 1.672269e-03 3 1  ON 70
ci_0072                 2.269053e-03 3 1  ON 71
ci_0073                 4.862452e-03 3 1  ON 72
ci_0074                 4.059715e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9007
    reference variance = 0.28114
====================================================
  Execution time = 1.4720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3040e-01
  Total weights = 1.9521e+06
  Execution time = 1.9263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965517737
                                         uncertainty =       0.001880254849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965517737
                                         uncertainty =       0.001880254849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399305596
  error estimate for blocks of size 2^( 2) =       0.000411989631
  error estimate for blocks of size 2^( 3) =       0.000424868007
  error estimate for blocks of size 2^( 4) =       0.000437019416
  error estimate for blocks of size 2^( 5) =       0.000448067830
  error estimate for blocks of size 2^( 6) =       0.000456674880
  error estimate for blocks of size 2^( 7) =       0.000463049788

      target function =                  N/A
              le_mean =     -16.906135280529
             les_mean =     286.147806569689
             stat err =       0.000451202978
             autocorr =       1.276830131583
              std dev =       0.564703389112
             le_variance =       0.318889917675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318963916586
                                         uncertainty =       0.001880141502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318963916586
                                         uncertainty =       0.001880141502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399304579
  error estimate for blocks of size 2^( 2) =       0.000411988916
  error estimate for blocks of size 2^( 3) =       0.000424867585
  error estimate for blocks of size 2^( 4) =       0.000437019016
  error estimate for blocks of size 2^( 5) =       0.000448067471
  error estimate for blocks of size 2^( 6) =       0.000456674773
  error estimate for blocks of size 2^( 7) =       0.000463049552

      target function =                  N/A
              le_mean =     -16.906135298642
             les_mean =     286.147807730069
             stat err =       0.000451202703
             autocorr =       1.276835075215
              std dev =       0.564701951102
             le_variance =       0.318888293578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318964701614
                                         uncertainty =       0.001880197513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318964701614
                                         uncertainty =       0.001880197513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399305078
  error estimate for blocks of size 2^( 2) =       0.000411989265
  error estimate for blocks of size 2^( 3) =       0.000424867789
  error estimate for blocks of size 2^( 4) =       0.000437019208
  error estimate for blocks of size 2^( 5) =       0.000448067643
  error estimate for blocks of size 2^( 6) =       0.000456674821
  error estimate for blocks of size 2^( 7) =       0.000463049664

      target function =                  N/A
              le_mean =     -16.906135288787
             les_mean =     286.147806994663
             stat err =       0.000451202834
             autocorr =       1.276832629326
              std dev =       0.564702656270
             le_variance =       0.318889089999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965414564
                                         uncertainty =       0.001880247652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965414564
                                         uncertainty =       0.001880247652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399305530
  error estimate for blocks of size 2^( 2) =       0.000411989584
  error estimate for blocks of size 2^( 3) =       0.000424867979
  error estimate for blocks of size 2^( 4) =       0.000437019389
  error estimate for blocks of size 2^( 5) =       0.000448067806
  error estimate for blocks of size 2^( 6) =       0.000456674873
  error estimate for blocks of size 2^( 7) =       0.000463049772

      target function =                  N/A
              le_mean =     -16.906135281453
             les_mean =     286.147806605412
             stat err =       0.000451202960
             autocorr =       1.276830444926
              std dev =       0.564703296478
             le_variance =       0.318889813053


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906135280529        initial
     2.3842e+01     2.3842e+02             1.7690e-05       -16.906135298642  <--
     9.5367e+01     9.5367e+02             4.4497e-06       -16.906135288787
     3.8147e+02     3.8147e+03             1.1141e-06       -16.906135281453

*****************************************************************************
Applying the update for shift_i =   2.3842e+01     and shift_s =   2.3842e+02
*****************************************************************************

  Execution time = 2.4473e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_0001                 7.011286e-01 3 1  ON 0
ci_0002                 7.004188e-01 3 1  ON 1
ci_0003                -2.812067e-02 3 1  ON 2
ci_0004                -2.821769e-02 3 1  ON 3
ci_0005                -3.414944e-02 3 1  ON 4
ci_0006                -3.465436e-02 3 1  ON 5
ci_0007                -2.234993e-02 3 1  ON 6
ci_0008                -2.433621e-02 3 1  ON 7
ci_0009                -1.796656e-02 3 1  ON 8
ci_0010                -1.808848e-02 3 1  ON 9
ci_0011                -1.328506e-02 3 1  ON 10
ci_0012                -1.281014e-02 3 1  ON 11
ci_0013                 1.325982e-02 3 1  ON 12
ci_0014                 1.366529e-02 3 1  ON 13
ci_0015                 1.365773e-02 3 1  ON 14
ci_0016                 1.339985e-02 3 1  ON 15
ci_0017                 1.220139e-02 3 1  ON 16
ci_0018                 1.209086e-02 3 1  ON 17
ci_0019                 1.213656e-02 3 1  ON 18
ci_0020                 1.125618e-02 3 1  ON 19
ci_0021                 2.454273e-03 3 1  ON 20
ci_0022                 3.229262e-03 3 1  ON 21
ci_0023                -1.139051e-02 3 1  ON 22
ci_0024                -1.125325e-02 3 1  ON 23
ci_0025                -1.055617e-02 3 1  ON 24
ci_0026                -1.070927e-02 3 1  ON 25
ci_0027                -1.174904e-02 3 1  ON 26
ci_0028                -1.142985e-02 3 1  ON 27
ci_0029                -1.087145e-02 3 1  ON 28
ci_0030                -1.076030e-02 3 1  ON 29
ci_0031                 1.956439e-02 3 1  ON 30
ci_0032                 1.944417e-02 3 1  ON 31
ci_0033                 9.386504e-03 3 1  ON 32
ci_0034                 1.060026e-02 3 1  ON 33
ci_0035                 6.898516e-03 3 1  ON 34
ci_0036                 6.557783e-03 3 1  ON 35
ci_0037                -9.923480e-03 3 1  ON 36
ci_0038                -1.002855e-02 3 1  ON 37
ci_0039                -2.773825e-03 3 1  ON 38
ci_0040                -2.745863e-03 3 1  ON 39
ci_0041                 8.062994e-03 3 1  ON 40
ci_0042                 7.375728e-03 3 1  ON 41
ci_0043                -1.463499e-02 3 1  ON 42
ci_0044                -1.550219e-02 3 1  ON 43
ci_0045                 7.220466e-03 3 1  ON 44
ci_0046                 7.721970e-03 3 1  ON 45
ci_0047                -2.187688e-03 3 1  ON 46
ci_0048                -1.929148e-03 3 1  ON 47
ci_0049                -5.373720e-03 3 1  ON 48
ci_0050                -6.028776e-03 3 1  ON 49
ci_0051                -3.651277e-03 3 1  ON 50
ci_0052                -3.809467e-03 3 1  ON 51
ci_0053                -4.703012e-03 3 1  ON 52
ci_0054                -4.976847e-03 3 1  ON 53
ci_0055                 6.169665e-03 3 1  ON 54
ci_0056                 6.743988e-03 3 1  ON 55
ci_0057                 4.143031e-03 3 1  ON 56
ci_0058                 5.098201e-03 3 1  ON 57
ci_0059                -5.232029e-03 3 1  ON 58
ci_0060                -4.771349e-03 3 1  ON 59
ci_0061                -3.561138e-03 3 1  ON 60
ci_0062                -2.935268e-03 3 1  ON 61
ci_0063                -9.032816e-03 3 1  ON 62
ci_0064                -8.842842e-03 3 1  ON 63
ci_0065                -5.908267e-03 3 1  ON 64
ci_0066                -5.126388e-03 3 1  ON 65
ci_0067                -5.434605e-03 3 1  ON 66
ci_0068                -5.571258e-03 3 1  ON 67
ci_0069                 5.102044e-03 3 1  ON 68
ci_0070                 4.541163e-03 3 1  ON 69
ci_0071                 1.674451e-03 3 1  ON 70
ci_0072                 2.266218e-03 3 1  ON 71
ci_0073                 4.865418e-03 3 1  ON 72
ci_0074                 4.063596e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1820e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9413
    reference variance = 0.140378
====================================================
  Execution time = 1.4851e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3449e-01
  Total weights = 1.951949780e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320262116974
                                         uncertainty =       0.002533922972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320262116974
                                         uncertainty =       0.002533922972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400109326
  error estimate for blocks of size 2^( 2) =       0.000413742832
  error estimate for blocks of size 2^( 3) =       0.000427342938
  error estimate for blocks of size 2^( 4) =       0.000439840397
  error estimate for blocks of size 2^( 5) =       0.000452153222
  error estimate for blocks of size 2^( 6) =       0.000461929195
  error estimate for blocks of size 2^( 7) =       0.000469117098

      target function =                  N/A
              le_mean =     -16.905771168636
             les_mean =     286.139586351584
             stat err =       0.000455759978
             autocorr =       1.297522870774
              std dev =       0.565840035562
             le_variance =       0.320174945845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577116864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905771168617       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905771243169       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905771228992       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905771231052       residual = 2.75e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 5.303453e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905771168617       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905771187752       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905771182745       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905771183384       residual = 3.50e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.362848e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905771168617       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905771173433       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905771172085       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905771172252       residual = 3.74e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.5367e+01 is 3.431058e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7465e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.011292e-01 3 1  ON 0
ci_0002                 7.004199e-01 3 1  ON 1
ci_0003                -2.811687e-02 3 1  ON 2
ci_0004                -2.821723e-02 3 1  ON 3
ci_0005                -3.414892e-02 3 1  ON 4
ci_0006                -3.465167e-02 3 1  ON 5
ci_0007                -2.233892e-02 3 1  ON 6
ci_0008                -2.433218e-02 3 1  ON 7
ci_0009                -1.796446e-02 3 1  ON 8
ci_0010                -1.808459e-02 3 1  ON 9
ci_0011                -1.327722e-02 3 1  ON 10
ci_0012                -1.280544e-02 3 1  ON 11
ci_0013                 1.325523e-02 3 1  ON 12
ci_0014                 1.366529e-02 3 1  ON 13
ci_0015                 1.365576e-02 3 1  ON 14
ci_0016                 1.341086e-02 3 1  ON 15
ci_0017                 1.219459e-02 3 1  ON 16
ci_0018                 1.208348e-02 3 1  ON 17
ci_0019                 1.212293e-02 3 1  ON 18
ci_0020                 1.124958e-02 3 1  ON 19
ci_0021                 2.460183e-03 3 1  ON 20
ci_0022                 3.227387e-03 3 1  ON 21
ci_0023                -1.139594e-02 3 1  ON 22
ci_0024                -1.124527e-02 3 1  ON 23
ci_0025                -1.055629e-02 3 1  ON 24
ci_0026                -1.071713e-02 3 1  ON 25
ci_0027                -1.173831e-02 3 1  ON 26
ci_0028                -1.142581e-02 3 1  ON 27
ci_0029                -1.086527e-02 3 1  ON 28
ci_0030                -1.076070e-02 3 1  ON 29
ci_0031                 1.956830e-02 3 1  ON 30
ci_0032                 1.944431e-02 3 1  ON 31
ci_0033                 9.398438e-03 3 1  ON 32
ci_0034                 1.059918e-02 3 1  ON 33
ci_0035                 6.898628e-03 3 1  ON 34
ci_0036                 6.560232e-03 3 1  ON 35
ci_0037                -9.928399e-03 3 1  ON 36
ci_0038                -1.003785e-02 3 1  ON 37
ci_0039                -2.773637e-03 3 1  ON 38
ci_0040                -2.736213e-03 3 1  ON 39
ci_0041                 8.052213e-03 3 1  ON 40
ci_0042                 7.371516e-03 3 1  ON 41
ci_0043                -1.463865e-02 3 1  ON 42
ci_0044                -1.550079e-02 3 1  ON 43
ci_0045                 7.223612e-03 3 1  ON 44
ci_0046                 7.719219e-03 3 1  ON 45
ci_0047                -2.188162e-03 3 1  ON 46
ci_0048                -1.930855e-03 3 1  ON 47
ci_0049                -5.377174e-03 3 1  ON 48
ci_0050                -6.018176e-03 3 1  ON 49
ci_0051                -3.650707e-03 3 1  ON 50
ci_0052                -3.813866e-03 3 1  ON 51
ci_0053                -4.703285e-03 3 1  ON 52
ci_0054                -4.969291e-03 3 1  ON 53
ci_0055                 6.177712e-03 3 1  ON 54
ci_0056                 6.736191e-03 3 1  ON 55
ci_0057                 4.152293e-03 3 1  ON 56
ci_0058                 5.096701e-03 3 1  ON 57
ci_0059                -5.229947e-03 3 1  ON 58
ci_0060                -4.774249e-03 3 1  ON 59
ci_0061                -3.562141e-03 3 1  ON 60
ci_0062                -2.947313e-03 3 1  ON 61
ci_0063                -9.038474e-03 3 1  ON 62
ci_0064                -8.832168e-03 3 1  ON 63
ci_0065                -5.901019e-03 3 1  ON 64
ci_0066                -5.136143e-03 3 1  ON 65
ci_0067                -5.434410e-03 3 1  ON 66
ci_0068                -5.561481e-03 3 1  ON 67
ci_0069                 5.105788e-03 3 1  ON 68
ci_0070                 4.542987e-03 3 1  ON 69
ci_0071                 1.674539e-03 3 1  ON 70
ci_0072                 2.262391e-03 3 1  ON 71
ci_0073                 4.864433e-03 3 1  ON 72
ci_0074                 4.073154e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9081
    reference variance = 0.228768
====================================================
  Execution time = 1.4688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3820e-01
  Total weights = 1.9516e+06
  Execution time = 1.9262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326202571883
                                         uncertainty =       0.002365214111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326202571883
                                         uncertainty =       0.002365214111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403849933
  error estimate for blocks of size 2^( 2) =       0.000416779244
  error estimate for blocks of size 2^( 3) =       0.000429681695
  error estimate for blocks of size 2^( 4) =       0.000442049274
  error estimate for blocks of size 2^( 5) =       0.000452367264
  error estimate for blocks of size 2^( 6) =       0.000458085422
  error estimate for blocks of size 2^( 7) =       0.000462320020

      target function =                  N/A
              le_mean =     -16.906528214521
             les_mean =     286.168881963585
             stat err =       0.000453705495
             autocorr =       1.262141505715
              std dev =       0.571130051820
             le_variance =       0.326189536092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326195292754
                                         uncertainty =       0.002363161007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326195292754
                                         uncertainty =       0.002363161007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403845453
  error estimate for blocks of size 2^( 2) =       0.000416776729
  error estimate for blocks of size 2^( 3) =       0.000429681371
  error estimate for blocks of size 2^( 4) =       0.000442049428
  error estimate for blocks of size 2^( 5) =       0.000452365809
  error estimate for blocks of size 2^( 6) =       0.000458085206
  error estimate for blocks of size 2^( 7) =       0.000462320010

      target function =                  N/A
              le_mean =     -16.906528605365
             les_mean =     286.169013944130
             stat err =       0.000453705113
             autocorr =       1.262167379212
              std dev =       0.571123717223
             le_variance =       0.326182300374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326198568387
                                         uncertainty =       0.002364146933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326198568387
                                         uncertainty =       0.002364146933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403847468
  error estimate for blocks of size 2^( 2) =       0.000416777791
  error estimate for blocks of size 2^( 3) =       0.000429681374
  error estimate for blocks of size 2^( 4) =       0.000442049200
  error estimate for blocks of size 2^( 5) =       0.000452366366
  error estimate for blocks of size 2^( 6) =       0.000458085182
  error estimate for blocks of size 2^( 7) =       0.000462319928

      target function =                  N/A
              le_mean =     -16.906528391131
             les_mean =     286.168929045312
             stat err =       0.000453705169
             autocorr =       1.262155096538
              std dev =       0.571126566810
             le_variance =       0.326185555316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326202044575
                                         uncertainty =       0.002365079192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326202044575
                                         uncertainty =       0.002365079192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403849608
  error estimate for blocks of size 2^( 2) =       0.000416779047
  error estimate for blocks of size 2^( 3) =       0.000429681641
  error estimate for blocks of size 2^( 4) =       0.000442049251
  error estimate for blocks of size 2^( 5) =       0.000452367137
  error estimate for blocks of size 2^( 6) =       0.000458085379
  error estimate for blocks of size 2^( 7) =       0.000462319999

      target function =                  N/A
              le_mean =     -16.906528234095
             les_mean =     286.168886509884
             stat err =       0.000453705442
             autocorr =       1.262143237832
              std dev =       0.571129592715
             le_variance =       0.326189011674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906528214521        initial
     5.9605e+00     5.9605e+01             5.3035e-05       -16.906528605365  <--
     2.3842e+01     2.3842e+02             1.3628e-05       -16.906528391131
     9.5367e+01     9.5367e+02             3.4311e-06       -16.906528234095

*****************************************************************************
Applying the update for shift_i =   5.9605e+00     and shift_s =   5.9605e+01
*****************************************************************************

  Execution time = 2.4451e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_0001                 7.011308e-01 3 1  ON 0
ci_0002                 7.004230e-01 3 1  ON 1
ci_0003                -2.810591e-02 3 1  ON 2
ci_0004                -2.821596e-02 3 1  ON 3
ci_0005                -3.414747e-02 3 1  ON 4
ci_0006                -3.464383e-02 3 1  ON 5
ci_0007                -2.230639e-02 3 1  ON 6
ci_0008                -2.432026e-02 3 1  ON 7
ci_0009                -1.795849e-02 3 1  ON 8
ci_0010                -1.807339e-02 3 1  ON 9
ci_0011                -1.325464e-02 3 1  ON 10
ci_0012                -1.279192e-02 3 1  ON 11
ci_0013                 1.324202e-02 3 1  ON 12
ci_0014                 1.366538e-02 3 1  ON 13
ci_0015                 1.365020e-02 3 1  ON 14
ci_0016                 1.344288e-02 3 1  ON 15
ci_0017                 1.217505e-02 3 1  ON 16
ci_0018                 1.206220e-02 3 1  ON 17
ci_0019                 1.208352e-02 3 1  ON 18
ci_0020                 1.123056e-02 3 1  ON 19
ci_0021                 2.477575e-03 3 1  ON 20
ci_0022                 3.221805e-03 3 1  ON 21
ci_0023                -1.141172e-02 3 1  ON 22
ci_0024                -1.122236e-02 3 1  ON 23
ci_0025                -1.055663e-02 3 1  ON 24
ci_0026                -1.073986e-02 3 1  ON 25
ci_0027                -1.170727e-02 3 1  ON 26
ci_0028                -1.141413e-02 3 1  ON 27
ci_0029                -1.084747e-02 3 1  ON 28
ci_0030                -1.076182e-02 3 1  ON 29
ci_0031                 1.957972e-02 3 1  ON 30
ci_0032                 1.944480e-02 3 1  ON 31
ci_0033                 9.433550e-03 3 1  ON 32
ci_0034                 1.059597e-02 3 1  ON 33
ci_0035                 6.898984e-03 3 1  ON 34
ci_0036                 6.567422e-03 3 1  ON 35
ci_0037                -9.942733e-03 3 1  ON 36
ci_0038                -1.006506e-02 3 1  ON 37
ci_0039                -2.773114e-03 3 1  ON 38
ci_0040                -2.708956e-03 3 1  ON 39
ci_0041                 8.021011e-03 3 1  ON 40
ci_0042                 7.359207e-03 3 1  ON 41
ci_0043                -1.464959e-02 3 1  ON 42
ci_0044                -1.549671e-02 3 1  ON 43
ci_0045                 7.232888e-03 3 1  ON 44
ci_0046                 7.711169e-03 3 1  ON 45
ci_0047                -2.189505e-03 3 1  ON 46
ci_0048                -1.935696e-03 3 1  ON 47
ci_0049                -5.387207e-03 3 1  ON 48
ci_0050                -5.987483e-03 3 1  ON 49
ci_0051                -3.649082e-03 3 1  ON 50
ci_0052                -3.826387e-03 3 1  ON 51
ci_0053                -4.704086e-03 3 1  ON 52
ci_0054                -4.947704e-03 3 1  ON 53
ci_0055                 6.201256e-03 3 1  ON 54
ci_0056                 6.713392e-03 3 1  ON 55
ci_0057                 4.179243e-03 3 1  ON 56
ci_0058                 5.092286e-03 3 1  ON 57
ci_0059                -5.224017e-03 3 1  ON 58
ci_0060                -4.782475e-03 3 1  ON 59
ci_0061                -3.564990e-03 3 1  ON 60
ci_0062                -2.982315e-03 3 1  ON 61
ci_0063                -9.054672e-03 3 1  ON 62
ci_0064                -8.801595e-03 3 1  ON 63
ci_0065                -5.880131e-03 3 1  ON 64
ci_0066                -5.164270e-03 3 1  ON 65
ci_0067                -5.433876e-03 3 1  ON 66
ci_0068                -5.533738e-03 3 1  ON 67
ci_0069                 5.116402e-03 3 1  ON 68
ci_0070                 4.548222e-03 3 1  ON 69
ci_0071                 1.674807e-03 3 1  ON 70
ci_0072                 2.251111e-03 3 1  ON 71
ci_0073                 4.861640e-03 3 1  ON 72
ci_0074                 4.100316e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1922e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8506
    reference variance = 0.23282
====================================================
  Execution time = 1.4982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3143e-01
  Total weights = 1.951504908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319358602359
                                         uncertainty =       0.002198330792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319358602359
                                         uncertainty =       0.002198330792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399615916
  error estimate for blocks of size 2^( 2) =       0.000412493800
  error estimate for blocks of size 2^( 3) =       0.000425436328
  error estimate for blocks of size 2^( 4) =       0.000437945677
  error estimate for blocks of size 2^( 5) =       0.000447689551
  error estimate for blocks of size 2^( 6) =       0.000456498921
  error estimate for blocks of size 2^( 7) =       0.000461441068

      target function =                  N/A
              le_mean =     -16.906849306807
             les_mean =     286.172986981540
             stat err =       0.000450893804
             autocorr =       1.273101357880
              std dev =       0.565142247967
             le_variance =       0.319385760437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690684930681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906849306825       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906853189832       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906853235107       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906853226733       residual = 1.51e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+00 is 1.910570e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906849306825       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906850372881       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906850391487       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906850391987       residual = 1.69e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+00 is 5.171874e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906849306825       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906849580045       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906849585322       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906849585697       residual = 1.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+01 is 1.320280e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7597e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.011248e-01 3 1  ON 0
ci_0002                 7.004299e-01 3 1  ON 1
ci_0003                -2.813184e-02 3 1  ON 2
ci_0004                -2.819728e-02 3 1  ON 3
ci_0005                -3.415346e-02 3 1  ON 4
ci_0006                -3.466279e-02 3 1  ON 5
ci_0007                -2.229171e-02 3 1  ON 6
ci_0008                -2.427519e-02 3 1  ON 7
ci_0009                -1.800902e-02 3 1  ON 8
ci_0010                -1.806114e-02 3 1  ON 9
ci_0011                -1.324211e-02 3 1  ON 10
ci_0012                -1.279711e-02 3 1  ON 11
ci_0013                 1.325501e-02 3 1  ON 12
ci_0014                 1.364935e-02 3 1  ON 13
ci_0015                 1.363601e-02 3 1  ON 14
ci_0016                 1.346782e-02 3 1  ON 15
ci_0017                 1.216731e-02 3 1  ON 16
ci_0018                 1.206197e-02 3 1  ON 17
ci_0019                 1.206000e-02 3 1  ON 18
ci_0020                 1.125190e-02 3 1  ON 19
ci_0021                 2.473559e-03 3 1  ON 20
ci_0022                 3.210337e-03 3 1  ON 21
ci_0023                -1.140384e-02 3 1  ON 22
ci_0024                -1.118795e-02 3 1  ON 23
ci_0025                -1.056747e-02 3 1  ON 24
ci_0026                -1.074927e-02 3 1  ON 25
ci_0027                -1.167359e-02 3 1  ON 26
ci_0028                -1.142619e-02 3 1  ON 27
ci_0029                -1.080623e-02 3 1  ON 28
ci_0030                -1.077438e-02 3 1  ON 29
ci_0031                 1.957685e-02 3 1  ON 30
ci_0032                 1.943758e-02 3 1  ON 31
ci_0033                 9.452728e-03 3 1  ON 32
ci_0034                 1.062601e-02 3 1  ON 33
ci_0035                 6.899898e-03 3 1  ON 34
ci_0036                 6.576663e-03 3 1  ON 35
ci_0037                -9.994452e-03 3 1  ON 36
ci_0038                -1.009000e-02 3 1  ON 37
ci_0039                -2.788141e-03 3 1  ON 38
ci_0040                -2.725220e-03 3 1  ON 39
ci_0041                 7.975307e-03 3 1  ON 40
ci_0042                 7.389390e-03 3 1  ON 41
ci_0043                -1.466753e-02 3 1  ON 42
ci_0044                -1.547149e-02 3 1  ON 43
ci_0045                 7.237093e-03 3 1  ON 44
ci_0046                 7.688704e-03 3 1  ON 45
ci_0047                -2.194437e-03 3 1  ON 46
ci_0048                -1.925822e-03 3 1  ON 47
ci_0049                -5.427981e-03 3 1  ON 48
ci_0050                -5.985106e-03 3 1  ON 49
ci_0051                -3.658317e-03 3 1  ON 50
ci_0052                -3.822488e-03 3 1  ON 51
ci_0053                -4.719145e-03 3 1  ON 52
ci_0054                -4.918566e-03 3 1  ON 53
ci_0055                 6.176434e-03 3 1  ON 54
ci_0056                 6.726024e-03 3 1  ON 55
ci_0057                 4.204342e-03 3 1  ON 56
ci_0058                 5.070647e-03 3 1  ON 57
ci_0059                -5.217258e-03 3 1  ON 58
ci_0060                -4.810954e-03 3 1  ON 59
ci_0061                -3.608884e-03 3 1  ON 60
ci_0062                -2.988180e-03 3 1  ON 61
ci_0063                -9.024204e-03 3 1  ON 62
ci_0064                -8.782060e-03 3 1  ON 63
ci_0065                -5.829611e-03 3 1  ON 64
ci_0066                -5.166788e-03 3 1  ON 65
ci_0067                -5.431588e-03 3 1  ON 66
ci_0068                -5.517091e-03 3 1  ON 67
ci_0069                 5.088976e-03 3 1  ON 68
ci_0070                 4.549399e-03 3 1  ON 69
ci_0071                 1.681937e-03 3 1  ON 70
ci_0072                 2.222211e-03 3 1  ON 71
ci_0073                 4.841365e-03 3 1  ON 72
ci_0074                 4.119850e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.0199
    reference variance = 0.554467
====================================================
  Execution time = 1.4442e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3302e-01
  Total weights = 1.9518e+06
  Execution time = 1.9260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320187728640
                                         uncertainty =       0.002232003597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320187728640
                                         uncertainty =       0.002232003597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400123330
  error estimate for blocks of size 2^( 2) =       0.000412990075
  error estimate for blocks of size 2^( 3) =       0.000426075460
  error estimate for blocks of size 2^( 4) =       0.000437760947
  error estimate for blocks of size 2^( 5) =       0.000448548381
  error estimate for blocks of size 2^( 6) =       0.000456703390
  error estimate for blocks of size 2^( 7) =       0.000460848377

      target function =                  N/A
              le_mean =     -16.905698484310
             les_mean =     286.135585050184
             stat err =       0.000450965274
             autocorr =       1.270277049944
              std dev =       0.565859840151
             le_variance =       0.320197358695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320254672797
                                         uncertainty =       0.002236999259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320254672797
                                         uncertainty =       0.002236999259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400165136
  error estimate for blocks of size 2^( 2) =       0.000413032510
  error estimate for blocks of size 2^( 3) =       0.000426123450
  error estimate for blocks of size 2^( 4) =       0.000437811773
  error estimate for blocks of size 2^( 5) =       0.000448600341
  error estimate for blocks of size 2^( 6) =       0.000456760531
  error estimate for blocks of size 2^( 7) =       0.000460917994

      target function =                  N/A
              le_mean =     -16.905696823292
             les_mean =     286.136136296580
             stat err =       0.000451022660
             autocorr =       1.270334890793
              std dev =       0.565918962397
             le_variance =       0.320264272000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320222912001
                                         uncertainty =       0.002234741152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320222912001
                                         uncertainty =       0.002234741152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400145301
  error estimate for blocks of size 2^( 2) =       0.000413012436
  error estimate for blocks of size 2^( 3) =       0.000426100838
  error estimate for blocks of size 2^( 4) =       0.000437787914
  error estimate for blocks of size 2^( 5) =       0.000448576066
  error estimate for blocks of size 2^( 6) =       0.000456734016
  error estimate for blocks of size 2^( 7) =       0.000460885650

      target function =                  N/A
              le_mean =     -16.905697252666
             les_mean =     286.135751045008
             stat err =       0.000450995911
             autocorr =       1.270310144525
              std dev =       0.565890911806
             le_variance =       0.320232524064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320191983966
                                         uncertainty =       0.002232349189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320191983966
                                         uncertainty =       0.002232349189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400125988
  error estimate for blocks of size 2^( 2) =       0.000412992784
  error estimate for blocks of size 2^( 3) =       0.000426078551
  error estimate for blocks of size 2^( 4) =       0.000437764246
  error estimate for blocks of size 2^( 5) =       0.000448551780
  error estimate for blocks of size 2^( 6) =       0.000456707167
  error estimate for blocks of size 2^( 7) =       0.000460852987

      target function =                  N/A
              le_mean =     -16.905698290057
             les_mean =     286.135589495232
             stat err =       0.000450969045
             autocorr =       1.270281422138
              std dev =       0.565863598237
             le_variance =       0.320201611809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905698484310        initial  <--
     1.4901e+00     1.4901e+01             1.9106e-04       -16.905696823292
     5.9605e+00     5.9605e+01             5.1719e-05       -16.905697252666
     2.3842e+01     2.3842e+02             1.3203e-05       -16.905698290057

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1913
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_0001                 7.011308e-01 3 1  ON 0
ci_0002                 7.004230e-01 3 1  ON 1
ci_0003                -2.810591e-02 3 1  ON 2
ci_0004                -2.821596e-02 3 1  ON 3
ci_0005                -3.414747e-02 3 1  ON 4
ci_0006                -3.464383e-02 3 1  ON 5
ci_0007                -2.230639e-02 3 1  ON 6
ci_0008                -2.432026e-02 3 1  ON 7
ci_0009                -1.795849e-02 3 1  ON 8
ci_0010                -1.807339e-02 3 1  ON 9
ci_0011                -1.325464e-02 3 1  ON 10
ci_0012                -1.279192e-02 3 1  ON 11
ci_0013                 1.324202e-02 3 1  ON 12
ci_0014                 1.366538e-02 3 1  ON 13
ci_0015                 1.365020e-02 3 1  ON 14
ci_0016                 1.344288e-02 3 1  ON 15
ci_0017                 1.217505e-02 3 1  ON 16
ci_0018                 1.206220e-02 3 1  ON 17
ci_0019                 1.208352e-02 3 1  ON 18
ci_0020                 1.123056e-02 3 1  ON 19
ci_0021                 2.477575e-03 3 1  ON 20
ci_0022                 3.221805e-03 3 1  ON 21
ci_0023                -1.141172e-02 3 1  ON 22
ci_0024                -1.122236e-02 3 1  ON 23
ci_0025                -1.055663e-02 3 1  ON 24
ci_0026                -1.073986e-02 3 1  ON 25
ci_0027                -1.170727e-02 3 1  ON 26
ci_0028                -1.141413e-02 3 1  ON 27
ci_0029                -1.084747e-02 3 1  ON 28
ci_0030                -1.076182e-02 3 1  ON 29
ci_0031                 1.957972e-02 3 1  ON 30
ci_0032                 1.944480e-02 3 1  ON 31
ci_0033                 9.433550e-03 3 1  ON 32
ci_0034                 1.059597e-02 3 1  ON 33
ci_0035                 6.898984e-03 3 1  ON 34
ci_0036                 6.567422e-03 3 1  ON 35
ci_0037                -9.942733e-03 3 1  ON 36
ci_0038                -1.006506e-02 3 1  ON 37
ci_0039                -2.773114e-03 3 1  ON 38
ci_0040                -2.708956e-03 3 1  ON 39
ci_0041                 8.021011e-03 3 1  ON 40
ci_0042                 7.359207e-03 3 1  ON 41
ci_0043                -1.464959e-02 3 1  ON 42
ci_0044                -1.549671e-02 3 1  ON 43
ci_0045                 7.232888e-03 3 1  ON 44
ci_0046                 7.711169e-03 3 1  ON 45
ci_0047                -2.189505e-03 3 1  ON 46
ci_0048                -1.935696e-03 3 1  ON 47
ci_0049                -5.387207e-03 3 1  ON 48
ci_0050                -5.987483e-03 3 1  ON 49
ci_0051                -3.649082e-03 3 1  ON 50
ci_0052                -3.826387e-03 3 1  ON 51
ci_0053                -4.704086e-03 3 1  ON 52
ci_0054                -4.947704e-03 3 1  ON 53
ci_0055                 6.201256e-03 3 1  ON 54
ci_0056                 6.713392e-03 3 1  ON 55
ci_0057                 4.179243e-03 3 1  ON 56
ci_0058                 5.092286e-03 3 1  ON 57
ci_0059                -5.224017e-03 3 1  ON 58
ci_0060                -4.782475e-03 3 1  ON 59
ci_0061                -3.564990e-03 3 1  ON 60
ci_0062                -2.982315e-03 3 1  ON 61
ci_0063                -9.054672e-03 3 1  ON 62
ci_0064                -8.801595e-03 3 1  ON 63
ci_0065                -5.880131e-03 3 1  ON 64
ci_0066                -5.164270e-03 3 1  ON 65
ci_0067                -5.433876e-03 3 1  ON 66
ci_0068                -5.533738e-03 3 1  ON 67
ci_0069                 5.116402e-03 3 1  ON 68
ci_0070                 4.548222e-03 3 1  ON 69
ci_0071                 1.674807e-03 3 1  ON 70
ci_0072                 2.251111e-03 3 1  ON 71
ci_0073                 4.861640e-03 3 1  ON 72
ci_0074                 4.100316e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1795e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.496458
====================================================
  Execution time = 1.5047e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3460e-01
  Total weights = 1.952000609e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322806667988
                                         uncertainty =       0.002644782022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322806667988
                                         uncertainty =       0.002644782022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401749904
  error estimate for blocks of size 2^( 2) =       0.000414449453
  error estimate for blocks of size 2^( 3) =       0.000427678039
  error estimate for blocks of size 2^( 4) =       0.000440861379
  error estimate for blocks of size 2^( 5) =       0.000452477061
  error estimate for blocks of size 2^( 6) =       0.000461141643
  error estimate for blocks of size 2^( 7) =       0.000466598992

      target function =                  N/A
              le_mean =     -16.906741017207
             les_mean =     286.172487715368
             stat err =       0.000455269769
             autocorr =       1.284180475428
              std dev =       0.568160162895
             le_variance =       0.322805970701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674101721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906741017185       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906741181717       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906741164063       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 2.758739e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906741017185       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906741058706       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906741054028       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 6.937442e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906741017185       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906741027590       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906741026403       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3842e+02 is 1.736925e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7687e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.011302e-01 3 1  ON 0
ci_0002                 7.004241e-01 3 1  ON 1
ci_0003                -2.810425e-02 3 1  ON 2
ci_0004                -2.821696e-02 3 1  ON 3
ci_0005                -3.414798e-02 3 1  ON 4
ci_0006                -3.464503e-02 3 1  ON 5
ci_0007                -2.230322e-02 3 1  ON 6
ci_0008                -2.431509e-02 3 1  ON 7
ci_0009                -1.795747e-02 3 1  ON 8
ci_0010                -1.807566e-02 3 1  ON 9
ci_0011                -1.325421e-02 3 1  ON 10
ci_0012                -1.279238e-02 3 1  ON 11
ci_0013                 1.324353e-02 3 1  ON 12
ci_0014                 1.366356e-02 3 1  ON 13
ci_0015                 1.365157e-02 3 1  ON 14
ci_0016                 1.344430e-02 3 1  ON 15
ci_0017                 1.217358e-02 3 1  ON 16
ci_0018                 1.206162e-02 3 1  ON 17
ci_0019                 1.208302e-02 3 1  ON 18
ci_0020                 1.123304e-02 3 1  ON 19
ci_0021                 2.478082e-03 3 1  ON 20
ci_0022                 3.220774e-03 3 1  ON 21
ci_0023                -1.141171e-02 3 1  ON 22
ci_0024                -1.122259e-02 3 1  ON 23
ci_0025                -1.055901e-02 3 1  ON 24
ci_0026                -1.074010e-02 3 1  ON 25
ci_0027                -1.170187e-02 3 1  ON 26
ci_0028                -1.141101e-02 3 1  ON 27
ci_0029                -1.084961e-02 3 1  ON 28
ci_0030                -1.076043e-02 3 1  ON 29
ci_0031                 1.958013e-02 3 1  ON 30
ci_0032                 1.944163e-02 3 1  ON 31
ci_0033                 9.438366e-03 3 1  ON 32
ci_0034                 1.058904e-02 3 1  ON 33
ci_0035                 6.897391e-03 3 1  ON 34
ci_0036                 6.571733e-03 3 1  ON 35
ci_0037                -9.945213e-03 3 1  ON 36
ci_0038                -1.006175e-02 3 1  ON 37
ci_0039                -2.773572e-03 3 1  ON 38
ci_0040                -2.710659e-03 3 1  ON 39
ci_0041                 8.019709e-03 3 1  ON 40
ci_0042                 7.359051e-03 3 1  ON 41
ci_0043                -1.464700e-02 3 1  ON 42
ci_0044                -1.549836e-02 3 1  ON 43
ci_0045                 7.237395e-03 3 1  ON 44
ci_0046                 7.711758e-03 3 1  ON 45
ci_0047                -2.188672e-03 3 1  ON 46
ci_0048                -1.934431e-03 3 1  ON 47
ci_0049                -5.389977e-03 3 1  ON 48
ci_0050                -5.988243e-03 3 1  ON 49
ci_0051                -3.650486e-03 3 1  ON 50
ci_0052                -3.823080e-03 3 1  ON 51
ci_0053                -4.702139e-03 3 1  ON 52
ci_0054                -4.949968e-03 3 1  ON 53
ci_0055                 6.203142e-03 3 1  ON 54
ci_0056                 6.711139e-03 3 1  ON 55
ci_0057                 4.181098e-03 3 1  ON 56
ci_0058                 5.090982e-03 3 1  ON 57
ci_0059                -5.221110e-03 3 1  ON 58
ci_0060                -4.781929e-03 3 1  ON 59
ci_0061                -3.567327e-03 3 1  ON 60
ci_0062                -2.982508e-03 3 1  ON 61
ci_0063                -9.050751e-03 3 1  ON 62
ci_0064                -8.803265e-03 3 1  ON 63
ci_0065                -5.877214e-03 3 1  ON 64
ci_0066                -5.164365e-03 3 1  ON 65
ci_0067                -5.433870e-03 3 1  ON 66
ci_0068                -5.530097e-03 3 1  ON 67
ci_0069                 5.112145e-03 3 1  ON 68
ci_0070                 4.546561e-03 3 1  ON 69
ci_0071                 1.674604e-03 3 1  ON 70
ci_0072                 2.248532e-03 3 1  ON 71
ci_0073                 4.861137e-03 3 1  ON 72
ci_0074                 4.100065e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9272
    reference variance = 0.169478
====================================================
  Execution time = 1.4552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3424e-01
  Total weights = 1.9519e+06
  Execution time = 1.9276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320162960042
                                         uncertainty =       0.002482433084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320162960042
                                         uncertainty =       0.002482433084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400075786
  error estimate for blocks of size 2^( 2) =       0.000412958156
  error estimate for blocks of size 2^( 3) =       0.000426452047
  error estimate for blocks of size 2^( 4) =       0.000437743626
  error estimate for blocks of size 2^( 5) =       0.000447983462
  error estimate for blocks of size 2^( 6) =       0.000456376718
  error estimate for blocks of size 2^( 7) =       0.000461648088

      target function =                  N/A
              le_mean =     -16.907567658143
             les_mean =     286.200087445084
             stat err =       0.000450937973
             autocorr =       1.270425151646
              std dev =       0.565792602342
             le_variance =       0.320121268865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320157897950
                                         uncertainty =       0.002482370088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320157897950
                                         uncertainty =       0.002482370088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400072638
  error estimate for blocks of size 2^( 2) =       0.000412955545
  error estimate for blocks of size 2^( 3) =       0.000426449964
  error estimate for blocks of size 2^( 4) =       0.000437741840
  error estimate for blocks of size 2^( 5) =       0.000447981659
  error estimate for blocks of size 2^( 6) =       0.000456375736
  error estimate for blocks of size 2^( 7) =       0.000461646527

      target function =                  N/A
              le_mean =     -16.907568145526
             les_mean =     286.200104860937
             stat err =       0.000450936440
             autocorr =       1.270436503180
              std dev =       0.565788151134
             le_variance =       0.320116231963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320160358892
                                         uncertainty =       0.002482400016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320160358892
                                         uncertainty =       0.002482400016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400074168
  error estimate for blocks of size 2^( 2) =       0.000412956811
  error estimate for blocks of size 2^( 3) =       0.000426450969
  error estimate for blocks of size 2^( 4) =       0.000437742699
  error estimate for blocks of size 2^( 5) =       0.000447982526
  error estimate for blocks of size 2^( 6) =       0.000456376197
  error estimate for blocks of size 2^( 7) =       0.000461647273

      target function =                  N/A
              le_mean =     -16.907567901343
             les_mean =     286.200095643299
             stat err =       0.000450937174
             autocorr =       1.270430917765
              std dev =       0.565790314983
             le_variance =       0.320118680529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320162630596
                                         uncertainty =       0.002482428836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320162630596
                                         uncertainty =       0.002482428836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400075581
  error estimate for blocks of size 2^( 2) =       0.000412957985
  error estimate for blocks of size 2^( 3) =       0.000426451910
  error estimate for blocks of size 2^( 4) =       0.000437743508
  error estimate for blocks of size 2^( 5) =       0.000447983342
  error estimate for blocks of size 2^( 6) =       0.000456376650
  error estimate for blocks of size 2^( 7) =       0.000461647984

      target function =                  N/A
              le_mean =     -16.907567688273
             les_mean =     286.200088406709
             stat err =       0.000450937871
             autocorr =       1.270425876587
              std dev =       0.565792312628
             le_variance =       0.320120941029


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907567658143        initial
     1.4901e+01     1.4901e+02             2.7587e-05       -16.907568145526  <--
     5.9605e+01     5.9605e+02             6.9374e-06       -16.907567901343
     2.3842e+02     2.3842e+03             1.7369e-06       -16.907567688273

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.4313e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_0001                 7.011281e-01 3 1  ON 0
ci_0002                 7.004275e-01 3 1  ON 1
ci_0003                -2.809934e-02 3 1  ON 2
ci_0004                -2.821990e-02 3 1  ON 3
ci_0005                -3.414951e-02 3 1  ON 4
ci_0006                -3.464857e-02 3 1  ON 5
ci_0007                -2.229375e-02 3 1  ON 6
ci_0008                -2.429966e-02 3 1  ON 7
ci_0009                -1.795448e-02 3 1  ON 8
ci_0010                -1.808238e-02 3 1  ON 9
ci_0011                -1.325293e-02 3 1  ON 10
ci_0012                -1.279375e-02 3 1  ON 11
ci_0013                 1.324803e-02 3 1  ON 12
ci_0014                 1.365818e-02 3 1  ON 13
ci_0015                 1.365564e-02 3 1  ON 14
ci_0016                 1.344850e-02 3 1  ON 15
ci_0017                 1.216922e-02 3 1  ON 16
ci_0018                 1.205991e-02 3 1  ON 17
ci_0019                 1.208155e-02 3 1  ON 18
ci_0020                 1.124037e-02 3 1  ON 19
ci_0021                 2.479582e-03 3 1  ON 20
ci_0022                 3.217707e-03 3 1  ON 21
ci_0023                -1.141166e-02 3 1  ON 22
ci_0024                -1.122328e-02 3 1  ON 23
ci_0025                -1.056604e-02 3 1  ON 24
ci_0026                -1.074083e-02 3 1  ON 25
ci_0027                -1.168588e-02 3 1  ON 26
ci_0028                -1.140176e-02 3 1  ON 27
ci_0029                -1.085591e-02 3 1  ON 28
ci_0030                -1.075632e-02 3 1  ON 29
ci_0031                 1.958136e-02 3 1  ON 30
ci_0032                 1.943220e-02 3 1  ON 31
ci_0033                 9.452698e-03 3 1  ON 32
ci_0034                 1.056839e-02 3 1  ON 33
ci_0035                 6.892671e-03 3 1  ON 34
ci_0036                 6.584511e-03 3 1  ON 35
ci_0037                -9.952581e-03 3 1  ON 36
ci_0038                -1.005193e-02 3 1  ON 37
ci_0039                -2.774915e-03 3 1  ON 38
ci_0040                -2.715642e-03 3 1  ON 39
ci_0041                 8.015859e-03 3 1  ON 40
ci_0042                 7.358586e-03 3 1  ON 41
ci_0043                -1.463928e-02 3 1  ON 42
ci_0044                -1.550328e-02 3 1  ON 43
ci_0045                 7.250793e-03 3 1  ON 44
ci_0046                 7.713505e-03 3 1  ON 45
ci_0047                -2.186231e-03 3 1  ON 46
ci_0048                -1.930722e-03 3 1  ON 47
ci_0049                -5.398181e-03 3 1  ON 48
ci_0050                -5.990485e-03 3 1  ON 49
ci_0051                -3.654611e-03 3 1  ON 50
ci_0052                -3.813377e-03 3 1  ON 51
ci_0053                -4.696422e-03 3 1  ON 52
ci_0054                -4.956629e-03 3 1  ON 53
ci_0055                 6.208740e-03 3 1  ON 54
ci_0056                 6.704458e-03 3 1  ON 55
ci_0057                 4.186595e-03 3 1  ON 56
ci_0058                 5.087110e-03 3 1  ON 57
ci_0059                -5.212565e-03 3 1  ON 58
ci_0060                -4.780327e-03 3 1  ON 59
ci_0061                -3.574246e-03 3 1  ON 60
ci_0062                -2.983089e-03 3 1  ON 61
ci_0063                -9.039204e-03 3 1  ON 62
ci_0064                -8.808183e-03 3 1  ON 63
ci_0065                -5.868593e-03 3 1  ON 64
ci_0066                -5.164649e-03 3 1  ON 65
ci_0067                -5.433848e-03 3 1  ON 66
ci_0068                -5.519401e-03 3 1  ON 67
ci_0069                 5.099647e-03 3 1  ON 68
ci_0070                 4.541680e-03 3 1  ON 69
ci_0071                 1.673999e-03 3 1  ON 70
ci_0072                 2.240907e-03 3 1  ON 71
ci_0073                 4.859647e-03 3 1  ON 72
ci_0074                 4.099329e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2006e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9377
    reference variance = 0.230392
====================================================
  Execution time = 1.4830e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3840e-01
  Total weights = 1.951987268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325230133897
                                         uncertainty =       0.004290557161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325230133897
                                         uncertainty =       0.004290557161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403227636
  error estimate for blocks of size 2^( 2) =       0.000415841432
  error estimate for blocks of size 2^( 3) =       0.000429424772
  error estimate for blocks of size 2^( 4) =       0.000440970541
  error estimate for blocks of size 2^( 5) =       0.000451361405
  error estimate for blocks of size 2^( 6) =       0.000460190171
  error estimate for blocks of size 2^( 7) =       0.000465927072

      target function =                  N/A
              le_mean =     -16.906371515505
             les_mean =     286.163798877545
             stat err =       0.000454612297
             autocorr =       1.271106030250
              std dev =       0.570249991662
             le_variance =       0.325185052990


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637151551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371515498       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906373151091       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906373351989       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373353653       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 2.136445e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371515498       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371936518       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371987894       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371989111       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 5.460150e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371515498       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371621538       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371634465       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371634820       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.9605e+01 is 1.372679e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7453e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.011464e-01 3 1  ON 0
ci_0002                 7.004124e-01 3 1  ON 1
ci_0003                -2.810678e-02 3 1  ON 2
ci_0004                -2.821491e-02 3 1  ON 3
ci_0005                -3.415168e-02 3 1  ON 4
ci_0006                -3.462391e-02 3 1  ON 5
ci_0007                -2.230642e-02 3 1  ON 6
ci_0008                -2.425992e-02 3 1  ON 7
ci_0009                -1.794612e-02 3 1  ON 8
ci_0010                -1.806720e-02 3 1  ON 9
ci_0011                -1.324222e-02 3 1  ON 10
ci_0012                -1.277900e-02 3 1  ON 11
ci_0013                 1.324758e-02 3 1  ON 12
ci_0014                 1.365143e-02 3 1  ON 13
ci_0015                 1.363246e-02 3 1  ON 14
ci_0016                 1.344424e-02 3 1  ON 15
ci_0017                 1.216540e-02 3 1  ON 16
ci_0018                 1.204780e-02 3 1  ON 17
ci_0019                 1.207328e-02 3 1  ON 18
ci_0020                 1.122747e-02 3 1  ON 19
ci_0021                 2.456732e-03 3 1  ON 20
ci_0022                 3.213182e-03 3 1  ON 21
ci_0023                -1.139943e-02 3 1  ON 22
ci_0024                -1.118911e-02 3 1  ON 23
ci_0025                -1.056245e-02 3 1  ON 24
ci_0026                -1.073135e-02 3 1  ON 25
ci_0027                -1.170158e-02 3 1  ON 26
ci_0028                -1.141787e-02 3 1  ON 27
ci_0029                -1.084709e-02 3 1  ON 28
ci_0030                -1.075000e-02 3 1  ON 29
ci_0031                 1.963596e-02 3 1  ON 30
ci_0032                 1.943640e-02 3 1  ON 31
ci_0033                 9.436264e-03 3 1  ON 32
ci_0034                 1.056594e-02 3 1  ON 33
ci_0035                 6.897384e-03 3 1  ON 34
ci_0036                 6.584931e-03 3 1  ON 35
ci_0037                -9.970660e-03 3 1  ON 36
ci_0038                -1.007322e-02 3 1  ON 37
ci_0039                -2.761999e-03 3 1  ON 38
ci_0040                -2.719828e-03 3 1  ON 39
ci_0041                 8.006817e-03 3 1  ON 40
ci_0042                 7.374636e-03 3 1  ON 41
ci_0043                -1.462050e-02 3 1  ON 42
ci_0044                -1.552382e-02 3 1  ON 43
ci_0045                 7.300983e-03 3 1  ON 44
ci_0046                 7.706527e-03 3 1  ON 45
ci_0047                -2.177996e-03 3 1  ON 46
ci_0048                -1.934975e-03 3 1  ON 47
ci_0049                -5.405299e-03 3 1  ON 48
ci_0050                -5.983616e-03 3 1  ON 49
ci_0051                -3.650738e-03 3 1  ON 50
ci_0052                -3.819213e-03 3 1  ON 51
ci_0053                -4.716074e-03 3 1  ON 52
ci_0054                -4.953090e-03 3 1  ON 53
ci_0055                 6.209816e-03 3 1  ON 54
ci_0056                 6.705196e-03 3 1  ON 55
ci_0057                 4.172777e-03 3 1  ON 56
ci_0058                 5.083716e-03 3 1  ON 57
ci_0059                -5.204372e-03 3 1  ON 58
ci_0060                -4.777825e-03 3 1  ON 59
ci_0061                -3.571951e-03 3 1  ON 60
ci_0062                -2.985548e-03 3 1  ON 61
ci_0063                -9.014345e-03 3 1  ON 62
ci_0064                -8.815546e-03 3 1  ON 63
ci_0065                -5.868595e-03 3 1  ON 64
ci_0066                -5.135315e-03 3 1  ON 65
ci_0067                -5.428617e-03 3 1  ON 66
ci_0068                -5.525500e-03 3 1  ON 67
ci_0069                 5.085827e-03 3 1  ON 68
ci_0070                 4.527834e-03 3 1  ON 69
ci_0071                 1.672290e-03 3 1  ON 70
ci_0072                 2.255236e-03 3 1  ON 71
ci_0073                 4.864686e-03 3 1  ON 72
ci_0074                 4.106818e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.0042
    reference variance = 0.902106
====================================================
  Execution time = 1.4399e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3005e-01
  Total weights = 1.9518e+06
  Execution time = 1.9162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319451834871
                                         uncertainty =       0.002271103910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319451834871
                                         uncertainty =       0.002271103910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399655747
  error estimate for blocks of size 2^( 2) =       0.000412421100
  error estimate for blocks of size 2^( 3) =       0.000426076595
  error estimate for blocks of size 2^( 4) =       0.000438749695
  error estimate for blocks of size 2^( 5) =       0.000449996556
  error estimate for blocks of size 2^( 6) =       0.000458210073
  error estimate for blocks of size 2^( 7) =       0.000462677383

      target function =                  N/A
              le_mean =     -16.906554036648
             les_mean =     286.161638154708
             stat err =       0.000452408427
             autocorr =       1.281413354904
              std dev =       0.565198578069
             le_variance =       0.319449432651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319404508443
                                         uncertainty =       0.002267216257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319404508443
                                         uncertainty =       0.002267216257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399626152
  error estimate for blocks of size 2^( 2) =       0.000412392680
  error estimate for blocks of size 2^( 3) =       0.000426049204
  error estimate for blocks of size 2^( 4) =       0.000438721807
  error estimate for blocks of size 2^( 5) =       0.000449966305
  error estimate for blocks of size 2^( 6) =       0.000458177437
  error estimate for blocks of size 2^( 7) =       0.000462644633

      target function =                  N/A
              le_mean =     -16.906556582270
             les_mean =     286.161883893688
             stat err =       0.000452377545
             autocorr =       1.281428199622
              std dev =       0.565156724177
             le_variance =       0.319402122882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319426316570
                                         uncertainty =       0.002269054578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319426316570
                                         uncertainty =       0.002269054578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399639790
  error estimate for blocks of size 2^( 2) =       0.000412405793
  error estimate for blocks of size 2^( 3) =       0.000426061866
  error estimate for blocks of size 2^( 4) =       0.000438734708
  error estimate for blocks of size 2^( 5) =       0.000449980399
  error estimate for blocks of size 2^( 6) =       0.000458192740
  error estimate for blocks of size 2^( 7) =       0.000462660030

      target function =                  N/A
              le_mean =     -16.906555247948
             les_mean =     286.161703570086
             stat err =       0.000452391969
             autocorr =       1.281422451538
              std dev =       0.565176011342
             le_variance =       0.319423923796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448518832
                                         uncertainty =       0.002270843045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319448518832
                                         uncertainty =       0.002270843045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399653674
  error estimate for blocks of size 2^( 2) =       0.000412419112
  error estimate for blocks of size 2^( 3) =       0.000426074688
  error estimate for blocks of size 2^( 4) =       0.000438747768
  error estimate for blocks of size 2^( 5) =       0.000449994483
  error estimate for blocks of size 2^( 6) =       0.000458207860
  error estimate for blocks of size 2^( 7) =       0.000462675188

      target function =                  N/A
              le_mean =     -16.906554182664
             les_mean =     286.161662456982
             stat err =       0.000452406325
             autocorr =       1.281414745383
              std dev =       0.565195645652
             le_variance =       0.319446117864


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906554036648        initial
     3.7253e+00     3.7253e+01             2.1364e-04       -16.906556582270  <--
     1.4901e+01     1.4901e+02             5.4601e-05       -16.906555247948
     5.9605e+01     5.9605e+02             1.3727e-05       -16.906554182664

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 2.4122e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_0001                 7.012011e-01 3 1  ON 0
ci_0002                 7.003665e-01 3 1  ON 1
ci_0003                -2.812837e-02 3 1  ON 2
ci_0004                -2.820038e-02 3 1  ON 3
ci_0005                -3.415832e-02 3 1  ON 4
ci_0006                -3.455213e-02 3 1  ON 5
ci_0007                -2.234382e-02 3 1  ON 6
ci_0008                -2.414322e-02 3 1  ON 7
ci_0009                -1.792273e-02 3 1  ON 8
ci_0010                -1.802448e-02 3 1  ON 9
ci_0011                -1.321188e-02 3 1  ON 10
ci_0012                -1.273753e-02 3 1  ON 11
ci_0013                 1.324652e-02 3 1  ON 12
ci_0014                 1.363240e-02 3 1  ON 13
ci_0015                 1.356674e-02 3 1  ON 14
ci_0016                 1.343209e-02 3 1  ON 15
ci_0017                 1.215497e-02 3 1  ON 16
ci_0018                 1.201408e-02 3 1  ON 17
ci_0019                 1.205000e-02 3 1  ON 18
ci_0020                 1.119088e-02 3 1  ON 19
ci_0021                 2.389490e-03 3 1  ON 20
ci_0022                 3.200086e-03 3 1  ON 21
ci_0023                -1.136508e-02 3 1  ON 22
ci_0024                -1.109291e-02 3 1  ON 23
ci_0025                -1.055255e-02 3 1  ON 24
ci_0026                -1.070429e-02 3 1  ON 25
ci_0027                -1.174649e-02 3 1  ON 26
ci_0028                -1.146406e-02 3 1  ON 27
ci_0029                -1.082239e-02 3 1  ON 28
ci_0030                -1.073227e-02 3 1  ON 29
ci_0031                 1.979500e-02 3 1  ON 30
ci_0032                 1.944809e-02 3 1  ON 31
ci_0033                 9.388325e-03 3 1  ON 32
ci_0034                 1.055882e-02 3 1  ON 33
ci_0035                 6.910859e-03 3 1  ON 34
ci_0036                 6.586145e-03 3 1  ON 35
ci_0037                -1.002287e-02 3 1  ON 36
ci_0038                -1.013424e-02 3 1  ON 37
ci_0039                -2.726875e-03 3 1  ON 38
ci_0040                -2.731221e-03 3 1  ON 39
ci_0041                 7.980848e-03 3 1  ON 40
ci_0042                 7.419968e-03 3 1  ON 41
ci_0043                -1.456555e-02 3 1  ON 42
ci_0044                -1.558417e-02 3 1  ON 43
ci_0045                 7.446207e-03 3 1  ON 44
ci_0046                 7.686590e-03 3 1  ON 45
ci_0047                -2.155447e-03 3 1  ON 46
ci_0048                -1.946650e-03 3 1  ON 47
ci_0049                -5.425542e-03 3 1  ON 48
ci_0050                -5.964266e-03 3 1  ON 49
ci_0051                -3.639989e-03 3 1  ON 50
ci_0052                -3.835186e-03 3 1  ON 51
ci_0053                -4.770540e-03 3 1  ON 52
ci_0054                -4.943380e-03 3 1  ON 53
ci_0055                 6.212907e-03 3 1  ON 54
ci_0056                 6.707138e-03 3 1  ON 55
ci_0057                 4.133406e-03 3 1  ON 56
ci_0058                 5.074020e-03 3 1  ON 57
ci_0059                -5.181501e-03 3 1  ON 58
ci_0060                -4.770988e-03 3 1  ON 59
ci_0061                -3.565409e-03 3 1  ON 60
ci_0062                -2.992487e-03 3 1  ON 61
ci_0063                -8.944932e-03 3 1  ON 62
ci_0064                -8.835837e-03 3 1  ON 63
ci_0065                -5.868553e-03 3 1  ON 64
ci_0066                -5.052403e-03 3 1  ON 65
ci_0067                -5.414168e-03 3 1  ON 66
ci_0068                -5.542683e-03 3 1  ON 67
ci_0069                 5.047752e-03 3 1  ON 68
ci_0070                 4.489819e-03 3 1  ON 69
ci_0071                 1.667436e-03 3 1  ON 70
ci_0072                 2.295955e-03 3 1  ON 71
ci_0073                 4.878691e-03 3 1  ON 72
ci_0074                 4.127272e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1581e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9058
    reference variance = 0.435796
====================================================
  Execution time = 1.4468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3554e-01
  Total weights = 1.952281080e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321598720502
                                         uncertainty =       0.002658066761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321598720502
                                         uncertainty =       0.002658066761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401000625
  error estimate for blocks of size 2^( 2) =       0.000413739517
  error estimate for blocks of size 2^( 3) =       0.000426034763
  error estimate for blocks of size 2^( 4) =       0.000438043736
  error estimate for blocks of size 2^( 5) =       0.000448598654
  error estimate for blocks of size 2^( 6) =       0.000455172761
  error estimate for blocks of size 2^( 7) =       0.000460107447

      target function =                  N/A
              le_mean =     -16.906265473355
             les_mean =     286.157350883331
             stat err =       0.000450480650
             autocorr =       1.262008215069
              std dev =       0.567100522488
             le_variance =       0.321603002606


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626547335e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906265473319       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906273036345       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906273296813       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906273264395       residual = 2.05e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 3.869418e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906265473319       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906267668396       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906267718587       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.050417e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906265473319       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906266045095       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906266056789       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4901e+01 is 2.691926e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171918 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7090e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.012177e-01 3 1  ON 0
ci_0002                 7.003540e-01 3 1  ON 1
ci_0003                -2.817507e-02 3 1  ON 2
ci_0004                -2.820278e-02 3 1  ON 3
ci_0005                -3.414880e-02 3 1  ON 4
ci_0006                -3.454876e-02 3 1  ON 5
ci_0007                -2.233824e-02 3 1  ON 6
ci_0008                -2.409265e-02 3 1  ON 7
ci_0009                -1.789939e-02 3 1  ON 8
ci_0010                -1.798479e-02 3 1  ON 9
ci_0011                -1.317860e-02 3 1  ON 10
ci_0012                -1.271143e-02 3 1  ON 11
ci_0013                 1.321886e-02 3 1  ON 12
ci_0014                 1.366244e-02 3 1  ON 13
ci_0015                 1.356777e-02 3 1  ON 14
ci_0016                 1.342096e-02 3 1  ON 15
ci_0017                 1.216902e-02 3 1  ON 16
ci_0018                 1.202410e-02 3 1  ON 17
ci_0019                 1.203119e-02 3 1  ON 18
ci_0020                 1.127881e-02 3 1  ON 19
ci_0021                 2.395633e-03 3 1  ON 20
ci_0022                 3.237275e-03 3 1  ON 21
ci_0023                -1.144258e-02 3 1  ON 22
ci_0024                -1.106116e-02 3 1  ON 23
ci_0025                -1.057738e-02 3 1  ON 24
ci_0026                -1.068368e-02 3 1  ON 25
ci_0027                -1.174846e-02 3 1  ON 26
ci_0028                -1.140215e-02 3 1  ON 27
ci_0029                -1.073901e-02 3 1  ON 28
ci_0030                -1.070474e-02 3 1  ON 29
ci_0031                 1.979051e-02 3 1  ON 30
ci_0032                 1.947327e-02 3 1  ON 31
ci_0033                 9.338130e-03 3 1  ON 32
ci_0034                 1.045378e-02 3 1  ON 33
ci_0035                 6.938342e-03 3 1  ON 34
ci_0036                 6.599190e-03 3 1  ON 35
ci_0037                -1.003023e-02 3 1  ON 36
ci_0038                -1.015847e-02 3 1  ON 37
ci_0039                -2.777374e-03 3 1  ON 38
ci_0040                -2.785649e-03 3 1  ON 39
ci_0041                 7.943624e-03 3 1  ON 40
ci_0042                 7.407350e-03 3 1  ON 41
ci_0043                -1.457241e-02 3 1  ON 42
ci_0044                -1.555610e-02 3 1  ON 43
ci_0045                 7.456346e-03 3 1  ON 44
ci_0046                 7.687871e-03 3 1  ON 45
ci_0047                -2.158284e-03 3 1  ON 46
ci_0048                -2.011164e-03 3 1  ON 47
ci_0049                -5.462547e-03 3 1  ON 48
ci_0050                -5.950024e-03 3 1  ON 49
ci_0051                -3.616109e-03 3 1  ON 50
ci_0052                -3.816478e-03 3 1  ON 51
ci_0053                -4.791808e-03 3 1  ON 52
ci_0054                -4.946293e-03 3 1  ON 53
ci_0055                 6.252529e-03 3 1  ON 54
ci_0056                 6.709912e-03 3 1  ON 55
ci_0057                 4.138941e-03 3 1  ON 56
ci_0058                 5.067630e-03 3 1  ON 57
ci_0059                -5.141897e-03 3 1  ON 58
ci_0060                -4.779688e-03 3 1  ON 59
ci_0061                -3.591869e-03 3 1  ON 60
ci_0062                -3.010111e-03 3 1  ON 61
ci_0063                -8.920046e-03 3 1  ON 62
ci_0064                -8.869625e-03 3 1  ON 63
ci_0065                -5.857087e-03 3 1  ON 64
ci_0066                -5.078682e-03 3 1  ON 65
ci_0067                -5.401941e-03 3 1  ON 66
ci_0068                -5.534503e-03 3 1  ON 67
ci_0069                 5.028917e-03 3 1  ON 68
ci_0070                 4.503444e-03 3 1  ON 69
ci_0071                 1.716900e-03 3 1  ON 70
ci_0072                 2.285276e-03 3 1  ON 71
ci_0073                 4.861050e-03 3 1  ON 72
ci_0074                 4.171127e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8921
    reference variance = 0.210381
====================================================
  Execution time = 1.6536e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3528e-01
  Total weights = 1.9520e+06
  Execution time = 1.9228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323939984341
                                         uncertainty =       0.002421186747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323939984341
                                         uncertainty =       0.002421186747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402419355
  error estimate for blocks of size 2^( 2) =       0.000415511027
  error estimate for blocks of size 2^( 3) =       0.000428568615
  error estimate for blocks of size 2^( 4) =       0.000440631598
  error estimate for blocks of size 2^( 5) =       0.000452241786
  error estimate for blocks of size 2^( 6) =       0.000459828790
  error estimate for blocks of size 2^( 7) =       0.000464154892

      target function =                  N/A
              le_mean =     -16.906157868100
             les_mean =     286.153427185516
             stat err =       0.000454214266
             autocorr =       1.273983547982
              std dev =       0.569106910158
             le_variance =       0.323882675190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323941353297
                                         uncertainty =       0.002439820546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323941353297
                                         uncertainty =       0.002439820546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402420130
  error estimate for blocks of size 2^( 2) =       0.000415517437
  error estimate for blocks of size 2^( 3) =       0.000428577066
  error estimate for blocks of size 2^( 4) =       0.000440646180
  error estimate for blocks of size 2^( 5) =       0.000452262674
  error estimate for blocks of size 2^( 6) =       0.000459853299
  error estimate for blocks of size 2^( 7) =       0.000464171515

      target function =                  N/A
              le_mean =     -16.906159661700
             les_mean =     286.153774387038
             stat err =       0.000454233417
             autocorr =       1.274086074970
              std dev =       0.569108005043
             le_variance =       0.323883921404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323933969983
                                         uncertainty =       0.002431648312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323933969983
                                         uncertainty =       0.002431648312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402415582
  error estimate for blocks of size 2^( 2) =       0.000415510670
  error estimate for blocks of size 2^( 3) =       0.000428569528
  error estimate for blocks of size 2^( 4) =       0.000440636259
  error estimate for blocks of size 2^( 5) =       0.000452250022
  error estimate for blocks of size 2^( 6) =       0.000459839760
  error estimate for blocks of size 2^( 7) =       0.000464161482

      target function =                  N/A
              le_mean =     -16.906158708313
             les_mean =     286.154927594700
             stat err =       0.000454221881
             autocorr =       1.274050158123
              std dev =       0.569101573086
             le_variance =       0.323876600489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323938290607
                                         uncertainty =       0.002422506592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323938290607
                                         uncertainty =       0.002422506592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402418299
  error estimate for blocks of size 2^( 2) =       0.000415510432
  error estimate for blocks of size 2^( 3) =       0.000428568196
  error estimate for blocks of size 2^( 4) =       0.000440631683
  error estimate for blocks of size 2^( 5) =       0.000452242339
  error estimate for blocks of size 2^( 6) =       0.000459829696
  error estimate for blocks of size 2^( 7) =       0.000464155191

      target function =                  N/A
              le_mean =     -16.906157891480
             les_mean =     286.153430901650
             stat err =       0.000454214727
             autocorr =       1.273992820215
              std dev =       0.569105416077
             le_variance =       0.323880974608


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906157868100        initial
     9.3132e-01     9.3132e+00             3.8694e-04       -16.906159661700  <--
     3.7253e+00     3.7253e+01             1.0504e-04       -16.906158708313
     1.4901e+01     1.4901e+02             2.6919e-05       -16.906157891480

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 2.6279e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_0001                 7.012663e-01 3 1  ON 0
ci_0002                 7.003164e-01 3 1  ON 1
ci_0003                -2.829571e-02 3 1  ON 2
ci_0004                -2.820785e-02 3 1  ON 3
ci_0005                -3.412189e-02 3 1  ON 4
ci_0006                -3.453914e-02 3 1  ON 5
ci_0007                -2.232343e-02 3 1  ON 6
ci_0008                -2.395370e-02 3 1  ON 7
ci_0009                -1.784379e-02 3 1  ON 8
ci_0010                -1.789109e-02 3 1  ON 9
ci_0011                -1.309693e-02 3 1  ON 10
ci_0012                -1.264616e-02 3 1  ON 11
ci_0013                 1.315261e-02 3 1  ON 12
ci_0014                 1.373793e-02 3 1  ON 13
ci_0015                 1.357227e-02 3 1  ON 14
ci_0016                 1.339480e-02 3 1  ON 15
ci_0017                 1.220342e-02 3 1  ON 16
ci_0018                 1.204718e-02 3 1  ON 17
ci_0019                 1.198233e-02 3 1  ON 18
ci_0020                 1.149421e-02 3 1  ON 19
ci_0021                 2.411866e-03 3 1  ON 20
ci_0022                 3.337897e-03 3 1  ON 21
ci_0023                -1.162733e-02 3 1  ON 22
ci_0024                -1.098524e-02 3 1  ON 23
ci_0025                -1.063628e-02 3 1  ON 24
ci_0026                -1.063389e-02 3 1  ON 25
ci_0027                -1.175146e-02 3 1  ON 26
ci_0028                -1.125020e-02 3 1  ON 27
ci_0029                -1.053576e-02 3 1  ON 28
ci_0030                -1.063672e-02 3 1  ON 29
ci_0031                 1.977694e-02 3 1  ON 30
ci_0032                 1.954197e-02 3 1  ON 31
ci_0033                 9.202486e-03 3 1  ON 32
ci_0034                 1.017188e-02 3 1  ON 33
ci_0035                 7.008812e-03 3 1  ON 34
ci_0036                 6.634014e-03 3 1  ON 35
ci_0037                -1.004891e-02 3 1  ON 36
ci_0038                -1.021979e-02 3 1  ON 37
ci_0039                -2.884897e-03 3 1  ON 38
ci_0040                -2.901377e-03 3 1  ON 39
ci_0041                 7.852490e-03 3 1  ON 40
ci_0042                 7.376370e-03 3 1  ON 41
ci_0043                -1.459441e-02 3 1  ON 42
ci_0044                -1.547897e-02 3 1  ON 43
ci_0045                 7.484147e-03 3 1  ON 44
ci_0046                 7.690325e-03 3 1  ON 45
ci_0047                -2.164434e-03 3 1  ON 46
ci_0048                -2.150440e-03 3 1  ON 47
ci_0049                -5.555186e-03 3 1  ON 48
ci_0050                -5.915739e-03 3 1  ON 49
ci_0051                -3.560288e-03 3 1  ON 50
ci_0052                -3.775659e-03 3 1  ON 51
ci_0053                -4.840915e-03 3 1  ON 52
ci_0054                -4.952092e-03 3 1  ON 53
ci_0055                 6.353213e-03 3 1  ON 54
ci_0056                 6.717506e-03 3 1  ON 55
ci_0057                 4.151655e-03 3 1  ON 56
ci_0058                 5.051825e-03 3 1  ON 57
ci_0059                -5.052302e-03 3 1  ON 58
ci_0060                -4.798872e-03 3 1  ON 59
ci_0061                -3.657736e-03 3 1  ON 60
ci_0062                -3.054761e-03 3 1  ON 61
ci_0063                -8.861184e-03 3 1  ON 62
ci_0064                -8.948554e-03 3 1  ON 63
ci_0065                -5.830080e-03 3 1  ON 64
ci_0066                -5.143209e-03 3 1  ON 65
ci_0067                -5.376676e-03 3 1  ON 66
ci_0068                -5.516049e-03 3 1  ON 67
ci_0069                 4.989294e-03 3 1  ON 68
ci_0070                 4.534715e-03 3 1  ON 69
ci_0071                 1.839700e-03 3 1  ON 70
ci_0072                 2.258893e-03 3 1  ON 71
ci_0073                 4.822925e-03 3 1  ON 72
ci_0074                 4.267882e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8298
    reference variance = 0.183958
====================================================
  Execution time = 1.4537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4069e-01
  Total weights = 1.951807244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327598406156
                                         uncertainty =       0.003031831039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327598406156
                                         uncertainty =       0.003031831039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404690895
  error estimate for blocks of size 2^( 2) =       0.000417038718
  error estimate for blocks of size 2^( 3) =       0.000429489191
  error estimate for blocks of size 2^( 4) =       0.000440942287
  error estimate for blocks of size 2^( 5) =       0.000450526216
  error estimate for blocks of size 2^( 6) =       0.000456815828
  error estimate for blocks of size 2^( 7) =       0.000458883475

      target function =                  N/A
              le_mean =     -16.906137833190
             les_mean =     286.158186869676
             stat err =       0.000451791951
             autocorr =       1.246321574663
              std dev =       0.572319352050
             le_variance =       0.327549440731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613783319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137833190       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141082444       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906140452915       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906140213138       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906140312308       residual = 4.63e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e-01 is 1.433833e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137833190       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906139151792       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906139047832       residual = 9.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906139020031       residual = 1.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 4.543755e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906137833190       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906138223686       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906138219747       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906138215523       residual = 3.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 3.7253e+00 is 1.219548e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173277 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7152e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.012603e-01 3 1  ON 0
ci_0002                 7.003252e-01 3 1  ON 1
ci_0003                -2.829123e-02 3 1  ON 2
ci_0004                -2.836591e-02 3 1  ON 3
ci_0005                -3.406756e-02 3 1  ON 4
ci_0006                -3.457579e-02 3 1  ON 5
ci_0007                -2.238750e-02 3 1  ON 6
ci_0008                -2.349933e-02 3 1  ON 7
ci_0009                -1.805539e-02 3 1  ON 8
ci_0010                -1.786942e-02 3 1  ON 9
ci_0011                -1.302272e-02 3 1  ON 10
ci_0012                -1.253337e-02 3 1  ON 11
ci_0013                 1.320378e-02 3 1  ON 12
ci_0014                 1.351526e-02 3 1  ON 13
ci_0015                 1.371488e-02 3 1  ON 14
ci_0016                 1.330891e-02 3 1  ON 15
ci_0017                 1.211708e-02 3 1  ON 16
ci_0018                 1.201548e-02 3 1  ON 17
ci_0019                 1.197288e-02 3 1  ON 18
ci_0020                 1.168776e-02 3 1  ON 19
ci_0021                 2.475986e-03 3 1  ON 20
ci_0022                 3.348222e-03 3 1  ON 21
ci_0023                -1.160654e-02 3 1  ON 22
ci_0024                -1.087557e-02 3 1  ON 23
ci_0025                -1.088774e-02 3 1  ON 24
ci_0026                -1.096448e-02 3 1  ON 25
ci_0027                -1.151968e-02 3 1  ON 26
ci_0028                -1.107026e-02 3 1  ON 27
ci_0029                -1.049565e-02 3 1  ON 28
ci_0030                -1.050765e-02 3 1  ON 29
ci_0031                 1.988403e-02 3 1  ON 30
ci_0032                 1.964094e-02 3 1  ON 31
ci_0033                 9.229670e-03 3 1  ON 32
ci_0034                 1.036951e-02 3 1  ON 33
ci_0035                 7.102874e-03 3 1  ON 34
ci_0036                 6.775661e-03 3 1  ON 35
ci_0037                -1.020318e-02 3 1  ON 36
ci_0038                -1.042073e-02 3 1  ON 37
ci_0039                -2.807598e-03 3 1  ON 38
ci_0040                -3.113717e-03 3 1  ON 39
ci_0041                 7.658497e-03 3 1  ON 40
ci_0042                 7.274068e-03 3 1  ON 41
ci_0043                -1.458592e-02 3 1  ON 42
ci_0044                -1.545214e-02 3 1  ON 43
ci_0045                 7.583463e-03 3 1  ON 44
ci_0046                 7.638150e-03 3 1  ON 45
ci_0047                -2.165789e-03 3 1  ON 46
ci_0048                -2.149031e-03 3 1  ON 47
ci_0049                -5.567429e-03 3 1  ON 48
ci_0050                -5.830831e-03 3 1  ON 49
ci_0051                -3.530049e-03 3 1  ON 50
ci_0052                -3.525474e-03 3 1  ON 51
ci_0053                -4.862878e-03 3 1  ON 52
ci_0054                -5.115414e-03 3 1  ON 53
ci_0055                 6.330379e-03 3 1  ON 54
ci_0056                 6.591253e-03 3 1  ON 55
ci_0057                 4.224106e-03 3 1  ON 56
ci_0058                 4.868544e-03 3 1  ON 57
ci_0059                -5.060895e-03 3 1  ON 58
ci_0060                -4.849508e-03 3 1  ON 59
ci_0061                -3.791471e-03 3 1  ON 60
ci_0062                -3.205642e-03 3 1  ON 61
ci_0063                -8.908926e-03 3 1  ON 62
ci_0064                -8.970938e-03 3 1  ON 63
ci_0065                -5.643389e-03 3 1  ON 64
ci_0066                -5.026955e-03 3 1  ON 65
ci_0067                -5.278446e-03 3 1  ON 66
ci_0068                -5.575881e-03 3 1  ON 67
ci_0069                 4.885273e-03 3 1  ON 68
ci_0070                 4.540523e-03 3 1  ON 69
ci_0071                 1.794928e-03 3 1  ON 70
ci_0072                 2.234871e-03 3 1  ON 71
ci_0073                 4.525613e-03 3 1  ON 72
ci_0074                 4.291452e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8629
    reference variance = 0.235813
====================================================
  Execution time = 1.4270e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3546e-01
  Total weights = 1.9513e+06
  Execution time = 1.9224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321090322058
                                         uncertainty =       0.001661877664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321090322058
                                         uncertainty =       0.001661877664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400685532
  error estimate for blocks of size 2^( 2) =       0.000413641633
  error estimate for blocks of size 2^( 3) =       0.000427055167
  error estimate for blocks of size 2^( 4) =       0.000439370551
  error estimate for blocks of size 2^( 5) =       0.000450188438
  error estimate for blocks of size 2^( 6) =       0.000456973778
  error estimate for blocks of size 2^( 7) =       0.000461676621

      target function =                  N/A
              le_mean =     -16.906083457425
             les_mean =     286.152604343445
             stat err =       0.000452052347
             autocorr =       1.272829211790
              std dev =       0.566654913630
             le_variance =       0.321097791141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441799730
                                         uncertainty =       0.001678615164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441799730
                                         uncertainty =       0.001678615164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400903857
  error estimate for blocks of size 2^( 2) =       0.000413869611
  error estimate for blocks of size 2^( 3) =       0.000427286566
  error estimate for blocks of size 2^( 4) =       0.000439605166
  error estimate for blocks of size 2^( 5) =       0.000450406694
  error estimate for blocks of size 2^( 6) =       0.000457174340
  error estimate for blocks of size 2^( 7) =       0.000461919252

      target function =                  N/A
              le_mean =     -16.906083536708
             les_mean =     286.158908136689
             stat err =       0.000452276363
             autocorr =       1.272703719129
              std dev =       0.566963671973
             le_variance =       0.321447805338

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321341945849
                                         uncertainty =       0.001678985309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321341945849
                                         uncertainty =       0.001678985309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400841790
  error estimate for blocks of size 2^( 2) =       0.000413806075
  error estimate for blocks of size 2^( 3) =       0.000427224596
  error estimate for blocks of size 2^( 4) =       0.000439545056
  error estimate for blocks of size 2^( 5) =       0.000450359281
  error estimate for blocks of size 2^( 6) =       0.000457124701
  error estimate for blocks of size 2^( 7) =       0.000461865309

      target function =                  N/A
              le_mean =     -16.906082993845
             les_mean =     286.151942423767
             stat err =       0.000452223587
             autocorr =       1.272800789066
              std dev =       0.566875895425
             le_variance =       0.321348280814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321114507158
                                         uncertainty =       0.001664194531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321114507158
                                         uncertainty =       0.001664194531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700520
  error estimate for blocks of size 2^( 2) =       0.000413657925
  error estimate for blocks of size 2^( 3) =       0.000427072286
  error estimate for blocks of size 2^( 4) =       0.000439388741
  error estimate for blocks of size 2^( 5) =       0.000450206232
  error estimate for blocks of size 2^( 6) =       0.000456988705
  error estimate for blocks of size 2^( 7) =       0.000461697555

      target function =                  N/A
              le_mean =     -16.906082068511
             les_mean =     286.151068683921
             stat err =       0.000452070308
             autocorr =       1.272835138812
              std dev =       0.566676109216
             le_variance =       0.321121812756


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906083457425        initial
     2.3283e-01     2.3283e+00             1.4338e-03       -16.906083536708  <--
     9.3132e-01     9.3132e+00             4.5438e-04       -16.906082993845
     3.7253e+00     3.7253e+01             1.2195e-04       -16.906082068511

*****************************************************************************
Applying the update for shift_i =   2.3283e-01     and shift_s =   2.3283e+00
*****************************************************************************

  Execution time = 2.4012e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_0001                 7.012314e-01 3 1  ON 0
ci_0002                 7.003578e-01 3 1  ON 1
ci_0003                -2.828196e-02 3 1  ON 2
ci_0004                -2.862780e-02 3 1  ON 3
ci_0005                -3.396643e-02 3 1  ON 4
ci_0006                -3.464745e-02 3 1  ON 5
ci_0007                -2.255265e-02 3 1  ON 6
ci_0008                -2.251987e-02 3 1  ON 7
ci_0009                -1.836691e-02 3 1  ON 8
ci_0010                -1.785261e-02 3 1  ON 9
ci_0011                -1.290771e-02 3 1  ON 10
ci_0012                -1.235439e-02 3 1  ON 11
ci_0013                 1.329596e-02 3 1  ON 12
ci_0014                 1.318596e-02 3 1  ON 13
ci_0015                 1.394571e-02 3 1  ON 14
ci_0016                 1.317656e-02 3 1  ON 15
ci_0017                 1.198679e-02 3 1  ON 16
ci_0018                 1.197432e-02 3 1  ON 17
ci_0019                 1.196992e-02 3 1  ON 18
ci_0020                 1.198577e-02 3 1  ON 19
ci_0021                 2.611075e-03 3 1  ON 20
ci_0022                 3.365896e-03 3 1  ON 21
ci_0023                -1.158318e-02 3 1  ON 22
ci_0024                -1.072666e-02 3 1  ON 23
ci_0025                -1.128005e-02 3 1  ON 24
ci_0026                -1.147018e-02 3 1  ON 25
ci_0027                -1.114666e-02 3 1  ON 26
ci_0028                -1.079098e-02 3 1  ON 27
ci_0029                -1.043232e-02 3 1  ON 28
ci_0030                -1.032055e-02 3 1  ON 29
ci_0031                 2.010497e-02 3 1  ON 30
ci_0032                 1.984639e-02 3 1  ON 31
ci_0033                 9.275969e-03 3 1  ON 32
ci_0034                 1.074440e-02 3 1  ON 33
ci_0035                 7.263257e-03 3 1  ON 34
ci_0036                 7.024640e-03 3 1  ON 35
ci_0037                -1.046679e-02 3 1  ON 36
ci_0038                -1.075715e-02 3 1  ON 37
ci_0039                -2.720268e-03 3 1  ON 38
ci_0040                -3.339997e-03 3 1  ON 39
ci_0041                 7.357891e-03 3 1  ON 40
ci_0042                 7.111296e-03 3 1  ON 41
ci_0043                -1.458920e-02 3 1  ON 42
ci_0044                -1.541798e-02 3 1  ON 43
ci_0045                 7.773281e-03 3 1  ON 44
ci_0046                 7.544690e-03 3 1  ON 45
ci_0047                -2.166414e-03 3 1  ON 46
ci_0048                -2.141727e-03 3 1  ON 47
ci_0049                -5.601307e-03 3 1  ON 48
ci_0050                -5.694241e-03 3 1  ON 49
ci_0051                -3.494164e-03 3 1  ON 50
ci_0052                -3.231667e-03 3 1  ON 51
ci_0053                -4.892898e-03 3 1  ON 52
ci_0054                -5.311912e-03 3 1  ON 53
ci_0055                 6.290499e-03 3 1  ON 54
ci_0056                 6.358816e-03 3 1  ON 55
ci_0057                 4.337002e-03 3 1  ON 56
ci_0058                 4.575536e-03 3 1  ON 57
ci_0059                -5.073072e-03 3 1  ON 58
ci_0060                -4.920094e-03 3 1  ON 59
ci_0061                -4.010111e-03 3 1  ON 60
ci_0062                -3.451233e-03 3 1  ON 61
ci_0063                -8.967586e-03 3 1  ON 62
ci_0064                -8.989330e-03 3 1  ON 63
ci_0065                -5.368134e-03 3 1  ON 64
ci_0066                -4.857910e-03 3 1  ON 65
ci_0067                -5.153026e-03 3 1  ON 66
ci_0068                -5.644536e-03 3 1  ON 67
ci_0069                 4.754409e-03 3 1  ON 68
ci_0070                 4.555778e-03 3 1  ON 69
ci_0071                 1.707150e-03 3 1  ON 70
ci_0072                 2.205341e-03 3 1  ON 71
ci_0073                 4.155579e-03 3 1  ON 72
ci_0074                 4.324197e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1170e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8913
    reference variance = 0.183302
====================================================
  Execution time = 1.4579e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3264e-01
  Total weights = 1.951834417e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321264833537
                                         uncertainty =       0.002207745780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321264833537
                                         uncertainty =       0.002207745780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400815136
  error estimate for blocks of size 2^( 2) =       0.000413746276
  error estimate for blocks of size 2^( 3) =       0.000427176238
  error estimate for blocks of size 2^( 4) =       0.000438513413
  error estimate for blocks of size 2^( 5) =       0.000448692866
  error estimate for blocks of size 2^( 6) =       0.000455843491
  error estimate for blocks of size 2^( 7) =       0.000461056585

      target function =                  N/A
              le_mean =     -16.906656566607
             les_mean =     286.167671731350
             stat err =       0.000451026589
             autocorr =       1.266240102097
              std dev =       0.566838200745
             le_variance =       0.321305545824


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665656661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656566664       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906680970288       residual = 8.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906680071570       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906679896229       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906680019017       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e-02 is 1.741962e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656566664       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906671047951       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906670784099       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906670707538       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e-01 is 8.571875e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906656566664       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906662080451       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906662202038       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906662174965       residual = 2.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 2.849787e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174650 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7203e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.012134e-01 3 1  ON 0
ci_0002                 7.004446e-01 3 1  ON 1
ci_0003                -2.803360e-02 3 1  ON 2
ci_0004                -2.837009e-02 3 1  ON 3
ci_0005                -3.382360e-02 3 1  ON 4
ci_0006                -3.432868e-02 3 1  ON 5
ci_0007                -2.244051e-02 3 1  ON 6
ci_0008                -2.248760e-02 3 1  ON 7
ci_0009                -1.780779e-02 3 1  ON 8
ci_0010                -1.796991e-02 3 1  ON 9
ci_0011                -1.253117e-02 3 1  ON 10
ci_0012                -1.264258e-02 3 1  ON 11
ci_0013                 1.334496e-02 3 1  ON 12
ci_0014                 1.352078e-02 3 1  ON 13
ci_0015                 1.367188e-02 3 1  ON 14
ci_0016                 1.314390e-02 3 1  ON 15
ci_0017                 1.172470e-02 3 1  ON 16
ci_0018                 1.180760e-02 3 1  ON 17
ci_0019                 1.191167e-02 3 1  ON 18
ci_0020                 1.191844e-02 3 1  ON 19
ci_0021                 1.907644e-03 3 1  ON 20
ci_0022                 3.171267e-03 3 1  ON 21
ci_0023                -1.190997e-02 3 1  ON 22
ci_0024                -1.119522e-02 3 1  ON 23
ci_0025                -1.138604e-02 3 1  ON 24
ci_0026                -1.119632e-02 3 1  ON 25
ci_0027                -1.122323e-02 3 1  ON 26
ci_0028                -1.113305e-02 3 1  ON 27
ci_0029                -1.076156e-02 3 1  ON 28
ci_0030                -1.012657e-02 3 1  ON 29
ci_0031                 1.936156e-02 3 1  ON 30
ci_0032                 1.969144e-02 3 1  ON 31
ci_0033                 9.486598e-03 3 1  ON 32
ci_0034                 9.887211e-03 3 1  ON 33
ci_0035                 7.422482e-03 3 1  ON 34
ci_0036                 6.813595e-03 3 1  ON 35
ci_0037                -1.082941e-02 3 1  ON 36
ci_0038                -1.075863e-02 3 1  ON 37
ci_0039                -2.756615e-03 3 1  ON 38
ci_0040                -3.067799e-03 3 1  ON 39
ci_0041                 7.361890e-03 3 1  ON 40
ci_0042                 7.432255e-03 3 1  ON 41
ci_0043                -1.496089e-02 3 1  ON 42
ci_0044                -1.566393e-02 3 1  ON 43
ci_0045                 8.049087e-03 3 1  ON 44
ci_0046                 7.452796e-03 3 1  ON 45
ci_0047                -2.217475e-03 3 1  ON 46
ci_0048                -2.310940e-03 3 1  ON 47
ci_0049                -5.418688e-03 3 1  ON 48
ci_0050                -5.444639e-03 3 1  ON 49
ci_0051                -3.551347e-03 3 1  ON 50
ci_0052                -3.057852e-03 3 1  ON 51
ci_0053                -5.134216e-03 3 1  ON 52
ci_0054                -5.021707e-03 3 1  ON 53
ci_0055                 5.883768e-03 3 1  ON 54
ci_0056                 6.283480e-03 3 1  ON 55
ci_0057                 4.616895e-03 3 1  ON 56
ci_0058                 5.207894e-03 3 1  ON 57
ci_0059                -5.200232e-03 3 1  ON 58
ci_0060                -4.945068e-03 3 1  ON 59
ci_0061                -3.783284e-03 3 1  ON 60
ci_0062                -3.105100e-03 3 1  ON 61
ci_0063                -8.688226e-03 3 1  ON 62
ci_0064                -9.047167e-03 3 1  ON 63
ci_0065                -5.681338e-03 3 1  ON 64
ci_0066                -4.887499e-03 3 1  ON 65
ci_0067                -5.445765e-03 3 1  ON 66
ci_0068                -5.444228e-03 3 1  ON 67
ci_0069                 5.013106e-03 3 1  ON 68
ci_0070                 4.681201e-03 3 1  ON 69
ci_0071                 2.340738e-03 3 1  ON 70
ci_0072                 1.761561e-03 3 1  ON 71
ci_0073                 4.477551e-03 3 1  ON 72
ci_0074                 4.195283e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9132
    reference variance = 0.238845
====================================================
  Execution time = 1.4248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3439e-01
  Total weights = 1.9521e+06
  Execution time = 1.9262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323703054923
                                         uncertainty =       0.002498833065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323703054923
                                         uncertainty =       0.002498833065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402310887
  error estimate for blocks of size 2^( 2) =       0.000415253883
  error estimate for blocks of size 2^( 3) =       0.000428359012
  error estimate for blocks of size 2^( 4) =       0.000440943976
  error estimate for blocks of size 2^( 5) =       0.000452257826
  error estimate for blocks of size 2^( 6) =       0.000460687946
  error estimate for blocks of size 2^( 7) =       0.000468347506

      target function =                  N/A
              le_mean =     -16.906149911684
             les_mean =     286.156186979704
             stat err =       0.000455559314
             autocorr =       1.282231050434
              std dev =       0.568953512512
             le_variance =       0.323708099400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323710185325
                                         uncertainty =       0.002554390975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323710185325
                                         uncertainty =       0.002554390975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402314073
  error estimate for blocks of size 2^( 2) =       0.000415264614
  error estimate for blocks of size 2^( 3) =       0.000428374101
  error estimate for blocks of size 2^( 4) =       0.000440979524
  error estimate for blocks of size 2^( 5) =       0.000452312378
  error estimate for blocks of size 2^( 6) =       0.000460797133
  error estimate for blocks of size 2^( 7) =       0.000468489139

      target function =                  N/A
              le_mean =     -16.906172108740
             les_mean =     286.158848829435
             stat err =       0.000455644543
             autocorr =       1.282690562474
              std dev =       0.568958017834
             le_variance =       0.323713226057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323801531897
                                         uncertainty =       0.002557391125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323801531897
                                         uncertainty =       0.002557391125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402370738
  error estimate for blocks of size 2^( 2) =       0.000415321098
  error estimate for blocks of size 2^( 3) =       0.000428430320
  error estimate for blocks of size 2^( 4) =       0.000441041912
  error estimate for blocks of size 2^( 5) =       0.000452377889
  error estimate for blocks of size 2^( 6) =       0.000460876876
  error estimate for blocks of size 2^( 7) =       0.000468546418

      target function =                  N/A
              le_mean =     -16.906181003408
             les_mean =     286.163669527944
             stat err =       0.000455710774
             autocorr =       1.282702119245
              std dev =       0.569038155120
             le_variance =       0.323804421983

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323655917738
                                         uncertainty =       0.002507155136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323655917738
                                         uncertainty =       0.002507155136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402281375
  error estimate for blocks of size 2^( 2) =       0.000415224758
  error estimate for blocks of size 2^( 3) =       0.000428330942
  error estimate for blocks of size 2^( 4) =       0.000440920457
  error estimate for blocks of size 2^( 5) =       0.000452242003
  error estimate for blocks of size 2^( 6) =       0.000460684657
  error estimate for blocks of size 2^( 7) =       0.000468355707

      target function =                  N/A
              le_mean =     -16.906149447422
             les_mean =     286.153115381496
             stat err =       0.000455550706
             autocorr =       1.282370731287
              std dev =       0.568911775915
             le_variance =       0.323660608775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906149911684        initial
     5.8208e-02     5.8208e-01             1.7420e-03       -16.906172108740
     2.3283e-01     2.3283e+00             8.5719e-04       -16.906181003408  <--
     9.3132e-01     9.3132e+00             2.8498e-04       -16.906149447422

*****************************************************************************
Applying the update for shift_i =   2.3283e-01     and shift_s =   2.3283e+00
*****************************************************************************

  Execution time = 2.3996e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_0001                 7.012134e-01 3 1  ON 0
ci_0002                 7.004446e-01 3 1  ON 1
ci_0003                -2.803360e-02 3 1  ON 2
ci_0004                -2.837009e-02 3 1  ON 3
ci_0005                -3.382360e-02 3 1  ON 4
ci_0006                -3.432868e-02 3 1  ON 5
ci_0007                -2.244051e-02 3 1  ON 6
ci_0008                -2.248760e-02 3 1  ON 7
ci_0009                -1.780779e-02 3 1  ON 8
ci_0010                -1.796991e-02 3 1  ON 9
ci_0011                -1.253117e-02 3 1  ON 10
ci_0012                -1.264258e-02 3 1  ON 11
ci_0013                 1.334496e-02 3 1  ON 12
ci_0014                 1.352078e-02 3 1  ON 13
ci_0015                 1.367188e-02 3 1  ON 14
ci_0016                 1.314390e-02 3 1  ON 15
ci_0017                 1.172470e-02 3 1  ON 16
ci_0018                 1.180760e-02 3 1  ON 17
ci_0019                 1.191167e-02 3 1  ON 18
ci_0020                 1.191844e-02 3 1  ON 19
ci_0021                 1.907644e-03 3 1  ON 20
ci_0022                 3.171267e-03 3 1  ON 21
ci_0023                -1.190997e-02 3 1  ON 22
ci_0024                -1.119522e-02 3 1  ON 23
ci_0025                -1.138604e-02 3 1  ON 24
ci_0026                -1.119632e-02 3 1  ON 25
ci_0027                -1.122323e-02 3 1  ON 26
ci_0028                -1.113305e-02 3 1  ON 27
ci_0029                -1.076156e-02 3 1  ON 28
ci_0030                -1.012657e-02 3 1  ON 29
ci_0031                 1.936156e-02 3 1  ON 30
ci_0032                 1.969144e-02 3 1  ON 31
ci_0033                 9.486598e-03 3 1  ON 32
ci_0034                 9.887211e-03 3 1  ON 33
ci_0035                 7.422482e-03 3 1  ON 34
ci_0036                 6.813595e-03 3 1  ON 35
ci_0037                -1.082941e-02 3 1  ON 36
ci_0038                -1.075863e-02 3 1  ON 37
ci_0039                -2.756615e-03 3 1  ON 38
ci_0040                -3.067799e-03 3 1  ON 39
ci_0041                 7.361890e-03 3 1  ON 40
ci_0042                 7.432255e-03 3 1  ON 41
ci_0043                -1.496089e-02 3 1  ON 42
ci_0044                -1.566393e-02 3 1  ON 43
ci_0045                 8.049087e-03 3 1  ON 44
ci_0046                 7.452796e-03 3 1  ON 45
ci_0047                -2.217475e-03 3 1  ON 46
ci_0048                -2.310940e-03 3 1  ON 47
ci_0049                -5.418688e-03 3 1  ON 48
ci_0050                -5.444639e-03 3 1  ON 49
ci_0051                -3.551347e-03 3 1  ON 50
ci_0052                -3.057852e-03 3 1  ON 51
ci_0053                -5.134216e-03 3 1  ON 52
ci_0054                -5.021707e-03 3 1  ON 53
ci_0055                 5.883768e-03 3 1  ON 54
ci_0056                 6.283480e-03 3 1  ON 55
ci_0057                 4.616895e-03 3 1  ON 56
ci_0058                 5.207894e-03 3 1  ON 57
ci_0059                -5.200232e-03 3 1  ON 58
ci_0060                -4.945068e-03 3 1  ON 59
ci_0061                -3.783284e-03 3 1  ON 60
ci_0062                -3.105100e-03 3 1  ON 61
ci_0063                -8.688226e-03 3 1  ON 62
ci_0064                -9.047167e-03 3 1  ON 63
ci_0065                -5.681338e-03 3 1  ON 64
ci_0066                -4.887499e-03 3 1  ON 65
ci_0067                -5.445765e-03 3 1  ON 66
ci_0068                -5.444228e-03 3 1  ON 67
ci_0069                 5.013106e-03 3 1  ON 68
ci_0070                 4.681201e-03 3 1  ON 69
ci_0071                 2.340738e-03 3 1  ON 70
ci_0072                 1.761561e-03 3 1  ON 71
ci_0073                 4.477551e-03 3 1  ON 72
ci_0074                 4.195283e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1205e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9457
    reference variance = 0.359567
====================================================
  Execution time = 1.4370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5242e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3355e-01
  Total weights = 1.952090890e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320054090858
                                         uncertainty =       0.001976768668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320054090858
                                         uncertainty =       0.001976768668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400043650
  error estimate for blocks of size 2^( 2) =       0.000413466810
  error estimate for blocks of size 2^( 3) =       0.000426446710
  error estimate for blocks of size 2^( 4) =       0.000438545844
  error estimate for blocks of size 2^( 5) =       0.000448029727
  error estimate for blocks of size 2^( 6) =       0.000453901370
  error estimate for blocks of size 2^( 7) =       0.000456984894

      target function =                  N/A
              le_mean =     -16.905706298441
             les_mean =     286.136452575975
             stat err =       0.000449365459
             autocorr =       1.261782822797
              std dev =       0.565747155591
             le_variance =       0.320069844059


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570629844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-02, overlap shift 5.8208e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706298462       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905720584605       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905716503371       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905716166687       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905716230578       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905716698884       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905716875289       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e-02 is 2.647355e-03

solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706298462       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905714982656       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905713411560       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905713376621       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905713420226       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e-01 is 1.172924e-03

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706298462       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905709679496       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905709457669       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905709437071       residual = 4.40e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e-01 is 3.627872e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6983e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.016112e-01 3 1  ON 0
ci_0002                 7.000631e-01 3 1  ON 1
ci_0003                -2.839553e-02 3 1  ON 2
ci_0004                -2.806420e-02 3 1  ON 3
ci_0005                -3.310642e-02 3 1  ON 4
ci_0006                -3.419917e-02 3 1  ON 5
ci_0007                -2.257644e-02 3 1  ON 6
ci_0008                -2.131468e-02 3 1  ON 7
ci_0009                -1.795613e-02 3 1  ON 8
ci_0010                -1.802970e-02 3 1  ON 9
ci_0011                -1.266048e-02 3 1  ON 10
ci_0012                -1.281259e-02 3 1  ON 11
ci_0013                 1.329083e-02 3 1  ON 12
ci_0014                 1.424535e-02 3 1  ON 13
ci_0015                 1.333690e-02 3 1  ON 14
ci_0016                 1.349893e-02 3 1  ON 15
ci_0017                 1.158602e-02 3 1  ON 16
ci_0018                 1.185478e-02 3 1  ON 17
ci_0019                 1.215575e-02 3 1  ON 18
ci_0020                 1.153566e-02 3 1  ON 19
ci_0021                 1.992167e-03 3 1  ON 20
ci_0022                 2.529416e-03 3 1  ON 21
ci_0023                -1.168371e-02 3 1  ON 22
ci_0024                -1.145073e-02 3 1  ON 23
ci_0025                -1.085481e-02 3 1  ON 24
ci_0026                -1.069963e-02 3 1  ON 25
ci_0027                -1.089263e-02 3 1  ON 26
ci_0028                -1.118915e-02 3 1  ON 27
ci_0029                -1.089523e-02 3 1  ON 28
ci_0030                -1.042469e-02 3 1  ON 29
ci_0031                 1.988597e-02 3 1  ON 30
ci_0032                 2.001029e-02 3 1  ON 31
ci_0033                 1.048348e-02 3 1  ON 32
ci_0034                 9.791445e-03 3 1  ON 33
ci_0035                 6.668780e-03 3 1  ON 34
ci_0036                 7.024205e-03 3 1  ON 35
ci_0037                -1.078452e-02 3 1  ON 36
ci_0038                -1.120708e-02 3 1  ON 37
ci_0039                -2.611441e-03 3 1  ON 38
ci_0040                -2.631072e-03 3 1  ON 39
ci_0041                 7.869855e-03 3 1  ON 40
ci_0042                 6.868656e-03 3 1  ON 41
ci_0043                -1.543304e-02 3 1  ON 42
ci_0044                -1.554306e-02 3 1  ON 43
ci_0045                 8.112643e-03 3 1  ON 44
ci_0046                 8.122484e-03 3 1  ON 45
ci_0047                -2.106850e-03 3 1  ON 46
ci_0048                -2.045398e-03 3 1  ON 47
ci_0049                -5.703680e-03 3 1  ON 48
ci_0050                -6.140214e-03 3 1  ON 49
ci_0051                -3.619623e-03 3 1  ON 50
ci_0052                -3.751608e-03 3 1  ON 51
ci_0053                -5.076864e-03 3 1  ON 52
ci_0054                -5.220798e-03 3 1  ON 53
ci_0055                 6.629735e-03 3 1  ON 54
ci_0056                 6.728037e-03 3 1  ON 55
ci_0057                 4.602997e-03 3 1  ON 56
ci_0058                 4.994084e-03 3 1  ON 57
ci_0059                -4.415959e-03 3 1  ON 58
ci_0060                -4.236501e-03 3 1  ON 59
ci_0061                -3.991098e-03 3 1  ON 60
ci_0062                -3.167928e-03 3 1  ON 61
ci_0063                -8.480987e-03 3 1  ON 62
ci_0064                -8.464403e-03 3 1  ON 63
ci_0065                -5.949449e-03 3 1  ON 64
ci_0066                -5.332351e-03 3 1  ON 65
ci_0067                -5.378733e-03 3 1  ON 66
ci_0068                -5.204792e-03 3 1  ON 67
ci_0069                 4.978151e-03 3 1  ON 68
ci_0070                 4.696751e-03 3 1  ON 69
ci_0071                 2.036086e-03 3 1  ON 70
ci_0072                 1.917401e-03 3 1  ON 71
ci_0073                 4.609469e-03 3 1  ON 72
ci_0074                 4.505358e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9497
    reference variance = 0.483168
====================================================
  Execution time = 1.4286e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3552e-01
  Total weights = 1.9521e+06
  Execution time = 1.9177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322456627280
                                         uncertainty =       0.002850273712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322456627280
                                         uncertainty =       0.002850273712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401506781
  error estimate for blocks of size 2^( 2) =       0.000414642617
  error estimate for blocks of size 2^( 3) =       0.000428165274
  error estimate for blocks of size 2^( 4) =       0.000440448696
  error estimate for blocks of size 2^( 5) =       0.000451806068
  error estimate for blocks of size 2^( 6) =       0.000460333017
  error estimate for blocks of size 2^( 7) =       0.000465642755

      target function =                  N/A
              le_mean =     -16.906850976253
             les_mean =     286.281463427426
             stat err =       0.000454557634
             autocorr =       1.281716991059
              std dev =       0.567816335737
             le_variance =       0.322415391130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322158901094
                                         uncertainty =       0.002804885877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322158901094
                                         uncertainty =       0.002804885877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401325002
  error estimate for blocks of size 2^( 2) =       0.000414437676
  error estimate for blocks of size 2^( 3) =       0.000427966770
  error estimate for blocks of size 2^( 4) =       0.000440239160
  error estimate for blocks of size 2^( 5) =       0.000451498753
  error estimate for blocks of size 2^( 6) =       0.000460064986
  error estimate for blocks of size 2^( 7) =       0.000465320491

      target function =                  N/A
              le_mean =     -16.906809714113
             les_mean =     286.193196949968
             stat err =       0.000454280847
             autocorr =       1.281316511063
              std dev =       0.567559260053
             le_variance =       0.322123513672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322231409381
                                         uncertainty =       0.002779883884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322231409381
                                         uncertainty =       0.002779883884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401370350
  error estimate for blocks of size 2^( 2) =       0.000414473250
  error estimate for blocks of size 2^( 3) =       0.000428006234
  error estimate for blocks of size 2^( 4) =       0.000440276773
  error estimate for blocks of size 2^( 5) =       0.000451543420
  error estimate for blocks of size 2^( 6) =       0.000460113920
  error estimate for blocks of size 2^( 7) =       0.000465373097

      target function =                  N/A
              le_mean =     -16.906825582200
             les_mean =     286.195901658810
             stat err =       0.000454326802
             autocorr =       1.281286182834
              std dev =       0.567623392071
             le_variance =       0.322196315227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322088954348
                                         uncertainty =       0.002828452639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322088954348
                                         uncertainty =       0.002828452639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401279443
  error estimate for blocks of size 2^( 2) =       0.000414412650
  error estimate for blocks of size 2^( 3) =       0.000427938340
  error estimate for blocks of size 2^( 4) =       0.000440227433
  error estimate for blocks of size 2^( 5) =       0.000451519062
  error estimate for blocks of size 2^( 6) =       0.000460040738
  error estimate for blocks of size 2^( 7) =       0.000465297692

      target function =                  N/A
              le_mean =     -16.906824826021
             les_mean =     286.176877864008
             stat err =       0.000454271231
             autocorr =       1.281553216556
              std dev =       0.567494830105
             le_variance =       0.322050382196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906850976253        initial  <--
     5.8208e-02     5.8208e-01             2.6474e-03       -16.906809714113
     2.3283e-01     2.3283e+00             1.1729e-03       -16.906825582200
     9.3132e-01     9.3132e+00             3.6279e-04       -16.906824826021

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9979
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_0001                 7.012134e-01 3 1  ON 0
ci_0002                 7.004446e-01 3 1  ON 1
ci_0003                -2.803360e-02 3 1  ON 2
ci_0004                -2.837009e-02 3 1  ON 3
ci_0005                -3.382360e-02 3 1  ON 4
ci_0006                -3.432868e-02 3 1  ON 5
ci_0007                -2.244051e-02 3 1  ON 6
ci_0008                -2.248760e-02 3 1  ON 7
ci_0009                -1.780779e-02 3 1  ON 8
ci_0010                -1.796991e-02 3 1  ON 9
ci_0011                -1.253117e-02 3 1  ON 10
ci_0012                -1.264258e-02 3 1  ON 11
ci_0013                 1.334496e-02 3 1  ON 12
ci_0014                 1.352078e-02 3 1  ON 13
ci_0015                 1.367188e-02 3 1  ON 14
ci_0016                 1.314390e-02 3 1  ON 15
ci_0017                 1.172470e-02 3 1  ON 16
ci_0018                 1.180760e-02 3 1  ON 17
ci_0019                 1.191167e-02 3 1  ON 18
ci_0020                 1.191844e-02 3 1  ON 19
ci_0021                 1.907644e-03 3 1  ON 20
ci_0022                 3.171267e-03 3 1  ON 21
ci_0023                -1.190997e-02 3 1  ON 22
ci_0024                -1.119522e-02 3 1  ON 23
ci_0025                -1.138604e-02 3 1  ON 24
ci_0026                -1.119632e-02 3 1  ON 25
ci_0027                -1.122323e-02 3 1  ON 26
ci_0028                -1.113305e-02 3 1  ON 27
ci_0029                -1.076156e-02 3 1  ON 28
ci_0030                -1.012657e-02 3 1  ON 29
ci_0031                 1.936156e-02 3 1  ON 30
ci_0032                 1.969144e-02 3 1  ON 31
ci_0033                 9.486598e-03 3 1  ON 32
ci_0034                 9.887211e-03 3 1  ON 33
ci_0035                 7.422482e-03 3 1  ON 34
ci_0036                 6.813595e-03 3 1  ON 35
ci_0037                -1.082941e-02 3 1  ON 36
ci_0038                -1.075863e-02 3 1  ON 37
ci_0039                -2.756615e-03 3 1  ON 38
ci_0040                -3.067799e-03 3 1  ON 39
ci_0041                 7.361890e-03 3 1  ON 40
ci_0042                 7.432255e-03 3 1  ON 41
ci_0043                -1.496089e-02 3 1  ON 42
ci_0044                -1.566393e-02 3 1  ON 43
ci_0045                 8.049087e-03 3 1  ON 44
ci_0046                 7.452796e-03 3 1  ON 45
ci_0047                -2.217475e-03 3 1  ON 46
ci_0048                -2.310940e-03 3 1  ON 47
ci_0049                -5.418688e-03 3 1  ON 48
ci_0050                -5.444639e-03 3 1  ON 49
ci_0051                -3.551347e-03 3 1  ON 50
ci_0052                -3.057852e-03 3 1  ON 51
ci_0053                -5.134216e-03 3 1  ON 52
ci_0054                -5.021707e-03 3 1  ON 53
ci_0055                 5.883768e-03 3 1  ON 54
ci_0056                 6.283480e-03 3 1  ON 55
ci_0057                 4.616895e-03 3 1  ON 56
ci_0058                 5.207894e-03 3 1  ON 57
ci_0059                -5.200232e-03 3 1  ON 58
ci_0060                -4.945068e-03 3 1  ON 59
ci_0061                -3.783284e-03 3 1  ON 60
ci_0062                -3.105100e-03 3 1  ON 61
ci_0063                -8.688226e-03 3 1  ON 62
ci_0064                -9.047167e-03 3 1  ON 63
ci_0065                -5.681338e-03 3 1  ON 64
ci_0066                -4.887499e-03 3 1  ON 65
ci_0067                -5.445765e-03 3 1  ON 66
ci_0068                -5.444228e-03 3 1  ON 67
ci_0069                 5.013106e-03 3 1  ON 68
ci_0070                 4.681201e-03 3 1  ON 69
ci_0071                 2.340738e-03 3 1  ON 70
ci_0072                 1.761561e-03 3 1  ON 71
ci_0073                 4.477551e-03 3 1  ON 72
ci_0074                 4.195283e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8783
    reference variance = 0.182422
====================================================
  Execution time = 1.4425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3279e-01
  Total weights = 1.951641521e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321090343491
                                         uncertainty =       0.002562865748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321090343491
                                         uncertainty =       0.002562865748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400680020
  error estimate for blocks of size 2^( 2) =       0.000413652615
  error estimate for blocks of size 2^( 3) =       0.000426458537
  error estimate for blocks of size 2^( 4) =       0.000439567767
  error estimate for blocks of size 2^( 5) =       0.000450642287
  error estimate for blocks of size 2^( 6) =       0.000457491471
  error estimate for blocks of size 2^( 7) =       0.000461104606

      target function =                  N/A
              le_mean =     -16.906536996312
             les_mean =     286.163779020485
             stat err =       0.000452201532
             autocorr =       1.273704508816
              std dev =       0.566647118307
             le_variance =       0.321088956686


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653699631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906536996329       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906533232234       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906533660184       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906533620412       residual = 7.09e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e-01 is 4.310663e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906536996329       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906535805285       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906535867113       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906535866164       residual = 1.31e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+00 is 1.370250e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906536996329       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906536677383       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906536687071       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906536687664       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+00 is 3.774179e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.177579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7037e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.012534e-01 3 1  ON 0
ci_0002                 7.004045e-01 3 1  ON 1
ci_0003                -2.800827e-02 3 1  ON 2
ci_0004                -2.837634e-02 3 1  ON 3
ci_0005                -3.384535e-02 3 1  ON 4
ci_0006                -3.435845e-02 3 1  ON 5
ci_0007                -2.242405e-02 3 1  ON 6
ci_0008                -2.248937e-02 3 1  ON 7
ci_0009                -1.774061e-02 3 1  ON 8
ci_0010                -1.789033e-02 3 1  ON 9
ci_0011                -1.252632e-02 3 1  ON 10
ci_0012                -1.261759e-02 3 1  ON 11
ci_0013                 1.339443e-02 3 1  ON 12
ci_0014                 1.346291e-02 3 1  ON 13
ci_0015                 1.359468e-02 3 1  ON 14
ci_0016                 1.318638e-02 3 1  ON 15
ci_0017                 1.186097e-02 3 1  ON 16
ci_0018                 1.178018e-02 3 1  ON 17
ci_0019                 1.180808e-02 3 1  ON 18
ci_0020                 1.193453e-02 3 1  ON 19
ci_0021                 1.931838e-03 3 1  ON 20
ci_0022                 3.133556e-03 3 1  ON 21
ci_0023                -1.177332e-02 3 1  ON 22
ci_0024                -1.113756e-02 3 1  ON 23
ci_0025                -1.141841e-02 3 1  ON 24
ci_0026                -1.115761e-02 3 1  ON 25
ci_0027                -1.128243e-02 3 1  ON 26
ci_0028                -1.115300e-02 3 1  ON 27
ci_0029                -1.075297e-02 3 1  ON 28
ci_0030                -1.023039e-02 3 1  ON 29
ci_0031                 1.940197e-02 3 1  ON 30
ci_0032                 1.969583e-02 3 1  ON 31
ci_0033                 9.408103e-03 3 1  ON 32
ci_0034                 9.972233e-03 3 1  ON 33
ci_0035                 7.402284e-03 3 1  ON 34
ci_0036                 6.826920e-03 3 1  ON 35
ci_0037                -1.082324e-02 3 1  ON 36
ci_0038                -1.075702e-02 3 1  ON 37
ci_0039                -2.732615e-03 3 1  ON 38
ci_0040                -3.014335e-03 3 1  ON 39
ci_0041                 7.370538e-03 3 1  ON 40
ci_0042                 7.473619e-03 3 1  ON 41
ci_0043                -1.494188e-02 3 1  ON 42
ci_0044                -1.571400e-02 3 1  ON 43
ci_0045                 8.070549e-03 3 1  ON 44
ci_0046                 7.559281e-03 3 1  ON 45
ci_0047                -2.215722e-03 3 1  ON 46
ci_0048                -2.261448e-03 3 1  ON 47
ci_0049                -5.483592e-03 3 1  ON 48
ci_0050                -5.446291e-03 3 1  ON 49
ci_0051                -3.592709e-03 3 1  ON 50
ci_0052                -3.118820e-03 3 1  ON 51
ci_0053                -5.188030e-03 3 1  ON 52
ci_0054                -5.079423e-03 3 1  ON 53
ci_0055                 5.944309e-03 3 1  ON 54
ci_0056                 6.316640e-03 3 1  ON 55
ci_0057                 4.698830e-03 3 1  ON 56
ci_0058                 5.082940e-03 3 1  ON 57
ci_0059                -5.189572e-03 3 1  ON 58
ci_0060                -4.930707e-03 3 1  ON 59
ci_0061                -3.733109e-03 3 1  ON 60
ci_0062                -3.148823e-03 3 1  ON 61
ci_0063                -8.624531e-03 3 1  ON 62
ci_0064                -8.973750e-03 3 1  ON 63
ci_0065                -5.622672e-03 3 1  ON 64
ci_0066                -5.020290e-03 3 1  ON 65
ci_0067                -5.465531e-03 3 1  ON 66
ci_0068                -5.464070e-03 3 1  ON 67
ci_0069                 4.955160e-03 3 1  ON 68
ci_0070                 4.727128e-03 3 1  ON 69
ci_0071                 2.251571e-03 3 1  ON 70
ci_0072                 1.800513e-03 3 1  ON 71
ci_0073                 4.426943e-03 3 1  ON 72
ci_0074                 4.332308e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.914
    reference variance = 0.181376
====================================================
  Execution time = 1.4204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3289e-01
  Total weights = 1.9518e+06
  Execution time = 1.9318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320326872507
                                         uncertainty =       0.002995994748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320326872507
                                         uncertainty =       0.002995994748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400177558
  error estimate for blocks of size 2^( 2) =       0.000412793911
  error estimate for blocks of size 2^( 3) =       0.000425907061
  error estimate for blocks of size 2^( 4) =       0.000438312803
  error estimate for blocks of size 2^( 5) =       0.000447972387
  error estimate for blocks of size 2^( 6) =       0.000456193046
  error estimate for blocks of size 2^( 7) =       0.000460927134

      target function =                  N/A
              le_mean =     -16.906561164220
             les_mean =     286.164689974294
             stat err =       0.000450851343
             autocorr =       1.269291220565
              std dev =       0.565936529309
             le_variance =       0.320284155206

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320480964739
                                         uncertainty =       0.003023677623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320480964739
                                         uncertainty =       0.003023677623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400273717
  error estimate for blocks of size 2^( 2) =       0.000412891224
  error estimate for blocks of size 2^( 3) =       0.000426005652
  error estimate for blocks of size 2^( 4) =       0.000438405966
  error estimate for blocks of size 2^( 5) =       0.000448061398
  error estimate for blocks of size 2^( 6) =       0.000456287000
  error estimate for blocks of size 2^( 7) =       0.000461039793

      target function =                  N/A
              le_mean =     -16.906557912516
             les_mean =     286.187146279668
             stat err =       0.000450948539
             autocorr =       1.269228512127
              std dev =       0.566072519674
             le_variance =       0.320438097530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320418791207
                                         uncertainty =       0.003015430009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320418791207
                                         uncertainty =       0.003015430009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400234898
  error estimate for blocks of size 2^( 2) =       0.000412851260
  error estimate for blocks of size 2^( 3) =       0.000425964380
  error estimate for blocks of size 2^( 4) =       0.000438366620
  error estimate for blocks of size 2^( 5) =       0.000448022381
  error estimate for blocks of size 2^( 6) =       0.000456244446
  error estimate for blocks of size 2^( 7) =       0.000460989102

      target function =                  N/A
              le_mean =     -16.906557142559
             les_mean =     286.169083058279
             stat err =       0.000450905637
             autocorr =       1.269233199630
              std dev =       0.566017620242
             le_variance =       0.320375946425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320337496720
                                         uncertainty =       0.002998645558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320337496720
                                         uncertainty =       0.002998645558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400184183
  error estimate for blocks of size 2^( 2) =       0.000412800579
  error estimate for blocks of size 2^( 3) =       0.000425913668
  error estimate for blocks of size 2^( 4) =       0.000438319025
  error estimate for blocks of size 2^( 5) =       0.000447978010
  error estimate for blocks of size 2^( 6) =       0.000456198768
  error estimate for blocks of size 2^( 7) =       0.000460933954

      target function =                  N/A
              le_mean =     -16.906560413855
             les_mean =     286.164629847256
             stat err =       0.000450857439
             autocorr =       1.269283519323
              std dev =       0.565945899122
             le_variance =       0.320294760733


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906561164220        initial  <--
     5.8208e-01     5.8208e+00             4.3107e-04       -16.906557912516
     2.3283e+00     2.3283e+01             1.3702e-04       -16.906557142559
     9.3132e+00     9.3132e+01             3.7742e-05       -16.906560413855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9851
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_0001                 7.012134e-01 3 1  ON 0
ci_0002                 7.004446e-01 3 1  ON 1
ci_0003                -2.803360e-02 3 1  ON 2
ci_0004                -2.837009e-02 3 1  ON 3
ci_0005                -3.382360e-02 3 1  ON 4
ci_0006                -3.432868e-02 3 1  ON 5
ci_0007                -2.244051e-02 3 1  ON 6
ci_0008                -2.248760e-02 3 1  ON 7
ci_0009                -1.780779e-02 3 1  ON 8
ci_0010                -1.796991e-02 3 1  ON 9
ci_0011                -1.253117e-02 3 1  ON 10
ci_0012                -1.264258e-02 3 1  ON 11
ci_0013                 1.334496e-02 3 1  ON 12
ci_0014                 1.352078e-02 3 1  ON 13
ci_0015                 1.367188e-02 3 1  ON 14
ci_0016                 1.314390e-02 3 1  ON 15
ci_0017                 1.172470e-02 3 1  ON 16
ci_0018                 1.180760e-02 3 1  ON 17
ci_0019                 1.191167e-02 3 1  ON 18
ci_0020                 1.191844e-02 3 1  ON 19
ci_0021                 1.907644e-03 3 1  ON 20
ci_0022                 3.171267e-03 3 1  ON 21
ci_0023                -1.190997e-02 3 1  ON 22
ci_0024                -1.119522e-02 3 1  ON 23
ci_0025                -1.138604e-02 3 1  ON 24
ci_0026                -1.119632e-02 3 1  ON 25
ci_0027                -1.122323e-02 3 1  ON 26
ci_0028                -1.113305e-02 3 1  ON 27
ci_0029                -1.076156e-02 3 1  ON 28
ci_0030                -1.012657e-02 3 1  ON 29
ci_0031                 1.936156e-02 3 1  ON 30
ci_0032                 1.969144e-02 3 1  ON 31
ci_0033                 9.486598e-03 3 1  ON 32
ci_0034                 9.887211e-03 3 1  ON 33
ci_0035                 7.422482e-03 3 1  ON 34
ci_0036                 6.813595e-03 3 1  ON 35
ci_0037                -1.082941e-02 3 1  ON 36
ci_0038                -1.075863e-02 3 1  ON 37
ci_0039                -2.756615e-03 3 1  ON 38
ci_0040                -3.067799e-03 3 1  ON 39
ci_0041                 7.361890e-03 3 1  ON 40
ci_0042                 7.432255e-03 3 1  ON 41
ci_0043                -1.496089e-02 3 1  ON 42
ci_0044                -1.566393e-02 3 1  ON 43
ci_0045                 8.049087e-03 3 1  ON 44
ci_0046                 7.452796e-03 3 1  ON 45
ci_0047                -2.217475e-03 3 1  ON 46
ci_0048                -2.310940e-03 3 1  ON 47
ci_0049                -5.418688e-03 3 1  ON 48
ci_0050                -5.444639e-03 3 1  ON 49
ci_0051                -3.551347e-03 3 1  ON 50
ci_0052                -3.057852e-03 3 1  ON 51
ci_0053                -5.134216e-03 3 1  ON 52
ci_0054                -5.021707e-03 3 1  ON 53
ci_0055                 5.883768e-03 3 1  ON 54
ci_0056                 6.283480e-03 3 1  ON 55
ci_0057                 4.616895e-03 3 1  ON 56
ci_0058                 5.207894e-03 3 1  ON 57
ci_0059                -5.200232e-03 3 1  ON 58
ci_0060                -4.945068e-03 3 1  ON 59
ci_0061                -3.783284e-03 3 1  ON 60
ci_0062                -3.105100e-03 3 1  ON 61
ci_0063                -8.688226e-03 3 1  ON 62
ci_0064                -9.047167e-03 3 1  ON 63
ci_0065                -5.681338e-03 3 1  ON 64
ci_0066                -4.887499e-03 3 1  ON 65
ci_0067                -5.445765e-03 3 1  ON 66
ci_0068                -5.444228e-03 3 1  ON 67
ci_0069                 5.013106e-03 3 1  ON 68
ci_0070                 4.681201e-03 3 1  ON 69
ci_0071                 2.340738e-03 3 1  ON 70
ci_0072                 1.761561e-03 3 1  ON 71
ci_0073                 4.477551e-03 3 1  ON 72
ci_0074                 4.195283e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8417
    reference variance = 0.252666
====================================================
  Execution time = 1.4483e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3289e-01
  Total weights = 1.951574583e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319548263473
                                         uncertainty =       0.002602545211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319548263473
                                         uncertainty =       0.002602545211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399681326
  error estimate for blocks of size 2^( 2) =       0.000412375390
  error estimate for blocks of size 2^( 3) =       0.000426189770
  error estimate for blocks of size 2^( 4) =       0.000439065719
  error estimate for blocks of size 2^( 5) =       0.000449576937
  error estimate for blocks of size 2^( 6) =       0.000457156571
  error estimate for blocks of size 2^( 7) =       0.000463524625

      target function =                  N/A
              le_mean =     -16.905573782191
             les_mean =     286.131315782434
             stat err =       0.000452330963
             autocorr =       1.280810616137
              std dev =       0.565234752129
             le_variance =       0.319490325015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690557378219e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905573782172       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905574662721       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905574621408       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905574634321       residual = 3.04e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+00 is 1.036001e-04

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905573782172       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905574007831       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905573996408       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905573999696       residual = 3.30e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+01 is 2.630330e-05

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905573782172       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905573838943       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905573836016       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905573836840       residual = 3.39e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+01 is 6.601507e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7093e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.012159e-01 3 1  ON 0
ci_0002                 7.004415e-01 3 1  ON 1
ci_0003                -2.803050e-02 3 1  ON 2
ci_0004                -2.836488e-02 3 1  ON 3
ci_0005                -3.382415e-02 3 1  ON 4
ci_0006                -3.432775e-02 3 1  ON 5
ci_0007                -2.243911e-02 3 1  ON 6
ci_0008                -2.248880e-02 3 1  ON 7
ci_0009                -1.780593e-02 3 1  ON 8
ci_0010                -1.798046e-02 3 1  ON 9
ci_0011                -1.253582e-02 3 1  ON 10
ci_0012                -1.264628e-02 3 1  ON 11
ci_0013                 1.335196e-02 3 1  ON 12
ci_0014                 1.353094e-02 3 1  ON 13
ci_0015                 1.367668e-02 3 1  ON 14
ci_0016                 1.314083e-02 3 1  ON 15
ci_0017                 1.172605e-02 3 1  ON 16
ci_0018                 1.180058e-02 3 1  ON 17
ci_0019                 1.191427e-02 3 1  ON 18
ci_0020                 1.190255e-02 3 1  ON 19
ci_0021                 1.906656e-03 3 1  ON 20
ci_0022                 3.167060e-03 3 1  ON 21
ci_0023                -1.190905e-02 3 1  ON 22
ci_0024                -1.119359e-02 3 1  ON 23
ci_0025                -1.138721e-02 3 1  ON 24
ci_0026                -1.119058e-02 3 1  ON 25
ci_0027                -1.121167e-02 3 1  ON 26
ci_0028                -1.112839e-02 3 1  ON 27
ci_0029                -1.075930e-02 3 1  ON 28
ci_0030                -1.014219e-02 3 1  ON 29
ci_0031                 1.938786e-02 3 1  ON 30
ci_0032                 1.969564e-02 3 1  ON 31
ci_0033                 9.480579e-03 3 1  ON 32
ci_0034                 9.886023e-03 3 1  ON 33
ci_0035                 7.421471e-03 3 1  ON 34
ci_0036                 6.812592e-03 3 1  ON 35
ci_0037                -1.083876e-02 3 1  ON 36
ci_0038                -1.075779e-02 3 1  ON 37
ci_0039                -2.749116e-03 3 1  ON 38
ci_0040                -3.074855e-03 3 1  ON 39
ci_0041                 7.358109e-03 3 1  ON 40
ci_0042                 7.422012e-03 3 1  ON 41
ci_0043                -1.495943e-02 3 1  ON 42
ci_0044                -1.566762e-02 3 1  ON 43
ci_0045                 8.055815e-03 3 1  ON 44
ci_0046                 7.443214e-03 3 1  ON 45
ci_0047                -2.216841e-03 3 1  ON 46
ci_0048                -2.312421e-03 3 1  ON 47
ci_0049                -5.427549e-03 3 1  ON 48
ci_0050                -5.456265e-03 3 1  ON 49
ci_0051                -3.555324e-03 3 1  ON 50
ci_0052                -3.059421e-03 3 1  ON 51
ci_0053                -5.128096e-03 3 1  ON 52
ci_0054                -5.013536e-03 3 1  ON 53
ci_0055                 5.894659e-03 3 1  ON 54
ci_0056                 6.279241e-03 3 1  ON 55
ci_0057                 4.616108e-03 3 1  ON 56
ci_0058                 5.207240e-03 3 1  ON 57
ci_0059                -5.199772e-03 3 1  ON 58
ci_0060                -4.940300e-03 3 1  ON 59
ci_0061                -3.782415e-03 3 1  ON 60
ci_0062                -3.111397e-03 3 1  ON 61
ci_0063                -8.695934e-03 3 1  ON 62
ci_0064                -9.045396e-03 3 1  ON 63
ci_0065                -5.679783e-03 3 1  ON 64
ci_0066                -4.879710e-03 3 1  ON 65
ci_0067                -5.436774e-03 3 1  ON 66
ci_0068                -5.435044e-03 3 1  ON 67
ci_0069                 5.005927e-03 3 1  ON 68
ci_0070                 4.687331e-03 3 1  ON 69
ci_0071                 2.339876e-03 3 1  ON 70
ci_0072                 1.767754e-03 3 1  ON 71
ci_0073                 4.475330e-03 3 1  ON 72
ci_0074                 4.191669e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9333
    reference variance = 0.306094
====================================================
  Execution time = 1.4470e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3148e-01
  Total weights = 1.9523e+06
  Execution time = 1.9303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319667817633
                                         uncertainty =       0.002447563902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319667817633
                                         uncertainty =       0.002447563902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399881723
  error estimate for blocks of size 2^( 2) =       0.000412947164
  error estimate for blocks of size 2^( 3) =       0.000426387535
  error estimate for blocks of size 2^( 4) =       0.000438707632
  error estimate for blocks of size 2^( 5) =       0.000449156825
  error estimate for blocks of size 2^( 6) =       0.000457525742
  error estimate for blocks of size 2^( 7) =       0.000464545622

      target function =                  N/A
              le_mean =     -16.906485771818
             les_mean =     286.160772877914
             stat err =       0.000452483955
             autocorr =       1.280392904254
              std dev =       0.565518156058
             le_variance =       0.319810784831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319655859728
                                         uncertainty =       0.002446537567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319655859728
                                         uncertainty =       0.002446537567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399874138
  error estimate for blocks of size 2^( 2) =       0.000412940806
  error estimate for blocks of size 2^( 3) =       0.000426382306
  error estimate for blocks of size 2^( 4) =       0.000438703022
  error estimate for blocks of size 2^( 5) =       0.000449151370
  error estimate for blocks of size 2^( 6) =       0.000457520665
  error estimate for blocks of size 2^( 7) =       0.000464537892

      target function =                  N/A
              le_mean =     -16.906485242964
             les_mean =     286.160671133245
             stat err =       0.000452478237
             autocorr =       1.280409116295
              std dev =       0.565507429465
             le_variance =       0.319798652780

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319661361498
                                         uncertainty =       0.002447031914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319661361498
                                         uncertainty =       0.002447031914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399877631
  error estimate for blocks of size 2^( 2) =       0.000412943703
  error estimate for blocks of size 2^( 3) =       0.000426384655
  error estimate for blocks of size 2^( 4) =       0.000438705080
  error estimate for blocks of size 2^( 5) =       0.000449153846
  error estimate for blocks of size 2^( 6) =       0.000457522959
  error estimate for blocks of size 2^( 7) =       0.000464541469

      target function =                  N/A
              le_mean =     -16.906485472219
             les_mean =     286.160712777777
             stat err =       0.000452480839
             autocorr =       1.280401472359
              std dev =       0.565512368602
             le_variance =       0.319804239041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319666978897
                                         uncertainty =       0.002447496397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319666978897
                                         uncertainty =       0.002447496397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399881192
  error estimate for blocks of size 2^( 2) =       0.000412946712
  error estimate for blocks of size 2^( 3) =       0.000426387156
  error estimate for blocks of size 2^( 4) =       0.000438707295
  error estimate for blocks of size 2^( 5) =       0.000449156435
  error estimate for blocks of size 2^( 6) =       0.000457525376
  error estimate for blocks of size 2^( 7) =       0.000464545084

      target function =                  N/A
              le_mean =     -16.906485730828
             les_mean =     286.160764373036
             stat err =       0.000452483548
             autocorr =       1.280393999907
              std dev =       0.565517404518
             le_variance =       0.319809934813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906485771818        initial  <--
     5.8208e+00     5.8208e+01             1.0360e-04       -16.906485242964
     2.3283e+01     2.3283e+02             2.6303e-05       -16.906485472219
     9.3132e+01     9.3132e+02             6.6015e-06       -16.906485730828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.4300
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_0001                 7.012134e-01 3 1  ON 0
ci_0002                 7.004446e-01 3 1  ON 1
ci_0003                -2.803360e-02 3 1  ON 2
ci_0004                -2.837009e-02 3 1  ON 3
ci_0005                -3.382360e-02 3 1  ON 4
ci_0006                -3.432868e-02 3 1  ON 5
ci_0007                -2.244051e-02 3 1  ON 6
ci_0008                -2.248760e-02 3 1  ON 7
ci_0009                -1.780779e-02 3 1  ON 8
ci_0010                -1.796991e-02 3 1  ON 9
ci_0011                -1.253117e-02 3 1  ON 10
ci_0012                -1.264258e-02 3 1  ON 11
ci_0013                 1.334496e-02 3 1  ON 12
ci_0014                 1.352078e-02 3 1  ON 13
ci_0015                 1.367188e-02 3 1  ON 14
ci_0016                 1.314390e-02 3 1  ON 15
ci_0017                 1.172470e-02 3 1  ON 16
ci_0018                 1.180760e-02 3 1  ON 17
ci_0019                 1.191167e-02 3 1  ON 18
ci_0020                 1.191844e-02 3 1  ON 19
ci_0021                 1.907644e-03 3 1  ON 20
ci_0022                 3.171267e-03 3 1  ON 21
ci_0023                -1.190997e-02 3 1  ON 22
ci_0024                -1.119522e-02 3 1  ON 23
ci_0025                -1.138604e-02 3 1  ON 24
ci_0026                -1.119632e-02 3 1  ON 25
ci_0027                -1.122323e-02 3 1  ON 26
ci_0028                -1.113305e-02 3 1  ON 27
ci_0029                -1.076156e-02 3 1  ON 28
ci_0030                -1.012657e-02 3 1  ON 29
ci_0031                 1.936156e-02 3 1  ON 30
ci_0032                 1.969144e-02 3 1  ON 31
ci_0033                 9.486598e-03 3 1  ON 32
ci_0034                 9.887211e-03 3 1  ON 33
ci_0035                 7.422482e-03 3 1  ON 34
ci_0036                 6.813595e-03 3 1  ON 35
ci_0037                -1.082941e-02 3 1  ON 36
ci_0038                -1.075863e-02 3 1  ON 37
ci_0039                -2.756615e-03 3 1  ON 38
ci_0040                -3.067799e-03 3 1  ON 39
ci_0041                 7.361890e-03 3 1  ON 40
ci_0042                 7.432255e-03 3 1  ON 41
ci_0043                -1.496089e-02 3 1  ON 42
ci_0044                -1.566393e-02 3 1  ON 43
ci_0045                 8.049087e-03 3 1  ON 44
ci_0046                 7.452796e-03 3 1  ON 45
ci_0047                -2.217475e-03 3 1  ON 46
ci_0048                -2.310940e-03 3 1  ON 47
ci_0049                -5.418688e-03 3 1  ON 48
ci_0050                -5.444639e-03 3 1  ON 49
ci_0051                -3.551347e-03 3 1  ON 50
ci_0052                -3.057852e-03 3 1  ON 51
ci_0053                -5.134216e-03 3 1  ON 52
ci_0054                -5.021707e-03 3 1  ON 53
ci_0055                 5.883768e-03 3 1  ON 54
ci_0056                 6.283480e-03 3 1  ON 55
ci_0057                 4.616895e-03 3 1  ON 56
ci_0058                 5.207894e-03 3 1  ON 57
ci_0059                -5.200232e-03 3 1  ON 58
ci_0060                -4.945068e-03 3 1  ON 59
ci_0061                -3.783284e-03 3 1  ON 60
ci_0062                -3.105100e-03 3 1  ON 61
ci_0063                -8.688226e-03 3 1  ON 62
ci_0064                -9.047167e-03 3 1  ON 63
ci_0065                -5.681338e-03 3 1  ON 64
ci_0066                -4.887499e-03 3 1  ON 65
ci_0067                -5.445765e-03 3 1  ON 66
ci_0068                -5.444228e-03 3 1  ON 67
ci_0069                 5.013106e-03 3 1  ON 68
ci_0070                 4.681201e-03 3 1  ON 69
ci_0071                 2.340738e-03 3 1  ON 70
ci_0072                 1.761561e-03 3 1  ON 71
ci_0073                 4.477551e-03 3 1  ON 72
ci_0074                 4.195283e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1529e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9059
    reference variance = 0.170045
====================================================
  Execution time = 1.4709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3704e-01
  Total weights = 1.951939126e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322446431609
                                         uncertainty =       0.002136353036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322446431609
                                         uncertainty =       0.002136353036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401495620
  error estimate for blocks of size 2^( 2) =       0.000414482407
  error estimate for blocks of size 2^( 3) =       0.000427882912
  error estimate for blocks of size 2^( 4) =       0.000439683034
  error estimate for blocks of size 2^( 5) =       0.000449849149
  error estimate for blocks of size 2^( 6) =       0.000457432785
  error estimate for blocks of size 2^( 7) =       0.000461516788

      target function =                  N/A
              le_mean =     -16.905057084415
             les_mean =     286.117994331325
             stat err =       0.000452120439
             autocorr =       1.268080012711
              std dev =       0.567800550978
             le_variance =       0.322397465691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690505708442e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905057084412       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905057176860       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905057181629       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905057182645       residual = 2.23e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 7.172633e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905057084412       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905057107588       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905057108771       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905057109024       residual = 2.27e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 1.796163e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905057084412       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905057090210       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905057090505       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905057090568       residual = 2.28e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 9.3132e+02 is 4.492288e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180077 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7325e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.012136e-01 3 1  ON 0
ci_0002                 7.004443e-01 3 1  ON 1
ci_0003                -2.803423e-02 3 1  ON 2
ci_0004                -2.836997e-02 3 1  ON 3
ci_0005                -3.382301e-02 3 1  ON 4
ci_0006                -3.432885e-02 3 1  ON 5
ci_0007                -2.244020e-02 3 1  ON 6
ci_0008                -2.248724e-02 3 1  ON 7
ci_0009                -1.780763e-02 3 1  ON 8
ci_0010                -1.797088e-02 3 1  ON 9
ci_0011                -1.253213e-02 3 1  ON 10
ci_0012                -1.264306e-02 3 1  ON 11
ci_0013                 1.334547e-02 3 1  ON 12
ci_0014                 1.351972e-02 3 1  ON 13
ci_0015                 1.367286e-02 3 1  ON 14
ci_0016                 1.314472e-02 3 1  ON 15
ci_0017                 1.172462e-02 3 1  ON 16
ci_0018                 1.180737e-02 3 1  ON 17
ci_0019                 1.191160e-02 3 1  ON 18
ci_0020                 1.191837e-02 3 1  ON 19
ci_0021                 1.907451e-03 3 1  ON 20
ci_0022                 3.170438e-03 3 1  ON 21
ci_0023                -1.190942e-02 3 1  ON 22
ci_0024                -1.119654e-02 3 1  ON 23
ci_0025                -1.138610e-02 3 1  ON 24
ci_0026                -1.119627e-02 3 1  ON 25
ci_0027                -1.122331e-02 3 1  ON 26
ci_0028                -1.113363e-02 3 1  ON 27
ci_0029                -1.076183e-02 3 1  ON 28
ci_0030                -1.012634e-02 3 1  ON 29
ci_0031                 1.936335e-02 3 1  ON 30
ci_0032                 1.969160e-02 3 1  ON 31
ci_0033                 9.486698e-03 3 1  ON 32
ci_0034                 9.888109e-03 3 1  ON 33
ci_0035                 7.421897e-03 3 1  ON 34
ci_0036                 6.813273e-03 3 1  ON 35
ci_0037                -1.082904e-02 3 1  ON 36
ci_0038                -1.075956e-02 3 1  ON 37
ci_0039                -2.757047e-03 3 1  ON 38
ci_0040                -3.067326e-03 3 1  ON 39
ci_0041                 7.362262e-03 3 1  ON 40
ci_0042                 7.432570e-03 3 1  ON 41
ci_0043                -1.496066e-02 3 1  ON 42
ci_0044                -1.566369e-02 3 1  ON 43
ci_0045                 8.048396e-03 3 1  ON 44
ci_0046                 7.452599e-03 3 1  ON 45
ci_0047                -2.217286e-03 3 1  ON 46
ci_0048                -2.310264e-03 3 1  ON 47
ci_0049                -5.418588e-03 3 1  ON 48
ci_0050                -5.445114e-03 3 1  ON 49
ci_0051                -3.551900e-03 3 1  ON 50
ci_0052                -3.058825e-03 3 1  ON 51
ci_0053                -5.134003e-03 3 1  ON 52
ci_0054                -5.021448e-03 3 1  ON 53
ci_0055                 5.884529e-03 3 1  ON 54
ci_0056                 6.283381e-03 3 1  ON 55
ci_0057                 4.615882e-03 3 1  ON 56
ci_0058                 5.208125e-03 3 1  ON 57
ci_0059                -5.199999e-03 3 1  ON 58
ci_0060                -4.945210e-03 3 1  ON 59
ci_0061                -3.783819e-03 3 1  ON 60
ci_0062                -3.105174e-03 3 1  ON 61
ci_0063                -8.687541e-03 3 1  ON 62
ci_0064                -9.048039e-03 3 1  ON 63
ci_0065                -5.681598e-03 3 1  ON 64
ci_0066                -4.888406e-03 3 1  ON 65
ci_0067                -5.444806e-03 3 1  ON 66
ci_0068                -5.444279e-03 3 1  ON 67
ci_0069                 5.013535e-03 3 1  ON 68
ci_0070                 4.681079e-03 3 1  ON 69
ci_0071                 2.340221e-03 3 1  ON 70
ci_0072                 1.762146e-03 3 1  ON 71
ci_0073                 4.476434e-03 3 1  ON 72
ci_0074                 4.195247e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8914
    reference variance = 0.21294
====================================================
  Execution time = 1.4560e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3183e-01
  Total weights = 1.9520e+06
  Execution time = 1.9162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259285867
                                         uncertainty =       0.002196212567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259285867
                                         uncertainty =       0.002196212567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400220457
  error estimate for blocks of size 2^( 2) =       0.000412540019
  error estimate for blocks of size 2^( 3) =       0.000424651740
  error estimate for blocks of size 2^( 4) =       0.000435555117
  error estimate for blocks of size 2^( 5) =       0.000445101033
  error estimate for blocks of size 2^( 6) =       0.000450735901
  error estimate for blocks of size 2^( 7) =       0.000454647958

      target function =                  N/A
              le_mean =     -16.905966295275
             les_mean =     286.143515246386
             stat err =       0.000446510002
             autocorr =       1.244697496891
              std dev =       0.565997198848
             le_variance =       0.320352829104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259793883
                                         uncertainty =       0.002196206993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259793883
                                         uncertainty =       0.002196206993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400220762
  error estimate for blocks of size 2^( 2) =       0.000412540197
  error estimate for blocks of size 2^( 3) =       0.000424651677
  error estimate for blocks of size 2^( 4) =       0.000435554683
  error estimate for blocks of size 2^( 5) =       0.000445100430
  error estimate for blocks of size 2^( 6) =       0.000450735426
  error estimate for blocks of size 2^( 7) =       0.000454647518

      target function =                  N/A
              le_mean =     -16.905966365734
             les_mean =     286.143570184578
             stat err =       0.000446509514
             autocorr =       1.244692878173
              std dev =       0.565997630114
             le_variance =       0.320353317295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259538616
                                         uncertainty =       0.002196209664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259538616
                                         uncertainty =       0.002196209664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400220609
  error estimate for blocks of size 2^( 2) =       0.000412540107
  error estimate for blocks of size 2^( 3) =       0.000424651707
  error estimate for blocks of size 2^( 4) =       0.000435554898
  error estimate for blocks of size 2^( 5) =       0.000445100729
  error estimate for blocks of size 2^( 6) =       0.000450735661
  error estimate for blocks of size 2^( 7) =       0.000454647736

      target function =                  N/A
              le_mean =     -16.905966330327
             les_mean =     286.143543725270
             stat err =       0.000446509756
             autocorr =       1.244695179847
              std dev =       0.565997413345
             le_variance =       0.320353071913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259317284
                                         uncertainty =       0.002196212196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320259317284
                                         uncertainty =       0.002196212196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400220476
  error estimate for blocks of size 2^( 2) =       0.000412540030
  error estimate for blocks of size 2^( 3) =       0.000424651736
  error estimate for blocks of size 2^( 4) =       0.000435555090
  error estimate for blocks of size 2^( 5) =       0.000445100995
  error estimate for blocks of size 2^( 6) =       0.000450735871
  error estimate for blocks of size 2^( 7) =       0.000454647930

      target function =                  N/A
              le_mean =     -16.905966299611
             les_mean =     286.143518226593
             stat err =       0.000446509971
             autocorr =       1.244697207102
              std dev =       0.565997225504
             le_variance =       0.320352859278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905966295275        initial
     5.8208e+01     5.8208e+02             7.1726e-06       -16.905966365734  <--
     2.3283e+02     2.3283e+03             1.7962e-06       -16.905966330327
     9.3132e+02     9.3132e+03             4.4923e-07       -16.905966299611

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.4253e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8561
    reference variance = 0.726232
====================================================
  Execution time = 1.4482e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3147e-01
  Total weights = 1.952145122e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320376391313
                                         uncertainty =       0.001889972875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320376391313
                                         uncertainty =       0.001889972875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400190114
  error estimate for blocks of size 2^( 2) =       0.000413039626
  error estimate for blocks of size 2^( 3) =       0.000426130609
  error estimate for blocks of size 2^( 4) =       0.000438092494
  error estimate for blocks of size 2^( 5) =       0.000447729305
  error estimate for blocks of size 2^( 6) =       0.000454471537
  error estimate for blocks of size 2^( 7) =       0.000458598792

      target function =                  N/A
              le_mean =     -16.906252836272
             les_mean =     286.152850384714
             stat err =       0.000449723032
             autocorr =       1.262866806546
              std dev =       0.565954286426
             le_variance =       0.320304254324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625283627e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906252836284       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906252805456       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906252819110       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906252821236       residual = 4.97e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+01 is 2.844600e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906252836284       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906252828498       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906252832145       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906252832684       residual = 5.32e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+01 is 7.188482e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906252836284       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906252834332       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906252835259       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906252835394       residual = 5.41e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+02 is 1.801997e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.181296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7110e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.012154e-01 3 1  ON 0
ci_0002                 7.004423e-01 3 1  ON 1
ci_0003                -2.803577e-02 3 1  ON 2
ci_0004                -2.836720e-02 3 1  ON 3
ci_0005                -3.381885e-02 3 1  ON 4
ci_0006                -3.432591e-02 3 1  ON 5
ci_0007                -2.243857e-02 3 1  ON 6
ci_0008                -2.248685e-02 3 1  ON 7
ci_0009                -1.780658e-02 3 1  ON 8
ci_0010                -1.797264e-02 3 1  ON 9
ci_0011                -1.253889e-02 3 1  ON 10
ci_0012                -1.264411e-02 3 1  ON 11
ci_0013                 1.334648e-02 3 1  ON 12
ci_0014                 1.351540e-02 3 1  ON 13
ci_0015                 1.367853e-02 3 1  ON 14
ci_0016                 1.314541e-02 3 1  ON 15
ci_0017                 1.172699e-02 3 1  ON 16
ci_0018                 1.180946e-02 3 1  ON 17
ci_0019                 1.191085e-02 3 1  ON 18
ci_0020                 1.191737e-02 3 1  ON 19
ci_0021                 1.907271e-03 3 1  ON 20
ci_0022                 3.166967e-03 3 1  ON 21
ci_0023                -1.190778e-02 3 1  ON 22
ci_0024                -1.120377e-02 3 1  ON 23
ci_0025                -1.138492e-02 3 1  ON 24
ci_0026                -1.119183e-02 3 1  ON 25
ci_0027                -1.122735e-02 3 1  ON 26
ci_0028                -1.113430e-02 3 1  ON 27
ci_0029                -1.076528e-02 3 1  ON 28
ci_0030                -1.012482e-02 3 1  ON 29
ci_0031                 1.936974e-02 3 1  ON 30
ci_0032                 1.968922e-02 3 1  ON 31
ci_0033                 9.484935e-03 3 1  ON 32
ci_0034                 9.887017e-03 3 1  ON 33
ci_0035                 7.416564e-03 3 1  ON 34
ci_0036                 6.809317e-03 3 1  ON 35
ci_0037                -1.082859e-02 3 1  ON 36
ci_0038                -1.076367e-02 3 1  ON 37
ci_0039                -2.758516e-03 3 1  ON 38
ci_0040                -3.066340e-03 3 1  ON 39
ci_0041                 7.364186e-03 3 1  ON 40
ci_0042                 7.431186e-03 3 1  ON 41
ci_0043                -1.496223e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.044051e-03 3 1  ON 44
ci_0046                 7.452801e-03 3 1  ON 45
ci_0047                -2.214393e-03 3 1  ON 46
ci_0048                -2.308107e-03 3 1  ON 47
ci_0049                -5.425477e-03 3 1  ON 48
ci_0050                -5.449119e-03 3 1  ON 49
ci_0051                -3.554913e-03 3 1  ON 50
ci_0052                -3.065556e-03 3 1  ON 51
ci_0053                -5.136304e-03 3 1  ON 52
ci_0054                -5.021314e-03 3 1  ON 53
ci_0055                 5.891784e-03 3 1  ON 54
ci_0056                 6.282280e-03 3 1  ON 55
ci_0057                 4.616621e-03 3 1  ON 56
ci_0058                 5.207131e-03 3 1  ON 57
ci_0059                -5.201417e-03 3 1  ON 58
ci_0060                -4.946272e-03 3 1  ON 59
ci_0061                -3.786370e-03 3 1  ON 60
ci_0062                -3.103553e-03 3 1  ON 61
ci_0063                -8.685431e-03 3 1  ON 62
ci_0064                -9.052064e-03 3 1  ON 63
ci_0065                -5.681805e-03 3 1  ON 64
ci_0066                -4.894174e-03 3 1  ON 65
ci_0067                -5.439243e-03 3 1  ON 66
ci_0068                -5.444286e-03 3 1  ON 67
ci_0069                 5.017107e-03 3 1  ON 68
ci_0070                 4.681981e-03 3 1  ON 69
ci_0071                 2.338453e-03 3 1  ON 70
ci_0072                 1.762934e-03 3 1  ON 71
ci_0073                 4.474237e-03 3 1  ON 72
ci_0074                 4.196172e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8372
    reference variance = 0.247676
====================================================
  Execution time = 1.6209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3679e-01
  Total weights = 1.9516e+06
  Execution time = 2.0350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829531592
                                         uncertainty =       0.003625129239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829531592
                                         uncertainty =       0.003625129239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401726405
  error estimate for blocks of size 2^( 2) =       0.000414612948
  error estimate for blocks of size 2^( 3) =       0.000428051891
  error estimate for blocks of size 2^( 4) =       0.000439777354
  error estimate for blocks of size 2^( 5) =       0.000450490747
  error estimate for blocks of size 2^( 6) =       0.000456791780
  error estimate for blocks of size 2^( 7) =       0.000460949363

      target function =                  N/A
              le_mean =     -16.905741992598
             les_mean =     286.140905300841
             stat err =       0.000452002311
             autocorr =       1.265961660108
              std dev =       0.568126930838
             le_variance =       0.322768209543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829381618
                                         uncertainty =       0.003622267686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829381618
                                         uncertainty =       0.003622267686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401726322
  error estimate for blocks of size 2^( 2) =       0.000414612051
  error estimate for blocks of size 2^( 3) =       0.000428050327
  error estimate for blocks of size 2^( 4) =       0.000439775168
  error estimate for blocks of size 2^( 5) =       0.000450488402
  error estimate for blocks of size 2^( 6) =       0.000456788494
  error estimate for blocks of size 2^( 7) =       0.000460945744

      target function =                  N/A
              le_mean =     -16.905741468431
             les_mean =     286.140897646460
             stat err =       0.000451999452
             autocorr =       1.265946170933
              std dev =       0.568126812855
             le_variance =       0.322768075485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829432498
                                         uncertainty =       0.003623682644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829432498
                                         uncertainty =       0.003623682644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401726349
  error estimate for blocks of size 2^( 2) =       0.000414612479
  error estimate for blocks of size 2^( 3) =       0.000428051084
  error estimate for blocks of size 2^( 4) =       0.000439776233
  error estimate for blocks of size 2^( 5) =       0.000450489548
  error estimate for blocks of size 2^( 6) =       0.000456790104
  error estimate for blocks of size 2^( 7) =       0.000460947519

      target function =                  N/A
              le_mean =     -16.905741725265
             les_mean =     286.140900346860
             stat err =       0.000452000851
             autocorr =       1.265953838298
              std dev =       0.568126850767
             le_variance =       0.322768118563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829515288
                                         uncertainty =       0.003624947852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322829515288
                                         uncertainty =       0.003624947852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401726396
  error estimate for blocks of size 2^( 2) =       0.000414612887
  error estimate for blocks of size 2^( 3) =       0.000428051787
  error estimate for blocks of size 2^( 4) =       0.000439777211
  error estimate for blocks of size 2^( 5) =       0.000450490594
  error estimate for blocks of size 2^( 6) =       0.000456791567
  error estimate for blocks of size 2^( 7) =       0.000460949130

      target function =                  N/A
              le_mean =     -16.905741958829
             les_mean =     286.140904579853
             stat err =       0.000452002126
             autocorr =       1.265960682279
              std dev =       0.568126917387
             le_variance =       0.322768194259


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905741992598        initial  <--
     1.4552e+01     1.4552e+02             2.8446e-05       -16.905741468431
     5.8208e+01     5.8208e+02             7.1885e-06       -16.905741725265
     2.3283e+02     2.3283e+03             1.8020e-06       -16.905741958829

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.0612
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8893
    reference variance = 0.273493
====================================================
  Execution time = 1.4616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3630e-01
  Total weights = 1.951805784e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322520602974
                                         uncertainty =       0.002260149299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322520602974
                                         uncertainty =       0.002260149299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401586188
  error estimate for blocks of size 2^( 2) =       0.000414246189
  error estimate for blocks of size 2^( 3) =       0.000427116986
  error estimate for blocks of size 2^( 4) =       0.000438792618
  error estimate for blocks of size 2^( 5) =       0.000448379498
  error estimate for blocks of size 2^( 6) =       0.000454227341
  error estimate for blocks of size 2^( 7) =       0.000459149140

      target function =                  N/A
              le_mean =     -16.906002197590
             les_mean =     286.149212331483
             stat err =       0.000450137149
             autocorr =       1.256412294631
              std dev =       0.567928633391
             le_variance =       0.322542932626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600219759e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002197626       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002231188       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002231649       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002231821       residual = 6.00e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+02 is 2.519396e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002197626       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002206026       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002206142       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002206184       residual = 6.06e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+02 is 6.304823e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002197626       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002199727       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002199756       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002199767       residual = 6.07e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+03 is 1.576602e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182567 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7226e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004433e-01 3 1  ON 1
ci_0003                -2.803615e-02 3 1  ON 2
ci_0004                -2.836982e-02 3 1  ON 3
ci_0005                -3.382133e-02 3 1  ON 4
ci_0006                -3.432941e-02 3 1  ON 5
ci_0007                -2.243932e-02 3 1  ON 6
ci_0008                -2.248606e-02 3 1  ON 7
ci_0009                -1.780713e-02 3 1  ON 8
ci_0010                -1.797379e-02 3 1  ON 9
ci_0011                -1.253526e-02 3 1  ON 10
ci_0012                -1.264456e-02 3 1  ON 11
ci_0013                 1.334706e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367596e-02 3 1  ON 14
ci_0016                 1.314756e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180692e-02 3 1  ON 17
ci_0019                 1.191154e-02 3 1  ON 18
ci_0020                 1.191817e-02 3 1  ON 19
ci_0021                 1.907041e-03 3 1  ON 20
ci_0022                 3.167766e-03 3 1  ON 21
ci_0023                -1.190738e-02 3 1  ON 22
ci_0024                -1.120072e-02 3 1  ON 23
ci_0025                -1.138597e-02 3 1  ON 24
ci_0026                -1.119590e-02 3 1  ON 25
ci_0027                -1.122359e-02 3 1  ON 26
ci_0028                -1.113561e-02 3 1  ON 27
ci_0029                -1.076202e-02 3 1  ON 28
ci_0030                -1.012618e-02 3 1  ON 29
ci_0031                 1.936895e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.487264e-03 3 1  ON 32
ci_0034                 9.890570e-03 3 1  ON 33
ci_0035                 7.420092e-03 3 1  ON 34
ci_0036                 6.812285e-03 3 1  ON 35
ci_0037                -1.082810e-02 3 1  ON 36
ci_0038                -1.076199e-02 3 1  ON 37
ci_0039                -2.758594e-03 3 1  ON 38
ci_0040                -3.065710e-03 3 1  ON 39
ci_0041                 7.362974e-03 3 1  ON 40
ci_0042                 7.433333e-03 3 1  ON 41
ci_0043                -1.496019e-02 3 1  ON 42
ci_0044                -1.566273e-02 3 1  ON 43
ci_0045                 8.046180e-03 3 1  ON 44
ci_0046                 7.451658e-03 3 1  ON 45
ci_0047                -2.216528e-03 3 1  ON 46
ci_0048                -2.308151e-03 3 1  ON 47
ci_0049                -5.418643e-03 3 1  ON 48
ci_0050                -5.446504e-03 3 1  ON 49
ci_0051                -3.553442e-03 3 1  ON 50
ci_0052                -3.062088e-03 3 1  ON 51
ci_0053                -5.133002e-03 3 1  ON 52
ci_0054                -5.020706e-03 3 1  ON 53
ci_0055                 5.886925e-03 3 1  ON 54
ci_0056                 6.283452e-03 3 1  ON 55
ci_0057                 4.612968e-03 3 1  ON 56
ci_0058                 5.208957e-03 3 1  ON 57
ci_0059                -5.199104e-03 3 1  ON 58
ci_0060                -4.945433e-03 3 1  ON 59
ci_0061                -3.784809e-03 3 1  ON 60
ci_0062                -3.106028e-03 3 1  ON 61
ci_0063                -8.685644e-03 3 1  ON 62
ci_0064                -9.050097e-03 3 1  ON 63
ci_0065                -5.682421e-03 3 1  ON 64
ci_0066                -4.891133e-03 3 1  ON 65
ci_0067                -5.441725e-03 3 1  ON 66
ci_0068                -5.444380e-03 3 1  ON 67
ci_0069                 5.014794e-03 3 1  ON 68
ci_0070                 4.680821e-03 3 1  ON 69
ci_0071                 2.338842e-03 3 1  ON 70
ci_0072                 1.764192e-03 3 1  ON 71
ci_0073                 4.473211e-03 3 1  ON 72
ci_0074                 4.195121e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.969
    reference variance = 1.58834
====================================================
  Execution time = 1.4109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3238e-01
  Total weights = 1.9521e+06
  Execution time = 1.9297e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888872218
                                         uncertainty =       0.002000566920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888872218
                                         uncertainty =       0.002000566920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400570876
  error estimate for blocks of size 2^( 2) =       0.000413265319
  error estimate for blocks of size 2^( 3) =       0.000426085003
  error estimate for blocks of size 2^( 4) =       0.000437392160
  error estimate for blocks of size 2^( 5) =       0.000446932138
  error estimate for blocks of size 2^( 6) =       0.000451483230
  error estimate for blocks of size 2^( 7) =       0.000458908708

      target function =                  N/A
              le_mean =     -16.907127756399
             les_mean =     286.183349635044
             stat err =       0.000448679059
             autocorr =       1.254621890819
              std dev =       0.566492764954
             le_variance =       0.320914052745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888325744
                                         uncertainty =       0.002000523695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888325744
                                         uncertainty =       0.002000523695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400570536
  error estimate for blocks of size 2^( 2) =       0.000413264977
  error estimate for blocks of size 2^( 3) =       0.000426084667
  error estimate for blocks of size 2^( 4) =       0.000437391839
  error estimate for blocks of size 2^( 5) =       0.000446931793
  error estimate for blocks of size 2^( 6) =       0.000451483002
  error estimate for blocks of size 2^( 7) =       0.000458908409

      target function =                  N/A
              le_mean =     -16.907127737523
             les_mean =     286.183348293565
             stat err =       0.000448678761
             autocorr =       1.254622354459
              std dev =       0.566492284345
             le_variance =       0.320913508222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888598349
                                         uncertainty =       0.002000545271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888598349
                                         uncertainty =       0.002000545271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400570705
  error estimate for blocks of size 2^( 2) =       0.000413265148
  error estimate for blocks of size 2^( 3) =       0.000426084835
  error estimate for blocks of size 2^( 4) =       0.000437391999
  error estimate for blocks of size 2^( 5) =       0.000446931965
  error estimate for blocks of size 2^( 6) =       0.000451483116
  error estimate for blocks of size 2^( 7) =       0.000458908558

      target function =                  N/A
              le_mean =     -16.907127746910
             les_mean =     286.183348954812
             stat err =       0.000448678910
             autocorr =       1.254622123035
              std dev =       0.566492524093
             le_variance =       0.320913779853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888837943
                                         uncertainty =       0.002000564212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320888837943
                                         uncertainty =       0.002000564212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400570854
  error estimate for blocks of size 2^( 2) =       0.000413265298
  error estimate for blocks of size 2^( 3) =       0.000426084982
  error estimate for blocks of size 2^( 4) =       0.000437392139
  error estimate for blocks of size 2^( 5) =       0.000446932117
  error estimate for blocks of size 2^( 6) =       0.000451483215
  error estimate for blocks of size 2^( 7) =       0.000458908689

      target function =                  N/A
              le_mean =     -16.907127755208
             les_mean =     286.183349549013
             stat err =       0.000448679040
             autocorr =       1.254621919867
              std dev =       0.566492734809
             le_variance =       0.320914018591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907127756399        initial  <--
     1.4552e+02     1.4552e+03             2.5194e-06       -16.907127737523
     5.8208e+02     5.8208e+03             6.3048e-07       -16.907127746910
     2.3283e+03     2.3283e+04             1.5766e-07       -16.907127755208

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9196
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1152e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.909
    reference variance = 0.439041
====================================================
  Execution time = 1.4445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3615e-01
  Total weights = 1.951767441e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322941235158
                                         uncertainty =       0.002600780014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322941235158
                                         uncertainty =       0.002600780014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401873981
  error estimate for blocks of size 2^( 2) =       0.000414584925
  error estimate for blocks of size 2^( 3) =       0.000427169413
  error estimate for blocks of size 2^( 4) =       0.000439439148
  error estimate for blocks of size 2^( 5) =       0.000448861932
  error estimate for blocks of size 2^( 6) =       0.000456849271
  error estimate for blocks of size 2^( 7) =       0.000461006873

      target function =                  N/A
              le_mean =     -16.906282027399
             les_mean =     286.158524633207
             stat err =       0.000451539306
             autocorr =       1.262441736001
              std dev =       0.568335634345
             le_variance =       0.323005393266


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628202740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282027409       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282027161       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906282027369       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906282027361       residual = 2.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+03 is 3.121616e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282027409       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282027347       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906282027399       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906282027397       residual = 2.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+03 is 7.804904e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906282027409       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906282027393       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906282027406       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906282027417       residual = 2.82e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+04 is 1.951280e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183836 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7064e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382126e-02 3 1  ON 4
ci_0006                -3.432939e-02 3 1  ON 5
ci_0007                -2.243923e-02 3 1  ON 6
ci_0008                -2.248615e-02 3 1  ON 7
ci_0009                -1.780712e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253500e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334701e-02 3 1  ON 12
ci_0014                 1.351656e-02 3 1  ON 13
ci_0015                 1.367577e-02 3 1  ON 14
ci_0016                 1.314722e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180664e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191819e-02 3 1  ON 19
ci_0021                 1.906874e-03 3 1  ON 20
ci_0022                 3.167946e-03 3 1  ON 21
ci_0023                -1.190775e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138628e-02 3 1  ON 24
ci_0026                -1.119606e-02 3 1  ON 25
ci_0027                -1.122355e-02 3 1  ON 26
ci_0028                -1.113534e-02 3 1  ON 27
ci_0029                -1.076255e-02 3 1  ON 28
ci_0030                -1.012570e-02 3 1  ON 29
ci_0031                 1.936872e-02 3 1  ON 30
ci_0032                 1.969209e-02 3 1  ON 31
ci_0033                 9.487039e-03 3 1  ON 32
ci_0034                 9.890802e-03 3 1  ON 33
ci_0035                 7.420138e-03 3 1  ON 34
ci_0036                 6.812290e-03 3 1  ON 35
ci_0037                -1.082788e-02 3 1  ON 36
ci_0038                -1.076231e-02 3 1  ON 37
ci_0039                -2.758338e-03 3 1  ON 38
ci_0040                -3.065912e-03 3 1  ON 39
ci_0041                 7.363397e-03 3 1  ON 40
ci_0042                 7.433529e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566299e-02 3 1  ON 43
ci_0045                 8.046298e-03 3 1  ON 44
ci_0046                 7.452005e-03 3 1  ON 45
ci_0047                -2.216707e-03 3 1  ON 46
ci_0048                -2.308254e-03 3 1  ON 47
ci_0049                -5.418264e-03 3 1  ON 48
ci_0050                -5.446551e-03 3 1  ON 49
ci_0051                -3.553535e-03 3 1  ON 50
ci_0052                -3.061762e-03 3 1  ON 51
ci_0053                -5.133389e-03 3 1  ON 52
ci_0054                -5.020683e-03 3 1  ON 53
ci_0055                 5.886801e-03 3 1  ON 54
ci_0056                 6.283060e-03 3 1  ON 55
ci_0057                 4.612842e-03 3 1  ON 56
ci_0058                 5.208809e-03 3 1  ON 57
ci_0059                -5.199277e-03 3 1  ON 58
ci_0060                -4.945640e-03 3 1  ON 59
ci_0061                -3.785415e-03 3 1  ON 60
ci_0062                -3.105409e-03 3 1  ON 61
ci_0063                -8.685426e-03 3 1  ON 62
ci_0064                -9.050643e-03 3 1  ON 63
ci_0065                -5.682396e-03 3 1  ON 64
ci_0066                -4.891133e-03 3 1  ON 65
ci_0067                -5.441952e-03 3 1  ON 66
ci_0068                -5.444421e-03 3 1  ON 67
ci_0069                 5.014796e-03 3 1  ON 68
ci_0070                 4.680692e-03 3 1  ON 69
ci_0071                 2.338704e-03 3 1  ON 70
ci_0072                 1.763914e-03 3 1  ON 71
ci_0073                 4.473098e-03 3 1  ON 72
ci_0074                 4.195156e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9344
    reference variance = 0.292245
====================================================
  Execution time = 1.4272e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2959e-01
  Total weights = 1.9515e+06
  Execution time = 1.9204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906842719
                                         uncertainty =       0.002181816172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906842719
                                         uncertainty =       0.002181816172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398718256
  error estimate for blocks of size 2^( 2) =       0.000411733369
  error estimate for blocks of size 2^( 3) =       0.000424988369
  error estimate for blocks of size 2^( 4) =       0.000437592871
  error estimate for blocks of size 2^( 5) =       0.000448701585
  error estimate for blocks of size 2^( 6) =       0.000457003371
  error estimate for blocks of size 2^( 7) =       0.000460850162

      target function =                  N/A
              le_mean =     -16.906380238736
             les_mean =     286.155280275420
             stat err =       0.000451036997
             autocorr =       1.279652628114
              std dev =       0.563872764979
             le_variance =       0.317952495085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906728814
                                         uncertainty =       0.002181803966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906728814
                                         uncertainty =       0.002181803966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398718184
  error estimate for blocks of size 2^( 2) =       0.000411733304
  error estimate for blocks of size 2^( 3) =       0.000424988304
  error estimate for blocks of size 2^( 4) =       0.000437592814
  error estimate for blocks of size 2^( 5) =       0.000448701537
  error estimate for blocks of size 2^( 6) =       0.000457003325
  error estimate for blocks of size 2^( 7) =       0.000460850115

      target function =                  N/A
              le_mean =     -16.906380237091
             les_mean =     286.155280584388
             stat err =       0.000451036948
             autocorr =       1.279652808415
              std dev =       0.563872663512
             le_variance =       0.317952380656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906785757
                                         uncertainty =       0.002181810068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906785757
                                         uncertainty =       0.002181810068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398718220
  error estimate for blocks of size 2^( 2) =       0.000411733336
  error estimate for blocks of size 2^( 3) =       0.000424988336
  error estimate for blocks of size 2^( 4) =       0.000437592843
  error estimate for blocks of size 2^( 5) =       0.000448701561
  error estimate for blocks of size 2^( 6) =       0.000457003348
  error estimate for blocks of size 2^( 7) =       0.000460850139

      target function =                  N/A
              le_mean =     -16.906380237913
             les_mean =     286.155280426448
             stat err =       0.000451036973
             autocorr =       1.279652718286
              std dev =       0.563872714237
             le_variance =       0.317952437861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906835598
                                         uncertainty =       0.002181815409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317906835598
                                         uncertainty =       0.002181815409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398718251
  error estimate for blocks of size 2^( 2) =       0.000411733365
  error estimate for blocks of size 2^( 3) =       0.000424988365
  error estimate for blocks of size 2^( 4) =       0.000437592868
  error estimate for blocks of size 2^( 5) =       0.000448701582
  error estimate for blocks of size 2^( 6) =       0.000457003368
  error estimate for blocks of size 2^( 7) =       0.000460850159

      target function =                  N/A
              le_mean =     -16.906380238633
             les_mean =     286.155280293928
             stat err =       0.000451036994
             autocorr =       1.279652639391
              std dev =       0.563872758636
             le_variance =       0.317952487931


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906380238736        initial  <--
     1.4552e+03     1.4552e+04             3.1216e-07       -16.906380237091
     5.8208e+03     5.8208e+04             7.8049e-08       -16.906380237913
     2.3283e+04     2.3283e+05             1.9513e-08       -16.906380238633

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0072
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1078e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9557
    reference variance = 0.327859
====================================================
  Execution time = 1.4409e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3268e-01
  Total weights = 1.951740244e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6149e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322308299444
                                         uncertainty =       0.004847228680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322308299444
                                         uncertainty =       0.004847228680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401355495
  error estimate for blocks of size 2^( 2) =       0.000414294381
  error estimate for blocks of size 2^( 3) =       0.000427640529
  error estimate for blocks of size 2^( 4) =       0.000439271686
  error estimate for blocks of size 2^( 5) =       0.000448871618
  error estimate for blocks of size 2^( 6) =       0.000457161234
  error estimate for blocks of size 2^( 7) =       0.000461576607

      target function =                  N/A
              le_mean =     -16.905848955544
             les_mean =     286.140404196131
             stat err =       0.000451720286
             autocorr =       1.266720392586
              std dev =       0.567602384982
             le_variance =       0.322172467437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584895554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905848955525       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905848955934       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905848955934       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848955933       residual = 1.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+04 is 2.513534e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905848955525       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905848955627       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905848955627       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848955627       residual = 1.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+04 is 6.283927e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905848955525       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905848955551       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905848955551       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905848955550       residual = 1.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+05 is 1.570988e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7030e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243924e-02 3 1  ON 6
ci_0008                -2.248615e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906874e-03 3 1  ON 20
ci_0022                 3.167960e-03 3 1  ON 21
ci_0023                -1.190775e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138629e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122352e-02 3 1  ON 26
ci_0028                -1.113537e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890800e-03 3 1  ON 33
ci_0035                 7.420141e-03 3 1  ON 34
ci_0036                 6.812311e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758337e-03 3 1  ON 38
ci_0040                -3.065912e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046331e-03 3 1  ON 44
ci_0046                 7.452011e-03 3 1  ON 45
ci_0047                -2.216720e-03 3 1  ON 46
ci_0048                -2.308249e-03 3 1  ON 47
ci_0049                -5.418288e-03 3 1  ON 48
ci_0050                -5.446538e-03 3 1  ON 49
ci_0051                -3.553551e-03 3 1  ON 50
ci_0052                -3.061733e-03 3 1  ON 51
ci_0053                -5.133362e-03 3 1  ON 52
ci_0054                -5.020674e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283087e-03 3 1  ON 55
ci_0057                 4.612854e-03 3 1  ON 56
ci_0058                 5.208812e-03 3 1  ON 57
ci_0059                -5.199302e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785418e-03 3 1  ON 60
ci_0062                -3.105398e-03 3 1  ON 61
ci_0063                -8.685501e-03 3 1  ON 62
ci_0064                -9.050639e-03 3 1  ON 63
ci_0065                -5.682374e-03 3 1  ON 64
ci_0066                -4.891118e-03 3 1  ON 65
ci_0067                -5.441941e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014812e-03 3 1  ON 68
ci_0070                 4.680714e-03 3 1  ON 69
ci_0071                 2.338673e-03 3 1  ON 70
ci_0072                 1.763895e-03 3 1  ON 71
ci_0073                 4.473101e-03 3 1  ON 72
ci_0074                 4.195147e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8556
    reference variance = 2.93078
====================================================
  Execution time = 1.4265e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3082e-01
  Total weights = 1.9516e+06
  Execution time = 1.9224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243704
                                         uncertainty =       0.001843134632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243704
                                         uncertainty =       0.001843134632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400090821
  error estimate for blocks of size 2^( 2) =       0.000413404113
  error estimate for blocks of size 2^( 3) =       0.000426719177
  error estimate for blocks of size 2^( 4) =       0.000439109584
  error estimate for blocks of size 2^( 5) =       0.000450289197
  error estimate for blocks of size 2^( 6) =       0.000458494690
  error estimate for blocks of size 2^( 7) =       0.000461978292

      target function =                  N/A
              le_mean =     -16.905052083257
             les_mean =     286.111601194840
             stat err =       0.000452467941
             autocorr =       1.278964385945
              std dev =       0.565813864711
             le_variance =       0.320145329499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243771
                                         uncertainty =       0.001843134773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243771
                                         uncertainty =       0.001843134773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400090821
  error estimate for blocks of size 2^( 2) =       0.000413404113
  error estimate for blocks of size 2^( 3) =       0.000426719176
  error estimate for blocks of size 2^( 4) =       0.000439109582
  error estimate for blocks of size 2^( 5) =       0.000450289195
  error estimate for blocks of size 2^( 6) =       0.000458494689
  error estimate for blocks of size 2^( 7) =       0.000461978289

      target function =                  N/A
              le_mean =     -16.905052082854
             les_mean =     286.111601047110
             stat err =       0.000452467939
             autocorr =       1.278964376212
              std dev =       0.565813864785
             le_variance =       0.320145329583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243738
                                         uncertainty =       0.001843134703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243738
                                         uncertainty =       0.001843134703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400090821
  error estimate for blocks of size 2^( 2) =       0.000413404113
  error estimate for blocks of size 2^( 3) =       0.000426719176
  error estimate for blocks of size 2^( 4) =       0.000439109583
  error estimate for blocks of size 2^( 5) =       0.000450289196
  error estimate for blocks of size 2^( 6) =       0.000458494690
  error estimate for blocks of size 2^( 7) =       0.000461978291

      target function =                  N/A
              le_mean =     -16.905052083055
             les_mean =     286.111601120927
             stat err =       0.000452467940
             autocorr =       1.278964381073
              std dev =       0.565813864748
             le_variance =       0.320145329541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243708
                                         uncertainty =       0.001843134641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320120243708
                                         uncertainty =       0.001843134641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400090821
  error estimate for blocks of size 2^( 2) =       0.000413404113
  error estimate for blocks of size 2^( 3) =       0.000426719177
  error estimate for blocks of size 2^( 4) =       0.000439109584
  error estimate for blocks of size 2^( 5) =       0.000450289197
  error estimate for blocks of size 2^( 6) =       0.000458494690
  error estimate for blocks of size 2^( 7) =       0.000461978292

      target function =                  N/A
              le_mean =     -16.905052083232
             les_mean =     286.111601185595
             stat err =       0.000452467941
             autocorr =       1.278964385338
              std dev =       0.565813864716
             le_variance =       0.320145329505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905052083257        initial  <--
     1.4552e+04     1.4552e+05             2.5135e-08       -16.905052082854
     5.8208e+04     5.8208e+05             6.2839e-09       -16.905052083055
     2.3283e+05     2.3283e+06             1.5710e-09       -16.905052083232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9938
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1030e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.7822
    reference variance = 0.367639
====================================================
  Execution time = 1.4455e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5263e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3176e-01
  Total weights = 1.951885105e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320536415362
                                         uncertainty =       0.002862448462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320536415362
                                         uncertainty =       0.002862448462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400326671
  error estimate for blocks of size 2^( 2) =       0.000413162516
  error estimate for blocks of size 2^( 3) =       0.000426468116
  error estimate for blocks of size 2^( 4) =       0.000439200738
  error estimate for blocks of size 2^( 5) =       0.000451535504
  error estimate for blocks of size 2^( 6) =       0.000461680436
  error estimate for blocks of size 2^( 7) =       0.000467379114

      target function =                  N/A
              le_mean =     -16.906825498505
             les_mean =     286.172505084004
             stat err =       0.000454948948
             autocorr =       1.291505558623
              std dev =       0.566147407492
             le_variance =       0.320522887010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682549851e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906825498504       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906825498524       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906825498520       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906825498520       residual = 2.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+05 is 2.080241e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906825498504       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906825498509       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906825498508       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906825498508       residual = 2.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+05 is 5.200607e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906825498504       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906825498505       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906825498505       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906825498505       residual = 2.79e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+06 is 1.300152e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186307 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7075e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486998e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446536e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020676e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945636e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441944e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9112
    reference variance = 0.315075
====================================================
  Execution time = 1.4288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3717e-01
  Total weights = 1.9518e+06
  Execution time = 1.9341e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766495248
                                         uncertainty =       0.002809892716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766495248
                                         uncertainty =       0.002809892716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939459
  error estimate for blocks of size 2^( 2) =       0.000415611217
  error estimate for blocks of size 2^( 3) =       0.000429192033
  error estimate for blocks of size 2^( 4) =       0.000441470829
  error estimate for blocks of size 2^( 5) =       0.000451669526
  error estimate for blocks of size 2^( 6) =       0.000458632157
  error estimate for blocks of size 2^( 7) =       0.000463148263

      target function =                  N/A
              le_mean =     -16.906669258314
             les_mean =     286.172637582675
             stat err =       0.000453730194
             autocorr =       1.267989813091
              std dev =       0.569842447190
             le_variance =       0.324720414620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766494714
                                         uncertainty =       0.002809892733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766494714
                                         uncertainty =       0.002809892733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939458
  error estimate for blocks of size 2^( 2) =       0.000415611216
  error estimate for blocks of size 2^( 3) =       0.000429192033
  error estimate for blocks of size 2^( 4) =       0.000441470829
  error estimate for blocks of size 2^( 5) =       0.000451669526
  error estimate for blocks of size 2^( 6) =       0.000458632157
  error estimate for blocks of size 2^( 7) =       0.000463148263

      target function =                  N/A
              le_mean =     -16.906669258312
             les_mean =     286.172637582092
             stat err =       0.000453730194
             autocorr =       1.267989813108
              std dev =       0.569842446717
             le_variance =       0.324720414081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766494981
                                         uncertainty =       0.002809892724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766494981
                                         uncertainty =       0.002809892724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939458
  error estimate for blocks of size 2^( 2) =       0.000415611216
  error estimate for blocks of size 2^( 3) =       0.000429192033
  error estimate for blocks of size 2^( 4) =       0.000441470829
  error estimate for blocks of size 2^( 5) =       0.000451669526
  error estimate for blocks of size 2^( 6) =       0.000458632157
  error estimate for blocks of size 2^( 7) =       0.000463148263

      target function =                  N/A
              le_mean =     -16.906669258313
             les_mean =     286.172637582383
             stat err =       0.000453730194
             autocorr =       1.267989813101
              std dev =       0.569842446954
             le_variance =       0.324720414350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766495215
                                         uncertainty =       0.002809892717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324766495215
                                         uncertainty =       0.002809892717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402939459
  error estimate for blocks of size 2^( 2) =       0.000415611217
  error estimate for blocks of size 2^( 3) =       0.000429192033
  error estimate for blocks of size 2^( 4) =       0.000441470829
  error estimate for blocks of size 2^( 5) =       0.000451669526
  error estimate for blocks of size 2^( 6) =       0.000458632157
  error estimate for blocks of size 2^( 7) =       0.000463148263

      target function =                  N/A
              le_mean =     -16.906669258314
             les_mean =     286.172637582638
             stat err =       0.000453730194
             autocorr =       1.267989813094
              std dev =       0.569842447161
             le_variance =       0.324720414586


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906669258314        initial  <--
     1.4552e+05     1.4552e+06             2.0802e-09       -16.906669258312
     5.8208e+05     5.8208e+06             5.2006e-10       -16.906669258313
     2.3283e+06     2.3283e+07             1.3002e-10       -16.906669258314

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0517
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1133e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.962
    reference variance = 0.16658
====================================================
  Execution time = 1.4425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3232e-01
  Total weights = 1.951758530e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320930309800
                                         uncertainty =       0.002148640197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320930309800
                                         uncertainty =       0.002148640197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400596317
  error estimate for blocks of size 2^( 2) =       0.000413055148
  error estimate for blocks of size 2^( 3) =       0.000426118949
  error estimate for blocks of size 2^( 4) =       0.000438356147
  error estimate for blocks of size 2^( 5) =       0.000446831258
  error estimate for blocks of size 2^( 6) =       0.000454345353
  error estimate for blocks of size 2^( 7) =       0.000459328621

      target function =                  N/A
              le_mean =     -16.905766660727
             les_mean =     286.137266656221
             stat err =       0.000449715345
             autocorr =       1.260263937477
              std dev =       0.566528744149
             le_variance =       0.320954817947


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576666073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905766660730       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905766660732       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766660732       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766660732       residual = 4.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+06 is 1.919048e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905766660730       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905766660731       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766660731       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766660731       residual = 4.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+06 is 4.797627e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905766660730       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905766660730       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905766660730       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905766667108       residual = 4.53e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+07 is 1.199406e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7049e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8457
    reference variance = 0.185421
====================================================
  Execution time = 1.4313e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3450e-01
  Total weights = 1.9519e+06
  Execution time = 1.9295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992955
                                         uncertainty =       0.002364681226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992955
                                         uncertainty =       0.002364681226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401294791
  error estimate for blocks of size 2^( 2) =       0.000414385978
  error estimate for blocks of size 2^( 3) =       0.000427201633
  error estimate for blocks of size 2^( 4) =       0.000439595278
  error estimate for blocks of size 2^( 5) =       0.000449184404
  error estimate for blocks of size 2^( 6) =       0.000456581075
  error estimate for blocks of size 2^( 7) =       0.000461861787

      target function =                  N/A
              le_mean =     -16.905781633876
             les_mean =     286.139951889590
             stat err =       0.000451805636
             autocorr =       1.267582526207
              std dev =       0.567516536039
             le_variance =       0.322075018678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992830
                                         uncertainty =       0.002364681224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992830
                                         uncertainty =       0.002364681224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401294791
  error estimate for blocks of size 2^( 2) =       0.000414385978
  error estimate for blocks of size 2^( 3) =       0.000427201633
  error estimate for blocks of size 2^( 4) =       0.000439595278
  error estimate for blocks of size 2^( 5) =       0.000449184404
  error estimate for blocks of size 2^( 6) =       0.000456581075
  error estimate for blocks of size 2^( 7) =       0.000461861787

      target function =                  N/A
              le_mean =     -16.905781633875
             les_mean =     286.139951889721
             stat err =       0.000451805636
             autocorr =       1.267582526324
              std dev =       0.567516535929
             le_variance =       0.322075018553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992892
                                         uncertainty =       0.002364681225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992892
                                         uncertainty =       0.002364681225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401294791
  error estimate for blocks of size 2^( 2) =       0.000414385978
  error estimate for blocks of size 2^( 3) =       0.000427201633
  error estimate for blocks of size 2^( 4) =       0.000439595278
  error estimate for blocks of size 2^( 5) =       0.000449184404
  error estimate for blocks of size 2^( 6) =       0.000456581075
  error estimate for blocks of size 2^( 7) =       0.000461861787

      target function =                  N/A
              le_mean =     -16.905781633876
             les_mean =     286.139951889656
             stat err =       0.000451805636
             autocorr =       1.267582526268
              std dev =       0.567516535984
             le_variance =       0.322075018615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992947
                                         uncertainty =       0.002364681226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153992947
                                         uncertainty =       0.002364681226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401294791
  error estimate for blocks of size 2^( 2) =       0.000414385978
  error estimate for blocks of size 2^( 3) =       0.000427201633
  error estimate for blocks of size 2^( 4) =       0.000439595278
  error estimate for blocks of size 2^( 5) =       0.000449184404
  error estimate for blocks of size 2^( 6) =       0.000456581075
  error estimate for blocks of size 2^( 7) =       0.000461861787

      target function =                  N/A
              le_mean =     -16.905781633876
             les_mean =     286.139951889598
             stat err =       0.000451805636
             autocorr =       1.267582526221
              std dev =       0.567516536032
             le_variance =       0.322075018670


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905781633876        initial  <--
     1.4552e+06     1.4552e+07             1.9190e-10       -16.905781633875
     5.8208e+06     5.8208e+07             4.7976e-11       -16.905781633876
     2.3283e+07     2.3283e+08             1.1994e-11       -16.905781633876

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1210
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9325
    reference variance = 0.312327
====================================================
  Execution time = 1.4662e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3368e-01
  Total weights = 1.951731331e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320787200555
                                         uncertainty =       0.002399998397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320787200555
                                         uncertainty =       0.002399998397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400452655
  error estimate for blocks of size 2^( 2) =       0.000412955541
  error estimate for blocks of size 2^( 3) =       0.000426233791
  error estimate for blocks of size 2^( 4) =       0.000439078207
  error estimate for blocks of size 2^( 5) =       0.000450289638
  error estimate for blocks of size 2^( 6) =       0.000459043063
  error estimate for blocks of size 2^( 7) =       0.000463004160

      target function =                  N/A
              le_mean =     -16.905686364120
             les_mean =     286.135910536875
             stat err =       0.000452853767
             autocorr =       1.278832351384
              std dev =       0.566325575994
             le_variance =       0.320724658025


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568636412e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686364096       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686364097       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686364097       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686364097       residual = 3.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+07 is 2.811809e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686364096       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686364096       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686364096       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686379681       residual = 3.65e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+07 is 7.029490e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905686364096       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905686364096       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905686364096       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905686307551       residual = 3.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+08 is 1.757452e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.188787 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7283e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8754
    reference variance = 0.380054
====================================================
  Execution time = 1.4015e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3738e-01
  Total weights = 1.9520e+06
  Execution time = 1.9242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248881
                                         uncertainty =       0.002334518757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248881
                                         uncertainty =       0.002334518757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401943733
  error estimate for blocks of size 2^( 2) =       0.000415207073
  error estimate for blocks of size 2^( 3) =       0.000428977226
  error estimate for blocks of size 2^( 4) =       0.000441343947
  error estimate for blocks of size 2^( 5) =       0.000454160104
  error estimate for blocks of size 2^( 6) =       0.000464808080
  error estimate for blocks of size 2^( 7) =       0.000472667623

      target function =                  N/A
              le_mean =     -16.905715322492
             les_mean =     286.140590743266
             stat err =       0.000458244939
             autocorr =       1.299764979357
              std dev =       0.568434277886
             le_variance =       0.323117528276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248883
                                         uncertainty =       0.002334518767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248883
                                         uncertainty =       0.002334518767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401943733
  error estimate for blocks of size 2^( 2) =       0.000415207073
  error estimate for blocks of size 2^( 3) =       0.000428977226
  error estimate for blocks of size 2^( 4) =       0.000441343947
  error estimate for blocks of size 2^( 5) =       0.000454160104
  error estimate for blocks of size 2^( 6) =       0.000464808080
  error estimate for blocks of size 2^( 7) =       0.000472667623

      target function =                  N/A
              le_mean =     -16.905715322492
             les_mean =     286.140590743220
             stat err =       0.000458244939
             autocorr =       1.299764979358
              std dev =       0.568434277888
             le_variance =       0.323117528278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248882
                                         uncertainty =       0.002334518762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248882
                                         uncertainty =       0.002334518762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401943733
  error estimate for blocks of size 2^( 2) =       0.000415207073
  error estimate for blocks of size 2^( 3) =       0.000428977226
  error estimate for blocks of size 2^( 4) =       0.000441343947
  error estimate for blocks of size 2^( 5) =       0.000454160104
  error estimate for blocks of size 2^( 6) =       0.000464808080
  error estimate for blocks of size 2^( 7) =       0.000472667623

      target function =                  N/A
              le_mean =     -16.905715322492
             les_mean =     286.140590743243
             stat err =       0.000458244939
             autocorr =       1.299764979363
              std dev =       0.568434277887
             le_variance =       0.323117528277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248881
                                         uncertainty =       0.002334518757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323240248881
                                         uncertainty =       0.002334518757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401943733
  error estimate for blocks of size 2^( 2) =       0.000415207073
  error estimate for blocks of size 2^( 3) =       0.000428977226
  error estimate for blocks of size 2^( 4) =       0.000441343947
  error estimate for blocks of size 2^( 5) =       0.000454160104
  error estimate for blocks of size 2^( 6) =       0.000464808080
  error estimate for blocks of size 2^( 7) =       0.000472667623

      target function =                  N/A
              le_mean =     -16.905715322492
             les_mean =     286.140590743263
             stat err =       0.000458244939
             autocorr =       1.299764979361
              std dev =       0.568434277886
             le_variance =       0.323117528276


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905715322492        initial  <--
     1.4552e+07     1.4552e+08             2.8118e-11       -16.905715322492
     5.8208e+07     5.8208e+08             7.0295e-12       -16.905715322492
     2.3283e+08     2.3283e+09             1.7575e-12       -16.905715322492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7595
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1049e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8929
    reference variance = 0.19574
====================================================
  Execution time = 1.4434e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2994e-01
  Total weights = 1.951985229e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317590339597
                                         uncertainty =       0.002106533654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317590339597
                                         uncertainty =       0.002106533654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398501915
  error estimate for blocks of size 2^( 2) =       0.000411857605
  error estimate for blocks of size 2^( 3) =       0.000425781203
  error estimate for blocks of size 2^( 4) =       0.000438779667
  error estimate for blocks of size 2^( 5) =       0.000450227171
  error estimate for blocks of size 2^( 6) =       0.000459721774
  error estimate for blocks of size 2^( 7) =       0.000463693328

      target function =                  N/A
              le_mean =     -16.906363483069
             les_mean =     286.155062736833
             stat err =       0.000453105485
             autocorr =       1.292819261341
              std dev =       0.563566812337
             le_variance =       0.317607551968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636348307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363483082       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363483082       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363483082       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363483082       residual = 3.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+08 is 2.244115e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363483082       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363483082       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363483082       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363483082       residual = 3.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+08 is 5.610104e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906363483082       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906363483082       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363483082       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363483082       residual = 3.46e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+09 is 1.402526e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190062 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7066e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.867
    reference variance = 0.314908
====================================================
  Execution time = 1.3978e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3116e-01
  Total weights = 1.9515e+06
  Execution time = 1.9254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399229918
  error estimate for blocks of size 2^( 2) =       0.000411949638
  error estimate for blocks of size 2^( 3) =       0.000424265289
  error estimate for blocks of size 2^( 4) =       0.000435999615
  error estimate for blocks of size 2^( 5) =       0.000446766555
  error estimate for blocks of size 2^( 6) =       0.000452450836
  error estimate for blocks of size 2^( 7) =       0.000455535663

      target function =                  N/A
              le_mean =     -16.905916156509
             les_mean =     286.141161178865
             stat err =       0.000447688167
             autocorr =       1.257491544562
              std dev =       0.564596363853
             le_variance =       0.318769054076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399229918
  error estimate for blocks of size 2^( 2) =       0.000411949638
  error estimate for blocks of size 2^( 3) =       0.000424265289
  error estimate for blocks of size 2^( 4) =       0.000435999615
  error estimate for blocks of size 2^( 5) =       0.000446766555
  error estimate for blocks of size 2^( 6) =       0.000452450836
  error estimate for blocks of size 2^( 7) =       0.000455535663

      target function =                  N/A
              le_mean =     -16.905916156509
             les_mean =     286.141161178857
             stat err =       0.000447688167
             autocorr =       1.257491544566
              std dev =       0.564596363853
             le_variance =       0.318769054076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399229918
  error estimate for blocks of size 2^( 2) =       0.000411949638
  error estimate for blocks of size 2^( 3) =       0.000424265289
  error estimate for blocks of size 2^( 4) =       0.000435999615
  error estimate for blocks of size 2^( 5) =       0.000446766555
  error estimate for blocks of size 2^( 6) =       0.000452450836
  error estimate for blocks of size 2^( 7) =       0.000455535663

      target function =                  N/A
              le_mean =     -16.905916156509
             les_mean =     286.141161178861
             stat err =       0.000447688167
             autocorr =       1.257491544569
              std dev =       0.564596363853
             le_variance =       0.318769054076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318734712268
                                         uncertainty =       0.002118378014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399229918
  error estimate for blocks of size 2^( 2) =       0.000411949638
  error estimate for blocks of size 2^( 3) =       0.000424265289
  error estimate for blocks of size 2^( 4) =       0.000435999615
  error estimate for blocks of size 2^( 5) =       0.000446766555
  error estimate for blocks of size 2^( 6) =       0.000452450836
  error estimate for blocks of size 2^( 7) =       0.000455535663

      target function =                  N/A
              le_mean =     -16.905916156509
             les_mean =     286.141161178865
             stat err =       0.000447688167
             autocorr =       1.257491544566
              std dev =       0.564596363853
             le_variance =       0.318769054076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905916156509        initial  <--
     1.4552e+08     1.4552e+09             2.2441e-12       -16.905916156509
     5.8208e+08     5.8208e+09             5.6101e-13       -16.905916156509
     2.3283e+09     2.3283e+10             1.4025e-13       -16.905916156509

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 27.2383
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4310e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8734
    reference variance = 0.441445
====================================================
  Execution time = 1.4413e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5237e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3077e-01
  Total weights = 1.951964357e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318466346900
                                         uncertainty =       0.002025285116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318466346900
                                         uncertainty =       0.002025285116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399027653
  error estimate for blocks of size 2^( 2) =       0.000411916095
  error estimate for blocks of size 2^( 3) =       0.000424828240
  error estimate for blocks of size 2^( 4) =       0.000437133637
  error estimate for blocks of size 2^( 5) =       0.000447423699
  error estimate for blocks of size 2^( 6) =       0.000454750728
  error estimate for blocks of size 2^( 7) =       0.000456874816

      target function =                  N/A
              le_mean =     -16.906753502142
             les_mean =     286.169082621709
             stat err =       0.000449045720
             autocorr =       1.266412342669
              std dev =       0.564310319069
             le_variance =       0.318446136208


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690675350214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906753502154       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906753502154       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906753502154       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+09 is 2.419121e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906753502154       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906753502154       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906753502154       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+09 is 6.047802e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906753502154       residual = 8.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906753502154       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906753502154       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+10 is 1.511951e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191067 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7027e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9593
    reference variance = 0.249966
====================================================
  Execution time = 1.4423e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3180e-01
  Total weights = 1.9519e+06
  Execution time = 1.9216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400097398
  error estimate for blocks of size 2^( 2) =       0.000413090741
  error estimate for blocks of size 2^( 3) =       0.000426697874
  error estimate for blocks of size 2^( 4) =       0.000438909656
  error estimate for blocks of size 2^( 5) =       0.000448846295
  error estimate for blocks of size 2^( 6) =       0.000456188022
  error estimate for blocks of size 2^( 7) =       0.000461616897

      target function =                  N/A
              le_mean =     -16.905782867595
             les_mean =     286.137293118414
             stat err =       0.000451390217
             autocorr =       1.272837117930
              std dev =       0.565823166518
             le_variance =       0.320155855769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400097398
  error estimate for blocks of size 2^( 2) =       0.000413090741
  error estimate for blocks of size 2^( 3) =       0.000426697874
  error estimate for blocks of size 2^( 4) =       0.000438909656
  error estimate for blocks of size 2^( 5) =       0.000448846295
  error estimate for blocks of size 2^( 6) =       0.000456188022
  error estimate for blocks of size 2^( 7) =       0.000461616897

      target function =                  N/A
              le_mean =     -16.905782867595
             les_mean =     286.137293118414
             stat err =       0.000451390217
             autocorr =       1.272837117930
              std dev =       0.565823166518
             le_variance =       0.320155855769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400097398
  error estimate for blocks of size 2^( 2) =       0.000413090741
  error estimate for blocks of size 2^( 3) =       0.000426697874
  error estimate for blocks of size 2^( 4) =       0.000438909656
  error estimate for blocks of size 2^( 5) =       0.000448846295
  error estimate for blocks of size 2^( 6) =       0.000456188022
  error estimate for blocks of size 2^( 7) =       0.000461616897

      target function =                  N/A
              le_mean =     -16.905782867595
             les_mean =     286.137293118414
             stat err =       0.000451390217
             autocorr =       1.272837117928
              std dev =       0.565823166518
             le_variance =       0.320155855769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320193073432
                                         uncertainty =       0.001786066566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400097398
  error estimate for blocks of size 2^( 2) =       0.000413090741
  error estimate for blocks of size 2^( 3) =       0.000426697874
  error estimate for blocks of size 2^( 4) =       0.000438909656
  error estimate for blocks of size 2^( 5) =       0.000448846295
  error estimate for blocks of size 2^( 6) =       0.000456188022
  error estimate for blocks of size 2^( 7) =       0.000461616897

      target function =                  N/A
              le_mean =     -16.905782867595
             les_mean =     286.137293118414
             stat err =       0.000451390217
             autocorr =       1.272837117928
              std dev =       0.565823166518
             le_variance =       0.320155855769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905782867595        initial  <--
     1.4552e+09     1.4552e+10             2.4191e-13       -16.905782867595
     5.8208e+09     5.8208e+10             6.0478e-14       -16.905782867595
     2.3283e+10     2.3283e+11             1.5120e-14       -16.905782867595

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1056
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.375136
====================================================
  Execution time = 1.4306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3913e-01
  Total weights = 1.951877120e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6080e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322094853060
                                         uncertainty =       0.002243611136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322094853060
                                         uncertainty =       0.002243611136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401361154
  error estimate for blocks of size 2^( 2) =       0.000414442645
  error estimate for blocks of size 2^( 3) =       0.000427404947
  error estimate for blocks of size 2^( 4) =       0.000439527816
  error estimate for blocks of size 2^( 5) =       0.000450123560
  error estimate for blocks of size 2^( 6) =       0.000459061705
  error estimate for blocks of size 2^( 7) =       0.000462313487

      target function =                  N/A
              le_mean =     -16.905483181730
             les_mean =     286.134490122887
             stat err =       0.000452756642
             autocorr =       1.272503504674
              std dev =       0.567610387702
             le_variance =       0.322181552227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690548318173e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905483181722       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905483181722       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905483181722       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905483181722       residual = 2.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+10 is 2.694125e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905483181722       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905483181722       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905483181722       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905484918851       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+10 is 6.730441e-15

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905483181722       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905483181722       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905483181722       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905483181722       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905483181722       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905483181689       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905425600896       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905386514248       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905477813939       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905220643552       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905925310244       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905595601451       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905766423697       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905585277264       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906032106474       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.914705141733       residual = 4.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.897877398194       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.911840828390       residual = 1.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.157376653806       residual = 7.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906308367455       residual = 2.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906997606718       residual = 1.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.832171781472       residual = 6.52e+00           smallest_sin_value = 9.99e-01
davidson iteration   22 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+11 is 1.690539e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6927e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8329
    reference variance = 0.331781
====================================================
  Execution time = 1.4103e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3337e-01
  Total weights = 1.9518e+06
  Execution time = 1.9256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401640411
  error estimate for blocks of size 2^( 2) =       0.000414097415
  error estimate for blocks of size 2^( 3) =       0.000426680566
  error estimate for blocks of size 2^( 4) =       0.000438634135
  error estimate for blocks of size 2^( 5) =       0.000448343256
  error estimate for blocks of size 2^( 6) =       0.000454963557
  error estimate for blocks of size 2^( 7) =       0.000460041757

      target function =                  N/A
              le_mean =     -16.906877985332
             les_mean =     286.175896791095
             stat err =       0.000450495676
             autocorr =       1.258074753038
              std dev =       0.568005316994
             le_variance =       0.322630040134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401640411
  error estimate for blocks of size 2^( 2) =       0.000414097415
  error estimate for blocks of size 2^( 3) =       0.000426680566
  error estimate for blocks of size 2^( 4) =       0.000438634135
  error estimate for blocks of size 2^( 5) =       0.000448343256
  error estimate for blocks of size 2^( 6) =       0.000454963557
  error estimate for blocks of size 2^( 7) =       0.000460041757

      target function =                  N/A
              le_mean =     -16.906877985332
             les_mean =     286.175896791095
             stat err =       0.000450495676
             autocorr =       1.258074753041
              std dev =       0.568005316994
             le_variance =       0.322630040134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401640411
  error estimate for blocks of size 2^( 2) =       0.000414097415
  error estimate for blocks of size 2^( 3) =       0.000426680566
  error estimate for blocks of size 2^( 4) =       0.000438634135
  error estimate for blocks of size 2^( 5) =       0.000448343256
  error estimate for blocks of size 2^( 6) =       0.000454963557
  error estimate for blocks of size 2^( 7) =       0.000460041757

      target function =                  N/A
              le_mean =     -16.906877985332
             les_mean =     286.175896791095
             stat err =       0.000450495676
             autocorr =       1.258074753041
              std dev =       0.568005316994
             le_variance =       0.322630040134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322633770997
                                         uncertainty =       0.002498019269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401640411
  error estimate for blocks of size 2^( 2) =       0.000414097415
  error estimate for blocks of size 2^( 3) =       0.000426680566
  error estimate for blocks of size 2^( 4) =       0.000438634135
  error estimate for blocks of size 2^( 5) =       0.000448343256
  error estimate for blocks of size 2^( 6) =       0.000454963557
  error estimate for blocks of size 2^( 7) =       0.000460041757

      target function =                  N/A
              le_mean =     -16.906877985332
             les_mean =     286.175896791095
             stat err =       0.000450495676
             autocorr =       1.258074753034
              std dev =       0.568005316994
             le_variance =       0.322630040134


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906877985332        initial  <--
     1.4552e+10     1.4552e+11             2.6941e-14       -16.906877985332
     5.8208e+10     5.8208e+11             6.7304e-15       -16.906877985332
     2.3283e+11     2.3283e+12             1.6905e-15       -16.906877985332

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8054
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.882
    reference variance = 0.248228
====================================================
  Execution time = 1.4347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3194e-01
  Total weights = 1.951983897e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320443778131
                                         uncertainty =       0.002112232330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320443778131
                                         uncertainty =       0.002112232330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400290784
  error estimate for blocks of size 2^( 2) =       0.000413126470
  error estimate for blocks of size 2^( 3) =       0.000425516731
  error estimate for blocks of size 2^( 4) =       0.000437063156
  error estimate for blocks of size 2^( 5) =       0.000448599540
  error estimate for blocks of size 2^( 6) =       0.000455941428
  error estimate for blocks of size 2^( 7) =       0.000458461477

      target function =                  N/A
              le_mean =     -16.905689169404
             les_mean =     286.134266800399
             stat err =       0.000450016400
             autocorr =       1.263879002383
              std dev =       0.566096656227
             le_variance =       0.320465424192


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568916940e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+11, overlap shift 1.4552e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689169406       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689169406       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689169406       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905726386926       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+11 is 2.094091e-15

solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689169406       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689169406       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689169406       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905689169406       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905685907260       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905634627360       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905958781583       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907225957712       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.917223561997       residual = 8.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.875670755606       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.868493370618       residual = 1.70e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.093471523772       residual = 2.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.851258173089       residual = 5.90e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.388588761978       residual = 1.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.079838990405       residual = 1.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -15.636182000485       residual = 7.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   16 stopping due to too large eigenvalue change
davidson solver did not converge after         16 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+11 is 5.223944e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905689169406       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689169406       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689169406       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905689169406       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906127527219       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906938679614       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.908461462248       residual = 5.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906328343337       residual = 9.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.949298511261       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910227917771       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.858402877209       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.414162051832       residual = 4.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+12 is 1.305986e-16

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205352 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6946e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9226
    reference variance = 0.335411
====================================================
  Execution time = 1.4148e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3690e-01
  Total weights = 1.9516e+06
  Execution time = 1.9182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401522724
  error estimate for blocks of size 2^( 2) =       0.000414421091
  error estimate for blocks of size 2^( 3) =       0.000427975686
  error estimate for blocks of size 2^( 4) =       0.000440865120
  error estimate for blocks of size 2^( 5) =       0.000451825821
  error estimate for blocks of size 2^( 6) =       0.000459348332
  error estimate for blocks of size 2^( 7) =       0.000467995380

      target function =                  N/A
              le_mean =     -16.906226237026
             les_mean =     286.157387494893
             stat err =       0.000455008663
             autocorr =       1.284159806701
              std dev =       0.567838882314
             le_variance =       0.322440996267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401522724
  error estimate for blocks of size 2^( 2) =       0.000414421091
  error estimate for blocks of size 2^( 3) =       0.000427975686
  error estimate for blocks of size 2^( 4) =       0.000440865120
  error estimate for blocks of size 2^( 5) =       0.000451825821
  error estimate for blocks of size 2^( 6) =       0.000459348332
  error estimate for blocks of size 2^( 7) =       0.000467995380

      target function =                  N/A
              le_mean =     -16.906226237026
             les_mean =     286.157387494893
             stat err =       0.000455008663
             autocorr =       1.284159806702
              std dev =       0.567838882314
             le_variance =       0.322440996267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401522724
  error estimate for blocks of size 2^( 2) =       0.000414421091
  error estimate for blocks of size 2^( 3) =       0.000427975686
  error estimate for blocks of size 2^( 4) =       0.000440865120
  error estimate for blocks of size 2^( 5) =       0.000451825821
  error estimate for blocks of size 2^( 6) =       0.000459348332
  error estimate for blocks of size 2^( 7) =       0.000467995380

      target function =                  N/A
              le_mean =     -16.906226237026
             les_mean =     286.157387494893
             stat err =       0.000455008663
             autocorr =       1.284159806701
              std dev =       0.567838882314
             le_variance =       0.322440996267

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322459180444
                                         uncertainty =       0.002601040369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401522724
  error estimate for blocks of size 2^( 2) =       0.000414421091
  error estimate for blocks of size 2^( 3) =       0.000427975686
  error estimate for blocks of size 2^( 4) =       0.000440865120
  error estimate for blocks of size 2^( 5) =       0.000451825821
  error estimate for blocks of size 2^( 6) =       0.000459348332
  error estimate for blocks of size 2^( 7) =       0.000467995380

      target function =                  N/A
              le_mean =     -16.906226237026
             les_mean =     286.157387494893
             stat err =       0.000455008663
             autocorr =       1.284159806701
              std dev =       0.567838882314
             le_variance =       0.322440996267


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906226237026        initial  <--
     1.4552e+11     1.4552e+12             2.0941e-15       -16.906226237026
     5.8208e+11     5.8208e+12             5.2239e-16       -16.906226237026
     2.3283e+12     2.3283e+13             1.3060e-16       -16.906226237026

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8133
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0766e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.347886
====================================================
  Execution time = 1.4476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3267e-01
  Total weights = 1.951994394e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321713993633
                                         uncertainty =       0.002578652489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321713993633
                                         uncertainty =       0.002578652489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401042292
  error estimate for blocks of size 2^( 2) =       0.000414175146
  error estimate for blocks of size 2^( 3) =       0.000427258820
  error estimate for blocks of size 2^( 4) =       0.000438728590
  error estimate for blocks of size 2^( 5) =       0.000449565766
  error estimate for blocks of size 2^( 6) =       0.000459519270
  error estimate for blocks of size 2^( 7) =       0.000462072976

      target function =                  N/A
              le_mean =     -16.906806619559
             les_mean =     286.172784473657
             stat err =       0.000452471651
             autocorr =       1.272923782493
              std dev =       0.567159448296
             le_variance =       0.321669839791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680661956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+12, overlap shift 1.4552e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906806619555       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906806619555       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906806619555       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906606697847       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906806619555       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907742239038       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907114323636       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905902413636       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906220581960       residual = 3.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907100974431       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908432139300       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.992759116980       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.854412519235       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.914305782740       residual = 2.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.768721493067       residual = 2.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.994919576109       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.903406096381       residual = 5.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.921529475055       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.933385319204       residual = 1.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.059461647203       residual = 3.39e+00           smallest_sin_value = 9.99e-01
davidson iteration   20:   krylov dim =  21   energy =     -16.833760951250       residual = 8.29e-01           smallest_sin_value = 9.91e-01
davidson iteration   21 stopping due to small subspace S singular value of 8.88e-01
davidson solver did not converge after         21 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+12 is 2.862178e-16

solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906806619555       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906806619555       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906806619555       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+12 is 6.210197e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906806619555       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906806619555       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906806619555       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906592618087       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.917827444485       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907092429796       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906806615183       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907871907458       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.896669966025       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907991091570       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.443030956159       residual = 5.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -15.772565827472       residual = 4.86e+04           smallest_sin_value = 1.00e+00
davidson iteration   12 stopping due to too large eigenvalue change
davidson solver did not converge after         12 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+13 is 1.552549e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213619 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7085e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.931
    reference variance = 0.291236
====================================================
  Execution time = 1.4139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3579e-01
  Total weights = 1.9517e+06
  Execution time = 1.9129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400758705
  error estimate for blocks of size 2^( 2) =       0.000413684301
  error estimate for blocks of size 2^( 3) =       0.000427136071
  error estimate for blocks of size 2^( 4) =       0.000440066383
  error estimate for blocks of size 2^( 5) =       0.000450232292
  error estimate for blocks of size 2^( 6) =       0.000457918635
  error estimate for blocks of size 2^( 7) =       0.000460371890

      target function =                  N/A
              le_mean =     -16.906491045816
             les_mean =     286.165226385986
             stat err =       0.000452147300
             autocorr =       1.272899028736
              std dev =       0.566758395753
             le_variance =       0.321215079156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400758705
  error estimate for blocks of size 2^( 2) =       0.000413684301
  error estimate for blocks of size 2^( 3) =       0.000427136071
  error estimate for blocks of size 2^( 4) =       0.000440066383
  error estimate for blocks of size 2^( 5) =       0.000450232292
  error estimate for blocks of size 2^( 6) =       0.000457918635
  error estimate for blocks of size 2^( 7) =       0.000460371890

      target function =                  N/A
              le_mean =     -16.906491045816
             les_mean =     286.165226385986
             stat err =       0.000452147300
             autocorr =       1.272899028735
              std dev =       0.566758395753
             le_variance =       0.321215079156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400758705
  error estimate for blocks of size 2^( 2) =       0.000413684301
  error estimate for blocks of size 2^( 3) =       0.000427136071
  error estimate for blocks of size 2^( 4) =       0.000440066383
  error estimate for blocks of size 2^( 5) =       0.000450232292
  error estimate for blocks of size 2^( 6) =       0.000457918635
  error estimate for blocks of size 2^( 7) =       0.000460371890

      target function =                  N/A
              le_mean =     -16.906491045816
             les_mean =     286.165226385986
             stat err =       0.000452147300
             autocorr =       1.272899028735
              std dev =       0.566758395753
             le_variance =       0.321215079156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321277514495
                                         uncertainty =       0.002406192804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400758705
  error estimate for blocks of size 2^( 2) =       0.000413684301
  error estimate for blocks of size 2^( 3) =       0.000427136071
  error estimate for blocks of size 2^( 4) =       0.000440066383
  error estimate for blocks of size 2^( 5) =       0.000450232292
  error estimate for blocks of size 2^( 6) =       0.000457918635
  error estimate for blocks of size 2^( 7) =       0.000460371890

      target function =                  N/A
              le_mean =     -16.906491045816
             les_mean =     286.165226385986
             stat err =       0.000452147300
             autocorr =       1.272899028736
              std dev =       0.566758395753
             le_variance =       0.321215079156


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906491045816        initial  <--
     1.4552e+12     1.4552e+13             2.8622e-16       -16.906491045816
     5.8208e+12     5.8208e+13             6.2102e-17       -16.906491045816
     2.3283e+13     2.3283e+14             1.5525e-17       -16.906491045816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7845
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0876e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.7991
    reference variance = 0.31218
====================================================
  Execution time = 1.4628e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3622e-01
  Total weights = 1.951861407e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323969761318
                                         uncertainty =       0.004045872287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323969761318
                                         uncertainty =       0.004045872287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402447253
  error estimate for blocks of size 2^( 2) =       0.000415369875
  error estimate for blocks of size 2^( 3) =       0.000428519735
  error estimate for blocks of size 2^( 4) =       0.000440229356
  error estimate for blocks of size 2^( 5) =       0.000451074514
  error estimate for blocks of size 2^( 6) =       0.000458639454
  error estimate for blocks of size 2^( 7) =       0.000462520706

      target function =                  N/A
              le_mean =     -16.905630663738
             les_mean =     286.136572720121
             stat err =       0.000453116007
             autocorr =       1.267654419191
              std dev =       0.569146363492
             le_variance =       0.323927583076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563066374e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+13, overlap shift 1.4552e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905630663754       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905630663754       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+13, overlap shift 5.8208e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905630663754       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905630663754       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+14, overlap shift 2.3283e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905630663754       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905630663754       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.82e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7238e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8737
    reference variance = 0.29596
====================================================
  Execution time = 1.4036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3576e-01
  Total weights = 1.9520e+06
  Execution time = 1.9191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401866086
  error estimate for blocks of size 2^( 2) =       0.000414620588
  error estimate for blocks of size 2^( 3) =       0.000428034244
  error estimate for blocks of size 2^( 4) =       0.000439847032
  error estimate for blocks of size 2^( 5) =       0.000449739389
  error estimate for blocks of size 2^( 6) =       0.000457729391
  error estimate for blocks of size 2^( 7) =       0.000463220488

      target function =                  N/A
              le_mean =     -16.905713094330
             les_mean =     286.138895373049
             stat err =       0.000452634075
             autocorr =       1.268620650508
              std dev =       0.568324469282
             le_variance =       0.322992702384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401866086
  error estimate for blocks of size 2^( 2) =       0.000414620588
  error estimate for blocks of size 2^( 3) =       0.000428034244
  error estimate for blocks of size 2^( 4) =       0.000439847032
  error estimate for blocks of size 2^( 5) =       0.000449739389
  error estimate for blocks of size 2^( 6) =       0.000457729391
  error estimate for blocks of size 2^( 7) =       0.000463220488

      target function =                  N/A
              le_mean =     -16.905713094330
             les_mean =     286.138895373049
             stat err =       0.000452634075
             autocorr =       1.268620650508
              std dev =       0.568324469282
             le_variance =       0.322992702384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401866086
  error estimate for blocks of size 2^( 2) =       0.000414620588
  error estimate for blocks of size 2^( 3) =       0.000428034244
  error estimate for blocks of size 2^( 4) =       0.000439847032
  error estimate for blocks of size 2^( 5) =       0.000449739389
  error estimate for blocks of size 2^( 6) =       0.000457729391
  error estimate for blocks of size 2^( 7) =       0.000463220488

      target function =                  N/A
              le_mean =     -16.905713094330
             les_mean =     286.138895373049
             stat err =       0.000452634075
             autocorr =       1.268620650508
              std dev =       0.568324469282
             le_variance =       0.322992702384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323027943350
                                         uncertainty =       0.001987887627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401866086
  error estimate for blocks of size 2^( 2) =       0.000414620588
  error estimate for blocks of size 2^( 3) =       0.000428034244
  error estimate for blocks of size 2^( 4) =       0.000439847032
  error estimate for blocks of size 2^( 5) =       0.000449739389
  error estimate for blocks of size 2^( 6) =       0.000457729391
  error estimate for blocks of size 2^( 7) =       0.000463220488

      target function =                  N/A
              le_mean =     -16.905713094330
             les_mean =     286.138895373049
             stat err =       0.000452634075
             autocorr =       1.268620650508
              std dev =       0.568324469282
             le_variance =       0.322992702384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905713094330        initial  <--
     1.4552e+13     1.4552e+14             0.0000e+00       -16.905713094330
     5.8208e+13     5.8208e+14             0.0000e+00       -16.905713094330
     2.3283e+14     2.3283e+15             0.0000e+00       -16.905713094330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7069
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.332276
====================================================
  Execution time = 1.4622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3454e-01
  Total weights = 1.951747672e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321374896910
                                         uncertainty =       0.001996744158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321374896910
                                         uncertainty =       0.001996744158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400899473
  error estimate for blocks of size 2^( 2) =       0.000413967284
  error estimate for blocks of size 2^( 3) =       0.000427355561
  error estimate for blocks of size 2^( 4) =       0.000439800035
  error estimate for blocks of size 2^( 5) =       0.000450553449
  error estimate for blocks of size 2^( 6) =       0.000460575040
  error estimate for blocks of size 2^( 7) =       0.000465033748

      target function =                  N/A
              le_mean =     -16.905671955837
             les_mean =     286.136288537635
             stat err =       0.000453990568
             autocorr =       1.282397579959
              std dev =       0.566957472017
             le_variance =       0.321440775076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567195584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+14, overlap shift 1.4552e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905671955823       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905671955823       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905671955823       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905671955823       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4: stopping due to imaginary component in cost function
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+14 is 2.903299e-18

solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905671955823       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905671955823       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905671955823       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910062464713       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905671955823       residual = 1.40e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.749090967045       residual = 6.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909577995615       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -15.366593323963       residual = 7.35e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.704907105444       residual = 7.64e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -21.018876957294       residual = 5.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+14 is 7.321119e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+15, overlap shift 2.3283e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905671955823       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905671955823       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905671955823       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 7.94e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+15 is 1.830280e-19

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217042 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7226e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.903
    reference variance = 0.197037
====================================================
  Execution time = 1.4180e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3825e-01
  Total weights = 1.9516e+06
  Execution time = 1.9236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402750890
  error estimate for blocks of size 2^( 2) =       0.000416130362
  error estimate for blocks of size 2^( 3) =       0.000430300551
  error estimate for blocks of size 2^( 4) =       0.000443454792
  error estimate for blocks of size 2^( 5) =       0.000455056495
  error estimate for blocks of size 2^( 6) =       0.000466293447
  error estimate for blocks of size 2^( 7) =       0.000470229236

      target function =                  N/A
              le_mean =     -16.905346483302
             les_mean =     286.128986160149
             stat err =       0.000458758493
             autocorr =       1.297463704423
              std dev =       0.569575770348
             le_variance =       0.324416558167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402750890
  error estimate for blocks of size 2^( 2) =       0.000416130362
  error estimate for blocks of size 2^( 3) =       0.000430300551
  error estimate for blocks of size 2^( 4) =       0.000443454792
  error estimate for blocks of size 2^( 5) =       0.000455056495
  error estimate for blocks of size 2^( 6) =       0.000466293447
  error estimate for blocks of size 2^( 7) =       0.000470229236

      target function =                  N/A
              le_mean =     -16.905346483302
             les_mean =     286.128986160149
             stat err =       0.000458758493
             autocorr =       1.297463704422
              std dev =       0.569575770348
             le_variance =       0.324416558167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402750890
  error estimate for blocks of size 2^( 2) =       0.000416130362
  error estimate for blocks of size 2^( 3) =       0.000430300551
  error estimate for blocks of size 2^( 4) =       0.000443454792
  error estimate for blocks of size 2^( 5) =       0.000455056495
  error estimate for blocks of size 2^( 6) =       0.000466293447
  error estimate for blocks of size 2^( 7) =       0.000470229236

      target function =                  N/A
              le_mean =     -16.905346483302
             les_mean =     286.128986160149
             stat err =       0.000458758493
             autocorr =       1.297463704423
              std dev =       0.569575770348
             le_variance =       0.324416558167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324524814031
                                         uncertainty =       0.002355169706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402750890
  error estimate for blocks of size 2^( 2) =       0.000416130362
  error estimate for blocks of size 2^( 3) =       0.000430300551
  error estimate for blocks of size 2^( 4) =       0.000443454792
  error estimate for blocks of size 2^( 5) =       0.000455056495
  error estimate for blocks of size 2^( 6) =       0.000466293447
  error estimate for blocks of size 2^( 7) =       0.000470229236

      target function =                  N/A
              le_mean =     -16.905346483302
             les_mean =     286.128986160149
             stat err =       0.000458758493
             autocorr =       1.297463704423
              std dev =       0.569575770348
             le_variance =       0.324416558167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905346483302        initial  <--
     1.4552e+14     1.4552e+15             2.9033e-18       -16.905346483302
     5.8208e+14     5.8208e+15             7.3211e-19       -16.905346483302
     2.3283e+15     2.3283e+16             1.8303e-19       -16.905346483302

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8710
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1104e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9404
    reference variance = 0.502333
====================================================
  Execution time = 1.4446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3972e-01
  Total weights = 1.952072970e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327187653694
                                         uncertainty =       0.003443295682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327187653694
                                         uncertainty =       0.003443295682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404458059
  error estimate for blocks of size 2^( 2) =       0.000417039960
  error estimate for blocks of size 2^( 3) =       0.000429920771
  error estimate for blocks of size 2^( 4) =       0.000440742999
  error estimate for blocks of size 2^( 5) =       0.000450689406
  error estimate for blocks of size 2^( 6) =       0.000456095919
  error estimate for blocks of size 2^( 7) =       0.000460857512

      target function =                  N/A
              le_mean =     -16.906277104005
             les_mean =     286.161923657144
             stat err =       0.000452096459
             autocorr =       1.249439477192
              std dev =       0.571990072842
             le_variance =       0.327172643430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627710400e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+15, overlap shift 1.4552e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906277104019       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277104019       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.48e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.8208e+15, overlap shift 5.8208e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906277104019       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277104019       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.48e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+16, overlap shift 2.3283e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906277104019       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906277104019       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.48e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+16 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7052e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.7457
    reference variance = 2.95181
====================================================
  Execution time = 1.4199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3095e-01
  Total weights = 1.9519e+06
  Execution time = 1.9280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398561306
  error estimate for blocks of size 2^( 2) =       0.000411477526
  error estimate for blocks of size 2^( 3) =       0.000424230883
  error estimate for blocks of size 2^( 4) =       0.000435940794
  error estimate for blocks of size 2^( 5) =       0.000446511832
  error estimate for blocks of size 2^( 6) =       0.000453739207
  error estimate for blocks of size 2^( 7) =       0.000461134933

      target function =                  N/A
              le_mean =     -16.906355557819
             les_mean =     286.155809078894
             stat err =       0.000449331692
             autocorr =       1.270994975943
              std dev =       0.563650805065
             le_variance =       0.317702230050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398561306
  error estimate for blocks of size 2^( 2) =       0.000411477526
  error estimate for blocks of size 2^( 3) =       0.000424230883
  error estimate for blocks of size 2^( 4) =       0.000435940794
  error estimate for blocks of size 2^( 5) =       0.000446511832
  error estimate for blocks of size 2^( 6) =       0.000453739207
  error estimate for blocks of size 2^( 7) =       0.000461134933

      target function =                  N/A
              le_mean =     -16.906355557819
             les_mean =     286.155809078894
             stat err =       0.000449331692
             autocorr =       1.270994975943
              std dev =       0.563650805065
             le_variance =       0.317702230050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398561306
  error estimate for blocks of size 2^( 2) =       0.000411477526
  error estimate for blocks of size 2^( 3) =       0.000424230883
  error estimate for blocks of size 2^( 4) =       0.000435940794
  error estimate for blocks of size 2^( 5) =       0.000446511832
  error estimate for blocks of size 2^( 6) =       0.000453739207
  error estimate for blocks of size 2^( 7) =       0.000461134933

      target function =                  N/A
              le_mean =     -16.906355557819
             les_mean =     286.155809078894
             stat err =       0.000449331692
             autocorr =       1.270994975943
              std dev =       0.563650805065
             le_variance =       0.317702230050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317517058293
                                         uncertainty =       0.002503172133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398561306
  error estimate for blocks of size 2^( 2) =       0.000411477526
  error estimate for blocks of size 2^( 3) =       0.000424230883
  error estimate for blocks of size 2^( 4) =       0.000435940794
  error estimate for blocks of size 2^( 5) =       0.000446511832
  error estimate for blocks of size 2^( 6) =       0.000453739207
  error estimate for blocks of size 2^( 7) =       0.000461134933

      target function =                  N/A
              le_mean =     -16.906355557819
             les_mean =     286.155809078894
             stat err =       0.000449331692
             autocorr =       1.270994975943
              std dev =       0.563650805065
             le_variance =       0.317702230050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906355557819        initial  <--
     1.4552e+15     1.4552e+16             0.0000e+00       -16.906355557819
     5.8208e+15     5.8208e+16             0.0000e+00       -16.906355557819
     2.3283e+16     2.3283e+17             0.0000e+00       -16.906355557819

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.9153
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0974e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.0049
    reference variance = 0.22269
====================================================
  Execution time = 1.6981e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3182e-01
  Total weights = 1.951889503e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319852233044
                                         uncertainty =       0.002035207501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319852233044
                                         uncertainty =       0.002035207501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399984324
  error estimate for blocks of size 2^( 2) =       0.000412894444
  error estimate for blocks of size 2^( 3) =       0.000426124025
  error estimate for blocks of size 2^( 4) =       0.000439039638
  error estimate for blocks of size 2^( 5) =       0.000450267518
  error estimate for blocks of size 2^( 6) =       0.000460403276
  error estimate for blocks of size 2^( 7) =       0.000466984970

      target function =                  N/A
              le_mean =     -16.905829718878
             les_mean =     286.138898835548
             stat err =       0.000454173850
             autocorr =       1.289312843425
              std dev =       0.565663256021
             le_variance =       0.319974919212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690582971888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+16, overlap shift 1.4552e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829718884       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829718884       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829718884       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905829718887       residual = 1.95e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905829718884       residual = 3.82e-12           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+16 is 3.651137e-20

solving harmonic davidson linear method for identity shift 5.8208e+16, overlap shift 5.8208e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829718884       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829718884       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829718884       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.31e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+16 is 8.830157e-21

solving harmonic davidson linear method for identity shift 2.3283e+17, overlap shift 2.3283e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905829718884       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905829718884       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905829718884       residual = 6.76e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905829718883       residual = 4.08e+00           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+17 is 2.207539e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9590e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.9055
    reference variance = 0.254661
====================================================
  Execution time = 1.4359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3179e-01
  Total weights = 1.9517e+06
  Execution time = 1.9244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080776
  error estimate for blocks of size 2^( 2) =       0.000412907286
  error estimate for blocks of size 2^( 3) =       0.000426099320
  error estimate for blocks of size 2^( 4) =       0.000438882792
  error estimate for blocks of size 2^( 5) =       0.000448962779
  error estimate for blocks of size 2^( 6) =       0.000457793174
  error estimate for blocks of size 2^( 7) =       0.000461468926

      target function =                  N/A
              le_mean =     -16.906991226456
             les_mean =     286.178138079289
             stat err =       0.000451776918
             autocorr =       1.275124846587
              std dev =       0.565799659722
             le_variance =       0.320129254941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080776
  error estimate for blocks of size 2^( 2) =       0.000412907286
  error estimate for blocks of size 2^( 3) =       0.000426099320
  error estimate for blocks of size 2^( 4) =       0.000438882792
  error estimate for blocks of size 2^( 5) =       0.000448962779
  error estimate for blocks of size 2^( 6) =       0.000457793174
  error estimate for blocks of size 2^( 7) =       0.000461468926

      target function =                  N/A
              le_mean =     -16.906991226456
             les_mean =     286.178138079289
             stat err =       0.000451776918
             autocorr =       1.275124846587
              std dev =       0.565799659722
             le_variance =       0.320129254941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080776
  error estimate for blocks of size 2^( 2) =       0.000412907286
  error estimate for blocks of size 2^( 3) =       0.000426099320
  error estimate for blocks of size 2^( 4) =       0.000438882792
  error estimate for blocks of size 2^( 5) =       0.000448962779
  error estimate for blocks of size 2^( 6) =       0.000457793174
  error estimate for blocks of size 2^( 7) =       0.000461468926

      target function =                  N/A
              le_mean =     -16.906991226456
             les_mean =     286.178138079289
             stat err =       0.000451776918
             autocorr =       1.275124846587
              std dev =       0.565799659722
             le_variance =       0.320129254941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320052842232
                                         uncertainty =       0.002364682306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400080776
  error estimate for blocks of size 2^( 2) =       0.000412907286
  error estimate for blocks of size 2^( 3) =       0.000426099320
  error estimate for blocks of size 2^( 4) =       0.000438882792
  error estimate for blocks of size 2^( 5) =       0.000448962779
  error estimate for blocks of size 2^( 6) =       0.000457793174
  error estimate for blocks of size 2^( 7) =       0.000461468926

      target function =                  N/A
              le_mean =     -16.906991226456
             les_mean =     286.178138079289
             stat err =       0.000451776918
             autocorr =       1.275124846587
              std dev =       0.565799659722
             le_variance =       0.320129254941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906991226456        initial  <--
     1.4552e+16     1.4552e+17             3.6511e-20       -16.906991226456
     5.8208e+16     5.8208e+17             8.8302e-21       -16.906991226456
     2.3283e+17     2.3283e+18             2.2075e-21       -16.906991226456

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0661
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3663e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8509
    reference variance = 0.25292
====================================================
  Execution time = 1.4597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3108e-01
  Total weights = 1.952348737e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319188959336
                                         uncertainty =       0.002490063573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319188959336
                                         uncertainty =       0.002490063573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399486942
  error estimate for blocks of size 2^( 2) =       0.000412587810
  error estimate for blocks of size 2^( 3) =       0.000425651524
  error estimate for blocks of size 2^( 4) =       0.000438323295
  error estimate for blocks of size 2^( 5) =       0.000449126987
  error estimate for blocks of size 2^( 6) =       0.000456435773
  error estimate for blocks of size 2^( 7) =       0.000459190604

      target function =                  N/A
              le_mean =     -16.906013926427
             les_mean =     286.144389112468
             stat err =       0.000450769165
             autocorr =       1.273219327829
              std dev =       0.564959851953
             le_variance =       0.319179634319


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601392643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+17, overlap shift 1.4552e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906013926439       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906013926439       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+17, overlap shift 5.8208e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906013926439       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906013926439       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+17 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+18, overlap shift 2.3283e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906013926439       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906013926439       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220579 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7221e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8457
    reference variance = 0.24305
====================================================
  Execution time = 1.4349e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3815e-01
  Total weights = 1.9521e+06
  Execution time = 1.9201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403262935
  error estimate for blocks of size 2^( 2) =       0.000416078490
  error estimate for blocks of size 2^( 3) =       0.000429170897
  error estimate for blocks of size 2^( 4) =       0.000441127433
  error estimate for blocks of size 2^( 5) =       0.000451523148
  error estimate for blocks of size 2^( 6) =       0.000460905454
  error estimate for blocks of size 2^( 7) =       0.000465689600

      target function =                  N/A
              le_mean =     -16.907268976592
             les_mean =     286.193892661758
             stat err =       0.000454811409
             autocorr =       1.271996996479
              std dev =       0.570299912531
             le_variance =       0.325241990233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403262935
  error estimate for blocks of size 2^( 2) =       0.000416078490
  error estimate for blocks of size 2^( 3) =       0.000429170897
  error estimate for blocks of size 2^( 4) =       0.000441127433
  error estimate for blocks of size 2^( 5) =       0.000451523148
  error estimate for blocks of size 2^( 6) =       0.000460905454
  error estimate for blocks of size 2^( 7) =       0.000465689600

      target function =                  N/A
              le_mean =     -16.907268976592
             les_mean =     286.193892661758
             stat err =       0.000454811409
             autocorr =       1.271996996479
              std dev =       0.570299912531
             le_variance =       0.325241990233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403262935
  error estimate for blocks of size 2^( 2) =       0.000416078490
  error estimate for blocks of size 2^( 3) =       0.000429170897
  error estimate for blocks of size 2^( 4) =       0.000441127433
  error estimate for blocks of size 2^( 5) =       0.000451523148
  error estimate for blocks of size 2^( 6) =       0.000460905454
  error estimate for blocks of size 2^( 7) =       0.000465689600

      target function =                  N/A
              le_mean =     -16.907268976592
             les_mean =     286.193892661758
             stat err =       0.000454811409
             autocorr =       1.271996996479
              std dev =       0.570299912531
             le_variance =       0.325241990233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325249157058
                                         uncertainty =       0.002573289809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403262935
  error estimate for blocks of size 2^( 2) =       0.000416078490
  error estimate for blocks of size 2^( 3) =       0.000429170897
  error estimate for blocks of size 2^( 4) =       0.000441127433
  error estimate for blocks of size 2^( 5) =       0.000451523148
  error estimate for blocks of size 2^( 6) =       0.000460905454
  error estimate for blocks of size 2^( 7) =       0.000465689600

      target function =                  N/A
              le_mean =     -16.907268976592
             les_mean =     286.193892661758
             stat err =       0.000454811409
             autocorr =       1.271996996479
              std dev =       0.570299912531
             le_variance =       0.325241990233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907268976592        initial  <--
     1.4552e+17     1.4552e+18             0.0000e+00       -16.907268976592
     5.8208e+17     5.8208e+18             0.0000e+00       -16.907268976592
     2.3283e+18     2.3283e+19             0.0000e+00       -16.907268976592

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0191
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.9091
    reference variance = 0.165512
====================================================
  Execution time = 1.4546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3194e-01
  Total weights = 1.951471735e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320656915448
                                         uncertainty =       0.002192571323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320656915448
                                         uncertainty =       0.002192571323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400512418
  error estimate for blocks of size 2^( 2) =       0.000413665785
  error estimate for blocks of size 2^( 3) =       0.000426829866
  error estimate for blocks of size 2^( 4) =       0.000439805473
  error estimate for blocks of size 2^( 5) =       0.000451422209
  error estimate for blocks of size 2^( 6) =       0.000460339149
  error estimate for blocks of size 2^( 7) =       0.000468063065

      target function =                  N/A
              le_mean =     -16.906325673533
             les_mean =     286.155790062120
             stat err =       0.000454907474
             autocorr =       1.290072661895
              std dev =       0.566410093855
             le_variance =       0.320820394421


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632567353e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+18, overlap shift 1.4552e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325673542       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325673542       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+18, overlap shift 5.8208e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325673542       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325673542       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+18 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+19, overlap shift 2.3283e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906325673542       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906325673542       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+19 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7158e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8908
    reference variance = 0.45815
====================================================
  Execution time = 1.4375e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3737e-01
  Total weights = 1.9515e+06
  Execution time = 1.9074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401880859
  error estimate for blocks of size 2^( 2) =       0.000414775350
  error estimate for blocks of size 2^( 3) =       0.000428233815
  error estimate for blocks of size 2^( 4) =       0.000440047739
  error estimate for blocks of size 2^( 5) =       0.000449910329
  error estimate for blocks of size 2^( 6) =       0.000457986705
  error estimate for blocks of size 2^( 7) =       0.000462027764

      target function =                  N/A
              le_mean =     -16.906166538284
             les_mean =     286.155840304422
             stat err =       0.000452493134
             autocorr =       1.267737519149
              std dev =       0.568345361685
             le_variance =       0.323016450148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401880859
  error estimate for blocks of size 2^( 2) =       0.000414775350
  error estimate for blocks of size 2^( 3) =       0.000428233815
  error estimate for blocks of size 2^( 4) =       0.000440047739
  error estimate for blocks of size 2^( 5) =       0.000449910329
  error estimate for blocks of size 2^( 6) =       0.000457986705
  error estimate for blocks of size 2^( 7) =       0.000462027764

      target function =                  N/A
              le_mean =     -16.906166538284
             les_mean =     286.155840304422
             stat err =       0.000452493134
             autocorr =       1.267737519149
              std dev =       0.568345361685
             le_variance =       0.323016450148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401880859
  error estimate for blocks of size 2^( 2) =       0.000414775350
  error estimate for blocks of size 2^( 3) =       0.000428233815
  error estimate for blocks of size 2^( 4) =       0.000440047739
  error estimate for blocks of size 2^( 5) =       0.000449910329
  error estimate for blocks of size 2^( 6) =       0.000457986705
  error estimate for blocks of size 2^( 7) =       0.000462027764

      target function =                  N/A
              le_mean =     -16.906166538284
             les_mean =     286.155840304422
             stat err =       0.000452493134
             autocorr =       1.267737519149
              std dev =       0.568345361685
             le_variance =       0.323016450148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323062633021
                                         uncertainty =       0.002175967694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401880859
  error estimate for blocks of size 2^( 2) =       0.000414775350
  error estimate for blocks of size 2^( 3) =       0.000428233815
  error estimate for blocks of size 2^( 4) =       0.000440047739
  error estimate for blocks of size 2^( 5) =       0.000449910329
  error estimate for blocks of size 2^( 6) =       0.000457986705
  error estimate for blocks of size 2^( 7) =       0.000462027764

      target function =                  N/A
              le_mean =     -16.906166538284
             les_mean =     286.155840304422
             stat err =       0.000452493134
             autocorr =       1.267737519149
              std dev =       0.568345361685
             le_variance =       0.323016450148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906166538284        initial  <--
     1.4552e+18     1.4552e+19             0.0000e+00       -16.906166538284
     5.8208e+18     5.8208e+19             0.0000e+00       -16.906166538284
     2.3283e+19     2.3283e+20             0.0000e+00       -16.906166538284

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.0185
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9083
    reference variance = 0.216649
====================================================
  Execution time = 1.4641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4165e-01
  Total weights = 1.952059775e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321180334670
                                         uncertainty =       0.001939419058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321180334670
                                         uncertainty =       0.001939419058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400673042
  error estimate for blocks of size 2^( 2) =       0.000414017000
  error estimate for blocks of size 2^( 3) =       0.000426933561
  error estimate for blocks of size 2^( 4) =       0.000439491947
  error estimate for blocks of size 2^( 5) =       0.000449196202
  error estimate for blocks of size 2^( 6) =       0.000457285796
  error estimate for blocks of size 2^( 7) =       0.000462097553

      target function =                  N/A
              le_mean =     -16.906239297394
             les_mean =     286.162580690158
             stat err =       0.000452017874
             autocorr =       1.272714436736
              std dev =       0.566637250360
             le_variance =       0.321077773495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623929739e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+19, overlap shift 1.4552e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239297403       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239297403       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239297403       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+19 is 3.828437e-23

solving harmonic davidson linear method for identity shift 5.8208e+19, overlap shift 5.8208e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239297403       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239297403       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239297403       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906239297403       residual = 1.72e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+19 is 9.597578e-24

solving harmonic davidson linear method for identity shift 2.3283e+20, overlap shift 2.3283e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906239297403       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906239297403       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239297403       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+20 is 2.407756e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7243e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.154848
====================================================
  Execution time = 1.3992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3453e-01
  Total weights = 1.9518e+06
  Execution time = 1.9001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400870518
  error estimate for blocks of size 2^( 2) =       0.000413537274
  error estimate for blocks of size 2^( 3) =       0.000426085510
  error estimate for blocks of size 2^( 4) =       0.000438032393
  error estimate for blocks of size 2^( 5) =       0.000447490928
  error estimate for blocks of size 2^( 6) =       0.000453301923
  error estimate for blocks of size 2^( 7) =       0.000457317564

      target function =                  N/A
              le_mean =     -16.906227355998
             les_mean =     286.155049597248
             stat err =       0.000449035702
             autocorr =       1.254739323308
              std dev =       0.566916523924
             le_variance =       0.321394345098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400870518
  error estimate for blocks of size 2^( 2) =       0.000413537274
  error estimate for blocks of size 2^( 3) =       0.000426085510
  error estimate for blocks of size 2^( 4) =       0.000438032393
  error estimate for blocks of size 2^( 5) =       0.000447490928
  error estimate for blocks of size 2^( 6) =       0.000453301923
  error estimate for blocks of size 2^( 7) =       0.000457317564

      target function =                  N/A
              le_mean =     -16.906227355998
             les_mean =     286.155049597248
             stat err =       0.000449035702
             autocorr =       1.254739323308
              std dev =       0.566916523924
             le_variance =       0.321394345098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400870518
  error estimate for blocks of size 2^( 2) =       0.000413537274
  error estimate for blocks of size 2^( 3) =       0.000426085510
  error estimate for blocks of size 2^( 4) =       0.000438032393
  error estimate for blocks of size 2^( 5) =       0.000447490928
  error estimate for blocks of size 2^( 6) =       0.000453301923
  error estimate for blocks of size 2^( 7) =       0.000457317564

      target function =                  N/A
              le_mean =     -16.906227355998
             les_mean =     286.155049597248
             stat err =       0.000449035702
             autocorr =       1.254739323308
              std dev =       0.566916523924
             le_variance =       0.321394345098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321472397835
                                         uncertainty =       0.002574668862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400870518
  error estimate for blocks of size 2^( 2) =       0.000413537274
  error estimate for blocks of size 2^( 3) =       0.000426085510
  error estimate for blocks of size 2^( 4) =       0.000438032393
  error estimate for blocks of size 2^( 5) =       0.000447490928
  error estimate for blocks of size 2^( 6) =       0.000453301923
  error estimate for blocks of size 2^( 7) =       0.000457317564

      target function =                  N/A
              le_mean =     -16.906227355998
             les_mean =     286.155049597248
             stat err =       0.000449035702
             autocorr =       1.254739323308
              std dev =       0.566916523924
             le_variance =       0.321394345098


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906227355998        initial  <--
     1.4552e+19     1.4552e+20             3.8284e-23       -16.906227355998
     5.8208e+19     5.8208e+20             9.5976e-24       -16.906227355998
     2.3283e+20     2.3283e+21             2.4078e-24       -16.906227355998

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5851
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.508863
====================================================
  Execution time = 1.4426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3378e-01
  Total weights = 1.951906044e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5773e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319919345136
                                         uncertainty =       0.001887026513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319919345136
                                         uncertainty =       0.001887026513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399914619
  error estimate for blocks of size 2^( 2) =       0.000413207925
  error estimate for blocks of size 2^( 3) =       0.000426261079
  error estimate for blocks of size 2^( 4) =       0.000438314144
  error estimate for blocks of size 2^( 5) =       0.000449067064
  error estimate for blocks of size 2^( 6) =       0.000457913415
  error estimate for blocks of size 2^( 7) =       0.000465310500

      target function =                  N/A
              le_mean =     -16.905775971539
             les_mean =     286.139037552666
             stat err =       0.000452651281
             autocorr =       1.281129250241
              std dev =       0.565564677846
             le_variance =       0.319863404827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577597154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+20, overlap shift 1.4552e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905775971576       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905775971576       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+20, overlap shift 5.8208e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905775971576       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905775971576       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+21, overlap shift 2.3283e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905775971576       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905775971576       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7009e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.0179
    reference variance = 0.326053
====================================================
  Execution time = 1.4196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3097e-01
  Total weights = 1.9517e+06
  Execution time = 1.8919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399730029
  error estimate for blocks of size 2^( 2) =       0.000412580291
  error estimate for blocks of size 2^( 3) =       0.000426000361
  error estimate for blocks of size 2^( 4) =       0.000437865954
  error estimate for blocks of size 2^( 5) =       0.000447325642
  error estimate for blocks of size 2^( 6) =       0.000454938019
  error estimate for blocks of size 2^( 7) =       0.000456600456

      target function =                  N/A
              le_mean =     -16.906331866349
             les_mean =     286.155024512684
             stat err =       0.000449182518
             autocorr =       1.262734773538
              std dev =       0.565303628152
             le_variance =       0.319568192002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399730029
  error estimate for blocks of size 2^( 2) =       0.000412580291
  error estimate for blocks of size 2^( 3) =       0.000426000361
  error estimate for blocks of size 2^( 4) =       0.000437865954
  error estimate for blocks of size 2^( 5) =       0.000447325642
  error estimate for blocks of size 2^( 6) =       0.000454938019
  error estimate for blocks of size 2^( 7) =       0.000456600456

      target function =                  N/A
              le_mean =     -16.906331866349
             les_mean =     286.155024512684
             stat err =       0.000449182518
             autocorr =       1.262734773538
              std dev =       0.565303628152
             le_variance =       0.319568192002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399730029
  error estimate for blocks of size 2^( 2) =       0.000412580291
  error estimate for blocks of size 2^( 3) =       0.000426000361
  error estimate for blocks of size 2^( 4) =       0.000437865954
  error estimate for blocks of size 2^( 5) =       0.000447325642
  error estimate for blocks of size 2^( 6) =       0.000454938019
  error estimate for blocks of size 2^( 7) =       0.000456600456

      target function =                  N/A
              le_mean =     -16.906331866349
             les_mean =     286.155024512684
             stat err =       0.000449182518
             autocorr =       1.262734773538
              std dev =       0.565303628152
             le_variance =       0.319568192002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319615785209
                                         uncertainty =       0.002178427729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399730029
  error estimate for blocks of size 2^( 2) =       0.000412580291
  error estimate for blocks of size 2^( 3) =       0.000426000361
  error estimate for blocks of size 2^( 4) =       0.000437865954
  error estimate for blocks of size 2^( 5) =       0.000447325642
  error estimate for blocks of size 2^( 6) =       0.000454938019
  error estimate for blocks of size 2^( 7) =       0.000456600456

      target function =                  N/A
              le_mean =     -16.906331866349
             les_mean =     286.155024512684
             stat err =       0.000449182518
             autocorr =       1.262734773538
              std dev =       0.565303628152
             le_variance =       0.319568192002


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906331866349        initial  <--
     1.4552e+20     1.4552e+21             0.0000e+00       -16.906331866349
     5.8208e+20     5.8208e+21             0.0000e+00       -16.906331866349
     2.3283e+21     2.3283e+22             0.0000e+00       -16.906331866349

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7823
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0816e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8937
    reference variance = 0.228728
====================================================
  Execution time = 1.4336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3732e-01
  Total weights = 1.951560401e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323996559620
                                         uncertainty =       0.002343573393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323996559620
                                         uncertainty =       0.002343573393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402463367
  error estimate for blocks of size 2^( 2) =       0.000415434323
  error estimate for blocks of size 2^( 3) =       0.000428658207
  error estimate for blocks of size 2^( 4) =       0.000440335227
  error estimate for blocks of size 2^( 5) =       0.000450808654
  error estimate for blocks of size 2^( 6) =       0.000460684361
  error estimate for blocks of size 2^( 7) =       0.000462825774

      target function =                  N/A
              le_mean =     -16.906814912078
             les_mean =     286.177710632859
             stat err =       0.000453663504
             autocorr =       1.270617912615
              std dev =       0.569169152103
             le_variance =       0.323953523706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690681491208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+21, overlap shift 1.4552e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906814912093       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906814912093       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+21, overlap shift 5.8208e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906814912093       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906814912093       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+22, overlap shift 2.3283e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906814912093       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906814912093       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225109 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6942e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9043
    reference variance = 0.167244
====================================================
  Execution time = 1.4182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3882e-01
  Total weights = 1.9519e+06
  Execution time = 1.8917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404063059
  error estimate for blocks of size 2^( 2) =       0.000417152901
  error estimate for blocks of size 2^( 3) =       0.000430567449
  error estimate for blocks of size 2^( 4) =       0.000442915651
  error estimate for blocks of size 2^( 5) =       0.000454212573
  error estimate for blocks of size 2^( 6) =       0.000459866761
  error estimate for blocks of size 2^( 7) =       0.000466864166

      target function =                  N/A
              le_mean =     -16.905711552005
             les_mean =     286.141905294861
             stat err =       0.000455964788
             autocorr =       1.273398445114
              std dev =       0.571431458181
             le_variance =       0.326533911399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404063059
  error estimate for blocks of size 2^( 2) =       0.000417152901
  error estimate for blocks of size 2^( 3) =       0.000430567449
  error estimate for blocks of size 2^( 4) =       0.000442915651
  error estimate for blocks of size 2^( 5) =       0.000454212573
  error estimate for blocks of size 2^( 6) =       0.000459866761
  error estimate for blocks of size 2^( 7) =       0.000466864166

      target function =                  N/A
              le_mean =     -16.905711552005
             les_mean =     286.141905294861
             stat err =       0.000455964788
             autocorr =       1.273398445114
              std dev =       0.571431458181
             le_variance =       0.326533911399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404063059
  error estimate for blocks of size 2^( 2) =       0.000417152901
  error estimate for blocks of size 2^( 3) =       0.000430567449
  error estimate for blocks of size 2^( 4) =       0.000442915651
  error estimate for blocks of size 2^( 5) =       0.000454212573
  error estimate for blocks of size 2^( 6) =       0.000459866761
  error estimate for blocks of size 2^( 7) =       0.000466864166

      target function =                  N/A
              le_mean =     -16.905711552005
             les_mean =     286.141905294861
             stat err =       0.000455964788
             autocorr =       1.273398445114
              std dev =       0.571431458181
             le_variance =       0.326533911399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326603563150
                                         uncertainty =       0.004237011173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404063059
  error estimate for blocks of size 2^( 2) =       0.000417152901
  error estimate for blocks of size 2^( 3) =       0.000430567449
  error estimate for blocks of size 2^( 4) =       0.000442915651
  error estimate for blocks of size 2^( 5) =       0.000454212573
  error estimate for blocks of size 2^( 6) =       0.000459866761
  error estimate for blocks of size 2^( 7) =       0.000466864166

      target function =                  N/A
              le_mean =     -16.905711552005
             les_mean =     286.141905294861
             stat err =       0.000455964788
             autocorr =       1.273398445114
              std dev =       0.571431458181
             le_variance =       0.326533911399


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905711552005        initial  <--
     1.4552e+21     1.4552e+22             0.0000e+00       -16.905711552005
     5.8208e+21     5.8208e+22             0.0000e+00       -16.905711552005
     2.3283e+22     2.3283e+23             0.0000e+00       -16.905711552005

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7563
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0705e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.9036
    reference variance = 0.1636
====================================================
  Execution time = 1.4461e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5696e-01
  Total weights = 1.951636333e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323201828141
                                         uncertainty =       0.002381424317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323201828141
                                         uncertainty =       0.002381424317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401951510
  error estimate for blocks of size 2^( 2) =       0.000414852684
  error estimate for blocks of size 2^( 3) =       0.000428105756
  error estimate for blocks of size 2^( 4) =       0.000440697045
  error estimate for blocks of size 2^( 5) =       0.000451135112
  error estimate for blocks of size 2^( 6) =       0.000459246258
  error estimate for blocks of size 2^( 7) =       0.000466696577

      target function =                  N/A
              le_mean =     -16.905617824368
             les_mean =     286.156876984875
             stat err =       0.000454443748
             autocorr =       1.278241565194
              std dev =       0.568445277520
             le_variance =       0.323130033535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561782437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+22, overlap shift 1.4552e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905617824357       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905617824357       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+22, overlap shift 5.8208e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905617824357       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905617824357       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+23, overlap shift 2.3283e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905617824357       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905617824357       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7074e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8744
    reference variance = 0.350869
====================================================
  Execution time = 1.4193e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4747e-01
  Total weights = 1.9518e+06
  Execution time = 1.9179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402427149
  error estimate for blocks of size 2^( 2) =       0.000415322866
  error estimate for blocks of size 2^( 3) =       0.000428100986
  error estimate for blocks of size 2^( 4) =       0.000439910302
  error estimate for blocks of size 2^( 5) =       0.000449911899
  error estimate for blocks of size 2^( 6) =       0.000456063542
  error estimate for blocks of size 2^( 7) =       0.000462962313

      target function =                  N/A
              le_mean =     -16.906327647213
             les_mean =     286.171388832954
             stat err =       0.000452212014
             autocorr =       1.262727531060
              std dev =       0.569117931463
             le_variance =       0.323895219912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402427149
  error estimate for blocks of size 2^( 2) =       0.000415322866
  error estimate for blocks of size 2^( 3) =       0.000428100986
  error estimate for blocks of size 2^( 4) =       0.000439910302
  error estimate for blocks of size 2^( 5) =       0.000449911899
  error estimate for blocks of size 2^( 6) =       0.000456063542
  error estimate for blocks of size 2^( 7) =       0.000462962313

      target function =                  N/A
              le_mean =     -16.906327647213
             les_mean =     286.171388832954
             stat err =       0.000452212014
             autocorr =       1.262727531060
              std dev =       0.569117931463
             le_variance =       0.323895219912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402427149
  error estimate for blocks of size 2^( 2) =       0.000415322866
  error estimate for blocks of size 2^( 3) =       0.000428100986
  error estimate for blocks of size 2^( 4) =       0.000439910302
  error estimate for blocks of size 2^( 5) =       0.000449911899
  error estimate for blocks of size 2^( 6) =       0.000456063542
  error estimate for blocks of size 2^( 7) =       0.000462962313

      target function =                  N/A
              le_mean =     -16.906327647213
             les_mean =     286.171388832954
             stat err =       0.000452212014
             autocorr =       1.262727531060
              std dev =       0.569117931463
             le_variance =       0.323895219912

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323911868269
                                         uncertainty =       0.003332585748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402427149
  error estimate for blocks of size 2^( 2) =       0.000415322866
  error estimate for blocks of size 2^( 3) =       0.000428100986
  error estimate for blocks of size 2^( 4) =       0.000439910302
  error estimate for blocks of size 2^( 5) =       0.000449911899
  error estimate for blocks of size 2^( 6) =       0.000456063542
  error estimate for blocks of size 2^( 7) =       0.000462962313

      target function =                  N/A
              le_mean =     -16.906327647213
             les_mean =     286.171388832954
             stat err =       0.000452212014
             autocorr =       1.262727531060
              std dev =       0.569117931463
             le_variance =       0.323895219912


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906327647213        initial  <--
     1.4552e+22     1.4552e+23             0.0000e+00       -16.906327647213
     5.8208e+22     5.8208e+23             0.0000e+00       -16.906327647213
     2.3283e+23     2.3283e+24             0.0000e+00       -16.906327647213

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8522
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0932e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.8593
    reference variance = 0.168794
====================================================
  Execution time = 1.4347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3432e-01
  Total weights = 1.951925683e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321181724598
                                         uncertainty =       0.002246246252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321181724598
                                         uncertainty =       0.002246246252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700381
  error estimate for blocks of size 2^( 2) =       0.000413715687
  error estimate for blocks of size 2^( 3) =       0.000427948372
  error estimate for blocks of size 2^( 4) =       0.000441785946
  error estimate for blocks of size 2^( 5) =       0.000453280473
  error estimate for blocks of size 2^( 6) =       0.000462193260
  error estimate for blocks of size 2^( 7) =       0.000467436325

      target function =                  N/A
              le_mean =     -16.906194005713
             les_mean =     286.153714360569
             stat err =       0.000456174001
             autocorr =       1.296049378460
              std dev =       0.566675913615
             le_variance =       0.321121591071


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690619400571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+23, overlap shift 1.4552e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194005689       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194005689       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+23, overlap shift 5.8208e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194005689       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194005689       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+24, overlap shift 2.3283e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906194005689       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906194005689       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7030e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9062
    reference variance = 0.216511
====================================================
  Execution time = 1.6402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3273e-01
  Total weights = 1.9518e+06
  Execution time = 1.9189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401032337
  error estimate for blocks of size 2^( 2) =       0.000414197018
  error estimate for blocks of size 2^( 3) =       0.000427737400
  error estimate for blocks of size 2^( 4) =       0.000439936354
  error estimate for blocks of size 2^( 5) =       0.000450845507
  error estimate for blocks of size 2^( 6) =       0.000459397442
  error estimate for blocks of size 2^( 7) =       0.000465436250

      target function =                  N/A
              le_mean =     -16.906677953650
             les_mean =     286.168485973895
             stat err =       0.000453903888
             autocorr =       1.281058668949
              std dev =       0.567145370028
             le_variance =       0.321653870744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401032337
  error estimate for blocks of size 2^( 2) =       0.000414197018
  error estimate for blocks of size 2^( 3) =       0.000427737400
  error estimate for blocks of size 2^( 4) =       0.000439936354
  error estimate for blocks of size 2^( 5) =       0.000450845507
  error estimate for blocks of size 2^( 6) =       0.000459397442
  error estimate for blocks of size 2^( 7) =       0.000465436250

      target function =                  N/A
              le_mean =     -16.906677953650
             les_mean =     286.168485973895
             stat err =       0.000453903888
             autocorr =       1.281058668949
              std dev =       0.567145370028
             le_variance =       0.321653870744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401032337
  error estimate for blocks of size 2^( 2) =       0.000414197018
  error estimate for blocks of size 2^( 3) =       0.000427737400
  error estimate for blocks of size 2^( 4) =       0.000439936354
  error estimate for blocks of size 2^( 5) =       0.000450845507
  error estimate for blocks of size 2^( 6) =       0.000459397442
  error estimate for blocks of size 2^( 7) =       0.000465436250

      target function =                  N/A
              le_mean =     -16.906677953650
             les_mean =     286.168485973895
             stat err =       0.000453903888
             autocorr =       1.281058668949
              std dev =       0.567145370028
             le_variance =       0.321653870744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321594988152
                                         uncertainty =       0.001954624727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401032337
  error estimate for blocks of size 2^( 2) =       0.000414197018
  error estimate for blocks of size 2^( 3) =       0.000427737400
  error estimate for blocks of size 2^( 4) =       0.000439936354
  error estimate for blocks of size 2^( 5) =       0.000450845507
  error estimate for blocks of size 2^( 6) =       0.000459397442
  error estimate for blocks of size 2^( 7) =       0.000465436250

      target function =                  N/A
              le_mean =     -16.906677953650
             les_mean =     286.168485973895
             stat err =       0.000453903888
             autocorr =       1.281058668949
              std dev =       0.567145370028
             le_variance =       0.321653870744


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906677953650        initial  <--
     1.4552e+23     1.4552e+24             0.0000e+00       -16.906677953650
     5.8208e+23     5.8208e+24             0.0000e+00       -16.906677953650
     2.3283e+24     2.3283e+25             0.0000e+00       -16.906677953650

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.0653
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8554
    reference variance = 0.286994
====================================================
  Execution time = 1.4503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2942e-01
  Total weights = 1.951687796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315106431748
                                         uncertainty =       0.001918597771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315106431748
                                         uncertainty =       0.001918597771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396936667
  error estimate for blocks of size 2^( 2) =       0.000409604535
  error estimate for blocks of size 2^( 3) =       0.000422465209
  error estimate for blocks of size 2^( 4) =       0.000434712768
  error estimate for blocks of size 2^( 5) =       0.000445680268
  error estimate for blocks of size 2^( 6) =       0.000452527992
  error estimate for blocks of size 2^( 7) =       0.000459628219

      target function =                  N/A
              le_mean =     -16.906029395783
             les_mean =     286.143247874059
             stat err =       0.000448137312
             autocorr =       1.274617195289
              std dev =       0.561353217578
             le_variance =       0.315117434885


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602939578e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+24, overlap shift 1.4552e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029395814       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029395814       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+24, overlap shift 5.8208e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029395814       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029395814       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+25, overlap shift 2.3283e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906029395814       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906029395814       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228245 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7103e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.8492
    reference variance = 0.202491
====================================================
  Execution time = 1.3958e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3784e-01
  Total weights = 1.9517e+06
  Execution time = 1.9186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403103281
  error estimate for blocks of size 2^( 2) =       0.000416028801
  error estimate for blocks of size 2^( 3) =       0.000429184426
  error estimate for blocks of size 2^( 4) =       0.000442188376
  error estimate for blocks of size 2^( 5) =       0.000453442267
  error estimate for blocks of size 2^( 6) =       0.000461446206
  error estimate for blocks of size 2^( 7) =       0.000467412741

      target function =                  N/A
              le_mean =     -16.906729212508
             les_mean =     286.175327949082
             stat err =       0.000456122398
             autocorr =       1.280354200299
              std dev =       0.570074127268
             le_variance =       0.324984510580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403103281
  error estimate for blocks of size 2^( 2) =       0.000416028801
  error estimate for blocks of size 2^( 3) =       0.000429184426
  error estimate for blocks of size 2^( 4) =       0.000442188376
  error estimate for blocks of size 2^( 5) =       0.000453442267
  error estimate for blocks of size 2^( 6) =       0.000461446206
  error estimate for blocks of size 2^( 7) =       0.000467412741

      target function =                  N/A
              le_mean =     -16.906729212508
             les_mean =     286.175327949082
             stat err =       0.000456122398
             autocorr =       1.280354200299
              std dev =       0.570074127268
             le_variance =       0.324984510580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403103281
  error estimate for blocks of size 2^( 2) =       0.000416028801
  error estimate for blocks of size 2^( 3) =       0.000429184426
  error estimate for blocks of size 2^( 4) =       0.000442188376
  error estimate for blocks of size 2^( 5) =       0.000453442267
  error estimate for blocks of size 2^( 6) =       0.000461446206
  error estimate for blocks of size 2^( 7) =       0.000467412741

      target function =                  N/A
              le_mean =     -16.906729212508
             les_mean =     286.175327949082
             stat err =       0.000456122398
             autocorr =       1.280354200299
              std dev =       0.570074127268
             le_variance =       0.324984510580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324982674905
                                         uncertainty =       0.002342597043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403103281
  error estimate for blocks of size 2^( 2) =       0.000416028801
  error estimate for blocks of size 2^( 3) =       0.000429184426
  error estimate for blocks of size 2^( 4) =       0.000442188376
  error estimate for blocks of size 2^( 5) =       0.000453442267
  error estimate for blocks of size 2^( 6) =       0.000461446206
  error estimate for blocks of size 2^( 7) =       0.000467412741

      target function =                  N/A
              le_mean =     -16.906729212508
             les_mean =     286.175327949082
             stat err =       0.000456122398
             autocorr =       1.280354200299
              std dev =       0.570074127268
             le_variance =       0.324984510580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906729212508        initial  <--
     1.4552e+24     1.4552e+25             0.0000e+00       -16.906729212508
     5.8208e+24     5.8208e+25             0.0000e+00       -16.906729212508
     2.3283e+25     2.3283e+26             0.0000e+00       -16.906729212508

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.6207
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9658
    reference variance = 0.332577
====================================================
  Execution time = 1.4471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3395e-01
  Total weights = 1.951775691e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322321671050
                                         uncertainty =       0.002792775099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322321671050
                                         uncertainty =       0.002792775099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401375857
  error estimate for blocks of size 2^( 2) =       0.000414445661
  error estimate for blocks of size 2^( 3) =       0.000427165360
  error estimate for blocks of size 2^( 4) =       0.000438959723
  error estimate for blocks of size 2^( 5) =       0.000448728329
  error estimate for blocks of size 2^( 6) =       0.000458012458
  error estimate for blocks of size 2^( 7) =       0.000463294822

      target function =                  N/A
              le_mean =     -16.906709189282
             les_mean =     286.170768477814
             stat err =       0.000452248833
             autocorr =       1.269557623413
              std dev =       0.567631180700
             le_variance =       0.322205157303


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690670918928e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+25, overlap shift 1.4552e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906709189283       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906709189283       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906709189283       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906709189283       residual = 2.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+25 is 2.871414e-29

solving harmonic davidson linear method for identity shift 5.8208e+25, overlap shift 5.8208e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906709189283       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906709189283       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906709189283       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906709189283       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906709189283       residual = 3.62e-12           smallest_sin_value = 1.00e+00
davidson solver converged in          4 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+25 is 7.178761e-30

solving harmonic davidson linear method for identity shift 2.3283e+26, overlap shift 2.3283e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906709189283       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906709189283       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906709189283       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906709189283       residual = 2.19e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+26 is 1.794634e-30

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7089e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.8671
    reference variance = 0.172947
====================================================
  Execution time = 1.3973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4186e-01
  Total weights = 1.9516e+06
  Execution time = 1.9214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178446
  error estimate for blocks of size 2^( 2) =       0.000417142524
  error estimate for blocks of size 2^( 3) =       0.000429571425
  error estimate for blocks of size 2^( 4) =       0.000440603513
  error estimate for blocks of size 2^( 5) =       0.000449384459
  error estimate for blocks of size 2^( 6) =       0.000456179442
  error estimate for blocks of size 2^( 7) =       0.000458482631

      target function =                  N/A
              le_mean =     -16.906173591182
             les_mean =     286.160566545004
             stat err =       0.000451162511
             autocorr =       1.246004786306
              std dev =       0.571594640352
             le_variance =       0.326720432879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178446
  error estimate for blocks of size 2^( 2) =       0.000417142524
  error estimate for blocks of size 2^( 3) =       0.000429571425
  error estimate for blocks of size 2^( 4) =       0.000440603513
  error estimate for blocks of size 2^( 5) =       0.000449384459
  error estimate for blocks of size 2^( 6) =       0.000456179442
  error estimate for blocks of size 2^( 7) =       0.000458482631

      target function =                  N/A
              le_mean =     -16.906173591182
             les_mean =     286.160566545004
             stat err =       0.000451162511
             autocorr =       1.246004786307
              std dev =       0.571594640352
             le_variance =       0.326720432879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178446
  error estimate for blocks of size 2^( 2) =       0.000417142524
  error estimate for blocks of size 2^( 3) =       0.000429571425
  error estimate for blocks of size 2^( 4) =       0.000440603513
  error estimate for blocks of size 2^( 5) =       0.000449384459
  error estimate for blocks of size 2^( 6) =       0.000456179442
  error estimate for blocks of size 2^( 7) =       0.000458482631

      target function =                  N/A
              le_mean =     -16.906173591182
             les_mean =     286.160566545004
             stat err =       0.000451162511
             autocorr =       1.246004786307
              std dev =       0.571594640352
             le_variance =       0.326720432879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326747771504
                                         uncertainty =       0.007606290676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404178446
  error estimate for blocks of size 2^( 2) =       0.000417142524
  error estimate for blocks of size 2^( 3) =       0.000429571425
  error estimate for blocks of size 2^( 4) =       0.000440603513
  error estimate for blocks of size 2^( 5) =       0.000449384459
  error estimate for blocks of size 2^( 6) =       0.000456179442
  error estimate for blocks of size 2^( 7) =       0.000458482631

      target function =                  N/A
              le_mean =     -16.906173591182
             les_mean =     286.160566545004
             stat err =       0.000451162511
             autocorr =       1.246004786307
              std dev =       0.571594640352
             le_variance =       0.326720432879


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906173591182        initial  <--
     1.4552e+25     1.4552e+26             2.8714e-29       -16.906173591182
     5.8208e+25     5.8208e+26             7.1788e-30       -16.906173591182
     2.3283e+26     2.3283e+27             1.7946e-30       -16.906173591182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7720
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0867e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.7909
    reference variance = 0.503516
====================================================
  Execution time = 1.4438e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3331e-01
  Total weights = 1.951638433e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322449419072
                                         uncertainty =       0.002262631005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322449419072
                                         uncertainty =       0.002262631005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401501655
  error estimate for blocks of size 2^( 2) =       0.000414188424
  error estimate for blocks of size 2^( 3) =       0.000427284675
  error estimate for blocks of size 2^( 4) =       0.000439661282
  error estimate for blocks of size 2^( 5) =       0.000449677151
  error estimate for blocks of size 2^( 6) =       0.000457111696
  error estimate for blocks of size 2^( 7) =       0.000461908745

      target function =                  N/A
              le_mean =     -16.905992017224
             les_mean =     286.145877432971
             stat err =       0.000452089719
             autocorr =       1.267869577723
              std dev =       0.567809085936
             le_variance =       0.322407158072


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599201722e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+26, overlap shift 1.4552e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992017244       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992017244       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+26, overlap shift 5.8208e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992017244       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992017244       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+27, overlap shift 2.3283e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905992017244       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992017244       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7050e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.825
    reference variance = 0.243126
====================================================
  Execution time = 1.4159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3548e-01
  Total weights = 1.9516e+06
  Execution time = 1.9230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399682415
  error estimate for blocks of size 2^( 2) =       0.000412603102
  error estimate for blocks of size 2^( 3) =       0.000425771338
  error estimate for blocks of size 2^( 4) =       0.000437820802
  error estimate for blocks of size 2^( 5) =       0.000448721144
  error estimate for blocks of size 2^( 6) =       0.000457141588
  error estimate for blocks of size 2^( 7) =       0.000459155106

      target function =                  N/A
              le_mean =     -16.905924745662
             les_mean =     286.145773499306
             stat err =       0.000450709660
             autocorr =       1.271638446363
              std dev =       0.565236292232
             le_variance =       0.319492066057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399682415
  error estimate for blocks of size 2^( 2) =       0.000412603102
  error estimate for blocks of size 2^( 3) =       0.000425771338
  error estimate for blocks of size 2^( 4) =       0.000437820802
  error estimate for blocks of size 2^( 5) =       0.000448721144
  error estimate for blocks of size 2^( 6) =       0.000457141588
  error estimate for blocks of size 2^( 7) =       0.000459155106

      target function =                  N/A
              le_mean =     -16.905924745662
             les_mean =     286.145773499306
             stat err =       0.000450709660
             autocorr =       1.271638446363
              std dev =       0.565236292232
             le_variance =       0.319492066057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399682415
  error estimate for blocks of size 2^( 2) =       0.000412603102
  error estimate for blocks of size 2^( 3) =       0.000425771338
  error estimate for blocks of size 2^( 4) =       0.000437820802
  error estimate for blocks of size 2^( 5) =       0.000448721144
  error estimate for blocks of size 2^( 6) =       0.000457141588
  error estimate for blocks of size 2^( 7) =       0.000459155106

      target function =                  N/A
              le_mean =     -16.905924745662
             les_mean =     286.145773499306
             stat err =       0.000450709660
             autocorr =       1.271638446363
              std dev =       0.565236292232
             le_variance =       0.319492066057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319530044568
                                         uncertainty =       0.002018591312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399682415
  error estimate for blocks of size 2^( 2) =       0.000412603102
  error estimate for blocks of size 2^( 3) =       0.000425771338
  error estimate for blocks of size 2^( 4) =       0.000437820802
  error estimate for blocks of size 2^( 5) =       0.000448721144
  error estimate for blocks of size 2^( 6) =       0.000457141588
  error estimate for blocks of size 2^( 7) =       0.000459155106

      target function =                  N/A
              le_mean =     -16.905924745662
             les_mean =     286.145773499306
             stat err =       0.000450709660
             autocorr =       1.271638446363
              std dev =       0.565236292232
             le_variance =       0.319492066057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905924745662        initial  <--
     1.4552e+26     1.4552e+27             0.0000e+00       -16.905924745662
     5.8208e+26     5.8208e+27             0.0000e+00       -16.905924745662
     2.3283e+27     2.3283e+28             0.0000e+00       -16.905924745662

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8373
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0894e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9094
    reference variance = 0.228845
====================================================
  Execution time = 1.4597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5220e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3175e-01
  Total weights = 1.951852031e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.6007e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318741768392
                                         uncertainty =       0.002290738385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318741768392
                                         uncertainty =       0.002290738385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399207372
  error estimate for blocks of size 2^( 2) =       0.000412109497
  error estimate for blocks of size 2^( 3) =       0.000424795045
  error estimate for blocks of size 2^( 4) =       0.000436208927
  error estimate for blocks of size 2^( 5) =       0.000446002245
  error estimate for blocks of size 2^( 6) =       0.000451032590
  error estimate for blocks of size 2^( 7) =       0.000457821031

      target function =                  N/A
              le_mean =     -16.906599513633
             les_mean =     286.164857095896
             stat err =       0.000447766198
             autocorr =       1.258072030209
              std dev =       0.564564479161
             le_variance =       0.318733051130


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659951363e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 74
Check correct_vf_var_size: 225, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+27, overlap shift 1.4552e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906599513631       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906599513631       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906599513633       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 1.4552e+27 is 2.077972e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.8208e+27, overlap shift 5.8208e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906599513631       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906599513631       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906599513633       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 5.8208e+27 is 5.194930e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+28, overlap shift 2.3283e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906599513631       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906599513631       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906599513631       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 75 and evec_eigen.size(): 75
The largest weight on the derivative vector for shift 2.3283e+28 is 1.298732e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232006 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 75 and numParams is: 74

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7204e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.362835
====================================================
  Execution time = 1.4147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3582e-01
  Total weights = 1.9520e+06
  Execution time = 1.9228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401218545
  error estimate for blocks of size 2^( 2) =       0.000414335690
  error estimate for blocks of size 2^( 3) =       0.000427045195
  error estimate for blocks of size 2^( 4) =       0.000439257017
  error estimate for blocks of size 2^( 5) =       0.000449752064
  error estimate for blocks of size 2^( 6) =       0.000457567857
  error estimate for blocks of size 2^( 7) =       0.000461814801

      target function =                  N/A
              le_mean =     -16.906194929995
             les_mean =     286.155243680998
             stat err =       0.000452097935
             autocorr =       1.269705642021
              std dev =       0.567408707450
             le_variance =       0.321952641290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401218545
  error estimate for blocks of size 2^( 2) =       0.000414335690
  error estimate for blocks of size 2^( 3) =       0.000427045195
  error estimate for blocks of size 2^( 4) =       0.000439257017
  error estimate for blocks of size 2^( 5) =       0.000449752064
  error estimate for blocks of size 2^( 6) =       0.000457567857
  error estimate for blocks of size 2^( 7) =       0.000461814801

      target function =                  N/A
              le_mean =     -16.906194929995
             les_mean =     286.155243680998
             stat err =       0.000452097935
             autocorr =       1.269705642021
              std dev =       0.567408707450
             le_variance =       0.321952641290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401218545
  error estimate for blocks of size 2^( 2) =       0.000414335690
  error estimate for blocks of size 2^( 3) =       0.000427045195
  error estimate for blocks of size 2^( 4) =       0.000439257017
  error estimate for blocks of size 2^( 5) =       0.000449752064
  error estimate for blocks of size 2^( 6) =       0.000457567857
  error estimate for blocks of size 2^( 7) =       0.000461814801

      target function =                  N/A
              le_mean =     -16.906194929995
             les_mean =     286.155243680998
             stat err =       0.000452097935
             autocorr =       1.269705642021
              std dev =       0.567408707450
             le_variance =       0.321952641290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321926317179
                                         uncertainty =       0.002298217836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401218545
  error estimate for blocks of size 2^( 2) =       0.000414335690
  error estimate for blocks of size 2^( 3) =       0.000427045195
  error estimate for blocks of size 2^( 4) =       0.000439257017
  error estimate for blocks of size 2^( 5) =       0.000449752064
  error estimate for blocks of size 2^( 6) =       0.000457567857
  error estimate for blocks of size 2^( 7) =       0.000461814801

      target function =                  N/A
              le_mean =     -16.906194929995
             les_mean =     286.155243680998
             stat err =       0.000452097935
             autocorr =       1.269705642021
              std dev =       0.567408707450
             le_variance =       0.321952641290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906194929995        initial  <--
     1.4552e+27     1.4552e+28             2.0780e-31       -16.906194929995
     5.8208e+27     5.8208e+28             5.1949e-32       -16.906194929995
     2.3283e+28     2.3283e+29             1.2987e-32       -16.906194929995

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8720
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_0001                 7.012142e-01 3 1  ON 0
ci_0002                 7.004434e-01 3 1  ON 1
ci_0003                -2.803611e-02 3 1  ON 2
ci_0004                -2.836960e-02 3 1  ON 3
ci_0005                -3.382123e-02 3 1  ON 4
ci_0006                -3.432936e-02 3 1  ON 5
ci_0007                -2.243925e-02 3 1  ON 6
ci_0008                -2.248614e-02 3 1  ON 7
ci_0009                -1.780714e-02 3 1  ON 8
ci_0010                -1.797377e-02 3 1  ON 9
ci_0011                -1.253501e-02 3 1  ON 10
ci_0012                -1.264452e-02 3 1  ON 11
ci_0013                 1.334700e-02 3 1  ON 12
ci_0014                 1.351657e-02 3 1  ON 13
ci_0015                 1.367580e-02 3 1  ON 14
ci_0016                 1.314718e-02 3 1  ON 15
ci_0017                 1.172437e-02 3 1  ON 16
ci_0018                 1.180668e-02 3 1  ON 17
ci_0019                 1.191142e-02 3 1  ON 18
ci_0020                 1.191818e-02 3 1  ON 19
ci_0021                 1.906872e-03 3 1  ON 20
ci_0022                 3.167958e-03 3 1  ON 21
ci_0023                -1.190776e-02 3 1  ON 22
ci_0024                -1.120047e-02 3 1  ON 23
ci_0025                -1.138630e-02 3 1  ON 24
ci_0026                -1.119612e-02 3 1  ON 25
ci_0027                -1.122351e-02 3 1  ON 26
ci_0028                -1.113536e-02 3 1  ON 27
ci_0029                -1.076263e-02 3 1  ON 28
ci_0030                -1.012564e-02 3 1  ON 29
ci_0031                 1.936873e-02 3 1  ON 30
ci_0032                 1.969207e-02 3 1  ON 31
ci_0033                 9.486999e-03 3 1  ON 32
ci_0034                 9.890797e-03 3 1  ON 33
ci_0035                 7.420146e-03 3 1  ON 34
ci_0036                 6.812310e-03 3 1  ON 35
ci_0037                -1.082792e-02 3 1  ON 36
ci_0038                -1.076232e-02 3 1  ON 37
ci_0039                -2.758334e-03 3 1  ON 38
ci_0040                -3.065914e-03 3 1  ON 39
ci_0041                 7.363372e-03 3 1  ON 40
ci_0042                 7.433511e-03 3 1  ON 41
ci_0043                -1.495996e-02 3 1  ON 42
ci_0044                -1.566296e-02 3 1  ON 43
ci_0045                 8.046330e-03 3 1  ON 44
ci_0046                 7.452012e-03 3 1  ON 45
ci_0047                -2.216721e-03 3 1  ON 46
ci_0048                -2.308251e-03 3 1  ON 47
ci_0049                -5.418289e-03 3 1  ON 48
ci_0050                -5.446535e-03 3 1  ON 49
ci_0051                -3.553548e-03 3 1  ON 50
ci_0052                -3.061727e-03 3 1  ON 51
ci_0053                -5.133365e-03 3 1  ON 52
ci_0054                -5.020677e-03 3 1  ON 53
ci_0055                 5.886805e-03 3 1  ON 54
ci_0056                 6.283086e-03 3 1  ON 55
ci_0057                 4.612852e-03 3 1  ON 56
ci_0058                 5.208815e-03 3 1  ON 57
ci_0059                -5.199304e-03 3 1  ON 58
ci_0060                -4.945635e-03 3 1  ON 59
ci_0061                -3.785419e-03 3 1  ON 60
ci_0062                -3.105397e-03 3 1  ON 61
ci_0063                -8.685494e-03 3 1  ON 62
ci_0064                -9.050640e-03 3 1  ON 63
ci_0065                -5.682375e-03 3 1  ON 64
ci_0066                -4.891114e-03 3 1  ON 65
ci_0067                -5.441945e-03 3 1  ON 66
ci_0068                -5.444432e-03 3 1  ON 67
ci_0069                 5.014817e-03 3 1  ON 68
ci_0070                 4.680716e-03 3 1  ON 69
ci_0071                 2.338674e-03 3 1  ON 70
ci_0072                 1.763892e-03 3 1  ON 71
ci_0073                 4.473100e-03 3 1  ON 72
ci_0074                 4.195141e-03 3 1  ON 73
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1082e+01 secs
  Total Execution time = 2.4986e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
