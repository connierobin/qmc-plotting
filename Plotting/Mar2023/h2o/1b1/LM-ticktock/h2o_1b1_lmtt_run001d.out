Rank =    0  Free Memory = 71432 MB
Rank =    1  Free Memory = 71432 MB
Rank =    2  Free Memory = 71432 MB
Rank =    3  Free Memory = 71432 MB
Rank =    4  Free Memory = 71432 MB
Rank =    5  Free Memory = 71432 MB
Rank =    6  Free Memory = 71432 MB
Rank =    7  Free Memory = 71432 MB
Rank =    8  Free Memory = 71432 MB
Rank =    9  Free Memory = 71431 MB
Rank =   10  Free Memory = 71431 MB
Rank =   11  Free Memory = 71431 MB
Rank =   12  Free Memory = 71430 MB
Rank =   13  Free Memory = 71430 MB
Rank =   14  Free Memory = 71430 MB
Rank =   15  Free Memory = 71416 MB
Rank =   16  Free Memory = 71416 MB
Rank =   17  Free Memory = 71416 MB
Rank =   18  Free Memory = 71416 MB
Rank =   19  Free Memory = 71416 MB
Rank =   20  Free Memory = 71416 MB
Rank =   21  Free Memory = 71416 MB
Rank =   22  Free Memory = 71416 MB
Rank =   23  Free Memory = 71416 MB
Rank =   24  Free Memory = 71416 MB
Rank =   25  Free Memory = 71416 MB
Rank =   26  Free Memory = 71416 MB
Rank =   27  Free Memory = 71416 MB
Rank =   28  Free Memory = 71416 MB
Rank =   29  Free Memory = 71416 MB
Rank =   30  Free Memory = 71416 MB
Rank =   31  Free Memory = 71416 MB
Rank =   32  Free Memory = 75732 MB
Rank =   33  Free Memory = 75732 MB
Rank =   34  Free Memory = 75732 MB
Rank =   35  Free Memory = 75732 MB
Rank =   36  Free Memory = 75732 MB
Rank =   37  Free Memory = 75732 MB
Rank =   38  Free Memory = 75732 MB
Rank =   39  Free Memory = 75732 MB
Rank =   40  Free Memory = 75732 MB
Rank =   41  Free Memory = 75732 MB
Rank =   42  Free Memory = 75732 MB
Rank =   43  Free Memory = 75732 MB
Rank =   44  Free Memory = 75732 MB
Rank =   45  Free Memory = 75732 MB
Rank =   46  Free Memory = 75732 MB
Rank =   47  Free Memory = 75732 MB
Rank =   48  Free Memory = 75732 MB
Rank =   49  Free Memory = 75732 MB
Rank =   50  Free Memory = 75732 MB
Rank =   51  Free Memory = 75732 MB
Rank =   52  Free Memory = 75732 MB
Rank =   53  Free Memory = 75732 MB
Rank =   54  Free Memory = 75732 MB
Rank =   55  Free Memory = 75732 MB
Rank =   56  Free Memory = 75732 MB
Rank =   57  Free Memory = 75732 MB
Rank =   58  Free Memory = 75732 MB
Rank =   59  Free Memory = 75732 MB
Rank =   60  Free Memory = 75732 MB
Rank =   61  Free Memory = 75732 MB
Rank =   62  Free Memory = 75732 MB
Rank =   63  Free Memory = 75732 MB
Rank =   64  Free Memory = 87297 MB
Rank =   65  Free Memory = 87297 MB
Rank =   66  Free Memory = 87297 MB
Rank =   67  Free Memory = 87297 MB
Rank =   68  Free Memory = 87297 MB
Rank =   69  Free Memory = 87297 MB
Rank =   70  Free Memory = 87297 MB
Rank =   71  Free Memory = 87297 MB
Rank =   72  Free Memory = 87297 MB
Rank =   73  Free Memory = 87297 MB
Rank =   74  Free Memory = 87297 MB
Rank =   75  Free Memory = 87297 MB
Rank =   76  Free Memory = 87297 MB
Rank =   77  Free Memory = 87297 MB
Rank =   78  Free Memory = 87297 MB
Rank =   79  Free Memory = 87297 MB
Rank =   80  Free Memory = 87297 MB
Rank =   81  Free Memory = 87297 MB
Rank =   82  Free Memory = 87297 MB
Rank =   83  Free Memory = 87297 MB
Rank =   84  Free Memory = 87297 MB
Rank =   85  Free Memory = 87297 MB
Rank =   86  Free Memory = 87297 MB
Rank =   87  Free Memory = 87297 MB
Rank =   88  Free Memory = 87297 MB
Rank =   89  Free Memory = 87297 MB
Rank =   90  Free Memory = 87297 MB
Rank =   91  Free Memory = 87297 MB
Rank =   92  Free Memory = 87297 MB
Rank =   93  Free Memory = 87297 MB
Rank =   94  Free Memory = 87297 MB
Rank =   95  Free Memory = 87297 MB
Rank =   96  Free Memory = 88259 MB
Rank =   97  Free Memory = 88259 MB
Rank =   98  Free Memory = 88259 MB
Rank =   99  Free Memory = 88259 MB
Rank =  100  Free Memory = 88259 MB
Rank =  101  Free Memory = 88259 MB
Rank =  102  Free Memory = 88259 MB
Rank =  103  Free Memory = 88259 MB
Rank =  104  Free Memory = 88259 MB
Rank =  105  Free Memory = 88259 MB
Rank =  106  Free Memory = 88259 MB
Rank =  107  Free Memory = 88259 MB
Rank =  108  Free Memory = 88259 MB
Rank =  109  Free Memory = 88259 MB
Rank =  110  Free Memory = 88259 MB
Rank =  111  Free Memory = 88259 MB
Rank =  112  Free Memory = 88259 MB
Rank =  113  Free Memory = 88259 MB
Rank =  114  Free Memory = 88259 MB
Rank =  115  Free Memory = 88259 MB
Rank =  116  Free Memory = 88259 MB
Rank =  117  Free Memory = 88258 MB
Rank =  118  Free Memory = 88258 MB
Rank =  119  Free Memory = 88258 MB
Rank =  120  Free Memory = 88258 MB
Rank =  121  Free Memory = 88258 MB
Rank =  122  Free Memory = 88258 MB
Rank =  123  Free Memory = 88258 MB
Rank =  124  Free Memory = 88258 MB
Rank =  125  Free Memory = 88258 MB
Rank =  126  Free Memory = 88258 MB
Rank =  127  Free Memory = 88258 MB
  Input file(s): opt_h2o_1b1_lmtt_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmtt_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:41:27 PST
  host    = n0093.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 455

  Range of prime numbers to use as seeds over processors and threads = 3229-4261


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.939727e-01    1         1  ON     0
     uu_1                 1.268714e-01    1         1  ON     1
     uu_2                 2.511361e-02    1         1  ON     2
     uu_3                -3.765314e-02    1         1  ON     3
     uu_4                -8.377567e-02    1         1  ON     4
     uu_5                -1.194542e-01    1         1  ON     5
     uu_6                -1.477551e-01    1         1  ON     6
     uu_7                -1.625913e-01    1         1  ON     7
     uu_8                -1.558903e-01    1         1  ON     8
     uu_9                -1.294336e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.514442e-01    1         1  ON     0
     ud_1                 1.875180e-01    1         1  ON     1
     ud_2                 7.110476e-02    1         1  ON     2
     ud_3                 1.963062e-03    1         1  ON     3
     ud_4                -5.677585e-02    1         1  ON     4
     ud_5                -1.002695e-01    1         1  ON     5
     ud_6                -1.294631e-01    1         1  ON     6
     ud_7                -1.471627e-01    1         1  ON     7
     ud_8                -1.500961e-01    1         1  ON     8
     ud_9                -1.420891e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.028053e-01    1         1  ON     0
     eO_1                -3.863429e-01    1         1  ON     1
     eO_2                 2.622157e-02    1         1  ON     2
     eO_3                 3.416126e-01    1         1  ON     3
     eO_4                 5.667955e-01    1         1  ON     4
     eO_5                 5.257711e-01    1         1  ON     5
     eO_6                 2.818478e-01    1         1  ON     6
     eO_7                -6.463996e-02    1         1  ON     7
     eO_8                -3.275256e-01    1         1  ON     8
     eO_9                -2.231919e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.869674e-01    1         1  ON     0
     eH1_1                -1.872401e-01    1         1  ON     1
     eH1_2                -1.411186e-01    1         1  ON     2
     eH1_3                -8.601401e-02    1         1  ON     3
     eH1_4                -3.553048e-02    1         1  ON     4
     eH1_5                 3.933155e-03    1         1  ON     5
     eH1_6                 7.335098e-02    1         1  ON     6
     eH1_7                 1.570701e-01    1         1  ON     7
     eH1_8                 2.273965e-01    1         1  ON     8
     eH1_9                 2.092299e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.851993e-01    1         1  ON     0
     eH2_1                -1.854240e-01    1         1  ON     1
     eH2_2                -1.390374e-01    1         1  ON     2
     eH2_3                -8.396609e-02    1         1  ON     3
     eH2_4                -3.377951e-02    1         1  ON     4
     eH2_5                 5.156767e-03    1         1  ON     5
     eH2_6                 7.402433e-02    1         1  ON     6
     eH2_7                 1.557694e-01    1         1  ON     7
     eH2_8                 2.244667e-01    1         1  ON     8
     eH2_9                 2.357714e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.931956e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9658e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8912
    reference variance = 0.212523
====================================================
  Execution time = 2.1589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4215e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342100919285
                                         uncertainty =       0.004750478923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342100919285
                                         uncertainty =       0.004750478923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413610809
  error estimate for blocks of size 2^( 2) =       0.000425772744
  error estimate for blocks of size 2^( 3) =       0.000438683345
  error estimate for blocks of size 2^( 4) =       0.000450619943
  error estimate for blocks of size 2^( 5) =       0.000461980535
  error estimate for blocks of size 2^( 6) =       0.000468724254
  error estimate for blocks of size 2^( 7) =       0.000475757805

      target function =                  N/A
              le_mean =     -16.905806916543
             les_mean =     286.148455131752
             stat err =       0.000464270634
             autocorr =       1.259965544849
              std dev =       0.584934016270
             le_variance =       0.342147803390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690580691654e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905806916543       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905827216941       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905837223230       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905838635105       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905837264061       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905838049345       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905838694599       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905839269203       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905839611229       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905839326063       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905839263966       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.710205e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905806916543       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905814791105       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905819505820       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905820698622       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905820606081       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905820473519       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905820477746       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905820644026       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905820690135       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.258583e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905806916543       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809200086       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905810716657       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905811164586       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905811269761       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905811227880       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811180584       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905811192880       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905811198762       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.745496e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044823 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7171e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.938950e-01                 1 1 ON  0
uu_1  1.269199e-01                 1 1 ON  1
uu_2  2.518550e-02                 1 1 ON  2
uu_3  -3.758618e-02                1 1 ON  3
uu_4  -8.379503e-02                1 1 ON  4
uu_5  -1.194546e-01                1 1 ON  5
uu_6  -1.477772e-01                1 1 ON  6
uu_7  -1.626331e-01                1 1 ON  7
uu_8  -1.559295e-01                1 1 ON  8
uu_9  -1.294692e-01                1 1 ON  9
ud_0  4.520701e-01                 1 1 ON  10
ud_1  1.879669e-01                 1 1 ON  11
ud_2  7.073317e-02                 1 1 ON  12
ud_3  1.518478e-03                 1 1 ON  13
ud_4  -5.680849e-02                1 1 ON  14
ud_5  -1.002591e-01                1 1 ON  15
ud_6  -1.295221e-01                1 1 ON  16
ud_7  -1.472415e-01                1 1 ON  17
ud_8  -1.501167e-01                1 1 ON  18
ud_9  -1.421312e-01                1 1 ON  19
eO_0  -7.032092e-01                1 1 ON  20
eO_1  -3.861785e-01                1 1 ON  21
eO_2  2.646651e-02                 1 1 ON  22
eO_3  3.419325e-01                 1 1 ON  23
eO_4  5.668165e-01                 1 1 ON  24
eO_5  5.256532e-01                 1 1 ON  25
eO_6  2.818395e-01                 1 1 ON  26
eO_7  -6.464227e-02                1 1 ON  27
eO_8  -3.276069e-01                1 1 ON  28
eO_9  -2.233049e-01                1 1 ON  29
eH1_0 -2.873710e-01                1 1 ON  30
eH1_1 -1.874804e-01                1 1 ON  31
eH1_2 -1.409121e-01                1 1 ON  32
eH1_3 -8.589989e-02                1 1 ON  33
eH1_4 -3.540376e-02                1 1 ON  34
eH1_5 4.068897e-03                 1 1 ON  35
eH1_6 7.326999e-02                 1 1 ON  36
eH1_7 1.569982e-01                 1 1 ON  37
eH1_8 2.274270e-01                 1 1 ON  38
eH1_9 2.093484e-01                 1 1 ON  39
eH2_0 -2.856604e-01                1 1 ON  40
eH2_1 -1.855494e-01                1 1 ON  41
eH2_2 -1.389163e-01                1 1 ON  42
eH2_3 -8.388256e-02                1 1 ON  43
eH2_4 -3.361551e-02                1 1 ON  44
eH2_5 5.229375e-03                 1 1 ON  45
eH2_6 7.410288e-02                 1 1 ON  46
eH2_7 1.558113e-01                 1 1 ON  47
eH2_8 2.244897e-01                 1 1 ON  48
eH2_9 2.357524e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8462
    reference variance = 0.304806
====================================================
  Execution time = 2.0413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3928e-01
  Total weights = 2.0000e+06
  Execution time = 1.9012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338883333821
                                         uncertainty =       0.004015113098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338883333821
                                         uncertainty =       0.004015113098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602953
  error estimate for blocks of size 2^( 2) =       0.000424372188
  error estimate for blocks of size 2^( 3) =       0.000437493281
  error estimate for blocks of size 2^( 4) =       0.000449623214
  error estimate for blocks of size 2^( 5) =       0.000461804312
  error estimate for blocks of size 2^( 6) =       0.000469059684
  error estimate for blocks of size 2^( 7) =       0.000475054273

      target function =                  N/A
              le_mean =     -16.906732271250
             les_mean =     286.176429904534
             stat err =       0.000463885371
             autocorr =       1.270177423440
              std dev =       0.582094478770
             le_variance =       0.338833982214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340084401881
                                         uncertainty =       0.004023878695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340084401881
                                         uncertainty =       0.004023878695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412331512
  error estimate for blocks of size 2^( 2) =       0.000425022758
  error estimate for blocks of size 2^( 3) =       0.000438075089
  error estimate for blocks of size 2^( 4) =       0.000450169570
  error estimate for blocks of size 2^( 5) =       0.000462345609
  error estimate for blocks of size 2^( 6) =       0.000469577379
  error estimate for blocks of size 2^( 7) =       0.000475519405

      target function =                  N/A
              le_mean =     -16.906735384462
             les_mean =     286.177735741582
             stat err =       0.000464402991
             autocorr =       1.268518960018
              std dev =       0.583124816305
             le_variance =       0.340034551391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339799971297
                                         uncertainty =       0.004021364437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339799971297
                                         uncertainty =       0.004021364437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412159048
  error estimate for blocks of size 2^( 2) =       0.000424864762
  error estimate for blocks of size 2^( 3) =       0.000437931284
  error estimate for blocks of size 2^( 4) =       0.000450033838
  error estimate for blocks of size 2^( 5) =       0.000462212558
  error estimate for blocks of size 2^( 6) =       0.000469449556
  error estimate for blocks of size 2^( 7) =       0.000475399072

      target function =                  N/A
              le_mean =     -16.906732299977
             les_mean =     286.177347054644
             stat err =       0.000464273756
             autocorr =       1.268874279574
              std dev =       0.582880915324
             le_variance =       0.339750161449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007119325
                                         uncertainty =       0.004015933989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339007119325
                                         uncertainty =       0.004015933989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411678086
  error estimate for blocks of size 2^( 2) =       0.000424437281
  error estimate for blocks of size 2^( 3) =       0.000437549916
  error estimate for blocks of size 2^( 4) =       0.000449675761
  error estimate for blocks of size 2^( 5) =       0.000461856614
  error estimate for blocks of size 2^( 6) =       0.000469109248
  error estimate for blocks of size 2^( 7) =       0.000475096780

      target function =                  N/A
              le_mean =     -16.906730842391
             les_mean =     286.176505300957
             stat err =       0.000463934600
             autocorr =       1.269983349963
              std dev =       0.582200732895
             le_variance =       0.338957693383


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906732271250        initial
     2.5000e-01     2.5000e+00             1.7102e-03       -16.906735384462  <--
     1.0000e+00     1.0000e+01             6.2586e-04       -16.906732299977
     4.0000e+00     4.0000e+01             1.7455e-04       -16.906730842391

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0024e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.939155e-01 1 1  ON 0
 uu_1                 1.270110e-01 1 1  ON 1
 uu_2                 2.528517e-02 1 1  ON 2
 uu_3                -3.750511e-02 1 1  ON 3
 uu_4                -8.385662e-02 1 1  ON 4
 uu_5                -1.194924e-01 1 1  ON 5
 uu_6                -1.478287e-01 1 1  ON 6
 uu_7                -1.627254e-01 1 1  ON 7
 uu_8                -1.560279e-01 1 1  ON 8
 uu_9                -1.295648e-01 1 1  ON 9
 ud_0                 4.531544e-01 1 1  ON 10
 ud_1                 1.885389e-01 1 1  ON 11
 ud_2                 7.038481e-02 1 1  ON 12
 ud_3                 8.059198e-04 1 1  ON 13
 ud_4                -5.704347e-02 1 1  ON 14
 ud_5                -1.002489e-01 1 1  ON 15
 ud_6                -1.295594e-01 1 1  ON 16
 ud_7                -1.473586e-01 1 1  ON 17
 ud_8                -1.501355e-01 1 1  ON 18
 ud_9                -1.422315e-01 1 1  ON 19
 eO_0                -7.038775e-01 1 1  ON 20
 eO_1                -3.858695e-01 1 1  ON 21
 eO_2                 2.692921e-02 1 1  ON 22
 eO_3                 3.424451e-01 1 1  ON 23
 eO_4                 5.669977e-01 1 1  ON 24
 eO_5                 5.254676e-01 1 1  ON 25
 eO_6                 2.818344e-01 1 1  ON 26
 eO_7                -6.463309e-02 1 1  ON 27
 eO_8                -3.278304e-01 1 1  ON 28
 eO_9                -2.236292e-01 1 1  ON 29
eH1_0                -2.883849e-01 1 1  ON 30
eH1_1                -1.879049e-01 1 1  ON 31
eH1_2                -1.405933e-01 1 1  ON 32
eH1_3                -8.564274e-02 1 1  ON 33
eH1_4                -3.513683e-02 1 1  ON 34
eH1_5                 4.403194e-03 1 1  ON 35
eH1_6                 7.310203e-02 1 1  ON 36
eH1_7                 1.568059e-01 1 1  ON 37
eH1_8                 2.275151e-01 1 1  ON 38
eH1_9                 2.096925e-01 1 1  ON 39
eH2_0                -2.867812e-01 1 1  ON 40
eH2_1                -1.858415e-01 1 1  ON 41
eH2_2                -1.387101e-01 1 1  ON 42
eH2_3                -8.368187e-02 1 1  ON 43
eH2_4                -3.329585e-02 1 1  ON 44
eH2_5                 5.436951e-03 1 1  ON 45
eH2_6                 7.436297e-02 1 1  ON 46
eH2_7                 1.559420e-01 1 1  ON 47
eH2_8                 2.245650e-01 1 1  ON 48
eH2_9                 2.357035e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7202e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6869e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9594
    reference variance = 0.198443
====================================================
  Execution time = 2.0743e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336396664478
                                         uncertainty =       0.005884722261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336396664478
                                         uncertainty =       0.005884722261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410126038
  error estimate for blocks of size 2^( 2) =       0.000422721235
  error estimate for blocks of size 2^( 3) =       0.000434881704
  error estimate for blocks of size 2^( 4) =       0.000446225394
  error estimate for blocks of size 2^( 5) =       0.000456038523
  error estimate for blocks of size 2^( 6) =       0.000463468142
  error estimate for blocks of size 2^( 7) =       0.000468031655

      target function =                  N/A
              le_mean =     -16.906351825662
             les_mean =     286.161138618346
             stat err =       0.000458440929
             autocorr =       1.249487981439
              std dev =       0.580005804712
             le_variance =       0.336406733500


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635182566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906351825662       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906370039631       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906370777354       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906373691160       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906374866034       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906376432744       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906376668436       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906377210246       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906377744403       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906377577214       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906377788702       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906377685573       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906377768147       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906377634727       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.820475e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906351825662       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906362383822       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363655468       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365494264       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365315537       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365790743       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365896648       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365915364       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906366089716       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906366155463       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.113157e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906351825662       residual = 8.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906355763349       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906356727136       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906356849036       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906357256557       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906357163174       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906357251099       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906357223111       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906357260957       residual = 3.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.224458e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049928 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6216e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.938393e-01 1 1  ON 0
 uu_1                 1.269515e-01 1 1  ON 1
 uu_2                 2.530445e-02 1 1  ON 2
 uu_3                -3.734480e-02 1 1  ON 3
 uu_4                -8.363392e-02 1 1  ON 4
 uu_5                -1.195916e-01 1 1  ON 5
 uu_6                -1.479896e-01 1 1  ON 6
 uu_7                -1.629210e-01 1 1  ON 7
 uu_8                -1.559438e-01 1 1  ON 8
 uu_9                -1.296444e-01 1 1  ON 9
 ud_0                 4.539544e-01 1 1  ON 10
 ud_1                 1.891683e-01 1 1  ON 11
 ud_2                 7.031291e-02 1 1  ON 12
 ud_3                 2.469013e-04 1 1  ON 13
 ud_4                -5.733826e-02 1 1  ON 14
 ud_5                -1.002967e-01 1 1  ON 15
 ud_6                -1.295907e-01 1 1  ON 16
 ud_7                -1.473629e-01 1 1  ON 17
 ud_8                -1.500245e-01 1 1  ON 18
 ud_9                -1.422399e-01 1 1  ON 19
 eO_0                -7.043212e-01 1 1  ON 20
 eO_1                -3.856510e-01 1 1  ON 21
 eO_2                 2.742746e-02 1 1  ON 22
 eO_3                 3.428686e-01 1 1  ON 23
 eO_4                 5.671153e-01 1 1  ON 24
 eO_5                 5.253678e-01 1 1  ON 25
 eO_6                 2.818757e-01 1 1  ON 26
 eO_7                -6.468694e-02 1 1  ON 27
 eO_8                -3.280810e-01 1 1  ON 28
 eO_9                -2.239782e-01 1 1  ON 29
eH1_0                -2.894981e-01 1 1  ON 30
eH1_1                -1.881599e-01 1 1  ON 31
eH1_2                -1.403905e-01 1 1  ON 32
eH1_3                -8.543281e-02 1 1  ON 33
eH1_4                -3.503828e-02 1 1  ON 34
eH1_5                 4.381508e-03 1 1  ON 35
eH1_6                 7.330211e-02 1 1  ON 36
eH1_7                 1.569866e-01 1 1  ON 37
eH1_8                 2.275332e-01 1 1  ON 38
eH1_9                 2.099269e-01 1 1  ON 39
eH2_0                -2.875750e-01 1 1  ON 40
eH2_1                -1.859417e-01 1 1  ON 41
eH2_2                -1.382754e-01 1 1  ON 42
eH2_3                -8.335110e-02 1 1  ON 43
eH2_4                -3.325677e-02 1 1  ON 44
eH2_5                 5.357852e-03 1 1  ON 45
eH2_6                 7.385322e-02 1 1  ON 46
eH2_7                 1.560136e-01 1 1  ON 47
eH2_8                 2.248340e-01 1 1  ON 48
eH2_9                 2.358212e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8998
    reference variance = 0.200334
====================================================
  Execution time = 2.0207e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3152e-01
  Total weights = 2.0000e+06
  Execution time = 1.8941e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331193489928
                                         uncertainty =       0.002753185864

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331193489928
                                         uncertainty =       0.002753185864

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406914085
  error estimate for blocks of size 2^( 2) =       0.000419896546
  error estimate for blocks of size 2^( 3) =       0.000433912134
  error estimate for blocks of size 2^( 4) =       0.000446589339
  error estimate for blocks of size 2^( 5) =       0.000457692405
  error estimate for blocks of size 2^( 6) =       0.000465811983
  error estimate for blocks of size 2^( 7) =       0.000474458556

      target function =                  N/A
              le_mean =     -16.906190191196
             les_mean =     286.150424759704
             stat err =       0.000461138071
             autocorr =       1.284270513884
              std dev =       0.575463417082
             le_variance =       0.331158144400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331923273922
                                         uncertainty =       0.002760016907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331923273922
                                         uncertainty =       0.002760016907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407362210
  error estimate for blocks of size 2^( 2) =       0.000420305591
  error estimate for blocks of size 2^( 3) =       0.000434283406
  error estimate for blocks of size 2^( 4) =       0.000446931103
  error estimate for blocks of size 2^( 5) =       0.000458024071
  error estimate for blocks of size 2^( 6) =       0.000466116626
  error estimate for blocks of size 2^( 7) =       0.000474806753

      target function =                  N/A
              le_mean =     -16.906188910013
             les_mean =     286.151111234774
             stat err =       0.000461469638
             autocorr =       1.283289938994
              std dev =       0.576097161658
             le_variance =       0.331887939671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331944040849
                                         uncertainty =       0.002759826806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331944040849
                                         uncertainty =       0.002759826806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407374998
  error estimate for blocks of size 2^( 2) =       0.000420318870
  error estimate for blocks of size 2^( 3) =       0.000434298250
  error estimate for blocks of size 2^( 4) =       0.000446945190
  error estimate for blocks of size 2^( 5) =       0.000458034216
  error estimate for blocks of size 2^( 6) =       0.000466122959
  error estimate for blocks of size 2^( 7) =       0.000474828670

      target function =                  N/A
              le_mean =     -16.906189056988
             les_mean =     286.151137042320
             stat err =       0.000461482759
             autocorr =       1.283282340768
              std dev =       0.576115246858
             le_variance =       0.331908777663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331318637227
                                         uncertainty =       0.002754330840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331318637227
                                         uncertainty =       0.002754330840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406990982
  error estimate for blocks of size 2^( 2) =       0.000419965414
  error estimate for blocks of size 2^( 3) =       0.000433973560
  error estimate for blocks of size 2^( 4) =       0.000446644616
  error estimate for blocks of size 2^( 5) =       0.000457744176
  error estimate for blocks of size 2^( 6) =       0.000465857879
  error estimate for blocks of size 2^( 7) =       0.000474517778

      target function =                  N/A
              le_mean =     -16.906187418450
             les_mean =     286.150456181432
             stat err =       0.000461191112
             autocorr =       1.284080600165
              std dev =       0.575572166912
             le_variance =       0.331283319324


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906190191196        initial  <--
     6.2500e-02     6.2500e-01             2.8205e-03       -16.906188910013
     2.5000e-01     2.5000e+00             1.1132e-03       -16.906189056988
     1.0000e+00     1.0000e+01             3.2245e-04       -16.906187418450

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7963
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.939155e-01 1 1  ON 0
 uu_1                 1.270110e-01 1 1  ON 1
 uu_2                 2.528517e-02 1 1  ON 2
 uu_3                -3.750511e-02 1 1  ON 3
 uu_4                -8.385662e-02 1 1  ON 4
 uu_5                -1.194924e-01 1 1  ON 5
 uu_6                -1.478287e-01 1 1  ON 6
 uu_7                -1.627254e-01 1 1  ON 7
 uu_8                -1.560279e-01 1 1  ON 8
 uu_9                -1.295648e-01 1 1  ON 9
 ud_0                 4.531544e-01 1 1  ON 10
 ud_1                 1.885389e-01 1 1  ON 11
 ud_2                 7.038481e-02 1 1  ON 12
 ud_3                 8.059198e-04 1 1  ON 13
 ud_4                -5.704347e-02 1 1  ON 14
 ud_5                -1.002489e-01 1 1  ON 15
 ud_6                -1.295594e-01 1 1  ON 16
 ud_7                -1.473586e-01 1 1  ON 17
 ud_8                -1.501355e-01 1 1  ON 18
 ud_9                -1.422315e-01 1 1  ON 19
 eO_0                -7.038775e-01 1 1  ON 20
 eO_1                -3.858695e-01 1 1  ON 21
 eO_2                 2.692921e-02 1 1  ON 22
 eO_3                 3.424451e-01 1 1  ON 23
 eO_4                 5.669977e-01 1 1  ON 24
 eO_5                 5.254676e-01 1 1  ON 25
 eO_6                 2.818344e-01 1 1  ON 26
 eO_7                -6.463309e-02 1 1  ON 27
 eO_8                -3.278304e-01 1 1  ON 28
 eO_9                -2.236292e-01 1 1  ON 29
eH1_0                -2.883849e-01 1 1  ON 30
eH1_1                -1.879049e-01 1 1  ON 31
eH1_2                -1.405933e-01 1 1  ON 32
eH1_3                -8.564274e-02 1 1  ON 33
eH1_4                -3.513683e-02 1 1  ON 34
eH1_5                 4.403194e-03 1 1  ON 35
eH1_6                 7.310203e-02 1 1  ON 36
eH1_7                 1.568059e-01 1 1  ON 37
eH1_8                 2.275151e-01 1 1  ON 38
eH1_9                 2.096925e-01 1 1  ON 39
eH2_0                -2.867812e-01 1 1  ON 40
eH2_1                -1.858415e-01 1 1  ON 41
eH2_2                -1.387101e-01 1 1  ON 42
eH2_3                -8.368187e-02 1 1  ON 43
eH2_4                -3.329585e-02 1 1  ON 44
eH2_5                 5.436951e-03 1 1  ON 45
eH2_6                 7.436297e-02 1 1  ON 46
eH2_7                 1.559420e-01 1 1  ON 47
eH2_8                 2.245650e-01 1 1  ON 48
eH2_9                 2.357035e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8999
    reference variance = 0.441015
====================================================
  Execution time = 2.2648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4895e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348748502621
                                         uncertainty =       0.010010978000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348748502621
                                         uncertainty =       0.010010978000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417699177
  error estimate for blocks of size 2^( 2) =       0.000430049752
  error estimate for blocks of size 2^( 3) =       0.000442802282
  error estimate for blocks of size 2^( 4) =       0.000454571366
  error estimate for blocks of size 2^( 5) =       0.000465125724
  error estimate for blocks of size 2^( 6) =       0.000471585645
  error estimate for blocks of size 2^( 7) =       0.000477443595

      target function =                  N/A
              le_mean =     -16.906445371230
             les_mean =     286.176840121023
             stat err =       0.000467181583
             autocorr =       1.250962201867
              std dev =       0.590715841249
             le_variance =       0.348945205102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644537123e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906445371230       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906451216703       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906454745748       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906454454215       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906454127063       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906454048626       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906454039994       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906454092367       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906454154661       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.807077e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906445371230       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906447168946       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906448357310       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906448370338       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906448297130       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906448245823       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906448218810       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906448225406       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.314133e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906445371230       residual = 8.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906445848098       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906446173584       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906446185754       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906446173003       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906446158362       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906446149083       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906446150561       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.477964e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8198e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.938898e-01 1 1  ON 0
 uu_1                 1.269870e-01 1 1  ON 1
 uu_2                 2.526725e-02 1 1  ON 2
 uu_3                -3.753128e-02 1 1  ON 3
 uu_4                -8.380472e-02 1 1  ON 4
 uu_5                -1.195101e-01 1 1  ON 5
 uu_6                -1.478864e-01 1 1  ON 6
 uu_7                -1.627730e-01 1 1  ON 7
 uu_8                -1.559583e-01 1 1  ON 8
 uu_9                -1.295264e-01 1 1  ON 9
 ud_0                 4.532466e-01 1 1  ON 10
 ud_1                 1.886638e-01 1 1  ON 11
 ud_2                 7.036446e-02 1 1  ON 12
 ud_3                 6.971344e-04 1 1  ON 13
 ud_4                -5.710701e-02 1 1  ON 14
 ud_5                -1.002547e-01 1 1  ON 15
 ud_6                -1.295563e-01 1 1  ON 16
 ud_7                -1.474461e-01 1 1  ON 17
 ud_8                -1.501187e-01 1 1  ON 18
 ud_9                -1.421813e-01 1 1  ON 19
 eO_0                -7.040089e-01 1 1  ON 20
 eO_1                -3.858348e-01 1 1  ON 21
 eO_2                 2.696775e-02 1 1  ON 22
 eO_3                 3.425546e-01 1 1  ON 23
 eO_4                 5.670263e-01 1 1  ON 24
 eO_5                 5.254475e-01 1 1  ON 25
 eO_6                 2.818349e-01 1 1  ON 26
 eO_7                -6.466036e-02 1 1  ON 27
 eO_8                -3.278339e-01 1 1  ON 28
 eO_9                -2.236497e-01 1 1  ON 29
eH1_0                -2.885048e-01 1 1  ON 30
eH1_1                -1.879387e-01 1 1  ON 31
eH1_2                -1.405457e-01 1 1  ON 32
eH1_3                -8.565137e-02 1 1  ON 33
eH1_4                -3.510926e-02 1 1  ON 34
eH1_5                 4.438705e-03 1 1  ON 35
eH1_6                 7.309663e-02 1 1  ON 36
eH1_7                 1.567911e-01 1 1  ON 37
eH1_8                 2.275129e-01 1 1  ON 38
eH1_9                 2.097373e-01 1 1  ON 39
eH2_0                -2.869100e-01 1 1  ON 40
eH2_1                -1.858809e-01 1 1  ON 41
eH2_2                -1.386702e-01 1 1  ON 42
eH2_3                -8.364639e-02 1 1  ON 43
eH2_4                -3.327925e-02 1 1  ON 44
eH2_5                 5.451504e-03 1 1  ON 45
eH2_6                 7.435536e-02 1 1  ON 46
eH2_7                 1.559546e-01 1 1  ON 47
eH2_8                 2.245831e-01 1 1  ON 48
eH2_9                 2.357217e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8722
    reference variance = 0.274434
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3204e-01
  Total weights = 2.0000e+06
  Execution time = 1.8986e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332067180638
                                         uncertainty =       0.002942501978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332067180638
                                         uncertainty =       0.002942501978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407431776
  error estimate for blocks of size 2^( 2) =       0.000420377194
  error estimate for blocks of size 2^( 3) =       0.000433944306
  error estimate for blocks of size 2^( 4) =       0.000446204298
  error estimate for blocks of size 2^( 5) =       0.000457364906
  error estimate for blocks of size 2^( 6) =       0.000463715568
  error estimate for blocks of size 2^( 7) =       0.000471198948

      target function =                  N/A
              le_mean =     -16.907036079733
             les_mean =     286.179870139138
             stat err =       0.000459620930
             autocorr =       1.272593794979
              std dev =       0.576195542969
             le_variance =       0.332001303737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332255925871
                                         uncertainty =       0.002945729360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332255925871
                                         uncertainty =       0.002945729360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407547617
  error estimate for blocks of size 2^( 2) =       0.000420481163
  error estimate for blocks of size 2^( 3) =       0.000434034058
  error estimate for blocks of size 2^( 4) =       0.000446279608
  error estimate for blocks of size 2^( 5) =       0.000457435195
  error estimate for blocks of size 2^( 6) =       0.000463778726
  error estimate for blocks of size 2^( 7) =       0.000471272356

      target function =                  N/A
              le_mean =     -16.907038908377
             les_mean =     286.180154603729
             stat err =       0.000459691472
             autocorr =       1.272260889193
              std dev =       0.576359367458
             le_variance =       0.332190120457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332146999838
                                         uncertainty =       0.002944137707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332146999838
                                         uncertainty =       0.002944137707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407480777
  error estimate for blocks of size 2^( 2) =       0.000420419794
  error estimate for blocks of size 2^( 3) =       0.000433978796
  error estimate for blocks of size 2^( 4) =       0.000446230342
  error estimate for blocks of size 2^( 5) =       0.000457388336
  error estimate for blocks of size 2^( 6) =       0.000463734909
  error estimate for blocks of size 2^( 7) =       0.000471225539

      target function =                  N/A
              le_mean =     -16.907037484758
             les_mean =     286.179997511555
             stat err =       0.000459644782
             autocorr =       1.272419797728
              std dev =       0.576264840660
             le_variance =       0.332081166581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332075549944
                                         uncertainty =       0.002942698488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332075549944
                                         uncertainty =       0.002942698488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407436915
  error estimate for blocks of size 2^( 2) =       0.000420381514
  error estimate for blocks of size 2^( 3) =       0.000433947553
  error estimate for blocks of size 2^( 4) =       0.000446206432
  error estimate for blocks of size 2^( 5) =       0.000457366696
  error estimate for blocks of size 2^( 6) =       0.000463716837
  error estimate for blocks of size 2^( 7) =       0.000471201232

      target function =                  N/A
              le_mean =     -16.907036200542
             les_mean =     286.179882599460
             stat err =       0.000459622799
             autocorr =       1.272572042365
              std dev =       0.576202810681
             le_variance =       0.332009679037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907036079733        initial
     6.2500e-01     6.2500e+00             4.8071e-04       -16.907038908377  <--
     2.5000e+00     2.5000e+01             1.3141e-04       -16.907037484758
     1.0000e+01     1.0000e+02             3.4780e-05       -16.907036200542

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9968e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.938398e-01 1 1  ON 0
 uu_1                 1.269264e-01 1 1  ON 1
 uu_2                 2.521758e-02 1 1  ON 2
 uu_3                -3.759368e-02 1 1  ON 3
 uu_4                -8.372979e-02 1 1  ON 4
 uu_5                -1.195410e-01 1 1  ON 5
 uu_6                -1.480267e-01 1 1  ON 6
 uu_7                -1.629190e-01 1 1  ON 7
 uu_8                -1.557741e-01 1 1  ON 8
 uu_9                -1.294183e-01 1 1  ON 9
 ud_0                 4.535181e-01 1 1  ON 10
 ud_1                 1.889225e-01 1 1  ON 11
 ud_2                 7.033241e-02 1 1  ON 12
 ud_3                 4.642563e-04 1 1  ON 13
 ud_4                -5.728505e-02 1 1  ON 14
 ud_5                -1.002935e-01 1 1  ON 15
 ud_6                -1.295513e-01 1 1  ON 16
 ud_7                -1.476728e-01 1 1  ON 17
 ud_8                -1.500833e-01 1 1  ON 18
 ud_9                -1.420389e-01 1 1  ON 19
 eO_0                -7.043238e-01 1 1  ON 20
 eO_1                -3.857634e-01 1 1  ON 21
 eO_2                 2.707471e-02 1 1  ON 22
 eO_3                 3.428032e-01 1 1  ON 23
 eO_4                 5.671339e-01 1 1  ON 24
 eO_5                 5.254150e-01 1 1  ON 25
 eO_6                 2.818404e-01 1 1  ON 26
 eO_7                -6.474573e-02 1 1  ON 27
 eO_8                -3.278497e-01 1 1  ON 28
 eO_9                -2.237137e-01 1 1  ON 29
eH1_0                -2.888285e-01 1 1  ON 30
eH1_1                -1.880138e-01 1 1  ON 31
eH1_2                -1.404591e-01 1 1  ON 32
eH1_3                -8.565466e-02 1 1  ON 33
eH1_4                -3.505724e-02 1 1  ON 34
eH1_5                 4.532890e-03 1 1  ON 35
eH1_6                 7.309158e-02 1 1  ON 36
eH1_7                 1.567494e-01 1 1  ON 37
eH1_8                 2.275041e-01 1 1  ON 38
eH1_9                 2.098725e-01 1 1  ON 39
eH2_0                -2.872619e-01 1 1  ON 40
eH2_1                -1.859755e-01 1 1  ON 41
eH2_2                -1.385873e-01 1 1  ON 42
eH2_3                -8.354648e-02 1 1  ON 43
eH2_4                -3.323823e-02 1 1  ON 44
eH2_5                 5.486768e-03 1 1  ON 45
eH2_6                 7.433787e-02 1 1  ON 46
eH2_7                 1.559910e-01 1 1  ON 47
eH2_8                 2.246355e-01 1 1  ON 48
eH2_9                 2.357760e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8172e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.874
    reference variance = 0.259436
====================================================
  Execution time = 2.0703e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341194162577
                                         uncertainty =       0.007357145498

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341194162577
                                         uncertainty =       0.007357145498

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413074996
  error estimate for blocks of size 2^( 2) =       0.000425765177
  error estimate for blocks of size 2^( 3) =       0.000438619539
  error estimate for blocks of size 2^( 4) =       0.000451702605
  error estimate for blocks of size 2^( 5) =       0.000462239141
  error estimate for blocks of size 2^( 6) =       0.000469713451
  error estimate for blocks of size 2^( 7) =       0.000476492869

      target function =                  N/A
              le_mean =     -16.905865489147
             les_mean =     286.149549671361
             stat err =       0.000465037016
             autocorr =       1.267410299209
              std dev =       0.584176261817
             le_variance =       0.341261904870


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586548915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905865489147       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905871339065       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905874985978       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873704867       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905874346718       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873410230       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905874420708       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905874425402       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905875016741       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905874656729       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905874645744       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.497307e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905865489147       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905867958093       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905869303864       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905868814278       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905868860466       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905868761197       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905869088222       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905868984318       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905869139689       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.763480e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905865489147       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905866234644       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905866598398       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905866468245       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905866363502       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905866441171       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905866514703       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905866502880       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.262392e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.056163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6333e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.937553e-01 1 1  ON 0
 uu_1                 1.269385e-01 1 1  ON 1
 uu_2                 2.524757e-02 1 1  ON 2
 uu_3                -3.750871e-02 1 1  ON 3
 uu_4                -8.375519e-02 1 1  ON 4
 uu_5                -1.195908e-01 1 1  ON 5
 uu_6                -1.480317e-01 1 1  ON 6
 uu_7                -1.630227e-01 1 1  ON 7
 uu_8                -1.558206e-01 1 1  ON 8
 uu_9                -1.293644e-01 1 1  ON 9
 ud_0                 4.539206e-01 1 1  ON 10
 ud_1                 1.891362e-01 1 1  ON 11
 ud_2                 7.025814e-02 1 1  ON 12
 ud_3                 2.286767e-04 1 1  ON 13
 ud_4                -5.752523e-02 1 1  ON 14
 ud_5                -1.003159e-01 1 1  ON 15
 ud_6                -1.295464e-01 1 1  ON 16
 ud_7                -1.476667e-01 1 1  ON 17
 ud_8                -1.500042e-01 1 1  ON 18
 ud_9                -1.420047e-01 1 1  ON 19
 eO_0                -7.045315e-01 1 1  ON 20
 eO_1                -3.857994e-01 1 1  ON 21
 eO_2                 2.721726e-02 1 1  ON 22
 eO_3                 3.429900e-01 1 1  ON 23
 eO_4                 5.673443e-01 1 1  ON 24
 eO_5                 5.253675e-01 1 1  ON 25
 eO_6                 2.818400e-01 1 1  ON 26
 eO_7                -6.479110e-02 1 1  ON 27
 eO_8                -3.278892e-01 1 1  ON 28
 eO_9                -2.238329e-01 1 1  ON 29
eH1_0                -2.892729e-01 1 1  ON 30
eH1_1                -1.879289e-01 1 1  ON 31
eH1_2                -1.403747e-01 1 1  ON 32
eH1_3                -8.546130e-02 1 1  ON 33
eH1_4                -3.514258e-02 1 1  ON 34
eH1_5                 4.509521e-03 1 1  ON 35
eH1_6                 7.307626e-02 1 1  ON 36
eH1_7                 1.567727e-01 1 1  ON 37
eH1_8                 2.275072e-01 1 1  ON 38
eH1_9                 2.099803e-01 1 1  ON 39
eH2_0                -2.877383e-01 1 1  ON 40
eH2_1                -1.861035e-01 1 1  ON 41
eH2_2                -1.384554e-01 1 1  ON 42
eH2_3                -8.333962e-02 1 1  ON 43
eH2_4                -3.313104e-02 1 1  ON 44
eH2_5                 5.472441e-03 1 1  ON 45
eH2_6                 7.437050e-02 1 1  ON 46
eH2_7                 1.560266e-01 1 1  ON 47
eH2_8                 2.245515e-01 1 1  ON 48
eH2_9                 2.358215e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9412
    reference variance = 0.213507
====================================================
  Execution time = 2.0614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3520e-01
  Total weights = 2.0000e+06
  Execution time = 1.9008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334614175342
                                         uncertainty =       0.003569134606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334614175342
                                         uncertainty =       0.003569134606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409233277
  error estimate for blocks of size 2^( 2) =       0.000421924420
  error estimate for blocks of size 2^( 3) =       0.000434114916
  error estimate for blocks of size 2^( 4) =       0.000445971193
  error estimate for blocks of size 2^( 5) =       0.000455521887
  error estimate for blocks of size 2^( 6) =       0.000463191183
  error estimate for blocks of size 2^( 7) =       0.000468370357

      target function =                  N/A
              le_mean =     -16.906696169878
             les_mean =     286.171318963536
             stat err =       0.000458263655
             autocorr =       1.253975195441
              std dev =       0.578743250889
             le_variance =       0.334943750450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335191165549
                                         uncertainty =       0.003578888824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335191165549
                                         uncertainty =       0.003578888824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409586159
  error estimate for blocks of size 2^( 2) =       0.000422250767
  error estimate for blocks of size 2^( 3) =       0.000434410928
  error estimate for blocks of size 2^( 4) =       0.000446247116
  error estimate for blocks of size 2^( 5) =       0.000455789416
  error estimate for blocks of size 2^( 6) =       0.000463457942
  error estimate for blocks of size 2^( 7) =       0.000468647000

      target function =                  N/A
              le_mean =     -16.906699127707
             les_mean =     286.171996870239
             stat err =       0.000458535368
             autocorr =       1.253300275886
              std dev =       0.579242300945
             le_variance =       0.335521643204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335126137682
                                         uncertainty =       0.003577550808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335126137682
                                         uncertainty =       0.003577550808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409546403
  error estimate for blocks of size 2^( 2) =       0.000422212678
  error estimate for blocks of size 2^( 3) =       0.000434375564
  error estimate for blocks of size 2^( 4) =       0.000446212376
  error estimate for blocks of size 2^( 5) =       0.000455754861
  error estimate for blocks of size 2^( 6) =       0.000463422575
  error estimate for blocks of size 2^( 7) =       0.000468609979

      target function =                  N/A
              le_mean =     -16.906697418776
             les_mean =     286.171873954463
             stat err =       0.000458499948
             autocorr =       1.253349953471
              std dev =       0.579186077312
             le_variance =       0.335456512152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334694936564
                                         uncertainty =       0.003570452806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334694936564
                                         uncertainty =       0.003570452806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409282686
  error estimate for blocks of size 2^( 2) =       0.000421969671
  error estimate for blocks of size 2^( 3) =       0.000434155664
  error estimate for blocks of size 2^( 4) =       0.000446008715
  error estimate for blocks of size 2^( 5) =       0.000455557992
  error estimate for blocks of size 2^( 6) =       0.000463226945
  error estimate for blocks of size 2^( 7) =       0.000468407346

      target function =                  N/A
              le_mean =     -16.906695971671
             les_mean =     286.171393145653
             stat err =       0.000458300249
             autocorr =       1.253872681785
              std dev =       0.578813125844
             le_variance =       0.335024634650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906696169878        initial
     1.5625e-01     1.5625e+00             1.4973e-03       -16.906699127707  <--
     6.2500e-01     6.2500e+00             4.7635e-04       -16.906697418776
     2.5000e+00     2.5000e+01             1.2624e-04       -16.906695971671

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0229e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.937369e-01 1 1  ON 0
 uu_1                 1.269639e-01 1 1  ON 1
 uu_2                 2.528252e-02 1 1  ON 2
 uu_3                -3.744859e-02 1 1  ON 3
 uu_4                -8.382133e-02 1 1  ON 4
 uu_5                -1.197259e-01 1 1  ON 5
 uu_6                -1.480927e-01 1 1  ON 6
 uu_7                -1.632308e-01 1 1  ON 7
 uu_8                -1.559470e-01 1 1  ON 8
 uu_9                -1.292339e-01 1 1  ON 9
 ud_0                 4.544783e-01 1 1  ON 10
 ud_1                 1.894243e-01 1 1  ON 11
 ud_2                 7.023940e-02 1 1  ON 12
 ud_3                -8.293313e-05 1 1  ON 13
 ud_4                -5.791248e-02 1 1  ON 14
 ud_5                -1.004284e-01 1 1  ON 15
 ud_6                -1.295130e-01 1 1  ON 16
 ud_7                -1.475991e-01 1 1  ON 17
 ud_8                -1.497771e-01 1 1  ON 18
 ud_9                -1.418959e-01 1 1  ON 19
 eO_0                -7.048661e-01 1 1  ON 20
 eO_1                -3.859053e-01 1 1  ON 21
 eO_2                 2.749236e-02 1 1  ON 22
 eO_3                 3.433150e-01 1 1  ON 23
 eO_4                 5.678263e-01 1 1  ON 24
 eO_5                 5.253346e-01 1 1  ON 25
 eO_6                 2.818835e-01 1 1  ON 26
 eO_7                -6.489561e-02 1 1  ON 27
 eO_8                -3.279934e-01 1 1  ON 28
 eO_9                -2.241563e-01 1 1  ON 29
eH1_0                -2.901706e-01 1 1  ON 30
eH1_1                -1.878331e-01 1 1  ON 31
eH1_2                -1.402393e-01 1 1  ON 32
eH1_3                -8.512009e-02 1 1  ON 33
eH1_4                -3.527504e-02 1 1  ON 34
eH1_5                 4.415046e-03 1 1  ON 35
eH1_6                 7.303631e-02 1 1  ON 36
eH1_7                 1.568517e-01 1 1  ON 37
eH1_8                 2.275270e-01 1 1  ON 38
eH1_9                 2.102770e-01 1 1  ON 39
eH2_0                -2.887592e-01 1 1  ON 40
eH2_1                -1.862204e-01 1 1  ON 41
eH2_2                -1.382894e-01 1 1  ON 42
eH2_3                -8.298539e-02 1 1  ON 43
eH2_4                -3.295635e-02 1 1  ON 44
eH2_5                 5.452608e-03 1 1  ON 45
eH2_6                 7.444692e-02 1 1  ON 46
eH2_7                 1.561228e-01 1 1  ON 47
eH2_8                 2.243270e-01 1 1  ON 48
eH2_9                 2.359458e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6568e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8307
    reference variance = 0.226586
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4152e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341528239970
                                         uncertainty =       0.007808160989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341528239970
                                         uncertainty =       0.007808160989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413230920
  error estimate for blocks of size 2^( 2) =       0.000425800118
  error estimate for blocks of size 2^( 3) =       0.000438436730
  error estimate for blocks of size 2^( 4) =       0.000450235856
  error estimate for blocks of size 2^( 5) =       0.000459547771
  error estimate for blocks of size 2^( 6) =       0.000467734456
  error estimate for blocks of size 2^( 7) =       0.000474617941

      target function =                  N/A
              le_mean =     -16.906585128053
             les_mean =     286.174140107124
             stat err =       0.000463034006
             autocorr =       1.255567761228
              std dev =       0.584396770844
             le_variance =       0.341519585773


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658512805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906585128053       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906585640476       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906586384654       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906587550890       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906588116590       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906589141330       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906589835756       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906588909053       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906589629087       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906589440110       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906589768414       residual = 7.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906590594591       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906590736946       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906590453537       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 2.203330e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906585128053       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906585463340       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906586057161       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906586698248       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906586747558       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906587295464       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906587533776       residual = 9.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906587174292       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906587475264       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906587428202       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906587426918       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 8.030198e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906585128053       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906585268768       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906585591517       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906585755958       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906585632250       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906585804034       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906585882352       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906585847888       residual = 9.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.512096e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.936494e-01 1 1  ON 0
 uu_1                 1.268524e-01 1 1  ON 1
 uu_2                 2.537649e-02 1 1  ON 2
 uu_3                -3.731288e-02 1 1  ON 3
 uu_4                -8.345168e-02 1 1  ON 4
 uu_5                -1.193544e-01 1 1  ON 5
 uu_6                -1.481859e-01 1 1  ON 6
 uu_7                -1.634002e-01 1 1  ON 7
 uu_8                -1.562275e-01 1 1  ON 8
 uu_9                -1.293905e-01 1 1  ON 9
 ud_0                 4.547641e-01 1 1  ON 10
 ud_1                 1.896372e-01 1 1  ON 11
 ud_2                 7.030934e-02 1 1  ON 12
 ud_3                -2.926122e-04 1 1  ON 13
 ud_4                -5.813491e-02 1 1  ON 14
 ud_5                -1.008045e-01 1 1  ON 15
 ud_6                -1.295759e-01 1 1  ON 16
 ud_7                -1.475425e-01 1 1  ON 17
 ud_8                -1.495568e-01 1 1  ON 18
 ud_9                -1.416748e-01 1 1  ON 19
 eO_0                -7.048081e-01 1 1  ON 20
 eO_1                -3.856040e-01 1 1  ON 21
 eO_2                 2.777356e-02 1 1  ON 22
 eO_3                 3.431674e-01 1 1  ON 23
 eO_4                 5.682886e-01 1 1  ON 24
 eO_5                 5.255705e-01 1 1  ON 25
 eO_6                 2.820502e-01 1 1  ON 26
 eO_7                -6.505733e-02 1 1  ON 27
 eO_8                -3.284473e-01 1 1  ON 28
 eO_9                -2.247004e-01 1 1  ON 29
eH1_0                -2.909737e-01 1 1  ON 30
eH1_1                -1.879885e-01 1 1  ON 31
eH1_2                -1.400401e-01 1 1  ON 32
eH1_3                -8.489323e-02 1 1  ON 33
eH1_4                -3.511123e-02 1 1  ON 34
eH1_5                 4.166057e-03 1 1  ON 35
eH1_6                 7.275920e-02 1 1  ON 36
eH1_7                 1.570150e-01 1 1  ON 37
eH1_8                 2.276431e-01 1 1  ON 38
eH1_9                 2.107099e-01 1 1  ON 39
eH2_0                -2.894323e-01 1 1  ON 40
eH2_1                -1.862403e-01 1 1  ON 41
eH2_2                -1.383977e-01 1 1  ON 42
eH2_3                -8.311800e-02 1 1  ON 43
eH2_4                -3.302639e-02 1 1  ON 44
eH2_5                 5.580666e-03 1 1  ON 45
eH2_6                 7.408835e-02 1 1  ON 46
eH2_7                 1.561544e-01 1 1  ON 47
eH2_8                 2.248186e-01 1 1  ON 48
eH2_9                 2.363312e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8661
    reference variance = 0.335364
====================================================
  Execution time = 2.0639e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4584e-01
  Total weights = 2.0000e+06
  Execution time = 1.8970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345931356502
                                         uncertainty =       0.006396867413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345931356502
                                         uncertainty =       0.006396867413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415825659
  error estimate for blocks of size 2^( 2) =       0.000428779629
  error estimate for blocks of size 2^( 3) =       0.000441616482
  error estimate for blocks of size 2^( 4) =       0.000453263256
  error estimate for blocks of size 2^( 5) =       0.000463681662
  error estimate for blocks of size 2^( 6) =       0.000470519093
  error estimate for blocks of size 2^( 7) =       0.000475860039

      target function =                  N/A
              le_mean =     -16.906398625184
             les_mean =     286.172136257981
             stat err =       0.000465831013
             autocorr =       1.254972553783
              std dev =       0.588066286451
             le_variance =       0.345821957260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346047718508
                                         uncertainty =       0.006396983872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346047718508
                                         uncertainty =       0.006396983872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415895569
  error estimate for blocks of size 2^( 2) =       0.000428842303
  error estimate for blocks of size 2^( 3) =       0.000441671100
  error estimate for blocks of size 2^( 4) =       0.000453301841
  error estimate for blocks of size 2^( 5) =       0.000463715287
  error estimate for blocks of size 2^( 6) =       0.000470546124
  error estimate for blocks of size 2^( 7) =       0.000475877316

      target function =                  N/A
              le_mean =     -16.906395664314
             les_mean =     286.172152434495
             stat err =       0.000465860142
             autocorr =       1.254707582487
              std dev =       0.588165154624
             le_variance =       0.345938249113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345976291324
                                         uncertainty =       0.006395614066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345976291324
                                         uncertainty =       0.006395614066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415852657
  error estimate for blocks of size 2^( 2) =       0.000428801464
  error estimate for blocks of size 2^( 3) =       0.000441632279
  error estimate for blocks of size 2^( 4) =       0.000453263943
  error estimate for blocks of size 2^( 5) =       0.000463679517
  error estimate for blocks of size 2^( 6) =       0.000470512869
  error estimate for blocks of size 2^( 7) =       0.000475844225

      target function =                  N/A
              le_mean =     -16.906394996352
             les_mean =     286.172058464146
             stat err =       0.000465825139
             autocorr =       1.254777962279
              std dev =       0.588104467252
             le_variance =       0.345866864402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345941052708
                                         uncertainty =       0.006396261153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345941052708
                                         uncertainty =       0.006396261153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415831488
  error estimate for blocks of size 2^( 2) =       0.000428783983
  error estimate for blocks of size 2^( 3) =       0.000441619024
  error estimate for blocks of size 2^( 4) =       0.000453262428
  error estimate for blocks of size 2^( 5) =       0.000463679981
  error estimate for blocks of size 2^( 6) =       0.000470517482
  error estimate for blocks of size 2^( 7) =       0.000475856227

      target function =                  N/A
              le_mean =     -16.906397235574
             les_mean =     286.172098967122
             stat err =       0.000465829029
             autocorr =       1.254926682758
              std dev =       0.588074530146
             le_variance =       0.345831653006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906398625184        initial  <--
     3.9062e-02     3.9062e-01             2.2033e-03       -16.906395664314
     1.5625e-01     1.5625e+00             8.0302e-04       -16.906394996352
     6.2500e-01     6.2500e+00             2.5121e-04       -16.906397235574

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1942
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.937369e-01 1 1  ON 0
 uu_1                 1.269639e-01 1 1  ON 1
 uu_2                 2.528252e-02 1 1  ON 2
 uu_3                -3.744859e-02 1 1  ON 3
 uu_4                -8.382133e-02 1 1  ON 4
 uu_5                -1.197259e-01 1 1  ON 5
 uu_6                -1.480927e-01 1 1  ON 6
 uu_7                -1.632308e-01 1 1  ON 7
 uu_8                -1.559470e-01 1 1  ON 8
 uu_9                -1.292339e-01 1 1  ON 9
 ud_0                 4.544783e-01 1 1  ON 10
 ud_1                 1.894243e-01 1 1  ON 11
 ud_2                 7.023940e-02 1 1  ON 12
 ud_3                -8.293313e-05 1 1  ON 13
 ud_4                -5.791248e-02 1 1  ON 14
 ud_5                -1.004284e-01 1 1  ON 15
 ud_6                -1.295130e-01 1 1  ON 16
 ud_7                -1.475991e-01 1 1  ON 17
 ud_8                -1.497771e-01 1 1  ON 18
 ud_9                -1.418959e-01 1 1  ON 19
 eO_0                -7.048661e-01 1 1  ON 20
 eO_1                -3.859053e-01 1 1  ON 21
 eO_2                 2.749236e-02 1 1  ON 22
 eO_3                 3.433150e-01 1 1  ON 23
 eO_4                 5.678263e-01 1 1  ON 24
 eO_5                 5.253346e-01 1 1  ON 25
 eO_6                 2.818835e-01 1 1  ON 26
 eO_7                -6.489561e-02 1 1  ON 27
 eO_8                -3.279934e-01 1 1  ON 28
 eO_9                -2.241563e-01 1 1  ON 29
eH1_0                -2.901706e-01 1 1  ON 30
eH1_1                -1.878331e-01 1 1  ON 31
eH1_2                -1.402393e-01 1 1  ON 32
eH1_3                -8.512009e-02 1 1  ON 33
eH1_4                -3.527504e-02 1 1  ON 34
eH1_5                 4.415046e-03 1 1  ON 35
eH1_6                 7.303631e-02 1 1  ON 36
eH1_7                 1.568517e-01 1 1  ON 37
eH1_8                 2.275270e-01 1 1  ON 38
eH1_9                 2.102770e-01 1 1  ON 39
eH2_0                -2.887592e-01 1 1  ON 40
eH2_1                -1.862204e-01 1 1  ON 41
eH2_2                -1.382894e-01 1 1  ON 42
eH2_3                -8.298539e-02 1 1  ON 43
eH2_4                -3.295635e-02 1 1  ON 44
eH2_5                 5.452608e-03 1 1  ON 45
eH2_6                 7.444692e-02 1 1  ON 46
eH2_7                 1.561228e-01 1 1  ON 47
eH2_8                 2.243270e-01 1 1  ON 48
eH2_9                 2.359458e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6326e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9804
    reference variance = 0.310563
====================================================
  Execution time = 2.0860e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347958863
                                         uncertainty =       0.003745904814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347958863
                                         uncertainty =       0.003745904814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411295255
  error estimate for blocks of size 2^( 2) =       0.000424168439
  error estimate for blocks of size 2^( 3) =       0.000437534620
  error estimate for blocks of size 2^( 4) =       0.000449574482
  error estimate for blocks of size 2^( 5) =       0.000460195029
  error estimate for blocks of size 2^( 6) =       0.000468568880
  error estimate for blocks of size 2^( 7) =       0.000472217115

      target function =                  N/A
              le_mean =     -16.906635695215
             les_mean =     286.172657935334
             stat err =       0.000462638876
             autocorr =       1.265251469929
              std dev =       0.581659327927
             le_variance =       0.338327573764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663569522e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906635695215       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636192625       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906637934737       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906637256670       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906638974334       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906639195891       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906638925715       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906638691491       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906638849228       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 5.660952e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906635695215       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906635855153       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906636296179       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906636077581       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906636680093       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906636766614       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906636669366       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906636614211       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.561605e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906635695215       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906635738281       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906635843712       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906635784111       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906635951536       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906635977674       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906635950112       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906635939479       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.025327e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6459e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.937277e-01 1 1  ON 0
 uu_1                 1.269856e-01 1 1  ON 1
 uu_2                 2.523801e-02 1 1  ON 2
 uu_3                -3.745984e-02 1 1  ON 3
 uu_4                -8.379840e-02 1 1  ON 4
 uu_5                -1.197203e-01 1 1  ON 5
 uu_6                -1.480654e-01 1 1  ON 6
 uu_7                -1.632093e-01 1 1  ON 7
 uu_8                -1.559331e-01 1 1  ON 8
 uu_9                -1.292949e-01 1 1  ON 9
 ud_0                 4.545655e-01 1 1  ON 10
 ud_1                 1.895102e-01 1 1  ON 11
 ud_2                 7.025632e-02 1 1  ON 12
 ud_3                -8.198373e-05 1 1  ON 13
 ud_4                -5.792700e-02 1 1  ON 14
 ud_5                -1.004987e-01 1 1  ON 15
 ud_6                -1.295345e-01 1 1  ON 16
 ud_7                -1.475965e-01 1 1  ON 17
 ud_8                -1.497647e-01 1 1  ON 18
 ud_9                -1.419260e-01 1 1  ON 19
 eO_0                -7.049902e-01 1 1  ON 20
 eO_1                -3.858380e-01 1 1  ON 21
 eO_2                 2.758445e-02 1 1  ON 22
 eO_3                 3.433264e-01 1 1  ON 23
 eO_4                 5.678980e-01 1 1  ON 24
 eO_5                 5.253172e-01 1 1  ON 25
 eO_6                 2.818948e-01 1 1  ON 26
 eO_7                -6.486702e-02 1 1  ON 27
 eO_8                -3.280347e-01 1 1  ON 28
 eO_9                -2.242302e-01 1 1  ON 29
eH1_0                -2.903268e-01 1 1  ON 30
eH1_1                -1.878590e-01 1 1  ON 31
eH1_2                -1.402131e-01 1 1  ON 32
eH1_3                -8.510872e-02 1 1  ON 33
eH1_4                -3.525612e-02 1 1  ON 34
eH1_5                 4.460251e-03 1 1  ON 35
eH1_6                 7.302591e-02 1 1  ON 36
eH1_7                 1.568479e-01 1 1  ON 37
eH1_8                 2.275504e-01 1 1  ON 38
eH1_9                 2.103178e-01 1 1  ON 39
eH2_0                -2.888879e-01 1 1  ON 40
eH2_1                -1.862122e-01 1 1  ON 41
eH2_2                -1.382167e-01 1 1  ON 42
eH2_3                -8.293439e-02 1 1  ON 43
eH2_4                -3.299257e-02 1 1  ON 44
eH2_5                 5.442447e-03 1 1  ON 45
eH2_6                 7.442155e-02 1 1  ON 46
eH2_7                 1.561629e-01 1 1  ON 47
eH2_8                 2.243376e-01 1 1  ON 48
eH2_9                 2.359571e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9519
    reference variance = 0.588152
====================================================
  Execution time = 2.0470e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.0423e-01
  Total weights = 2.0000e+06
  Execution time = 1.8963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404160514375
                                         uncertainty =       0.048232646831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404160514375
                                         uncertainty =       0.048232646831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449541135
  error estimate for blocks of size 2^( 2) =       0.000461202017
  error estimate for blocks of size 2^( 3) =       0.000473683284
  error estimate for blocks of size 2^( 4) =       0.000485535160
  error estimate for blocks of size 2^( 5) =       0.000496414563
  error estimate for blocks of size 2^( 6) =       0.000504673236
  error estimate for blocks of size 2^( 7) =       0.000510003991

      target function =                  N/A
              le_mean =     -16.905882818016
             les_mean =     286.213048117757
             stat err =       0.000499156737
             autocorr =       1.232920290957
              std dev =       0.635747169353
             le_variance =       0.404174463341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404328493212
                                         uncertainty =       0.048232332679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404328493212
                                         uncertainty =       0.048232332679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449634316
  error estimate for blocks of size 2^( 2) =       0.000461288220
  error estimate for blocks of size 2^( 3) =       0.000473764025
  error estimate for blocks of size 2^( 4) =       0.000485611437
  error estimate for blocks of size 2^( 5) =       0.000496490761
  error estimate for blocks of size 2^( 6) =       0.000504749340
  error estimate for blocks of size 2^( 7) =       0.000510082160

      target function =                  N/A
              le_mean =     -16.905882527418
             les_mean =     286.213205865621
             stat err =       0.000499233424
             autocorr =       1.232788032546
              std dev =       0.635878948332
             le_variance =       0.404342036932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404265056419
                                         uncertainty =       0.048232429847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404265056419
                                         uncertainty =       0.048232429847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449599079
  error estimate for blocks of size 2^( 2) =       0.000461255218
  error estimate for blocks of size 2^( 3) =       0.000473732951
  error estimate for blocks of size 2^( 4) =       0.000485582084
  error estimate for blocks of size 2^( 5) =       0.000496461251
  error estimate for blocks of size 2^( 6) =       0.000504718895
  error estimate for blocks of size 2^( 7) =       0.000510051080

      target function =                  N/A
              le_mean =     -16.905882318151
             les_mean =     286.213135415875
             stat err =       0.000499203327
             autocorr =       1.232832622916
              std dev =       0.635829114511
             le_variance =       0.404278662860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404173528682
                                         uncertainty =       0.048232619452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.404173528682
                                         uncertainty =       0.048232619452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449548342
  error estimate for blocks of size 2^( 2) =       0.000461208583
  error estimate for blocks of size 2^( 3) =       0.000473689381
  error estimate for blocks of size 2^( 4) =       0.000485540902
  error estimate for blocks of size 2^( 5) =       0.000496420264
  error estimate for blocks of size 2^( 6) =       0.000504678727
  error estimate for blocks of size 2^( 7) =       0.000510009718

      target function =                  N/A
              le_mean =     -16.905882705970
             les_mean =     286.213057290238
             stat err =       0.000499162403
             autocorr =       1.232908741999
              std dev =       0.635757362765
             le_variance =       0.404187424309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905882818016        initial  <--
     3.9062e-01     3.9062e+00             5.6610e-04       -16.905882527418
     1.5625e+00     1.5625e+01             1.5616e-04       -16.905882318151
     6.2500e+00     6.2500e+01             4.0253e-05       -16.905882705970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0743
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.937369e-01 1 1  ON 0
 uu_1                 1.269639e-01 1 1  ON 1
 uu_2                 2.528252e-02 1 1  ON 2
 uu_3                -3.744859e-02 1 1  ON 3
 uu_4                -8.382133e-02 1 1  ON 4
 uu_5                -1.197259e-01 1 1  ON 5
 uu_6                -1.480927e-01 1 1  ON 6
 uu_7                -1.632308e-01 1 1  ON 7
 uu_8                -1.559470e-01 1 1  ON 8
 uu_9                -1.292339e-01 1 1  ON 9
 ud_0                 4.544783e-01 1 1  ON 10
 ud_1                 1.894243e-01 1 1  ON 11
 ud_2                 7.023940e-02 1 1  ON 12
 ud_3                -8.293313e-05 1 1  ON 13
 ud_4                -5.791248e-02 1 1  ON 14
 ud_5                -1.004284e-01 1 1  ON 15
 ud_6                -1.295130e-01 1 1  ON 16
 ud_7                -1.475991e-01 1 1  ON 17
 ud_8                -1.497771e-01 1 1  ON 18
 ud_9                -1.418959e-01 1 1  ON 19
 eO_0                -7.048661e-01 1 1  ON 20
 eO_1                -3.859053e-01 1 1  ON 21
 eO_2                 2.749236e-02 1 1  ON 22
 eO_3                 3.433150e-01 1 1  ON 23
 eO_4                 5.678263e-01 1 1  ON 24
 eO_5                 5.253346e-01 1 1  ON 25
 eO_6                 2.818835e-01 1 1  ON 26
 eO_7                -6.489561e-02 1 1  ON 27
 eO_8                -3.279934e-01 1 1  ON 28
 eO_9                -2.241563e-01 1 1  ON 29
eH1_0                -2.901706e-01 1 1  ON 30
eH1_1                -1.878331e-01 1 1  ON 31
eH1_2                -1.402393e-01 1 1  ON 32
eH1_3                -8.512009e-02 1 1  ON 33
eH1_4                -3.527504e-02 1 1  ON 34
eH1_5                 4.415046e-03 1 1  ON 35
eH1_6                 7.303631e-02 1 1  ON 36
eH1_7                 1.568517e-01 1 1  ON 37
eH1_8                 2.275270e-01 1 1  ON 38
eH1_9                 2.102770e-01 1 1  ON 39
eH2_0                -2.887592e-01 1 1  ON 40
eH2_1                -1.862204e-01 1 1  ON 41
eH2_2                -1.382894e-01 1 1  ON 42
eH2_3                -8.298539e-02 1 1  ON 43
eH2_4                -3.295635e-02 1 1  ON 44
eH2_5                 5.452608e-03 1 1  ON 45
eH2_6                 7.444692e-02 1 1  ON 46
eH2_7                 1.561228e-01 1 1  ON 47
eH2_8                 2.243270e-01 1 1  ON 48
eH2_9                 2.359458e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8497
    reference variance = 0.269393
====================================================
  Execution time = 2.0910e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5415e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340727738089
                                         uncertainty =       0.004827455486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340727738089
                                         uncertainty =       0.004827455486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412787189
  error estimate for blocks of size 2^( 2) =       0.000425595820
  error estimate for blocks of size 2^( 3) =       0.000438069662
  error estimate for blocks of size 2^( 4) =       0.000449976104
  error estimate for blocks of size 2^( 5) =       0.000460313587
  error estimate for blocks of size 2^( 6) =       0.000468230097
  error estimate for blocks of size 2^( 7) =       0.000475460478

      target function =                  N/A
              le_mean =     -16.906612625617
             les_mean =     286.174336829823
             stat err =       0.000463495067
             autocorr =       1.260775643403
              std dev =       0.583769241692
             le_variance =       0.340786527545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661262562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906612625617       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906612846424       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906612843769       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906612878465       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906612961341       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906612935613       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906612957480       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906612995599       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.096667e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906612625617       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906612682651       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906612681789       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906612690844       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906612711399       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906612705759       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906612711113       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906612720644       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.299247e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906612625617       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906612639995       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906612639768       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906612642055       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906612647182       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906612645831       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906612647162       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906612649542       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.264257e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6457e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.937405e-01 1 1  ON 0
 uu_1                 1.269604e-01 1 1  ON 1
 uu_2                 2.528359e-02 1 1  ON 2
 uu_3                -3.745331e-02 1 1  ON 3
 uu_4                -8.381963e-02 1 1  ON 4
 uu_5                -1.197259e-01 1 1  ON 5
 uu_6                -1.480908e-01 1 1  ON 6
 uu_7                -1.632327e-01 1 1  ON 7
 uu_8                -1.559513e-01 1 1  ON 8
 uu_9                -1.292376e-01 1 1  ON 9
 ud_0                 4.544844e-01 1 1  ON 10
 ud_1                 1.894340e-01 1 1  ON 11
 ud_2                 7.024410e-02 1 1  ON 12
 ud_3                -8.498413e-05 1 1  ON 13
 ud_4                -5.791159e-02 1 1  ON 14
 ud_5                -1.004310e-01 1 1  ON 15
 ud_6                -1.295123e-01 1 1  ON 16
 ud_7                -1.476066e-01 1 1  ON 17
 ud_8                -1.497804e-01 1 1  ON 18
 ud_9                -1.418952e-01 1 1  ON 19
 eO_0                -7.048750e-01 1 1  ON 20
 eO_1                -3.858976e-01 1 1  ON 21
 eO_2                 2.749394e-02 1 1  ON 22
 eO_3                 3.433257e-01 1 1  ON 23
 eO_4                 5.678300e-01 1 1  ON 24
 eO_5                 5.253336e-01 1 1  ON 25
 eO_6                 2.818833e-01 1 1  ON 26
 eO_7                -6.489622e-02 1 1  ON 27
 eO_8                -3.279989e-01 1 1  ON 28
 eO_9                -2.241622e-01 1 1  ON 29
eH1_0                -2.901836e-01 1 1  ON 30
eH1_1                -1.878345e-01 1 1  ON 31
eH1_2                -1.402360e-01 1 1  ON 32
eH1_3                -8.512073e-02 1 1  ON 33
eH1_4                -3.526990e-02 1 1  ON 34
eH1_5                 4.413275e-03 1 1  ON 35
eH1_6                 7.303629e-02 1 1  ON 36
eH1_7                 1.568539e-01 1 1  ON 37
eH1_8                 2.275276e-01 1 1  ON 38
eH1_9                 2.102798e-01 1 1  ON 39
eH2_0                -2.887671e-01 1 1  ON 40
eH2_1                -1.862256e-01 1 1  ON 41
eH2_2                -1.382869e-01 1 1  ON 42
eH2_3                -8.299062e-02 1 1  ON 43
eH2_4                -3.295022e-02 1 1  ON 44
eH2_5                 5.455846e-03 1 1  ON 45
eH2_6                 7.444483e-02 1 1  ON 46
eH2_7                 1.561213e-01 1 1  ON 47
eH2_8                 2.243275e-01 1 1  ON 48
eH2_9                 2.359501e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.7965
    reference variance = 0.663253
====================================================
  Execution time = 2.0883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3724e-01
  Total weights = 2.0000e+06
  Execution time = 1.9068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337110238387
                                         uncertainty =       0.003489854815

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337110238387
                                         uncertainty =       0.003489854815

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410632892
  error estimate for blocks of size 2^( 2) =       0.000423338867
  error estimate for blocks of size 2^( 3) =       0.000436270223
  error estimate for blocks of size 2^( 4) =       0.000448178308
  error estimate for blocks of size 2^( 5) =       0.000458539657
  error estimate for blocks of size 2^( 6) =       0.000466843933
  error estimate for blocks of size 2^( 7) =       0.000471157904

      target function =                  N/A
              le_mean =     -16.905436994489
             les_mean =     286.131038549422
             stat err =       0.000461179951
             autocorr =       1.261343490773
              std dev =       0.580722604527
             le_variance =       0.337238743409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337110423799
                                         uncertainty =       0.003489843577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337110423799
                                         uncertainty =       0.003489843577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410633012
  error estimate for blocks of size 2^( 2) =       0.000423338810
  error estimate for blocks of size 2^( 3) =       0.000436270132
  error estimate for blocks of size 2^( 4) =       0.000448178252
  error estimate for blocks of size 2^( 5) =       0.000458539408
  error estimate for blocks of size 2^( 6) =       0.000466844243
  error estimate for blocks of size 2^( 7) =       0.000471159269

      target function =                  N/A
              le_mean =     -16.905437063036
             les_mean =     286.131041064343
             stat err =       0.000461180293
             autocorr =       1.261344625837
              std dev =       0.580722774383
             le_variance =       0.337238940688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337109351462
                                         uncertainty =       0.003489837899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337109351462
                                         uncertainty =       0.003489837899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410632355
  error estimate for blocks of size 2^( 2) =       0.000423338269
  error estimate for blocks of size 2^( 3) =       0.000436269637
  error estimate for blocks of size 2^( 4) =       0.000448177763
  error estimate for blocks of size 2^( 5) =       0.000458539019
  error estimate for blocks of size 2^( 6) =       0.000466843597
  error estimate for blocks of size 2^( 7) =       0.000471158144

      target function =                  N/A
              le_mean =     -16.905437033840
             les_mean =     286.131038998991
             stat err =       0.000461179630
             autocorr =       1.261345033732
              std dev =       0.580721846045
             le_variance =       0.337237862473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337110090861
                                         uncertainty =       0.003489852291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337110090861
                                         uncertainty =       0.003489852291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410632802
  error estimate for blocks of size 2^( 2) =       0.000423338771
  error estimate for blocks of size 2^( 3) =       0.000436270129
  error estimate for blocks of size 2^( 4) =       0.000448178221
  error estimate for blocks of size 2^( 5) =       0.000458539558
  error estimate for blocks of size 2^( 6) =       0.000466843873
  error estimate for blocks of size 2^( 7) =       0.000471157917

      target function =                  N/A
              le_mean =     -16.905436999417
             les_mean =     286.131038569283
             stat err =       0.000461179892
             autocorr =       1.261343718513
              std dev =       0.580722478154
             le_variance =       0.337238596633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905436994489        initial
     3.9062e+00     3.9062e+01             5.0967e-05       -16.905437063036  <--
     1.5625e+01     1.5625e+02             1.2992e-05       -16.905437033840
     6.2500e+01     6.2500e+02             3.2643e-06       -16.905436999417

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.0492e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.937512e-01 1 1  ON 0
 uu_1                 1.269513e-01 1 1  ON 1
 uu_2                 2.528583e-02 1 1  ON 2
 uu_3                -3.746610e-02 1 1  ON 3
 uu_4                -8.381569e-02 1 1  ON 4
 uu_5                -1.197256e-01 1 1  ON 5
 uu_6                -1.480854e-01 1 1  ON 6
 uu_7                -1.632382e-01 1 1  ON 7
 uu_8                -1.559643e-01 1 1  ON 8
 uu_9                -1.292483e-01 1 1  ON 9
 ud_0                 4.545038e-01 1 1  ON 10
 ud_1                 1.894614e-01 1 1  ON 11
 ud_2                 7.025789e-02 1 1  ON 12
 ud_3                -9.022091e-05 1 1  ON 13
 ud_4                -5.790953e-02 1 1  ON 14
 ud_5                -1.004381e-01 1 1  ON 15
 ud_6                -1.295107e-01 1 1  ON 16
 ud_7                -1.476287e-01 1 1  ON 17
 ud_8                -1.497904e-01 1 1  ON 18
 ud_9                -1.418931e-01 1 1  ON 19
 eO_0                -7.049004e-01 1 1  ON 20
 eO_1                -3.858754e-01 1 1  ON 21
 eO_2                 2.749928e-02 1 1  ON 22
 eO_3                 3.433564e-01 1 1  ON 23
 eO_4                 5.678410e-01 1 1  ON 24
 eO_5                 5.253309e-01 1 1  ON 25
 eO_6                 2.818825e-01 1 1  ON 26
 eO_7                -6.489806e-02 1 1  ON 27
 eO_8                -3.280153e-01 1 1  ON 28
 eO_9                -2.241797e-01 1 1  ON 29
eH1_0                -2.902216e-01 1 1  ON 30
eH1_1                -1.878388e-01 1 1  ON 31
eH1_2                -1.402265e-01 1 1  ON 32
eH1_3                -8.512225e-02 1 1  ON 33
eH1_4                -3.525485e-02 1 1  ON 34
eH1_5                 4.408149e-03 1 1  ON 35
eH1_6                 7.303614e-02 1 1  ON 36
eH1_7                 1.568602e-01 1 1  ON 37
eH1_8                 2.275293e-01 1 1  ON 38
eH1_9                 2.102878e-01 1 1  ON 39
eH2_0                -2.887901e-01 1 1  ON 40
eH2_1                -1.862409e-01 1 1  ON 41
eH2_2                -1.382800e-01 1 1  ON 42
eH2_3                -8.300524e-02 1 1  ON 43
eH2_4                -3.293258e-02 1 1  ON 44
eH2_5                 5.465624e-03 1 1  ON 45
eH2_6                 7.443875e-02 1 1  ON 46
eH2_7                 1.561167e-01 1 1  ON 47
eH2_8                 2.243289e-01 1 1  ON 48
eH2_9                 2.359629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6956e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6890e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9374
    reference variance = 0.201432
====================================================
  Execution time = 2.0709e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4140e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341388709241
                                         uncertainty =       0.004819063379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341388709241
                                         uncertainty =       0.004819063379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413159012
  error estimate for blocks of size 2^( 2) =       0.000426159313
  error estimate for blocks of size 2^( 3) =       0.000439038610
  error estimate for blocks of size 2^( 4) =       0.000451179534
  error estimate for blocks of size 2^( 5) =       0.000461481744
  error estimate for blocks of size 2^( 6) =       0.000468710847
  error estimate for blocks of size 2^( 7) =       0.000474153963

      target function =                  N/A
              le_mean =     -16.906023305590
             les_mean =     286.155024576163
             stat err =       0.000463881522
             autocorr =       1.260606920910
              std dev =       0.584295077589
             le_variance =       0.341400737695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602330559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023305590       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023554448       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906023747855       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906023582193       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906023624807       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906023616132       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906023557165       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906023582202       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.940397e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023305590       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023376907       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906023441196       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906023395310       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906023397782       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906023400772       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906023382525       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906023384987       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.222068e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906023305590       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906023324097       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906023341394       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906023329712       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906023329759       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906023330819       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906023326231       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906023326513       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.325784e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6279e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.937698e-01 1 1  ON 0
 uu_1                 1.269503e-01 1 1  ON 1
 uu_2                 2.528355e-02 1 1  ON 2
 uu_3                -3.747486e-02 1 1  ON 3
 uu_4                -8.382919e-02 1 1  ON 4
 uu_5                -1.197152e-01 1 1  ON 5
 uu_6                -1.480668e-01 1 1  ON 6
 uu_7                -1.632579e-01 1 1  ON 7
 uu_8                -1.559733e-01 1 1  ON 8
 uu_9                -1.292563e-01 1 1  ON 9
 ud_0                 4.545560e-01 1 1  ON 10
 ud_1                 1.895008e-01 1 1  ON 11
 ud_2                 7.026221e-02 1 1  ON 12
 ud_3                -9.925192e-05 1 1  ON 13
 ud_4                -5.791896e-02 1 1  ON 14
 ud_5                -1.004402e-01 1 1  ON 15
 ud_6                -1.295121e-01 1 1  ON 16
 ud_7                -1.476361e-01 1 1  ON 17
 ud_8                -1.498154e-01 1 1  ON 18
 ud_9                -1.419000e-01 1 1  ON 19
 eO_0                -7.049167e-01 1 1  ON 20
 eO_1                -3.858786e-01 1 1  ON 21
 eO_2                 2.753401e-02 1 1  ON 22
 eO_3                 3.433770e-01 1 1  ON 23
 eO_4                 5.678666e-01 1 1  ON 24
 eO_5                 5.253310e-01 1 1  ON 25
 eO_6                 2.818880e-01 1 1  ON 26
 eO_7                -6.490580e-02 1 1  ON 27
 eO_8                -3.280388e-01 1 1  ON 28
 eO_9                -2.242083e-01 1 1  ON 29
eH1_0                -2.902668e-01 1 1  ON 30
eH1_1                -1.878619e-01 1 1  ON 31
eH1_2                -1.402206e-01 1 1  ON 32
eH1_3                -8.513342e-02 1 1  ON 33
eH1_4                -3.522617e-02 1 1  ON 34
eH1_5                 4.407649e-03 1 1  ON 35
eH1_6                 7.304638e-02 1 1  ON 36
eH1_7                 1.568651e-01 1 1  ON 37
eH1_8                 2.275362e-01 1 1  ON 38
eH1_9                 2.103031e-01 1 1  ON 39
eH2_0                -2.888382e-01 1 1  ON 40
eH2_1                -1.862406e-01 1 1  ON 41
eH2_2                -1.382829e-01 1 1  ON 42
eH2_3                -8.303256e-02 1 1  ON 43
eH2_4                -3.292579e-02 1 1  ON 44
eH2_5                 5.477680e-03 1 1  ON 45
eH2_6                 7.444270e-02 1 1  ON 46
eH2_7                 1.561338e-01 1 1  ON 47
eH2_8                 2.243366e-01 1 1  ON 48
eH2_9                 2.359755e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.174854
====================================================
  Execution time = 2.2482e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4368e-01
  Total weights = 2.0000e+06
  Execution time = 1.8985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343698824878
                                         uncertainty =       0.007429298761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343698824878
                                         uncertainty =       0.007429298761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414512898
  error estimate for blocks of size 2^( 2) =       0.000427049067
  error estimate for blocks of size 2^( 3) =       0.000439890798
  error estimate for blocks of size 2^( 4) =       0.000452312161
  error estimate for blocks of size 2^( 5) =       0.000462981009
  error estimate for blocks of size 2^( 6) =       0.000470291689
  error estimate for blocks of size 2^( 7) =       0.000475742295

      target function =                  N/A
              le_mean =     -16.906023150762
             les_mean =     286.157260487370
             stat err =       0.000465331788
             autocorr =       1.260228643378
              std dev =       0.586209762028
             le_variance =       0.343641885097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822445293
                                         uncertainty =       0.007430582839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822445293
                                         uncertainty =       0.007430582839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414587461
  error estimate for blocks of size 2^( 2) =       0.000427119044
  error estimate for blocks of size 2^( 3) =       0.000439955213
  error estimate for blocks of size 2^( 4) =       0.000452373191
  error estimate for blocks of size 2^( 5) =       0.000463037792
  error estimate for blocks of size 2^( 6) =       0.000470348671
  error estimate for blocks of size 2^( 7) =       0.000475797750

      target function =                  N/A
              le_mean =     -16.906022911159
             les_mean =     286.157376026066
             stat err =       0.000465389351
             autocorr =       1.260087079175
              std dev =       0.586315209851
             le_variance =       0.343765525302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343766377801
                                         uncertainty =       0.007430035615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343766377801
                                         uncertainty =       0.007430035615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414553645
  error estimate for blocks of size 2^( 2) =       0.000427087264
  error estimate for blocks of size 2^( 3) =       0.000439925881
  error estimate for blocks of size 2^( 4) =       0.000452345328
  error estimate for blocks of size 2^( 5) =       0.000463011699
  error estimate for blocks of size 2^( 6) =       0.000470322522
  error estimate for blocks of size 2^( 7) =       0.000475772039

      target function =                  N/A
              le_mean =     -16.906022924793
             les_mean =     286.157320410668
             stat err =       0.000465362897
             autocorr =       1.260149388345
              std dev =       0.586267386848
             le_variance =       0.343709448881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343707419259
                                         uncertainty =       0.007429393883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343707419259
                                         uncertainty =       0.007429393883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414518082
  error estimate for blocks of size 2^( 2) =       0.000427053922
  error estimate for blocks of size 2^( 3) =       0.000439895250
  error estimate for blocks of size 2^( 4) =       0.000452316364
  error estimate for blocks of size 2^( 5) =       0.000462984888
  error estimate for blocks of size 2^( 6) =       0.000470295587
  error estimate for blocks of size 2^( 7) =       0.000475746039

      target function =                  N/A
              le_mean =     -16.906023114311
             les_mean =     286.157267850663
             stat err =       0.000465335720
             autocorr =       1.260218413876
              std dev =       0.586217093635
             le_variance =       0.343650480869


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906023150762        initial  <--
     9.7656e-01     9.7656e+00             1.9404e-04       -16.906022911159
     3.9062e+00     3.9062e+01             5.2221e-05       -16.906022924793
     1.5625e+01     1.5625e+02             1.3258e-05       -16.906023114311

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1049
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.937512e-01 1 1  ON 0
 uu_1                 1.269513e-01 1 1  ON 1
 uu_2                 2.528583e-02 1 1  ON 2
 uu_3                -3.746610e-02 1 1  ON 3
 uu_4                -8.381569e-02 1 1  ON 4
 uu_5                -1.197256e-01 1 1  ON 5
 uu_6                -1.480854e-01 1 1  ON 6
 uu_7                -1.632382e-01 1 1  ON 7
 uu_8                -1.559643e-01 1 1  ON 8
 uu_9                -1.292483e-01 1 1  ON 9
 ud_0                 4.545038e-01 1 1  ON 10
 ud_1                 1.894614e-01 1 1  ON 11
 ud_2                 7.025789e-02 1 1  ON 12
 ud_3                -9.022091e-05 1 1  ON 13
 ud_4                -5.790953e-02 1 1  ON 14
 ud_5                -1.004381e-01 1 1  ON 15
 ud_6                -1.295107e-01 1 1  ON 16
 ud_7                -1.476287e-01 1 1  ON 17
 ud_8                -1.497904e-01 1 1  ON 18
 ud_9                -1.418931e-01 1 1  ON 19
 eO_0                -7.049004e-01 1 1  ON 20
 eO_1                -3.858754e-01 1 1  ON 21
 eO_2                 2.749928e-02 1 1  ON 22
 eO_3                 3.433564e-01 1 1  ON 23
 eO_4                 5.678410e-01 1 1  ON 24
 eO_5                 5.253309e-01 1 1  ON 25
 eO_6                 2.818825e-01 1 1  ON 26
 eO_7                -6.489806e-02 1 1  ON 27
 eO_8                -3.280153e-01 1 1  ON 28
 eO_9                -2.241797e-01 1 1  ON 29
eH1_0                -2.902216e-01 1 1  ON 30
eH1_1                -1.878388e-01 1 1  ON 31
eH1_2                -1.402265e-01 1 1  ON 32
eH1_3                -8.512225e-02 1 1  ON 33
eH1_4                -3.525485e-02 1 1  ON 34
eH1_5                 4.408149e-03 1 1  ON 35
eH1_6                 7.303614e-02 1 1  ON 36
eH1_7                 1.568602e-01 1 1  ON 37
eH1_8                 2.275293e-01 1 1  ON 38
eH1_9                 2.102878e-01 1 1  ON 39
eH2_0                -2.887901e-01 1 1  ON 40
eH2_1                -1.862409e-01 1 1  ON 41
eH2_2                -1.382800e-01 1 1  ON 42
eH2_3                -8.300524e-02 1 1  ON 43
eH2_4                -3.293258e-02 1 1  ON 44
eH2_5                 5.465624e-03 1 1  ON 45
eH2_6                 7.443875e-02 1 1  ON 46
eH2_7                 1.561167e-01 1 1  ON 47
eH2_8                 2.243289e-01 1 1  ON 48
eH2_9                 2.359629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8391e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9052
    reference variance = 0.288305
====================================================
  Execution time = 2.0958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335016076560
                                         uncertainty =       0.002941028889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335016076560
                                         uncertainty =       0.002941028889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409287638
  error estimate for blocks of size 2^( 2) =       0.000422192528
  error estimate for blocks of size 2^( 3) =       0.000435306969
  error estimate for blocks of size 2^( 4) =       0.000448697548
  error estimate for blocks of size 2^( 5) =       0.000459385249
  error estimate for blocks of size 2^( 6) =       0.000468890260
  error estimate for blocks of size 2^( 7) =       0.000474078596

      target function =                  N/A
              le_mean =     -16.906223526464
             les_mean =     286.155426501282
             stat err =       0.000462762913
             autocorr =       1.278379614027
              std dev =       0.578820129243
             le_variance =       0.335032742017


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622352646e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223526464       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223584486       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223608300       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223726011       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223757856       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223777410       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223759112       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906223754127       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.180132e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223526464       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223541189       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223547189       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223577346       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223585526       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223590529       residual = 9.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223586043       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.703900e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906223526464       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906223530160       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906223531663       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906223539249       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906223541309       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906223542567       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906223541452       residual = 9.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.434022e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6483e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.937517e-01 1 1  ON 0
 uu_1                 1.269508e-01 1 1  ON 1
 uu_2                 2.528676e-02 1 1  ON 2
 uu_3                -3.746839e-02 1 1  ON 3
 uu_4                -8.381455e-02 1 1  ON 4
 uu_5                -1.197242e-01 1 1  ON 5
 uu_6                -1.480872e-01 1 1  ON 6
 uu_7                -1.632425e-01 1 1  ON 7
 uu_8                -1.559625e-01 1 1  ON 8
 uu_9                -1.292471e-01 1 1  ON 9
 ud_0                 4.545057e-01 1 1  ON 10
 ud_1                 1.894629e-01 1 1  ON 11
 ud_2                 7.025658e-02 1 1  ON 12
 ud_3                -9.592481e-05 1 1  ON 13
 ud_4                -5.790947e-02 1 1  ON 14
 ud_5                -1.004410e-01 1 1  ON 15
 ud_6                -1.295074e-01 1 1  ON 16
 ud_7                -1.476281e-01 1 1  ON 17
 ud_8                -1.497878e-01 1 1  ON 18
 ud_9                -1.418923e-01 1 1  ON 19
 eO_0                -7.049058e-01 1 1  ON 20
 eO_1                -3.858745e-01 1 1  ON 21
 eO_2                 2.750292e-02 1 1  ON 22
 eO_3                 3.433605e-01 1 1  ON 23
 eO_4                 5.678422e-01 1 1  ON 24
 eO_5                 5.253294e-01 1 1  ON 25
 eO_6                 2.818827e-01 1 1  ON 26
 eO_7                -6.489770e-02 1 1  ON 27
 eO_8                -3.280157e-01 1 1  ON 28
 eO_9                -2.241819e-01 1 1  ON 29
eH1_0                -2.902270e-01 1 1  ON 30
eH1_1                -1.878382e-01 1 1  ON 31
eH1_2                -1.402254e-01 1 1  ON 32
eH1_3                -8.512498e-02 1 1  ON 33
eH1_4                -3.525515e-02 1 1  ON 34
eH1_5                 4.406939e-03 1 1  ON 35
eH1_6                 7.303850e-02 1 1  ON 36
eH1_7                 1.568601e-01 1 1  ON 37
eH1_8                 2.275304e-01 1 1  ON 38
eH1_9                 2.102905e-01 1 1  ON 39
eH2_0                -2.887945e-01 1 1  ON 40
eH2_1                -1.862393e-01 1 1  ON 41
eH2_2                -1.382811e-01 1 1  ON 42
eH2_3                -8.300660e-02 1 1  ON 43
eH2_4                -3.293271e-02 1 1  ON 44
eH2_5                 5.463781e-03 1 1  ON 45
eH2_6                 7.443970e-02 1 1  ON 46
eH2_7                 1.561196e-01 1 1  ON 47
eH2_8                 2.243300e-01 1 1  ON 48
eH2_9                 2.359640e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8438
    reference variance = 0.325375
====================================================
  Execution time = 2.0486e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3289e-01
  Total weights = 2.0000e+06
  Execution time = 1.9049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332950886036
                                         uncertainty =       0.003725207005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332950886036
                                         uncertainty =       0.003725207005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407972721
  error estimate for blocks of size 2^( 2) =       0.000420421347
  error estimate for blocks of size 2^( 3) =       0.000433530322
  error estimate for blocks of size 2^( 4) =       0.000444897686
  error estimate for blocks of size 2^( 5) =       0.000455638489
  error estimate for blocks of size 2^( 6) =       0.000463494579
  error estimate for blocks of size 2^( 7) =       0.000468375779

      target function =                  N/A
              le_mean =     -16.906221314515
             les_mean =     286.153202450703
             stat err =       0.000458101633
             autocorr =       1.260844216296
              std dev =       0.576960554782
             le_variance =       0.332883481775

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332959811531
                                         uncertainty =       0.003725337296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332959811531
                                         uncertainty =       0.003725337296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407978188
  error estimate for blocks of size 2^( 2) =       0.000420426578
  error estimate for blocks of size 2^( 3) =       0.000433535222
  error estimate for blocks of size 2^( 4) =       0.000444902135
  error estimate for blocks of size 2^( 5) =       0.000455642862
  error estimate for blocks of size 2^( 6) =       0.000463498324
  error estimate for blocks of size 2^( 7) =       0.000468379554

      target function =                  N/A
              le_mean =     -16.906221364567
             les_mean =     286.153213064795
             stat err =       0.000458105719
             autocorr =       1.260832914101
              std dev =       0.576968286397
             le_variance =       0.332892403508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332954915163
                                         uncertainty =       0.003725268413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332954915163
                                         uncertainty =       0.003725268413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407975189
  error estimate for blocks of size 2^( 2) =       0.000420423706
  error estimate for blocks of size 2^( 3) =       0.000433532526
  error estimate for blocks of size 2^( 4) =       0.000444899664
  error estimate for blocks of size 2^( 5) =       0.000455640444
  error estimate for blocks of size 2^( 6) =       0.000463496207
  error estimate for blocks of size 2^( 7) =       0.000468377425

      target function =                  N/A
              le_mean =     -16.906221339176
             les_mean =     286.153207311713
             stat err =       0.000458103435
             autocorr =       1.260838880650
              std dev =       0.576964044760
             le_variance =       0.332887508946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332951384977
                                         uncertainty =       0.003725214662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332951384977
                                         uncertainty =       0.003725214662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407973026
  error estimate for blocks of size 2^( 2) =       0.000420421639
  error estimate for blocks of size 2^( 3) =       0.000433530595
  error estimate for blocks of size 2^( 4) =       0.000444897930
  error estimate for blocks of size 2^( 5) =       0.000455638731
  error estimate for blocks of size 2^( 6) =       0.000463494780
  error estimate for blocks of size 2^( 7) =       0.000468375982

      target function =                  N/A
              le_mean =     -16.906221317519
             les_mean =     286.153203050959
             stat err =       0.000458101856
             autocorr =       1.260843552074
              std dev =       0.576960986955
             le_variance =       0.332883980468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906221314515        initial
     9.7656e+00     9.7656e+01             2.1801e-05       -16.906221364567  <--
     3.9062e+01     3.9062e+02             5.7039e-06       -16.906221339176
     1.5625e+02     1.5625e+03             1.4340e-06       -16.906221317519

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 3.0095e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.937540e-01 1 1  ON 0
 uu_1                 1.269495e-01 1 1  ON 1
 uu_2                 2.528865e-02 1 1  ON 2
 uu_3                -3.747465e-02 1 1  ON 3
 uu_4                -8.381201e-02 1 1  ON 4
 uu_5                -1.197209e-01 1 1  ON 5
 uu_6                -1.480919e-01 1 1  ON 6
 uu_7                -1.632556e-01 1 1  ON 7
 uu_8                -1.559570e-01 1 1  ON 8
 uu_9                -1.292432e-01 1 1  ON 9
 ud_0                 4.545119e-01 1 1  ON 10
 ud_1                 1.894674e-01 1 1  ON 11
 ud_2                 7.025251e-02 1 1  ON 12
 ud_3                -1.120222e-04 1 1  ON 13
 ud_4                -5.791032e-02 1 1  ON 14
 ud_5                -1.004494e-01 1 1  ON 15
 ud_6                -1.294977e-01 1 1  ON 16
 ud_7                -1.476266e-01 1 1  ON 17
 ud_8                -1.497796e-01 1 1  ON 18
 ud_9                -1.418898e-01 1 1  ON 19
 eO_0                -7.049216e-01 1 1  ON 20
 eO_1                -3.858720e-01 1 1  ON 21
 eO_2                 2.751341e-02 1 1  ON 22
 eO_3                 3.433730e-01 1 1  ON 23
 eO_4                 5.678462e-01 1 1  ON 24
 eO_5                 5.253249e-01 1 1  ON 25
 eO_6                 2.818834e-01 1 1  ON 26
 eO_7                -6.489655e-02 1 1  ON 27
 eO_8                -3.280172e-01 1 1  ON 28
 eO_9                -2.241891e-01 1 1  ON 29
eH1_0                -2.902434e-01 1 1  ON 30
eH1_1                -1.878360e-01 1 1  ON 31
eH1_2                -1.402223e-01 1 1  ON 32
eH1_3                -8.513350e-02 1 1  ON 33
eH1_4                -3.525693e-02 1 1  ON 34
eH1_5                 4.402965e-03 1 1  ON 35
eH1_6                 7.304590e-02 1 1  ON 36
eH1_7                 1.568601e-01 1 1  ON 37
eH1_8                 2.275339e-01 1 1  ON 38
eH1_9                 2.102989e-01 1 1  ON 39
eH2_0                -2.888078e-01 1 1  ON 40
eH2_1                -1.862348e-01 1 1  ON 41
eH2_2                -1.382850e-01 1 1  ON 42
eH2_3                -8.301087e-02 1 1  ON 43
eH2_4                -3.293277e-02 1 1  ON 44
eH2_5                 5.458594e-03 1 1  ON 45
eH2_6                 7.444268e-02 1 1  ON 46
eH2_7                 1.561285e-01 1 1  ON 47
eH2_8                 2.243338e-01 1 1  ON 48
eH2_9                 2.359674e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6585e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8885
    reference variance = 0.244788
====================================================
  Execution time = 2.0905e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336519101077
                                         uncertainty =       0.004117800628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336519101077
                                         uncertainty =       0.004117800628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410231718
  error estimate for blocks of size 2^( 2) =       0.000423260353
  error estimate for blocks of size 2^( 3) =       0.000436223124
  error estimate for blocks of size 2^( 4) =       0.000448525427
  error estimate for blocks of size 2^( 5) =       0.000459926968
  error estimate for blocks of size 2^( 6) =       0.000468659687
  error estimate for blocks of size 2^( 7) =       0.000473483463

      target function =                  N/A
              le_mean =     -16.906823710565
             les_mean =     286.177267936387
             stat err =       0.000462648886
             autocorr =       1.271875411030
              std dev =       0.580155259006
             le_variance =       0.336580124552


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682371057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906823710565       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906823829789       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906823804824       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906823740168       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906823749375       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906823678237       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906823714392       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906823733870       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.873755e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906823710565       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906823742017       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906823734209       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906823715044       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906823714061       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906823693919       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906823698926       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906823704266       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.018672e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906823710565       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906823718538       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906823716477       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906823711475       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906823710964       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906823705739       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906823706667       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906823708008       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 5.080264e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073549 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6506e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.937517e-01 1 1  ON 0
 uu_1                 1.269427e-01 1 1  ON 1
 uu_2                 2.529186e-02 1 1  ON 2
 uu_3                -3.747752e-02 1 1  ON 3
 uu_4                -8.380843e-02 1 1  ON 4
 uu_5                -1.197188e-01 1 1  ON 5
 uu_6                -1.481059e-01 1 1  ON 6
 uu_7                -1.632602e-01 1 1  ON 7
 uu_8                -1.559432e-01 1 1  ON 8
 uu_9                -1.292393e-01 1 1  ON 9
 ud_0                 4.545306e-01 1 1  ON 10
 ud_1                 1.894592e-01 1 1  ON 11
 ud_2                 7.024986e-02 1 1  ON 12
 ud_3                -1.246599e-04 1 1  ON 13
 ud_4                -5.791397e-02 1 1  ON 14
 ud_5                -1.004561e-01 1 1  ON 15
 ud_6                -1.294943e-01 1 1  ON 16
 ud_7                -1.476219e-01 1 1  ON 17
 ud_8                -1.497729e-01 1 1  ON 18
 ud_9                -1.418835e-01 1 1  ON 19
 eO_0                -7.049368e-01 1 1  ON 20
 eO_1                -3.858612e-01 1 1  ON 21
 eO_2                 2.752169e-02 1 1  ON 22
 eO_3                 3.433766e-01 1 1  ON 23
 eO_4                 5.678440e-01 1 1  ON 24
 eO_5                 5.253331e-01 1 1  ON 25
 eO_6                 2.818826e-01 1 1  ON 26
 eO_7                -6.489616e-02 1 1  ON 27
 eO_8                -3.280191e-01 1 1  ON 28
 eO_9                -2.241978e-01 1 1  ON 29
eH1_0                -2.902635e-01 1 1  ON 30
eH1_1                -1.878457e-01 1 1  ON 31
eH1_2                -1.402066e-01 1 1  ON 32
eH1_3                -8.513158e-02 1 1  ON 33
eH1_4                -3.525694e-02 1 1  ON 34
eH1_5                 4.400292e-03 1 1  ON 35
eH1_6                 7.304765e-02 1 1  ON 36
eH1_7                 1.568575e-01 1 1  ON 37
eH1_8                 2.275351e-01 1 1  ON 38
eH1_9                 2.103099e-01 1 1  ON 39
eH2_0                -2.888276e-01 1 1  ON 40
eH2_1                -1.862330e-01 1 1  ON 41
eH2_2                -1.382803e-01 1 1  ON 42
eH2_3                -8.301646e-02 1 1  ON 43
eH2_4                -3.293136e-02 1 1  ON 44
eH2_5                 5.458538e-03 1 1  ON 45
eH2_6                 7.444477e-02 1 1  ON 46
eH2_7                 1.561348e-01 1 1  ON 47
eH2_8                 2.243348e-01 1 1  ON 48
eH2_9                 2.359705e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9246
    reference variance = 0.299733
====================================================
  Execution time = 2.0321e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3981e-01
  Total weights = 2.0000e+06
  Execution time = 1.8975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339792290484
                                         uncertainty =       0.004272293868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339792290484
                                         uncertainty =       0.004272293868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412188105
  error estimate for blocks of size 2^( 2) =       0.000424970061
  error estimate for blocks of size 2^( 3) =       0.000438231456
  error estimate for blocks of size 2^( 4) =       0.000450121287
  error estimate for blocks of size 2^( 5) =       0.000459781882
  error estimate for blocks of size 2^( 6) =       0.000466335283
  error estimate for blocks of size 2^( 7) =       0.000472300903

      target function =                  N/A
              le_mean =     -16.906373057220
             les_mean =     286.165247847076
             stat err =       0.000462134839
             autocorr =       1.257032513689
              std dev =       0.582922007731
             le_variance =       0.339798067097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840553651
                                         uncertainty =       0.004271422401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339840553651
                                         uncertainty =       0.004271422401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412217389
  error estimate for blocks of size 2^( 2) =       0.000424998458
  error estimate for blocks of size 2^( 3) =       0.000438258939
  error estimate for blocks of size 2^( 4) =       0.000450147306
  error estimate for blocks of size 2^( 5) =       0.000459808335
  error estimate for blocks of size 2^( 6) =       0.000466359706
  error estimate for blocks of size 2^( 7) =       0.000472327530

      target function =                  N/A
              le_mean =     -16.906373353917
             les_mean =     286.165306162933
             stat err =       0.000462160719
             autocorr =       1.256994696557
              std dev =       0.582963421520
             le_variance =       0.339846350831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339818782536
                                         uncertainty =       0.004271773656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339818782536
                                         uncertainty =       0.004271773656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412204180
  error estimate for blocks of size 2^( 2) =       0.000424985667
  error estimate for blocks of size 2^( 3) =       0.000438246543
  error estimate for blocks of size 2^( 4) =       0.000450135545
  error estimate for blocks of size 2^( 5) =       0.000459796393
  error estimate for blocks of size 2^( 6) =       0.000466348637
  error estimate for blocks of size 2^( 7) =       0.000472315469

      target function =                  N/A
              le_mean =     -16.906373224831
             les_mean =     286.165280018828
             stat err =       0.000462149011
             autocorr =       1.257011565125
              std dev =       0.582944741340
             le_variance =       0.339824571456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339795679131
                                         uncertainty =       0.004272225456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339795679131
                                         uncertainty =       0.004272225456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412190161
  error estimate for blocks of size 2^( 2) =       0.000424972058
  error estimate for blocks of size 2^( 3) =       0.000438233386
  error estimate for blocks of size 2^( 4) =       0.000450123109
  error estimate for blocks of size 2^( 5) =       0.000459783738
  error estimate for blocks of size 2^( 6) =       0.000466336989
  error estimate for blocks of size 2^( 7) =       0.000472302764

      target function =                  N/A
              le_mean =     -16.906373078413
             les_mean =     286.165251953944
             stat err =       0.000462136650
             autocorr =       1.257029825104
              std dev =       0.582924915712
             le_variance =       0.339801457358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906373057220        initial
     2.4414e+00     2.4414e+01             7.8738e-05       -16.906373353917  <--
     9.7656e+00     9.7656e+01             2.0187e-05       -16.906373224831
     3.9062e+01     3.9062e+02             5.0803e-06       -16.906373078413

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9929e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.937454e-01 1 1  ON 0
 uu_1                 1.269259e-01 1 1  ON 1
 uu_2                 2.529752e-02 1 1  ON 2
 uu_3                -3.748412e-02 1 1  ON 3
 uu_4                -8.380037e-02 1 1  ON 4
 uu_5                -1.197133e-01 1 1  ON 5
 uu_6                -1.481454e-01 1 1  ON 6
 uu_7                -1.632739e-01 1 1  ON 7
 uu_8                -1.559029e-01 1 1  ON 8
 uu_9                -1.292277e-01 1 1  ON 9
 ud_0                 4.545783e-01 1 1  ON 10
 ud_1                 1.894394e-01 1 1  ON 11
 ud_2                 7.024076e-02 1 1  ON 12
 ud_3                -1.583873e-04 1 1  ON 13
 ud_4                -5.792583e-02 1 1  ON 14
 ud_5                -1.004743e-01 1 1  ON 15
 ud_6                -1.294849e-01 1 1  ON 16
 ud_7                -1.476080e-01 1 1  ON 17
 ud_8                -1.497529e-01 1 1  ON 18
 ud_9                -1.418651e-01 1 1  ON 19
 eO_0                -7.049794e-01 1 1  ON 20
 eO_1                -3.858321e-01 1 1  ON 21
 eO_2                 2.754685e-02 1 1  ON 22
 eO_3                 3.433861e-01 1 1  ON 23
 eO_4                 5.678379e-01 1 1  ON 24
 eO_5                 5.253572e-01 1 1  ON 25
 eO_6                 2.818801e-01 1 1  ON 26
 eO_7                -6.489492e-02 1 1  ON 27
 eO_8                -3.280246e-01 1 1  ON 28
 eO_9                -2.242231e-01 1 1  ON 29
eH1_0                -2.903221e-01 1 1  ON 30
eH1_1                -1.878716e-01 1 1  ON 31
eH1_2                -1.401639e-01 1 1  ON 32
eH1_3                -8.512531e-02 1 1  ON 33
eH1_4                -3.525671e-02 1 1  ON 34
eH1_5                 4.392027e-03 1 1  ON 35
eH1_6                 7.305252e-02 1 1  ON 36
eH1_7                 1.568499e-01 1 1  ON 37
eH1_8                 2.275388e-01 1 1  ON 38
eH1_9                 2.103419e-01 1 1  ON 39
eH2_0                -2.888846e-01 1 1  ON 40
eH2_1                -1.862291e-01 1 1  ON 41
eH2_2                -1.382672e-01 1 1  ON 42
eH2_3                -8.303190e-02 1 1  ON 43
eH2_4                -3.292795e-02 1 1  ON 44
eH2_5                 5.458670e-03 1 1  ON 45
eH2_6                 7.445117e-02 1 1  ON 46
eH2_7                 1.561533e-01 1 1  ON 47
eH2_8                 2.243379e-01 1 1  ON 48
eH2_9                 2.359794e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.946
    reference variance = 1.17799
====================================================
  Execution time = 2.0881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3327e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333250058268
                                         uncertainty =       0.003238327357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333250058268
                                         uncertainty =       0.003238327357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408211148
  error estimate for blocks of size 2^( 2) =       0.000420780157
  error estimate for blocks of size 2^( 3) =       0.000434278566
  error estimate for blocks of size 2^( 4) =       0.000447499410
  error estimate for blocks of size 2^( 5) =       0.000458071566
  error estimate for blocks of size 2^( 6) =       0.000464340822
  error estimate for blocks of size 2^( 7) =       0.000466954879

      target function =                  N/A
              le_mean =     -16.905420146307
             les_mean =     286.126502839312
             stat err =       0.000459216669
             autocorr =       1.265509957714
              std dev =       0.577297741888
             le_variance =       0.333272682789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690542014631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905420146307       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905420072228       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905421637283       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905421995104       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905422538704       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905422804919       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905422712032       residual = 5.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905422512780       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905422527558       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.998541e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905420146307       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905420123732       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905420609885       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905420719757       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905420887896       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905420920005       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905420884224       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905420863525       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.037088e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905420146307       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905420140336       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905420269656       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905420300453       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905420345352       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905420350939       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905420339888       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905420336194       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.622621e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6368e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.937559e-01 1 1  ON 0
 uu_1                 1.269210e-01 1 1  ON 1
 uu_2                 2.524571e-02 1 1  ON 2
 uu_3                -3.750583e-02 1 1  ON 3
 uu_4                -8.383100e-02 1 1  ON 4
 uu_5                -1.197222e-01 1 1  ON 5
 uu_6                -1.481360e-01 1 1  ON 6
 uu_7                -1.633019e-01 1 1  ON 7
 uu_8                -1.558589e-01 1 1  ON 8
 uu_9                -1.291856e-01 1 1  ON 9
 ud_0                 4.546720e-01 1 1  ON 10
 ud_1                 1.895005e-01 1 1  ON 11
 ud_2                 7.024118e-02 1 1  ON 12
 ud_3                -2.218783e-04 1 1  ON 13
 ud_4                -5.796621e-02 1 1  ON 14
 ud_5                -1.005258e-01 1 1  ON 15
 ud_6                -1.295179e-01 1 1  ON 16
 ud_7                -1.476449e-01 1 1  ON 17
 ud_8                -1.496990e-01 1 1  ON 18
 ud_9                -1.418209e-01 1 1  ON 19
 eO_0                -7.050408e-01 1 1  ON 20
 eO_1                -3.858982e-01 1 1  ON 21
 eO_2                 2.763539e-02 1 1  ON 22
 eO_3                 3.434284e-01 1 1  ON 23
 eO_4                 5.678880e-01 1 1  ON 24
 eO_5                 5.253699e-01 1 1  ON 25
 eO_6                 2.818495e-01 1 1  ON 26
 eO_7                -6.489026e-02 1 1  ON 27
 eO_8                -3.280179e-01 1 1  ON 28
 eO_9                -2.242563e-01 1 1  ON 29
eH1_0                -2.904258e-01 1 1  ON 30
eH1_1                -1.879323e-01 1 1  ON 31
eH1_2                -1.401629e-01 1 1  ON 32
eH1_3                -8.510704e-02 1 1  ON 33
eH1_4                -3.524148e-02 1 1  ON 34
eH1_5                 4.394493e-03 1 1  ON 35
eH1_6                 7.307238e-02 1 1  ON 36
eH1_7                 1.568688e-01 1 1  ON 37
eH1_8                 2.275597e-01 1 1  ON 38
eH1_9                 2.103817e-01 1 1  ON 39
eH2_0                -2.889364e-01 1 1  ON 40
eH2_1                -1.862659e-01 1 1  ON 41
eH2_2                -1.382760e-01 1 1  ON 42
eH2_3                -8.305718e-02 1 1  ON 43
eH2_4                -3.292130e-02 1 1  ON 44
eH2_5                 5.475313e-03 1 1  ON 45
eH2_6                 7.447065e-02 1 1  ON 46
eH2_7                 1.561744e-01 1 1  ON 47
eH2_8                 2.243470e-01 1 1  ON 48
eH2_9                 2.360093e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8165
    reference variance = 0.226542
====================================================
  Execution time = 2.0298e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3481e-01
  Total weights = 2.0000e+06
  Execution time = 1.8702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334754685111
                                         uncertainty =       0.003736874447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334754685111
                                         uncertainty =       0.003736874447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409100542
  error estimate for blocks of size 2^( 2) =       0.000421680462
  error estimate for blocks of size 2^( 3) =       0.000434363802
  error estimate for blocks of size 2^( 4) =       0.000445478535
  error estimate for blocks of size 2^( 5) =       0.000455106901
  error estimate for blocks of size 2^( 6) =       0.000460878552
  error estimate for blocks of size 2^( 7) =       0.000466731144

      target function =                  N/A
              le_mean =     -16.906696803034
             les_mean =     286.171123129578
             stat err =       0.000457048783
             autocorr =       1.248144890882
              std dev =       0.578555535128
             le_variance =       0.334726507227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335019509341
                                         uncertainty =       0.003739832407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335019509341
                                         uncertainty =       0.003739832407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409262296
  error estimate for blocks of size 2^( 2) =       0.000421834847
  error estimate for blocks of size 2^( 3) =       0.000434510225
  error estimate for blocks of size 2^( 4) =       0.000445619349
  error estimate for blocks of size 2^( 5) =       0.000455243172
  error estimate for blocks of size 2^( 6) =       0.000461008664
  error estimate for blocks of size 2^( 7) =       0.000466851915

      target function =                  N/A
              le_mean =     -16.906698726219
             les_mean =     286.171452905937
             stat err =       0.000457180775
             autocorr =       1.247878911873
              std dev =       0.578784289963
             le_variance =       0.334991254308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334915519699
                                         uncertainty =       0.003738688640

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334915519699
                                         uncertainty =       0.003738688640

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409198785
  error estimate for blocks of size 2^( 2) =       0.000421774107
  error estimate for blocks of size 2^( 3) =       0.000434452391
  error estimate for blocks of size 2^( 4) =       0.000445563904
  error estimate for blocks of size 2^( 5) =       0.000455189464
  error estimate for blocks of size 2^( 6) =       0.000460957614
  error estimate for blocks of size 2^( 7) =       0.000466804607

      target function =                  N/A
              le_mean =     -16.906697937806
             les_mean =     286.171322284234
             stat err =       0.000457128897
             autocorr =       1.247983032606
              std dev =       0.578694471594
             le_variance =       0.334887291454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334775574748
                                         uncertainty =       0.003737110698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334775574748
                                         uncertainty =       0.003737110698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409113303
  error estimate for blocks of size 2^( 2) =       0.000421692616
  error estimate for blocks of size 2^( 3) =       0.000434375275
  error estimate for blocks of size 2^( 4) =       0.000445489588
  error estimate for blocks of size 2^( 5) =       0.000455117579
  error estimate for blocks of size 2^( 6) =       0.000460888778
  error estimate for blocks of size 2^( 7) =       0.000466740621

      target function =                  N/A
              le_mean =     -16.906696942184
             les_mean =     286.171148717192
             stat err =       0.000457059141
             autocorr =       1.248123601446
              std dev =       0.578573581920
             le_variance =       0.334747389695


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906696803034        initial
     6.1035e-01     6.1035e+00             3.9985e-04       -16.906698726219  <--
     2.4414e+00     2.4414e+01             1.0371e-04       -16.906697937806
     9.7656e+00     9.7656e+01             2.6226e-05       -16.906696942184

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9743e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.937627e-01 1 1  ON 0
 uu_1                 1.268896e-01 1 1  ON 1
 uu_2                 2.514124e-02 1 1  ON 2
 uu_3                -3.758233e-02 1 1  ON 3
 uu_4                -8.390726e-02 1 1  ON 4
 uu_5                -1.197574e-01 1 1  ON 5
 uu_6                -1.481109e-01 1 1  ON 6
 uu_7                -1.633743e-01 1 1  ON 7
 uu_8                -1.557371e-01 1 1  ON 8
 uu_9                -1.290631e-01 1 1  ON 9
 ud_0                 4.548943e-01 1 1  ON 10
 ud_1                 1.896442e-01 1 1  ON 11
 ud_2                 7.024813e-02 1 1  ON 12
 ud_3                -3.583306e-04 1 1  ON 13
 ud_4                -5.808027e-02 1 1  ON 14
 ud_5                -1.006585e-01 1 1  ON 15
 ud_6                -1.296006e-01 1 1  ON 16
 ud_7                -1.477464e-01 1 1  ON 17
 ud_8                -1.495517e-01 1 1  ON 18
 ud_9                -1.416911e-01 1 1  ON 19
 eO_0                -7.052315e-01 1 1  ON 20
 eO_1                -3.860225e-01 1 1  ON 21
 eO_2                 2.782337e-02 1 1  ON 22
 eO_3                 3.435521e-01 1 1  ON 23
 eO_4                 5.680368e-01 1 1  ON 24
 eO_5                 5.254157e-01 1 1  ON 25
 eO_6                 2.817669e-01 1 1  ON 26
 eO_7                -6.487682e-02 1 1  ON 27
 eO_8                -3.279996e-01 1 1  ON 28
 eO_9                -2.243555e-01 1 1  ON 29
eH1_0                -2.907220e-01 1 1  ON 30
eH1_1                -1.880819e-01 1 1  ON 31
eH1_2                -1.401813e-01 1 1  ON 32
eH1_3                -8.506165e-02 1 1  ON 33
eH1_4                -3.520609e-02 1 1  ON 34
eH1_5                 4.400452e-03 1 1  ON 35
eH1_6                 7.312809e-02 1 1  ON 36
eH1_7                 1.569259e-01 1 1  ON 37
eH1_8                 2.276218e-01 1 1  ON 38
eH1_9                 2.105007e-01 1 1  ON 39
eH2_0                -2.890891e-01 1 1  ON 40
eH2_1                -1.863662e-01 1 1  ON 41
eH2_2                -1.383233e-01 1 1  ON 42
eH2_3                -8.311641e-02 1 1  ON 43
eH2_4                -3.291536e-02 1 1  ON 44
eH2_5                 5.526270e-03 1 1  ON 45
eH2_6                 7.453115e-02 1 1  ON 46
eH2_7                 1.562403e-01 1 1  ON 47
eH2_8                 2.243747e-01 1 1  ON 48
eH2_9                 2.360985e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9207
    reference variance = 0.166902
====================================================
  Execution time = 2.0779e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3217e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332147046735
                                         uncertainty =       0.003100874978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332147046735
                                         uncertainty =       0.003100874978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407537427
  error estimate for blocks of size 2^( 2) =       0.000420210110
  error estimate for blocks of size 2^( 3) =       0.000432576383
  error estimate for blocks of size 2^( 4) =       0.000444976801
  error estimate for blocks of size 2^( 5) =       0.000455603132
  error estimate for blocks of size 2^( 6) =       0.000465506880
  error estimate for blocks of size 2^( 7) =       0.000470637706

      target function =                  N/A
              le_mean =     -16.906330672939
             les_mean =     286.156190164901
             stat err =       0.000459181130
             autocorr =       1.269501058294
              std dev =       0.576344955923
             le_variance =       0.332173508217


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633067294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330672939       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906331410539       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906332662488       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906331089886       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906331504566       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906331273241       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906330602059       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906330902927       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906331044881       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906331243346       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906331117935       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 9.651924e-04

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330672939       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330965385       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906331205396       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906330505563       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906330858285       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906330734552       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906330470691       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906330576627       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906330606263       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.908553e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906330672939       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330758598       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906330789849       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906330581064       residual = 9.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906330705159       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906330665137       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906330609206       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906330632399       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.700851e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6313e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.939134e-01 1 1  ON 0
 uu_1                 1.269427e-01 1 1  ON 1
 uu_2                 2.515710e-02 1 1  ON 2
 uu_3                -3.756726e-02 1 1  ON 3
 uu_4                -8.381727e-02 1 1  ON 4
 uu_5                -1.197770e-01 1 1  ON 5
 uu_6                -1.482774e-01 1 1  ON 6
 uu_7                -1.635119e-01 1 1  ON 7
 uu_8                -1.558287e-01 1 1  ON 8
 uu_9                -1.290439e-01 1 1  ON 9
 ud_0                 4.549444e-01 1 1  ON 10
 ud_1                 1.897605e-01 1 1  ON 11
 ud_2                 7.030151e-02 1 1  ON 12
 ud_3                -3.029468e-04 1 1  ON 13
 ud_4                -5.810741e-02 1 1  ON 14
 ud_5                -1.006863e-01 1 1  ON 15
 ud_6                -1.295791e-01 1 1  ON 16
 ud_7                -1.477296e-01 1 1  ON 17
 ud_8                -1.497369e-01 1 1  ON 18
 ud_9                -1.416938e-01 1 1  ON 19
 eO_0                -7.053568e-01 1 1  ON 20
 eO_1                -3.858109e-01 1 1  ON 21
 eO_2                 2.787912e-02 1 1  ON 22
 eO_3                 3.436469e-01 1 1  ON 23
 eO_4                 5.680128e-01 1 1  ON 24
 eO_5                 5.254289e-01 1 1  ON 25
 eO_6                 2.818714e-01 1 1  ON 26
 eO_7                -6.491609e-02 1 1  ON 27
 eO_8                -3.281307e-01 1 1  ON 28
 eO_9                -2.244866e-01 1 1  ON 29
eH1_0                -2.910128e-01 1 1  ON 30
eH1_1                -1.882918e-01 1 1  ON 31
eH1_2                -1.400963e-01 1 1  ON 32
eH1_3                -8.508991e-02 1 1  ON 33
eH1_4                -3.503916e-02 1 1  ON 34
eH1_5                 4.473221e-03 1 1  ON 35
eH1_6                 7.309380e-02 1 1  ON 36
eH1_7                 1.569699e-01 1 1  ON 37
eH1_8                 2.276717e-01 1 1  ON 38
eH1_9                 2.105825e-01 1 1  ON 39
eH2_0                -2.892881e-01 1 1  ON 40
eH2_1                -1.865926e-01 1 1  ON 41
eH2_2                -1.382577e-01 1 1  ON 42
eH2_3                -8.309080e-02 1 1  ON 43
eH2_4                -3.303868e-02 1 1  ON 44
eH2_5                 5.593390e-03 1 1  ON 45
eH2_6                 7.463105e-02 1 1  ON 46
eH2_7                 1.564196e-01 1 1  ON 47
eH2_8                 2.243677e-01 1 1  ON 48
eH2_9                 2.361409e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.220183
====================================================
  Execution time = 2.0689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3340e-01
  Total weights = 2.0000e+06
  Execution time = 1.8712e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506406031
                                         uncertainty =       0.002648911976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333506406031
                                         uncertainty =       0.002648911976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408295577
  error estimate for blocks of size 2^( 2) =       0.000421253115
  error estimate for blocks of size 2^( 3) =       0.000433788581
  error estimate for blocks of size 2^( 4) =       0.000445802735
  error estimate for blocks of size 2^( 5) =       0.000456447542
  error estimate for blocks of size 2^( 6) =       0.000463593085
  error estimate for blocks of size 2^( 7) =       0.000467598973

      target function =                  N/A
              le_mean =     -16.905983721225
             les_mean =     286.145695972411
             stat err =       0.000458360584
             autocorr =       1.260274579287
              std dev =       0.577417142806
             le_variance =       0.333410556806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333526050870
                                         uncertainty =       0.002648577521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333526050870
                                         uncertainty =       0.002648577521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408307566
  error estimate for blocks of size 2^( 2) =       0.000421263960
  error estimate for blocks of size 2^( 3) =       0.000433792904
  error estimate for blocks of size 2^( 4) =       0.000445799894
  error estimate for blocks of size 2^( 5) =       0.000456438823
  error estimate for blocks of size 2^( 6) =       0.000463587584
  error estimate for blocks of size 2^( 7) =       0.000467587678

      target function =                  N/A
              le_mean =     -16.905984439742
             les_mean =     286.145739846581
             stat err =       0.000458353495
             autocorr =       1.260161594423
              std dev =       0.577434097098
             le_variance =       0.333430136492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333479690838
                                         uncertainty =       0.002648042230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333479690838
                                         uncertainty =       0.002648042230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408279198
  error estimate for blocks of size 2^( 2) =       0.000421237080
  error estimate for blocks of size 2^( 3) =       0.000433768844
  error estimate for blocks of size 2^( 4) =       0.000445778616
  error estimate for blocks of size 2^( 5) =       0.000456418748
  error estimate for blocks of size 2^( 6) =       0.000463567204
  error estimate for blocks of size 2^( 7) =       0.000467568601

      target function =                  N/A
              le_mean =     -16.905984093957
             les_mean =     286.145681825513
             stat err =       0.000458333292
             autocorr =       1.260225615438
              std dev =       0.577393979083
             le_variance =       0.333383807082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333492650849
                                         uncertainty =       0.002648688641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333492650849
                                         uncertainty =       0.002648688641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408287154
  error estimate for blocks of size 2^( 2) =       0.000421244979
  error estimate for blocks of size 2^( 3) =       0.000433780113
  error estimate for blocks of size 2^( 4) =       0.000445793799
  error estimate for blocks of size 2^( 5) =       0.000456438008
  error estimate for blocks of size 2^( 6) =       0.000463584253
  error estimate for blocks of size 2^( 7) =       0.000467589519

      target function =                  N/A
              le_mean =     -16.905983674713
             les_mean =     286.145680643823
             stat err =       0.000458351395
             autocorr =       1.260276046087
              std dev =       0.577405231063
             le_variance =       0.333396800859


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905983721225        initial
     1.5259e-01     1.5259e+00             9.6519e-04       -16.905984439742  <--
     6.1035e-01     6.1035e+00             2.9086e-04       -16.905984093957
     2.4414e+00     2.4414e+01             7.7009e-05       -16.905983674713

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 3.0136e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.942347e-01 1 1  ON 0
 uu_1                 1.270778e-01 1 1  ON 1
 uu_2                 2.527336e-02 1 1  ON 2
 uu_3                -3.749114e-02 1 1  ON 3
 uu_4                -8.371659e-02 1 1  ON 4
 uu_5                -1.198236e-01 1 1  ON 5
 uu_6                -1.485906e-01 1 1  ON 6
 uu_7                -1.638624e-01 1 1  ON 7
 uu_8                -1.561015e-01 1 1  ON 8
 uu_9                -1.290087e-01 1 1  ON 9
 ud_0                 4.551497e-01 1 1  ON 10
 ud_1                 1.899689e-01 1 1  ON 11
 ud_2                 7.045405e-02 1 1  ON 12
 ud_3                -1.977975e-04 1 1  ON 13
 ud_4                -5.809069e-02 1 1  ON 14
 ud_5                -1.007020e-01 1 1  ON 15
 ud_6                -1.296170e-01 1 1  ON 16
 ud_7                -1.477032e-01 1 1  ON 17
 ud_8                -1.501676e-01 1 1  ON 18
 ud_9                -1.417112e-01 1 1  ON 19
 eO_0                -7.054438e-01 1 1  ON 20
 eO_1                -3.855222e-01 1 1  ON 21
 eO_2                 2.807094e-02 1 1  ON 22
 eO_3                 3.438614e-01 1 1  ON 23
 eO_4                 5.680340e-01 1 1  ON 24
 eO_5                 5.254742e-01 1 1  ON 25
 eO_6                 2.821271e-01 1 1  ON 26
 eO_7                -6.500993e-02 1 1  ON 27
 eO_8                -3.285024e-01 1 1  ON 28
 eO_9                -2.248663e-01 1 1  ON 29
eH1_0                -2.916871e-01 1 1  ON 30
eH1_1                -1.886617e-01 1 1  ON 31
eH1_2                -1.400713e-01 1 1  ON 32
eH1_3                -8.512713e-02 1 1  ON 33
eH1_4                -3.483133e-02 1 1  ON 34
eH1_5                 4.707333e-03 1 1  ON 35
eH1_6                 7.305643e-02 1 1  ON 36
eH1_7                 1.570769e-01 1 1  ON 37
eH1_8                 2.278044e-01 1 1  ON 38
eH1_9                 2.108150e-01 1 1  ON 39
eH2_0                -2.897996e-01 1 1  ON 40
eH2_1                -1.870155e-01 1 1  ON 41
eH2_2                -1.383124e-01 1 1  ON 42
eH2_3                -8.314146e-02 1 1  ON 43
eH2_4                -3.325592e-02 1 1  ON 44
eH2_5                 5.718659e-03 1 1  ON 45
eH2_6                 7.491822e-02 1 1  ON 46
eH2_7                 1.569254e-01 1 1  ON 47
eH2_8                 2.243647e-01 1 1  ON 48
eH2_9                 2.362667e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9551
    reference variance = 0.823362
====================================================
  Execution time = 2.1045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3354e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333487859925
                                         uncertainty =       0.002399626943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333487859925
                                         uncertainty =       0.002399626943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408375471
  error estimate for blocks of size 2^( 2) =       0.000420954327
  error estimate for blocks of size 2^( 3) =       0.000434431486
  error estimate for blocks of size 2^( 4) =       0.000446259179
  error estimate for blocks of size 2^( 5) =       0.000456913267
  error estimate for blocks of size 2^( 6) =       0.000464029388
  error estimate for blocks of size 2^( 7) =       0.000470375117

      target function =                  N/A
              le_mean =     -16.905788304472
             les_mean =     286.139219079958
             stat err =       0.000459394238
             autocorr =       1.265469811474
              std dev =       0.577530130038
             le_variance =       0.333541051102


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578830447e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788304472       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905789933876       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905792830996       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905790005209       residual = 7.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905793174443       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905794581520       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905793993178       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905793616617       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905793310945       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905795573899       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905796233400       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905795182516       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905795085521       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905794885196       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 2.419042e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788304472       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905789369902       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905790943578       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788778314       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905790490509       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905791577314       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905791448277       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905790849970       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905791262076       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905791492083       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.019958e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905788304472       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905788751288       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905789247151       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905788360139       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905788661681       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905789220957       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905789262332       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905789161505       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905789201607       residual = 1.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.267486e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6709e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.940364e-01 1 1  ON 0
 uu_1                 1.271499e-01 1 1  ON 1
 uu_2                 2.527773e-02 1 1  ON 2
 uu_3                -3.743223e-02 1 1  ON 3
 uu_4                -8.363212e-02 1 1  ON 4
 uu_5                -1.197489e-01 1 1  ON 5
 uu_6                -1.486640e-01 1 1  ON 6
 uu_7                -1.641946e-01 1 1  ON 7
 uu_8                -1.559883e-01 1 1  ON 8
 uu_9                -1.292255e-01 1 1  ON 9
 ud_0                 4.554191e-01 1 1  ON 10
 ud_1                 1.901790e-01 1 1  ON 11
 ud_2                 7.053063e-02 1 1  ON 12
 ud_3                -3.888156e-04 1 1  ON 13
 ud_4                -5.825080e-02 1 1  ON 14
 ud_5                -1.007606e-01 1 1  ON 15
 ud_6                -1.296965e-01 1 1  ON 16
 ud_7                -1.479319e-01 1 1  ON 17
 ud_8                -1.499617e-01 1 1  ON 18
 ud_9                -1.414423e-01 1 1  ON 19
 eO_0                -7.050906e-01 1 1  ON 20
 eO_1                -3.852045e-01 1 1  ON 21
 eO_2                 2.842385e-02 1 1  ON 22
 eO_3                 3.437443e-01 1 1  ON 23
 eO_4                 5.679087e-01 1 1  ON 24
 eO_5                 5.256447e-01 1 1  ON 25
 eO_6                 2.820929e-01 1 1  ON 26
 eO_7                -6.512295e-02 1 1  ON 27
 eO_8                -3.286411e-01 1 1  ON 28
 eO_9                -2.253731e-01 1 1  ON 29
eH1_0                -2.927071e-01 1 1  ON 30
eH1_1                -1.887941e-01 1 1  ON 31
eH1_2                -1.403295e-01 1 1  ON 32
eH1_3                -8.501307e-02 1 1  ON 33
eH1_4                -3.474345e-02 1 1  ON 34
eH1_5                 4.315569e-03 1 1  ON 35
eH1_6                 7.318641e-02 1 1  ON 36
eH1_7                 1.575813e-01 1 1  ON 37
eH1_8                 2.279203e-01 1 1  ON 38
eH1_9                 2.112708e-01 1 1  ON 39
eH2_0                -2.904749e-01 1 1  ON 40
eH2_1                -1.872625e-01 1 1  ON 41
eH2_2                -1.386489e-01 1 1  ON 42
eH2_3                -8.300396e-02 1 1  ON 43
eH2_4                -3.271628e-02 1 1  ON 44
eH2_5                 5.680385e-03 1 1  ON 45
eH2_6                 7.467009e-02 1 1  ON 46
eH2_7                 1.567780e-01 1 1  ON 47
eH2_8                 2.246207e-01 1 1  ON 48
eH2_9                 2.365378e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.917
    reference variance = 0.29341
====================================================
  Execution time = 2.0620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3278e-01
  Total weights = 2.0000e+06
  Execution time = 2.2800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332774034695
                                         uncertainty =       0.003271467141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332774034695
                                         uncertainty =       0.003271467141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407870059
  error estimate for blocks of size 2^( 2) =       0.000420566375
  error estimate for blocks of size 2^( 3) =       0.000433161394
  error estimate for blocks of size 2^( 4) =       0.000444682330
  error estimate for blocks of size 2^( 5) =       0.000456293408
  error estimate for blocks of size 2^( 6) =       0.000463447129
  error estimate for blocks of size 2^( 7) =       0.000468462069

      target function =                  N/A
              le_mean =     -16.906896447183
             les_mean =     286.175863279021
             stat err =       0.000458221234
             autocorr =       1.262137789268
              std dev =       0.576815368744
             le_variance =       0.332715969620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332872399006
                                         uncertainty =       0.003268954062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332872399006
                                         uncertainty =       0.003268954062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407930365
  error estimate for blocks of size 2^( 2) =       0.000420618796
  error estimate for blocks of size 2^( 3) =       0.000433201461
  error estimate for blocks of size 2^( 4) =       0.000444712090
  error estimate for blocks of size 2^( 5) =       0.000456328405
  error estimate for blocks of size 2^( 6) =       0.000463482623
  error estimate for blocks of size 2^( 7) =       0.000468495801

      target function =                  N/A
              le_mean =     -16.906893267892
             les_mean =     286.175854171211
             stat err =       0.000458254730
             autocorr =       1.261949116002
              std dev =       0.576900654993
             le_variance =       0.332814365732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332915673021
                                         uncertainty =       0.003268132354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332915673021
                                         uncertainty =       0.003268132354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407956880
  error estimate for blocks of size 2^( 2) =       0.000420643545
  error estimate for blocks of size 2^( 3) =       0.000433222905
  error estimate for blocks of size 2^( 4) =       0.000444730710
  error estimate for blocks of size 2^( 5) =       0.000456347385
  error estimate for blocks of size 2^( 6) =       0.000463502739
  error estimate for blocks of size 2^( 7) =       0.000468512652

      target function =                  N/A
              le_mean =     -16.906892342554
             les_mean =     286.175866148630
             stat err =       0.000458273372
             autocorr =       1.261887742102
              std dev =       0.576938152973
             le_variance =       0.332857632355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332796592617
                                         uncertainty =       0.003270383631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332796592617
                                         uncertainty =       0.003270383631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407883890
  error estimate for blocks of size 2^( 2) =       0.000420577856
  error estimate for blocks of size 2^( 3) =       0.000433169029
  error estimate for blocks of size 2^( 4) =       0.000444687043
  error estimate for blocks of size 2^( 5) =       0.000456298947
  error estimate for blocks of size 2^( 6) =       0.000463453214
  error estimate for blocks of size 2^( 7) =       0.000468467177

      target function =                  N/A
              le_mean =     -16.906894970791
             les_mean =     286.175835922515
             stat err =       0.000458226595
             autocorr =       1.262081726620
              std dev =       0.576834929187
             le_variance =       0.332738535530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906896447183        initial  <--
     3.8147e-02     3.8147e-01             2.4190e-03       -16.906893267892
     1.5259e-01     1.5259e+00             1.0200e-03       -16.906892342554
     6.1035e-01     6.1035e+00             3.2675e-04       -16.906894970791

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2570
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.942347e-01 1 1  ON 0
 uu_1                 1.270778e-01 1 1  ON 1
 uu_2                 2.527336e-02 1 1  ON 2
 uu_3                -3.749114e-02 1 1  ON 3
 uu_4                -8.371659e-02 1 1  ON 4
 uu_5                -1.198236e-01 1 1  ON 5
 uu_6                -1.485906e-01 1 1  ON 6
 uu_7                -1.638624e-01 1 1  ON 7
 uu_8                -1.561015e-01 1 1  ON 8
 uu_9                -1.290087e-01 1 1  ON 9
 ud_0                 4.551497e-01 1 1  ON 10
 ud_1                 1.899689e-01 1 1  ON 11
 ud_2                 7.045405e-02 1 1  ON 12
 ud_3                -1.977975e-04 1 1  ON 13
 ud_4                -5.809069e-02 1 1  ON 14
 ud_5                -1.007020e-01 1 1  ON 15
 ud_6                -1.296170e-01 1 1  ON 16
 ud_7                -1.477032e-01 1 1  ON 17
 ud_8                -1.501676e-01 1 1  ON 18
 ud_9                -1.417112e-01 1 1  ON 19
 eO_0                -7.054438e-01 1 1  ON 20
 eO_1                -3.855222e-01 1 1  ON 21
 eO_2                 2.807094e-02 1 1  ON 22
 eO_3                 3.438614e-01 1 1  ON 23
 eO_4                 5.680340e-01 1 1  ON 24
 eO_5                 5.254742e-01 1 1  ON 25
 eO_6                 2.821271e-01 1 1  ON 26
 eO_7                -6.500993e-02 1 1  ON 27
 eO_8                -3.285024e-01 1 1  ON 28
 eO_9                -2.248663e-01 1 1  ON 29
eH1_0                -2.916871e-01 1 1  ON 30
eH1_1                -1.886617e-01 1 1  ON 31
eH1_2                -1.400713e-01 1 1  ON 32
eH1_3                -8.512713e-02 1 1  ON 33
eH1_4                -3.483133e-02 1 1  ON 34
eH1_5                 4.707333e-03 1 1  ON 35
eH1_6                 7.305643e-02 1 1  ON 36
eH1_7                 1.570769e-01 1 1  ON 37
eH1_8                 2.278044e-01 1 1  ON 38
eH1_9                 2.108150e-01 1 1  ON 39
eH2_0                -2.897996e-01 1 1  ON 40
eH2_1                -1.870155e-01 1 1  ON 41
eH2_2                -1.383124e-01 1 1  ON 42
eH2_3                -8.314146e-02 1 1  ON 43
eH2_4                -3.325592e-02 1 1  ON 44
eH2_5                 5.718659e-03 1 1  ON 45
eH2_6                 7.491822e-02 1 1  ON 46
eH2_7                 1.569254e-01 1 1  ON 47
eH2_8                 2.243647e-01 1 1  ON 48
eH2_9                 2.362667e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.299868
====================================================
  Execution time = 2.0607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5332e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330708738244
                                         uncertainty =       0.002717072406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330708738244
                                         uncertainty =       0.002717072406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406622499
  error estimate for blocks of size 2^( 2) =       0.000419593591
  error estimate for blocks of size 2^( 3) =       0.000433719176
  error estimate for blocks of size 2^( 4) =       0.000446387511
  error estimate for blocks of size 2^( 5) =       0.000458065398
  error estimate for blocks of size 2^( 6) =       0.000466502920
  error estimate for blocks of size 2^( 7) =       0.000473889721

      target function =                  N/A
              le_mean =     -16.905954186968
             les_mean =     286.141970520699
             stat err =       0.000461211388
             autocorr =       1.286522044957
              std dev =       0.575051053547
             le_variance =       0.330683714185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595418697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905954186968       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905956584917       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905956288879       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905956726523       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905956239506       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905956363876       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905956298367       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905956312511       residual = 9.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 4.001304e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905954186968       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905954987181       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905954896441       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905955071782       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905954933607       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905954963407       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905954970070       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905954951080       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.133940e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905954186968       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905954405297       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905954382425       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905954435215       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905954399947       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905954406440       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905954411366       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905954405700       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.945829e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6147e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.941820e-01 1 1  ON 0
 uu_1                 1.271123e-01 1 1  ON 1
 uu_2                 2.534717e-02 1 1  ON 2
 uu_3                -3.744351e-02 1 1  ON 3
 uu_4                -8.375942e-02 1 1  ON 4
 uu_5                -1.197913e-01 1 1  ON 5
 uu_6                -1.486083e-01 1 1  ON 6
 uu_7                -1.638952e-01 1 1  ON 7
 uu_8                -1.561559e-01 1 1  ON 8
 uu_9                -1.290308e-01 1 1  ON 9
 ud_0                 4.552041e-01 1 1  ON 10
 ud_1                 1.899613e-01 1 1  ON 11
 ud_2                 7.042385e-02 1 1  ON 12
 ud_3                -2.602234e-04 1 1  ON 13
 ud_4                -5.807213e-02 1 1  ON 14
 ud_5                -1.006695e-01 1 1  ON 15
 ud_6                -1.295278e-01 1 1  ON 16
 ud_7                -1.476772e-01 1 1  ON 17
 ud_8                -1.501518e-01 1 1  ON 18
 ud_9                -1.417186e-01 1 1  ON 19
 eO_0                -7.054848e-01 1 1  ON 20
 eO_1                -3.854819e-01 1 1  ON 21
 eO_2                 2.808002e-02 1 1  ON 22
 eO_3                 3.439235e-01 1 1  ON 23
 eO_4                 5.680772e-01 1 1  ON 24
 eO_5                 5.254804e-01 1 1  ON 25
 eO_6                 2.821306e-01 1 1  ON 26
 eO_7                -6.499786e-02 1 1  ON 27
 eO_8                -3.285467e-01 1 1  ON 28
 eO_9                -2.249353e-01 1 1  ON 29
eH1_0                -2.917728e-01 1 1  ON 30
eH1_1                -1.886213e-01 1 1  ON 31
eH1_2                -1.401063e-01 1 1  ON 32
eH1_3                -8.508168e-02 1 1  ON 33
eH1_4                -3.484462e-02 1 1  ON 34
eH1_5                 4.720440e-03 1 1  ON 35
eH1_6                 7.301570e-02 1 1  ON 36
eH1_7                 1.570447e-01 1 1  ON 37
eH1_8                 2.278111e-01 1 1  ON 38
eH1_9                 2.108717e-01 1 1  ON 39
eH2_0                -2.899130e-01 1 1  ON 40
eH2_1                -1.869964e-01 1 1  ON 41
eH2_2                -1.383424e-01 1 1  ON 42
eH2_3                -8.316758e-02 1 1  ON 43
eH2_4                -3.327783e-02 1 1  ON 44
eH2_5                 5.764086e-03 1 1  ON 45
eH2_6                 7.496095e-02 1 1  ON 46
eH2_7                 1.569312e-01 1 1  ON 47
eH2_8                 2.244012e-01 1 1  ON 48
eH2_9                 2.362890e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9087
    reference variance = 0.285441
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3218e-01
  Total weights = 2.0000e+06
  Execution time = 1.8948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332174272171
                                         uncertainty =       0.002496842122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332174272171
                                         uncertainty =       0.002496842122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407522215
  error estimate for blocks of size 2^( 2) =       0.000419800337
  error estimate for blocks of size 2^( 3) =       0.000433057230
  error estimate for blocks of size 2^( 4) =       0.000445906255
  error estimate for blocks of size 2^( 5) =       0.000458245865
  error estimate for blocks of size 2^( 6) =       0.000468667398
  error estimate for blocks of size 2^( 7) =       0.000476213738

      target function =                  N/A
              le_mean =     -16.906921273204
             les_mean =     286.176135483293
             stat err =       0.000462258314
             autocorr =       1.286669142658
              std dev =       0.576323443095
             le_variance =       0.332148711061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332248830799
                                         uncertainty =       0.002497306647

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332248830799
                                         uncertainty =       0.002497306647

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407567886
  error estimate for blocks of size 2^( 2) =       0.000419840066
  error estimate for blocks of size 2^( 3) =       0.000433093176
  error estimate for blocks of size 2^( 4) =       0.000445938937
  error estimate for blocks of size 2^( 5) =       0.000458280096
  error estimate for blocks of size 2^( 6) =       0.000468702051
  error estimate for blocks of size 2^( 7) =       0.000476243106

      target function =                  N/A
              le_mean =     -16.906919041151
             les_mean =     286.176134461696
             stat err =       0.000462291048
             autocorr =       1.286562985038
              std dev =       0.576388032293
             le_variance =       0.332223163770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332242038084
                                         uncertainty =       0.002497217592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332242038084
                                         uncertainty =       0.002497217592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407563763
  error estimate for blocks of size 2^( 2) =       0.000419837117
  error estimate for blocks of size 2^( 3) =       0.000433090508
  error estimate for blocks of size 2^( 4) =       0.000445936830
  error estimate for blocks of size 2^( 5) =       0.000458277017
  error estimate for blocks of size 2^( 6) =       0.000468698103
  error estimate for blocks of size 2^( 7) =       0.000476240819

      target function =                  N/A
              le_mean =     -16.906919384343
             les_mean =     286.176139344459
             stat err =       0.000462288192
             autocorr =       1.286573122301
              std dev =       0.576382201222
             le_variance =       0.332216441885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332183908903
                                         uncertainty =       0.002496893433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332183908903
                                         uncertainty =       0.002496893433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407528124
  error estimate for blocks of size 2^( 2) =       0.000419805558
  error estimate for blocks of size 2^( 3) =       0.000433061932
  error estimate for blocks of size 2^( 4) =       0.000445910568
  error estimate for blocks of size 2^( 5) =       0.000458250240
  error estimate for blocks of size 2^( 6) =       0.000468671688
  error estimate for blocks of size 2^( 7) =       0.000476217517

      target function =                  N/A
              le_mean =     -16.906920967422
             les_mean =     286.176134777019
             stat err =       0.000462262503
             autocorr =       1.286655148438
              std dev =       0.576331800663
             le_variance =       0.332158344455


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906921273204        initial  <--
     3.8147e-01     3.8147e+00             4.0013e-04       -16.906919041151
     1.5259e+00     1.5259e+01             1.1339e-04       -16.906919384343
     6.1035e+00     6.1035e+01             2.9458e-05       -16.906920967422

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8985
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.942347e-01 1 1  ON 0
 uu_1                 1.270778e-01 1 1  ON 1
 uu_2                 2.527336e-02 1 1  ON 2
 uu_3                -3.749114e-02 1 1  ON 3
 uu_4                -8.371659e-02 1 1  ON 4
 uu_5                -1.198236e-01 1 1  ON 5
 uu_6                -1.485906e-01 1 1  ON 6
 uu_7                -1.638624e-01 1 1  ON 7
 uu_8                -1.561015e-01 1 1  ON 8
 uu_9                -1.290087e-01 1 1  ON 9
 ud_0                 4.551497e-01 1 1  ON 10
 ud_1                 1.899689e-01 1 1  ON 11
 ud_2                 7.045405e-02 1 1  ON 12
 ud_3                -1.977975e-04 1 1  ON 13
 ud_4                -5.809069e-02 1 1  ON 14
 ud_5                -1.007020e-01 1 1  ON 15
 ud_6                -1.296170e-01 1 1  ON 16
 ud_7                -1.477032e-01 1 1  ON 17
 ud_8                -1.501676e-01 1 1  ON 18
 ud_9                -1.417112e-01 1 1  ON 19
 eO_0                -7.054438e-01 1 1  ON 20
 eO_1                -3.855222e-01 1 1  ON 21
 eO_2                 2.807094e-02 1 1  ON 22
 eO_3                 3.438614e-01 1 1  ON 23
 eO_4                 5.680340e-01 1 1  ON 24
 eO_5                 5.254742e-01 1 1  ON 25
 eO_6                 2.821271e-01 1 1  ON 26
 eO_7                -6.500993e-02 1 1  ON 27
 eO_8                -3.285024e-01 1 1  ON 28
 eO_9                -2.248663e-01 1 1  ON 29
eH1_0                -2.916871e-01 1 1  ON 30
eH1_1                -1.886617e-01 1 1  ON 31
eH1_2                -1.400713e-01 1 1  ON 32
eH1_3                -8.512713e-02 1 1  ON 33
eH1_4                -3.483133e-02 1 1  ON 34
eH1_5                 4.707333e-03 1 1  ON 35
eH1_6                 7.305643e-02 1 1  ON 36
eH1_7                 1.570769e-01 1 1  ON 37
eH1_8                 2.278044e-01 1 1  ON 38
eH1_9                 2.108150e-01 1 1  ON 39
eH2_0                -2.897996e-01 1 1  ON 40
eH2_1                -1.870155e-01 1 1  ON 41
eH2_2                -1.383124e-01 1 1  ON 42
eH2_3                -8.314146e-02 1 1  ON 43
eH2_4                -3.325592e-02 1 1  ON 44
eH2_5                 5.718659e-03 1 1  ON 45
eH2_6                 7.491822e-02 1 1  ON 46
eH2_7                 1.569254e-01 1 1  ON 47
eH2_8                 2.243647e-01 1 1  ON 48
eH2_9                 2.362667e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6051e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9156
    reference variance = 0.513821
====================================================
  Execution time = 2.0583e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3554e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550643951
                                         uncertainty =       0.003842720208

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335550643951
                                         uncertainty =       0.003842720208

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409598597
  error estimate for blocks of size 2^( 2) =       0.000422685692
  error estimate for blocks of size 2^( 3) =       0.000435983797
  error estimate for blocks of size 2^( 4) =       0.000448639740
  error estimate for blocks of size 2^( 5) =       0.000459662305
  error estimate for blocks of size 2^( 6) =       0.000468485714
  error estimate for blocks of size 2^( 7) =       0.000473916385

      target function =                  N/A
              le_mean =     -16.907229566529
             les_mean =     286.189953469253
             stat err =       0.000462676036
             autocorr =       1.275960091471
              std dev =       0.579259891328
             le_variance =       0.335542021701


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690722956653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907229566529       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907229478415       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907229496418       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907229582494       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907229631722       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907229643822       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907229678375       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907229679271       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 3.382177e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907229566529       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907229543471       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907229547703       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907229567252       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907229580592       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907229585134       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907229594839       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907229595348       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 8.918150e-06

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907229566529       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907229560697       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907229561734       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907229566484       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907229569902       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907229571119       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907229573619       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907229573770       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 2.260416e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6166e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.942269e-01 1 1  ON 0
 uu_1                 1.270762e-01 1 1  ON 1
 uu_2                 2.527899e-02 1 1  ON 2
 uu_3                -3.749089e-02 1 1  ON 3
 uu_4                -8.371912e-02 1 1  ON 4
 uu_5                -1.198257e-01 1 1  ON 5
 uu_6                -1.485866e-01 1 1  ON 6
 uu_7                -1.638604e-01 1 1  ON 7
 uu_8                -1.560973e-01 1 1  ON 8
 uu_9                -1.290120e-01 1 1  ON 9
 ud_0                 4.551566e-01 1 1  ON 10
 ud_1                 1.899689e-01 1 1  ON 11
 ud_2                 7.045955e-02 1 1  ON 12
 ud_3                -2.042447e-04 1 1  ON 13
 ud_4                -5.808762e-02 1 1  ON 14
 ud_5                -1.006994e-01 1 1  ON 15
 ud_6                -1.296197e-01 1 1  ON 16
 ud_7                -1.477004e-01 1 1  ON 17
 ud_8                -1.501680e-01 1 1  ON 18
 ud_9                -1.417152e-01 1 1  ON 19
 eO_0                -7.054481e-01 1 1  ON 20
 eO_1                -3.855157e-01 1 1  ON 21
 eO_2                 2.806792e-02 1 1  ON 22
 eO_3                 3.438674e-01 1 1  ON 23
 eO_4                 5.680364e-01 1 1  ON 24
 eO_5                 5.254758e-01 1 1  ON 25
 eO_6                 2.821293e-01 1 1  ON 26
 eO_7                -6.500852e-02 1 1  ON 27
 eO_8                -3.285053e-01 1 1  ON 28
 eO_9                -2.248739e-01 1 1  ON 29
eH1_0                -2.916945e-01 1 1  ON 30
eH1_1                -1.886603e-01 1 1  ON 31
eH1_2                -1.400752e-01 1 1  ON 32
eH1_3                -8.513100e-02 1 1  ON 33
eH1_4                -3.482705e-02 1 1  ON 34
eH1_5                 4.712339e-03 1 1  ON 35
eH1_6                 7.306047e-02 1 1  ON 36
eH1_7                 1.570722e-01 1 1  ON 37
eH1_8                 2.278032e-01 1 1  ON 38
eH1_9                 2.108189e-01 1 1  ON 39
eH2_0                -2.898069e-01 1 1  ON 40
eH2_1                -1.870125e-01 1 1  ON 41
eH2_2                -1.383214e-01 1 1  ON 42
eH2_3                -8.313999e-02 1 1  ON 43
eH2_4                -3.325019e-02 1 1  ON 44
eH2_5                 5.719113e-03 1 1  ON 45
eH2_6                 7.491659e-02 1 1  ON 46
eH2_7                 1.569287e-01 1 1  ON 47
eH2_8                 2.243633e-01 1 1  ON 48
eH2_9                 2.362672e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8321
    reference variance = 0.229328
====================================================
  Execution time = 2.0169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3979e-01
  Total weights = 2.0000e+06
  Execution time = 1.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339842576813
                                         uncertainty =       0.003246369303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339842576813
                                         uncertainty =       0.003246369303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180663
  error estimate for blocks of size 2^( 2) =       0.000424854678
  error estimate for blocks of size 2^( 3) =       0.000438228344
  error estimate for blocks of size 2^( 4) =       0.000450470591
  error estimate for blocks of size 2^( 5) =       0.000460303279
  error estimate for blocks of size 2^( 6) =       0.000469128645
  error estimate for blocks of size 2^( 7) =       0.000474754231

      target function =                  N/A
              le_mean =     -16.906133206308
             les_mean =     286.157125616807
             stat err =       0.000463664187
             autocorr =       1.265411795086
              std dev =       0.582911483234
             le_variance =       0.339785797286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339843945544
                                         uncertainty =       0.003246484141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339843945544
                                         uncertainty =       0.003246484141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412181501
  error estimate for blocks of size 2^( 2) =       0.000424855360
  error estimate for blocks of size 2^( 3) =       0.000438228541
  error estimate for blocks of size 2^( 4) =       0.000450470610
  error estimate for blocks of size 2^( 5) =       0.000460302704
  error estimate for blocks of size 2^( 6) =       0.000469128461
  error estimate for blocks of size 2^( 7) =       0.000474754359

      target function =                  N/A
              le_mean =     -16.906133184888
             les_mean =     286.157126274652
             stat err =       0.000463664033
             autocorr =       1.265405812750
              std dev =       0.582912668728
             le_variance =       0.339787179364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339842859719
                                         uncertainty =       0.003246425627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339842859719
                                         uncertainty =       0.003246425627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180839
  error estimate for blocks of size 2^( 2) =       0.000424854790
  error estimate for blocks of size 2^( 3) =       0.000438228211
  error estimate for blocks of size 2^( 4) =       0.000450470377
  error estimate for blocks of size 2^( 5) =       0.000460302750
  error estimate for blocks of size 2^( 6) =       0.000469128349
  error estimate for blocks of size 2^( 7) =       0.000474754105

      target function =                  N/A
              le_mean =     -16.906133192133
             les_mean =     286.157125427936
             stat err =       0.000463663895
             autocorr =       1.265409123806
              std dev =       0.582911732316
             le_variance =       0.339786087672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339842593258
                                         uncertainty =       0.003246376279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339842593258
                                         uncertainty =       0.003246376279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412180673
  error estimate for blocks of size 2^( 2) =       0.000424854681
  error estimate for blocks of size 2^( 3) =       0.000438228316
  error estimate for blocks of size 2^( 4) =       0.000450470554
  error estimate for blocks of size 2^( 5) =       0.000460303201
  error estimate for blocks of size 2^( 6) =       0.000469128598
  error estimate for blocks of size 2^( 7) =       0.000474754206

      target function =                  N/A
              le_mean =     -16.906133204160
             les_mean =     286.157125561618
             stat err =       0.000463664140
             autocorr =       1.265411475942
              std dev =       0.582911498167
             le_variance =       0.339785814695


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906133206308        initial  <--
     3.8147e+00     3.8147e+01             3.3822e-05       -16.906133184888
     1.5259e+01     1.5259e+02             8.9181e-06       -16.906133192133
     6.1035e+01     6.1035e+02             2.2604e-06       -16.906133204160

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6261
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.942347e-01 1 1  ON 0
 uu_1                 1.270778e-01 1 1  ON 1
 uu_2                 2.527336e-02 1 1  ON 2
 uu_3                -3.749114e-02 1 1  ON 3
 uu_4                -8.371659e-02 1 1  ON 4
 uu_5                -1.198236e-01 1 1  ON 5
 uu_6                -1.485906e-01 1 1  ON 6
 uu_7                -1.638624e-01 1 1  ON 7
 uu_8                -1.561015e-01 1 1  ON 8
 uu_9                -1.290087e-01 1 1  ON 9
 ud_0                 4.551497e-01 1 1  ON 10
 ud_1                 1.899689e-01 1 1  ON 11
 ud_2                 7.045405e-02 1 1  ON 12
 ud_3                -1.977975e-04 1 1  ON 13
 ud_4                -5.809069e-02 1 1  ON 14
 ud_5                -1.007020e-01 1 1  ON 15
 ud_6                -1.296170e-01 1 1  ON 16
 ud_7                -1.477032e-01 1 1  ON 17
 ud_8                -1.501676e-01 1 1  ON 18
 ud_9                -1.417112e-01 1 1  ON 19
 eO_0                -7.054438e-01 1 1  ON 20
 eO_1                -3.855222e-01 1 1  ON 21
 eO_2                 2.807094e-02 1 1  ON 22
 eO_3                 3.438614e-01 1 1  ON 23
 eO_4                 5.680340e-01 1 1  ON 24
 eO_5                 5.254742e-01 1 1  ON 25
 eO_6                 2.821271e-01 1 1  ON 26
 eO_7                -6.500993e-02 1 1  ON 27
 eO_8                -3.285024e-01 1 1  ON 28
 eO_9                -2.248663e-01 1 1  ON 29
eH1_0                -2.916871e-01 1 1  ON 30
eH1_1                -1.886617e-01 1 1  ON 31
eH1_2                -1.400713e-01 1 1  ON 32
eH1_3                -8.512713e-02 1 1  ON 33
eH1_4                -3.483133e-02 1 1  ON 34
eH1_5                 4.707333e-03 1 1  ON 35
eH1_6                 7.305643e-02 1 1  ON 36
eH1_7                 1.570769e-01 1 1  ON 37
eH1_8                 2.278044e-01 1 1  ON 38
eH1_9                 2.108150e-01 1 1  ON 39
eH2_0                -2.897996e-01 1 1  ON 40
eH2_1                -1.870155e-01 1 1  ON 41
eH2_2                -1.383124e-01 1 1  ON 42
eH2_3                -8.314146e-02 1 1  ON 43
eH2_4                -3.325592e-02 1 1  ON 44
eH2_5                 5.718659e-03 1 1  ON 45
eH2_6                 7.491822e-02 1 1  ON 46
eH2_7                 1.569254e-01 1 1  ON 47
eH2_8                 2.243647e-01 1 1  ON 48
eH2_9                 2.362667e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5799e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.428477
====================================================
  Execution time = 2.0663e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3877e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4723e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338832955872
                                         uncertainty =       0.003775822733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338832955872
                                         uncertainty =       0.003775822733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411561845
  error estimate for blocks of size 2^( 2) =       0.000424265626
  error estimate for blocks of size 2^( 3) =       0.000436204772
  error estimate for blocks of size 2^( 4) =       0.000448119445
  error estimate for blocks of size 2^( 5) =       0.000458390272
  error estimate for blocks of size 2^( 6) =       0.000466229756
  error estimate for blocks of size 2^( 7) =       0.000472465388

      target function =                  N/A
              le_mean =     -16.906991575597
             les_mean =     286.185130272702
             stat err =       0.000461301215
             autocorr =       1.256316276361
              std dev =       0.582036343181
             le_variance =       0.338766304783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690699157560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906991575597       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906991602507       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906991611877       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906991613761       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906991612306       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906991606930       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906991610250       residual = 8.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 5.356808e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906991575597       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906991582351       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906991584707       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906991585178       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906991584818       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906991583477       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906991584266       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906991584305       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.356672e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906991575597       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906991577287       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906991577877       residual = 6.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906991577995       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906991577905       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906991577569       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906991577764       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906991577777       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.395062e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6142e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.942344e-01 1 1  ON 0
 uu_1                 1.270779e-01 1 1  ON 1
 uu_2                 2.527367e-02 1 1  ON 2
 uu_3                -3.749117e-02 1 1  ON 3
 uu_4                -8.371576e-02 1 1  ON 4
 uu_5                -1.198233e-01 1 1  ON 5
 uu_6                -1.485904e-01 1 1  ON 6
 uu_7                -1.638620e-01 1 1  ON 7
 uu_8                -1.561019e-01 1 1  ON 8
 uu_9                -1.290096e-01 1 1  ON 9
 ud_0                 4.551505e-01 1 1  ON 10
 ud_1                 1.899702e-01 1 1  ON 11
 ud_2                 7.045439e-02 1 1  ON 12
 ud_3                -1.977960e-04 1 1  ON 13
 ud_4                -5.809095e-02 1 1  ON 14
 ud_5                -1.007014e-01 1 1  ON 15
 ud_6                -1.296162e-01 1 1  ON 16
 ud_7                -1.477039e-01 1 1  ON 17
 ud_8                -1.501685e-01 1 1  ON 18
 ud_9                -1.417121e-01 1 1  ON 19
 eO_0                -7.054439e-01 1 1  ON 20
 eO_1                -3.855220e-01 1 1  ON 21
 eO_2                 2.807180e-02 1 1  ON 22
 eO_3                 3.438622e-01 1 1  ON 23
 eO_4                 5.680343e-01 1 1  ON 24
 eO_5                 5.254743e-01 1 1  ON 25
 eO_6                 2.821272e-01 1 1  ON 26
 eO_7                -6.501009e-02 1 1  ON 27
 eO_8                -3.285034e-01 1 1  ON 28
 eO_9                -2.248673e-01 1 1  ON 29
eH1_0                -2.916884e-01 1 1  ON 30
eH1_1                -1.886620e-01 1 1  ON 31
eH1_2                -1.400713e-01 1 1  ON 32
eH1_3                -8.512629e-02 1 1  ON 33
eH1_4                -3.483100e-02 1 1  ON 34
eH1_5                 4.707243e-03 1 1  ON 35
eH1_6                 7.305695e-02 1 1  ON 36
eH1_7                 1.570767e-01 1 1  ON 37
eH1_8                 2.278040e-01 1 1  ON 38
eH1_9                 2.108152e-01 1 1  ON 39
eH2_0                -2.898007e-01 1 1  ON 40
eH2_1                -1.870158e-01 1 1  ON 41
eH2_2                -1.383129e-01 1 1  ON 42
eH2_3                -8.314135e-02 1 1  ON 43
eH2_4                -3.325525e-02 1 1  ON 44
eH2_5                 5.719144e-03 1 1  ON 45
eH2_6                 7.491847e-02 1 1  ON 46
eH2_7                 1.569255e-01 1 1  ON 47
eH2_8                 2.243647e-01 1 1  ON 48
eH2_9                 2.362667e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9375
    reference variance = 0.298032
====================================================
  Execution time = 2.0141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3530e-01
  Total weights = 2.0000e+06
  Execution time = 1.8881e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388879023
                                         uncertainty =       0.002967918926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388879023
                                         uncertainty =       0.002967918926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409448308
  error estimate for blocks of size 2^( 2) =       0.000421819243
  error estimate for blocks of size 2^( 3) =       0.000435393442
  error estimate for blocks of size 2^( 4) =       0.000447563232
  error estimate for blocks of size 2^( 5) =       0.000458090083
  error estimate for blocks of size 2^( 6) =       0.000466976444
  error estimate for blocks of size 2^( 7) =       0.000472864620

      target function =                  N/A
              le_mean =     -16.906278364493
             les_mean =     286.157543804208
             stat err =       0.000461373595
             autocorr =       1.269718094456
              std dev =       0.579047350506
             le_variance =       0.335295834128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388507612
                                         uncertainty =       0.002967909022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388507612
                                         uncertainty =       0.002967909022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409448083
  error estimate for blocks of size 2^( 2) =       0.000421818953
  error estimate for blocks of size 2^( 3) =       0.000435393055
  error estimate for blocks of size 2^( 4) =       0.000447562766
  error estimate for blocks of size 2^( 5) =       0.000458089608
  error estimate for blocks of size 2^( 6) =       0.000466976076
  error estimate for blocks of size 2^( 7) =       0.000472864281

      target function =                  N/A
              le_mean =     -16.906278367067
             les_mean =     286.157543522045
             stat err =       0.000461373183
             autocorr =       1.269717225186
              std dev =       0.579047031714
             le_variance =       0.335295464937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388761654
                                         uncertainty =       0.002967914385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388761654
                                         uncertainty =       0.002967914385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409448237
  error estimate for blocks of size 2^( 2) =       0.000421819137
  error estimate for blocks of size 2^( 3) =       0.000435393285
  error estimate for blocks of size 2^( 4) =       0.000447563034
  error estimate for blocks of size 2^( 5) =       0.000458089878
  error estimate for blocks of size 2^( 6) =       0.000466976292
  error estimate for blocks of size 2^( 7) =       0.000472864485

      target function =                  N/A
              le_mean =     -16.906278365529
             les_mean =     286.157543722937
             stat err =       0.000461373422
             autocorr =       1.269717585602
              std dev =       0.579047250074
             le_variance =       0.335295717818

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388863616
                                         uncertainty =       0.002967918353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335388863616
                                         uncertainty =       0.002967918353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409448299
  error estimate for blocks of size 2^( 2) =       0.000421819229
  error estimate for blocks of size 2^( 3) =       0.000435393422
  error estimate for blocks of size 2^( 4) =       0.000447563207
  error estimate for blocks of size 2^( 5) =       0.000458090057
  error estimate for blocks of size 2^( 6) =       0.000466976424
  error estimate for blocks of size 2^( 7) =       0.000472864603

      target function =                  N/A
              le_mean =     -16.906278364618
             les_mean =     286.157543793165
             stat err =       0.000461373573
             autocorr =       1.269718031405
              std dev =       0.579047337317
             le_variance =       0.335295818854


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906278364493        initial
     3.8147e+01     3.8147e+02             5.3568e-06       -16.906278367067  <--
     1.5259e+02     1.5259e+03             1.3567e-06       -16.906278365529
     6.1035e+02     6.1035e+03             3.3951e-07       -16.906278364618

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.9652e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.942337e-01 1 1  ON 0
 uu_1                 1.270783e-01 1 1  ON 1
 uu_2                 2.527463e-02 1 1  ON 2
 uu_3                -3.749125e-02 1 1  ON 3
 uu_4                -8.371333e-02 1 1  ON 4
 uu_5                -1.198227e-01 1 1  ON 5
 uu_6                -1.485895e-01 1 1  ON 6
 uu_7                -1.638605e-01 1 1  ON 7
 uu_8                -1.561032e-01 1 1  ON 8
 uu_9                -1.290123e-01 1 1  ON 9
 ud_0                 4.551527e-01 1 1  ON 10
 ud_1                 1.899742e-01 1 1  ON 11
 ud_2                 7.045546e-02 1 1  ON 12
 ud_3                -1.978548e-04 1 1  ON 13
 ud_4                -5.809182e-02 1 1  ON 14
 ud_5                -1.006998e-01 1 1  ON 15
 ud_6                -1.296134e-01 1 1  ON 16
 ud_7                -1.477059e-01 1 1  ON 17
 ud_8                -1.501715e-01 1 1  ON 18
 ud_9                -1.417149e-01 1 1  ON 19
 eO_0                -7.054441e-01 1 1  ON 20
 eO_1                -3.855215e-01 1 1  ON 21
 eO_2                 2.807438e-02 1 1  ON 22
 eO_3                 3.438645e-01 1 1  ON 23
 eO_4                 5.680351e-01 1 1  ON 24
 eO_5                 5.254746e-01 1 1  ON 25
 eO_6                 2.821275e-01 1 1  ON 26
 eO_7                -6.501060e-02 1 1  ON 27
 eO_8                -3.285062e-01 1 1  ON 28
 eO_9                -2.248699e-01 1 1  ON 29
eH1_0                -2.916919e-01 1 1  ON 30
eH1_1                -1.886630e-01 1 1  ON 31
eH1_2                -1.400712e-01 1 1  ON 32
eH1_3                -8.512384e-02 1 1  ON 33
eH1_4                -3.482987e-02 1 1  ON 34
eH1_5                 4.707002e-03 1 1  ON 35
eH1_6                 7.305843e-02 1 1  ON 36
eH1_7                 1.570763e-01 1 1  ON 37
eH1_8                 2.278029e-01 1 1  ON 38
eH1_9                 2.108156e-01 1 1  ON 39
eH2_0                -2.898040e-01 1 1  ON 40
eH2_1                -1.870164e-01 1 1  ON 41
eH2_2                -1.383142e-01 1 1  ON 42
eH2_3                -8.314104e-02 1 1  ON 43
eH2_4                -3.325318e-02 1 1  ON 44
eH2_5                 5.720590e-03 1 1  ON 45
eH2_6                 7.491917e-02 1 1  ON 46
eH2_7                 1.569258e-01 1 1  ON 47
eH2_8                 2.243644e-01 1 1  ON 48
eH2_9                 2.362668e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.864
    reference variance = 0.325444
====================================================
  Execution time = 2.0828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342663914161
                                         uncertainty =       0.005701024839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342663914161
                                         uncertainty =       0.005701024839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413879758
  error estimate for blocks of size 2^( 2) =       0.000426404667
  error estimate for blocks of size 2^( 3) =       0.000439728793
  error estimate for blocks of size 2^( 4) =       0.000452372028
  error estimate for blocks of size 2^( 5) =       0.000462325621
  error estimate for blocks of size 2^( 6) =       0.000470031542
  error estimate for blocks of size 2^( 7) =       0.000477043847

      target function =                  N/A
              le_mean =     -16.906212293687
             les_mean =     286.162606856627
             stat err =       0.000465443259
             autocorr =       1.264693006034
              std dev =       0.585314367427
             le_variance =       0.342592908717


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621229369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906212293687       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906212301740       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906212299957       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906212315672       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906212292147       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906212264286       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906212267221       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.351892e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906212293687       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906212295731       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906212295250       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906212299344       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906212293290       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906212286462       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906212286917       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 3.372775e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906212293687       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906212294200       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906212294077       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906212295112       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906212293587       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906212291889       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906212291984       residual = 3.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 8.425690e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094044 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6352e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.942330e-01 1 1  ON 0
 uu_1                 1.270782e-01 1 1  ON 1
 uu_2                 2.527478e-02 1 1  ON 2
 uu_3                -3.749219e-02 1 1  ON 3
 uu_4                -8.371428e-02 1 1  ON 4
 uu_5                -1.198240e-01 1 1  ON 5
 uu_6                -1.485888e-01 1 1  ON 6
 uu_7                -1.638583e-01 1 1  ON 7
 uu_8                -1.561035e-01 1 1  ON 8
 uu_9                -1.290136e-01 1 1  ON 9
 ud_0                 4.551561e-01 1 1  ON 10
 ud_1                 1.899772e-01 1 1  ON 11
 ud_2                 7.045560e-02 1 1  ON 12
 ud_3                -2.004064e-04 1 1  ON 13
 ud_4                -5.809153e-02 1 1  ON 14
 ud_5                -1.006992e-01 1 1  ON 15
 ud_6                -1.296135e-01 1 1  ON 16
 ud_7                -1.477078e-01 1 1  ON 17
 ud_8                -1.501710e-01 1 1  ON 18
 ud_9                -1.417143e-01 1 1  ON 19
 eO_0                -7.054452e-01 1 1  ON 20
 eO_1                -3.855197e-01 1 1  ON 21
 eO_2                 2.807625e-02 1 1  ON 22
 eO_3                 3.438646e-01 1 1  ON 23
 eO_4                 5.680369e-01 1 1  ON 24
 eO_5                 5.254750e-01 1 1  ON 25
 eO_6                 2.821276e-01 1 1  ON 26
 eO_7                -6.501118e-02 1 1  ON 27
 eO_8                -3.285068e-01 1 1  ON 28
 eO_9                -2.248726e-01 1 1  ON 29
eH1_0                -2.916949e-01 1 1  ON 30
eH1_1                -1.886622e-01 1 1  ON 31
eH1_2                -1.400744e-01 1 1  ON 32
eH1_3                -8.512328e-02 1 1  ON 33
eH1_4                -3.483092e-02 1 1  ON 34
eH1_5                 4.709134e-03 1 1  ON 35
eH1_6                 7.305858e-02 1 1  ON 36
eH1_7                 1.570767e-01 1 1  ON 37
eH1_8                 2.278036e-01 1 1  ON 38
eH1_9                 2.108171e-01 1 1  ON 39
eH2_0                -2.898064e-01 1 1  ON 40
eH2_1                -1.870170e-01 1 1  ON 41
eH2_2                -1.383167e-01 1 1  ON 42
eH2_3                -8.314205e-02 1 1  ON 43
eH2_4                -3.325337e-02 1 1  ON 44
eH2_5                 5.722584e-03 1 1  ON 45
eH2_6                 7.491873e-02 1 1  ON 46
eH2_7                 1.569270e-01 1 1  ON 47
eH2_8                 2.243650e-01 1 1  ON 48
eH2_9                 2.362676e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9147
    reference variance = 0.309754
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3607e-01
  Total weights = 2.0000e+06
  Execution time = 1.8870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335969652157
                                         uncertainty =       0.002856035608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335969652157
                                         uncertainty =       0.002856035608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409918716
  error estimate for blocks of size 2^( 2) =       0.000422239070
  error estimate for blocks of size 2^( 3) =       0.000434773345
  error estimate for blocks of size 2^( 4) =       0.000446948893
  error estimate for blocks of size 2^( 5) =       0.000457063252
  error estimate for blocks of size 2^( 6) =       0.000465123227
  error estimate for blocks of size 2^( 7) =       0.000470300868

      target function =                  N/A
              le_mean =     -16.907096129967
             les_mean =     286.185966087666
             stat err =       0.000459859060
             autocorr =       1.258502256086
              std dev =       0.579712607903
             le_variance =       0.336066707761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335980518890
                                         uncertainty =       0.002856141325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335980518890
                                         uncertainty =       0.002856141325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409925350
  error estimate for blocks of size 2^( 2) =       0.000422245170
  error estimate for blocks of size 2^( 3) =       0.000434778842
  error estimate for blocks of size 2^( 4) =       0.000446953884
  error estimate for blocks of size 2^( 5) =       0.000457067934
  error estimate for blocks of size 2^( 6) =       0.000465127748
  error estimate for blocks of size 2^( 7) =       0.000470305222

      target function =                  N/A
              le_mean =     -16.907096150221
             les_mean =     286.185977649957
             stat err =       0.000459863697
             autocorr =       1.258486903357
              std dev =       0.579721989553
             le_variance =       0.336077585172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335975059598
                                         uncertainty =       0.002856088179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335975059598
                                         uncertainty =       0.002856088179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409922017
  error estimate for blocks of size 2^( 2) =       0.000422242103
  error estimate for blocks of size 2^( 3) =       0.000434776073
  error estimate for blocks of size 2^( 4) =       0.000446951364
  error estimate for blocks of size 2^( 5) =       0.000457065566
  error estimate for blocks of size 2^( 6) =       0.000465125459
  error estimate for blocks of size 2^( 7) =       0.000470303013

      target function =                  N/A
              le_mean =     -16.907096139668
             les_mean =     286.185971828603
             stat err =       0.000459861350
             autocorr =       1.258494523588
              std dev =       0.579717276478
             le_variance =       0.336072120648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335970326912
                                         uncertainty =       0.002856042168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335970326912
                                         uncertainty =       0.002856042168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409919128
  error estimate for blocks of size 2^( 2) =       0.000422239449
  error estimate for blocks of size 2^( 3) =       0.000434773685
  error estimate for blocks of size 2^( 4) =       0.000446949200
  error estimate for blocks of size 2^( 5) =       0.000457063540
  error estimate for blocks of size 2^( 6) =       0.000465123505
  error estimate for blocks of size 2^( 7) =       0.000470301135

      target function =                  N/A
              le_mean =     -16.907096131134
             les_mean =     286.185966802586
             stat err =       0.000459859345
             autocorr =       1.258501287721
              std dev =       0.579713190466
             le_variance =       0.336067383200


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907096129967        initial
     9.5367e+00     9.5367e+01             1.3519e-05       -16.907096150221  <--
     3.8147e+01     3.8147e+02             3.3728e-06       -16.907096139668
     1.5259e+02     1.5259e+03             8.4257e-07       -16.907096131134

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.9871e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.942312e-01 1 1  ON 0
 uu_1                 1.270777e-01 1 1  ON 1
 uu_2                 2.527513e-02 1 1  ON 2
 uu_3                -3.749491e-02 1 1  ON 3
 uu_4                -8.371719e-02 1 1  ON 4
 uu_5                -1.198278e-01 1 1  ON 5
 uu_6                -1.485867e-01 1 1  ON 6
 uu_7                -1.638516e-01 1 1  ON 7
 uu_8                -1.561044e-01 1 1  ON 8
 uu_9                -1.290177e-01 1 1  ON 9
 ud_0                 4.551662e-01 1 1  ON 10
 ud_1                 1.899857e-01 1 1  ON 11
 ud_2                 7.045605e-02 1 1  ON 12
 ud_3                -2.077630e-04 1 1  ON 13
 ud_4                -5.809083e-02 1 1  ON 14
 ud_5                -1.006976e-01 1 1  ON 15
 ud_6                -1.296137e-01 1 1  ON 16
 ud_7                -1.477135e-01 1 1  ON 17
 ud_8                -1.501695e-01 1 1  ON 18
 ud_9                -1.417125e-01 1 1  ON 19
 eO_0                -7.054481e-01 1 1  ON 20
 eO_1                -3.855145e-01 1 1  ON 21
 eO_2                 2.808183e-02 1 1  ON 22
 eO_3                 3.438648e-01 1 1  ON 23
 eO_4                 5.680425e-01 1 1  ON 24
 eO_5                 5.254762e-01 1 1  ON 25
 eO_6                 2.821276e-01 1 1  ON 26
 eO_7                -6.501290e-02 1 1  ON 27
 eO_8                -3.285087e-01 1 1  ON 28
 eO_9                -2.248806e-01 1 1  ON 29
eH1_0                -2.917038e-01 1 1  ON 30
eH1_1                -1.886600e-01 1 1  ON 31
eH1_2                -1.400837e-01 1 1  ON 32
eH1_3                -8.512170e-02 1 1  ON 33
eH1_4                -3.483400e-02 1 1  ON 34
eH1_5                 4.715477e-03 1 1  ON 35
eH1_6                 7.305902e-02 1 1  ON 36
eH1_7                 1.570781e-01 1 1  ON 37
eH1_8                 2.278056e-01 1 1  ON 38
eH1_9                 2.108218e-01 1 1  ON 39
eH2_0                -2.898137e-01 1 1  ON 40
eH2_1                -1.870187e-01 1 1  ON 41
eH2_2                -1.383239e-01 1 1  ON 42
eH2_3                -8.314511e-02 1 1  ON 43
eH2_4                -3.325392e-02 1 1  ON 44
eH2_5                 5.728528e-03 1 1  ON 45
eH2_6                 7.491742e-02 1 1  ON 46
eH2_7                 1.569304e-01 1 1  ON 47
eH2_8                 2.243666e-01 1 1  ON 48
eH2_9                 2.362701e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6230e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.242803
====================================================
  Execution time = 2.0740e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5702e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357101437885
                                         uncertainty =       0.013456308565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357101437885
                                         uncertainty =       0.013456308565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422505627
  error estimate for blocks of size 2^( 2) =       0.000435512863
  error estimate for blocks of size 2^( 3) =       0.000448542694
  error estimate for blocks of size 2^( 4) =       0.000461373013
  error estimate for blocks of size 2^( 5) =       0.000471854144
  error estimate for blocks of size 2^( 6) =       0.000478363346
  error estimate for blocks of size 2^( 7) =       0.000484083441

      target function =                  N/A
              le_mean =     -16.906437499793
             les_mean =     286.184650766444
             stat err =       0.000473918486
             autocorr =       1.258178626207
              std dev =       0.597513188589
             le_variance =       0.357022010538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643749979e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906437499793       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906437552966       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906437469630       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906437515450       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906437490458       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906437533249       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906437557893       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906437555846       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 6.627824e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906437499793       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906437513890       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906437490701       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906437501680       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906437493921       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906437503899       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906437508609       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906437509744       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.739951e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906437499793       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906437503371       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906437497407       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906437500112       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906437498057       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906437500487       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906437501541       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906437501924       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.408091e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096712 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6243e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.942303e-01 1 1  ON 0
 uu_1                 1.270765e-01 1 1  ON 1
 uu_2                 2.527803e-02 1 1  ON 2
 uu_3                -3.750105e-02 1 1  ON 3
 uu_4                -8.372106e-02 1 1  ON 4
 uu_5                -1.198346e-01 1 1  ON 5
 uu_6                -1.486012e-01 1 1  ON 6
 uu_7                -1.638530e-01 1 1  ON 7
 uu_8                -1.560935e-01 1 1  ON 8
 uu_9                -1.290091e-01 1 1  ON 9
 ud_0                 4.551739e-01 1 1  ON 10
 ud_1                 1.899854e-01 1 1  ON 11
 ud_2                 7.045848e-02 1 1  ON 12
 ud_3                -2.156860e-04 1 1  ON 13
 ud_4                -5.809333e-02 1 1  ON 14
 ud_5                -1.006975e-01 1 1  ON 15
 ud_6                -1.296284e-01 1 1  ON 16
 ud_7                -1.477063e-01 1 1  ON 17
 ud_8                -1.501630e-01 1 1  ON 18
 ud_9                -1.417054e-01 1 1  ON 19
 eO_0                -7.054540e-01 1 1  ON 20
 eO_1                -3.855104e-01 1 1  ON 21
 eO_2                 2.808214e-02 1 1  ON 22
 eO_3                 3.438700e-01 1 1  ON 23
 eO_4                 5.680544e-01 1 1  ON 24
 eO_5                 5.254810e-01 1 1  ON 25
 eO_6                 2.821213e-01 1 1  ON 26
 eO_7                -6.501357e-02 1 1  ON 27
 eO_8                -3.285101e-01 1 1  ON 28
 eO_9                -2.248896e-01 1 1  ON 29
eH1_0                -2.917118e-01 1 1  ON 30
eH1_1                -1.886690e-01 1 1  ON 31
eH1_2                -1.401011e-01 1 1  ON 32
eH1_3                -8.512014e-02 1 1  ON 33
eH1_4                -3.484509e-02 1 1  ON 34
eH1_5                 4.714109e-03 1 1  ON 35
eH1_6                 7.306168e-02 1 1  ON 36
eH1_7                 1.570893e-01 1 1  ON 37
eH1_8                 2.278171e-01 1 1  ON 38
eH1_9                 2.108350e-01 1 1  ON 39
eH2_0                -2.898253e-01 1 1  ON 40
eH2_1                -1.870171e-01 1 1  ON 41
eH2_2                -1.383409e-01 1 1  ON 42
eH2_3                -8.313828e-02 1 1  ON 43
eH2_4                -3.324207e-02 1 1  ON 44
eH2_5                 5.732293e-03 1 1  ON 45
eH2_6                 7.491855e-02 1 1  ON 46
eH2_7                 1.569275e-01 1 1  ON 47
eH2_8                 2.243666e-01 1 1  ON 48
eH2_9                 2.362716e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9524
    reference variance = 0.201492
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.0184e-01
  Total weights = 2.0000e+06
  Execution time = 1.8920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401897157542
                                         uncertainty =       0.063227346406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401897157542
                                         uncertainty =       0.063227346406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448233865
  error estimate for blocks of size 2^( 2) =       0.000459951130
  error estimate for blocks of size 2^( 3) =       0.000472184054
  error estimate for blocks of size 2^( 4) =       0.000483403822
  error estimate for blocks of size 2^( 5) =       0.000492575211
  error estimate for blocks of size 2^( 6) =       0.000499029519
  error estimate for blocks of size 2^( 7) =       0.000503529883

      target function =                  N/A
              le_mean =     -16.905922340207
             les_mean =     286.212037167195
             stat err =       0.000494634609
             autocorr =       1.217754293964
              std dev =       0.633898410633
             le_variance =       0.401827195003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401944944305
                                         uncertainty =       0.063240803284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401944944305
                                         uncertainty =       0.063240803284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448260511
  error estimate for blocks of size 2^( 2) =       0.000459976810
  error estimate for blocks of size 2^( 3) =       0.000472207837
  error estimate for blocks of size 2^( 4) =       0.000483425675
  error estimate for blocks of size 2^( 5) =       0.000492595789
  error estimate for blocks of size 2^( 6) =       0.000499048407
  error estimate for blocks of size 2^( 7) =       0.000503548855

      target function =                  N/A
              le_mean =     -16.905922904517
             les_mean =     286.212104024573
             stat err =       0.000494654681
             autocorr =       1.217708346778
              std dev =       0.633936094591
             le_variance =       0.401874972025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401921801125
                                         uncertainty =       0.063233846115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401921801125
                                         uncertainty =       0.063233846115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448247607
  error estimate for blocks of size 2^( 2) =       0.000459964357
  error estimate for blocks of size 2^( 3) =       0.000472196263
  error estimate for blocks of size 2^( 4) =       0.000483414984
  error estimate for blocks of size 2^( 5) =       0.000492585721
  error estimate for blocks of size 2^( 6) =       0.000499039103
  error estimate for blocks of size 2^( 7) =       0.000503539473

      target function =                  N/A
              le_mean =     -16.905922662807
             les_mean =     286.212072714263
             stat err =       0.000494644820
             autocorr =       1.217729905542
              std dev =       0.633917845135
             le_variance =       0.401851834381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401900250133
                                         uncertainty =       0.063228148317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.401900250133
                                         uncertainty =       0.063228148317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000448235589
  error estimate for blocks of size 2^( 2) =       0.000459952789
  error estimate for blocks of size 2^( 3) =       0.000472185584
  error estimate for blocks of size 2^( 4) =       0.000483405218
  error estimate for blocks of size 2^( 5) =       0.000492576525
  error estimate for blocks of size 2^( 6) =       0.000499030715
  error estimate for blocks of size 2^( 7) =       0.000503531078

      target function =                  N/A
              le_mean =     -16.905922381673
             les_mean =     286.212041661334
             stat err =       0.000494635884
             autocorr =       1.217751201675
              std dev =       0.633900849575
             le_variance =       0.401830287092


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905922340207        initial
     2.3842e+00     2.3842e+01             6.6278e-05       -16.905922904517  <--
     9.5367e+00     9.5367e+01             1.7400e-05       -16.905922662807
     3.8147e+01     3.8147e+02             4.4081e-06       -16.905922381673

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 3.0011e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.942290e-01 1 1  ON 0
 uu_1                 1.270740e-01 1 1  ON 1
 uu_2                 2.528380e-02 1 1  ON 2
 uu_3                -3.751744e-02 1 1  ON 3
 uu_4                -8.373399e-02 1 1  ON 4
 uu_5                -1.198539e-01 1 1  ON 5
 uu_6                -1.486431e-01 1 1  ON 6
 uu_7                -1.638584e-01 1 1  ON 7
 uu_8                -1.560620e-01 1 1  ON 8
 uu_9                -1.289837e-01 1 1  ON 9
 ud_0                 4.551945e-01 1 1  ON 10
 ud_1                 1.899864e-01 1 1  ON 11
 ud_2                 7.046418e-02 1 1  ON 12
 ud_3                -2.358777e-04 1 1  ON 13
 ud_4                -5.810221e-02 1 1  ON 14
 ud_5                -1.006975e-01 1 1  ON 15
 ud_6                -1.296692e-01 1 1  ON 16
 ud_7                -1.476868e-01 1 1  ON 17
 ud_8                -1.501441e-01 1 1  ON 18
 ud_9                -1.416842e-01 1 1  ON 19
 eO_0                -7.054688e-01 1 1  ON 20
 eO_1                -3.855013e-01 1 1  ON 21
 eO_2                 2.808434e-02 1 1  ON 22
 eO_3                 3.438841e-01 1 1  ON 23
 eO_4                 5.680897e-01 1 1  ON 24
 eO_5                 5.254957e-01 1 1  ON 25
 eO_6                 2.821026e-01 1 1  ON 26
 eO_7                -6.501586e-02 1 1  ON 27
 eO_8                -3.285140e-01 1 1  ON 28
 eO_9                -2.249162e-01 1 1  ON 29
eH1_0                -2.917358e-01 1 1  ON 30
eH1_1                -1.886960e-01 1 1  ON 31
eH1_2                -1.401500e-01 1 1  ON 32
eH1_3                -8.511833e-02 1 1  ON 33
eH1_4                -3.487641e-02 1 1  ON 34
eH1_5                 4.709351e-03 1 1  ON 35
eH1_6                 7.306956e-02 1 1  ON 36
eH1_7                 1.571226e-01 1 1  ON 37
eH1_8                 2.278513e-01 1 1  ON 38
eH1_9                 2.108743e-01 1 1  ON 39
eH2_0                -2.898594e-01 1 1  ON 40
eH2_1                -1.870143e-01 1 1  ON 41
eH2_2                -1.383868e-01 1 1  ON 42
eH2_3                -8.312014e-02 1 1  ON 43
eH2_4                -3.320718e-02 1 1  ON 44
eH2_5                 5.743739e-03 1 1  ON 45
eH2_6                 7.492178e-02 1 1  ON 46
eH2_7                 1.569187e-01 1 1  ON 47
eH2_8                 2.243664e-01 1 1  ON 48
eH2_9                 2.362759e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.999
    reference variance = 0.19194
====================================================
  Execution time = 2.2570e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4125e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341054859391
                                         uncertainty =       0.003922574876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341054859391
                                         uncertainty =       0.003922574876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413066110
  error estimate for blocks of size 2^( 2) =       0.000425956152
  error estimate for blocks of size 2^( 3) =       0.000438859095
  error estimate for blocks of size 2^( 4) =       0.000450760479
  error estimate for blocks of size 2^( 5) =       0.000461087370
  error estimate for blocks of size 2^( 6) =       0.000468904728
  error estimate for blocks of size 2^( 7) =       0.000474083156

      target function =                  N/A
              le_mean =     -16.905963956496
             les_mean =     286.152864350988
             stat err =       0.000463708933
             autocorr =       1.260235746663
              std dev =       0.584163695610
             le_variance =       0.341247223268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596395650e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963956496       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905964418298       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905964834075       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905965155663       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905965879626       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905965468335       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905965375676       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905965433308       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 3.103864e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963956496       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905964099737       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905964250818       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905964376827       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905964585192       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905964427485       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905964415714       residual = 7.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.022239e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963956496       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963994599       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905964036972       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905964072660       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905964125384       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905964080121       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905964082755       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.725081e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099085 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8120e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.942276e-01 1 1  ON 0
 uu_1                 1.270414e-01 1 1  ON 1
 uu_2                 2.527993e-02 1 1  ON 2
 uu_3                -3.753821e-02 1 1  ON 3
 uu_4                -8.369540e-02 1 1  ON 4
 uu_5                -1.198452e-01 1 1  ON 5
 uu_6                -1.485987e-01 1 1  ON 6
 uu_7                -1.638292e-01 1 1  ON 7
 uu_8                -1.561003e-01 1 1  ON 8
 uu_9                -1.290130e-01 1 1  ON 9
 ud_0                 4.552967e-01 1 1  ON 10
 ud_1                 1.900137e-01 1 1  ON 11
 ud_2                 7.047653e-02 1 1  ON 12
 ud_3                -2.515266e-04 1 1  ON 13
 ud_4                -5.811500e-02 1 1  ON 14
 ud_5                -1.007197e-01 1 1  ON 15
 ud_6                -1.296703e-01 1 1  ON 16
 ud_7                -1.476996e-01 1 1  ON 17
 ud_8                -1.501357e-01 1 1  ON 18
 ud_9                -1.417079e-01 1 1  ON 19
 eO_0                -7.054546e-01 1 1  ON 20
 eO_1                -3.854912e-01 1 1  ON 21
 eO_2                 2.809896e-02 1 1  ON 22
 eO_3                 3.438737e-01 1 1  ON 23
 eO_4                 5.681562e-01 1 1  ON 24
 eO_5                 5.254880e-01 1 1  ON 25
 eO_6                 2.820946e-01 1 1  ON 26
 eO_7                -6.501581e-02 1 1  ON 27
 eO_8                -3.285351e-01 1 1  ON 28
 eO_9                -2.249607e-01 1 1  ON 29
eH1_0                -2.917781e-01 1 1  ON 30
eH1_1                -1.886643e-01 1 1  ON 31
eH1_2                -1.401912e-01 1 1  ON 32
eH1_3                -8.507799e-02 1 1  ON 33
eH1_4                -3.489056e-02 1 1  ON 34
eH1_5                 4.722922e-03 1 1  ON 35
eH1_6                 7.305743e-02 1 1  ON 36
eH1_7                 1.571094e-01 1 1  ON 37
eH1_8                 2.278515e-01 1 1  ON 38
eH1_9                 2.108969e-01 1 1  ON 39
eH2_0                -2.898880e-01 1 1  ON 40
eH2_1                -1.870436e-01 1 1  ON 41
eH2_2                -1.384004e-01 1 1  ON 42
eH2_3                -8.313873e-02 1 1  ON 43
eH2_4                -3.316552e-02 1 1  ON 44
eH2_5                 5.727782e-03 1 1  ON 45
eH2_6                 7.492137e-02 1 1  ON 46
eH2_7                 1.569566e-01 1 1  ON 47
eH2_8                 2.243846e-01 1 1  ON 48
eH2_9                 2.362761e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8999
    reference variance = 0.600134
====================================================
  Execution time = 2.0104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4482e-01
  Total weights = 2.0000e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344763107909
                                         uncertainty =       0.008169333477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344763107909
                                         uncertainty =       0.008169333477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415179331
  error estimate for blocks of size 2^( 2) =       0.000428352556
  error estimate for blocks of size 2^( 3) =       0.000441469312
  error estimate for blocks of size 2^( 4) =       0.000454369962
  error estimate for blocks of size 2^( 5) =       0.000465735016
  error estimate for blocks of size 2^( 6) =       0.000475752378
  error estimate for blocks of size 2^( 7) =       0.000482336375

      target function =                  N/A
              le_mean =     -16.906278813565
             les_mean =     286.167010903542
             stat err =       0.000469548433
             autocorr =       1.279055355691
              std dev =       0.587152240836
             le_variance =       0.344747753918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344973653348
                                         uncertainty =       0.008172420019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344973653348
                                         uncertainty =       0.008172420019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415306076
  error estimate for blocks of size 2^( 2) =       0.000428472110
  error estimate for blocks of size 2^( 3) =       0.000441581589
  error estimate for blocks of size 2^( 4) =       0.000454475263
  error estimate for blocks of size 2^( 5) =       0.000465836895
  error estimate for blocks of size 2^( 6) =       0.000475846845
  error estimate for blocks of size 2^( 7) =       0.000482428448

      target function =                  N/A
              le_mean =     -16.906278740487
             les_mean =     286.167218951796
             stat err =       0.000469646863
             autocorr =       1.278810759664
              std dev =       0.587331484954
             le_variance =       0.344958273219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344913787833
                                         uncertainty =       0.008171356114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344913787833
                                         uncertainty =       0.008171356114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415270043
  error estimate for blocks of size 2^( 2) =       0.000428438213
  error estimate for blocks of size 2^( 3) =       0.000441550054
  error estimate for blocks of size 2^( 4) =       0.000454445775
  error estimate for blocks of size 2^( 5) =       0.000465808492
  error estimate for blocks of size 2^( 6) =       0.000475821213
  error estimate for blocks of size 2^( 7) =       0.000482403782

      target function =                  N/A
              le_mean =     -16.906278927274
             les_mean =     286.167165411056
             stat err =       0.000469619815
             autocorr =       1.278885378414
              std dev =       0.587280526410
             le_variance =       0.344898416701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344783478785
                                         uncertainty =       0.008169598533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344783478785
                                         uncertainty =       0.008169598533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415191596
  error estimate for blocks of size 2^( 2) =       0.000428364131
  error estimate for blocks of size 2^( 3) =       0.000441480215
  error estimate for blocks of size 2^( 4) =       0.000454380196
  error estimate for blocks of size 2^( 5) =       0.000465744932
  error estimate for blocks of size 2^( 6) =       0.000475761675
  error estimate for blocks of size 2^( 7) =       0.000482345488

      target function =                  N/A
              le_mean =     -16.906278824603
             les_mean =     286.167031645218
             stat err =       0.000469558073
             autocorr =       1.279032308279
              std dev =       0.587169585695
             le_variance =       0.344768122365


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906278813565        initial
     5.9605e-01     5.9605e+00             3.1039e-04       -16.906278740487
     2.3842e+00     2.3842e+01             1.0222e-04       -16.906278927274  <--
     9.5367e+00     9.5367e+01             2.7251e-05       -16.906278824603

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.9619e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.942276e-01 1 1  ON 0
 uu_1                 1.270414e-01 1 1  ON 1
 uu_2                 2.527993e-02 1 1  ON 2
 uu_3                -3.753821e-02 1 1  ON 3
 uu_4                -8.369540e-02 1 1  ON 4
 uu_5                -1.198452e-01 1 1  ON 5
 uu_6                -1.485987e-01 1 1  ON 6
 uu_7                -1.638292e-01 1 1  ON 7
 uu_8                -1.561003e-01 1 1  ON 8
 uu_9                -1.290130e-01 1 1  ON 9
 ud_0                 4.552967e-01 1 1  ON 10
 ud_1                 1.900137e-01 1 1  ON 11
 ud_2                 7.047653e-02 1 1  ON 12
 ud_3                -2.515266e-04 1 1  ON 13
 ud_4                -5.811500e-02 1 1  ON 14
 ud_5                -1.007197e-01 1 1  ON 15
 ud_6                -1.296703e-01 1 1  ON 16
 ud_7                -1.476996e-01 1 1  ON 17
 ud_8                -1.501357e-01 1 1  ON 18
 ud_9                -1.417079e-01 1 1  ON 19
 eO_0                -7.054546e-01 1 1  ON 20
 eO_1                -3.854912e-01 1 1  ON 21
 eO_2                 2.809896e-02 1 1  ON 22
 eO_3                 3.438737e-01 1 1  ON 23
 eO_4                 5.681562e-01 1 1  ON 24
 eO_5                 5.254880e-01 1 1  ON 25
 eO_6                 2.820946e-01 1 1  ON 26
 eO_7                -6.501581e-02 1 1  ON 27
 eO_8                -3.285351e-01 1 1  ON 28
 eO_9                -2.249607e-01 1 1  ON 29
eH1_0                -2.917781e-01 1 1  ON 30
eH1_1                -1.886643e-01 1 1  ON 31
eH1_2                -1.401912e-01 1 1  ON 32
eH1_3                -8.507799e-02 1 1  ON 33
eH1_4                -3.489056e-02 1 1  ON 34
eH1_5                 4.722922e-03 1 1  ON 35
eH1_6                 7.305743e-02 1 1  ON 36
eH1_7                 1.571094e-01 1 1  ON 37
eH1_8                 2.278515e-01 1 1  ON 38
eH1_9                 2.108969e-01 1 1  ON 39
eH2_0                -2.898880e-01 1 1  ON 40
eH2_1                -1.870436e-01 1 1  ON 41
eH2_2                -1.384004e-01 1 1  ON 42
eH2_3                -8.313873e-02 1 1  ON 43
eH2_4                -3.316552e-02 1 1  ON 44
eH2_5                 5.727782e-03 1 1  ON 45
eH2_6                 7.492137e-02 1 1  ON 46
eH2_7                 1.569566e-01 1 1  ON 47
eH2_8                 2.243846e-01 1 1  ON 48
eH2_9                 2.362761e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7745e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8809
    reference variance = 0.268341
====================================================
  Execution time = 2.0687e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4802e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347984673505
                                         uncertainty =       0.010772390563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347984673505
                                         uncertainty =       0.010772390563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417145436
  error estimate for blocks of size 2^( 2) =       0.000429682637
  error estimate for blocks of size 2^( 3) =       0.000442966250
  error estimate for blocks of size 2^( 4) =       0.000455514328
  error estimate for blocks of size 2^( 5) =       0.000466628686
  error estimate for blocks of size 2^( 6) =       0.000475030555
  error estimate for blocks of size 2^( 7) =       0.000479004463

      target function =                  N/A
              le_mean =     -16.906889817687
             les_mean =     286.190943763382
             stat err =       0.000469044508
             autocorr =       1.264308672877
              std dev =       0.589932733446
             le_variance =       0.348020629991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690688981769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906889817687       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906889412256       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906889404591       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906889200434       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906889508317       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906889935069       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906889545923       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906889623204       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 2.680188e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906889817687       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906889690032       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906889660830       residual = 8.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906889575367       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906889653072       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906889780280       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906889678249       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906889690769       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 7.115000e-05

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906889817687       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906889783559       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906889772918       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906889748394       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906889767872       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906889799728       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906889775052       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906889777066       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.808774e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6163e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.941805e-01 1 1  ON 0
 uu_1                 1.270414e-01 1 1  ON 1
 uu_2                 2.531049e-02 1 1  ON 2
 uu_3                -3.752907e-02 1 1  ON 3
 uu_4                -8.373473e-02 1 1  ON 4
 uu_5                -1.197938e-01 1 1  ON 5
 uu_6                -1.486193e-01 1 1  ON 6
 uu_7                -1.638514e-01 1 1  ON 7
 uu_8                -1.561019e-01 1 1  ON 8
 uu_9                -1.289974e-01 1 1  ON 9
 ud_0                 4.552956e-01 1 1  ON 10
 ud_1                 1.900336e-01 1 1  ON 11
 ud_2                 7.048260e-02 1 1  ON 12
 ud_3                -2.818443e-04 1 1  ON 13
 ud_4                -5.809726e-02 1 1  ON 14
 ud_5                -1.007159e-01 1 1  ON 15
 ud_6                -1.296740e-01 1 1  ON 16
 ud_7                -1.476860e-01 1 1  ON 17
 ud_8                -1.501343e-01 1 1  ON 18
 ud_9                -1.417021e-01 1 1  ON 19
 eO_0                -7.054581e-01 1 1  ON 20
 eO_1                -3.854965e-01 1 1  ON 21
 eO_2                 2.811633e-02 1 1  ON 22
 eO_3                 3.438667e-01 1 1  ON 23
 eO_4                 5.682062e-01 1 1  ON 24
 eO_5                 5.255180e-01 1 1  ON 25
 eO_6                 2.820699e-01 1 1  ON 26
 eO_7                -6.500834e-02 1 1  ON 27
 eO_8                -3.285462e-01 1 1  ON 28
 eO_9                -2.250014e-01 1 1  ON 29
eH1_0                -2.918492e-01 1 1  ON 30
eH1_1                -1.886993e-01 1 1  ON 31
eH1_2                -1.402196e-01 1 1  ON 32
eH1_3                -8.508957e-02 1 1  ON 33
eH1_4                -3.489323e-02 1 1  ON 34
eH1_5                 4.716863e-03 1 1  ON 35
eH1_6                 7.308731e-02 1 1  ON 36
eH1_7                 1.571505e-01 1 1  ON 37
eH1_8                 2.278705e-01 1 1  ON 38
eH1_9                 2.109383e-01 1 1  ON 39
eH2_0                -2.899268e-01 1 1  ON 40
eH2_1                -1.870230e-01 1 1  ON 41
eH2_2                -1.384237e-01 1 1  ON 42
eH2_3                -8.316635e-02 1 1  ON 43
eH2_4                -3.313760e-02 1 1  ON 44
eH2_5                 5.735461e-03 1 1  ON 45
eH2_6                 7.491829e-02 1 1  ON 46
eH2_7                 1.569328e-01 1 1  ON 47
eH2_8                 2.243857e-01 1 1  ON 48
eH2_9                 2.363069e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8293
    reference variance = 0.43657
====================================================
  Execution time = 2.0311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.0000e+06
  Execution time = 1.8961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336935340348
                                         uncertainty =       0.003366477881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336935340348
                                         uncertainty =       0.003366477881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410476498
  error estimate for blocks of size 2^( 2) =       0.000423034423
  error estimate for blocks of size 2^( 3) =       0.000435378305
  error estimate for blocks of size 2^( 4) =       0.000447774494
  error estimate for blocks of size 2^( 5) =       0.000458731233
  error estimate for blocks of size 2^( 6) =       0.000464601116
  error estimate for blocks of size 2^( 7) =       0.000469956537

      target function =                  N/A
              le_mean =     -16.906794340980
             les_mean =     286.176676630375
             stat err =       0.000460265845
             autocorr =       1.257305756116
              std dev =       0.580501430382
             le_variance =       0.336981910676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336862359636
                                         uncertainty =       0.003365314015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336862359636
                                         uncertainty =       0.003365314015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410431955
  error estimate for blocks of size 2^( 2) =       0.000422991488
  error estimate for blocks of size 2^( 3) =       0.000435335744
  error estimate for blocks of size 2^( 4) =       0.000447728494
  error estimate for blocks of size 2^( 5) =       0.000458681294
  error estimate for blocks of size 2^( 6) =       0.000464548123
  error estimate for blocks of size 2^( 7) =       0.000469904748

      target function =                  N/A
              le_mean =     -16.906793628138
             les_mean =     286.176579395721
             stat err =       0.000460215665
             autocorr =       1.257304473804
              std dev =       0.580438437512
             le_variance =       0.336908779741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336875227133
                                         uncertainty =       0.003365547218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336875227133
                                         uncertainty =       0.003365547218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410439816
  error estimate for blocks of size 2^( 2) =       0.000422999211
  error estimate for blocks of size 2^( 3) =       0.000435343752
  error estimate for blocks of size 2^( 4) =       0.000447738051
  error estimate for blocks of size 2^( 5) =       0.000458692625
  error estimate for blocks of size 2^( 6) =       0.000464561061
  error estimate for blocks of size 2^( 7) =       0.000469917535

      target function =                  N/A
              le_mean =     -16.906793810715
             les_mean =     286.176598474616
             stat err =       0.000460227318
             autocorr =       1.257319986633
              std dev =       0.580449554276
             le_variance =       0.336921685060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336926258564
                                         uncertainty =       0.003366337666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336926258564
                                         uncertainty =       0.003366337666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410470957
  error estimate for blocks of size 2^( 2) =       0.000423029112
  error estimate for blocks of size 2^( 3) =       0.000435373111
  error estimate for blocks of size 2^( 4) =       0.000447769067
  error estimate for blocks of size 2^( 5) =       0.000458725537
  error estimate for blocks of size 2^( 6) =       0.000464595255
  error estimate for blocks of size 2^( 7) =       0.000469950840

      target function =                  N/A
              le_mean =     -16.906794256424
             les_mean =     286.176664673262
             stat err =       0.000460260175
             autocorr =       1.257308722273
              std dev =       0.580493594015
             le_variance =       0.336972812692


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906794340980        initial  <--
     5.9605e-01     5.9605e+00             2.6802e-04       -16.906793628138
     2.3842e+00     2.3842e+01             7.1150e-05       -16.906793810715
     9.5367e+00     9.5367e+01             1.8088e-05       -16.906794256424

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8329
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.942276e-01 1 1  ON 0
 uu_1                 1.270414e-01 1 1  ON 1
 uu_2                 2.527993e-02 1 1  ON 2
 uu_3                -3.753821e-02 1 1  ON 3
 uu_4                -8.369540e-02 1 1  ON 4
 uu_5                -1.198452e-01 1 1  ON 5
 uu_6                -1.485987e-01 1 1  ON 6
 uu_7                -1.638292e-01 1 1  ON 7
 uu_8                -1.561003e-01 1 1  ON 8
 uu_9                -1.290130e-01 1 1  ON 9
 ud_0                 4.552967e-01 1 1  ON 10
 ud_1                 1.900137e-01 1 1  ON 11
 ud_2                 7.047653e-02 1 1  ON 12
 ud_3                -2.515266e-04 1 1  ON 13
 ud_4                -5.811500e-02 1 1  ON 14
 ud_5                -1.007197e-01 1 1  ON 15
 ud_6                -1.296703e-01 1 1  ON 16
 ud_7                -1.476996e-01 1 1  ON 17
 ud_8                -1.501357e-01 1 1  ON 18
 ud_9                -1.417079e-01 1 1  ON 19
 eO_0                -7.054546e-01 1 1  ON 20
 eO_1                -3.854912e-01 1 1  ON 21
 eO_2                 2.809896e-02 1 1  ON 22
 eO_3                 3.438737e-01 1 1  ON 23
 eO_4                 5.681562e-01 1 1  ON 24
 eO_5                 5.254880e-01 1 1  ON 25
 eO_6                 2.820946e-01 1 1  ON 26
 eO_7                -6.501581e-02 1 1  ON 27
 eO_8                -3.285351e-01 1 1  ON 28
 eO_9                -2.249607e-01 1 1  ON 29
eH1_0                -2.917781e-01 1 1  ON 30
eH1_1                -1.886643e-01 1 1  ON 31
eH1_2                -1.401912e-01 1 1  ON 32
eH1_3                -8.507799e-02 1 1  ON 33
eH1_4                -3.489056e-02 1 1  ON 34
eH1_5                 4.722922e-03 1 1  ON 35
eH1_6                 7.305743e-02 1 1  ON 36
eH1_7                 1.571094e-01 1 1  ON 37
eH1_8                 2.278515e-01 1 1  ON 38
eH1_9                 2.108969e-01 1 1  ON 39
eH2_0                -2.898880e-01 1 1  ON 40
eH2_1                -1.870436e-01 1 1  ON 41
eH2_2                -1.384004e-01 1 1  ON 42
eH2_3                -8.313873e-02 1 1  ON 43
eH2_4                -3.316552e-02 1 1  ON 44
eH2_5                 5.727782e-03 1 1  ON 45
eH2_6                 7.492137e-02 1 1  ON 46
eH2_7                 1.569566e-01 1 1  ON 47
eH2_8                 2.243846e-01 1 1  ON 48
eH2_9                 2.362761e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6015e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9403
    reference variance = 0.385252
====================================================
  Execution time = 2.0478e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3833e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338375896187
                                         uncertainty =       0.004771087874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338375896187
                                         uncertainty =       0.004771087874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411299031
  error estimate for blocks of size 2^( 2) =       0.000423910961
  error estimate for blocks of size 2^( 3) =       0.000436417094
  error estimate for blocks of size 2^( 4) =       0.000448136220
  error estimate for blocks of size 2^( 5) =       0.000459161014
  error estimate for blocks of size 2^( 6) =       0.000468055082
  error estimate for blocks of size 2^( 7) =       0.000476528982

      target function =                  N/A
              le_mean =     -16.906529110634
             les_mean =     286.169060185874
             stat err =       0.000462970324
             autocorr =       1.267041778399
              std dev =       0.581664668280
             le_variance =       0.338333786325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652911063e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906529110634       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906529233331       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529306147       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529336395       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529332603       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529343360       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529342777       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906529345586       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 2.863023e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906529110634       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906529142107       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529161072       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529169289       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529168391       residual = 8.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529170721       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529170704       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 7.036009e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906529110634       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906529118554       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529123345       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529125443       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529125225       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529125776       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529125785       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.761189e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5964e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.942321e-01 1 1  ON 0
 uu_1                 1.270379e-01 1 1  ON 1
 uu_2                 2.527958e-02 1 1  ON 2
 uu_3                -3.753989e-02 1 1  ON 3
 uu_4                -8.370042e-02 1 1  ON 4
 uu_5                -1.198436e-01 1 1  ON 5
 uu_6                -1.485982e-01 1 1  ON 6
 uu_7                -1.638246e-01 1 1  ON 7
 uu_8                -1.560989e-01 1 1  ON 8
 uu_9                -1.290151e-01 1 1  ON 9
 ud_0                 4.553008e-01 1 1  ON 10
 ud_1                 1.900174e-01 1 1  ON 11
 ud_2                 7.047804e-02 1 1  ON 12
 ud_3                -2.557352e-04 1 1  ON 13
 ud_4                -5.811161e-02 1 1  ON 14
 ud_5                -1.007191e-01 1 1  ON 15
 ud_6                -1.296716e-01 1 1  ON 16
 ud_7                -1.477004e-01 1 1  ON 17
 ud_8                -1.501375e-01 1 1  ON 18
 ud_9                -1.417113e-01 1 1  ON 19
 eO_0                -7.054540e-01 1 1  ON 20
 eO_1                -3.854931e-01 1 1  ON 21
 eO_2                 2.810053e-02 1 1  ON 22
 eO_3                 3.438771e-01 1 1  ON 23
 eO_4                 5.681603e-01 1 1  ON 24
 eO_5                 5.254867e-01 1 1  ON 25
 eO_6                 2.820943e-01 1 1  ON 26
 eO_7                -6.501307e-02 1 1  ON 27
 eO_8                -3.285386e-01 1 1  ON 28
 eO_9                -2.249652e-01 1 1  ON 29
eH1_0                -2.917851e-01 1 1  ON 30
eH1_1                -1.886640e-01 1 1  ON 31
eH1_2                -1.401923e-01 1 1  ON 32
eH1_3                -8.507308e-02 1 1  ON 33
eH1_4                -3.489005e-02 1 1  ON 34
eH1_5                 4.722211e-03 1 1  ON 35
eH1_6                 7.305608e-02 1 1  ON 36
eH1_7                 1.571093e-01 1 1  ON 37
eH1_8                 2.278521e-01 1 1  ON 38
eH1_9                 2.108998e-01 1 1  ON 39
eH2_0                -2.898940e-01 1 1  ON 40
eH2_1                -1.870435e-01 1 1  ON 41
eH2_2                -1.384007e-01 1 1  ON 42
eH2_3                -8.313727e-02 1 1  ON 43
eH2_4                -3.316609e-02 1 1  ON 44
eH2_5                 5.722004e-03 1 1  ON 45
eH2_6                 7.492133e-02 1 1  ON 46
eH2_7                 1.569608e-01 1 1  ON 47
eH2_8                 2.243876e-01 1 1  ON 48
eH2_9                 2.362775e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9006
    reference variance = 0.220254
====================================================
  Execution time = 2.0478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3732e-01
  Total weights = 2.0000e+06
  Execution time = 1.8979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337265529303
                                         uncertainty =       0.003112267041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337265529303
                                         uncertainty =       0.003112267041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410679684
  error estimate for blocks of size 2^( 2) =       0.000423529311
  error estimate for blocks of size 2^( 3) =       0.000436935879
  error estimate for blocks of size 2^( 4) =       0.000450303653
  error estimate for blocks of size 2^( 5) =       0.000462263626
  error estimate for blocks of size 2^( 6) =       0.000471445160
  error estimate for blocks of size 2^( 7) =       0.000476619848

      target function =                  N/A
              le_mean =     -16.906539994085
             les_mean =     286.168410008958
             stat err =       0.000465158072
             autocorr =       1.282905551013
              std dev =       0.580788779180
             le_variance =       0.337315606021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337274387635
                                         uncertainty =       0.003112342227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337274387635
                                         uncertainty =       0.003112342227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410685068
  error estimate for blocks of size 2^( 2) =       0.000423534404
  error estimate for blocks of size 2^( 3) =       0.000436940758
  error estimate for blocks of size 2^( 4) =       0.000450308189
  error estimate for blocks of size 2^( 5) =       0.000462268074
  error estimate for blocks of size 2^( 6) =       0.000471449915
  error estimate for blocks of size 2^( 7) =       0.000476624623

      target function =                  N/A
              le_mean =     -16.906539900955
             les_mean =     286.168415704249
             stat err =       0.000465162700
             autocorr =       1.282897444040
              std dev =       0.580796393174
             le_variance =       0.337324450323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337269438970
                                         uncertainty =       0.003112297058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337269438970
                                         uncertainty =       0.003112297058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410682060
  error estimate for blocks of size 2^( 2) =       0.000423531562
  error estimate for blocks of size 2^( 3) =       0.000436938044
  error estimate for blocks of size 2^( 4) =       0.000450305654
  error estimate for blocks of size 2^( 5) =       0.000462265599
  error estimate for blocks of size 2^( 6) =       0.000471447301
  error estimate for blocks of size 2^( 7) =       0.000476622023

      target function =                  N/A
              le_mean =     -16.906539938961
             les_mean =     286.168412047282
             stat err =       0.000465160144
             autocorr =       1.282902141982
              std dev =       0.580792138585
             le_variance =       0.337319508242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337266011643
                                         uncertainty =       0.003112270733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337266011643
                                         uncertainty =       0.003112270733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410679977
  error estimate for blocks of size 2^( 2) =       0.000423529588
  error estimate for blocks of size 2^( 3) =       0.000436936146
  error estimate for blocks of size 2^( 4) =       0.000450303899
  error estimate for blocks of size 2^( 5) =       0.000462263869
  error estimate for blocks of size 2^( 6) =       0.000471445424
  error estimate for blocks of size 2^( 7) =       0.000476620117

      target function =                  N/A
              le_mean =     -16.906539986916
             les_mean =     286.168410247937
             stat err =       0.000465158328
             autocorr =       1.282905131187
              std dev =       0.580789193614
             le_variance =       0.337316087419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906539994085        initial  <--
     5.9605e+00     5.9605e+01             2.8630e-05       -16.906539900955
     2.3842e+01     2.3842e+02             7.0360e-06       -16.906539938961
     9.5367e+01     9.5367e+02             1.7612e-06       -16.906539986916

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0050
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.942276e-01 1 1  ON 0
 uu_1                 1.270414e-01 1 1  ON 1
 uu_2                 2.527993e-02 1 1  ON 2
 uu_3                -3.753821e-02 1 1  ON 3
 uu_4                -8.369540e-02 1 1  ON 4
 uu_5                -1.198452e-01 1 1  ON 5
 uu_6                -1.485987e-01 1 1  ON 6
 uu_7                -1.638292e-01 1 1  ON 7
 uu_8                -1.561003e-01 1 1  ON 8
 uu_9                -1.290130e-01 1 1  ON 9
 ud_0                 4.552967e-01 1 1  ON 10
 ud_1                 1.900137e-01 1 1  ON 11
 ud_2                 7.047653e-02 1 1  ON 12
 ud_3                -2.515266e-04 1 1  ON 13
 ud_4                -5.811500e-02 1 1  ON 14
 ud_5                -1.007197e-01 1 1  ON 15
 ud_6                -1.296703e-01 1 1  ON 16
 ud_7                -1.476996e-01 1 1  ON 17
 ud_8                -1.501357e-01 1 1  ON 18
 ud_9                -1.417079e-01 1 1  ON 19
 eO_0                -7.054546e-01 1 1  ON 20
 eO_1                -3.854912e-01 1 1  ON 21
 eO_2                 2.809896e-02 1 1  ON 22
 eO_3                 3.438737e-01 1 1  ON 23
 eO_4                 5.681562e-01 1 1  ON 24
 eO_5                 5.254880e-01 1 1  ON 25
 eO_6                 2.820946e-01 1 1  ON 26
 eO_7                -6.501581e-02 1 1  ON 27
 eO_8                -3.285351e-01 1 1  ON 28
 eO_9                -2.249607e-01 1 1  ON 29
eH1_0                -2.917781e-01 1 1  ON 30
eH1_1                -1.886643e-01 1 1  ON 31
eH1_2                -1.401912e-01 1 1  ON 32
eH1_3                -8.507799e-02 1 1  ON 33
eH1_4                -3.489056e-02 1 1  ON 34
eH1_5                 4.722922e-03 1 1  ON 35
eH1_6                 7.305743e-02 1 1  ON 36
eH1_7                 1.571094e-01 1 1  ON 37
eH1_8                 2.278515e-01 1 1  ON 38
eH1_9                 2.108969e-01 1 1  ON 39
eH2_0                -2.898880e-01 1 1  ON 40
eH2_1                -1.870436e-01 1 1  ON 41
eH2_2                -1.384004e-01 1 1  ON 42
eH2_3                -8.313873e-02 1 1  ON 43
eH2_4                -3.316552e-02 1 1  ON 44
eH2_5                 5.727782e-03 1 1  ON 45
eH2_6                 7.492137e-02 1 1  ON 46
eH2_7                 1.569566e-01 1 1  ON 47
eH2_8                 2.243846e-01 1 1  ON 48
eH2_9                 2.362761e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5975e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.257242
====================================================
  Execution time = 2.0675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4492e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345008794271
                                         uncertainty =       0.006049007040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345008794271
                                         uncertainty =       0.006049007040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415280147
  error estimate for blocks of size 2^( 2) =       0.000427650973
  error estimate for blocks of size 2^( 3) =       0.000440608844
  error estimate for blocks of size 2^( 4) =       0.000452871006
  error estimate for blocks of size 2^( 5) =       0.000463935846
  error estimate for blocks of size 2^( 6) =       0.000471046090
  error estimate for blocks of size 2^( 7) =       0.000475739758

      target function =                  N/A
              le_mean =     -16.907078840117
             les_mean =     286.194229934497
             stat err =       0.000465898175
             autocorr =       1.258634638009
              std dev =       0.587294816112
             le_variance =       0.344915201032


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690707884012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907078840117       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907078842906       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907078853787       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907078854624       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907078847770       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907078846129       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907078847540       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907078846663       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.917674e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907078840117       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907078840816       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907078843547       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907078843756       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907078842042       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907078841630       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907078841977       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907078841755       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 9.805469e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907078840117       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907078840292       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907078840975       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907078841027       residual = 7.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907078840599       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907078840496       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907078840582       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907078840527       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.452074e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106577 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6210e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.942276e-01 1 1  ON 0
 uu_1                 1.270417e-01 1 1  ON 1
 uu_2                 2.527997e-02 1 1  ON 2
 uu_3                -3.753799e-02 1 1  ON 3
 uu_4                -8.369538e-02 1 1  ON 4
 uu_5                -1.198451e-01 1 1  ON 5
 uu_6                -1.485986e-01 1 1  ON 6
 uu_7                -1.638289e-01 1 1  ON 7
 uu_8                -1.561006e-01 1 1  ON 8
 uu_9                -1.290136e-01 1 1  ON 9
 ud_0                 4.552968e-01 1 1  ON 10
 ud_1                 1.900143e-01 1 1  ON 11
 ud_2                 7.047676e-02 1 1  ON 12
 ud_3                -2.514838e-04 1 1  ON 13
 ud_4                -5.811473e-02 1 1  ON 14
 ud_5                -1.007197e-01 1 1  ON 15
 ud_6                -1.296703e-01 1 1  ON 16
 ud_7                -1.476995e-01 1 1  ON 17
 ud_8                -1.501358e-01 1 1  ON 18
 ud_9                -1.417084e-01 1 1  ON 19
 eO_0                -7.054547e-01 1 1  ON 20
 eO_1                -3.854908e-01 1 1  ON 21
 eO_2                 2.809891e-02 1 1  ON 22
 eO_3                 3.438737e-01 1 1  ON 23
 eO_4                 5.681566e-01 1 1  ON 24
 eO_5                 5.254882e-01 1 1  ON 25
 eO_6                 2.820946e-01 1 1  ON 26
 eO_7                -6.501568e-02 1 1  ON 27
 eO_8                -3.285356e-01 1 1  ON 28
 eO_9                -2.249613e-01 1 1  ON 29
eH1_0                -2.917790e-01 1 1  ON 30
eH1_1                -1.886642e-01 1 1  ON 31
eH1_2                -1.401913e-01 1 1  ON 32
eH1_3                -8.507795e-02 1 1  ON 33
eH1_4                -3.489044e-02 1 1  ON 34
eH1_5                 4.722733e-03 1 1  ON 35
eH1_6                 7.305809e-02 1 1  ON 36
eH1_7                 1.571097e-01 1 1  ON 37
eH1_8                 2.278515e-01 1 1  ON 38
eH1_9                 2.108970e-01 1 1  ON 39
eH2_0                -2.898889e-01 1 1  ON 40
eH2_1                -1.870434e-01 1 1  ON 41
eH2_2                -1.384007e-01 1 1  ON 42
eH2_3                -8.313850e-02 1 1  ON 43
eH2_4                -3.316457e-02 1 1  ON 44
eH2_5                 5.727877e-03 1 1  ON 45
eH2_6                 7.492120e-02 1 1  ON 46
eH2_7                 1.569563e-01 1 1  ON 47
eH2_8                 2.243844e-01 1 1  ON 48
eH2_9                 2.362762e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8985
    reference variance = 0.25747
====================================================
  Execution time = 2.0152e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4024e-01
  Total weights = 2.0000e+06
  Execution time = 1.8938e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340226114548
                                         uncertainty =       0.004378052120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340226114548
                                         uncertainty =       0.004378052120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412456522
  error estimate for blocks of size 2^( 2) =       0.000425332347
  error estimate for blocks of size 2^( 3) =       0.000437452388
  error estimate for blocks of size 2^( 4) =       0.000449435407
  error estimate for blocks of size 2^( 5) =       0.000460244807
  error estimate for blocks of size 2^( 6) =       0.000468544429
  error estimate for blocks of size 2^( 7) =       0.000473506164

      target function =                  N/A
              le_mean =     -16.906677994043
             les_mean =     286.176001388960
             stat err =       0.000462932702
             autocorr =       1.259735508523
              std dev =       0.583301607075
             le_variance =       0.340240764816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225414116
                                         uncertainty =       0.004378053752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225414116
                                         uncertainty =       0.004378053752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412456097
  error estimate for blocks of size 2^( 2) =       0.000425331921
  error estimate for blocks of size 2^( 3) =       0.000437451939
  error estimate for blocks of size 2^( 4) =       0.000449434921
  error estimate for blocks of size 2^( 5) =       0.000460244311
  error estimate for blocks of size 2^( 6) =       0.000468543951
  error estimate for blocks of size 2^( 7) =       0.000473505672

      target function =                  N/A
              le_mean =     -16.906678004304
             les_mean =     286.176001035824
             stat err =       0.000462932214
             autocorr =       1.259735444482
              std dev =       0.583301006966
             le_variance =       0.340240064728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225760576
                                         uncertainty =       0.004378052924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340225760576
                                         uncertainty =       0.004378052924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412456307
  error estimate for blocks of size 2^( 2) =       0.000425332131
  error estimate for blocks of size 2^( 3) =       0.000437452162
  error estimate for blocks of size 2^( 4) =       0.000449435162
  error estimate for blocks of size 2^( 5) =       0.000460244557
  error estimate for blocks of size 2^( 6) =       0.000468544188
  error estimate for blocks of size 2^( 7) =       0.000473505916

      target function =                  N/A
              le_mean =     -16.906677999194
             les_mean =     286.176001209335
             stat err =       0.000462932456
             autocorr =       1.259735477973
              std dev =       0.583301303802
             le_variance =       0.340240411017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340226070180
                                         uncertainty =       0.004378052220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340226070180
                                         uncertainty =       0.004378052220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412456495
  error estimate for blocks of size 2^( 2) =       0.000425332320
  error estimate for blocks of size 2^( 3) =       0.000437452360
  error estimate for blocks of size 2^( 4) =       0.000449435376
  error estimate for blocks of size 2^( 5) =       0.000460244776
  error estimate for blocks of size 2^( 6) =       0.000468544399
  error estimate for blocks of size 2^( 7) =       0.000473506133

      target function =                  N/A
              le_mean =     -16.906677994687
             les_mean =     286.176001366392
             stat err =       0.000462932671
             autocorr =       1.259735504748
              std dev =       0.583301569061
             le_variance =       0.340240720469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906677994043        initial
     5.9605e+01     5.9605e+02             3.9177e-06       -16.906678004304  <--
     2.3842e+02     2.3842e+03             9.8055e-07       -16.906677999194
     9.5367e+02     9.5367e+03             2.4521e-07       -16.906677994687

*****************************************************************************
Applying the update for shift_i =   5.9605e+01     and shift_s =   5.9605e+02
*****************************************************************************

  Execution time = 2.9670e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.942275e-01 1 1  ON 0
 uu_1                 1.270425e-01 1 1  ON 1
 uu_2                 2.528011e-02 1 1  ON 2
 uu_3                -3.753732e-02 1 1  ON 3
 uu_4                -8.369529e-02 1 1  ON 4
 uu_5                -1.198446e-01 1 1  ON 5
 uu_6                -1.485984e-01 1 1  ON 6
 uu_7                -1.638283e-01 1 1  ON 7
 uu_8                -1.561015e-01 1 1  ON 8
 uu_9                -1.290154e-01 1 1  ON 9
 ud_0                 4.552971e-01 1 1  ON 10
 ud_1                 1.900159e-01 1 1  ON 11
 ud_2                 7.047745e-02 1 1  ON 12
 ud_3                -2.513533e-04 1 1  ON 13
 ud_4                -5.811392e-02 1 1  ON 14
 ud_5                -1.007198e-01 1 1  ON 15
 ud_6                -1.296704e-01 1 1  ON 16
 ud_7                -1.476992e-01 1 1  ON 17
 ud_8                -1.501362e-01 1 1  ON 18
 ud_9                -1.417100e-01 1 1  ON 19
 eO_0                -7.054550e-01 1 1  ON 20
 eO_1                -3.854896e-01 1 1  ON 21
 eO_2                 2.809875e-02 1 1  ON 22
 eO_3                 3.438738e-01 1 1  ON 23
 eO_4                 5.681578e-01 1 1  ON 24
 eO_5                 5.254889e-01 1 1  ON 25
 eO_6                 2.820948e-01 1 1  ON 26
 eO_7                -6.501528e-02 1 1  ON 27
 eO_8                -3.285369e-01 1 1  ON 28
 eO_9                -2.249630e-01 1 1  ON 29
eH1_0                -2.917820e-01 1 1  ON 30
eH1_1                -1.886640e-01 1 1  ON 31
eH1_2                -1.401917e-01 1 1  ON 32
eH1_3                -8.507783e-02 1 1  ON 33
eH1_4                -3.489006e-02 1 1  ON 34
eH1_5                 4.722167e-03 1 1  ON 35
eH1_6                 7.306005e-02 1 1  ON 36
eH1_7                 1.571108e-01 1 1  ON 37
eH1_8                 2.278514e-01 1 1  ON 38
eH1_9                 2.108970e-01 1 1  ON 39
eH2_0                -2.898913e-01 1 1  ON 40
eH2_1                -1.870429e-01 1 1  ON 41
eH2_2                -1.384015e-01 1 1  ON 42
eH2_3                -8.313780e-02 1 1  ON 43
eH2_4                -3.316173e-02 1 1  ON 44
eH2_5                 5.728162e-03 1 1  ON 45
eH2_6                 7.492071e-02 1 1  ON 46
eH2_7                 1.569555e-01 1 1  ON 47
eH2_8                 2.243838e-01 1 1  ON 48
eH2_9                 2.362763e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5886e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9398
    reference variance = 0.245171
====================================================
  Execution time = 2.0781e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3254e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332478226944
                                         uncertainty =       0.002730387288

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332478226944
                                         uncertainty =       0.002730387288

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407761151
  error estimate for blocks of size 2^( 2) =       0.000420761577
  error estimate for blocks of size 2^( 3) =       0.000433790372
  error estimate for blocks of size 2^( 4) =       0.000445770396
  error estimate for blocks of size 2^( 5) =       0.000455976493
  error estimate for blocks of size 2^( 6) =       0.000464041304
  error estimate for blocks of size 2^( 7) =       0.000467867928

      target function =                  N/A
              le_mean =     -16.905751831008
             les_mean =     286.136983118468
             stat err =       0.000458414030
             autocorr =       1.263874957444
              std dev =       0.576661350456
             le_variance =       0.332538313110


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690575183101e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905751831008       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905751836960       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751800237       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751815858       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905751822385       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905751828512       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905751841205       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.211642e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905751831008       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905751832509       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751823179       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751826958       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905751828698       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905751830213       residual = 5.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905751833475       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.055753e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905751831008       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905751831384       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905751829042       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905751829978       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905751830420       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905751830798       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905751831618       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.656257e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6312e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.942260e-01 1 1  ON 0
 uu_1                 1.270415e-01 1 1  ON 1
 uu_2                 2.528022e-02 1 1  ON 2
 uu_3                -3.753709e-02 1 1  ON 3
 uu_4                -8.369614e-02 1 1  ON 4
 uu_5                -1.198423e-01 1 1  ON 5
 uu_6                -1.485990e-01 1 1  ON 6
 uu_7                -1.638284e-01 1 1  ON 7
 uu_8                -1.561014e-01 1 1  ON 8
 uu_9                -1.290149e-01 1 1  ON 9
 ud_0                 4.552992e-01 1 1  ON 10
 ud_1                 1.900169e-01 1 1  ON 11
 ud_2                 7.047731e-02 1 1  ON 12
 ud_3                -2.520092e-04 1 1  ON 13
 ud_4                -5.811334e-02 1 1  ON 14
 ud_5                -1.007205e-01 1 1  ON 15
 ud_6                -1.296705e-01 1 1  ON 16
 ud_7                -1.477010e-01 1 1  ON 17
 ud_8                -1.501360e-01 1 1  ON 18
 ud_9                -1.417093e-01 1 1  ON 19
 eO_0                -7.054551e-01 1 1  ON 20
 eO_1                -3.854907e-01 1 1  ON 21
 eO_2                 2.810093e-02 1 1  ON 22
 eO_3                 3.438745e-01 1 1  ON 23
 eO_4                 5.681597e-01 1 1  ON 24
 eO_5                 5.254889e-01 1 1  ON 25
 eO_6                 2.820937e-01 1 1  ON 26
 eO_7                -6.501541e-02 1 1  ON 27
 eO_8                -3.285374e-01 1 1  ON 28
 eO_9                -2.249643e-01 1 1  ON 29
eH1_0                -2.917823e-01 1 1  ON 30
eH1_1                -1.886609e-01 1 1  ON 31
eH1_2                -1.401924e-01 1 1  ON 32
eH1_3                -8.507800e-02 1 1  ON 33
eH1_4                -3.489204e-02 1 1  ON 34
eH1_5                 4.721368e-03 1 1  ON 35
eH1_6                 7.306117e-02 1 1  ON 36
eH1_7                 1.571103e-01 1 1  ON 37
eH1_8                 2.278509e-01 1 1  ON 38
eH1_9                 2.108977e-01 1 1  ON 39
eH2_0                -2.898929e-01 1 1  ON 40
eH2_1                -1.870407e-01 1 1  ON 41
eH2_2                -1.384027e-01 1 1  ON 42
eH2_3                -8.313922e-02 1 1  ON 43
eH2_4                -3.316366e-02 1 1  ON 44
eH2_5                 5.727909e-03 1 1  ON 45
eH2_6                 7.492042e-02 1 1  ON 46
eH2_7                 1.569567e-01 1 1  ON 47
eH2_8                 2.243847e-01 1 1  ON 48
eH2_9                 2.362774e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8662
    reference variance = 0.348545
====================================================
  Execution time = 2.0429e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3587e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335923014277
                                         uncertainty =       0.002669312925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335923014277
                                         uncertainty =       0.002669312925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409799795
  error estimate for blocks of size 2^( 2) =       0.000422536681
  error estimate for blocks of size 2^( 3) =       0.000435904183
  error estimate for blocks of size 2^( 4) =       0.000448137957
  error estimate for blocks of size 2^( 5) =       0.000460218519
  error estimate for blocks of size 2^( 6) =       0.000469735956
  error estimate for blocks of size 2^( 7) =       0.000477488311

      target function =                  N/A
              le_mean =     -16.906634042305
             les_mean =     286.170146215899
             stat err =       0.000463895186
             autocorr =       1.281434045028
              std dev =       0.579544427457
             le_variance =       0.335871743396

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335928026477
                                         uncertainty =       0.002669351442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335928026477
                                         uncertainty =       0.002669351442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409802852
  error estimate for blocks of size 2^( 2) =       0.000422539598
  error estimate for blocks of size 2^( 3) =       0.000435906897
  error estimate for blocks of size 2^( 4) =       0.000448140443
  error estimate for blocks of size 2^( 5) =       0.000460220891
  error estimate for blocks of size 2^( 6) =       0.000469738299
  error estimate for blocks of size 2^( 7) =       0.000477490649

      target function =                  N/A
              le_mean =     -16.906634062184
             les_mean =     286.170151899909
             stat err =       0.000463897570
             autocorr =       1.281428097113
              std dev =       0.579548751384
             le_variance =       0.335876755231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335925530641
                                         uncertainty =       0.002669332323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335925530641
                                         uncertainty =       0.002669332323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409801330
  error estimate for blocks of size 2^( 2) =       0.000422538145
  error estimate for blocks of size 2^( 3) =       0.000435905545
  error estimate for blocks of size 2^( 4) =       0.000448139203
  error estimate for blocks of size 2^( 5) =       0.000460219708
  error estimate for blocks of size 2^( 6) =       0.000469737131
  error estimate for blocks of size 2^( 7) =       0.000477489484

      target function =                  N/A
              le_mean =     -16.906634052510
             les_mean =     286.170149077117
             stat err =       0.000463896381
             autocorr =       1.281431050482
              std dev =       0.579546598274
             le_variance =       0.335874259571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335923329066
                                         uncertainty =       0.002669315354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335923329066
                                         uncertainty =       0.002669315354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409799987
  error estimate for blocks of size 2^( 2) =       0.000422536864
  error estimate for blocks of size 2^( 3) =       0.000435904353
  error estimate for blocks of size 2^( 4) =       0.000448138113
  error estimate for blocks of size 2^( 5) =       0.000460218668
  error estimate for blocks of size 2^( 6) =       0.000469736103
  error estimate for blocks of size 2^( 7) =       0.000477488458

      target function =                  N/A
              le_mean =     -16.906634043580
             les_mean =     286.170146573768
             stat err =       0.000463895335
             autocorr =       1.281433670049
              std dev =       0.579544699020
             le_variance =       0.335872058162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906634042305        initial
     1.4901e+01     1.4901e+02             1.2116e-05       -16.906634062184  <--
     5.9605e+01     5.9605e+02             3.0558e-06       -16.906634052510
     2.3842e+02     2.3842e+03             7.6563e-07       -16.906634043580

*****************************************************************************
Applying the update for shift_i =   1.4901e+01     and shift_s =   1.4901e+02
*****************************************************************************

  Execution time = 2.9980e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.942217e-01 1 1  ON 0
 uu_1                 1.270385e-01 1 1  ON 1
 uu_2                 2.528047e-02 1 1  ON 2
 uu_3                -3.753637e-02 1 1  ON 3
 uu_4                -8.369863e-02 1 1  ON 4
 uu_5                -1.198354e-01 1 1  ON 5
 uu_6                -1.486008e-01 1 1  ON 6
 uu_7                -1.638286e-01 1 1  ON 7
 uu_8                -1.561009e-01 1 1  ON 8
 uu_9                -1.290133e-01 1 1  ON 9
 ud_0                 4.553055e-01 1 1  ON 10
 ud_1                 1.900198e-01 1 1  ON 11
 ud_2                 7.047692e-02 1 1  ON 12
 ud_3                -2.539228e-04 1 1  ON 13
 ud_4                -5.811164e-02 1 1  ON 14
 ud_5                -1.007226e-01 1 1  ON 15
 ud_6                -1.296710e-01 1 1  ON 16
 ud_7                -1.477062e-01 1 1  ON 17
 ud_8                -1.501354e-01 1 1  ON 18
 ud_9                -1.417073e-01 1 1  ON 19
 eO_0                -7.054555e-01 1 1  ON 20
 eO_1                -3.854939e-01 1 1  ON 21
 eO_2                 2.810740e-02 1 1  ON 22
 eO_3                 3.438765e-01 1 1  ON 23
 eO_4                 5.681652e-01 1 1  ON 24
 eO_5                 5.254890e-01 1 1  ON 25
 eO_6                 2.820906e-01 1 1  ON 26
 eO_7                -6.501579e-02 1 1  ON 27
 eO_8                -3.285389e-01 1 1  ON 28
 eO_9                -2.249680e-01 1 1  ON 29
eH1_0                -2.917832e-01 1 1  ON 30
eH1_1                -1.886518e-01 1 1  ON 31
eH1_2                -1.401944e-01 1 1  ON 32
eH1_3                -8.507851e-02 1 1  ON 33
eH1_4                -3.489794e-02 1 1  ON 34
eH1_5                 4.718979e-03 1 1  ON 35
eH1_6                 7.306449e-02 1 1  ON 36
eH1_7                 1.571087e-01 1 1  ON 37
eH1_8                 2.278494e-01 1 1  ON 38
eH1_9                 2.108996e-01 1 1  ON 39
eH2_0                -2.898977e-01 1 1  ON 40
eH2_1                -1.870341e-01 1 1  ON 41
eH2_2                -1.384064e-01 1 1  ON 42
eH2_3                -8.314342e-02 1 1  ON 43
eH2_4                -3.316946e-02 1 1  ON 44
eH2_5                 5.727162e-03 1 1  ON 45
eH2_6                 7.491957e-02 1 1  ON 46
eH2_7                 1.569604e-01 1 1  ON 47
eH2_8                 2.243872e-01 1 1  ON 48
eH2_9                 2.362805e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6311e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.359932
====================================================
  Execution time = 2.0544e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342471087667
                                         uncertainty =       0.005404778685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342471087667
                                         uncertainty =       0.005404778685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413750064
  error estimate for blocks of size 2^( 2) =       0.000426179711
  error estimate for blocks of size 2^( 3) =       0.000439461675
  error estimate for blocks of size 2^( 4) =       0.000451514111
  error estimate for blocks of size 2^( 5) =       0.000460110444
  error estimate for blocks of size 2^( 6) =       0.000469309305
  error estimate for blocks of size 2^( 7) =       0.000474293475

      target function =                  N/A
              le_mean =     -16.905875531711
             les_mean =     286.151005552655
             stat err =       0.000463806834
             autocorr =       1.256603137474
              std dev =       0.585130951260
             le_variance =       0.342378230123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587553171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905875531711       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905875671424       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905875654661       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905875660447       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905875666407       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905875650647       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905875672984       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905875675289       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 5.328012e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905875531711       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905875567952       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905875564087       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905875565711       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905875566653       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905875562475       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905875568235       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905875568965       residual = 1.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.356893e-05

solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905875531711       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905875540857       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905875539916       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905875540334       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905875540531       residual = 9.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905875539471       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905875540917       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905875541110       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.408386e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111353 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6012e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.942292e-01 1 1  ON 0
 uu_1                 1.270371e-01 1 1  ON 1
 uu_2                 2.527991e-02 1 1  ON 2
 uu_3                -3.753263e-02 1 1  ON 3
 uu_4                -8.370563e-02 1 1  ON 4
 uu_5                -1.198297e-01 1 1  ON 5
 uu_6                -1.485984e-01 1 1  ON 6
 uu_7                -1.638284e-01 1 1  ON 7
 uu_8                -1.561063e-01 1 1  ON 8
 uu_9                -1.290186e-01 1 1  ON 9
 ud_0                 4.553123e-01 1 1  ON 10
 ud_1                 1.900233e-01 1 1  ON 11
 ud_2                 7.048161e-02 1 1  ON 12
 ud_3                -2.547244e-04 1 1  ON 13
 ud_4                -5.811364e-02 1 1  ON 14
 ud_5                -1.007212e-01 1 1  ON 15
 ud_6                -1.296722e-01 1 1  ON 16
 ud_7                -1.477050e-01 1 1  ON 17
 ud_8                -1.501387e-01 1 1  ON 18
 ud_9                -1.417131e-01 1 1  ON 19
 eO_0                -7.054495e-01 1 1  ON 20
 eO_1                -3.854995e-01 1 1  ON 21
 eO_2                 2.811006e-02 1 1  ON 22
 eO_3                 3.438824e-01 1 1  ON 23
 eO_4                 5.681687e-01 1 1  ON 24
 eO_5                 5.254926e-01 1 1  ON 25
 eO_6                 2.820925e-01 1 1  ON 26
 eO_7                -6.501693e-02 1 1  ON 27
 eO_8                -3.285464e-01 1 1  ON 28
 eO_9                -2.249757e-01 1 1  ON 29
eH1_0                -2.917917e-01 1 1  ON 30
eH1_1                -1.886552e-01 1 1  ON 31
eH1_2                -1.401968e-01 1 1  ON 32
eH1_3                -8.507513e-02 1 1  ON 33
eH1_4                -3.489891e-02 1 1  ON 34
eH1_5                 4.720812e-03 1 1  ON 35
eH1_6                 7.306798e-02 1 1  ON 36
eH1_7                 1.571071e-01 1 1  ON 37
eH1_8                 2.278491e-01 1 1  ON 38
eH1_9                 2.109045e-01 1 1  ON 39
eH2_0                -2.899113e-01 1 1  ON 40
eH2_1                -1.870295e-01 1 1  ON 41
eH2_2                -1.384044e-01 1 1  ON 42
eH2_3                -8.314764e-02 1 1  ON 43
eH2_4                -3.316647e-02 1 1  ON 44
eH2_5                 5.729365e-03 1 1  ON 45
eH2_6                 7.492042e-02 1 1  ON 46
eH2_7                 1.569630e-01 1 1  ON 47
eH2_8                 2.243891e-01 1 1  ON 48
eH2_9                 2.362807e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8924
    reference variance = 0.234875
====================================================
  Execution time = 2.2187e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3261e-01
  Total weights = 2.0000e+06
  Execution time = 1.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332723176406
                                         uncertainty =       0.002534862225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332723176406
                                         uncertainty =       0.002534862225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407803288
  error estimate for blocks of size 2^( 2) =       0.000420953205
  error estimate for blocks of size 2^( 3) =       0.000434545611
  error estimate for blocks of size 2^( 4) =       0.000446652212
  error estimate for blocks of size 2^( 5) =       0.000457693141
  error estimate for blocks of size 2^( 6) =       0.000467571803
  error estimate for blocks of size 2^( 7) =       0.000473010169

      target function =                  N/A
              le_mean =     -16.906606400126
             les_mean =     286.165946846476
             stat err =       0.000461231831
             autocorr =       1.279196012466
              std dev =       0.576720941184
             le_variance =       0.332607044000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332729818150
                                         uncertainty =       0.002534888111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332729818150
                                         uncertainty =       0.002534888111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407807373
  error estimate for blocks of size 2^( 2) =       0.000420957106
  error estimate for blocks of size 2^( 3) =       0.000434549297
  error estimate for blocks of size 2^( 4) =       0.000446655914
  error estimate for blocks of size 2^( 5) =       0.000457697043
  error estimate for blocks of size 2^( 6) =       0.000467576053
  error estimate for blocks of size 2^( 7) =       0.000473013137

      target function =                  N/A
              le_mean =     -16.906606626316
             les_mean =     286.165961157478
             stat err =       0.000461235537
             autocorr =       1.279190942370
              std dev =       0.576726717587
             le_variance =       0.332613706779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332726661624
                                         uncertainty =       0.002534876514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332726661624
                                         uncertainty =       0.002534876514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407805432
  error estimate for blocks of size 2^( 2) =       0.000420955256
  error estimate for blocks of size 2^( 3) =       0.000434547553
  error estimate for blocks of size 2^( 4) =       0.000446654164
  error estimate for blocks of size 2^( 5) =       0.000457695204
  error estimate for blocks of size 2^( 6) =       0.000467574056
  error estimate for blocks of size 2^( 7) =       0.000473011753

      target function =                  N/A
              le_mean =     -16.906606516938
             les_mean =     286.165954293176
             stat err =       0.000461233794
             autocorr =       1.279193452426
              std dev =       0.576723972900
             le_variance =       0.332610540918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332723617040
                                         uncertainty =       0.002534864068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332723617040
                                         uncertainty =       0.002534864068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407803559
  error estimate for blocks of size 2^( 2) =       0.000420953465
  error estimate for blocks of size 2^( 3) =       0.000434545857
  error estimate for blocks of size 2^( 4) =       0.000446652459
  error estimate for blocks of size 2^( 5) =       0.000457693402
  error estimate for blocks of size 2^( 6) =       0.000467572089
  error estimate for blocks of size 2^( 7) =       0.000473010370

      target function =                  N/A
              le_mean =     -16.906606414703
             les_mean =     286.165947781494
             stat err =       0.000461232080
             autocorr =       1.279195691574
              std dev =       0.576721324504
             le_variance =       0.332607486137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906606400126        initial
     3.7253e+00     3.7253e+01             5.3280e-05       -16.906606626316  <--
     1.4901e+01     1.4901e+02             1.3569e-05       -16.906606516938
     5.9605e+01     5.9605e+02             3.4084e-06       -16.906606414703

*****************************************************************************
Applying the update for shift_i =   3.7253e+00     and shift_s =   3.7253e+01
*****************************************************************************

  Execution time = 3.1637e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.942500e-01 1 1  ON 0
 uu_1                 1.270334e-01 1 1  ON 1
 uu_2                 2.527921e-02 1 1  ON 2
 uu_3                -3.752307e-02 1 1  ON 3
 uu_4                -8.372385e-02 1 1  ON 4
 uu_5                -1.198143e-01 1 1  ON 5
 uu_6                -1.485907e-01 1 1  ON 6
 uu_7                -1.638273e-01 1 1  ON 7
 uu_8                -1.561223e-01 1 1  ON 8
 uu_9                -1.290344e-01 1 1  ON 9
 ud_0                 4.553317e-01 1 1  ON 10
 ud_1                 1.900338e-01 1 1  ON 11
 ud_2                 7.049486e-02 1 1  ON 12
 ud_3                -2.564478e-04 1 1  ON 13
 ud_4                -5.811920e-02 1 1  ON 14
 ud_5                -1.007176e-01 1 1  ON 15
 ud_6                -1.296755e-01 1 1  ON 16
 ud_7                -1.477013e-01 1 1  ON 17
 ud_8                -1.501484e-01 1 1  ON 18
 ud_9                -1.417304e-01 1 1  ON 19
 eO_0                -7.054334e-01 1 1  ON 20
 eO_1                -3.855143e-01 1 1  ON 21
 eO_2                 2.811805e-02 1 1  ON 22
 eO_3                 3.438998e-01 1 1  ON 23
 eO_4                 5.681790e-01 1 1  ON 24
 eO_5                 5.255034e-01 1 1  ON 25
 eO_6                 2.820983e-01 1 1  ON 26
 eO_7                -6.502028e-02 1 1  ON 27
 eO_8                -3.285686e-01 1 1  ON 28
 eO_9                -2.249984e-01 1 1  ON 29
eH1_0                -2.918167e-01 1 1  ON 30
eH1_1                -1.886649e-01 1 1  ON 31
eH1_2                -1.402040e-01 1 1  ON 32
eH1_3                -8.506535e-02 1 1  ON 33
eH1_4                -3.490165e-02 1 1  ON 34
eH1_5                 4.726271e-03 1 1  ON 35
eH1_6                 7.307832e-02 1 1  ON 36
eH1_7                 1.571025e-01 1 1  ON 37
eH1_8                 2.278481e-01 1 1  ON 38
eH1_9                 2.109190e-01 1 1  ON 39
eH2_0                -2.899510e-01 1 1  ON 40
eH2_1                -1.870164e-01 1 1  ON 41
eH2_2                -1.383992e-01 1 1  ON 42
eH2_3                -8.315909e-02 1 1  ON 43
eH2_4                -3.315826e-02 1 1  ON 44
eH2_5                 5.736118e-03 1 1  ON 45
eH2_6                 7.492306e-02 1 1  ON 46
eH2_7                 1.569708e-01 1 1  ON 47
eH2_8                 2.243947e-01 1 1  ON 48
eH2_9                 2.362810e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7655e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9087
    reference variance = 0.232862
====================================================
  Execution time = 2.0597e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3835e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6045e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338401035969
                                         uncertainty =       0.004406348489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338401035969
                                         uncertainty =       0.004406348489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411310149
  error estimate for blocks of size 2^( 2) =       0.000423435951
  error estimate for blocks of size 2^( 3) =       0.000436605751
  error estimate for blocks of size 2^( 4) =       0.000448349652
  error estimate for blocks of size 2^( 5) =       0.000458191473
  error estimate for blocks of size 2^( 6) =       0.000465839352
  error estimate for blocks of size 2^( 7) =       0.000469619636

      target function =                  N/A
              le_mean =     -16.906523404708
             les_mean =     286.168885541624
             stat err =       0.000460500028
             autocorr =       1.253488839387
              std dev =       0.581680390643
             le_variance =       0.338352076859


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652340471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906523404708       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906523389223       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906523220313       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906523495551       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906523688952       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906523664070       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906523565472       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906523648246       residual = 9.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 2.096248e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906523404708       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906523400176       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906523344663       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906523411730       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906523477421       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906523461488       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906523470763       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906523456611       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 5.554187e-05

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906523404708       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906523403525       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906523388557       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906523405092       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906523422013       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906523418069       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906523421784       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906523417885       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 1.413292e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114060 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6208e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.942709e-01 1 1  ON 0
 uu_1                 1.270371e-01 1 1  ON 1
 uu_2                 2.527039e-02 1 1  ON 2
 uu_3                -3.750749e-02 1 1  ON 3
 uu_4                -8.372023e-02 1 1  ON 4
 uu_5                -1.197969e-01 1 1  ON 5
 uu_6                -1.485842e-01 1 1  ON 6
 uu_7                -1.638063e-01 1 1  ON 7
 uu_8                -1.561461e-01 1 1  ON 8
 uu_9                -1.290850e-01 1 1  ON 9
 ud_0                 4.553811e-01 1 1  ON 10
 ud_1                 1.900533e-01 1 1  ON 11
 ud_2                 7.051024e-02 1 1  ON 12
 ud_3                -2.747572e-04 1 1  ON 13
 ud_4                -5.811947e-02 1 1  ON 14
 ud_5                -1.007083e-01 1 1  ON 15
 ud_6                -1.296617e-01 1 1  ON 16
 ud_7                -1.477240e-01 1 1  ON 17
 ud_8                -1.501671e-01 1 1  ON 18
 ud_9                -1.417586e-01 1 1  ON 19
 eO_0                -7.054395e-01 1 1  ON 20
 eO_1                -3.855159e-01 1 1  ON 21
 eO_2                 2.814317e-02 1 1  ON 22
 eO_3                 3.439097e-01 1 1  ON 23
 eO_4                 5.682124e-01 1 1  ON 24
 eO_5                 5.255182e-01 1 1  ON 25
 eO_6                 2.820973e-01 1 1  ON 26
 eO_7                -6.502267e-02 1 1  ON 27
 eO_8                -3.285947e-01 1 1  ON 28
 eO_9                -2.250371e-01 1 1  ON 29
eH1_0                -2.918723e-01 1 1  ON 30
eH1_1                -1.886535e-01 1 1  ON 31
eH1_2                -1.401977e-01 1 1  ON 32
eH1_3                -8.506614e-02 1 1  ON 33
eH1_4                -3.490954e-02 1 1  ON 34
eH1_5                 4.715415e-03 1 1  ON 35
eH1_6                 7.308231e-02 1 1  ON 36
eH1_7                 1.571075e-01 1 1  ON 37
eH1_8                 2.278662e-01 1 1  ON 38
eH1_9                 2.109414e-01 1 1  ON 39
eH2_0                -2.899900e-01 1 1  ON 40
eH2_1                -1.870223e-01 1 1  ON 41
eH2_2                -1.384079e-01 1 1  ON 42
eH2_3                -8.316597e-02 1 1  ON 43
eH2_4                -3.315473e-02 1 1  ON 44
eH2_5                 5.749400e-03 1 1  ON 45
eH2_6                 7.495553e-02 1 1  ON 46
eH2_7                 1.569887e-01 1 1  ON 47
eH2_8                 2.243897e-01 1 1  ON 48
eH2_9                 2.362764e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8692
    reference variance = 0.265938
====================================================
  Execution time = 2.0168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4982e-01
  Total weights = 2.0000e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349800236131
                                         uncertainty =       0.011512583708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349800236131
                                         uncertainty =       0.011512583708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418200488
  error estimate for blocks of size 2^( 2) =       0.000430837974
  error estimate for blocks of size 2^( 3) =       0.000444738542
  error estimate for blocks of size 2^( 4) =       0.000457813165
  error estimate for blocks of size 2^( 5) =       0.000468504695
  error estimate for blocks of size 2^( 6) =       0.000477484685
  error estimate for blocks of size 2^( 7) =       0.000482151056

      target function =                  N/A
              le_mean =     -16.906462376366
             les_mean =     286.178253204311
             stat err =       0.000471488400
             autocorr =       1.271080204713
              std dev =       0.591424801407
             le_variance =       0.349783295720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349905183714
                                         uncertainty =       0.011512667362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349905183714
                                         uncertainty =       0.011512667362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418263191
  error estimate for blocks of size 2^( 2) =       0.000430897535
  error estimate for blocks of size 2^( 3) =       0.000444794552
  error estimate for blocks of size 2^( 4) =       0.000457868080
  error estimate for blocks of size 2^( 5) =       0.000468558370
  error estimate for blocks of size 2^( 6) =       0.000477535149
  error estimate for blocks of size 2^( 7) =       0.000482197446

      target function =                  N/A
              le_mean =     -16.906463130851
             les_mean =     286.178383614488
             stat err =       0.000471539761
             autocorr =       1.270975986640
              std dev =       0.591513477945
             le_variance =       0.349888194591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349865194241
                                         uncertainty =       0.011512310115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349865194241
                                         uncertainty =       0.011512310115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418239298
  error estimate for blocks of size 2^( 2) =       0.000430874867
  error estimate for blocks of size 2^( 3) =       0.000444773339
  error estimate for blocks of size 2^( 4) =       0.000457847294
  error estimate for blocks of size 2^( 5) =       0.000468538079
  error estimate for blocks of size 2^( 6) =       0.000477516287
  error estimate for blocks of size 2^( 7) =       0.000482179774

      target function =                  N/A
              le_mean =     -16.906462906129
             les_mean =     286.178336042756
             stat err =       0.000471520359
             autocorr =       1.271016600584
              std dev =       0.591479688032
             le_variance =       0.349848221354

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349808770097
                                         uncertainty =       0.011512534362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349808770097
                                         uncertainty =       0.011512534362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418205587
  error estimate for blocks of size 2^( 2) =       0.000430842821
  error estimate for blocks of size 2^( 3) =       0.000444743115
  error estimate for blocks of size 2^( 4) =       0.000457817651
  error estimate for blocks of size 2^( 5) =       0.000468509083
  error estimate for blocks of size 2^( 6) =       0.000477488846
  error estimate for blocks of size 2^( 7) =       0.000482154822

      target function =                  N/A
              le_mean =     -16.906462447096
             les_mean =     286.178264125411
             stat err =       0.000471492601
             autocorr =       1.271071857214
              std dev =       0.591432012366
             le_variance =       0.349791825251


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906462376366        initial
     9.3132e-01     9.3132e+00             2.0962e-04       -16.906463130851  <--
     3.7253e+00     3.7253e+01             5.5542e-05       -16.906462906129
     1.4901e+01     1.4901e+02             1.4133e-05       -16.906462447096

*****************************************************************************
Applying the update for shift_i =   9.3132e-01     and shift_s =   9.3132e+00
*****************************************************************************

  Execution time = 2.9714e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.943218e-01 1 1  ON 0
 uu_1                 1.270456e-01 1 1  ON 1
 uu_2                 2.526128e-02 1 1  ON 2
 uu_3                -3.747523e-02 1 1  ON 3
 uu_4                -8.370279e-02 1 1  ON 4
 uu_5                -1.197518e-01 1 1  ON 5
 uu_6                -1.485602e-01 1 1  ON 6
 uu_7                -1.637443e-01 1 1  ON 7
 uu_8                -1.562127e-01 1 1  ON 8
 uu_9                -1.292324e-01 1 1  ON 9
 ud_0                 4.555023e-01 1 1  ON 10
 ud_1                 1.901083e-01 1 1  ON 11
 ud_2                 7.055195e-02 1 1  ON 12
 ud_3                -3.092961e-04 1 1  ON 13
 ud_4                -5.812187e-02 1 1  ON 14
 ud_5                -1.006832e-01 1 1  ON 15
 ud_6                -1.296216e-01 1 1  ON 16
 ud_7                -1.477790e-01 1 1  ON 17
 ud_8                -1.502185e-01 1 1  ON 18
 ud_9                -1.418413e-01 1 1  ON 19
 eO_0                -7.054595e-01 1 1  ON 20
 eO_1                -3.855147e-01 1 1  ON 21
 eO_2                 2.820898e-02 1 1  ON 22
 eO_3                 3.439377e-01 1 1  ON 23
 eO_4                 5.683085e-01 1 1  ON 24
 eO_5                 5.255651e-01 1 1  ON 25
 eO_6                 2.820971e-01 1 1  ON 26
 eO_7                -6.502874e-02 1 1  ON 27
 eO_8                -3.286713e-01 1 1  ON 28
 eO_9                -2.251511e-01 1 1  ON 29
eH1_0                -2.920263e-01 1 1  ON 30
eH1_1                -1.886273e-01 1 1  ON 31
eH1_2                -1.401844e-01 1 1  ON 32
eH1_3                -8.506598e-02 1 1  ON 33
eH1_4                -3.493481e-02 1 1  ON 34
eH1_5                 4.684651e-03 1 1  ON 35
eH1_6                 7.309441e-02 1 1  ON 36
eH1_7                 1.571230e-01 1 1  ON 37
eH1_8                 2.279197e-01 1 1  ON 38
eH1_9                 2.110072e-01 1 1  ON 39
eH2_0                -2.901018e-01 1 1  ON 40
eH2_1                -1.870422e-01 1 1  ON 41
eH2_2                -1.384384e-01 1 1  ON 42
eH2_3                -8.318348e-02 1 1  ON 43
eH2_4                -3.314627e-02 1 1  ON 44
eH2_5                 5.789849e-03 1 1  ON 45
eH2_6                 7.505118e-02 1 1  ON 46
eH2_7                 1.570424e-01 1 1  ON 47
eH2_8                 2.243755e-01 1 1  ON 48
eH2_9                 2.362629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5928e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 0.220533
====================================================
  Execution time = 2.0883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3973e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627824480
                                         uncertainty =       0.006387147620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339627824480
                                         uncertainty =       0.006387147620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412149896
  error estimate for blocks of size 2^( 2) =       0.000424533807
  error estimate for blocks of size 2^( 3) =       0.000437425818
  error estimate for blocks of size 2^( 4) =       0.000449795361
  error estimate for blocks of size 2^( 5) =       0.000460271960
  error estimate for blocks of size 2^( 6) =       0.000465218674
  error estimate for blocks of size 2^( 7) =       0.000469648649

      target function =                  N/A
              le_mean =     -16.905973658320
             les_mean =     286.151680239535
             stat err =       0.000461233661
             autocorr =       1.252366956035
              std dev =       0.582867972690
             le_variance =       0.339735073587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690597365832e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-01, overlap shift 2.3283e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905973658320       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905974289492       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905975029529       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905974666689       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905973839908       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905974638402       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975355567       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905975116510       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905975194101       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905975202333       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e-01 is 6.063061e-04

solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905973658320       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905973890480       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905974214999       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905974094502       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905973898259       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905973848832       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905974126731       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905974058311       residual = 4.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 1.699243e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905973658320       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905973724112       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905973827431       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905973795811       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905973740223       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905973720159       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905973778203       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 4.994372e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116904 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6466e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.943081e-01 1 1  ON 0
 uu_1                 1.270266e-01 1 1  ON 1
 uu_2                 2.531863e-02 1 1  ON 2
 uu_3                -3.749191e-02 1 1  ON 3
 uu_4                -8.376301e-02 1 1  ON 4
 uu_5                -1.196960e-01 1 1  ON 5
 uu_6                -1.484793e-01 1 1  ON 6
 uu_7                -1.637328e-01 1 1  ON 7
 uu_8                -1.562820e-01 1 1  ON 8
 uu_9                -1.293471e-01 1 1  ON 9
 ud_0                 4.555729e-01 1 1  ON 10
 ud_1                 1.901381e-01 1 1  ON 11
 ud_2                 7.063821e-02 1 1  ON 12
 ud_3                -2.836838e-04 1 1  ON 13
 ud_4                -5.812287e-02 1 1  ON 14
 ud_5                -1.006831e-01 1 1  ON 15
 ud_6                -1.296837e-01 1 1  ON 16
 ud_7                -1.477707e-01 1 1  ON 17
 ud_8                -1.502033e-01 1 1  ON 18
 ud_9                -1.419123e-01 1 1  ON 19
 eO_0                -7.052896e-01 1 1  ON 20
 eO_1                -3.855664e-01 1 1  ON 21
 eO_2                 2.824291e-02 1 1  ON 22
 eO_3                 3.439588e-01 1 1  ON 23
 eO_4                 5.683818e-01 1 1  ON 24
 eO_5                 5.256074e-01 1 1  ON 25
 eO_6                 2.820920e-01 1 1  ON 26
 eO_7                -6.504177e-02 1 1  ON 27
 eO_8                -3.287745e-01 1 1  ON 28
 eO_9                -2.252885e-01 1 1  ON 29
eH1_0                -2.921320e-01 1 1  ON 30
eH1_1                -1.886474e-01 1 1  ON 31
eH1_2                -1.402196e-01 1 1  ON 32
eH1_3                -8.502828e-02 1 1  ON 33
eH1_4                -3.493217e-02 1 1  ON 34
eH1_5                 4.738246e-03 1 1  ON 35
eH1_6                 7.319632e-02 1 1  ON 36
eH1_7                 1.570786e-01 1 1  ON 37
eH1_8                 2.278780e-01 1 1  ON 38
eH1_9                 2.110477e-01 1 1  ON 39
eH2_0                -2.902695e-01 1 1  ON 40
eH2_1                -1.871292e-01 1 1  ON 41
eH2_2                -1.384874e-01 1 1  ON 42
eH2_3                -8.317925e-02 1 1  ON 43
eH2_4                -3.309322e-02 1 1  ON 44
eH2_5                 5.757570e-03 1 1  ON 45
eH2_6                 7.502850e-02 1 1  ON 46
eH2_7                 1.571036e-01 1 1  ON 47
eH2_8                 2.244797e-01 1 1  ON 48
eH2_9                 2.363224e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9581
    reference variance = 0.39279
====================================================
  Execution time = 2.0435e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3534e-01
  Total weights = 2.0000e+06
  Execution time = 1.8863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335369550249
                                         uncertainty =       0.003210798980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335369550249
                                         uncertainty =       0.003210798980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409501001
  error estimate for blocks of size 2^( 2) =       0.000422632951
  error estimate for blocks of size 2^( 3) =       0.000435622258
  error estimate for blocks of size 2^( 4) =       0.000447748984
  error estimate for blocks of size 2^( 5) =       0.000457394089
  error estimate for blocks of size 2^( 6) =       0.000465420092
  error estimate for blocks of size 2^( 7) =       0.000472954362

      target function =                  N/A
              le_mean =     -16.906418441278
             les_mean =     286.162366483886
             stat err =       0.000460879382
             autocorr =       1.266673321926
              std dev =       0.579121869728
             le_variance =       0.335382139997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335281287124
                                         uncertainty =       0.003210065585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335281287124
                                         uncertainty =       0.003210065585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409447149
  error estimate for blocks of size 2^( 2) =       0.000422580777
  error estimate for blocks of size 2^( 3) =       0.000435570609
  error estimate for blocks of size 2^( 4) =       0.000447701405
  error estimate for blocks of size 2^( 5) =       0.000457349722
  error estimate for blocks of size 2^( 6) =       0.000465384690
  error estimate for blocks of size 2^( 7) =       0.000472919749

      target function =                  N/A
              le_mean =     -16.906416689401
             les_mean =     286.162219043603
             stat err =       0.000460838892
             autocorr =       1.266783925439
              std dev =       0.579045711132
             le_variance =       0.335293935580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335294180127
                                         uncertainty =       0.003210299797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335294180127
                                         uncertainty =       0.003210299797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409455019
  error estimate for blocks of size 2^( 2) =       0.000422589233
  error estimate for blocks of size 2^( 3) =       0.000435579843
  error estimate for blocks of size 2^( 4) =       0.000447710353
  error estimate for blocks of size 2^( 5) =       0.000457356992
  error estimate for blocks of size 2^( 6) =       0.000465390513
  error estimate for blocks of size 2^( 7) =       0.000472925539

      target function =                  N/A
              le_mean =     -16.906416899929
             les_mean =     286.162239052392
             stat err =       0.000460845849
             autocorr =       1.266773476364
              std dev =       0.579056841629
             le_variance =       0.335306825838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335359393529
                                         uncertainty =       0.003210764311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335359393529
                                         uncertainty =       0.003210764311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409494806
  error estimate for blocks of size 2^( 2) =       0.000422627088
  error estimate for blocks of size 2^( 3) =       0.000435616590
  error estimate for blocks of size 2^( 4) =       0.000447743904
  error estimate for blocks of size 2^( 5) =       0.000457389143
  error estimate for blocks of size 2^( 6) =       0.000465416334
  error estimate for blocks of size 2^( 7) =       0.000472950688

      target function =                  N/A
              le_mean =     -16.906418151386
             les_mean =     286.162346533919
             stat err =       0.000460875018
             autocorr =       1.266687659785
              std dev =       0.579113108212
             le_variance =       0.335371992103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906418441278        initial  <--
     2.3283e-01     2.3283e+00             6.0631e-04       -16.906416689401
     9.3132e-01     9.3132e+00             1.6992e-04       -16.906416899929
     3.7253e+00     3.7253e+01             4.9944e-05       -16.906418151386

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9080
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.943218e-01 1 1  ON 0
 uu_1                 1.270456e-01 1 1  ON 1
 uu_2                 2.526128e-02 1 1  ON 2
 uu_3                -3.747523e-02 1 1  ON 3
 uu_4                -8.370279e-02 1 1  ON 4
 uu_5                -1.197518e-01 1 1  ON 5
 uu_6                -1.485602e-01 1 1  ON 6
 uu_7                -1.637443e-01 1 1  ON 7
 uu_8                -1.562127e-01 1 1  ON 8
 uu_9                -1.292324e-01 1 1  ON 9
 ud_0                 4.555023e-01 1 1  ON 10
 ud_1                 1.901083e-01 1 1  ON 11
 ud_2                 7.055195e-02 1 1  ON 12
 ud_3                -3.092961e-04 1 1  ON 13
 ud_4                -5.812187e-02 1 1  ON 14
 ud_5                -1.006832e-01 1 1  ON 15
 ud_6                -1.296216e-01 1 1  ON 16
 ud_7                -1.477790e-01 1 1  ON 17
 ud_8                -1.502185e-01 1 1  ON 18
 ud_9                -1.418413e-01 1 1  ON 19
 eO_0                -7.054595e-01 1 1  ON 20
 eO_1                -3.855147e-01 1 1  ON 21
 eO_2                 2.820898e-02 1 1  ON 22
 eO_3                 3.439377e-01 1 1  ON 23
 eO_4                 5.683085e-01 1 1  ON 24
 eO_5                 5.255651e-01 1 1  ON 25
 eO_6                 2.820971e-01 1 1  ON 26
 eO_7                -6.502874e-02 1 1  ON 27
 eO_8                -3.286713e-01 1 1  ON 28
 eO_9                -2.251511e-01 1 1  ON 29
eH1_0                -2.920263e-01 1 1  ON 30
eH1_1                -1.886273e-01 1 1  ON 31
eH1_2                -1.401844e-01 1 1  ON 32
eH1_3                -8.506598e-02 1 1  ON 33
eH1_4                -3.493481e-02 1 1  ON 34
eH1_5                 4.684651e-03 1 1  ON 35
eH1_6                 7.309441e-02 1 1  ON 36
eH1_7                 1.571230e-01 1 1  ON 37
eH1_8                 2.279197e-01 1 1  ON 38
eH1_9                 2.110072e-01 1 1  ON 39
eH2_0                -2.901018e-01 1 1  ON 40
eH2_1                -1.870422e-01 1 1  ON 41
eH2_2                -1.384384e-01 1 1  ON 42
eH2_3                -8.318348e-02 1 1  ON 43
eH2_4                -3.314627e-02 1 1  ON 44
eH2_5                 5.789849e-03 1 1  ON 45
eH2_6                 7.505118e-02 1 1  ON 46
eH2_7                 1.570424e-01 1 1  ON 47
eH2_8                 2.243755e-01 1 1  ON 48
eH2_9                 2.362629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.211588
====================================================
  Execution time = 2.0656e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4182e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341776262502
                                         uncertainty =       0.004066738936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341776262502
                                         uncertainty =       0.004066738936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413412100
  error estimate for blocks of size 2^( 2) =       0.000425426629
  error estimate for blocks of size 2^( 3) =       0.000438681035
  error estimate for blocks of size 2^( 4) =       0.000450761841
  error estimate for blocks of size 2^( 5) =       0.000462545966
  error estimate for blocks of size 2^( 6) =       0.000472683135
  error estimate for blocks of size 2^( 7) =       0.000477195745

      target function =                  N/A
              le_mean =     -16.906108692792
             les_mean =     286.158330091039
             stat err =       0.000465796672
             autocorr =       1.269481550875
              std dev =       0.584652999187
             le_variance =       0.341819129459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690610869279e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906108692792       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906108732362       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906108720815       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906108698351       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906108795453       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906108872866       residual = 4.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906108936792       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906108914941       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 8.963828e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906108692792       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906108703248       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906108699616       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906108689455       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906108711761       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906108728836       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906108745910       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.219947e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906108692792       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906108695443       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906108694482       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906108691667       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906108697055       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906108701095       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906108705382       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.587753e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.119235 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6166e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.943228e-01 1 1  ON 0
 uu_1                 1.270490e-01 1 1  ON 1
 uu_2                 2.526274e-02 1 1  ON 2
 uu_3                -3.748709e-02 1 1  ON 3
 uu_4                -8.370045e-02 1 1  ON 4
 uu_5                -1.197530e-01 1 1  ON 5
 uu_6                -1.485559e-01 1 1  ON 6
 uu_7                -1.637532e-01 1 1  ON 7
 uu_8                -1.562169e-01 1 1  ON 8
 uu_9                -1.292316e-01 1 1  ON 9
 ud_0                 4.554925e-01 1 1  ON 10
 ud_1                 1.901095e-01 1 1  ON 11
 ud_2                 7.054783e-02 1 1  ON 12
 ud_3                -3.102366e-04 1 1  ON 13
 ud_4                -5.812908e-02 1 1  ON 14
 ud_5                -1.006882e-01 1 1  ON 15
 ud_6                -1.296256e-01 1 1  ON 16
 ud_7                -1.477803e-01 1 1  ON 17
 ud_8                -1.501991e-01 1 1  ON 18
 ud_9                -1.418237e-01 1 1  ON 19
 eO_0                -7.054579e-01 1 1  ON 20
 eO_1                -3.855176e-01 1 1  ON 21
 eO_2                 2.822333e-02 1 1  ON 22
 eO_3                 3.439306e-01 1 1  ON 23
 eO_4                 5.683142e-01 1 1  ON 24
 eO_5                 5.255703e-01 1 1  ON 25
 eO_6                 2.820924e-01 1 1  ON 26
 eO_7                -6.503204e-02 1 1  ON 27
 eO_8                -3.286700e-01 1 1  ON 28
 eO_9                -2.251584e-01 1 1  ON 29
eH1_0                -2.920485e-01 1 1  ON 30
eH1_1                -1.886283e-01 1 1  ON 31
eH1_2                -1.401870e-01 1 1  ON 32
eH1_3                -8.505956e-02 1 1  ON 33
eH1_4                -3.492793e-02 1 1  ON 34
eH1_5                 4.675138e-03 1 1  ON 35
eH1_6                 7.309673e-02 1 1  ON 36
eH1_7                 1.571286e-01 1 1  ON 37
eH1_8                 2.279206e-01 1 1  ON 38
eH1_9                 2.110152e-01 1 1  ON 39
eH2_0                -2.901196e-01 1 1  ON 40
eH2_1                -1.870494e-01 1 1  ON 41
eH2_2                -1.384353e-01 1 1  ON 42
eH2_3                -8.318579e-02 1 1  ON 43
eH2_4                -3.313612e-02 1 1  ON 44
eH2_5                 5.785032e-03 1 1  ON 45
eH2_6                 7.505036e-02 1 1  ON 46
eH2_7                 1.570449e-01 1 1  ON 47
eH2_8                 2.243764e-01 1 1  ON 48
eH2_9                 2.362708e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9825
    reference variance = 0.168998
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3441e-01
  Total weights = 2.0000e+06
  Execution time = 1.8967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334430055542
                                         uncertainty =       0.003865597129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334430055542
                                         uncertainty =       0.003865597129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408911114
  error estimate for blocks of size 2^( 2) =       0.000421838695
  error estimate for blocks of size 2^( 3) =       0.000434649754
  error estimate for blocks of size 2^( 4) =       0.000447033147
  error estimate for blocks of size 2^( 5) =       0.000457547717
  error estimate for blocks of size 2^( 6) =       0.000464996177
  error estimate for blocks of size 2^( 7) =       0.000468019969

      target function =                  N/A
              le_mean =     -16.906617607111
             les_mean =     286.168135344108
             stat err =       0.000459399252
             autocorr =       1.262184199133
              std dev =       0.578287643173
             le_variance =       0.334416598247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334409306416
                                         uncertainty =       0.003865508195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334409306416
                                         uncertainty =       0.003865508195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408898429
  error estimate for blocks of size 2^( 2) =       0.000421826482
  error estimate for blocks of size 2^( 3) =       0.000434637680
  error estimate for blocks of size 2^( 4) =       0.000447021724
  error estimate for blocks of size 2^( 5) =       0.000457536754
  error estimate for blocks of size 2^( 6) =       0.000464985339
  error estimate for blocks of size 2^( 7) =       0.000468010679

      target function =                  N/A
              le_mean =     -16.906617251465
             les_mean =     286.168102571603
             stat err =       0.000459388624
             autocorr =       1.262204103106
              std dev =       0.578269704605
             le_variance =       0.334395851264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334417643915
                                         uncertainty =       0.003865539643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334417643915
                                         uncertainty =       0.003865539643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408903526
  error estimate for blocks of size 2^( 2) =       0.000421831377
  error estimate for blocks of size 2^( 3) =       0.000434642528
  error estimate for blocks of size 2^( 4) =       0.000447026300
  error estimate for blocks of size 2^( 5) =       0.000457541135
  error estimate for blocks of size 2^( 6) =       0.000464989669
  error estimate for blocks of size 2^( 7) =       0.000468014290

      target function =                  N/A
              le_mean =     -16.906617409666
             les_mean =     286.168116256212
             stat err =       0.000459392849
             autocorr =       1.262195856335
              std dev =       0.578276911674
             le_variance =       0.334404186576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334428439331
                                         uncertainty =       0.003865589064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334428439331
                                         uncertainty =       0.003865589064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408910126
  error estimate for blocks of size 2^( 2) =       0.000421837741
  error estimate for blocks of size 2^( 3) =       0.000434648812
  error estimate for blocks of size 2^( 4) =       0.000447032254
  error estimate for blocks of size 2^( 5) =       0.000457546858
  error estimate for blocks of size 2^( 6) =       0.000464995328
  error estimate for blocks of size 2^( 7) =       0.000468019225

      target function =                  N/A
              le_mean =     -16.906617580640
             les_mean =     286.168132832843
             stat err =       0.000459398416
             autocorr =       1.262185704039
              std dev =       0.578286245758
             le_variance =       0.334414982033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906617607111        initial  <--
     2.3283e+00     2.3283e+01             8.9638e-05       -16.906617251465
     9.3132e+00     9.3132e+01             2.2199e-05       -16.906617409666
     3.7253e+01     3.7253e+02             5.5878e-06       -16.906617580640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7802
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.943218e-01 1 1  ON 0
 uu_1                 1.270456e-01 1 1  ON 1
 uu_2                 2.526128e-02 1 1  ON 2
 uu_3                -3.747523e-02 1 1  ON 3
 uu_4                -8.370279e-02 1 1  ON 4
 uu_5                -1.197518e-01 1 1  ON 5
 uu_6                -1.485602e-01 1 1  ON 6
 uu_7                -1.637443e-01 1 1  ON 7
 uu_8                -1.562127e-01 1 1  ON 8
 uu_9                -1.292324e-01 1 1  ON 9
 ud_0                 4.555023e-01 1 1  ON 10
 ud_1                 1.901083e-01 1 1  ON 11
 ud_2                 7.055195e-02 1 1  ON 12
 ud_3                -3.092961e-04 1 1  ON 13
 ud_4                -5.812187e-02 1 1  ON 14
 ud_5                -1.006832e-01 1 1  ON 15
 ud_6                -1.296216e-01 1 1  ON 16
 ud_7                -1.477790e-01 1 1  ON 17
 ud_8                -1.502185e-01 1 1  ON 18
 ud_9                -1.418413e-01 1 1  ON 19
 eO_0                -7.054595e-01 1 1  ON 20
 eO_1                -3.855147e-01 1 1  ON 21
 eO_2                 2.820898e-02 1 1  ON 22
 eO_3                 3.439377e-01 1 1  ON 23
 eO_4                 5.683085e-01 1 1  ON 24
 eO_5                 5.255651e-01 1 1  ON 25
 eO_6                 2.820971e-01 1 1  ON 26
 eO_7                -6.502874e-02 1 1  ON 27
 eO_8                -3.286713e-01 1 1  ON 28
 eO_9                -2.251511e-01 1 1  ON 29
eH1_0                -2.920263e-01 1 1  ON 30
eH1_1                -1.886273e-01 1 1  ON 31
eH1_2                -1.401844e-01 1 1  ON 32
eH1_3                -8.506598e-02 1 1  ON 33
eH1_4                -3.493481e-02 1 1  ON 34
eH1_5                 4.684651e-03 1 1  ON 35
eH1_6                 7.309441e-02 1 1  ON 36
eH1_7                 1.571230e-01 1 1  ON 37
eH1_8                 2.279197e-01 1 1  ON 38
eH1_9                 2.110072e-01 1 1  ON 39
eH2_0                -2.901018e-01 1 1  ON 40
eH2_1                -1.870422e-01 1 1  ON 41
eH2_2                -1.384384e-01 1 1  ON 42
eH2_3                -8.318348e-02 1 1  ON 43
eH2_4                -3.314627e-02 1 1  ON 44
eH2_5                 5.789849e-03 1 1  ON 45
eH2_6                 7.505118e-02 1 1  ON 46
eH2_7                 1.570424e-01 1 1  ON 47
eH2_8                 2.243755e-01 1 1  ON 48
eH2_9                 2.362629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8924
    reference variance = 0.257304
====================================================
  Execution time = 2.0958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4200e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342026887440
                                         uncertainty =       0.006171273846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342026887440
                                         uncertainty =       0.006171273846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413520908
  error estimate for blocks of size 2^( 2) =       0.000426298937
  error estimate for blocks of size 2^( 3) =       0.000438854806
  error estimate for blocks of size 2^( 4) =       0.000450893597
  error estimate for blocks of size 2^( 5) =       0.000461473863
  error estimate for blocks of size 2^( 6) =       0.000468339635
  error estimate for blocks of size 2^( 7) =       0.000471604784

      target function =                  N/A
              le_mean =     -16.906529902091
             les_mean =     286.172752242258
             stat err =       0.000463077970
             autocorr =       1.254045505467
              std dev =       0.584806876623
             le_variance =       0.341999082945


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652990209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906529902091       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906529903014       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529911418       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529920155       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529931601       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529932823       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529931218       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906529933269       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 8.773976e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906529902091       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906529902323       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529904439       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529906632       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529909517       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529909835       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529909460       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906529909958       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 2.197698e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906529902091       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906529902149       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529902679       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529903228       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529903951       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529904031       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529903939       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906529904063       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 5.496876e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121811 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6551e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.943214e-01 1 1  ON 0
 uu_1                 1.270462e-01 1 1  ON 1
 uu_2                 2.526184e-02 1 1  ON 2
 uu_3                -3.747549e-02 1 1  ON 3
 uu_4                -8.370185e-02 1 1  ON 4
 uu_5                -1.197520e-01 1 1  ON 5
 uu_6                -1.485602e-01 1 1  ON 6
 uu_7                -1.637445e-01 1 1  ON 7
 uu_8                -1.562135e-01 1 1  ON 8
 uu_9                -1.292331e-01 1 1  ON 9
 ud_0                 4.555031e-01 1 1  ON 10
 ud_1                 1.901094e-01 1 1  ON 11
 ud_2                 7.055267e-02 1 1  ON 12
 ud_3                -3.092821e-04 1 1  ON 13
 ud_4                -5.812173e-02 1 1  ON 14
 ud_5                -1.006833e-01 1 1  ON 15
 ud_6                -1.296214e-01 1 1  ON 16
 ud_7                -1.477795e-01 1 1  ON 17
 ud_8                -1.502196e-01 1 1  ON 18
 ud_9                -1.418417e-01 1 1  ON 19
 eO_0                -7.054588e-01 1 1  ON 20
 eO_1                -3.855154e-01 1 1  ON 21
 eO_2                 2.821002e-02 1 1  ON 22
 eO_3                 3.439379e-01 1 1  ON 23
 eO_4                 5.683096e-01 1 1  ON 24
 eO_5                 5.255648e-01 1 1  ON 25
 eO_6                 2.820982e-01 1 1  ON 26
 eO_7                -6.502913e-02 1 1  ON 27
 eO_8                -3.286724e-01 1 1  ON 28
 eO_9                -2.251522e-01 1 1  ON 29
eH1_0                -2.920285e-01 1 1  ON 30
eH1_1                -1.886281e-01 1 1  ON 31
eH1_2                -1.401840e-01 1 1  ON 32
eH1_3                -8.506544e-02 1 1  ON 33
eH1_4                -3.493341e-02 1 1  ON 34
eH1_5                 4.684844e-03 1 1  ON 35
eH1_6                 7.309452e-02 1 1  ON 36
eH1_7                 1.571229e-01 1 1  ON 37
eH1_8                 2.279193e-01 1 1  ON 38
eH1_9                 2.110077e-01 1 1  ON 39
eH2_0                -2.901040e-01 1 1  ON 40
eH2_1                -1.870427e-01 1 1  ON 41
eH2_2                -1.384390e-01 1 1  ON 42
eH2_3                -8.318318e-02 1 1  ON 43
eH2_4                -3.314637e-02 1 1  ON 44
eH2_5                 5.790719e-03 1 1  ON 45
eH2_6                 7.505195e-02 1 1  ON 46
eH2_7                 1.570424e-01 1 1  ON 47
eH2_8                 2.243757e-01 1 1  ON 48
eH2_9                 2.362633e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.7222
    reference variance = 4.50921
====================================================
  Execution time = 2.0782e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4007e-01
  Total weights = 2.0000e+06
  Execution time = 1.8899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339878054862
                                         uncertainty =       0.004159418618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339878054862
                                         uncertainty =       0.004159418618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412352083
  error estimate for blocks of size 2^( 2) =       0.000424998432
  error estimate for blocks of size 2^( 3) =       0.000437708969
  error estimate for blocks of size 2^( 4) =       0.000449852332
  error estimate for blocks of size 2^( 5) =       0.000460560198
  error estimate for blocks of size 2^( 6) =       0.000471997025
  error estimate for blocks of size 2^( 7) =       0.000478562907

      target function =                  N/A
              le_mean =     -16.906964544546
             les_mean =     286.185518421383
             stat err =       0.000465243116
             autocorr =       1.272985700488
              std dev =       0.583153908408
             le_variance =       0.340068480892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339876796042
                                         uncertainty =       0.004159399444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339876796042
                                         uncertainty =       0.004159399444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412351320
  error estimate for blocks of size 2^( 2) =       0.000424997656
  error estimate for blocks of size 2^( 3) =       0.000437708178
  error estimate for blocks of size 2^( 4) =       0.000449851527
  error estimate for blocks of size 2^( 5) =       0.000460559440
  error estimate for blocks of size 2^( 6) =       0.000471996371
  error estimate for blocks of size 2^( 7) =       0.000478562195

      target function =                  N/A
              le_mean =     -16.906964539127
             les_mean =     286.185516980212
             stat err =       0.000465242383
             autocorr =       1.272986400429
              std dev =       0.583152829844
             le_variance =       0.340067222955

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339877408611
                                         uncertainty =       0.004159408792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339877408611
                                         uncertainty =       0.004159408792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412351692
  error estimate for blocks of size 2^( 2) =       0.000424998034
  error estimate for blocks of size 2^( 3) =       0.000437708564
  error estimate for blocks of size 2^( 4) =       0.000449851920
  error estimate for blocks of size 2^( 5) =       0.000460559810
  error estimate for blocks of size 2^( 6) =       0.000471996690
  error estimate for blocks of size 2^( 7) =       0.000478562543

      target function =                  N/A
              le_mean =     -16.906964541775
             les_mean =     286.185517681884
             stat err =       0.000465242741
             autocorr =       1.272986065149
              std dev =       0.583153354680
             le_variance =       0.340067835075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339877973529
                                         uncertainty =       0.004159417382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339877973529
                                         uncertainty =       0.004159417382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412352034
  error estimate for blocks of size 2^( 2) =       0.000424998382
  error estimate for blocks of size 2^( 3) =       0.000437708918
  error estimate for blocks of size 2^( 4) =       0.000449852280
  error estimate for blocks of size 2^( 5) =       0.000460560150
  error estimate for blocks of size 2^( 6) =       0.000471996983
  error estimate for blocks of size 2^( 7) =       0.000478562861

      target function =                  N/A
              le_mean =     -16.906964544195
             les_mean =     286.185518328257
             stat err =       0.000465243068
             autocorr =       1.272985746530
              std dev =       0.583153838720
             le_variance =       0.340068399613


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906964544546        initial  <--
     2.3283e+01     2.3283e+02             8.7740e-06       -16.906964539127
     9.3132e+01     9.3132e+02             2.1977e-06       -16.906964541775
     3.7253e+02     3.7253e+03             5.4969e-07       -16.906964544195

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2761
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.943218e-01 1 1  ON 0
 uu_1                 1.270456e-01 1 1  ON 1
 uu_2                 2.526128e-02 1 1  ON 2
 uu_3                -3.747523e-02 1 1  ON 3
 uu_4                -8.370279e-02 1 1  ON 4
 uu_5                -1.197518e-01 1 1  ON 5
 uu_6                -1.485602e-01 1 1  ON 6
 uu_7                -1.637443e-01 1 1  ON 7
 uu_8                -1.562127e-01 1 1  ON 8
 uu_9                -1.292324e-01 1 1  ON 9
 ud_0                 4.555023e-01 1 1  ON 10
 ud_1                 1.901083e-01 1 1  ON 11
 ud_2                 7.055195e-02 1 1  ON 12
 ud_3                -3.092961e-04 1 1  ON 13
 ud_4                -5.812187e-02 1 1  ON 14
 ud_5                -1.006832e-01 1 1  ON 15
 ud_6                -1.296216e-01 1 1  ON 16
 ud_7                -1.477790e-01 1 1  ON 17
 ud_8                -1.502185e-01 1 1  ON 18
 ud_9                -1.418413e-01 1 1  ON 19
 eO_0                -7.054595e-01 1 1  ON 20
 eO_1                -3.855147e-01 1 1  ON 21
 eO_2                 2.820898e-02 1 1  ON 22
 eO_3                 3.439377e-01 1 1  ON 23
 eO_4                 5.683085e-01 1 1  ON 24
 eO_5                 5.255651e-01 1 1  ON 25
 eO_6                 2.820971e-01 1 1  ON 26
 eO_7                -6.502874e-02 1 1  ON 27
 eO_8                -3.286713e-01 1 1  ON 28
 eO_9                -2.251511e-01 1 1  ON 29
eH1_0                -2.920263e-01 1 1  ON 30
eH1_1                -1.886273e-01 1 1  ON 31
eH1_2                -1.401844e-01 1 1  ON 32
eH1_3                -8.506598e-02 1 1  ON 33
eH1_4                -3.493481e-02 1 1  ON 34
eH1_5                 4.684651e-03 1 1  ON 35
eH1_6                 7.309441e-02 1 1  ON 36
eH1_7                 1.571230e-01 1 1  ON 37
eH1_8                 2.279197e-01 1 1  ON 38
eH1_9                 2.110072e-01 1 1  ON 39
eH2_0                -2.901018e-01 1 1  ON 40
eH2_1                -1.870422e-01 1 1  ON 41
eH2_2                -1.384384e-01 1 1  ON 42
eH2_3                -8.318348e-02 1 1  ON 43
eH2_4                -3.314627e-02 1 1  ON 44
eH2_5                 5.789849e-03 1 1  ON 45
eH2_6                 7.505118e-02 1 1  ON 46
eH2_7                 1.570424e-01 1 1  ON 47
eH2_8                 2.243755e-01 1 1  ON 48
eH2_9                 2.362629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6833e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8301
    reference variance = 0.290465
====================================================
  Execution time = 2.1139e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2927e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329243132128
                                         uncertainty =       0.002750340627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329243132128
                                         uncertainty =       0.002750340627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405751070
  error estimate for blocks of size 2^( 2) =       0.000418636215
  error estimate for blocks of size 2^( 3) =       0.000431643740
  error estimate for blocks of size 2^( 4) =       0.000443704512
  error estimate for blocks of size 2^( 5) =       0.000454055953
  error estimate for blocks of size 2^( 6) =       0.000462820447
  error estimate for blocks of size 2^( 7) =       0.000467657530

      target function =                  N/A
              le_mean =     -16.906572255841
             les_mean =     286.161453138784
             stat err =       0.000457059611
             autocorr =       1.268896920573
              std dev =       0.573818666007
             le_variance =       0.329267861458


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690657225584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572255841       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572258163       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572258693       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572259672       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572261334       residual = 8.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572261332       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572261171       residual = 8.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.031126e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572255841       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572256421       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572256554       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572256799       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572257215       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572257214       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572257173       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.758934e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906572255841       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906572255986       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906572256019       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906572256080       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906572256184       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906572256184       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906572256174       residual = 8.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 4.398057e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6650e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.943217e-01 1 1  ON 0
 uu_1                 1.270456e-01 1 1  ON 1
 uu_2                 2.526126e-02 1 1  ON 2
 uu_3                -3.747516e-02 1 1  ON 3
 uu_4                -8.370275e-02 1 1  ON 4
 uu_5                -1.197518e-01 1 1  ON 5
 uu_6                -1.485600e-01 1 1  ON 6
 uu_7                -1.637443e-01 1 1  ON 7
 uu_8                -1.562128e-01 1 1  ON 8
 uu_9                -1.292325e-01 1 1  ON 9
 ud_0                 4.555024e-01 1 1  ON 10
 ud_1                 1.901084e-01 1 1  ON 11
 ud_2                 7.055196e-02 1 1  ON 12
 ud_3                -3.092393e-04 1 1  ON 13
 ud_4                -5.812189e-02 1 1  ON 14
 ud_5                -1.006832e-01 1 1  ON 15
 ud_6                -1.296216e-01 1 1  ON 16
 ud_7                -1.477790e-01 1 1  ON 17
 ud_8                -1.502186e-01 1 1  ON 18
 ud_9                -1.418414e-01 1 1  ON 19
 eO_0                -7.054594e-01 1 1  ON 20
 eO_1                -3.855147e-01 1 1  ON 21
 eO_2                 2.820916e-02 1 1  ON 22
 eO_3                 3.439377e-01 1 1  ON 23
 eO_4                 5.683085e-01 1 1  ON 24
 eO_5                 5.255652e-01 1 1  ON 25
 eO_6                 2.820972e-01 1 1  ON 26
 eO_7                -6.502878e-02 1 1  ON 27
 eO_8                -3.286714e-01 1 1  ON 28
 eO_9                -2.251512e-01 1 1  ON 29
eH1_0                -2.920265e-01 1 1  ON 30
eH1_1                -1.886274e-01 1 1  ON 31
eH1_2                -1.401844e-01 1 1  ON 32
eH1_3                -8.506593e-02 1 1  ON 33
eH1_4                -3.493475e-02 1 1  ON 34
eH1_5                 4.684592e-03 1 1  ON 35
eH1_6                 7.309440e-02 1 1  ON 36
eH1_7                 1.571230e-01 1 1  ON 37
eH1_8                 2.279197e-01 1 1  ON 38
eH1_9                 2.110073e-01 1 1  ON 39
eH2_0                -2.901020e-01 1 1  ON 40
eH2_1                -1.870422e-01 1 1  ON 41
eH2_2                -1.384383e-01 1 1  ON 42
eH2_3                -8.318342e-02 1 1  ON 43
eH2_4                -3.314624e-02 1 1  ON 44
eH2_5                 5.789816e-03 1 1  ON 45
eH2_6                 7.505126e-02 1 1  ON 46
eH2_7                 1.570424e-01 1 1  ON 47
eH2_8                 2.243755e-01 1 1  ON 48
eH2_9                 2.362629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8598
    reference variance = 0.433251
====================================================
  Execution time = 2.1985e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.0000e+06
  Execution time = 1.9622e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244366925
                                         uncertainty =       0.003223303810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244366925
                                         uncertainty =       0.003223303810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411244421
  error estimate for blocks of size 2^( 2) =       0.000423735845
  error estimate for blocks of size 2^( 3) =       0.000436640871
  error estimate for blocks of size 2^( 4) =       0.000448970166
  error estimate for blocks of size 2^( 5) =       0.000458389219
  error estimate for blocks of size 2^( 6) =       0.000463932506
  error estimate for blocks of size 2^( 7) =       0.000469327572

      target function =                  N/A
              le_mean =     -16.907413743640
             les_mean =     286.198883276487
             stat err =       0.000460154866
             autocorr =       1.252010583200
              std dev =       0.581587437105
             le_variance =       0.338243946998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244375156
                                         uncertainty =       0.003223304840

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244375156
                                         uncertainty =       0.003223304840

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411244426
  error estimate for blocks of size 2^( 2) =       0.000423735842
  error estimate for blocks of size 2^( 3) =       0.000436640862
  error estimate for blocks of size 2^( 4) =       0.000448970155
  error estimate for blocks of size 2^( 5) =       0.000458389205
  error estimate for blocks of size 2^( 6) =       0.000463932501
  error estimate for blocks of size 2^( 7) =       0.000469327579

      target function =                  N/A
              le_mean =     -16.907413747090
             les_mean =     286.198883401331
             stat err =       0.000460154860
             autocorr =       1.252010518896
              std dev =       0.581587444137
             le_variance =       0.338243955177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244371127
                                         uncertainty =       0.003223304325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244371127
                                         uncertainty =       0.003223304325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411244423
  error estimate for blocks of size 2^( 2) =       0.000423735844
  error estimate for blocks of size 2^( 3) =       0.000436640867
  error estimate for blocks of size 2^( 4) =       0.000448970160
  error estimate for blocks of size 2^( 5) =       0.000458389212
  error estimate for blocks of size 2^( 6) =       0.000463932503
  error estimate for blocks of size 2^( 7) =       0.000469327576

      target function =                  N/A
              le_mean =     -16.907413745366
             les_mean =     286.198883339057
             stat err =       0.000460154863
             autocorr =       1.252010550909
              std dev =       0.581587440695
             le_variance =       0.338243951174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244367453
                                         uncertainty =       0.003223303874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338244367453
                                         uncertainty =       0.003223303874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411244421
  error estimate for blocks of size 2^( 2) =       0.000423735845
  error estimate for blocks of size 2^( 3) =       0.000436640870
  error estimate for blocks of size 2^( 4) =       0.000448970165
  error estimate for blocks of size 2^( 5) =       0.000458389218
  error estimate for blocks of size 2^( 6) =       0.000463932506
  error estimate for blocks of size 2^( 7) =       0.000469327573

      target function =                  N/A
              le_mean =     -16.907413743855
             les_mean =     286.198883284312
             stat err =       0.000460154866
             autocorr =       1.252010579161
              std dev =       0.581587437556
             le_variance =       0.338243947523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907413743640        initial
     2.3283e+02     2.3283e+03             7.0311e-07       -16.907413747090  <--
     9.3132e+02     9.3132e+03             1.7589e-07       -16.907413745366
     3.7253e+03     3.7253e+04             4.3981e-08       -16.907413743855

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 3.1572e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.943216e-01 1 1  ON 0
 uu_1                 1.270458e-01 1 1  ON 1
 uu_2                 2.526123e-02 1 1  ON 2
 uu_3                -3.747498e-02 1 1  ON 3
 uu_4                -8.370264e-02 1 1  ON 4
 uu_5                -1.197517e-01 1 1  ON 5
 uu_6                -1.485596e-01 1 1  ON 6
 uu_7                -1.637444e-01 1 1  ON 7
 uu_8                -1.562131e-01 1 1  ON 8
 uu_9                -1.292329e-01 1 1  ON 9
 ud_0                 4.555026e-01 1 1  ON 10
 ud_1                 1.901088e-01 1 1  ON 11
 ud_2                 7.055200e-02 1 1  ON 12
 ud_3                -3.090692e-04 1 1  ON 13
 ud_4                -5.812194e-02 1 1  ON 14
 ud_5                -1.006830e-01 1 1  ON 15
 ud_6                -1.296214e-01 1 1  ON 16
 ud_7                -1.477791e-01 1 1  ON 17
 ud_8                -1.502186e-01 1 1  ON 18
 ud_9                -1.418417e-01 1 1  ON 19
 eO_0                -7.054593e-01 1 1  ON 20
 eO_1                -3.855148e-01 1 1  ON 21
 eO_2                 2.820969e-02 1 1  ON 22
 eO_3                 3.439377e-01 1 1  ON 23
 eO_4                 5.683086e-01 1 1  ON 24
 eO_5                 5.255653e-01 1 1  ON 25
 eO_6                 2.820973e-01 1 1  ON 26
 eO_7                -6.502889e-02 1 1  ON 27
 eO_8                -3.286717e-01 1 1  ON 28
 eO_9                -2.251516e-01 1 1  ON 29
eH1_0                -2.920269e-01 1 1  ON 30
eH1_1                -1.886275e-01 1 1  ON 31
eH1_2                -1.401844e-01 1 1  ON 32
eH1_3                -8.506579e-02 1 1  ON 33
eH1_4                -3.493456e-02 1 1  ON 34
eH1_5                 4.684416e-03 1 1  ON 35
eH1_6                 7.309437e-02 1 1  ON 36
eH1_7                 1.571229e-01 1 1  ON 37
eH1_8                 2.279198e-01 1 1  ON 38
eH1_9                 2.110076e-01 1 1  ON 39
eH2_0                -2.901025e-01 1 1  ON 40
eH2_1                -1.870423e-01 1 1  ON 41
eH2_2                -1.384381e-01 1 1  ON 42
eH2_3                -8.318323e-02 1 1  ON 43
eH2_4                -3.314615e-02 1 1  ON 44
eH2_5                 5.789717e-03 1 1  ON 45
eH2_6                 7.505151e-02 1 1  ON 46
eH2_7                 1.570424e-01 1 1  ON 47
eH2_8                 2.243754e-01 1 1  ON 48
eH2_9                 2.362629e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8229e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9532
    reference variance = 0.239975
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4785e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347898756336
                                         uncertainty =       0.005804599160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347898756336
                                         uncertainty =       0.005804599160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417042502
  error estimate for blocks of size 2^( 2) =       0.000429751749
  error estimate for blocks of size 2^( 3) =       0.000442296479
  error estimate for blocks of size 2^( 4) =       0.000453559098
  error estimate for blocks of size 2^( 5) =       0.000463696496
  error estimate for blocks of size 2^( 6) =       0.000471796796
  error estimate for blocks of size 2^( 7) =       0.000478378273

      target function =                  N/A
              le_mean =     -16.906068741823
             les_mean =     286.163009026200
             stat err =       0.000466857666
             autocorr =       1.253165279451
              std dev =       0.589787162361
             le_variance =       0.347848896886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606874182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068741823       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906068741477       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906068744448       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906068737737       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906068732733       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906068742466       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906068747786       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906068749078       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.846554e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068741823       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906068741736       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906068742469       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906068740771       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906068739507       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906068741932       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906068743268       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906068743597       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.144988e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906068741823       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906068741801       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906068741984       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906068741558       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906068741242       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906068741847       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906068742179       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906068742264       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 1.788046e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.126681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6262e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.943209e-01 1 1  ON 0
 uu_1                 1.270459e-01 1 1  ON 1
 uu_2                 2.526167e-02 1 1  ON 2
 uu_3                -3.747497e-02 1 1  ON 3
 uu_4                -8.370210e-02 1 1  ON 4
 uu_5                -1.197514e-01 1 1  ON 5
 uu_6                -1.485598e-01 1 1  ON 6
 uu_7                -1.637449e-01 1 1  ON 7
 uu_8                -1.562130e-01 1 1  ON 8
 uu_9                -1.292328e-01 1 1  ON 9
 ud_0                 4.555021e-01 1 1  ON 10
 ud_1                 1.901093e-01 1 1  ON 11
 ud_2                 7.055246e-02 1 1  ON 12
 ud_3                -3.090596e-04 1 1  ON 13
 ud_4                -5.812145e-02 1 1  ON 14
 ud_5                -1.006833e-01 1 1  ON 15
 ud_6                -1.296217e-01 1 1  ON 16
 ud_7                -1.477790e-01 1 1  ON 17
 ud_8                -1.502187e-01 1 1  ON 18
 ud_9                -1.418417e-01 1 1  ON 19
 eO_0                -7.054596e-01 1 1  ON 20
 eO_1                -3.855144e-01 1 1  ON 21
 eO_2                 2.820987e-02 1 1  ON 22
 eO_3                 3.439378e-01 1 1  ON 23
 eO_4                 5.683093e-01 1 1  ON 24
 eO_5                 5.255652e-01 1 1  ON 25
 eO_6                 2.820972e-01 1 1  ON 26
 eO_7                -6.502893e-02 1 1  ON 27
 eO_8                -3.286720e-01 1 1  ON 28
 eO_9                -2.251521e-01 1 1  ON 29
eH1_0                -2.920270e-01 1 1  ON 30
eH1_1                -1.886279e-01 1 1  ON 31
eH1_2                -1.401849e-01 1 1  ON 32
eH1_3                -8.506550e-02 1 1  ON 33
eH1_4                -3.493419e-02 1 1  ON 34
eH1_5                 4.684559e-03 1 1  ON 35
eH1_6                 7.309445e-02 1 1  ON 36
eH1_7                 1.571228e-01 1 1  ON 37
eH1_8                 2.279197e-01 1 1  ON 38
eH1_9                 2.110078e-01 1 1  ON 39
eH2_0                -2.901030e-01 1 1  ON 40
eH2_1                -1.870420e-01 1 1  ON 41
eH2_2                -1.384382e-01 1 1  ON 42
eH2_3                -8.318333e-02 1 1  ON 43
eH2_4                -3.314604e-02 1 1  ON 44
eH2_5                 5.789686e-03 1 1  ON 45
eH2_6                 7.505124e-02 1 1  ON 46
eH2_7                 1.570425e-01 1 1  ON 47
eH2_8                 2.243754e-01 1 1  ON 48
eH2_9                 2.362631e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8084
    reference variance = 0.297211
====================================================
  Execution time = 2.0318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.0000e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850198065
                                         uncertainty =       0.004543888417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336850198065
                                         uncertainty =       0.004543888417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410328087
  error estimate for blocks of size 2^( 2) =       0.000423205306
  error estimate for blocks of size 2^( 3) =       0.000436060567
  error estimate for blocks of size 2^( 4) =       0.000448296664
  error estimate for blocks of size 2^( 5) =       0.000459326615
  error estimate for blocks of size 2^( 6) =       0.000468800869
  error estimate for blocks of size 2^( 7) =       0.000474917864

      target function =                  N/A
              le_mean =     -16.905967860513
             les_mean =     286.148487410518
             stat err =       0.000462835503
             autocorr =       1.272303845110
              std dev =       0.580291545844
             le_variance =       0.336738278178

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846289110
                                         uncertainty =       0.004543849490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336846289110
                                         uncertainty =       0.004543849490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410325707
  error estimate for blocks of size 2^( 2) =       0.000423203072
  error estimate for blocks of size 2^( 3) =       0.000436058438
  error estimate for blocks of size 2^( 4) =       0.000448294563
  error estimate for blocks of size 2^( 5) =       0.000459324556
  error estimate for blocks of size 2^( 6) =       0.000468798820
  error estimate for blocks of size 2^( 7) =       0.000474915903

      target function =                  N/A
              le_mean =     -16.905967876143
             les_mean =     286.148484033217
             stat err =       0.000462833461
             autocorr =       1.272307373704
              std dev =       0.580288180470
             le_variance =       0.336734372393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336848229936
                                         uncertainty =       0.004543868796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336848229936
                                         uncertainty =       0.004543868796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410326889
  error estimate for blocks of size 2^( 2) =       0.000423204181
  error estimate for blocks of size 2^( 3) =       0.000436059495
  error estimate for blocks of size 2^( 4) =       0.000448295607
  error estimate for blocks of size 2^( 5) =       0.000459325579
  error estimate for blocks of size 2^( 6) =       0.000468799838
  error estimate for blocks of size 2^( 7) =       0.000474916877

      target function =                  N/A
              le_mean =     -16.905967868355
             les_mean =     286.148485709141
             stat err =       0.000462834475
             autocorr =       1.272305622326
              std dev =       0.580289851406
             le_variance =       0.336736311645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849951605
                                         uncertainty =       0.004543885959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336849951605
                                         uncertainty =       0.004543885959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410327937
  error estimate for blocks of size 2^( 2) =       0.000423205165
  error estimate for blocks of size 2^( 3) =       0.000436060433
  error estimate for blocks of size 2^( 4) =       0.000448296532
  error estimate for blocks of size 2^( 5) =       0.000459326485
  error estimate for blocks of size 2^( 6) =       0.000468800740
  error estimate for blocks of size 2^( 7) =       0.000474917741

      target function =                  N/A
              le_mean =     -16.905967861493
             les_mean =     286.148487197376
             stat err =       0.000462835374
             autocorr =       1.272304067672
              std dev =       0.580291333658
             le_variance =       0.336738031918


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905967860513        initial
     5.8208e+01     5.8208e+02             2.8466e-06       -16.905967876143  <--
     2.3283e+02     2.3283e+03             7.1450e-07       -16.905967868355
     9.3132e+02     9.3132e+03             1.7880e-07       -16.905967861493

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.9834e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.943188e-01 1 1  ON 0
 uu_1                 1.270459e-01 1 1  ON 1
 uu_2                 2.526295e-02 1 1  ON 2
 uu_3                -3.747494e-02 1 1  ON 3
 uu_4                -8.370048e-02 1 1  ON 4
 uu_5                -1.197505e-01 1 1  ON 5
 uu_6                -1.485606e-01 1 1  ON 6
 uu_7                -1.637462e-01 1 1  ON 7
 uu_8                -1.562127e-01 1 1  ON 8
 uu_9                -1.292327e-01 1 1  ON 9
 ud_0                 4.555007e-01 1 1  ON 10
 ud_1                 1.901108e-01 1 1  ON 11
 ud_2                 7.055383e-02 1 1  ON 12
 ud_3                -3.090238e-04 1 1  ON 13
 ud_4                -5.811997e-02 1 1  ON 14
 ud_5                -1.006842e-01 1 1  ON 15
 ud_6                -1.296225e-01 1 1  ON 16
 ud_7                -1.477786e-01 1 1  ON 17
 ud_8                -1.502188e-01 1 1  ON 18
 ud_9                -1.418417e-01 1 1  ON 19
 eO_0                -7.054606e-01 1 1  ON 20
 eO_1                -3.855132e-01 1 1  ON 21
 eO_2                 2.821043e-02 1 1  ON 22
 eO_3                 3.439379e-01 1 1  ON 23
 eO_4                 5.683114e-01 1 1  ON 24
 eO_5                 5.255650e-01 1 1  ON 25
 eO_6                 2.820972e-01 1 1  ON 26
 eO_7                -6.502903e-02 1 1  ON 27
 eO_8                -3.286729e-01 1 1  ON 28
 eO_9                -2.251534e-01 1 1  ON 29
eH1_0                -2.920276e-01 1 1  ON 30
eH1_1                -1.886290e-01 1 1  ON 31
eH1_2                -1.401864e-01 1 1  ON 32
eH1_3                -8.506461e-02 1 1  ON 33
eH1_4                -3.493309e-02 1 1  ON 34
eH1_5                 4.684989e-03 1 1  ON 35
eH1_6                 7.309468e-02 1 1  ON 36
eH1_7                 1.571223e-01 1 1  ON 37
eH1_8                 2.279195e-01 1 1  ON 38
eH1_9                 2.110085e-01 1 1  ON 39
eH2_0                -2.901044e-01 1 1  ON 40
eH2_1                -1.870411e-01 1 1  ON 41
eH2_2                -1.384383e-01 1 1  ON 42
eH2_3                -8.318362e-02 1 1  ON 43
eH2_4                -3.314568e-02 1 1  ON 44
eH2_5                 5.789594e-03 1 1  ON 45
eH2_6                 7.505043e-02 1 1  ON 46
eH2_7                 1.570427e-01 1 1  ON 47
eH2_8                 2.243752e-01 1 1  ON 48
eH2_9                 2.362637e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6895e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8392
    reference variance = 0.137935
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340013265405
                                         uncertainty =       0.004537835969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340013265405
                                         uncertainty =       0.004537835969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412312313
  error estimate for blocks of size 2^( 2) =       0.000425259339
  error estimate for blocks of size 2^( 3) =       0.000437899923
  error estimate for blocks of size 2^( 4) =       0.000449597763
  error estimate for blocks of size 2^( 5) =       0.000460092346
  error estimate for blocks of size 2^( 6) =       0.000465613786
  error estimate for blocks of size 2^( 7) =       0.000470636860

      target function =                  N/A
              le_mean =     -16.906784979019
             les_mean =     286.179381043645
             stat err =       0.000461485189
             autocorr =       1.252745712955
              std dev =       0.583097664951
             le_variance =       0.340002886871


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690678497902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906784979019       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906784983080       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906784931118       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906784913540       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906784927638       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906784920716       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906784925403       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.239138e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906784979019       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906784980047       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906784966840       residual = 7.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906784962341       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906784965570       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906784963857       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906784965105       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.131474e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906784979019       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906784979277       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906784975961       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906784974830       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906784975617       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906784975191       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906784975507       residual = 9.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.850098e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6065e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.943182e-01 1 1  ON 0
 uu_1                 1.270466e-01 1 1  ON 1
 uu_2                 2.526341e-02 1 1  ON 2
 uu_3                -3.747542e-02 1 1  ON 3
 uu_4                -8.369945e-02 1 1  ON 4
 uu_5                -1.197498e-01 1 1  ON 5
 uu_6                -1.485617e-01 1 1  ON 6
 uu_7                -1.637464e-01 1 1  ON 7
 uu_8                -1.562131e-01 1 1  ON 8
 uu_9                -1.292330e-01 1 1  ON 9
 ud_0                 4.555004e-01 1 1  ON 10
 ud_1                 1.901122e-01 1 1  ON 11
 ud_2                 7.055543e-02 1 1  ON 12
 ud_3                -3.093869e-04 1 1  ON 13
 ud_4                -5.812010e-02 1 1  ON 14
 ud_5                -1.006830e-01 1 1  ON 15
 ud_6                -1.296215e-01 1 1  ON 16
 ud_7                -1.477788e-01 1 1  ON 17
 ud_8                -1.502205e-01 1 1  ON 18
 ud_9                -1.418423e-01 1 1  ON 19
 eO_0                -7.054605e-01 1 1  ON 20
 eO_1                -3.855125e-01 1 1  ON 21
 eO_2                 2.821063e-02 1 1  ON 22
 eO_3                 3.439384e-01 1 1  ON 23
 eO_4                 5.683135e-01 1 1  ON 24
 eO_5                 5.255657e-01 1 1  ON 25
 eO_6                 2.820963e-01 1 1  ON 26
 eO_7                -6.502951e-02 1 1  ON 27
 eO_8                -3.286737e-01 1 1  ON 28
 eO_9                -2.251550e-01 1 1  ON 29
eH1_0                -2.920295e-01 1 1  ON 30
eH1_1                -1.886295e-01 1 1  ON 31
eH1_2                -1.401879e-01 1 1  ON 32
eH1_3                -8.506485e-02 1 1  ON 33
eH1_4                -3.493173e-02 1 1  ON 34
eH1_5                 4.686540e-03 1 1  ON 35
eH1_6                 7.309537e-02 1 1  ON 36
eH1_7                 1.571218e-01 1 1  ON 37
eH1_8                 2.279188e-01 1 1  ON 38
eH1_9                 2.110091e-01 1 1  ON 39
eH2_0                -2.901055e-01 1 1  ON 40
eH2_1                -1.870402e-01 1 1  ON 41
eH2_2                -1.384415e-01 1 1  ON 42
eH2_3                -8.318373e-02 1 1  ON 43
eH2_4                -3.314680e-02 1 1  ON 44
eH2_5                 5.790630e-03 1 1  ON 45
eH2_6                 7.505078e-02 1 1  ON 46
eH2_7                 1.570434e-01 1 1  ON 47
eH2_8                 2.243765e-01 1 1  ON 48
eH2_9                 2.362644e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8756
    reference variance = 0.351707
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3847e-01
  Total weights = 2.0000e+06
  Execution time = 1.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338437414133
                                         uncertainty =       0.004692376386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338437414133
                                         uncertainty =       0.004692376386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411383702
  error estimate for blocks of size 2^( 2) =       0.000423931267
  error estimate for blocks of size 2^( 3) =       0.000436390276
  error estimate for blocks of size 2^( 4) =       0.000447676242
  error estimate for blocks of size 2^( 5) =       0.000457186061
  error estimate for blocks of size 2^( 6) =       0.000462588223
  error estimate for blocks of size 2^( 7) =       0.000467935190

      target function =                  N/A
              le_mean =     -16.906448682909
             les_mean =     286.166479999159
             stat err =       0.000458846429
             autocorr =       1.244057770613
              std dev =       0.581784410730
             le_variance =       0.338473100568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338432840167
                                         uncertainty =       0.004692216546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338432840167
                                         uncertainty =       0.004692216546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411380921
  error estimate for blocks of size 2^( 2) =       0.000423928575
  error estimate for blocks of size 2^( 3) =       0.000436387537
  error estimate for blocks of size 2^( 4) =       0.000447673344
  error estimate for blocks of size 2^( 5) =       0.000457183100
  error estimate for blocks of size 2^( 6) =       0.000462585475
  error estimate for blocks of size 2^( 7) =       0.000467932423

      target function =                  N/A
              le_mean =     -16.906448761384
             les_mean =     286.166478076921
             stat err =       0.000458843586
             autocorr =       1.244059170357
              std dev =       0.581780478223
             le_variance =       0.338468524841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338435052894
                                         uncertainty =       0.004692294958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338435052894
                                         uncertainty =       0.004692294958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411382267
  error estimate for blocks of size 2^( 2) =       0.000423929878
  error estimate for blocks of size 2^( 3) =       0.000436388864
  error estimate for blocks of size 2^( 4) =       0.000447674751
  error estimate for blocks of size 2^( 5) =       0.000457184539
  error estimate for blocks of size 2^( 6) =       0.000462586810
  error estimate for blocks of size 2^( 7) =       0.000467933766

      target function =                  N/A
              le_mean =     -16.906448723193
             les_mean =     286.166478999150
             stat err =       0.000458844966
             autocorr =       1.244058519807
              std dev =       0.581782380646
             le_variance =       0.338470738430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338437116519
                                         uncertainty =       0.004692366159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338437116519
                                         uncertainty =       0.004692366159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411383521
  error estimate for blocks of size 2^( 2) =       0.000423931092
  error estimate for blocks of size 2^( 3) =       0.000436390098
  error estimate for blocks of size 2^( 4) =       0.000447676054
  error estimate for blocks of size 2^( 5) =       0.000457185869
  error estimate for blocks of size 2^( 6) =       0.000462588045
  error estimate for blocks of size 2^( 7) =       0.000467935011

      target function =                  N/A
              le_mean =     -16.906448687968
             les_mean =     286.166479872513
             stat err =       0.000458846245
             autocorr =       1.244057865844
              std dev =       0.581784154856
             le_variance =       0.338472802841


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906448682909        initial
     1.4552e+01     1.4552e+02             1.2391e-05       -16.906448761384  <--
     5.8208e+01     5.8208e+02             3.1315e-06       -16.906448723193
     2.3283e+02     2.3283e+03             7.8501e-07       -16.906448687968

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 3.0047e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.943167e-01 1 1  ON 0
 uu_1                 1.270487e-01 1 1  ON 1
 uu_2                 2.526473e-02 1 1  ON 2
 uu_3                -3.747673e-02 1 1  ON 3
 uu_4                -8.369649e-02 1 1  ON 4
 uu_5                -1.197478e-01 1 1  ON 5
 uu_6                -1.485653e-01 1 1  ON 6
 uu_7                -1.637469e-01 1 1  ON 7
 uu_8                -1.562143e-01 1 1  ON 8
 uu_9                -1.292338e-01 1 1  ON 9
 ud_0                 4.554995e-01 1 1  ON 10
 ud_1                 1.901166e-01 1 1  ON 11
 ud_2                 7.056012e-02 1 1  ON 12
 ud_3                -3.103950e-04 1 1  ON 13
 ud_4                -5.812049e-02 1 1  ON 14
 ud_5                -1.006796e-01 1 1  ON 15
 ud_6                -1.296184e-01 1 1  ON 16
 ud_7                -1.477794e-01 1 1  ON 17
 ud_8                -1.502253e-01 1 1  ON 18
 ud_9                -1.418441e-01 1 1  ON 19
 eO_0                -7.054599e-01 1 1  ON 20
 eO_1                -3.855106e-01 1 1  ON 21
 eO_2                 2.821126e-02 1 1  ON 22
 eO_3                 3.439398e-01 1 1  ON 23
 eO_4                 5.683197e-01 1 1  ON 24
 eO_5                 5.255678e-01 1 1  ON 25
 eO_6                 2.820938e-01 1 1  ON 26
 eO_7                -6.503097e-02 1 1  ON 27
 eO_8                -3.286762e-01 1 1  ON 28
 eO_9                -2.251596e-01 1 1  ON 29
eH1_0                -2.920352e-01 1 1  ON 30
eH1_1                -1.886309e-01 1 1  ON 31
eH1_2                -1.401921e-01 1 1  ON 32
eH1_3                -8.506561e-02 1 1  ON 33
eH1_4                -3.492765e-02 1 1  ON 34
eH1_5                 4.691187e-03 1 1  ON 35
eH1_6                 7.309745e-02 1 1  ON 36
eH1_7                 1.571204e-01 1 1  ON 37
eH1_8                 2.279170e-01 1 1  ON 38
eH1_9                 2.110108e-01 1 1  ON 39
eH2_0                -2.901088e-01 1 1  ON 40
eH2_1                -1.870379e-01 1 1  ON 41
eH2_2                -1.384507e-01 1 1  ON 42
eH2_3                -8.318409e-02 1 1  ON 43
eH2_4                -3.315012e-02 1 1  ON 44
eH2_5                 5.793725e-03 1 1  ON 45
eH2_6                 7.505187e-02 1 1  ON 46
eH2_7                 1.570454e-01 1 1  ON 47
eH2_8                 2.243803e-01 1 1  ON 48
eH2_9                 2.362665e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8698
    reference variance = 0.244111
====================================================
  Execution time = 2.0604e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3423e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312609692
                                         uncertainty =       0.003361878670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334312609692
                                         uncertainty =       0.003361878670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408795093
  error estimate for blocks of size 2^( 2) =       0.000421462426
  error estimate for blocks of size 2^( 3) =       0.000434745106
  error estimate for blocks of size 2^( 4) =       0.000447634372
  error estimate for blocks of size 2^( 5) =       0.000459601257
  error estimate for blocks of size 2^( 6) =       0.000468821337
  error estimate for blocks of size 2^( 7) =       0.000474604446

      target function =                  N/A
              le_mean =     -16.906002170089
             les_mean =     286.147136064064
             stat err =       0.000462665353
             autocorr =       1.280921774754
              std dev =       0.578123564753
             le_variance =       0.334226856123


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600217009e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002170089       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002416786       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002408267       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002612797       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002547423       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002548727       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002562276       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 4.837443e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002170089       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002234186       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002232368       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002287131       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002271453       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002272375       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002275167       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.239820e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002170089       residual = 6.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002186272       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002185843       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002199785       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002195937       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002196201       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002196843       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.119140e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6168e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.943124e-01 1 1  ON 0
 uu_1                 1.270435e-01 1 1  ON 1
 uu_2                 2.526778e-02 1 1  ON 2
 uu_3                -3.748182e-02 1 1  ON 3
 uu_4                -8.369971e-02 1 1  ON 4
 uu_5                -1.197424e-01 1 1  ON 5
 uu_6                -1.485643e-01 1 1  ON 6
 uu_7                -1.637474e-01 1 1  ON 7
 uu_8                -1.562099e-01 1 1  ON 8
 uu_9                -1.292320e-01 1 1  ON 9
 ud_0                 4.555080e-01 1 1  ON 10
 ud_1                 1.901177e-01 1 1  ON 11
 ud_2                 7.055594e-02 1 1  ON 12
 ud_3                -3.140563e-04 1 1  ON 13
 ud_4                -5.812237e-02 1 1  ON 14
 ud_5                -1.006893e-01 1 1  ON 15
 ud_6                -1.296200e-01 1 1  ON 16
 ud_7                -1.477795e-01 1 1  ON 17
 ud_8                -1.502177e-01 1 1  ON 18
 ud_9                -1.418376e-01 1 1  ON 19
 eO_0                -7.054573e-01 1 1  ON 20
 eO_1                -3.855111e-01 1 1  ON 21
 eO_2                 2.820662e-02 1 1  ON 22
 eO_3                 3.439435e-01 1 1  ON 23
 eO_4                 5.683275e-01 1 1  ON 24
 eO_5                 5.255670e-01 1 1  ON 25
 eO_6                 2.820937e-01 1 1  ON 26
 eO_7                -6.503008e-02 1 1  ON 27
 eO_8                -3.286777e-01 1 1  ON 28
 eO_9                -2.251656e-01 1 1  ON 29
eH1_0                -2.920476e-01 1 1  ON 30
eH1_1                -1.886294e-01 1 1  ON 31
eH1_2                -1.401980e-01 1 1  ON 32
eH1_3                -8.506528e-02 1 1  ON 33
eH1_4                -3.492427e-02 1 1  ON 34
eH1_5                 4.689350e-03 1 1  ON 35
eH1_6                 7.309737e-02 1 1  ON 36
eH1_7                 1.571198e-01 1 1  ON 37
eH1_8                 2.279196e-01 1 1  ON 38
eH1_9                 2.110181e-01 1 1  ON 39
eH2_0                -2.901193e-01 1 1  ON 40
eH2_1                -1.870404e-01 1 1  ON 41
eH2_2                -1.384543e-01 1 1  ON 42
eH2_3                -8.318922e-02 1 1  ON 43
eH2_4                -3.314727e-02 1 1  ON 44
eH2_5                 5.791031e-03 1 1  ON 45
eH2_6                 7.505754e-02 1 1  ON 46
eH2_7                 1.570530e-01 1 1  ON 47
eH2_8                 2.243838e-01 1 1  ON 48
eH2_9                 2.362681e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9159
    reference variance = 0.187516
====================================================
  Execution time = 2.0472e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4151e-01
  Total weights = 2.0000e+06
  Execution time = 1.8851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341462226941
                                         uncertainty =       0.004249669033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341462226941
                                         uncertainty =       0.004249669033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413222002
  error estimate for blocks of size 2^( 2) =       0.000425652213
  error estimate for blocks of size 2^( 3) =       0.000437831489
  error estimate for blocks of size 2^( 4) =       0.000448750096
  error estimate for blocks of size 2^( 5) =       0.000457605392
  error estimate for blocks of size 2^( 6) =       0.000462918828
  error estimate for blocks of size 2^( 7) =       0.000467449350

      target function =                  N/A
              le_mean =     -16.905958584607
             les_mean =     286.152940340085
             stat err =       0.000459180916
             autocorr =       1.234811839673
              std dev =       0.584384159937
             le_variance =       0.341504846385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341490298766
                                         uncertainty =       0.004249891805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341490298766
                                         uncertainty =       0.004249891805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413238979
  error estimate for blocks of size 2^( 2) =       0.000425668400
  error estimate for blocks of size 2^( 3) =       0.000437846933
  error estimate for blocks of size 2^( 4) =       0.000448764921
  error estimate for blocks of size 2^( 5) =       0.000457619748
  error estimate for blocks of size 2^( 6) =       0.000462933235
  error estimate for blocks of size 2^( 7) =       0.000467462941

      target function =                  N/A
              le_mean =     -16.905958800390
             les_mean =     286.152975697242
             stat err =       0.000459195211
             autocorr =       1.234787262718
              std dev =       0.584408168610
             le_variance =       0.341532907538

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341476918597
                                         uncertainty =       0.004249779066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341476918597
                                         uncertainty =       0.004249779066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413230887
  error estimate for blocks of size 2^( 2) =       0.000425660671
  error estimate for blocks of size 2^( 3) =       0.000437839554
  error estimate for blocks of size 2^( 4) =       0.000448757834
  error estimate for blocks of size 2^( 5) =       0.000457612883
  error estimate for blocks of size 2^( 6) =       0.000462926346
  error estimate for blocks of size 2^( 7) =       0.000467456459

      target function =                  N/A
              le_mean =     -16.905958695017
             les_mean =     286.152958759476
             stat err =       0.000459188380
             autocorr =       1.234798882915
              std dev =       0.584396725363
             le_variance =       0.341519532615

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341464082704
                                         uncertainty =       0.004249682708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341464082704
                                         uncertainty =       0.004249682708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413223125
  error estimate for blocks of size 2^( 2) =       0.000425653281
  error estimate for blocks of size 2^( 3) =       0.000437832507
  error estimate for blocks of size 2^( 4) =       0.000448751073
  error estimate for blocks of size 2^( 5) =       0.000457606337
  error estimate for blocks of size 2^( 6) =       0.000462919776
  error estimate for blocks of size 2^( 7) =       0.000467450247

      target function =                  N/A
              le_mean =     -16.905958598318
             les_mean =     286.152942658766
             stat err =       0.000459181858
             autocorr =       1.234810198192
              std dev =       0.584385747147
             le_variance =       0.341506701468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905958584607        initial
     3.6380e+00     3.6380e+01             4.8374e-05       -16.905958800390  <--
     1.4552e+01     1.4552e+02             1.2398e-05       -16.905958695017
     5.8208e+01     5.8208e+02             3.1191e-06       -16.905958598318

*****************************************************************************
Applying the update for shift_i =   3.6380e+00     and shift_s =   3.6380e+01
*****************************************************************************

  Execution time = 2.9955e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.942999e-01 1 1  ON 0
 uu_1                 1.270290e-01 1 1  ON 1
 uu_2                 2.527501e-02 1 1  ON 2
 uu_3                -3.749555e-02 1 1  ON 3
 uu_4                -8.370955e-02 1 1  ON 4
 uu_5                -1.197266e-01 1 1  ON 5
 uu_6                -1.485614e-01 1 1  ON 6
 uu_7                -1.637487e-01 1 1  ON 7
 uu_8                -1.561969e-01 1 1  ON 8
 uu_9                -1.292265e-01 1 1  ON 9
 ud_0                 4.555317e-01 1 1  ON 10
 ud_1                 1.901202e-01 1 1  ON 11
 ud_2                 7.054481e-02 1 1  ON 12
 ud_3                -3.249037e-04 1 1  ON 13
 ud_4                -5.812847e-02 1 1  ON 14
 ud_5                -1.007165e-01 1 1  ON 15
 ud_6                -1.296255e-01 1 1  ON 16
 ud_7                -1.477798e-01 1 1  ON 17
 ud_8                -1.501951e-01 1 1  ON 18
 ud_9                -1.418181e-01 1 1  ON 19
 eO_0                -7.054500e-01 1 1  ON 20
 eO_1                -3.855116e-01 1 1  ON 21
 eO_2                 2.819335e-02 1 1  ON 22
 eO_3                 3.439534e-01 1 1  ON 23
 eO_4                 5.683504e-01 1 1  ON 24
 eO_5                 5.255647e-01 1 1  ON 25
 eO_6                 2.820935e-01 1 1  ON 26
 eO_7                -6.502738e-02 1 1  ON 27
 eO_8                -3.286821e-01 1 1  ON 28
 eO_9                -2.251829e-01 1 1  ON 29
eH1_0                -2.920835e-01 1 1  ON 30
eH1_1                -1.886254e-01 1 1  ON 31
eH1_2                -1.402149e-01 1 1  ON 32
eH1_3                -8.506434e-02 1 1  ON 33
eH1_4                -3.491442e-02 1 1  ON 34
eH1_5                 4.684069e-03 1 1  ON 35
eH1_6                 7.309705e-02 1 1  ON 36
eH1_7                 1.571179e-01 1 1  ON 37
eH1_8                 2.279275e-01 1 1  ON 38
eH1_9                 2.110396e-01 1 1  ON 39
eH2_0                -2.901498e-01 1 1  ON 40
eH2_1                -1.870482e-01 1 1  ON 41
eH2_2                -1.384655e-01 1 1  ON 42
eH2_3                -8.320337e-02 1 1  ON 43
eH2_4                -3.313925e-02 1 1  ON 44
eH2_5                 5.783349e-03 1 1  ON 45
eH2_6                 7.507429e-02 1 1  ON 46
eH2_7                 1.570753e-01 1 1  ON 47
eH2_8                 2.243940e-01 1 1  ON 48
eH2_9                 2.362730e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8541
    reference variance = 0.309169
====================================================
  Execution time = 2.0579e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4513e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345248483796
                                         uncertainty =       0.005067817315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345248483796
                                         uncertainty =       0.005067817315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415411497
  error estimate for blocks of size 2^( 2) =       0.000427954159
  error estimate for blocks of size 2^( 3) =       0.000441076073
  error estimate for blocks of size 2^( 4) =       0.000452396478
  error estimate for blocks of size 2^( 5) =       0.000462414414
  error estimate for blocks of size 2^( 6) =       0.000470628037
  error estimate for blocks of size 2^( 7) =       0.000475774080

      target function =                  N/A
              le_mean =     -16.906182605511
             les_mean =     286.164143541851
             stat err =       0.000465303252
             autocorr =       1.254628511327
              std dev =       0.587480572909
             le_variance =       0.345133423545


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618260551e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e-01, overlap shift 9.0949e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906182605511       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906182775458       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906183296376       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906183372124       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906183488687       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906183767793       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906183539518       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906183566934       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e-01 is 1.424506e-04

solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906182605511       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906182655863       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906182821492       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906182858016       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906182907717       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906182999520       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906182921044       residual = 8.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 4.212471e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906182605511       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906182618710       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906182663009       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906182674092       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906182688503       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906182713694       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906182693200       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.082760e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6125e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.942896e-01 1 1  ON 0
 uu_1                 1.269901e-01 1 1  ON 1
 uu_2                 2.526943e-02 1 1  ON 2
 uu_3                -3.752182e-02 1 1  ON 3
 uu_4                -8.368709e-02 1 1  ON 4
 uu_5                -1.197107e-01 1 1  ON 5
 uu_6                -1.485385e-01 1 1  ON 6
 uu_7                -1.637558e-01 1 1  ON 7
 uu_8                -1.561970e-01 1 1  ON 8
 uu_9                -1.292184e-01 1 1  ON 9
 ud_0                 4.555693e-01 1 1  ON 10
 ud_1                 1.901365e-01 1 1  ON 11
 ud_2                 7.056197e-02 1 1  ON 12
 ud_3                -3.185812e-04 1 1  ON 13
 ud_4                -5.814317e-02 1 1  ON 14
 ud_5                -1.007586e-01 1 1  ON 15
 ud_6                -1.296495e-01 1 1  ON 16
 ud_7                -1.477807e-01 1 1  ON 17
 ud_8                -1.501802e-01 1 1  ON 18
 ud_9                -1.418121e-01 1 1  ON 19
 eO_0                -7.054565e-01 1 1  ON 20
 eO_1                -3.855043e-01 1 1  ON 21
 eO_2                 2.819515e-02 1 1  ON 22
 eO_3                 3.439639e-01 1 1  ON 23
 eO_4                 5.683621e-01 1 1  ON 24
 eO_5                 5.255802e-01 1 1  ON 25
 eO_6                 2.820953e-01 1 1  ON 26
 eO_7                -6.502147e-02 1 1  ON 27
 eO_8                -3.286955e-01 1 1  ON 28
 eO_9                -2.252096e-01 1 1  ON 29
eH1_0                -2.921149e-01 1 1  ON 30
eH1_1                -1.886181e-01 1 1  ON 31
eH1_2                -1.402299e-01 1 1  ON 32
eH1_3                -8.507188e-02 1 1  ON 33
eH1_4                -3.492266e-02 1 1  ON 34
eH1_5                 4.685481e-03 1 1  ON 35
eH1_6                 7.312335e-02 1 1  ON 36
eH1_7                 1.571221e-01 1 1  ON 37
eH1_8                 2.279283e-01 1 1  ON 38
eH1_9                 2.110542e-01 1 1  ON 39
eH2_0                -2.901812e-01 1 1  ON 40
eH2_1                -1.870595e-01 1 1  ON 41
eH2_2                -1.385010e-01 1 1  ON 42
eH2_3                -8.321231e-02 1 1  ON 43
eH2_4                -3.314304e-02 1 1  ON 44
eH2_5                 5.768633e-03 1 1  ON 45
eH2_6                 7.508795e-02 1 1  ON 46
eH2_7                 1.571076e-01 1 1  ON 47
eH2_8                 2.244157e-01 1 1  ON 48
eH2_9                 2.362907e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9424
    reference variance = 0.192792
====================================================
  Execution time = 2.0169e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2942e-01
  Total weights = 2.0000e+06
  Execution time = 1.8864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329417767659
                                         uncertainty =       0.002537612253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329417767659
                                         uncertainty =       0.002537612253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405832232
  error estimate for blocks of size 2^( 2) =       0.000418993261
  error estimate for blocks of size 2^( 3) =       0.000431824759
  error estimate for blocks of size 2^( 4) =       0.000445009932
  error estimate for blocks of size 2^( 5) =       0.000456043808
  error estimate for blocks of size 2^( 6) =       0.000463994589
  error estimate for blocks of size 2^( 7) =       0.000469944963

      target function =                  N/A
              le_mean =     -16.906414079712
             les_mean =     286.156236471781
             stat err =       0.000458748323
             autocorr =       1.277779468107
              std dev =       0.573933447184
             le_variance =       0.329399601797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329481976041
                                         uncertainty =       0.002538074314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329481976041
                                         uncertainty =       0.002538074314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405871760
  error estimate for blocks of size 2^( 2) =       0.000419031880
  error estimate for blocks of size 2^( 3) =       0.000431860462
  error estimate for blocks of size 2^( 4) =       0.000445043730
  error estimate for blocks of size 2^( 5) =       0.000456074634
  error estimate for blocks of size 2^( 6) =       0.000464023520
  error estimate for blocks of size 2^( 7) =       0.000469971677

      target function =                  N/A
              le_mean =     -16.906413601926
             les_mean =     286.156284486204
             stat err =       0.000458778390
             autocorr =       1.277698062120
              std dev =       0.573989347934
             le_variance =       0.329463771542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329453063193
                                         uncertainty =       0.002537901652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329453063193
                                         uncertainty =       0.002537901652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405853960
  error estimate for blocks of size 2^( 2) =       0.000419014553
  error estimate for blocks of size 2^( 3) =       0.000431844403
  error estimate for blocks of size 2^( 4) =       0.000445028611
  error estimate for blocks of size 2^( 5) =       0.000456060679
  error estimate for blocks of size 2^( 6) =       0.000464010235
  error estimate for blocks of size 2^( 7) =       0.000469959041

      target function =                  N/A
              le_mean =     -16.906413703441
             les_mean =     286.156259021649
             stat err =       0.000458764641
             autocorr =       1.277733551743
              std dev =       0.573964175241
             le_variance =       0.329434874460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329422206618
                                         uncertainty =       0.002537649591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329422206618
                                         uncertainty =       0.002537649591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405834965
  error estimate for blocks of size 2^( 2) =       0.000418995940
  error estimate for blocks of size 2^( 3) =       0.000431827220
  error estimate for blocks of size 2^( 4) =       0.000445012268
  error estimate for blocks of size 2^( 5) =       0.000456045908
  error estimate for blocks of size 2^( 6) =       0.000463996528
  error estimate for blocks of size 2^( 7) =       0.000469946687

      target function =                  N/A
              le_mean =     -16.906414024249
             les_mean =     286.156239032262
             stat err =       0.000458750348
             autocorr =       1.277773539649
              std dev =       0.573937311587
             le_variance =       0.329404037632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906414079712        initial  <--
     9.0949e-01     9.0949e+00             1.4245e-04       -16.906413601926
     3.6380e+00     3.6380e+01             4.2125e-05       -16.906413703441
     1.4552e+01     1.4552e+02             1.0828e-05       -16.906414024249

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6494
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.942999e-01 1 1  ON 0
 uu_1                 1.270290e-01 1 1  ON 1
 uu_2                 2.527501e-02 1 1  ON 2
 uu_3                -3.749555e-02 1 1  ON 3
 uu_4                -8.370955e-02 1 1  ON 4
 uu_5                -1.197266e-01 1 1  ON 5
 uu_6                -1.485614e-01 1 1  ON 6
 uu_7                -1.637487e-01 1 1  ON 7
 uu_8                -1.561969e-01 1 1  ON 8
 uu_9                -1.292265e-01 1 1  ON 9
 ud_0                 4.555317e-01 1 1  ON 10
 ud_1                 1.901202e-01 1 1  ON 11
 ud_2                 7.054481e-02 1 1  ON 12
 ud_3                -3.249037e-04 1 1  ON 13
 ud_4                -5.812847e-02 1 1  ON 14
 ud_5                -1.007165e-01 1 1  ON 15
 ud_6                -1.296255e-01 1 1  ON 16
 ud_7                -1.477798e-01 1 1  ON 17
 ud_8                -1.501951e-01 1 1  ON 18
 ud_9                -1.418181e-01 1 1  ON 19
 eO_0                -7.054500e-01 1 1  ON 20
 eO_1                -3.855116e-01 1 1  ON 21
 eO_2                 2.819335e-02 1 1  ON 22
 eO_3                 3.439534e-01 1 1  ON 23
 eO_4                 5.683504e-01 1 1  ON 24
 eO_5                 5.255647e-01 1 1  ON 25
 eO_6                 2.820935e-01 1 1  ON 26
 eO_7                -6.502738e-02 1 1  ON 27
 eO_8                -3.286821e-01 1 1  ON 28
 eO_9                -2.251829e-01 1 1  ON 29
eH1_0                -2.920835e-01 1 1  ON 30
eH1_1                -1.886254e-01 1 1  ON 31
eH1_2                -1.402149e-01 1 1  ON 32
eH1_3                -8.506434e-02 1 1  ON 33
eH1_4                -3.491442e-02 1 1  ON 34
eH1_5                 4.684069e-03 1 1  ON 35
eH1_6                 7.309705e-02 1 1  ON 36
eH1_7                 1.571179e-01 1 1  ON 37
eH1_8                 2.279275e-01 1 1  ON 38
eH1_9                 2.110396e-01 1 1  ON 39
eH2_0                -2.901498e-01 1 1  ON 40
eH2_1                -1.870482e-01 1 1  ON 41
eH2_2                -1.384655e-01 1 1  ON 42
eH2_3                -8.320337e-02 1 1  ON 43
eH2_4                -3.313925e-02 1 1  ON 44
eH2_5                 5.783349e-03 1 1  ON 45
eH2_6                 7.507429e-02 1 1  ON 46
eH2_7                 1.570753e-01 1 1  ON 47
eH2_8                 2.243940e-01 1 1  ON 48
eH2_9                 2.362730e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5781e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.0607
    reference variance = 0.668885
====================================================
  Execution time = 2.0562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3302e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332992406543
                                         uncertainty =       0.002676524847

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332992406543
                                         uncertainty =       0.002676524847

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408055273
  error estimate for blocks of size 2^( 2) =       0.000421154773
  error estimate for blocks of size 2^( 3) =       0.000434313214
  error estimate for blocks of size 2^( 4) =       0.000447146689
  error estimate for blocks of size 2^( 5) =       0.000458087143
  error estimate for blocks of size 2^( 6) =       0.000467575741
  error estimate for blocks of size 2^( 7) =       0.000471378819

      target function =                  N/A
              le_mean =     -16.906466528048
             les_mean =     286.161628509017
             stat err =       0.000461047098
             autocorr =       1.276593407187
              std dev =       0.577077301152
             le_variance =       0.333018211504


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690646652805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906466528048       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906466585428       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906466591415       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906466606167       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906466596007       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906466590526       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906466580442       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 2.015212e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906466528048       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906466542670       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906466544341       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906466547978       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906466545377       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906466543898       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906466541368       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 5.106677e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906466528048       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906466531722       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906466532151       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906466533057       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906466532402       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906466532025       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906466531392       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.281101e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6091e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.942967e-01 1 1  ON 0
 uu_1                 1.270290e-01 1 1  ON 1
 uu_2                 2.527516e-02 1 1  ON 2
 uu_3                -3.749846e-02 1 1  ON 3
 uu_4                -8.370838e-02 1 1  ON 4
 uu_5                -1.197277e-01 1 1  ON 5
 uu_6                -1.485563e-01 1 1  ON 6
 uu_7                -1.637498e-01 1 1  ON 7
 uu_8                -1.561976e-01 1 1  ON 8
 uu_9                -1.292263e-01 1 1  ON 9
 ud_0                 4.555295e-01 1 1  ON 10
 ud_1                 1.901234e-01 1 1  ON 11
 ud_2                 7.054452e-02 1 1  ON 12
 ud_3                -3.232511e-04 1 1  ON 13
 ud_4                -5.812798e-02 1 1  ON 14
 ud_5                -1.007173e-01 1 1  ON 15
 ud_6                -1.296267e-01 1 1  ON 16
 ud_7                -1.477793e-01 1 1  ON 17
 ud_8                -1.501943e-01 1 1  ON 18
 ud_9                -1.418173e-01 1 1  ON 19
 eO_0                -7.054535e-01 1 1  ON 20
 eO_1                -3.855116e-01 1 1  ON 21
 eO_2                 2.819610e-02 1 1  ON 22
 eO_3                 3.439543e-01 1 1  ON 23
 eO_4                 5.683529e-01 1 1  ON 24
 eO_5                 5.255661e-01 1 1  ON 25
 eO_6                 2.820925e-01 1 1  ON 26
 eO_7                -6.502678e-02 1 1  ON 27
 eO_8                -3.286832e-01 1 1  ON 28
 eO_9                -2.251851e-01 1 1  ON 29
eH1_0                -2.920859e-01 1 1  ON 30
eH1_1                -1.886268e-01 1 1  ON 31
eH1_2                -1.402170e-01 1 1  ON 32
eH1_3                -8.506436e-02 1 1  ON 33
eH1_4                -3.491430e-02 1 1  ON 34
eH1_5                 4.682722e-03 1 1  ON 35
eH1_6                 7.310047e-02 1 1  ON 36
eH1_7                 1.571200e-01 1 1  ON 37
eH1_8                 2.279270e-01 1 1  ON 38
eH1_9                 2.110405e-01 1 1  ON 39
eH2_0                -2.901515e-01 1 1  ON 40
eH2_1                -1.870482e-01 1 1  ON 41
eH2_2                -1.384662e-01 1 1  ON 42
eH2_3                -8.320302e-02 1 1  ON 43
eH2_4                -3.314000e-02 1 1  ON 44
eH2_5                 5.782293e-03 1 1  ON 45
eH2_6                 7.507354e-02 1 1  ON 46
eH2_7                 1.570748e-01 1 1  ON 47
eH2_8                 2.243954e-01 1 1  ON 48
eH2_9                 2.362749e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.965
    reference variance = 0.269826
====================================================
  Execution time = 2.0744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4253e-01
  Total weights = 2.0000e+06
  Execution time = 1.8999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342496886519
                                         uncertainty =       0.005296485418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342496886519
                                         uncertainty =       0.005296485418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413841583
  error estimate for blocks of size 2^( 2) =       0.000426287559
  error estimate for blocks of size 2^( 3) =       0.000438901857
  error estimate for blocks of size 2^( 4) =       0.000450832183
  error estimate for blocks of size 2^( 5) =       0.000460588963
  error estimate for blocks of size 2^( 6) =       0.000467766177
  error estimate for blocks of size 2^( 7) =       0.000474104241

      target function =                  N/A
              le_mean =     -16.906402279413
             les_mean =     286.168967572894
             stat err =       0.000463322891
             autocorr =       1.253427626884
              std dev =       0.585260378655
             le_variance =       0.342529710823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485961266
                                         uncertainty =       0.005296042220

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342485961266
                                         uncertainty =       0.005296042220

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413834980
  error estimate for blocks of size 2^( 2) =       0.000426281149
  error estimate for blocks of size 2^( 3) =       0.000438895519
  error estimate for blocks of size 2^( 4) =       0.000450826136
  error estimate for blocks of size 2^( 5) =       0.000460582853
  error estimate for blocks of size 2^( 6) =       0.000467759805
  error estimate for blocks of size 2^( 7) =       0.000474098153

      target function =                  N/A
              le_mean =     -16.906402304974
             les_mean =     286.168957507504
             stat err =       0.000463316737
             autocorr =       1.253434325474
              std dev =       0.585251041121
             le_variance =       0.342518781133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342491175569
                                         uncertainty =       0.005296253844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342491175569
                                         uncertainty =       0.005296253844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413838131
  error estimate for blocks of size 2^( 2) =       0.000426284208
  error estimate for blocks of size 2^( 3) =       0.000438898543
  error estimate for blocks of size 2^( 4) =       0.000450829020
  error estimate for blocks of size 2^( 5) =       0.000460585767
  error estimate for blocks of size 2^( 6) =       0.000467762846
  error estimate for blocks of size 2^( 7) =       0.000474101060

      target function =                  N/A
              le_mean =     -16.906402291791
             les_mean =     286.168962278156
             stat err =       0.000463319673
             autocorr =       1.253431125229
              std dev =       0.585255497659
             le_variance =       0.342523997540

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342496164227
                                         uncertainty =       0.005296456145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342496164227
                                         uncertainty =       0.005296456145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413841146
  error estimate for blocks of size 2^( 2) =       0.000426287136
  error estimate for blocks of size 2^( 3) =       0.000438901438
  error estimate for blocks of size 2^( 4) =       0.000450831783
  error estimate for blocks of size 2^( 5) =       0.000460588559
  error estimate for blocks of size 2^( 6) =       0.000467765755
  error estimate for blocks of size 2^( 7) =       0.000474103839

      target function =                  N/A
              le_mean =     -16.906402280919
             les_mean =     286.168966901235
             stat err =       0.000463322484
             autocorr =       1.253428069124
              std dev =       0.585259761333
             le_variance =       0.342528988236


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906402279413        initial
     9.0949e+00     9.0949e+01             2.0152e-05       -16.906402304974  <--
     3.6380e+01     3.6380e+02             5.1067e-06       -16.906402291791
     1.4552e+02     1.4552e+03             1.2811e-06       -16.906402280919

*****************************************************************************
Applying the update for shift_i =   9.0949e+00     and shift_s =   9.0949e+01
*****************************************************************************

  Execution time = 3.0286e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.942873e-01 1 1  ON 0
 uu_1                 1.270289e-01 1 1  ON 1
 uu_2                 2.527540e-02 1 1  ON 2
 uu_3                -3.750678e-02 1 1  ON 3
 uu_4                -8.370525e-02 1 1  ON 4
 uu_5                -1.197310e-01 1 1  ON 5
 uu_6                -1.485413e-01 1 1  ON 6
 uu_7                -1.637528e-01 1 1  ON 7
 uu_8                -1.561999e-01 1 1  ON 8
 uu_9                -1.292256e-01 1 1  ON 9
 ud_0                 4.555235e-01 1 1  ON 10
 ud_1                 1.901325e-01 1 1  ON 11
 ud_2                 7.054380e-02 1 1  ON 12
 ud_3                -3.185164e-04 1 1  ON 13
 ud_4                -5.812654e-02 1 1  ON 14
 ud_5                -1.007195e-01 1 1  ON 15
 ud_6                -1.296301e-01 1 1  ON 16
 ud_7                -1.477780e-01 1 1  ON 17
 ud_8                -1.501920e-01 1 1  ON 18
 ud_9                -1.418150e-01 1 1  ON 19
 eO_0                -7.054635e-01 1 1  ON 20
 eO_1                -3.855117e-01 1 1  ON 21
 eO_2                 2.820418e-02 1 1  ON 22
 eO_3                 3.439570e-01 1 1  ON 23
 eO_4                 5.683604e-01 1 1  ON 24
 eO_5                 5.255704e-01 1 1  ON 25
 eO_6                 2.820899e-01 1 1  ON 26
 eO_7                -6.502500e-02 1 1  ON 27
 eO_8                -3.286863e-01 1 1  ON 28
 eO_9                -2.251917e-01 1 1  ON 29
eH1_0                -2.920931e-01 1 1  ON 30
eH1_1                -1.886311e-01 1 1  ON 31
eH1_2                -1.402230e-01 1 1  ON 32
eH1_3                -8.506457e-02 1 1  ON 33
eH1_4                -3.491397e-02 1 1  ON 34
eH1_5                 4.678747e-03 1 1  ON 35
eH1_6                 7.311065e-02 1 1  ON 36
eH1_7                 1.571261e-01 1 1  ON 37
eH1_8                 2.279256e-01 1 1  ON 38
eH1_9                 2.110430e-01 1 1  ON 39
eH2_0                -2.901567e-01 1 1  ON 40
eH2_1                -1.870481e-01 1 1  ON 41
eH2_2                -1.384680e-01 1 1  ON 42
eH2_3                -8.320202e-02 1 1  ON 43
eH2_4                -3.314219e-02 1 1  ON 44
eH2_5                 5.779121e-03 1 1  ON 45
eH2_6                 7.507128e-02 1 1  ON 46
eH2_7                 1.570734e-01 1 1  ON 47
eH2_8                 2.243997e-01 1 1  ON 48
eH2_9                 2.362807e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6383e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8605
    reference variance = 0.142038
====================================================
  Execution time = 2.2471e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3569e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335652873925
                                         uncertainty =       0.003585658941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335652873925
                                         uncertainty =       0.003585658941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409687200
  error estimate for blocks of size 2^( 2) =       0.000422400423
  error estimate for blocks of size 2^( 3) =       0.000436248639
  error estimate for blocks of size 2^( 4) =       0.000447904099
  error estimate for blocks of size 2^( 5) =       0.000458043591
  error estimate for blocks of size 2^( 6) =       0.000463767293
  error estimate for blocks of size 2^( 7) =       0.000468110938

      target function =                  N/A
              le_mean =     -16.906157479339
             les_mean =     286.153847752444
             stat err =       0.000459456480
             autocorr =       1.257720013209
              std dev =       0.579385194920
             le_variance =       0.335687204093


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690615747934e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157479339       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906157522535       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157685296       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906157633622       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906157779971       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906157828769       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906157796693       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+00 is 6.560165e-05

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157479339       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906157491046       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157536298       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906157523000       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906157561547       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906157575875       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906157568307       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 1.717689e-05

solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906157479339       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906157482328       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906157493976       residual = 4.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906157490636       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906157500411       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906157504138       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906157502319       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 4.343697e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7952e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.942796e-01 1 1  ON 0
 uu_1                 1.270295e-01 1 1  ON 1
 uu_2                 2.527078e-02 1 1  ON 2
 uu_3                -3.751331e-02 1 1  ON 3
 uu_4                -8.371296e-02 1 1  ON 4
 uu_5                -1.197203e-01 1 1  ON 5
 uu_6                -1.485333e-01 1 1  ON 6
 uu_7                -1.637584e-01 1 1  ON 7
 uu_8                -1.561979e-01 1 1  ON 8
 uu_9                -1.292212e-01 1 1  ON 9
 ud_0                 4.555258e-01 1 1  ON 10
 ud_1                 1.901307e-01 1 1  ON 11
 ud_2                 7.054980e-02 1 1  ON 12
 ud_3                -3.226052e-04 1 1  ON 13
 ud_4                -5.811708e-02 1 1  ON 14
 ud_5                -1.007254e-01 1 1  ON 15
 ud_6                -1.296328e-01 1 1  ON 16
 ud_7                -1.477855e-01 1 1  ON 17
 ud_8                -1.501909e-01 1 1  ON 18
 ud_9                -1.418108e-01 1 1  ON 19
 eO_0                -7.054670e-01 1 1  ON 20
 eO_1                -3.855075e-01 1 1  ON 21
 eO_2                 2.822135e-02 1 1  ON 22
 eO_3                 3.439490e-01 1 1  ON 23
 eO_4                 5.683676e-01 1 1  ON 24
 eO_5                 5.255761e-01 1 1  ON 25
 eO_6                 2.820825e-01 1 1  ON 26
 eO_7                -6.502810e-02 1 1  ON 27
 eO_8                -3.286889e-01 1 1  ON 28
 eO_9                -2.251997e-01 1 1  ON 29
eH1_0                -2.921067e-01 1 1  ON 30
eH1_1                -1.886339e-01 1 1  ON 31
eH1_2                -1.402175e-01 1 1  ON 32
eH1_3                -8.506094e-02 1 1  ON 33
eH1_4                -3.491105e-02 1 1  ON 34
eH1_5                 4.671754e-03 1 1  ON 35
eH1_6                 7.311204e-02 1 1  ON 36
eH1_7                 1.571243e-01 1 1  ON 37
eH1_8                 2.279247e-01 1 1  ON 38
eH1_9                 2.110514e-01 1 1  ON 39
eH2_0                -2.901672e-01 1 1  ON 40
eH2_1                -1.870436e-01 1 1  ON 41
eH2_2                -1.384732e-01 1 1  ON 42
eH2_3                -8.319661e-02 1 1  ON 43
eH2_4                -3.314544e-02 1 1  ON 44
eH2_5                 5.767774e-03 1 1  ON 45
eH2_6                 7.506915e-02 1 1  ON 46
eH2_7                 1.570839e-01 1 1  ON 47
eH2_8                 2.244027e-01 1 1  ON 48
eH2_9                 2.362844e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.835
    reference variance = 0.30008
====================================================
  Execution time = 2.0951e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4174e-01
  Total weights = 2.0000e+06
  Execution time = 1.9323e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341758255468
                                         uncertainty =       0.003375965437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341758255468
                                         uncertainty =       0.003375965437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413363374
  error estimate for blocks of size 2^( 2) =       0.000425686158
  error estimate for blocks of size 2^( 3) =       0.000438908984
  error estimate for blocks of size 2^( 4) =       0.000451787285
  error estimate for blocks of size 2^( 5) =       0.000462884581
  error estimate for blocks of size 2^( 6) =       0.000470036745
  error estimate for blocks of size 2^( 7) =       0.000473749190

      target function =                  N/A
              le_mean =     -16.906306333175
             les_mean =     286.164932218562
             stat err =       0.000464614450
             autocorr =       1.263343466943
              std dev =       0.584584089992
             le_variance =       0.341738558271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341755416755
                                         uncertainty =       0.003376010194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341755416755
                                         uncertainty =       0.003376010194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413361672
  error estimate for blocks of size 2^( 2) =       0.000425684267
  error estimate for blocks of size 2^( 3) =       0.000438906910
  error estimate for blocks of size 2^( 4) =       0.000451785181
  error estimate for blocks of size 2^( 5) =       0.000462882472
  error estimate for blocks of size 2^( 6) =       0.000470034404
  error estimate for blocks of size 2^( 7) =       0.000473747422

      target function =                  N/A
              le_mean =     -16.906306688537
             les_mean =     286.164941419088
             stat err =       0.000464612370
             autocorr =       1.263342559322
              std dev =       0.584581682145
             le_variance =       0.341735743100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341756271812
                                         uncertainty =       0.003375986613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341756271812
                                         uncertainty =       0.003375986613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413362183
  error estimate for blocks of size 2^( 2) =       0.000425684878
  error estimate for blocks of size 2^( 3) =       0.000438907599
  error estimate for blocks of size 2^( 4) =       0.000451785893
  error estimate for blocks of size 2^( 5) =       0.000462883178
  error estimate for blocks of size 2^( 6) =       0.000470035163
  error estimate for blocks of size 2^( 7) =       0.000473747931

      target function =                  N/A
              le_mean =     -16.906306520579
             les_mean =     286.164936586102
             stat err =       0.000464613041
             autocorr =       1.263343084027
              std dev =       0.584582405816
             le_variance =       0.341736589189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757981344
                                         uncertainty =       0.003375968045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757981344
                                         uncertainty =       0.003375968045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413363210
  error estimate for blocks of size 2^( 2) =       0.000425685982
  error estimate for blocks of size 2^( 3) =       0.000438908795
  error estimate for blocks of size 2^( 4) =       0.000451787096
  error estimate for blocks of size 2^( 5) =       0.000462884389
  error estimate for blocks of size 2^( 6) =       0.000470036529
  error estimate for blocks of size 2^( 7) =       0.000473749016

      target function =                  N/A
              le_mean =     -16.906306356560
             les_mean =     286.164932737062
             stat err =       0.000464614257
             autocorr =       1.263343422909
              std dev =       0.584583857182
             le_variance =       0.341738286078


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906306333175        initial
     2.2737e+00     2.2737e+01             6.5602e-05       -16.906306688537  <--
     9.0949e+00     9.0949e+01             1.7177e-05       -16.906306520579
     3.6380e+01     3.6380e+02             4.3437e-06       -16.906306356560

*****************************************************************************
Applying the update for shift_i =   2.2737e+00     and shift_s =   2.2737e+01
*****************************************************************************

  Execution time = 3.0466e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.942586e-01 1 1  ON 0
 uu_1                 1.270295e-01 1 1  ON 1
 uu_2                 2.525690e-02 1 1  ON 2
 uu_3                -3.753227e-02 1 1  ON 3
 uu_4                -8.373299e-02 1 1  ON 4
 uu_5                -1.196917e-01 1 1  ON 5
 uu_6                -1.485099e-01 1 1  ON 6
 uu_7                -1.637738e-01 1 1  ON 7
 uu_8                -1.561923e-01 1 1  ON 8
 uu_9                -1.292085e-01 1 1  ON 9
 ud_0                 4.555326e-01 1 1  ON 10
 ud_1                 1.901278e-01 1 1  ON 11
 ud_2                 7.056408e-02 1 1  ON 12
 ud_3                -3.308947e-04 1 1  ON 13
 ud_4                -5.809374e-02 1 1  ON 14
 ud_5                -1.007406e-01 1 1  ON 15
 ud_6                -1.296415e-01 1 1  ON 16
 ud_7                -1.478070e-01 1 1  ON 17
 ud_8                -1.501880e-01 1 1  ON 18
 ud_9                -1.417989e-01 1 1  ON 19
 eO_0                -7.054755e-01 1 1  ON 20
 eO_1                -3.854959e-01 1 1  ON 21
 eO_2                 2.826978e-02 1 1  ON 22
 eO_3                 3.439262e-01 1 1  ON 23
 eO_4                 5.683884e-01 1 1  ON 24
 eO_5                 5.255932e-01 1 1  ON 25
 eO_6                 2.820612e-01 1 1  ON 26
 eO_7                -6.503709e-02 1 1  ON 27
 eO_8                -3.286963e-01 1 1  ON 28
 eO_9                -2.252227e-01 1 1  ON 29
eH1_0                -2.921461e-01 1 1  ON 30
eH1_1                -1.886408e-01 1 1  ON 31
eH1_2                -1.402016e-01 1 1  ON 32
eH1_3                -8.505122e-02 1 1  ON 33
eH1_4                -3.490230e-02 1 1  ON 34
eH1_5                 4.651575e-03 1 1  ON 35
eH1_6                 7.311576e-02 1 1  ON 36
eH1_7                 1.571190e-01 1 1  ON 37
eH1_8                 2.279220e-01 1 1  ON 38
eH1_9                 2.110755e-01 1 1  ON 39
eH2_0                -2.901973e-01 1 1  ON 40
eH2_1                -1.870318e-01 1 1  ON 41
eH2_2                -1.384857e-01 1 1  ON 42
eH2_3                -8.318242e-02 1 1  ON 43
eH2_4                -3.315450e-02 1 1  ON 44
eH2_5                 5.734697e-03 1 1  ON 45
eH2_6                 7.506293e-02 1 1  ON 46
eH2_7                 1.571144e-01 1 1  ON 47
eH2_8                 2.244116e-01 1 1  ON 48
eH2_9                 2.362951e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9192
    reference variance = 0.345435
====================================================
  Execution time = 2.0311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3666e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336764370037
                                         uncertainty =       0.004188014460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336764370037
                                         uncertainty =       0.004188014460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410282723
  error estimate for blocks of size 2^( 2) =       0.000423003722
  error estimate for blocks of size 2^( 3) =       0.000435841390
  error estimate for blocks of size 2^( 4) =       0.000448006933
  error estimate for blocks of size 2^( 5) =       0.000458581819
  error estimate for blocks of size 2^( 6) =       0.000464653458
  error estimate for blocks of size 2^( 7) =       0.000466405535

      target function =                  N/A
              le_mean =     -16.906488896605
             les_mean =     286.166030469011
             stat err =       0.000459411936
             autocorr =       1.253828364166
              std dev =       0.580227391898
             le_variance =       0.336663826309


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648889661e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e-01, overlap shift 5.6843e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906488896605       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906488672035       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906489078693       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906489465091       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906489225364       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906488994612       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906489043660       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906488989465       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906488987251       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e-01 is 2.578182e-04

solving harmonic davidson linear method for identity shift 2.2737e+00, overlap shift 2.2737e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906488896605       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906488828941       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906488971898       residual = 7.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906489082508       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906489076769       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906489014439       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906488991314       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906488969619       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+00 is 6.454012e-05

solving harmonic davidson linear method for identity shift 9.0949e+00, overlap shift 9.0949e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906488896605       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906488878774       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906488918354       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906488947361       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906488951166       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906488937069       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906488929302       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906488922659       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+00 is 1.638931e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140666 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6045e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.943189e-01 1 1  ON 0
 uu_1                 1.270433e-01 1 1  ON 1
 uu_2                 2.527450e-02 1 1  ON 2
 uu_3                -3.752536e-02 1 1  ON 3
 uu_4                -8.375848e-02 1 1  ON 4
 uu_5                -1.196944e-01 1 1  ON 5
 uu_6                -1.484709e-01 1 1  ON 6
 uu_7                -1.637936e-01 1 1  ON 7
 uu_8                -1.562403e-01 1 1  ON 8
 uu_9                -1.292581e-01 1 1  ON 9
 ud_0                 4.555886e-01 1 1  ON 10
 ud_1                 1.901551e-01 1 1  ON 11
 ud_2                 7.056644e-02 1 1  ON 12
 ud_3                -3.248688e-04 1 1  ON 13
 ud_4                -5.809247e-02 1 1  ON 14
 ud_5                -1.007564e-01 1 1  ON 15
 ud_6                -1.295879e-01 1 1  ON 16
 ud_7                -1.478287e-01 1 1  ON 17
 ud_8                -1.502182e-01 1 1  ON 18
 ud_9                -1.418418e-01 1 1  ON 19
 eO_0                -7.054705e-01 1 1  ON 20
 eO_1                -3.855207e-01 1 1  ON 21
 eO_2                 2.831979e-02 1 1  ON 22
 eO_3                 3.439660e-01 1 1  ON 23
 eO_4                 5.684238e-01 1 1  ON 24
 eO_5                 5.255916e-01 1 1  ON 25
 eO_6                 2.820942e-01 1 1  ON 26
 eO_7                -6.503836e-02 1 1  ON 27
 eO_8                -3.287608e-01 1 1  ON 28
 eO_9                -2.252772e-01 1 1  ON 29
eH1_0                -2.921462e-01 1 1  ON 30
eH1_1                -1.886334e-01 1 1  ON 31
eH1_2                -1.402285e-01 1 1  ON 32
eH1_3                -8.508495e-02 1 1  ON 33
eH1_4                -3.488618e-02 1 1  ON 34
eH1_5                 4.660425e-03 1 1  ON 35
eH1_6                 7.311357e-02 1 1  ON 36
eH1_7                 1.571329e-01 1 1  ON 37
eH1_8                 2.279113e-01 1 1  ON 38
eH1_9                 2.110952e-01 1 1  ON 39
eH2_0                -2.902517e-01 1 1  ON 40
eH2_1                -1.870689e-01 1 1  ON 41
eH2_2                -1.384873e-01 1 1  ON 42
eH2_3                -8.314502e-02 1 1  ON 43
eH2_4                -3.316246e-02 1 1  ON 44
eH2_5                 5.744042e-03 1 1  ON 45
eH2_6                 7.507137e-02 1 1  ON 46
eH2_7                 1.571276e-01 1 1  ON 47
eH2_8                 2.244171e-01 1 1  ON 48
eH2_9                 2.362997e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8856
    reference variance = 0.226351
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3395e-01
  Total weights = 2.0000e+06
  Execution time = 1.8874e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334022663952
                                         uncertainty =       0.003487627062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334022663952
                                         uncertainty =       0.003487627062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408594219
  error estimate for blocks of size 2^( 2) =       0.000421000678
  error estimate for blocks of size 2^( 3) =       0.000433882160
  error estimate for blocks of size 2^( 4) =       0.000446263090
  error estimate for blocks of size 2^( 5) =       0.000456057035
  error estimate for blocks of size 2^( 6) =       0.000462559029
  error estimate for blocks of size 2^( 7) =       0.000469907797

      target function =                  N/A
              le_mean =     -16.906011143485
             les_mean =     286.147111088613
             stat err =       0.000458696737
             autocorr =       1.260279484108
              std dev =       0.577839486285
             le_variance =       0.333898471910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334171257901
                                         uncertainty =       0.003490217299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334171257901
                                         uncertainty =       0.003490217299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408685127
  error estimate for blocks of size 2^( 2) =       0.000421086089
  error estimate for blocks of size 2^( 3) =       0.000433961324
  error estimate for blocks of size 2^( 4) =       0.000446338538
  error estimate for blocks of size 2^( 5) =       0.000456130864
  error estimate for blocks of size 2^( 6) =       0.000462630900
  error estimate for blocks of size 2^( 7) =       0.000469977958

      target function =                  N/A
              le_mean =     -16.906010989290
             les_mean =     286.147254468667
             stat err =       0.000458769565
             autocorr =       1.260118920080
              std dev =       0.577968049031
             le_variance =       0.334047065701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119574786
                                         uncertainty =       0.003489322699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119574786
                                         uncertainty =       0.003489322699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408653509
  error estimate for blocks of size 2^( 2) =       0.000421056500
  error estimate for blocks of size 2^( 3) =       0.000433934029
  error estimate for blocks of size 2^( 4) =       0.000446312675
  error estimate for blocks of size 2^( 5) =       0.000456105623
  error estimate for blocks of size 2^( 6) =       0.000462606403
  error estimate for blocks of size 2^( 7) =       0.000469953946

      target function =                  N/A
              le_mean =     -16.906010889650
             les_mean =     286.147199414268
             stat err =       0.000458744662
             autocorr =       1.260177099264
              std dev =       0.577923334284
             le_variance =       0.333995380310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334035802893
                                         uncertainty =       0.003487857181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334035802893
                                         uncertainty =       0.003487857181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408602258
  error estimate for blocks of size 2^( 2) =       0.000421008241
  error estimate for blocks of size 2^( 3) =       0.000433889180
  error estimate for blocks of size 2^( 4) =       0.000446269797
  error estimate for blocks of size 2^( 5) =       0.000456063602
  error estimate for blocks of size 2^( 6) =       0.000462565440
  error estimate for blocks of size 2^( 7) =       0.000469914034

      target function =                  N/A
              le_mean =     -16.906011097210
             les_mean =     286.147122662243
             stat err =       0.000458703218
             autocorr =       1.260265506670
              std dev =       0.577850854656
             le_variance =       0.333911610227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906011143485        initial  <--
     5.6843e-01     5.6843e+00             2.5782e-04       -16.906010989290
     2.2737e+00     2.2737e+01             6.4540e-05       -16.906010889650
     9.0949e+00     9.0949e+01             1.6389e-05       -16.906011097210

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8224
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.942586e-01 1 1  ON 0
 uu_1                 1.270295e-01 1 1  ON 1
 uu_2                 2.525690e-02 1 1  ON 2
 uu_3                -3.753227e-02 1 1  ON 3
 uu_4                -8.373299e-02 1 1  ON 4
 uu_5                -1.196917e-01 1 1  ON 5
 uu_6                -1.485099e-01 1 1  ON 6
 uu_7                -1.637738e-01 1 1  ON 7
 uu_8                -1.561923e-01 1 1  ON 8
 uu_9                -1.292085e-01 1 1  ON 9
 ud_0                 4.555326e-01 1 1  ON 10
 ud_1                 1.901278e-01 1 1  ON 11
 ud_2                 7.056408e-02 1 1  ON 12
 ud_3                -3.308947e-04 1 1  ON 13
 ud_4                -5.809374e-02 1 1  ON 14
 ud_5                -1.007406e-01 1 1  ON 15
 ud_6                -1.296415e-01 1 1  ON 16
 ud_7                -1.478070e-01 1 1  ON 17
 ud_8                -1.501880e-01 1 1  ON 18
 ud_9                -1.417989e-01 1 1  ON 19
 eO_0                -7.054755e-01 1 1  ON 20
 eO_1                -3.854959e-01 1 1  ON 21
 eO_2                 2.826978e-02 1 1  ON 22
 eO_3                 3.439262e-01 1 1  ON 23
 eO_4                 5.683884e-01 1 1  ON 24
 eO_5                 5.255932e-01 1 1  ON 25
 eO_6                 2.820612e-01 1 1  ON 26
 eO_7                -6.503709e-02 1 1  ON 27
 eO_8                -3.286963e-01 1 1  ON 28
 eO_9                -2.252227e-01 1 1  ON 29
eH1_0                -2.921461e-01 1 1  ON 30
eH1_1                -1.886408e-01 1 1  ON 31
eH1_2                -1.402016e-01 1 1  ON 32
eH1_3                -8.505122e-02 1 1  ON 33
eH1_4                -3.490230e-02 1 1  ON 34
eH1_5                 4.651575e-03 1 1  ON 35
eH1_6                 7.311576e-02 1 1  ON 36
eH1_7                 1.571190e-01 1 1  ON 37
eH1_8                 2.279220e-01 1 1  ON 38
eH1_9                 2.110755e-01 1 1  ON 39
eH2_0                -2.901973e-01 1 1  ON 40
eH2_1                -1.870318e-01 1 1  ON 41
eH2_2                -1.384857e-01 1 1  ON 42
eH2_3                -8.318242e-02 1 1  ON 43
eH2_4                -3.315450e-02 1 1  ON 44
eH2_5                 5.734697e-03 1 1  ON 45
eH2_6                 7.506293e-02 1 1  ON 46
eH2_7                 1.571144e-01 1 1  ON 47
eH2_8                 2.244116e-01 1 1  ON 48
eH2_9                 2.362951e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5874e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8643
    reference variance = 0.355423
====================================================
  Execution time = 2.0788e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4254e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5324e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342481237035
                                         uncertainty =       0.004635143927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342481237035
                                         uncertainty =       0.004635143927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413845143
  error estimate for blocks of size 2^( 2) =       0.000426682139
  error estimate for blocks of size 2^( 3) =       0.000439623533
  error estimate for blocks of size 2^( 4) =       0.000451991235
  error estimate for blocks of size 2^( 5) =       0.000463721161
  error estimate for blocks of size 2^( 6) =       0.000472201105
  error estimate for blocks of size 2^( 7) =       0.000479823540

      target function =                  N/A
              le_mean =     -16.905956458111
             les_mean =     286.153899197472
             stat err =       0.000466934260
             autocorr =       1.273021548206
              std dev =       0.585265414309
             le_variance =       0.342535605186


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595645811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905956458111       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905956416247       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905956394239       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905956355231       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905956364722       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905956394246       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905956382099       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905956378083       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+00 is 2.477585e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905956458111       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905956447343       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905956441592       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905956431251       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905956432545       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905956439593       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905956436558       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905956435373       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 6.343293e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905956458111       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905956455400       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905956453945       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905956451322       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905956451571       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905956453307       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905956452546       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905956452238       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 1.595473e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6327e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.942559e-01 1 1  ON 0
 uu_1                 1.270322e-01 1 1  ON 1
 uu_2                 2.526284e-02 1 1  ON 2
 uu_3                -3.753260e-02 1 1  ON 3
 uu_4                -8.373070e-02 1 1  ON 4
 uu_5                -1.196927e-01 1 1  ON 5
 uu_6                -1.485124e-01 1 1  ON 6
 uu_7                -1.637758e-01 1 1  ON 7
 uu_8                -1.561964e-01 1 1  ON 8
 uu_9                -1.292101e-01 1 1  ON 9
 ud_0                 4.555324e-01 1 1  ON 10
 ud_1                 1.901300e-01 1 1  ON 11
 ud_2                 7.056621e-02 1 1  ON 12
 ud_3                -3.315490e-04 1 1  ON 13
 ud_4                -5.809572e-02 1 1  ON 14
 ud_5                -1.007389e-01 1 1  ON 15
 ud_6                -1.296361e-01 1 1  ON 16
 ud_7                -1.478056e-01 1 1  ON 17
 ud_8                -1.501897e-01 1 1  ON 18
 ud_9                -1.418014e-01 1 1  ON 19
 eO_0                -7.054727e-01 1 1  ON 20
 eO_1                -3.854996e-01 1 1  ON 21
 eO_2                 2.827242e-02 1 1  ON 22
 eO_3                 3.439301e-01 1 1  ON 23
 eO_4                 5.683920e-01 1 1  ON 24
 eO_5                 5.255943e-01 1 1  ON 25
 eO_6                 2.820611e-01 1 1  ON 26
 eO_7                -6.503682e-02 1 1  ON 27
 eO_8                -3.287007e-01 1 1  ON 28
 eO_9                -2.252278e-01 1 1  ON 29
eH1_0                -2.921509e-01 1 1  ON 30
eH1_1                -1.886441e-01 1 1  ON 31
eH1_2                -1.402031e-01 1 1  ON 32
eH1_3                -8.504995e-02 1 1  ON 33
eH1_4                -3.489951e-02 1 1  ON 34
eH1_5                 4.650668e-03 1 1  ON 35
eH1_6                 7.311483e-02 1 1  ON 36
eH1_7                 1.571201e-01 1 1  ON 37
eH1_8                 2.279235e-01 1 1  ON 38
eH1_9                 2.110783e-01 1 1  ON 39
eH2_0                -2.902021e-01 1 1  ON 40
eH2_1                -1.870382e-01 1 1  ON 41
eH2_2                -1.384870e-01 1 1  ON 42
eH2_3                -8.317966e-02 1 1  ON 43
eH2_4                -3.314833e-02 1 1  ON 44
eH2_5                 5.735207e-03 1 1  ON 45
eH2_6                 7.506086e-02 1 1  ON 46
eH2_7                 1.571164e-01 1 1  ON 47
eH2_8                 2.244118e-01 1 1  ON 48
eH2_9                 2.362958e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9063
    reference variance = 0.175863
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3701e-01
  Total weights = 2.0000e+06
  Execution time = 1.8916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337025434154
                                         uncertainty =       0.004260690928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337025434154
                                         uncertainty =       0.004260690928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410499444
  error estimate for blocks of size 2^( 2) =       0.000423067241
  error estimate for blocks of size 2^( 3) =       0.000436219462
  error estimate for blocks of size 2^( 4) =       0.000448502673
  error estimate for blocks of size 2^( 5) =       0.000459460390
  error estimate for blocks of size 2^( 6) =       0.000467015702
  error estimate for blocks of size 2^( 7) =       0.000471660985

      target function =                  N/A
              le_mean =     -16.906365939312
             les_mean =     286.162228692841
             stat err =       0.000461659938
             autocorr =       1.264792349606
              std dev =       0.580533881371
             le_variance =       0.337019587420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337008384785
                                         uncertainty =       0.004260618195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337008384785
                                         uncertainty =       0.004260618195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410489052
  error estimate for blocks of size 2^( 2) =       0.000423057151
  error estimate for blocks of size 2^( 3) =       0.000436209364
  error estimate for blocks of size 2^( 4) =       0.000448492700
  error estimate for blocks of size 2^( 5) =       0.000459450860
  error estimate for blocks of size 2^( 6) =       0.000467006417
  error estimate for blocks of size 2^( 7) =       0.000471652008

      target function =                  N/A
              le_mean =     -16.906365958859
             les_mean =     286.162212290362
             stat err =       0.000461650496
             autocorr =       1.264804654643
              std dev =       0.580519184872
             le_variance =       0.337002524005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337016349984
                                         uncertainty =       0.004260646677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337016349984
                                         uncertainty =       0.004260646677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410493908
  error estimate for blocks of size 2^( 2) =       0.000423061870
  error estimate for blocks of size 2^( 3) =       0.000436214091
  error estimate for blocks of size 2^( 4) =       0.000448497368
  error estimate for blocks of size 2^( 5) =       0.000459455315
  error estimate for blocks of size 2^( 6) =       0.000467010758
  error estimate for blocks of size 2^( 7) =       0.000471656207

      target function =                  N/A
              le_mean =     -16.906365949327
             les_mean =     286.162219940261
             stat err =       0.000461654912
             autocorr =       1.264798930755
              std dev =       0.580526051274
             le_variance =       0.337010496208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337024279470
                                         uncertainty =       0.004260685125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337024279470
                                         uncertainty =       0.004260685125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410498740
  error estimate for blocks of size 2^( 2) =       0.000423066558
  error estimate for blocks of size 2^( 3) =       0.000436218779
  error estimate for blocks of size 2^( 4) =       0.000448501999
  error estimate for blocks of size 2^( 5) =       0.000459459745
  error estimate for blocks of size 2^( 6) =       0.000467015074
  error estimate for blocks of size 2^( 7) =       0.000471660378

      target function =                  N/A
              le_mean =     -16.906365940508
             les_mean =     286.162227577730
             stat err =       0.000461659299
             autocorr =       1.264793186446
              std dev =       0.580532886110
             le_variance =       0.337018431855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906365939312        initial
     5.6843e+00     5.6843e+01             2.4776e-05       -16.906365958859  <--
     2.2737e+01     2.2737e+02             6.3433e-06       -16.906365949327
     9.0949e+01     9.0949e+02             1.5955e-06       -16.906365940508

*****************************************************************************
Applying the update for shift_i =   5.6843e+00     and shift_s =   5.6843e+01
*****************************************************************************

  Execution time = 2.9843e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.942483e-01 1 1  ON 0
 uu_1                 1.270409e-01 1 1  ON 1
 uu_2                 2.527951e-02 1 1  ON 2
 uu_3                -3.753289e-02 1 1  ON 3
 uu_4                -8.372452e-02 1 1  ON 4
 uu_5                -1.196955e-01 1 1  ON 5
 uu_6                -1.485197e-01 1 1  ON 6
 uu_7                -1.637818e-01 1 1  ON 7
 uu_8                -1.562089e-01 1 1  ON 8
 uu_9                -1.292150e-01 1 1  ON 9
 ud_0                 4.555324e-01 1 1  ON 10
 ud_1                 1.901365e-01 1 1  ON 11
 ud_2                 7.057231e-02 1 1  ON 12
 ud_3                -3.333972e-04 1 1  ON 13
 ud_4                -5.810129e-02 1 1  ON 14
 ud_5                -1.007341e-01 1 1  ON 15
 ud_6                -1.296201e-01 1 1  ON 16
 ud_7                -1.478015e-01 1 1  ON 17
 ud_8                -1.501949e-01 1 1  ON 18
 ud_9                -1.418087e-01 1 1  ON 19
 eO_0                -7.054646e-01 1 1  ON 20
 eO_1                -3.855100e-01 1 1  ON 21
 eO_2                 2.828023e-02 1 1  ON 22
 eO_3                 3.439416e-01 1 1  ON 23
 eO_4                 5.684029e-01 1 1  ON 24
 eO_5                 5.255975e-01 1 1  ON 25
 eO_6                 2.820607e-01 1 1  ON 26
 eO_7                -6.503601e-02 1 1  ON 27
 eO_8                -3.287140e-01 1 1  ON 28
 eO_9                -2.252430e-01 1 1  ON 29
eH1_0                -2.921654e-01 1 1  ON 30
eH1_1                -1.886537e-01 1 1  ON 31
eH1_2                -1.402076e-01 1 1  ON 32
eH1_3                -8.504630e-02 1 1  ON 33
eH1_4                -3.489134e-02 1 1  ON 34
eH1_5                 4.648015e-03 1 1  ON 35
eH1_6                 7.311207e-02 1 1  ON 36
eH1_7                 1.571232e-01 1 1  ON 37
eH1_8                 2.279282e-01 1 1  ON 38
eH1_9                 2.110864e-01 1 1  ON 39
eH2_0                -2.902164e-01 1 1  ON 40
eH2_1                -1.870566e-01 1 1  ON 41
eH2_2                -1.384909e-01 1 1  ON 42
eH2_3                -8.317159e-02 1 1  ON 43
eH2_4                -3.313013e-02 1 1  ON 44
eH2_5                 5.736791e-03 1 1  ON 45
eH2_6                 7.505468e-02 1 1  ON 46
eH2_7                 1.571222e-01 1 1  ON 47
eH2_8                 2.244124e-01 1 1  ON 48
eH2_9                 2.362979e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9512
    reference variance = 0.199598
====================================================
  Execution time = 2.0526e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3686e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336879567335
                                         uncertainty =       0.004080214791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336879567335
                                         uncertainty =       0.004080214791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410399484
  error estimate for blocks of size 2^( 2) =       0.000423350049
  error estimate for blocks of size 2^( 3) =       0.000436094229
  error estimate for blocks of size 2^( 4) =       0.000447720022
  error estimate for blocks of size 2^( 5) =       0.000457466509
  error estimate for blocks of size 2^( 6) =       0.000464542924
  error estimate for blocks of size 2^( 7) =       0.000468984796

      target function =                  N/A
              le_mean =     -16.906361252279
             les_mean =     286.161906097319
             stat err =       0.000459678563
             autocorr =       1.254569973233
              std dev =       0.580392516483
             le_variance =       0.336855473189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636125228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+00, overlap shift 1.4211e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361252279       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361465303       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361655502       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361415833       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361418081       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361335970       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361394608       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361448080       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+00 is 8.474114e-05

solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361252279       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361309834       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361360700       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361295178       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361284708       residual = 7.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361266895       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361289836       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+00 is 2.391523e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906361252279       residual = 5.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906361266964       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906361279915       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906361263150       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361259629       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906361255404       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361261594       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 6.246923e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6006e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.942426e-01 1 1  ON 0
 uu_1                 1.270472e-01 1 1  ON 1
 uu_2                 2.529126e-02 1 1  ON 2
 uu_3                -3.753208e-02 1 1  ON 3
 uu_4                -8.371837e-02 1 1  ON 4
 uu_5                -1.196833e-01 1 1  ON 5
 uu_6                -1.485217e-01 1 1  ON 6
 uu_7                -1.637948e-01 1 1  ON 7
 uu_8                -1.562295e-01 1 1  ON 8
 uu_9                -1.292193e-01 1 1  ON 9
 ud_0                 4.555396e-01 1 1  ON 10
 ud_1                 1.901604e-01 1 1  ON 11
 ud_2                 7.057204e-02 1 1  ON 12
 ud_3                -3.221064e-04 1 1  ON 13
 ud_4                -5.810874e-02 1 1  ON 14
 ud_5                -1.007325e-01 1 1  ON 15
 ud_6                -1.296070e-01 1 1  ON 16
 ud_7                -1.477998e-01 1 1  ON 17
 ud_8                -1.502033e-01 1 1  ON 18
 ud_9                -1.418234e-01 1 1  ON 19
 eO_0                -7.054689e-01 1 1  ON 20
 eO_1                -3.854994e-01 1 1  ON 21
 eO_2                 2.829683e-02 1 1  ON 22
 eO_3                 3.439486e-01 1 1  ON 23
 eO_4                 5.684157e-01 1 1  ON 24
 eO_5                 5.255980e-01 1 1  ON 25
 eO_6                 2.820639e-01 1 1  ON 26
 eO_7                -6.504708e-02 1 1  ON 27
 eO_8                -3.287280e-01 1 1  ON 28
 eO_9                -2.252588e-01 1 1  ON 29
eH1_0                -2.921744e-01 1 1  ON 30
eH1_1                -1.886565e-01 1 1  ON 31
eH1_2                -1.402120e-01 1 1  ON 32
eH1_3                -8.503783e-02 1 1  ON 33
eH1_4                -3.490053e-02 1 1  ON 34
eH1_5                 4.649314e-03 1 1  ON 35
eH1_6                 7.311959e-02 1 1  ON 36
eH1_7                 1.571186e-01 1 1  ON 37
eH1_8                 2.279241e-01 1 1  ON 38
eH1_9                 2.110950e-01 1 1  ON 39
eH2_0                -2.902362e-01 1 1  ON 40
eH2_1                -1.870512e-01 1 1  ON 41
eH2_2                -1.385137e-01 1 1  ON 42
eH2_3                -8.318545e-02 1 1  ON 43
eH2_4                -3.313068e-02 1 1  ON 44
eH2_5                 5.730356e-03 1 1  ON 45
eH2_6                 7.506770e-02 1 1  ON 46
eH2_7                 1.571424e-01 1 1  ON 47
eH2_8                 2.244217e-01 1 1  ON 48
eH2_9                 2.363028e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9287
    reference variance = 0.238461
====================================================
  Execution time = 2.0237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4209e-01
  Total weights = 2.0000e+06
  Execution time = 1.8922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342004936035
                                         uncertainty =       0.004569972570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342004936035
                                         uncertainty =       0.004569972570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413575115
  error estimate for blocks of size 2^( 2) =       0.000426278229
  error estimate for blocks of size 2^( 3) =       0.000439180199
  error estimate for blocks of size 2^( 4) =       0.000450062962
  error estimate for blocks of size 2^( 5) =       0.000460461046
  error estimate for blocks of size 2^( 6) =       0.000468364429
  error estimate for blocks of size 2^( 7) =       0.000474893560

      target function =                  N/A
              le_mean =     -16.906430430132
             les_mean =     286.169478470045
             stat err =       0.000463445499
             autocorr =       1.255707645617
              std dev =       0.584883537288
             le_variance =       0.342088752190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342008036037
                                         uncertainty =       0.004569476045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342008036037
                                         uncertainty =       0.004569476045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413576987
  error estimate for blocks of size 2^( 2) =       0.000426278715
  error estimate for blocks of size 2^( 3) =       0.000439178768
  error estimate for blocks of size 2^( 4) =       0.000450059903
  error estimate for blocks of size 2^( 5) =       0.000460456891
  error estimate for blocks of size 2^( 6) =       0.000468359137
  error estimate for blocks of size 2^( 7) =       0.000474887194

      target function =                  N/A
              le_mean =     -16.906430379329
             les_mean =     286.169479847813
             stat err =       0.000463440781
             autocorr =       1.255670715371
              std dev =       0.584886183588
             le_variance =       0.342091847752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342002178153
                                         uncertainty =       0.004569582165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342002178153
                                         uncertainty =       0.004569582165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413573447
  error estimate for blocks of size 2^( 2) =       0.000426275850
  error estimate for blocks of size 2^( 3) =       0.000439176825
  error estimate for blocks of size 2^( 4) =       0.000450058696
  error estimate for blocks of size 2^( 5) =       0.000460456202
  error estimate for blocks of size 2^( 6) =       0.000468358924
  error estimate for blocks of size 2^( 7) =       0.000474887471

      target function =                  N/A
              le_mean =     -16.906430400919
             les_mean =     286.169474723029
             stat err =       0.000463440323
             autocorr =       1.255689725983
              std dev =       0.584881178488
             le_variance =       0.342085992949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342004450316
                                         uncertainty =       0.004569918175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342004450316
                                         uncertainty =       0.004569918175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413574822
  error estimate for blocks of size 2^( 2) =       0.000426277845
  error estimate for blocks of size 2^( 3) =       0.000439179689
  error estimate for blocks of size 2^( 4) =       0.000450062336
  error estimate for blocks of size 2^( 5) =       0.000460460346
  error estimate for blocks of size 2^( 6) =       0.000468363639
  error estimate for blocks of size 2^( 7) =       0.000474892694

      target function =                  N/A
              le_mean =     -16.906430425056
             les_mean =     286.169477812596
             stat err =       0.000463444754
             autocorr =       1.255705389694
              std dev =       0.584883121974
             le_variance =       0.342088266370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906430430132        initial  <--
     1.4211e+00     1.4211e+01             8.4741e-05       -16.906430379329
     5.6843e+00     5.6843e+01             2.3915e-05       -16.906430400919
     2.2737e+01     2.2737e+02             6.2469e-06       -16.906430425056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7468
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.942483e-01 1 1  ON 0
 uu_1                 1.270409e-01 1 1  ON 1
 uu_2                 2.527951e-02 1 1  ON 2
 uu_3                -3.753289e-02 1 1  ON 3
 uu_4                -8.372452e-02 1 1  ON 4
 uu_5                -1.196955e-01 1 1  ON 5
 uu_6                -1.485197e-01 1 1  ON 6
 uu_7                -1.637818e-01 1 1  ON 7
 uu_8                -1.562089e-01 1 1  ON 8
 uu_9                -1.292150e-01 1 1  ON 9
 ud_0                 4.555324e-01 1 1  ON 10
 ud_1                 1.901365e-01 1 1  ON 11
 ud_2                 7.057231e-02 1 1  ON 12
 ud_3                -3.333972e-04 1 1  ON 13
 ud_4                -5.810129e-02 1 1  ON 14
 ud_5                -1.007341e-01 1 1  ON 15
 ud_6                -1.296201e-01 1 1  ON 16
 ud_7                -1.478015e-01 1 1  ON 17
 ud_8                -1.501949e-01 1 1  ON 18
 ud_9                -1.418087e-01 1 1  ON 19
 eO_0                -7.054646e-01 1 1  ON 20
 eO_1                -3.855100e-01 1 1  ON 21
 eO_2                 2.828023e-02 1 1  ON 22
 eO_3                 3.439416e-01 1 1  ON 23
 eO_4                 5.684029e-01 1 1  ON 24
 eO_5                 5.255975e-01 1 1  ON 25
 eO_6                 2.820607e-01 1 1  ON 26
 eO_7                -6.503601e-02 1 1  ON 27
 eO_8                -3.287140e-01 1 1  ON 28
 eO_9                -2.252430e-01 1 1  ON 29
eH1_0                -2.921654e-01 1 1  ON 30
eH1_1                -1.886537e-01 1 1  ON 31
eH1_2                -1.402076e-01 1 1  ON 32
eH1_3                -8.504630e-02 1 1  ON 33
eH1_4                -3.489134e-02 1 1  ON 34
eH1_5                 4.648015e-03 1 1  ON 35
eH1_6                 7.311207e-02 1 1  ON 36
eH1_7                 1.571232e-01 1 1  ON 37
eH1_8                 2.279282e-01 1 1  ON 38
eH1_9                 2.110864e-01 1 1  ON 39
eH2_0                -2.902164e-01 1 1  ON 40
eH2_1                -1.870566e-01 1 1  ON 41
eH2_2                -1.384909e-01 1 1  ON 42
eH2_3                -8.317159e-02 1 1  ON 43
eH2_4                -3.313013e-02 1 1  ON 44
eH2_5                 5.736791e-03 1 1  ON 45
eH2_6                 7.505468e-02 1 1  ON 46
eH2_7                 1.571222e-01 1 1  ON 47
eH2_8                 2.244124e-01 1 1  ON 48
eH2_9                 2.362979e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5759e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6897e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8393
    reference variance = 0.183252
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336652385751
                                         uncertainty =       0.004669803424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336652385751
                                         uncertainty =       0.004669803424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410250205
  error estimate for blocks of size 2^( 2) =       0.000422926362
  error estimate for blocks of size 2^( 3) =       0.000435814049
  error estimate for blocks of size 2^( 4) =       0.000447783119
  error estimate for blocks of size 2^( 5) =       0.000456718925
  error estimate for blocks of size 2^( 6) =       0.000463141585
  error estimate for blocks of size 2^( 7) =       0.000468384647

      target function =                  N/A
              le_mean =     -16.906898963542
             les_mean =     286.179842856742
             stat err =       0.000459007069
             autocorr =       1.251817834169
              std dev =       0.580181404063
             le_variance =       0.336610461621


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690689896354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906898963542       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906898996194       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906898986689       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906898982139       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906898947884       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906898939344       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906898955877       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+01 is 1.268609e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906898963542       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906898971788       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906898969460       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906898968411       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906898959790       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906898957522       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906898961808       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+01 is 3.201514e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906898963542       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906898965609       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906898965030       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906898964773       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906898962615       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906898962039       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906898963120       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+02 is 8.022916e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6041e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.942484e-01 1 1  ON 0
 uu_1                 1.270416e-01 1 1  ON 1
 uu_2                 2.528093e-02 1 1  ON 2
 uu_3                -3.753209e-02 1 1  ON 3
 uu_4                -8.372447e-02 1 1  ON 4
 uu_5                -1.196963e-01 1 1  ON 5
 uu_6                -1.485165e-01 1 1  ON 6
 uu_7                -1.637833e-01 1 1  ON 7
 uu_8                -1.562115e-01 1 1  ON 8
 uu_9                -1.292166e-01 1 1  ON 9
 ud_0                 4.555307e-01 1 1  ON 10
 ud_1                 1.901383e-01 1 1  ON 11
 ud_2                 7.057259e-02 1 1  ON 12
 ud_3                -3.323823e-04 1 1  ON 13
 ud_4                -5.810131e-02 1 1  ON 14
 ud_5                -1.007336e-01 1 1  ON 15
 ud_6                -1.296194e-01 1 1  ON 16
 ud_7                -1.478008e-01 1 1  ON 17
 ud_8                -1.501945e-01 1 1  ON 18
 ud_9                -1.418095e-01 1 1  ON 19
 eO_0                -7.054646e-01 1 1  ON 20
 eO_1                -3.855083e-01 1 1  ON 21
 eO_2                 2.828199e-02 1 1  ON 22
 eO_3                 3.439406e-01 1 1  ON 23
 eO_4                 5.684043e-01 1 1  ON 24
 eO_5                 5.255982e-01 1 1  ON 25
 eO_6                 2.820607e-01 1 1  ON 26
 eO_7                -6.503627e-02 1 1  ON 27
 eO_8                -3.287157e-01 1 1  ON 28
 eO_9                -2.252449e-01 1 1  ON 29
eH1_0                -2.921681e-01 1 1  ON 30
eH1_1                -1.886519e-01 1 1  ON 31
eH1_2                -1.402080e-01 1 1  ON 32
eH1_3                -8.504665e-02 1 1  ON 33
eH1_4                -3.488991e-02 1 1  ON 34
eH1_5                 4.648751e-03 1 1  ON 35
eH1_6                 7.311239e-02 1 1  ON 36
eH1_7                 1.571221e-01 1 1  ON 37
eH1_8                 2.279272e-01 1 1  ON 38
eH1_9                 2.110870e-01 1 1  ON 39
eH2_0                -2.902183e-01 1 1  ON 40
eH2_1                -1.870556e-01 1 1  ON 41
eH2_2                -1.384931e-01 1 1  ON 42
eH2_3                -8.317264e-02 1 1  ON 43
eH2_4                -3.312874e-02 1 1  ON 44
eH2_5                 5.737564e-03 1 1  ON 45
eH2_6                 7.505468e-02 1 1  ON 46
eH2_7                 1.571234e-01 1 1  ON 47
eH2_8                 2.244126e-01 1 1  ON 48
eH2_9                 2.362980e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8602
    reference variance = 0.358479
====================================================
  Execution time = 2.0377e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3386e-01
  Total weights = 2.0000e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333835703415
                                         uncertainty =       0.003983216608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333835703415
                                         uncertainty =       0.003983216608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408569760
  error estimate for blocks of size 2^( 2) =       0.000421218686
  error estimate for blocks of size 2^( 3) =       0.000434781746
  error estimate for blocks of size 2^( 4) =       0.000447099207
  error estimate for blocks of size 2^( 5) =       0.000457931954
  error estimate for blocks of size 2^( 6) =       0.000466461995
  error estimate for blocks of size 2^( 7) =       0.000474498717

      target function =                  N/A
              le_mean =     -16.905306230946
             les_mean =     286.123237093422
             stat err =       0.000461497968
             autocorr =       1.275872116913
              std dev =       0.577804896399
             le_variance =       0.333858498303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333827143234
                                         uncertainty =       0.003983102443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333827143234
                                         uncertainty =       0.003983102443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408564520
  error estimate for blocks of size 2^( 2) =       0.000421213542
  error estimate for blocks of size 2^( 3) =       0.000434776678
  error estimate for blocks of size 2^( 4) =       0.000447094182
  error estimate for blocks of size 2^( 5) =       0.000457927046
  error estimate for blocks of size 2^( 6) =       0.000466457326
  error estimate for blocks of size 2^( 7) =       0.000474494297

      target function =                  N/A
              le_mean =     -16.905306194289
             les_mean =     286.123227288959
             stat err =       0.000461493213
             autocorr =       1.275878556331
              std dev =       0.577797484600
             le_variance =       0.333849933211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333831310417
                                         uncertainty =       0.003983158012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333831310417
                                         uncertainty =       0.003983158012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408567071
  error estimate for blocks of size 2^( 2) =       0.000421216047
  error estimate for blocks of size 2^( 3) =       0.000434779147
  error estimate for blocks of size 2^( 4) =       0.000447096630
  error estimate for blocks of size 2^( 5) =       0.000457929437
  error estimate for blocks of size 2^( 6) =       0.000466459598
  error estimate for blocks of size 2^( 7) =       0.000474496448

      target function =                  N/A
              le_mean =     -16.905306212180
             les_mean =     286.123232063459
             stat err =       0.000461495528
             autocorr =       1.275875424642
              std dev =       0.577801092763
             le_variance =       0.333854102799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333835150568
                                         uncertainty =       0.003983209235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333835150568
                                         uncertainty =       0.003983209235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408569422
  error estimate for blocks of size 2^( 2) =       0.000421218354
  error estimate for blocks of size 2^( 3) =       0.000434781419
  error estimate for blocks of size 2^( 4) =       0.000447098882
  error estimate for blocks of size 2^( 5) =       0.000457931637
  error estimate for blocks of size 2^( 6) =       0.000466461693
  error estimate for blocks of size 2^( 7) =       0.000474498431

      target function =                  N/A
              le_mean =     -16.905306228574
             les_mean =     286.123236460082
             stat err =       0.000461497661
             autocorr =       1.275872533215
              std dev =       0.577804417723
             le_variance =       0.333857945141


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905306230946        initial  <--
     1.4211e+01     1.4211e+02             1.2686e-05       -16.905306194289
     5.6843e+01     5.6843e+02             3.2015e-06       -16.905306212180
     2.2737e+02     2.2737e+03             8.0229e-07       -16.905306228574

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8523
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.942483e-01 1 1  ON 0
 uu_1                 1.270409e-01 1 1  ON 1
 uu_2                 2.527951e-02 1 1  ON 2
 uu_3                -3.753289e-02 1 1  ON 3
 uu_4                -8.372452e-02 1 1  ON 4
 uu_5                -1.196955e-01 1 1  ON 5
 uu_6                -1.485197e-01 1 1  ON 6
 uu_7                -1.637818e-01 1 1  ON 7
 uu_8                -1.562089e-01 1 1  ON 8
 uu_9                -1.292150e-01 1 1  ON 9
 ud_0                 4.555324e-01 1 1  ON 10
 ud_1                 1.901365e-01 1 1  ON 11
 ud_2                 7.057231e-02 1 1  ON 12
 ud_3                -3.333972e-04 1 1  ON 13
 ud_4                -5.810129e-02 1 1  ON 14
 ud_5                -1.007341e-01 1 1  ON 15
 ud_6                -1.296201e-01 1 1  ON 16
 ud_7                -1.478015e-01 1 1  ON 17
 ud_8                -1.501949e-01 1 1  ON 18
 ud_9                -1.418087e-01 1 1  ON 19
 eO_0                -7.054646e-01 1 1  ON 20
 eO_1                -3.855100e-01 1 1  ON 21
 eO_2                 2.828023e-02 1 1  ON 22
 eO_3                 3.439416e-01 1 1  ON 23
 eO_4                 5.684029e-01 1 1  ON 24
 eO_5                 5.255975e-01 1 1  ON 25
 eO_6                 2.820607e-01 1 1  ON 26
 eO_7                -6.503601e-02 1 1  ON 27
 eO_8                -3.287140e-01 1 1  ON 28
 eO_9                -2.252430e-01 1 1  ON 29
eH1_0                -2.921654e-01 1 1  ON 30
eH1_1                -1.886537e-01 1 1  ON 31
eH1_2                -1.402076e-01 1 1  ON 32
eH1_3                -8.504630e-02 1 1  ON 33
eH1_4                -3.489134e-02 1 1  ON 34
eH1_5                 4.648015e-03 1 1  ON 35
eH1_6                 7.311207e-02 1 1  ON 36
eH1_7                 1.571232e-01 1 1  ON 37
eH1_8                 2.279282e-01 1 1  ON 38
eH1_9                 2.110864e-01 1 1  ON 39
eH2_0                -2.902164e-01 1 1  ON 40
eH2_1                -1.870566e-01 1 1  ON 41
eH2_2                -1.384909e-01 1 1  ON 42
eH2_3                -8.317159e-02 1 1  ON 43
eH2_4                -3.313013e-02 1 1  ON 44
eH2_5                 5.736791e-03 1 1  ON 45
eH2_6                 7.505468e-02 1 1  ON 46
eH2_7                 1.571222e-01 1 1  ON 47
eH2_8                 2.244124e-01 1 1  ON 48
eH2_9                 2.362979e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5899e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8688
    reference variance = 0.379984
====================================================
  Execution time = 2.0562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9079e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341133503375
                                         uncertainty =       0.004984436024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341133503375
                                         uncertainty =       0.004984436024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412954678
  error estimate for blocks of size 2^( 2) =       0.000425215921
  error estimate for blocks of size 2^( 3) =       0.000438213818
  error estimate for blocks of size 2^( 4) =       0.000450367950
  error estimate for blocks of size 2^( 5) =       0.000460196615
  error estimate for blocks of size 2^( 6) =       0.000468023636
  error estimate for blocks of size 2^( 7) =       0.000472466928

      target function =                  N/A
              le_mean =     -16.905776532677
             les_mean =     286.146343135030
             stat err =       0.000462763782
             autocorr =       1.255781099694
              std dev =       0.584006106778
             le_variance =       0.341063132754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690577653268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905776532677       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905776533353       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905776532257       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905776533267       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905776533933       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905776533819       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905776533329       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+02 is 1.318860e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905776532677       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905776532846       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905776532572       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905776532824       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905776532988       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905776532962       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905776532840       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 3.298404e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905776532677       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905776532719       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905776532651       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905776532714       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905776532752       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905776532749       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905776532717       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 8.246795e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150056 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7978e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.942483e-01 1 1  ON 0
 uu_1                 1.270410e-01 1 1  ON 1
 uu_2                 2.527969e-02 1 1  ON 2
 uu_3                -3.753283e-02 1 1  ON 3
 uu_4                -8.372456e-02 1 1  ON 4
 uu_5                -1.196956e-01 1 1  ON 5
 uu_6                -1.485197e-01 1 1  ON 6
 uu_7                -1.637819e-01 1 1  ON 7
 uu_8                -1.562090e-01 1 1  ON 8
 uu_9                -1.292150e-01 1 1  ON 9
 ud_0                 4.555325e-01 1 1  ON 10
 ud_1                 1.901365e-01 1 1  ON 11
 ud_2                 7.057235e-02 1 1  ON 12
 ud_3                -3.333545e-04 1 1  ON 13
 ud_4                -5.810152e-02 1 1  ON 14
 ud_5                -1.007341e-01 1 1  ON 15
 ud_6                -1.296201e-01 1 1  ON 16
 ud_7                -1.478015e-01 1 1  ON 17
 ud_8                -1.501948e-01 1 1  ON 18
 ud_9                -1.418086e-01 1 1  ON 19
 eO_0                -7.054645e-01 1 1  ON 20
 eO_1                -3.855099e-01 1 1  ON 21
 eO_2                 2.828014e-02 1 1  ON 22
 eO_3                 3.439418e-01 1 1  ON 23
 eO_4                 5.684031e-01 1 1  ON 24
 eO_5                 5.255975e-01 1 1  ON 25
 eO_6                 2.820607e-01 1 1  ON 26
 eO_7                -6.503611e-02 1 1  ON 27
 eO_8                -3.287141e-01 1 1  ON 28
 eO_9                -2.252431e-01 1 1  ON 29
eH1_0                -2.921658e-01 1 1  ON 30
eH1_1                -1.886539e-01 1 1  ON 31
eH1_2                -1.402077e-01 1 1  ON 32
eH1_3                -8.504636e-02 1 1  ON 33
eH1_4                -3.489124e-02 1 1  ON 34
eH1_5                 4.648133e-03 1 1  ON 35
eH1_6                 7.311224e-02 1 1  ON 36
eH1_7                 1.571233e-01 1 1  ON 37
eH1_8                 2.279282e-01 1 1  ON 38
eH1_9                 2.110865e-01 1 1  ON 39
eH2_0                -2.902165e-01 1 1  ON 40
eH2_1                -1.870566e-01 1 1  ON 41
eH2_2                -1.384911e-01 1 1  ON 42
eH2_3                -8.317171e-02 1 1  ON 43
eH2_4                -3.313001e-02 1 1  ON 44
eH2_5                 5.736874e-03 1 1  ON 45
eH2_6                 7.505458e-02 1 1  ON 46
eH2_7                 1.571222e-01 1 1  ON 47
eH2_8                 2.244125e-01 1 1  ON 48
eH2_9                 2.362980e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9062
    reference variance = 0.327888
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4546e-01
  Total weights = 2.0000e+06
  Execution time = 1.8993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345498968520
                                         uncertainty =       0.005216057019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345498968520
                                         uncertainty =       0.005216057019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415608973
  error estimate for blocks of size 2^( 2) =       0.000428282022
  error estimate for blocks of size 2^( 3) =       0.000441081755
  error estimate for blocks of size 2^( 4) =       0.000453729608
  error estimate for blocks of size 2^( 5) =       0.000466368226
  error estimate for blocks of size 2^( 6) =       0.000475514962
  error estimate for blocks of size 2^( 7) =       0.000481512378

      target function =                  N/A
              le_mean =     -16.905451901403
             les_mean =     286.139765455544
             stat err =       0.000469281294
             autocorr =       1.274960276399
              std dev =       0.587759846893
             le_variance =       0.345461637619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345499262029
                                         uncertainty =       0.005216056157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345499262029
                                         uncertainty =       0.005216056157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415609150
  error estimate for blocks of size 2^( 2) =       0.000428282190
  error estimate for blocks of size 2^( 3) =       0.000441081904
  error estimate for blocks of size 2^( 4) =       0.000453729749
  error estimate for blocks of size 2^( 5) =       0.000466368359
  error estimate for blocks of size 2^( 6) =       0.000475515088
  error estimate for blocks of size 2^( 7) =       0.000481512534

      target function =                  N/A
              le_mean =     -16.905451906005
             les_mean =     286.139765904389
             stat err =       0.000469281433
             autocorr =       1.274959949569
              std dev =       0.587760096364
             le_variance =       0.345461930877

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345499115447
                                         uncertainty =       0.005216056591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345499115447
                                         uncertainty =       0.005216056591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415609062
  error estimate for blocks of size 2^( 2) =       0.000428282106
  error estimate for blocks of size 2^( 3) =       0.000441081830
  error estimate for blocks of size 2^( 4) =       0.000453729678
  error estimate for blocks of size 2^( 5) =       0.000466368293
  error estimate for blocks of size 2^( 6) =       0.000475515025
  error estimate for blocks of size 2^( 7) =       0.000481512456

      target function =                  N/A
              le_mean =     -16.905451903704
             les_mean =     286.139765680155
             stat err =       0.000469281363
             autocorr =       1.274960112819
              std dev =       0.587759971774
             le_variance =       0.345461784420

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345498986891
                                         uncertainty =       0.005216056966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345498986891
                                         uncertainty =       0.005216056966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415608984
  error estimate for blocks of size 2^( 2) =       0.000428282032
  error estimate for blocks of size 2^( 3) =       0.000441081764
  error estimate for blocks of size 2^( 4) =       0.000453729617
  error estimate for blocks of size 2^( 5) =       0.000466368234
  error estimate for blocks of size 2^( 6) =       0.000475514970
  error estimate for blocks of size 2^( 7) =       0.000481512388

      target function =                  N/A
              le_mean =     -16.905451901691
             les_mean =     286.139765483623
             stat err =       0.000469281302
             autocorr =       1.274960255936
              std dev =       0.587759862507
             le_variance =       0.345461655975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905451901403        initial
     1.4211e+02     1.4211e+03             1.3189e-06       -16.905451906005  <--
     5.6843e+02     5.6843e+03             3.2984e-07       -16.905451903704
     2.2737e+03     2.2737e+04             8.2468e-08       -16.905451901691

*****************************************************************************
Applying the update for shift_i =   1.4211e+02     and shift_s =   1.4211e+03
*****************************************************************************

  Execution time = 2.9997e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.942481e-01 1 1  ON 0
 uu_1                 1.270412e-01 1 1  ON 1
 uu_2                 2.528026e-02 1 1  ON 2
 uu_3                -3.753264e-02 1 1  ON 3
 uu_4                -8.372467e-02 1 1  ON 4
 uu_5                -1.196959e-01 1 1  ON 5
 uu_6                -1.485198e-01 1 1  ON 6
 uu_7                -1.637823e-01 1 1  ON 7
 uu_8                -1.562092e-01 1 1  ON 8
 uu_9                -1.292149e-01 1 1  ON 9
 ud_0                 4.555331e-01 1 1  ON 10
 ud_1                 1.901366e-01 1 1  ON 11
 ud_2                 7.057246e-02 1 1  ON 12
 ud_3                -3.332269e-04 1 1  ON 13
 ud_4                -5.810219e-02 1 1  ON 14
 ud_5                -1.007342e-01 1 1  ON 15
 ud_6                -1.296202e-01 1 1  ON 16
 ud_7                -1.478016e-01 1 1  ON 17
 ud_8                -1.501945e-01 1 1  ON 18
 ud_9                -1.418084e-01 1 1  ON 19
 eO_0                -7.054643e-01 1 1  ON 20
 eO_1                -3.855099e-01 1 1  ON 21
 eO_2                 2.827987e-02 1 1  ON 22
 eO_3                 3.439425e-01 1 1  ON 23
 eO_4                 5.684037e-01 1 1  ON 24
 eO_5                 5.255973e-01 1 1  ON 25
 eO_6                 2.820607e-01 1 1  ON 26
 eO_7                -6.503643e-02 1 1  ON 27
 eO_8                -3.287143e-01 1 1  ON 28
 eO_9                -2.252435e-01 1 1  ON 29
eH1_0                -2.921668e-01 1 1  ON 30
eH1_1                -1.886546e-01 1 1  ON 31
eH1_2                -1.402081e-01 1 1  ON 32
eH1_3                -8.504652e-02 1 1  ON 33
eH1_4                -3.489092e-02 1 1  ON 34
eH1_5                 4.648488e-03 1 1  ON 35
eH1_6                 7.311275e-02 1 1  ON 36
eH1_7                 1.571238e-01 1 1  ON 37
eH1_8                 2.279282e-01 1 1  ON 38
eH1_9                 2.110868e-01 1 1  ON 39
eH2_0                -2.902169e-01 1 1  ON 40
eH2_1                -1.870564e-01 1 1  ON 41
eH2_2                -1.384916e-01 1 1  ON 42
eH2_3                -8.317207e-02 1 1  ON 43
eH2_4                -3.312963e-02 1 1  ON 44
eH2_5                 5.737123e-03 1 1  ON 45
eH2_6                 7.505429e-02 1 1  ON 46
eH2_7                 1.571223e-01 1 1  ON 47
eH2_8                 2.244125e-01 1 1  ON 48
eH2_9                 2.362982e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7980e+01 secs
  Total Execution time = 2.2638e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
