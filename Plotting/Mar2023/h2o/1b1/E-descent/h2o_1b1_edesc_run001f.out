Rank =    0  Free Memory = 84961 MB
Rank =    1  Free Memory = 84961 MB
Rank =    2  Free Memory = 84961 MB
Rank =    3  Free Memory = 84961 MB
Rank =    4  Free Memory = 84961 MB
Rank =    5  Free Memory = 84960 MB
Rank =    6  Free Memory = 84960 MB
Rank =    7  Free Memory = 84960 MB
Rank =    8  Free Memory = 84960 MB
Rank =    9  Free Memory = 84960 MB
Rank =   10  Free Memory = 84959 MB
Rank =   11  Free Memory = 84959 MB
Rank =   12  Free Memory = 84959 MB
Rank =   13  Free Memory = 84959 MB
Rank =   14  Free Memory = 84958 MB
Rank =   15  Free Memory = 84945 MB
Rank =   16  Free Memory = 84945 MB
Rank =   17  Free Memory = 84945 MB
Rank =   18  Free Memory = 84945 MB
Rank =   19  Free Memory = 84945 MB
Rank =   20  Free Memory = 84945 MB
Rank =   21  Free Memory = 84945 MB
Rank =   22  Free Memory = 84945 MB
Rank =   23  Free Memory = 84945 MB
Rank =   24  Free Memory = 84945 MB
Rank =   25  Free Memory = 84945 MB
Rank =   26  Free Memory = 84945 MB
Rank =   27  Free Memory = 84945 MB
Rank =   28  Free Memory = 84945 MB
Rank =   29  Free Memory = 84945 MB
Rank =   30  Free Memory = 84944 MB
Rank =   31  Free Memory = 84944 MB
Rank =   32  Free Memory = 89775 MB
Rank =   33  Free Memory = 89775 MB
Rank =   34  Free Memory = 89775 MB
Rank =   35  Free Memory = 89775 MB
Rank =   36  Free Memory = 89775 MB
Rank =   37  Free Memory = 89775 MB
Rank =   38  Free Memory = 89775 MB
Rank =   39  Free Memory = 89775 MB
Rank =   40  Free Memory = 89775 MB
Rank =   41  Free Memory = 89775 MB
Rank =   42  Free Memory = 89775 MB
Rank =   43  Free Memory = 89774 MB
Rank =   44  Free Memory = 89774 MB
Rank =   45  Free Memory = 89774 MB
Rank =   46  Free Memory = 89774 MB
Rank =   47  Free Memory = 89774 MB
Rank =   48  Free Memory = 89774 MB
Rank =   49  Free Memory = 89774 MB
Rank =   50  Free Memory = 89774 MB
Rank =   51  Free Memory = 89774 MB
Rank =   52  Free Memory = 89774 MB
Rank =   53  Free Memory = 89774 MB
Rank =   54  Free Memory = 89774 MB
Rank =   55  Free Memory = 89774 MB
Rank =   56  Free Memory = 89774 MB
Rank =   57  Free Memory = 89774 MB
Rank =   58  Free Memory = 89774 MB
Rank =   59  Free Memory = 89774 MB
Rank =   60  Free Memory = 89774 MB
Rank =   61  Free Memory = 89774 MB
Rank =   62  Free Memory = 89774 MB
Rank =   63  Free Memory = 89774 MB
Rank =   64  Free Memory = 73260 MB
Rank =   65  Free Memory = 73260 MB
Rank =   66  Free Memory = 73260 MB
Rank =   67  Free Memory = 73260 MB
Rank =   68  Free Memory = 73260 MB
Rank =   69  Free Memory = 73260 MB
Rank =   70  Free Memory = 73260 MB
Rank =   71  Free Memory = 73260 MB
Rank =   72  Free Memory = 73260 MB
Rank =   73  Free Memory = 73260 MB
Rank =   74  Free Memory = 73260 MB
Rank =   75  Free Memory = 73260 MB
Rank =   76  Free Memory = 73260 MB
Rank =   77  Free Memory = 73260 MB
Rank =   78  Free Memory = 73260 MB
Rank =   79  Free Memory = 73260 MB
Rank =   80  Free Memory = 73260 MB
Rank =   81  Free Memory = 73260 MB
Rank =   82  Free Memory = 73260 MB
Rank =   83  Free Memory = 73260 MB
Rank =   84  Free Memory = 73260 MB
Rank =   85  Free Memory = 73260 MB
Rank =   86  Free Memory = 73260 MB
Rank =   87  Free Memory = 73260 MB
Rank =   88  Free Memory = 73260 MB
Rank =   89  Free Memory = 73260 MB
Rank =   90  Free Memory = 73260 MB
Rank =   91  Free Memory = 73260 MB
Rank =   92  Free Memory = 73260 MB
Rank =   93  Free Memory = 73260 MB
Rank =   94  Free Memory = 73260 MB
Rank =   95  Free Memory = 73260 MB
Rank =   96  Free Memory = 74020 MB
Rank =   97  Free Memory = 74020 MB
Rank =   98  Free Memory = 74020 MB
Rank =   99  Free Memory = 74020 MB
Rank =  100  Free Memory = 74020 MB
Rank =  101  Free Memory = 74020 MB
Rank =  102  Free Memory = 74020 MB
Rank =  103  Free Memory = 74020 MB
Rank =  104  Free Memory = 74020 MB
Rank =  105  Free Memory = 74020 MB
Rank =  106  Free Memory = 74020 MB
Rank =  107  Free Memory = 74020 MB
Rank =  108  Free Memory = 74020 MB
Rank =  109  Free Memory = 74020 MB
Rank =  110  Free Memory = 74020 MB
Rank =  111  Free Memory = 74020 MB
Rank =  112  Free Memory = 74020 MB
Rank =  113  Free Memory = 74020 MB
Rank =  114  Free Memory = 74020 MB
Rank =  115  Free Memory = 74020 MB
Rank =  116  Free Memory = 74020 MB
Rank =  117  Free Memory = 74020 MB
Rank =  118  Free Memory = 74020 MB
Rank =  119  Free Memory = 74020 MB
Rank =  120  Free Memory = 74020 MB
Rank =  121  Free Memory = 74020 MB
Rank =  122  Free Memory = 74020 MB
Rank =  123  Free Memory = 74020 MB
Rank =  124  Free Memory = 74020 MB
Rank =  125  Free Memory = 74020 MB
Rank =  126  Free Memory = 74020 MB
Rank =  127  Free Memory = 74020 MB
  Input file(s): opt_h2o_1b1_edesc_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_edesc_run001f.xml

  Project = H2O
  date    = 2023-03-06 14:08:30 PST
  host    = n0113.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 94

  Range of prime numbers to use as seeds over processors and threads = 503-1423


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.083700e-01    1         1  ON     0
     uu_1                 1.416767e-01    1         1  ON     1
     uu_2                 4.094271e-02    1         1  ON     2
     uu_3                -2.029634e-02    1         1  ON     3
     uu_4                -6.361145e-02    1         1  ON     4
     uu_5                -9.670829e-02    1         1  ON     5
     uu_6                -1.233240e-01    1         1  ON     6
     uu_7                -1.363789e-01    1         1  ON     7
     uu_8                -1.282921e-01    1         1  ON     8
     uu_9                -9.951167e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.435018e-01    1         1  ON     0
     ud_1                 1.777445e-01    1         1  ON     1
     ud_2                 5.800545e-02    1         1  ON     2
     ud_3                -1.250309e-02    1         1  ON     3
     ud_4                -6.878397e-02    1         1  ON     4
     ud_5                -1.080321e-01    1         1  ON     5
     ud_6                -1.328837e-01    1         1  ON     6
     ud_7                -1.469906e-01    1         1  ON     7
     ud_8                -1.457591e-01    1         1  ON     8
     ud_9                -1.352403e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.634963e-01    1         1  ON     0
     eO_1                -4.422463e-01    1         1  ON     1
     eO_2                -2.053012e-02    1         1  ON     2
     eO_3                 3.008195e-01    1         1  ON     3
     eO_4                 5.250651e-01    1         1  ON     4
     eO_5                 4.811727e-01    1         1  ON     5
     eO_6                 2.500520e-01    1         1  ON     6
     eO_7                -4.945185e-02    1         1  ON     7
     eO_8                -2.104215e-01    1         1  ON     8
     eO_9                -7.127295e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.362976e-01    1         1  ON     0
     eH1_1                -1.371898e-01    1         1  ON     1
     eH1_2                -9.161839e-02    1         1  ON     2
     eH1_3                -3.823020e-02    1         1  ON     3
     eH1_4                 7.520988e-03    1         1  ON     4
     eH1_5                 4.096866e-02    1         1  ON     5
     eH1_6                 9.636235e-02    1         1  ON     6
     eH1_7                 1.470450e-01    1         1  ON     7
     eH1_8                 1.639070e-01    1         1  ON     8
     eH1_9                 5.094510e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.332770e-01    1         1  ON     0
     eH2_1                -1.342081e-01    1         1  ON     1
     eH2_2                -8.869876e-02    1         1  ON     2
     eH2_3                -3.500513e-02    1         1  ON     3
     eH2_4                 1.124783e-02    1         1  ON     4
     eH2_5                 4.345589e-02    1         1  ON     5
     eH2_6                 9.993493e-02    1         1  ON     6
     eH2_7                 1.511981e-01    1         1  ON     7
     eH2_8                 1.690103e-01    1         1  ON     8
     eH2_9                 3.402851e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.716485e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3054e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.891
    reference variance = 0.211826
====================================================
  Execution time = 2.0913e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332320433989
                                         uncertainty =       0.004173451222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332320433989
                                         uncertainty =       0.004173451222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407586222
  error estimate for blocks of size 2^( 2) =       0.000422190623
  error estimate for blocks of size 2^( 3) =       0.000438357575
  error estimate for blocks of size 2^( 4) =       0.000456149222
  error estimate for blocks of size 2^( 5) =       0.000474702855
  error estimate for blocks of size 2^( 6) =       0.000491029084
  error estimate for blocks of size 2^( 7) =       0.000502325072

      target function =                  N/A
              le_mean =     -16.914590431441
             les_mean =     286.435622354457
             stat err =       0.000481051558
             autocorr =       1.392978011896
              std dev =       0.576413963389
             le_variance =       0.332253057190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691459043144e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914590431441       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914602825090       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914602469694       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914604335263       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914606989351       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914607455536       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914608333083       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914608578954       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.914608219581       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.914607818577       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.166402e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914590431441       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914594435487       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914594274439       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914595156289       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914595613630       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914596014542       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914596102988       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914596137692       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.914596089879       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.631553e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914590431441       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914591511364       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914591466322       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914591760826       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914591857577       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914591975790       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914591971506       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914591993980       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.020935e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6355e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.082487e-01                 1 1 ON  0
uu_1  1.417011e-01                 1 1 ON  1
uu_2  4.104167e-02                 1 1 ON  2
uu_3  -2.030161e-02                1 1 ON  3
uu_4  -6.366600e-02                1 1 ON  4
uu_5  -9.663712e-02                1 1 ON  5
uu_6  -1.232367e-01                1 1 ON  6
uu_7  -1.363985e-01                1 1 ON  7
uu_8  -1.285030e-01                1 1 ON  8
uu_9  -9.957271e-02                1 1 ON  9
ud_0  4.435132e-01                 1 1 ON  10
ud_1  1.777135e-01                 1 1 ON  11
ud_2  5.776208e-02                 1 1 ON  12
ud_3  -1.265619e-02                1 1 ON  13
ud_4  -6.877921e-02                1 1 ON  14
ud_5  -1.079261e-01                1 1 ON  15
ud_6  -1.328083e-01                1 1 ON  16
ud_7  -1.469548e-01                1 1 ON  17
ud_8  -1.456932e-01                1 1 ON  18
ud_9  -1.352135e-01                1 1 ON  19
eO_0  -7.638594e-01                1 1 ON  20
eO_1  -4.423793e-01                1 1 ON  21
eO_2  -2.065146e-02                1 1 ON  22
eO_3  3.008363e-01                 1 1 ON  23
eO_4  5.253780e-01                 1 1 ON  24
eO_5  4.814272e-01                 1 1 ON  25
eO_6  2.502111e-01                 1 1 ON  26
eO_7  -4.934587e-02                1 1 ON  27
eO_8  -2.105147e-01                1 1 ON  28
eO_9  -7.138806e-02                1 1 ON  29
eH1_0 -2.364191e-01                1 1 ON  30
eH1_1 -1.373496e-01                1 1 ON  31
eH1_2 -9.176472e-02                1 1 ON  32
eH1_3 -3.809954e-02                1 1 ON  33
eH1_4 7.435122e-03                 1 1 ON  34
eH1_5 4.105751e-02                 1 1 ON  35
eH1_6 9.644027e-02                 1 1 ON  36
eH1_7 1.470489e-01                 1 1 ON  37
eH1_8 1.639908e-01                 1 1 ON  38
eH1_9 5.106854e-02                 1 1 ON  39
eH2_0 -2.333435e-01                1 1 ON  40
eH2_1 -1.343795e-01                1 1 ON  41
eH2_2 -8.875839e-02                1 1 ON  42
eH2_3 -3.494681e-02                1 1 ON  43
eH2_4 1.121925e-02                 1 1 ON  44
eH2_5 4.345282e-02                 1 1 ON  45
eH2_6 9.981578e-02                 1 1 ON  46
eH2_7 1.512377e-01                 1 1 ON  47
eH2_8 1.691969e-01                 1 1 ON  48
eH2_9 3.422185e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8486
    reference variance = 0.630521
====================================================
  Execution time = 2.0809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3324e-01
  Total weights = 2.0000e+06
  Execution time = 1.8860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333133898247
                                         uncertainty =       0.003007349576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333133898247
                                         uncertainty =       0.003007349576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408121529
  error estimate for blocks of size 2^( 2) =       0.000422690800
  error estimate for blocks of size 2^( 3) =       0.000438710412
  error estimate for blocks of size 2^( 4) =       0.000455576490
  error estimate for blocks of size 2^( 5) =       0.000474086700
  error estimate for blocks of size 2^( 6) =       0.000490595627
  error estimate for blocks of size 2^( 7) =       0.000503230213

      target function =                  N/A
              le_mean =     -16.915094102149
             les_mean =     286.453534682051
             stat err =       0.000480872257
             autocorr =       1.388290767681
              std dev =       0.577171000721
             le_variance =       0.333126364073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333440250879
                                         uncertainty =       0.003007866148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333440250879
                                         uncertainty =       0.003007866148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408309239
  error estimate for blocks of size 2^( 2) =       0.000422861289
  error estimate for blocks of size 2^( 3) =       0.000438860602
  error estimate for blocks of size 2^( 4) =       0.000455705555
  error estimate for blocks of size 2^( 5) =       0.000474191165
  error estimate for blocks of size 2^( 6) =       0.000490651946
  error estimate for blocks of size 2^( 7) =       0.000503259958

      target function =                  N/A
              le_mean =     -16.915097186709
             les_mean =     286.453945538583
             stat err =       0.000480952156
             autocorr =       1.387475547494
              std dev =       0.577436463593
             le_variance =       0.333432869486

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333367573933
                                         uncertainty =       0.003007651780

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333367573933
                                         uncertainty =       0.003007651780

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408264728
  error estimate for blocks of size 2^( 2) =       0.000422817910
  error estimate for blocks of size 2^( 3) =       0.000438819844
  error estimate for blocks of size 2^( 4) =       0.000455670511
  error estimate for blocks of size 2^( 5) =       0.000474162588
  error estimate for blocks of size 2^( 6) =       0.000490637649
  error estimate for blocks of size 2^( 7) =       0.000503255817

      target function =                  N/A
              le_mean =     -16.915097057306
             les_mean =     286.453868467010
             stat err =       0.000480931641
             autocorr =       1.387659716134
              std dev =       0.577373514809
             le_variance =       0.333360175603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333165722112
                                         uncertainty =       0.003007440196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333165722112
                                         uncertainty =       0.003007440196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408141034
  error estimate for blocks of size 2^( 2) =       0.000422707682
  error estimate for blocks of size 2^( 3) =       0.000438724550
  error estimate for blocks of size 2^( 4) =       0.000455588450
  error estimate for blocks of size 2^( 5) =       0.000474095971
  error estimate for blocks of size 2^( 6) =       0.000490600063
  error estimate for blocks of size 2^( 7) =       0.000503232460

      target function =                  N/A
              le_mean =     -16.915094405745
             les_mean =     286.453576795170
             stat err =       0.000480879236
             autocorr =       1.388198371526
              std dev =       0.577198584970
             le_variance =       0.333158206492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915094102149        initial
     2.5000e-01     2.5000e+00             1.1664e-03       -16.915097186709  <--
     1.0000e+00     1.0000e+01             3.6316e-04       -16.915097057306
     4.0000e+00     4.0000e+01             1.0209e-04       -16.915094405745

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0339e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.081677e-01 1 1  ON 0
 uu_1                 1.417880e-01 1 1  ON 1
 uu_2                 4.116756e-02 1 1  ON 2
 uu_3                -2.030074e-02 1 1  ON 3
 uu_4                -6.379456e-02 1 1  ON 4
 uu_5                -9.656639e-02 1 1  ON 5
 uu_6                -1.230922e-01 1 1  ON 6
 uu_7                -1.364294e-01 1 1  ON 7
 uu_8                -1.290692e-01 1 1  ON 8
 uu_9                -9.975819e-02 1 1  ON 9
 ud_0                 4.434525e-01 1 1  ON 10
 ud_1                 1.775226e-01 1 1  ON 11
 ud_2                 5.737407e-02 1 1  ON 12
 ud_3                -1.299382e-02 1 1  ON 13
 ud_4                -6.885871e-02 1 1  ON 14
 ud_5                -1.077838e-01 1 1  ON 15
 ud_6                -1.326129e-01 1 1  ON 16
 ud_7                -1.468173e-01 1 1  ON 17
 ud_8                -1.454936e-01 1 1  ON 18
 ud_9                -1.351323e-01 1 1  ON 19
 eO_0                -7.646410e-01 1 1  ON 20
 eO_1                -4.429151e-01 1 1  ON 21
 eO_2                -2.108230e-02 1 1  ON 22
 eO_3                 3.007316e-01 1 1  ON 23
 eO_4                 5.262315e-01 1 1  ON 24
 eO_5                 4.822867e-01 1 1  ON 25
 eO_6                 2.507291e-01 1 1  ON 26
 eO_7                -4.903345e-02 1 1  ON 27
 eO_8                -2.107916e-01 1 1  ON 28
 eO_9                -7.173202e-02 1 1  ON 29
eH1_0                -2.367662e-01 1 1  ON 30
eH1_1                -1.377002e-01 1 1  ON 31
eH1_2                -9.203633e-02 1 1  ON 32
eH1_3                -3.800703e-02 1 1  ON 33
eH1_4                 7.267080e-03 1 1  ON 34
eH1_5                 4.120192e-02 1 1  ON 35
eH1_6                 9.666384e-02 1 1  ON 36
eH1_7                 1.470893e-01 1 1  ON 37
eH1_8                 1.642451e-01 1 1  ON 38
eH1_9                 5.143639e-02 1 1  ON 39
eH2_0                -2.335531e-01 1 1  ON 40
eH2_1                -1.347293e-01 1 1  ON 41
eH2_2                -8.890915e-02 1 1  ON 42
eH2_3                -3.491650e-02 1 1  ON 43
eH2_4                 1.112073e-02 1 1  ON 44
eH2_5                 4.339181e-02 1 1  ON 45
eH2_6                 9.949637e-02 1 1  ON 46
eH2_7                 1.513613e-01 1 1  ON 47
eH2_8                 1.697439e-01 1 1  ON 48
eH2_9                 3.479776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6870e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9146
    reference variance = 0.316272
====================================================
  Execution time = 2.0637e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3876e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587517523
                                         uncertainty =       0.002848780761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338587517523
                                         uncertainty =       0.002848780761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411560519
  error estimate for blocks of size 2^( 2) =       0.000425467967
  error estimate for blocks of size 2^( 3) =       0.000440368282
  error estimate for blocks of size 2^( 4) =       0.000454750032
  error estimate for blocks of size 2^( 5) =       0.000471675053
  error estimate for blocks of size 2^( 6) =       0.000485886275
  error estimate for blocks of size 2^( 7) =       0.000494874895

      target function =                  N/A
              le_mean =     -16.916373937157
             les_mean =     286.502471133523
             stat err =       0.000476796564
             autocorr =       1.342143096109
              std dev =       0.582034467358
             le_variance =       0.338764121193


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691637393716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916373937157       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916379740750       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916383430349       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916381866100       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916387948896       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916393141523       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916393718966       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916395874560       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.916394176212       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.916394401064       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.916395216475       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.916397484924       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.916397519520       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.916397111407       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.823176e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916373937157       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916376803923       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916378892441       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916378783651       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916381848452       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916381559360       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916383677365       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916383024640       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.916382761195       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.916382692783       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.916382806641       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.412598e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916373937157       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916374885116       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916375746525       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916376011848       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916376830467       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916376601776       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916377067174       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916376923445       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.916376891509       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.980438e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.011649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6195e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.081680e-01 1 1  ON 0
 uu_1                 1.422298e-01 1 1  ON 1
 uu_2                 4.168243e-02 1 1  ON 2
 uu_3                -1.981040e-02 1 1  ON 3
 uu_4                -6.348505e-02 1 1  ON 4
 uu_5                -9.629057e-02 1 1  ON 5
 uu_6                -1.227110e-01 1 1  ON 6
 uu_7                -1.361748e-01 1 1  ON 7
 uu_8                -1.304315e-01 1 1  ON 8
 uu_9                -1.011708e-01 1 1  ON 9
 ud_0                 4.435876e-01 1 1  ON 10
 ud_1                 1.777086e-01 1 1  ON 11
 ud_2                 5.740939e-02 1 1  ON 12
 ud_3                -1.290191e-02 1 1  ON 13
 ud_4                -6.851681e-02 1 1  ON 14
 ud_5                -1.074636e-01 1 1  ON 15
 ud_6                -1.318970e-01 1 1  ON 16
 ud_7                -1.463229e-01 1 1  ON 17
 ud_8                -1.459475e-01 1 1  ON 18
 ud_9                -1.360711e-01 1 1  ON 19
 eO_0                -7.653240e-01 1 1  ON 20
 eO_1                -4.430440e-01 1 1  ON 21
 eO_2                -2.155202e-02 1 1  ON 22
 eO_3                 3.008156e-01 1 1  ON 23
 eO_4                 5.269341e-01 1 1  ON 24
 eO_5                 4.835805e-01 1 1  ON 25
 eO_6                 2.517734e-01 1 1  ON 26
 eO_7                -4.873626e-02 1 1  ON 27
 eO_8                -2.120673e-01 1 1  ON 28
 eO_9                -7.253031e-02 1 1  ON 29
eH1_0                -2.370703e-01 1 1  ON 30
eH1_1                -1.377991e-01 1 1  ON 31
eH1_2                -9.212994e-02 1 1  ON 32
eH1_3                -3.799608e-02 1 1  ON 33
eH1_4                 7.446396e-03 1 1  ON 34
eH1_5                 4.118104e-02 1 1  ON 35
eH1_6                 9.651301e-02 1 1  ON 36
eH1_7                 1.470419e-01 1 1  ON 37
eH1_8                 1.646672e-01 1 1  ON 38
eH1_9                 5.165353e-02 1 1  ON 39
eH2_0                -2.335848e-01 1 1  ON 40
eH2_1                -1.347865e-01 1 1  ON 41
eH2_2                -8.907918e-02 1 1  ON 42
eH2_3                -3.498278e-02 1 1  ON 43
eH2_4                 1.102790e-02 1 1  ON 44
eH2_5                 4.371080e-02 1 1  ON 45
eH2_6                 9.906438e-02 1 1  ON 46
eH2_7                 1.513350e-01 1 1  ON 47
eH2_8                 1.699932e-01 1 1  ON 48
eH2_9                 3.527632e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.912
    reference variance = 0.396136
====================================================
  Execution time = 2.0199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3967e-01
  Total weights = 2.0000e+06
  Execution time = 1.8848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339788855128
                                         uncertainty =       0.004879206636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339788855128
                                         uncertainty =       0.004879206636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412161482
  error estimate for blocks of size 2^( 2) =       0.000426218201
  error estimate for blocks of size 2^( 3) =       0.000441049492
  error estimate for blocks of size 2^( 4) =       0.000457089938
  error estimate for blocks of size 2^( 5) =       0.000473422534
  error estimate for blocks of size 2^( 6) =       0.000488443963
  error estimate for blocks of size 2^( 7) =       0.000499653102

      target function =                  N/A
              le_mean =     -16.915528295709
             les_mean =     286.474851528308
             stat err =       0.000479652384
             autocorr =       1.354311008032
              std dev =       0.582884358374
             le_variance =       0.339754175237

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748598905
                                         uncertainty =       0.004873745842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748598905
                                         uncertainty =       0.004873745842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412136812
  error estimate for blocks of size 2^( 2) =       0.000426170429
  error estimate for blocks of size 2^( 3) =       0.000440960891
  error estimate for blocks of size 2^( 4) =       0.000456955978
  error estimate for blocks of size 2^( 5) =       0.000473256365
  error estimate for blocks of size 2^( 6) =       0.000488279957
  error estimate for blocks of size 2^( 7) =       0.000499480246

      target function =                  N/A
              le_mean =     -16.915528073131
             les_mean =     286.474803326747
             stat err =       0.000479493136
             autocorr =       1.353573910935
              std dev =       0.582849469192
             le_variance =       0.339713503737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339635156073
                                         uncertainty =       0.004871194689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339635156073
                                         uncertainty =       0.004871194689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412067998
  error estimate for blocks of size 2^( 2) =       0.000426109513
  error estimate for blocks of size 2^( 3) =       0.000440913497
  error estimate for blocks of size 2^( 4) =       0.000456923045
  error estimate for blocks of size 2^( 5) =       0.000473242395
  error estimate for blocks of size 2^( 6) =       0.000488273075
  error estimate for blocks of size 2^( 7) =       0.000499485276

      target function =                  N/A
              le_mean =     -16.915526211361
             les_mean =     286.474626906795
             stat err =       0.000479480948
             autocorr =       1.353957198330
              std dev =       0.582752150888
             le_variance =       0.339600069365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751541032
                                         uncertainty =       0.004877434829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751541032
                                         uncertainty =       0.004877434829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412138798
  error estimate for blocks of size 2^( 2) =       0.000426192899
  error estimate for blocks of size 2^( 3) =       0.000441019738
  error estimate for blocks of size 2^( 4) =       0.000457055461
  error estimate for blocks of size 2^( 5) =       0.000473387571
  error estimate for blocks of size 2^( 6) =       0.000488411747
  error estimate for blocks of size 2^( 7) =       0.000499622620

      target function =                  N/A
              le_mean =     -16.915526627037
             les_mean =     286.474757677832
             stat err =       0.000479619350
             autocorr =       1.354273534919
              std dev =       0.582852277773
             le_variance =       0.339716777705


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915528295709        initial  <--
     6.2500e-02     6.2500e-01             4.8232e-03       -16.915528073131
     2.5000e-01     2.5000e+00             1.4126e-03       -16.915526211361
     1.0000e+00     1.0000e+01             3.9804e-04       -16.915526627037

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6988
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.081677e-01 1 1  ON 0
 uu_1                 1.417880e-01 1 1  ON 1
 uu_2                 4.116756e-02 1 1  ON 2
 uu_3                -2.030074e-02 1 1  ON 3
 uu_4                -6.379456e-02 1 1  ON 4
 uu_5                -9.656639e-02 1 1  ON 5
 uu_6                -1.230922e-01 1 1  ON 6
 uu_7                -1.364294e-01 1 1  ON 7
 uu_8                -1.290692e-01 1 1  ON 8
 uu_9                -9.975819e-02 1 1  ON 9
 ud_0                 4.434525e-01 1 1  ON 10
 ud_1                 1.775226e-01 1 1  ON 11
 ud_2                 5.737407e-02 1 1  ON 12
 ud_3                -1.299382e-02 1 1  ON 13
 ud_4                -6.885871e-02 1 1  ON 14
 ud_5                -1.077838e-01 1 1  ON 15
 ud_6                -1.326129e-01 1 1  ON 16
 ud_7                -1.468173e-01 1 1  ON 17
 ud_8                -1.454936e-01 1 1  ON 18
 ud_9                -1.351323e-01 1 1  ON 19
 eO_0                -7.646410e-01 1 1  ON 20
 eO_1                -4.429151e-01 1 1  ON 21
 eO_2                -2.108230e-02 1 1  ON 22
 eO_3                 3.007316e-01 1 1  ON 23
 eO_4                 5.262315e-01 1 1  ON 24
 eO_5                 4.822867e-01 1 1  ON 25
 eO_6                 2.507291e-01 1 1  ON 26
 eO_7                -4.903345e-02 1 1  ON 27
 eO_8                -2.107916e-01 1 1  ON 28
 eO_9                -7.173202e-02 1 1  ON 29
eH1_0                -2.367662e-01 1 1  ON 30
eH1_1                -1.377002e-01 1 1  ON 31
eH1_2                -9.203633e-02 1 1  ON 32
eH1_3                -3.800703e-02 1 1  ON 33
eH1_4                 7.267080e-03 1 1  ON 34
eH1_5                 4.120192e-02 1 1  ON 35
eH1_6                 9.666384e-02 1 1  ON 36
eH1_7                 1.470893e-01 1 1  ON 37
eH1_8                 1.642451e-01 1 1  ON 38
eH1_9                 5.143639e-02 1 1  ON 39
eH2_0                -2.335531e-01 1 1  ON 40
eH2_1                -1.347293e-01 1 1  ON 41
eH2_2                -8.890915e-02 1 1  ON 42
eH2_3                -3.491650e-02 1 1  ON 43
eH2_4                 1.112073e-02 1 1  ON 44
eH2_5                 4.339181e-02 1 1  ON 45
eH2_6                 9.949637e-02 1 1  ON 46
eH2_7                 1.513613e-01 1 1  ON 47
eH2_8                 1.697439e-01 1 1  ON 48
eH2_9                 3.479776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5901e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8682
    reference variance = 0.390249
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3490e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334842436144
                                         uncertainty =       0.002984367021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334842436144
                                         uncertainty =       0.002984367021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409205126
  error estimate for blocks of size 2^( 2) =       0.000423439745
  error estimate for blocks of size 2^( 3) =       0.000438965998
  error estimate for blocks of size 2^( 4) =       0.000456359565
  error estimate for blocks of size 2^( 5) =       0.000474893982
  error estimate for blocks of size 2^( 6) =       0.000493931832
  error estimate for blocks of size 2^( 7) =       0.000510266809

      target function =                  N/A
              le_mean =     -16.915057858653
             les_mean =     286.454079863834
             stat err =       0.000483863047
             autocorr =       1.398179022466
              std dev =       0.578703438485
             le_variance =       0.334897669714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691505785865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915057858653       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915057855806       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915058039839       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915057505982       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915057802305       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915058124646       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915058511168       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915058516819       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.915058479974       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.841765e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915057858653       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915057857852       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915057907246       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915057713328       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915057734912       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915057742921       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915057804285       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915057820182       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.915057826950       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.226357e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915057858653       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915057858446       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915057871053       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915057817445       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915057818127       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915057813425       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915057822678       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915057826306       residual = 9.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 3.025662e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014724 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6088e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.081792e-01 1 1  ON 0
 uu_1                 1.417933e-01 1 1  ON 1
 uu_2                 4.120263e-02 1 1  ON 2
 uu_3                -2.028597e-02 1 1  ON 3
 uu_4                -6.380788e-02 1 1  ON 4
 uu_5                -9.659084e-02 1 1  ON 5
 uu_6                -1.231217e-01 1 1  ON 6
 uu_7                -1.364721e-01 1 1  ON 7
 uu_8                -1.290738e-01 1 1  ON 8
 uu_9                -9.978027e-02 1 1  ON 9
 ud_0                 4.434631e-01 1 1  ON 10
 ud_1                 1.774441e-01 1 1  ON 11
 ud_2                 5.730396e-02 1 1  ON 12
 ud_3                -1.305251e-02 1 1  ON 13
 ud_4                -6.882556e-02 1 1  ON 14
 ud_5                -1.077699e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.467433e-01 1 1  ON 17
 ud_8                -1.454689e-01 1 1  ON 18
 ud_9                -1.350989e-01 1 1  ON 19
 eO_0                -7.647293e-01 1 1  ON 20
 eO_1                -4.429620e-01 1 1  ON 21
 eO_2                -2.110833e-02 1 1  ON 22
 eO_3                 3.007166e-01 1 1  ON 23
 eO_4                 5.262716e-01 1 1  ON 24
 eO_5                 4.824094e-01 1 1  ON 25
 eO_6                 2.508191e-01 1 1  ON 26
 eO_7                -4.900251e-02 1 1  ON 27
 eO_8                -2.108446e-01 1 1  ON 28
 eO_9                -7.177885e-02 1 1  ON 29
eH1_0                -2.368004e-01 1 1  ON 30
eH1_1                -1.377161e-01 1 1  ON 31
eH1_2                -9.202391e-02 1 1  ON 32
eH1_3                -3.804849e-02 1 1  ON 33
eH1_4                 7.242086e-03 1 1  ON 34
eH1_5                 4.109428e-02 1 1  ON 35
eH1_6                 9.663165e-02 1 1  ON 36
eH1_7                 1.471284e-01 1 1  ON 37
eH1_8                 1.643280e-01 1 1  ON 38
eH1_9                 5.154184e-02 1 1  ON 39
eH2_0                -2.336378e-01 1 1  ON 40
eH2_1                -1.347464e-01 1 1  ON 41
eH2_2                -8.890090e-02 1 1  ON 42
eH2_3                -3.491565e-02 1 1  ON 43
eH2_4                 1.107347e-02 1 1  ON 44
eH2_5                 4.339336e-02 1 1  ON 45
eH2_6                 9.949401e-02 1 1  ON 46
eH2_7                 1.513862e-01 1 1  ON 47
eH2_8                 1.697881e-01 1 1  ON 48
eH2_9                 3.487115e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8981
    reference variance = 0.141257
====================================================
  Execution time = 2.2303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3410e-01
  Total weights = 2.0000e+06
  Execution time = 1.8836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334146544673
                                         uncertainty =       0.002819192751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334146544673
                                         uncertainty =       0.002819192751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408684830
  error estimate for blocks of size 2^( 2) =       0.000423023513
  error estimate for blocks of size 2^( 3) =       0.000438539784
  error estimate for blocks of size 2^( 4) =       0.000455037052
  error estimate for blocks of size 2^( 5) =       0.000472637954
  error estimate for blocks of size 2^( 6) =       0.000488927772
  error estimate for blocks of size 2^( 7) =       0.000503343204

      target function =                  N/A
              le_mean =     -16.914592862390
             les_mean =     286.437498113667
             stat err =       0.000479986495
             autocorr =       1.379370719170
              std dev =       0.577967629084
             le_variance =       0.334046580269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334269689386
                                         uncertainty =       0.002820698565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334269689386
                                         uncertainty =       0.002820698565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408760111
  error estimate for blocks of size 2^( 2) =       0.000423096638
  error estimate for blocks of size 2^( 3) =       0.000438612207
  error estimate for blocks of size 2^( 4) =       0.000455109485
  error estimate for blocks of size 2^( 5) =       0.000472701989
  error estimate for blocks of size 2^( 6) =       0.000488983319
  error estimate for blocks of size 2^( 7) =       0.000503398231

      target function =                  N/A
              le_mean =     -16.914592743908
             les_mean =     286.437617182474
             stat err =       0.000480048256
             autocorr =       1.379217550011
              std dev =       0.578074093262
             le_variance =       0.334169657300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334249406518
                                         uncertainty =       0.002820236406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334249406518
                                         uncertainty =       0.002820236406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408747716
  error estimate for blocks of size 2^( 2) =       0.000423084075
  error estimate for blocks of size 2^( 3) =       0.000438599047
  error estimate for blocks of size 2^( 4) =       0.000455095772
  error estimate for blocks of size 2^( 5) =       0.000472691300
  error estimate for blocks of size 2^( 6) =       0.000488975612
  error estimate for blocks of size 2^( 7) =       0.000503391226

      target function =                  N/A
              le_mean =     -16.914592672515
             les_mean =     286.437594500351
             stat err =       0.000480038478
             autocorr =       1.379245012142
              std dev =       0.578056563251
             le_variance =       0.334149390317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162820424
                                         uncertainty =       0.002819339289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334162820424
                                         uncertainty =       0.002819339289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408694781
  error estimate for blocks of size 2^( 2) =       0.000423033054
  error estimate for blocks of size 2^( 3) =       0.000438549057
  error estimate for blocks of size 2^( 4) =       0.000455046185
  error estimate for blocks of size 2^( 5) =       0.000472646353
  error estimate for blocks of size 2^( 6) =       0.000488935425
  error estimate for blocks of size 2^( 7) =       0.000503350950

      target function =                  N/A
              le_mean =     -16.914592816895
             les_mean =     286.437512843117
             stat err =       0.000479994728
             autocorr =       1.379350861100
              std dev =       0.577981702817
             le_variance =       0.334062848792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914592862390        initial  <--
     6.2500e-01     6.2500e+00             4.8418e-04       -16.914592743908
     2.5000e+00     2.5000e+01             1.2264e-04       -16.914592672515
     1.0000e+01     1.0000e+02             3.0257e-05       -16.914592816895

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.0041
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.081677e-01 1 1  ON 0
 uu_1                 1.417880e-01 1 1  ON 1
 uu_2                 4.116756e-02 1 1  ON 2
 uu_3                -2.030074e-02 1 1  ON 3
 uu_4                -6.379456e-02 1 1  ON 4
 uu_5                -9.656639e-02 1 1  ON 5
 uu_6                -1.230922e-01 1 1  ON 6
 uu_7                -1.364294e-01 1 1  ON 7
 uu_8                -1.290692e-01 1 1  ON 8
 uu_9                -9.975819e-02 1 1  ON 9
 ud_0                 4.434525e-01 1 1  ON 10
 ud_1                 1.775226e-01 1 1  ON 11
 ud_2                 5.737407e-02 1 1  ON 12
 ud_3                -1.299382e-02 1 1  ON 13
 ud_4                -6.885871e-02 1 1  ON 14
 ud_5                -1.077838e-01 1 1  ON 15
 ud_6                -1.326129e-01 1 1  ON 16
 ud_7                -1.468173e-01 1 1  ON 17
 ud_8                -1.454936e-01 1 1  ON 18
 ud_9                -1.351323e-01 1 1  ON 19
 eO_0                -7.646410e-01 1 1  ON 20
 eO_1                -4.429151e-01 1 1  ON 21
 eO_2                -2.108230e-02 1 1  ON 22
 eO_3                 3.007316e-01 1 1  ON 23
 eO_4                 5.262315e-01 1 1  ON 24
 eO_5                 4.822867e-01 1 1  ON 25
 eO_6                 2.507291e-01 1 1  ON 26
 eO_7                -4.903345e-02 1 1  ON 27
 eO_8                -2.107916e-01 1 1  ON 28
 eO_9                -7.173202e-02 1 1  ON 29
eH1_0                -2.367662e-01 1 1  ON 30
eH1_1                -1.377002e-01 1 1  ON 31
eH1_2                -9.203633e-02 1 1  ON 32
eH1_3                -3.800703e-02 1 1  ON 33
eH1_4                 7.267080e-03 1 1  ON 34
eH1_5                 4.120192e-02 1 1  ON 35
eH1_6                 9.666384e-02 1 1  ON 36
eH1_7                 1.470893e-01 1 1  ON 37
eH1_8                 1.642451e-01 1 1  ON 38
eH1_9                 5.143639e-02 1 1  ON 39
eH2_0                -2.335531e-01 1 1  ON 40
eH2_1                -1.347293e-01 1 1  ON 41
eH2_2                -8.890915e-02 1 1  ON 42
eH2_3                -3.491650e-02 1 1  ON 43
eH2_4                 1.112073e-02 1 1  ON 44
eH2_5                 4.339181e-02 1 1  ON 45
eH2_6                 9.949637e-02 1 1  ON 46
eH2_7                 1.513613e-01 1 1  ON 47
eH2_8                 1.697439e-01 1 1  ON 48
eH2_9                 3.479776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8098e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9395
    reference variance = 0.497465
====================================================
  Execution time = 2.0375e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3684e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336542160623
                                         uncertainty =       0.003640653287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336542160623
                                         uncertainty =       0.003640653287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410391369
  error estimate for blocks of size 2^( 2) =       0.000424543939
  error estimate for blocks of size 2^( 3) =       0.000439924329
  error estimate for blocks of size 2^( 4) =       0.000456035848
  error estimate for blocks of size 2^( 5) =       0.000473332991
  error estimate for blocks of size 2^( 6) =       0.000489147375
  error estimate for blocks of size 2^( 7) =       0.000500674352

      target function =                  N/A
              le_mean =     -16.915280699734
             les_mean =     286.463563133317
             stat err =       0.000479797641
             autocorr =       1.366846613093
              std dev =       0.580381039432
             le_variance =       0.336842150932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691528069973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915280699734       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915280592243       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915280673288       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915280699180       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915280779950       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915280875222       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915280821838       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915280831952       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.549794e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915280699734       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915280672504       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915280693044       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915280699361       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915280719955       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915280744631       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915280731548       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915280733727       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.137856e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915280699734       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915280692904       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915280698057       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915280699625       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915280704801       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915280711027       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915280707780       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915280708301       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.844821e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.017456 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5988e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.081667e-01 1 1  ON 0
 uu_1                 1.417869e-01 1 1  ON 1
 uu_2                 4.117343e-02 1 1  ON 2
 uu_3                -2.030212e-02 1 1  ON 3
 uu_4                -6.379206e-02 1 1  ON 4
 uu_5                -9.656790e-02 1 1  ON 5
 uu_6                -1.230948e-01 1 1  ON 6
 uu_7                -1.364311e-01 1 1  ON 7
 uu_8                -1.290714e-01 1 1  ON 8
 uu_9                -9.976158e-02 1 1  ON 9
 ud_0                 4.434521e-01 1 1  ON 10
 ud_1                 1.775170e-01 1 1  ON 11
 ud_2                 5.737101e-02 1 1  ON 12
 ud_3                -1.300009e-02 1 1  ON 13
 ud_4                -6.885872e-02 1 1  ON 14
 ud_5                -1.077850e-01 1 1  ON 15
 ud_6                -1.326090e-01 1 1  ON 16
 ud_7                -1.468133e-01 1 1  ON 17
 ud_8                -1.454896e-01 1 1  ON 18
 ud_9                -1.351289e-01 1 1  ON 19
 eO_0                -7.646496e-01 1 1  ON 20
 eO_1                -4.429215e-01 1 1  ON 21
 eO_2                -2.109005e-02 1 1  ON 22
 eO_3                 3.007358e-01 1 1  ON 23
 eO_4                 5.262368e-01 1 1  ON 24
 eO_5                 4.822981e-01 1 1  ON 25
 eO_6                 2.507372e-01 1 1  ON 26
 eO_7                -4.902865e-02 1 1  ON 27
 eO_8                -2.107969e-01 1 1  ON 28
 eO_9                -7.173725e-02 1 1  ON 29
eH1_0                -2.367732e-01 1 1  ON 30
eH1_1                -1.377036e-01 1 1  ON 31
eH1_2                -9.203857e-02 1 1  ON 32
eH1_3                -3.800755e-02 1 1  ON 33
eH1_4                 7.266508e-03 1 1  ON 34
eH1_5                 4.120053e-02 1 1  ON 35
eH1_6                 9.666640e-02 1 1  ON 36
eH1_7                 1.470949e-01 1 1  ON 37
eH1_8                 1.642503e-01 1 1  ON 38
eH1_9                 5.143992e-02 1 1  ON 39
eH2_0                -2.335547e-01 1 1  ON 40
eH2_1                -1.347244e-01 1 1  ON 41
eH2_2                -8.891507e-02 1 1  ON 42
eH2_3                -3.491620e-02 1 1  ON 43
eH2_4                 1.111855e-02 1 1  ON 44
eH2_5                 4.339155e-02 1 1  ON 45
eH2_6                 9.948902e-02 1 1  ON 46
eH2_7                 1.513580e-01 1 1  ON 47
eH2_8                 1.697495e-01 1 1  ON 48
eH2_9                 3.480676e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.857
    reference variance = 0.262717
====================================================
  Execution time = 2.0015e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3886e-01
  Total weights = 2.0000e+06
  Execution time = 1.8813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338894978557
                                         uncertainty =       0.004042102404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338894978557
                                         uncertainty =       0.004042102404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411615561
  error estimate for blocks of size 2^( 2) =       0.000426286529
  error estimate for blocks of size 2^( 3) =       0.000442428404
  error estimate for blocks of size 2^( 4) =       0.000459236209
  error estimate for blocks of size 2^( 5) =       0.000477968685
  error estimate for blocks of size 2^( 6) =       0.000497259739
  error estimate for blocks of size 2^( 7) =       0.000512252208

      target function =                  N/A
              le_mean =     -16.915286008165
             les_mean =     286.465755308646
             stat err =       0.000486679210
             autocorr =       1.397983417291
              std dev =       0.582112308791
             le_variance =       0.338854740046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338900899444
                                         uncertainty =       0.004042184861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338900899444
                                         uncertainty =       0.004042184861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411619153
  error estimate for blocks of size 2^( 2) =       0.000426289979
  error estimate for blocks of size 2^( 3) =       0.000442431763
  error estimate for blocks of size 2^( 4) =       0.000459239107
  error estimate for blocks of size 2^( 5) =       0.000477971065
  error estimate for blocks of size 2^( 6) =       0.000497260826
  error estimate for blocks of size 2^( 7) =       0.000512251712

      target function =                  N/A
              le_mean =     -16.915285750280
             les_mean =     286.465752497765
             stat err =       0.000486680677
             autocorr =       1.397967449707
              std dev =       0.582117388130
             le_variance =       0.338860653564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338898056916
                                         uncertainty =       0.004042147010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338898056916
                                         uncertainty =       0.004042147010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411617428
  error estimate for blocks of size 2^( 2) =       0.000426288320
  error estimate for blocks of size 2^( 3) =       0.000442430149
  error estimate for blocks of size 2^( 4) =       0.000459237718
  error estimate for blocks of size 2^( 5) =       0.000477969931
  error estimate for blocks of size 2^( 6) =       0.000497260327
  error estimate for blocks of size 2^( 7) =       0.000512251964

      target function =                  N/A
              le_mean =     -16.915285874834
             les_mean =     286.465753872425
             stat err =       0.000486679985
             autocorr =       1.397975183481
              std dev =       0.582114949542
             le_variance =       0.338857814480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895365884
                                         uncertainty =       0.004042108092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338895365884
                                         uncertainty =       0.004042108092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411615796
  error estimate for blocks of size 2^( 2) =       0.000426286754
  error estimate for blocks of size 2^( 3) =       0.000442428624
  error estimate for blocks of size 2^( 4) =       0.000459236399
  error estimate for blocks of size 2^( 5) =       0.000477968842
  error estimate for blocks of size 2^( 6) =       0.000497259813
  error estimate for blocks of size 2^( 7) =       0.000512252177

      target function =                  N/A
              le_mean =     -16.915285991239
             les_mean =     286.465755122856
             stat err =       0.000486679308
             autocorr =       1.397982380748
              std dev =       0.582112641054
             le_variance =       0.338855126875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915286008165        initial  <--
     6.2500e+00     6.2500e+01             4.5498e-05       -16.915285750280
     2.5000e+01     2.5000e+02             1.1379e-05       -16.915285874834
     1.0000e+02     1.0000e+03             2.8448e-06       -16.915285991239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5029
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.081677e-01 1 1  ON 0
 uu_1                 1.417880e-01 1 1  ON 1
 uu_2                 4.116756e-02 1 1  ON 2
 uu_3                -2.030074e-02 1 1  ON 3
 uu_4                -6.379456e-02 1 1  ON 4
 uu_5                -9.656639e-02 1 1  ON 5
 uu_6                -1.230922e-01 1 1  ON 6
 uu_7                -1.364294e-01 1 1  ON 7
 uu_8                -1.290692e-01 1 1  ON 8
 uu_9                -9.975819e-02 1 1  ON 9
 ud_0                 4.434525e-01 1 1  ON 10
 ud_1                 1.775226e-01 1 1  ON 11
 ud_2                 5.737407e-02 1 1  ON 12
 ud_3                -1.299382e-02 1 1  ON 13
 ud_4                -6.885871e-02 1 1  ON 14
 ud_5                -1.077838e-01 1 1  ON 15
 ud_6                -1.326129e-01 1 1  ON 16
 ud_7                -1.468173e-01 1 1  ON 17
 ud_8                -1.454936e-01 1 1  ON 18
 ud_9                -1.351323e-01 1 1  ON 19
 eO_0                -7.646410e-01 1 1  ON 20
 eO_1                -4.429151e-01 1 1  ON 21
 eO_2                -2.108230e-02 1 1  ON 22
 eO_3                 3.007316e-01 1 1  ON 23
 eO_4                 5.262315e-01 1 1  ON 24
 eO_5                 4.822867e-01 1 1  ON 25
 eO_6                 2.507291e-01 1 1  ON 26
 eO_7                -4.903345e-02 1 1  ON 27
 eO_8                -2.107916e-01 1 1  ON 28
 eO_9                -7.173202e-02 1 1  ON 29
eH1_0                -2.367662e-01 1 1  ON 30
eH1_1                -1.377002e-01 1 1  ON 31
eH1_2                -9.203633e-02 1 1  ON 32
eH1_3                -3.800703e-02 1 1  ON 33
eH1_4                 7.267080e-03 1 1  ON 34
eH1_5                 4.120192e-02 1 1  ON 35
eH1_6                 9.666384e-02 1 1  ON 36
eH1_7                 1.470893e-01 1 1  ON 37
eH1_8                 1.642451e-01 1 1  ON 38
eH1_9                 5.143639e-02 1 1  ON 39
eH2_0                -2.335531e-01 1 1  ON 40
eH2_1                -1.347293e-01 1 1  ON 41
eH2_2                -8.890915e-02 1 1  ON 42
eH2_3                -3.491650e-02 1 1  ON 43
eH2_4                 1.112073e-02 1 1  ON 44
eH2_5                 4.339181e-02 1 1  ON 45
eH2_6                 9.949637e-02 1 1  ON 46
eH2_7                 1.513613e-01 1 1  ON 47
eH2_8                 1.697439e-01 1 1  ON 48
eH2_9                 3.479776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5497e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.0219
    reference variance = 0.207783
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3945e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339460065597
                                         uncertainty =       0.003455973700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339460065597
                                         uncertainty =       0.003455973700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411978036
  error estimate for blocks of size 2^( 2) =       0.000426450337
  error estimate for blocks of size 2^( 3) =       0.000441740689
  error estimate for blocks of size 2^( 4) =       0.000458702231
  error estimate for blocks of size 2^( 5) =       0.000475879957
  error estimate for blocks of size 2^( 6) =       0.000492424438
  error estimate for blocks of size 2^( 7) =       0.000505009182

      target function =                  N/A
              le_mean =     -16.915253271133
             les_mean =     286.465244861591
             stat err =       0.000483003952
             autocorr =       1.374526895042
              std dev =       0.582624926302
             le_variance =       0.339451804748


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691525327113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915253271133       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915253305054       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915253303665       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915253290825       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915253289442       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915253290323       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915253287004       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915253290690       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.475065e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915253271133       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915253279622       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915253279272       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915253276044       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915253275700       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915253275911       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915253275070       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915253275984       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 1.368941e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915253271133       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915253273256       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915253273168       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915253272360       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915253272274       residual = 8.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915253272326       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915253272115       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915253272342       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 3.422463e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020182 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5900e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.081675e-01 1 1  ON 0
 uu_1                 1.417882e-01 1 1  ON 1
 uu_2                 4.116819e-02 1 1  ON 2
 uu_3                -2.030037e-02 1 1  ON 3
 uu_4                -6.379439e-02 1 1  ON 4
 uu_5                -9.656582e-02 1 1  ON 5
 uu_6                -1.230917e-01 1 1  ON 6
 uu_7                -1.364293e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.975956e-02 1 1  ON 9
 ud_0                 4.434518e-01 1 1  ON 10
 ud_1                 1.775227e-01 1 1  ON 11
 ud_2                 5.737381e-02 1 1  ON 12
 ud_3                -1.299445e-02 1 1  ON 13
 ud_4                -6.885862e-02 1 1  ON 14
 ud_5                -1.077836e-01 1 1  ON 15
 ud_6                -1.326121e-01 1 1  ON 16
 ud_7                -1.468167e-01 1 1  ON 17
 ud_8                -1.454937e-01 1 1  ON 18
 ud_9                -1.351323e-01 1 1  ON 19
 eO_0                -7.646420e-01 1 1  ON 20
 eO_1                -4.429156e-01 1 1  ON 21
 eO_2                -2.108276e-02 1 1  ON 22
 eO_3                 3.007317e-01 1 1  ON 23
 eO_4                 5.262323e-01 1 1  ON 24
 eO_5                 4.822878e-01 1 1  ON 25
 eO_6                 2.507304e-01 1 1  ON 26
 eO_7                -4.903297e-02 1 1  ON 27
 eO_8                -2.107925e-01 1 1  ON 28
 eO_9                -7.173279e-02 1 1  ON 29
eH1_0                -2.367666e-01 1 1  ON 30
eH1_1                -1.377002e-01 1 1  ON 31
eH1_2                -9.203641e-02 1 1  ON 32
eH1_3                -3.800700e-02 1 1  ON 33
eH1_4                 7.267271e-03 1 1  ON 34
eH1_5                 4.120165e-02 1 1  ON 35
eH1_6                 9.666360e-02 1 1  ON 36
eH1_7                 1.470893e-01 1 1  ON 37
eH1_8                 1.642455e-01 1 1  ON 38
eH1_9                 5.143682e-02 1 1  ON 39
eH2_0                -2.335536e-01 1 1  ON 40
eH2_1                -1.347296e-01 1 1  ON 41
eH2_2                -8.890938e-02 1 1  ON 42
eH2_3                -3.491622e-02 1 1  ON 43
eH2_4                 1.112018e-02 1 1  ON 44
eH2_5                 4.339179e-02 1 1  ON 45
eH2_6                 9.949609e-02 1 1  ON 46
eH2_7                 1.513612e-01 1 1  ON 47
eH2_8                 1.697446e-01 1 1  ON 48
eH2_9                 3.479866e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9381
    reference variance = 0.289015
====================================================
  Execution time = 2.0402e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.5468e-01
  Total weights = 2.0000e+06
  Execution time = 1.8748e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354660584048
                                         uncertainty =       0.009291155964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354660584048
                                         uncertainty =       0.009291155964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421117789
  error estimate for blocks of size 2^( 2) =       0.000435116156
  error estimate for blocks of size 2^( 3) =       0.000450270992
  error estimate for blocks of size 2^( 4) =       0.000466355396
  error estimate for blocks of size 2^( 5) =       0.000482579801
  error estimate for blocks of size 2^( 6) =       0.000499842569
  error estimate for blocks of size 2^( 7) =       0.000512858361

      target function =                  N/A
              le_mean =     -16.914747909091
             les_mean =     286.463377034886
             stat err =       0.000490409032
             autocorr =       1.356156297077
              std dev =       0.595550488318
             le_variance =       0.354680384135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354657656899
                                         uncertainty =       0.009291100555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354657656899
                                         uncertainty =       0.009291100555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421116052
  error estimate for blocks of size 2^( 2) =       0.000435114477
  error estimate for blocks of size 2^( 3) =       0.000450269341
  error estimate for blocks of size 2^( 4) =       0.000466353716
  error estimate for blocks of size 2^( 5) =       0.000482578060
  error estimate for blocks of size 2^( 6) =       0.000499840783
  error estimate for blocks of size 2^( 7) =       0.000512856563

      target function =                  N/A
              le_mean =     -16.914747920629
             les_mean =     286.463374499118
             stat err =       0.000490407281
             autocorr =       1.356157801146
              std dev =       0.595548031685
             le_variance =       0.354677458043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354659110616
                                         uncertainty =       0.009291128059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354659110616
                                         uncertainty =       0.009291128059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421116914
  error estimate for blocks of size 2^( 2) =       0.000435115311
  error estimate for blocks of size 2^( 3) =       0.000450270161
  error estimate for blocks of size 2^( 4) =       0.000466354551
  error estimate for blocks of size 2^( 5) =       0.000482578925
  error estimate for blocks of size 2^( 6) =       0.000499841670
  error estimate for blocks of size 2^( 7) =       0.000512857456

      target function =                  N/A
              le_mean =     -16.914747914880
             les_mean =     286.463375757844
             stat err =       0.000490408151
             autocorr =       1.356157057306
              std dev =       0.595549251730
             le_variance =       0.354678911236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354660399550
                                         uncertainty =       0.009291152470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354660399550
                                         uncertainty =       0.009291152470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421117679
  error estimate for blocks of size 2^( 2) =       0.000435116050
  error estimate for blocks of size 2^( 3) =       0.000450270888
  error estimate for blocks of size 2^( 4) =       0.000466355290
  error estimate for blocks of size 2^( 5) =       0.000482579691
  error estimate for blocks of size 2^( 6) =       0.000499842456
  error estimate for blocks of size 2^( 7) =       0.000512858248

      target function =                  N/A
              le_mean =     -16.914747909814
             les_mean =     286.463376874907
             stat err =       0.000490408921
             autocorr =       1.356156392364
              std dev =       0.595550333476
             le_variance =       0.354680199704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914747909091        initial
     6.2500e+01     6.2500e+02             5.4751e-06       -16.914747920629  <--
     2.5000e+02     2.5000e+03             1.3689e-06       -16.914747914880
     1.0000e+03     1.0000e+04             3.4225e-07       -16.914747909814

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 2.9850e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.081670e-01 1 1  ON 0
 uu_1                 1.417887e-01 1 1  ON 1
 uu_2                 4.117008e-02 1 1  ON 2
 uu_3                -2.029928e-02 1 1  ON 3
 uu_4                -6.379390e-02 1 1  ON 4
 uu_5                -9.656413e-02 1 1  ON 5
 uu_6                -1.230902e-01 1 1  ON 6
 uu_7                -1.364289e-01 1 1  ON 7
 uu_8                -1.290733e-01 1 1  ON 8
 uu_9                -9.976366e-02 1 1  ON 9
 ud_0                 4.434498e-01 1 1  ON 10
 ud_1                 1.775229e-01 1 1  ON 11
 ud_2                 5.737303e-02 1 1  ON 12
 ud_3                -1.299633e-02 1 1  ON 13
 ud_4                -6.885836e-02 1 1  ON 14
 ud_5                -1.077831e-01 1 1  ON 15
 ud_6                -1.326096e-01 1 1  ON 16
 ud_7                -1.468147e-01 1 1  ON 17
 ud_8                -1.454940e-01 1 1  ON 18
 ud_9                -1.351322e-01 1 1  ON 19
 eO_0                -7.646453e-01 1 1  ON 20
 eO_1                -4.429171e-01 1 1  ON 21
 eO_2                -2.108414e-02 1 1  ON 22
 eO_3                 3.007321e-01 1 1  ON 23
 eO_4                 5.262347e-01 1 1  ON 24
 eO_5                 4.822912e-01 1 1  ON 25
 eO_6                 2.507343e-01 1 1  ON 26
 eO_7                -4.903155e-02 1 1  ON 27
 eO_8                -2.107950e-01 1 1  ON 28
 eO_9                -7.173511e-02 1 1  ON 29
eH1_0                -2.367680e-01 1 1  ON 30
eH1_1                -1.377002e-01 1 1  ON 31
eH1_2                -9.203667e-02 1 1  ON 32
eH1_3                -3.800693e-02 1 1  ON 33
eH1_4                 7.267839e-03 1 1  ON 34
eH1_5                 4.120083e-02 1 1  ON 35
eH1_6                 9.666288e-02 1 1  ON 36
eH1_7                 1.470895e-01 1 1  ON 37
eH1_8                 1.642468e-01 1 1  ON 38
eH1_9                 5.143813e-02 1 1  ON 39
eH2_0                -2.335549e-01 1 1  ON 40
eH2_1                -1.347306e-01 1 1  ON 41
eH2_2                -8.891005e-02 1 1  ON 42
eH2_3                -3.491538e-02 1 1  ON 43
eH2_4                 1.111853e-02 1 1  ON 44
eH2_5                 4.339170e-02 1 1  ON 45
eH2_6                 9.949524e-02 1 1  ON 46
eH2_7                 1.513612e-01 1 1  ON 47
eH2_8                 1.697468e-01 1 1  ON 48
eH2_9                 3.480133e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9543
    reference variance = 0.314396
====================================================
  Execution time = 2.0360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.3614e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336149801736
                                         uncertainty =       0.006087594280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336149801736
                                         uncertainty =       0.006087594280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409965864
  error estimate for blocks of size 2^( 2) =       0.000424690631
  error estimate for blocks of size 2^( 3) =       0.000440818818
  error estimate for blocks of size 2^( 4) =       0.000458439826
  error estimate for blocks of size 2^( 5) =       0.000476717642
  error estimate for blocks of size 2^( 6) =       0.000495050201
  error estimate for blocks of size 2^( 7) =       0.000511657269

      target function =                  N/A
              le_mean =     -16.914285995881
             les_mean =     286.429214601576
             stat err =       0.000485466235
             autocorr =       1.402241012966
              std dev =       0.579779284890
             le_variance =       0.336144019188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691428599588e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914285995881       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914286009705       residual = 6.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914286051884       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914286060542       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914286088542       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914286160827       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914286103907       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914286109142       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.562451e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914285995881       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914285999354       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914286009852       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914286011685       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914286018869       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914286037208       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914286023093       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914286024400       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.913069e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914285995881       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914285996751       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914285999372       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914285999809       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914286001616       residual = 5.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914286006218       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914286002698       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914286003024       residual = 8.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 9.787025e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5936e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.081673e-01 1 1  ON 0
 uu_1                 1.417890e-01 1 1  ON 1
 uu_2                 4.117077e-02 1 1  ON 2
 uu_3                -2.029859e-02 1 1  ON 3
 uu_4                -6.379510e-02 1 1  ON 4
 uu_5                -9.656629e-02 1 1  ON 5
 uu_6                -1.230926e-01 1 1  ON 6
 uu_7                -1.364289e-01 1 1  ON 7
 uu_8                -1.290721e-01 1 1  ON 8
 uu_9                -9.976369e-02 1 1  ON 9
 ud_0                 4.434477e-01 1 1  ON 10
 ud_1                 1.775200e-01 1 1  ON 11
 ud_2                 5.737019e-02 1 1  ON 12
 ud_3                -1.299861e-02 1 1  ON 13
 ud_4                -6.885700e-02 1 1  ON 14
 ud_5                -1.077838e-01 1 1  ON 15
 ud_6                -1.326075e-01 1 1  ON 16
 ud_7                -1.468133e-01 1 1  ON 17
 ud_8                -1.454910e-01 1 1  ON 18
 ud_9                -1.351299e-01 1 1  ON 19
 eO_0                -7.646479e-01 1 1  ON 20
 eO_1                -4.429187e-01 1 1  ON 21
 eO_2                -2.108684e-02 1 1  ON 22
 eO_3                 3.007306e-01 1 1  ON 23
 eO_4                 5.262370e-01 1 1  ON 24
 eO_5                 4.822946e-01 1 1  ON 25
 eO_6                 2.507378e-01 1 1  ON 26
 eO_7                -4.902954e-02 1 1  ON 27
 eO_8                -2.107957e-01 1 1  ON 28
 eO_9                -7.173694e-02 1 1  ON 29
eH1_0                -2.367698e-01 1 1  ON 30
eH1_1                -1.376993e-01 1 1  ON 31
eH1_2                -9.203743e-02 1 1  ON 32
eH1_3                -3.800713e-02 1 1  ON 33
eH1_4                 7.268544e-03 1 1  ON 34
eH1_5                 4.119926e-02 1 1  ON 35
eH1_6                 9.666023e-02 1 1  ON 36
eH1_7                 1.470887e-01 1 1  ON 37
eH1_8                 1.642499e-01 1 1  ON 38
eH1_9                 5.144117e-02 1 1  ON 39
eH2_0                -2.335584e-01 1 1  ON 40
eH2_1                -1.347334e-01 1 1  ON 41
eH2_2                -8.891033e-02 1 1  ON 42
eH2_3                -3.491662e-02 1 1  ON 43
eH2_4                 1.111604e-02 1 1  ON 44
eH2_5                 4.339339e-02 1 1  ON 45
eH2_6                 9.949628e-02 1 1  ON 46
eH2_7                 1.513618e-01 1 1  ON 47
eH2_8                 1.697490e-01 1 1  ON 48
eH2_9                 3.480524e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9705
    reference variance = 0.217291
====================================================
  Execution time = 2.0108e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3084e-01
  Total weights = 2.0000e+06
  Execution time = 1.8774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330899067630
                                         uncertainty =       0.002428018230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330899067630
                                         uncertainty =       0.002428018230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406720423
  error estimate for blocks of size 2^( 2) =       0.000420966246
  error estimate for blocks of size 2^( 3) =       0.000436128496
  error estimate for blocks of size 2^( 4) =       0.000453870626
  error estimate for blocks of size 2^( 5) =       0.000469984537
  error estimate for blocks of size 2^( 6) =       0.000486319807
  error estimate for blocks of size 2^( 7) =       0.000496301143

      target function =                  N/A
              le_mean =     -16.915569960952
             les_mean =     286.467349943198
             stat err =       0.000476619028
             autocorr =       1.373253747933
              std dev =       0.575189538129
             le_variance =       0.330843004773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900121648
                                         uncertainty =       0.002428009755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330900121648
                                         uncertainty =       0.002428009755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406721070
  error estimate for blocks of size 2^( 2) =       0.000420966948
  error estimate for blocks of size 2^( 3) =       0.000436129389
  error estimate for blocks of size 2^( 4) =       0.000453871579
  error estimate for blocks of size 2^( 5) =       0.000469985433
  error estimate for blocks of size 2^( 6) =       0.000486320315
  error estimate for blocks of size 2^( 7) =       0.000496301398

      target function =                  N/A
              le_mean =     -16.915569990747
             les_mean =     286.467352003823
             stat err =       0.000476619681
             autocorr =       1.373253141221
              std dev =       0.575190453132
             le_variance =       0.330844057374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330899626289
                                         uncertainty =       0.002428014264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330899626289
                                         uncertainty =       0.002428014264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406720766
  error estimate for blocks of size 2^( 2) =       0.000420966615
  error estimate for blocks of size 2^( 3) =       0.000436128960
  error estimate for blocks of size 2^( 4) =       0.000453871120
  error estimate for blocks of size 2^( 5) =       0.000469985002
  error estimate for blocks of size 2^( 6) =       0.000486320076
  error estimate for blocks of size 2^( 7) =       0.000496301286

      target function =                  N/A
              le_mean =     -16.915569975863
             les_mean =     286.467351005602
             stat err =       0.000476619371
             autocorr =       1.373253406159
              std dev =       0.575190023120
             le_variance =       0.330843562697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330899138397
                                         uncertainty =       0.002428017743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330899138397
                                         uncertainty =       0.002428017743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406720466
  error estimate for blocks of size 2^( 2) =       0.000420966292
  error estimate for blocks of size 2^( 3) =       0.000436128554
  error estimate for blocks of size 2^( 4) =       0.000453870688
  error estimate for blocks of size 2^( 5) =       0.000469984596
  error estimate for blocks of size 2^( 6) =       0.000486319841
  error estimate for blocks of size 2^( 7) =       0.000496301162

      target function =                  N/A
              le_mean =     -16.915569962799
             les_mean =     286.467350076370
             stat err =       0.000476619072
             autocorr =       1.373253703922
              std dev =       0.575189599564
             le_variance =       0.330843075447


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915569960952        initial
     1.5625e+01     1.5625e+02             1.5625e-05       -16.915569990747  <--
     6.2500e+01     6.2500e+02             3.9131e-06       -16.915569975863
     2.5000e+02     2.5000e+03             9.7870e-07       -16.915569962799

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.9567e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.081684e-01 1 1  ON 0
 uu_1                 1.417896e-01 1 1  ON 1
 uu_2                 4.117279e-02 1 1  ON 2
 uu_3                -2.029657e-02 1 1  ON 3
 uu_4                -6.379866e-02 1 1  ON 4
 uu_5                -9.657270e-02 1 1  ON 5
 uu_6                -1.231000e-01 1 1  ON 6
 uu_7                -1.364290e-01 1 1  ON 7
 uu_8                -1.290685e-01 1 1  ON 8
 uu_9                -9.976374e-02 1 1  ON 9
 ud_0                 4.434416e-01 1 1  ON 10
 ud_1                 1.775113e-01 1 1  ON 11
 ud_2                 5.736172e-02 1 1  ON 12
 ud_3                -1.300535e-02 1 1  ON 13
 ud_4                -6.885311e-02 1 1  ON 14
 ud_5                -1.077859e-01 1 1  ON 15
 ud_6                -1.326012e-01 1 1  ON 16
 ud_7                -1.468090e-01 1 1  ON 17
 ud_8                -1.454819e-01 1 1  ON 18
 ud_9                -1.351230e-01 1 1  ON 19
 eO_0                -7.646557e-01 1 1  ON 20
 eO_1                -4.429237e-01 1 1  ON 21
 eO_2                -2.109491e-02 1 1  ON 22
 eO_3                 3.007261e-01 1 1  ON 23
 eO_4                 5.262438e-01 1 1  ON 24
 eO_5                 4.823049e-01 1 1  ON 25
 eO_6                 2.507482e-01 1 1  ON 26
 eO_7                -4.902352e-02 1 1  ON 27
 eO_8                -2.107978e-01 1 1  ON 28
 eO_9                -7.174241e-02 1 1  ON 29
eH1_0                -2.367750e-01 1 1  ON 30
eH1_1                -1.376969e-01 1 1  ON 31
eH1_2                -9.203968e-02 1 1  ON 32
eH1_3                -3.800773e-02 1 1  ON 33
eH1_4                 7.270637e-03 1 1  ON 34
eH1_5                 4.119457e-02 1 1  ON 35
eH1_6                 9.665228e-02 1 1  ON 36
eH1_7                 1.470865e-01 1 1  ON 37
eH1_8                 1.642590e-01 1 1  ON 38
eH1_9                 5.145026e-02 1 1  ON 39
eH2_0                -2.335688e-01 1 1  ON 40
eH2_1                -1.347415e-01 1 1  ON 41
eH2_2                -8.891126e-02 1 1  ON 42
eH2_3                -3.492033e-02 1 1  ON 43
eH2_4                 1.110860e-02 1 1  ON 44
eH2_5                 4.339841e-02 1 1  ON 45
eH2_6                 9.949942e-02 1 1  ON 46
eH2_7                 1.513636e-01 1 1  ON 47
eH2_8                 1.697558e-01 1 1  ON 48
eH2_9                 3.481695e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5508e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9406
    reference variance = 0.20671
====================================================
  Execution time = 2.0512e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3866e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338767006435
                                         uncertainty =       0.003653484133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338767006435
                                         uncertainty =       0.003653484133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411494719
  error estimate for blocks of size 2^( 2) =       0.000425977480
  error estimate for blocks of size 2^( 3) =       0.000441984330
  error estimate for blocks of size 2^( 4) =       0.000458479961
  error estimate for blocks of size 2^( 5) =       0.000476292512
  error estimate for blocks of size 2^( 6) =       0.000492322409
  error estimate for blocks of size 2^( 7) =       0.000505557170

      target function =                  N/A
              le_mean =     -16.915153440418
             les_mean =     286.461071551429
             stat err =       0.000483163013
             autocorr =       1.378665251518
              std dev =       0.581941412761
             le_variance =       0.338655807886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691515344042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915153440418       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915153786107       residual = 7.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915153867560       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915153977405       residual = 9.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915154073672       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915153920322       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915153950279       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915153977528       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.263772e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915153440418       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915153528691       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915153550558       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915153580956       residual = 9.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915153604254       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915153565246       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915153571617       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915153578070       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.822181e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915153440418       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915153462605       residual = 7.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915153468174       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915153475973       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915153481745       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915153471953       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915153473471       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915153475054       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.559150e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025540 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6031e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.081662e-01 1 1  ON 0
 uu_1                 1.417861e-01 1 1  ON 1
 uu_2                 4.117443e-02 1 1  ON 2
 uu_3                -2.028674e-02 1 1  ON 3
 uu_4                -6.380008e-02 1 1  ON 4
 uu_5                -9.657438e-02 1 1  ON 5
 uu_6                -1.231071e-01 1 1  ON 6
 uu_7                -1.364323e-01 1 1  ON 7
 uu_8                -1.290689e-01 1 1  ON 8
 uu_9                -9.976816e-02 1 1  ON 9
 ud_0                 4.434443e-01 1 1  ON 10
 ud_1                 1.775079e-01 1 1  ON 11
 ud_2                 5.735333e-02 1 1  ON 12
 ud_3                -1.301805e-02 1 1  ON 13
 ud_4                -6.885800e-02 1 1  ON 14
 ud_5                -1.077820e-01 1 1  ON 15
 ud_6                -1.325950e-01 1 1  ON 16
 ud_7                -1.467967e-01 1 1  ON 17
 ud_8                -1.454817e-01 1 1  ON 18
 ud_9                -1.351220e-01 1 1  ON 19
 eO_0                -7.646711e-01 1 1  ON 20
 eO_1                -4.429316e-01 1 1  ON 21
 eO_2                -2.110182e-02 1 1  ON 22
 eO_3                 3.007291e-01 1 1  ON 23
 eO_4                 5.262544e-01 1 1  ON 24
 eO_5                 4.823215e-01 1 1  ON 25
 eO_6                 2.507593e-01 1 1  ON 26
 eO_7                -4.901659e-02 1 1  ON 27
 eO_8                -2.108058e-01 1 1  ON 28
 eO_9                -7.175154e-02 1 1  ON 29
eH1_0                -2.367852e-01 1 1  ON 30
eH1_1                -1.377028e-01 1 1  ON 31
eH1_2                -9.203973e-02 1 1  ON 32
eH1_3                -3.800550e-02 1 1  ON 33
eH1_4                 7.275592e-03 1 1  ON 34
eH1_5                 4.118881e-02 1 1  ON 35
eH1_6                 9.664817e-02 1 1  ON 36
eH1_7                 1.470861e-01 1 1  ON 37
eH1_8                 1.642694e-01 1 1  ON 38
eH1_9                 5.146061e-02 1 1  ON 39
eH2_0                -2.335774e-01 1 1  ON 40
eH2_1                -1.347451e-01 1 1  ON 41
eH2_2                -8.891728e-02 1 1  ON 42
eH2_3                -3.492283e-02 1 1  ON 43
eH2_4                 1.110470e-02 1 1  ON 44
eH2_5                 4.339813e-02 1 1  ON 45
eH2_6                 9.949566e-02 1 1  ON 46
eH2_7                 1.513608e-01 1 1  ON 47
eH2_8                 1.697659e-01 1 1  ON 48
eH2_9                 3.483518e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9915
    reference variance = 0.249919
====================================================
  Execution time = 2.0779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3996e-01
  Total weights = 2.0000e+06
  Execution time = 1.8932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965503847
                                         uncertainty =       0.003781589040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339965503847
                                         uncertainty =       0.003781589040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412284875
  error estimate for blocks of size 2^( 2) =       0.000427060198
  error estimate for blocks of size 2^( 3) =       0.000442985665
  error estimate for blocks of size 2^( 4) =       0.000459453260
  error estimate for blocks of size 2^( 5) =       0.000477775571
  error estimate for blocks of size 2^( 6) =       0.000495475853
  error estimate for blocks of size 2^( 7) =       0.000507541455

      target function =                  N/A
              le_mean =     -16.915142978998
             les_mean =     286.462019466246
             stat err =       0.000485061535
             autocorr =       1.384200073705
              std dev =       0.583058861754
             le_variance =       0.339957636270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339983793694
                                         uncertainty =       0.003781551434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339983793694
                                         uncertainty =       0.003781551434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412295970
  error estimate for blocks of size 2^( 2) =       0.000427070847
  error estimate for blocks of size 2^( 3) =       0.000442995767
  error estimate for blocks of size 2^( 4) =       0.000459462623
  error estimate for blocks of size 2^( 5) =       0.000477783371
  error estimate for blocks of size 2^( 6) =       0.000495482761
  error estimate for blocks of size 2^( 7) =       0.000507546904

      target function =                  N/A
              le_mean =     -16.915143455072
             les_mean =     286.462053868659
             stat err =       0.000485068915
             autocorr =       1.384167696548
              std dev =       0.583074551810
             le_variance =       0.339975932969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339975246200
                                         uncertainty =       0.003781569519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339975246200
                                         uncertainty =       0.003781569519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412290785
  error estimate for blocks of size 2^( 2) =       0.000427065868
  error estimate for blocks of size 2^( 3) =       0.000442991047
  error estimate for blocks of size 2^( 4) =       0.000459458255
  error estimate for blocks of size 2^( 5) =       0.000477779752
  error estimate for blocks of size 2^( 6) =       0.000495479593
  error estimate for blocks of size 2^( 7) =       0.000507544461

      target function =                  N/A
              le_mean =     -16.915143223165
             les_mean =     286.462037472764
             stat err =       0.000485065515
             autocorr =       1.384183108433
              std dev =       0.583067219582
             le_variance =       0.339967382551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339966739356
                                         uncertainty =       0.003781586552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339966739356
                                         uncertainty =       0.003781586552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412285624
  error estimate for blocks of size 2^( 2) =       0.000427060917
  error estimate for blocks of size 2^( 3) =       0.000442986348
  error estimate for blocks of size 2^( 4) =       0.000459453893
  error estimate for blocks of size 2^( 5) =       0.000477776102
  error estimate for blocks of size 2^( 6) =       0.000495476329
  error estimate for blocks of size 2^( 7) =       0.000507541839

      target function =                  N/A
              le_mean =     -16.915143009392
             les_mean =     286.462021730476
             stat err =       0.000485062041
             autocorr =       1.384197927203
              std dev =       0.583059921695
             le_variance =       0.339958872287


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915142978998        initial
     3.9062e+00     3.9062e+01             7.2638e-05       -16.915143455072  <--
     1.5625e+01     1.5625e+02             1.8222e-05       -16.915143223165
     6.2500e+01     6.2500e+02             4.5592e-06       -16.915143009392

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 3.0311e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732896e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.848
    reference variance = 0.219206
====================================================
  Execution time = 2.0664e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338461067413
                                         uncertainty =       0.004453985928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338461067413
                                         uncertainty =       0.004453985928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411378752
  error estimate for blocks of size 2^( 2) =       0.000425473434
  error estimate for blocks of size 2^( 3) =       0.000440588466
  error estimate for blocks of size 2^( 4) =       0.000455710925
  error estimate for blocks of size 2^( 5) =       0.000470892446
  error estimate for blocks of size 2^( 6) =       0.000487062699
  error estimate for blocks of size 2^( 7) =       0.000498038516

      target function =                  N/A
              le_mean =     -16.915478734708
             les_mean =     286.471885610531
             stat err =       0.000477926147
             autocorr =       1.349701928887
              std dev =       0.581777410543
             le_variance =       0.338464955418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691547873471e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915478734708       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915479850108       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915479284287       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915479596848       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915478944407       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915479217438       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915479320214       residual = 6.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915479410174       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.915479376626       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.660184e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915478734708       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915479042983       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915478891232       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915478989925       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915478798985       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915478855964       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915478867334       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915478891131       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.915478884605       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 7.059798e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915478734708       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915478813865       residual = 9.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915478775372       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915478801838       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915478752185       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915478765147       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915478766768       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915478772505       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.915478771054       residual = 1.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.879696e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6288e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.081504e-01 1 1  ON 0
 uu_1                 1.417866e-01 1 1  ON 1
 uu_2                 4.124979e-02 1 1  ON 2
 uu_3                -2.023000e-02 1 1  ON 3
 uu_4                -6.382237e-02 1 1  ON 4
 uu_5                -9.658697e-02 1 1  ON 5
 uu_6                -1.231178e-01 1 1  ON 6
 uu_7                -1.364512e-01 1 1  ON 7
 uu_8                -1.291236e-01 1 1  ON 8
 uu_9                -9.982622e-02 1 1  ON 9
 ud_0                 4.434317e-01 1 1  ON 10
 ud_1                 1.774935e-01 1 1  ON 11
 ud_2                 5.729977e-02 1 1  ON 12
 ud_3                -1.307794e-02 1 1  ON 13
 ud_4                -6.886398e-02 1 1  ON 14
 ud_5                -1.077554e-01 1 1  ON 15
 ud_6                -1.325131e-01 1 1  ON 16
 ud_7                -1.467471e-01 1 1  ON 17
 ud_8                -1.454979e-01 1 1  ON 18
 ud_9                -1.351245e-01 1 1  ON 19
 eO_0                -7.647652e-01 1 1  ON 20
 eO_1                -4.430064e-01 1 1  ON 21
 eO_2                -2.115175e-02 1 1  ON 22
 eO_3                 3.007822e-01 1 1  ON 23
 eO_4                 5.263211e-01 1 1  ON 24
 eO_5                 4.824389e-01 1 1  ON 25
 eO_6                 2.508408e-01 1 1  ON 26
 eO_7                -4.897461e-02 1 1  ON 27
 eO_8                -2.108696e-01 1 1  ON 28
 eO_9                -7.181970e-02 1 1  ON 29
eH1_0                -2.368635e-01 1 1  ON 30
eH1_1                -1.377087e-01 1 1  ON 31
eH1_2                -9.207919e-02 1 1  ON 32
eH1_3                -3.800869e-02 1 1  ON 33
eH1_4                 7.313734e-03 1 1  ON 34
eH1_5                 4.113202e-02 1 1  ON 35
eH1_6                 9.661699e-02 1 1  ON 36
eH1_7                 1.471029e-01 1 1  ON 37
eH1_8                 1.643480e-01 1 1  ON 38
eH1_9                 5.154283e-02 1 1  ON 39
eH2_0                -2.336227e-01 1 1  ON 40
eH2_1                -1.347722e-01 1 1  ON 41
eH2_2                -8.891973e-02 1 1  ON 42
eH2_3                -3.492402e-02 1 1  ON 43
eH2_4                 1.106663e-02 1 1  ON 44
eH2_5                 4.340928e-02 1 1  ON 45
eH2_6                 9.947872e-02 1 1  ON 46
eH2_7                 1.513399e-01 1 1  ON 47
eH2_8                 1.698180e-01 1 1  ON 48
eH2_9                 3.492627e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9515
    reference variance = 0.607874
====================================================
  Execution time = 2.0354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4409e-01
  Total weights = 2.0000e+06
  Execution time = 1.8889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343688568969
                                         uncertainty =       0.004947007877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343688568969
                                         uncertainty =       0.004947007877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414798128
  error estimate for blocks of size 2^( 2) =       0.000428740542
  error estimate for blocks of size 2^( 3) =       0.000443251706
  error estimate for blocks of size 2^( 4) =       0.000459636799
  error estimate for blocks of size 2^( 5) =       0.000475193439
  error estimate for blocks of size 2^( 6) =       0.000490532412
  error estimate for blocks of size 2^( 7) =       0.000499702557

      target function =                  N/A
              le_mean =     -16.915152017529
             les_mean =     286.466482578415
             stat err =       0.000481266302
             autocorr =       1.346162011307
              std dev =       0.586613138568
             le_variance =       0.344114974340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343616395897
                                         uncertainty =       0.004946501163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343616395897
                                         uncertainty =       0.004946501163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414754444
  error estimate for blocks of size 2^( 2) =       0.000428696510
  error estimate for blocks of size 2^( 3) =       0.000443207545
  error estimate for blocks of size 2^( 4) =       0.000459593394
  error estimate for blocks of size 2^( 5) =       0.000475152248
  error estimate for blocks of size 2^( 6) =       0.000490488560
  error estimate for blocks of size 2^( 7) =       0.000499655066

      target function =                  N/A
              le_mean =     -16.915151634509
             les_mean =     286.466397143273
             stat err =       0.000481222317
             autocorr =       1.346199500744
              std dev =       0.586551359091
             le_variance =       0.344042496852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343638569143
                                         uncertainty =       0.004946595361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343638569143
                                         uncertainty =       0.004946595361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414767887
  error estimate for blocks of size 2^( 2) =       0.000428710206
  error estimate for blocks of size 2^( 3) =       0.000443221532
  error estimate for blocks of size 2^( 4) =       0.000459607203
  error estimate for blocks of size 2^( 5) =       0.000475165411
  error estimate for blocks of size 2^( 6) =       0.000490503049
  error estimate for blocks of size 2^( 7) =       0.000499670886

      target function =                  N/A
              le_mean =     -16.915151741487
             les_mean =     286.466423065211
             stat err =       0.000481236637
             autocorr =       1.346192351159
              std dev =       0.586570370628
             le_variance =       0.344064799699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343681626376
                                         uncertainty =       0.004946948591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343681626376
                                         uncertainty =       0.004946948591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414793930
  error estimate for blocks of size 2^( 2) =       0.000428736334
  error estimate for blocks of size 2^( 3) =       0.000443247528
  error estimate for blocks of size 2^( 4) =       0.000459632700
  error estimate for blocks of size 2^( 5) =       0.000475189555
  error estimate for blocks of size 2^( 6) =       0.000490528362
  error estimate for blocks of size 2^( 7) =       0.000499698196

      target function =                  N/A
              le_mean =     -16.915151971017
             les_mean =     286.466474039849
             stat err =       0.000481262203
             autocorr =       1.346166332385
              std dev =       0.586607201875
             le_variance =       0.344108009291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915152017529        initial  <--
     9.7656e-01     9.7656e+00             2.6602e-04       -16.915151634509
     3.9062e+00     3.9062e+01             7.0598e-05       -16.915151741487
     1.5625e+01     1.5625e+02             1.8797e-05       -16.915151971017

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9034
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732896e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.923
    reference variance = 0.247433
====================================================
  Execution time = 2.2865e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339684466908
                                         uncertainty =       0.003853838146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339684466908
                                         uncertainty =       0.003853838146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412075836
  error estimate for blocks of size 2^( 2) =       0.000425967064
  error estimate for blocks of size 2^( 3) =       0.000441740542
  error estimate for blocks of size 2^( 4) =       0.000457867938
  error estimate for blocks of size 2^( 5) =       0.000475485739
  error estimate for blocks of size 2^( 6) =       0.000491749729
  error estimate for blocks of size 2^( 7) =       0.000506233702

      target function =                  N/A
              le_mean =     -16.916254962330
             les_mean =     286.499294769215
             stat err =       0.000482834277
             autocorr =       1.372909440161
              std dev =       0.582763235340
             le_variance =       0.339612988464


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691625496233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916254962330       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916255197052       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916255194827       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916255251464       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916255202339       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916255244275       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916255245251       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916255245382       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 3.418693e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916254962330       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916255021458       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916255020903       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916255035399       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916255023189       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916255033726       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916255033900       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916255033973       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 8.542226e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916254962330       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916254977140       residual = 6.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916254977002       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916254980648       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916254977600       residual = 5.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916254980238       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916254980276       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916254980297       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.135256e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8446e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.081583e-01 1 1  ON 0
 uu_1                 1.417772e-01 1 1  ON 1
 uu_2                 4.118085e-02 1 1  ON 2
 uu_3                -2.025746e-02 1 1  ON 3
 uu_4                -6.380113e-02 1 1  ON 4
 uu_5                -9.658028e-02 1 1  ON 5
 uu_6                -1.231261e-01 1 1  ON 6
 uu_7                -1.364448e-01 1 1  ON 7
 uu_8                -1.290750e-01 1 1  ON 8
 uu_9                -9.978319e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774945e-01 1 1  ON 11
 ud_2                 5.732703e-02 1 1  ON 12
 ud_3                -1.305845e-02 1 1  ON 13
 ud_4                -6.887511e-02 1 1  ON 14
 ud_5                -1.077676e-01 1 1  ON 15
 ud_6                -1.325741e-01 1 1  ON 16
 ud_7                -1.467573e-01 1 1  ON 17
 ud_8                -1.454799e-01 1 1  ON 18
 ud_9                -1.351172e-01 1 1  ON 19
 eO_0                -7.647198e-01 1 1  ON 20
 eO_1                -4.429617e-01 1 1  ON 21
 eO_2                -2.112501e-02 1 1  ON 22
 eO_3                 3.007355e-01 1 1  ON 23
 eO_4                 5.262901e-01 1 1  ON 24
 eO_5                 4.823802e-01 1 1  ON 25
 eO_6                 2.507992e-01 1 1  ON 26
 eO_7                -4.899441e-02 1 1  ON 27
 eO_8                -2.108329e-01 1 1  ON 28
 eO_9                -7.178178e-02 1 1  ON 29
eH1_0                -2.368170e-01 1 1  ON 30
eH1_1                -1.377203e-01 1 1  ON 31
eH1_2                -9.204292e-02 1 1  ON 32
eH1_3                -3.799878e-02 1 1  ON 33
eH1_4                 7.289340e-03 1 1  ON 34
eH1_5                 4.116975e-02 1 1  ON 35
eH1_6                 9.663526e-02 1 1  ON 36
eH1_7                 1.470859e-01 1 1  ON 37
eH1_8                 1.643036e-01 1 1  ON 38
eH1_9                 5.149506e-02 1 1  ON 39
eH2_0                -2.336048e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893710e-02 1 1  ON 42
eH2_3                -3.492917e-02 1 1  ON 43
eH2_4                 1.108849e-02 1 1  ON 44
eH2_5                 4.339811e-02 1 1  ON 45
eH2_6                 9.948199e-02 1 1  ON 46
eH2_7                 1.513512e-01 1 1  ON 47
eH2_8                 1.697999e-01 1 1  ON 48
eH2_9                 3.489575e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9225
    reference variance = 0.183297
====================================================
  Execution time = 2.0273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3586e-01
  Total weights = 2.0000e+06
  Execution time = 1.8891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948685100
                                         uncertainty =       0.003104698649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948685100
                                         uncertainty =       0.003104698649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409794183
  error estimate for blocks of size 2^( 2) =       0.000423853751
  error estimate for blocks of size 2^( 3) =       0.000439494736
  error estimate for blocks of size 2^( 4) =       0.000455762044
  error estimate for blocks of size 2^( 5) =       0.000472479672
  error estimate for blocks of size 2^( 6) =       0.000487958052
  error estimate for blocks of size 2^( 7) =       0.000500824765

      target function =                  N/A
              le_mean =     -16.915384068954
             les_mean =     286.466080576621
             stat err =       0.000479256133
             autocorr =       1.367740732665
              std dev =       0.579536490926
             le_variance =       0.335862544315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335953192033
                                         uncertainty =       0.003104766376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335953192033
                                         uncertainty =       0.003104766376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409796931
  error estimate for blocks of size 2^( 2) =       0.000423856443
  error estimate for blocks of size 2^( 3) =       0.000439497291
  error estimate for blocks of size 2^( 4) =       0.000455764262
  error estimate for blocks of size 2^( 5) =       0.000472481207
  error estimate for blocks of size 2^( 6) =       0.000487958893
  error estimate for blocks of size 2^( 7) =       0.000500825283

      target function =                  N/A
              le_mean =     -16.915384024966
             les_mean =     286.466083593508
             stat err =       0.000479257411
             autocorr =       1.367729681059
              std dev =       0.579540377679
             le_variance =       0.335867049360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335951083774
                                         uncertainty =       0.003104734984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335951083774
                                         uncertainty =       0.003104734984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409795645
  error estimate for blocks of size 2^( 2) =       0.000423855182
  error estimate for blocks of size 2^( 3) =       0.000439496094
  error estimate for blocks of size 2^( 4) =       0.000455763228
  error estimate for blocks of size 2^( 5) =       0.000472480508
  error estimate for blocks of size 2^( 6) =       0.000487958536
  error estimate for blocks of size 2^( 7) =       0.000500825089

      target function =                  N/A
              le_mean =     -16.915384045219
             les_mean =     286.466082171353
             stat err =       0.000479256841
             autocorr =       1.367735005560
              std dev =       0.579538559580
             le_variance =       0.335864942040

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948989463
                                         uncertainty =       0.003104703271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335948989463
                                         uncertainty =       0.003104703271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409794368
  error estimate for blocks of size 2^( 2) =       0.000423853933
  error estimate for blocks of size 2^( 3) =       0.000439494908
  error estimate for blocks of size 2^( 4) =       0.000455762194
  error estimate for blocks of size 2^( 5) =       0.000472479779
  error estimate for blocks of size 2^( 6) =       0.000487958115
  error estimate for blocks of size 2^( 7) =       0.000500824807

      target function =                  N/A
              le_mean =     -16.915384065885
             les_mean =     286.466080777024
             stat err =       0.000479256224
             autocorr =       1.367740010100
              std dev =       0.579536753415
             le_variance =       0.335862848559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915384068954        initial  <--
     9.7656e+00     9.7656e+01             3.4187e-05       -16.915384024966
     3.9062e+01     3.9062e+02             8.5422e-06       -16.915384045219
     1.5625e+02     1.5625e+03             2.1353e-06       -16.915384065885

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8170
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732896e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9718
    reference variance = 0.256594
====================================================
  Execution time = 2.1056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4097e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341073078388
                                         uncertainty =       0.003301146892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341073078388
                                         uncertainty =       0.003301146892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412896154
  error estimate for blocks of size 2^( 2) =       0.000427440772
  error estimate for blocks of size 2^( 3) =       0.000443512799
  error estimate for blocks of size 2^( 4) =       0.000461381096
  error estimate for blocks of size 2^( 5) =       0.000480760326
  error estimate for blocks of size 2^( 6) =       0.000498242163
  error estimate for blocks of size 2^( 7) =       0.000513859614

      target function =                  N/A
              le_mean =     -16.914545752310
             les_mean =     286.442824304432
             stat err =       0.000488560799
             autocorr =       1.400088731273
              std dev =       0.583923340801
             le_variance =       0.340966467932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691454575231e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914545752310       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914545783996       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914545785019       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914545800188       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914545804831       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914545801496       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914545799563       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914545800572       residual = 5.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.581742e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914545752310       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914545760238       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914545760496       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914545764301       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914545765457       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914545764626       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914545764143       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914545764392       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 6.456021e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914545752310       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914545754292       residual = 8.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914545754357       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914545755309       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914545755597       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914545755390       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914545755270       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914545755330       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 1.614109e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6618e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.081589e-01 1 1  ON 0
 uu_1                 1.417772e-01 1 1  ON 1
 uu_2                 4.117916e-02 1 1  ON 2
 uu_3                -2.025920e-02 1 1  ON 3
 uu_4                -6.380372e-02 1 1  ON 4
 uu_5                -9.657983e-02 1 1  ON 5
 uu_6                -1.231287e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290702e-01 1 1  ON 8
 uu_9                -9.978113e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774975e-01 1 1  ON 11
 ud_2                 5.732841e-02 1 1  ON 12
 ud_3                -1.305504e-02 1 1  ON 13
 ud_4                -6.887309e-02 1 1  ON 14
 ud_5                -1.077708e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467598e-01 1 1  ON 17
 ud_8                -1.454803e-01 1 1  ON 18
 ud_9                -1.351186e-01 1 1  ON 19
 eO_0                -7.647168e-01 1 1  ON 20
 eO_1                -4.429570e-01 1 1  ON 21
 eO_2                -2.112294e-02 1 1  ON 22
 eO_3                 3.007379e-01 1 1  ON 23
 eO_4                 5.262865e-01 1 1  ON 24
 eO_5                 4.823722e-01 1 1  ON 25
 eO_6                 2.507933e-01 1 1  ON 26
 eO_7                -4.899561e-02 1 1  ON 27
 eO_8                -2.108296e-01 1 1  ON 28
 eO_9                -7.177901e-02 1 1  ON 29
eH1_0                -2.368156e-01 1 1  ON 30
eH1_1                -1.377202e-01 1 1  ON 31
eH1_2                -9.204037e-02 1 1  ON 32
eH1_3                -3.799921e-02 1 1  ON 33
eH1_4                 7.290265e-03 1 1  ON 34
eH1_5                 4.117108e-02 1 1  ON 35
eH1_6                 9.663572e-02 1 1  ON 36
eH1_7                 1.470852e-01 1 1  ON 37
eH1_8                 1.643009e-01 1 1  ON 38
eH1_9                 5.149191e-02 1 1  ON 39
eH2_0                -2.336032e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893537e-02 1 1  ON 42
eH2_3                -3.493037e-02 1 1  ON 43
eH2_4                 1.109273e-02 1 1  ON 44
eH2_5                 4.339733e-02 1 1  ON 45
eH2_6                 9.948436e-02 1 1  ON 46
eH2_7                 1.513524e-01 1 1  ON 47
eH2_8                 1.697967e-01 1 1  ON 48
eH2_9                 3.489024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9799
    reference variance = 0.692132
====================================================
  Execution time = 2.0225e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3994e-01
  Total weights = 2.0000e+06
  Execution time = 1.8804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340015550682
                                         uncertainty =       0.005619882369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340015550682
                                         uncertainty =       0.005619882369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272152
  error estimate for blocks of size 2^( 2) =       0.000426232014
  error estimate for blocks of size 2^( 3) =       0.000441687631
  error estimate for blocks of size 2^( 4) =       0.000457751701
  error estimate for blocks of size 2^( 5) =       0.000473702355
  error estimate for blocks of size 2^( 6) =       0.000489295901
  error estimate for blocks of size 2^( 7) =       0.000500799351

      target function =                  N/A
              le_mean =     -16.916188254268
             les_mean =     286.497361539237
             stat err =       0.000480387327
             autocorr =       1.357735215969
              std dev =       0.583040869383
             le_variance =       0.339936655371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340016909149
                                         uncertainty =       0.005619992971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340016909149
                                         uncertainty =       0.005619992971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272976
  error estimate for blocks of size 2^( 2) =       0.000426232815
  error estimate for blocks of size 2^( 3) =       0.000441688414
  error estimate for blocks of size 2^( 4) =       0.000457752451
  error estimate for blocks of size 2^( 5) =       0.000473703076
  error estimate for blocks of size 2^( 6) =       0.000489296553
  error estimate for blocks of size 2^( 7) =       0.000500799897

      target function =                  N/A
              le_mean =     -16.916188236961
             les_mean =     286.497362311688
             stat err =       0.000480387994
             autocorr =       1.357733563844
              std dev =       0.583042033943
             le_variance =       0.339938013345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340016232319
                                         uncertainty =       0.005619937839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340016232319
                                         uncertainty =       0.005619937839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272566
  error estimate for blocks of size 2^( 2) =       0.000426232416
  error estimate for blocks of size 2^( 3) =       0.000441688024
  error estimate for blocks of size 2^( 4) =       0.000457752077
  error estimate for blocks of size 2^( 5) =       0.000473702717
  error estimate for blocks of size 2^( 6) =       0.000489296228
  error estimate for blocks of size 2^( 7) =       0.000500799625

      target function =                  N/A
              le_mean =     -16.916188245584
             les_mean =     286.497361926838
             stat err =       0.000480387662
             autocorr =       1.357734386915
              std dev =       0.583041453724
             le_variance =       0.339937336761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340015635959
                                         uncertainty =       0.005619889308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340015635959
                                         uncertainty =       0.005619889308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412272204
  error estimate for blocks of size 2^( 2) =       0.000426232065
  error estimate for blocks of size 2^( 3) =       0.000441687680
  error estimate for blocks of size 2^( 4) =       0.000457751748
  error estimate for blocks of size 2^( 5) =       0.000473702401
  error estimate for blocks of size 2^( 6) =       0.000489295942
  error estimate for blocks of size 2^( 7) =       0.000500799386

      target function =                  N/A
              le_mean =     -16.916188253181
             les_mean =     286.497361587707
             stat err =       0.000480387369
             autocorr =       1.357735112239
              std dev =       0.583040942487
             le_variance =       0.339936740617


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.916188254268        initial  <--
     9.7656e+01     9.7656e+02             2.5817e-06       -16.916188236961
     3.9062e+02     3.9062e+03             6.4560e-07       -16.916188245584
     1.5625e+03     1.5625e+04             1.6141e-07       -16.916188253181

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7263
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732896e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6350e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9863
    reference variance = 0.369267
====================================================
  Execution time = 2.0890e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.4462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344526786989
                                         uncertainty =       0.004154364893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344526786989
                                         uncertainty =       0.004154364893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415104880
  error estimate for blocks of size 2^( 2) =       0.000428689829
  error estimate for blocks of size 2^( 3) =       0.000443753201
  error estimate for blocks of size 2^( 4) =       0.000459940541
  error estimate for blocks of size 2^( 5) =       0.000476963829
  error estimate for blocks of size 2^( 6) =       0.000492451854
  error estimate for blocks of size 2^( 7) =       0.000504591632

      target function =                  N/A
              le_mean =     -16.915624849255
             les_mean =     286.482987990685
             stat err =       0.000483486964
             autocorr =       1.356606398128
              std dev =       0.587046950640
             le_variance =       0.344624122255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691562484926e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915624849255       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915624850525       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915624850735       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915624850140       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915624849696       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915624850301       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915624850619       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915624850541       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 3.269207e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915624849255       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915624849573       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915624849625       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915624849476       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915624849365       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915624849517       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915624849593       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915624849581       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 8.172985e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915624849255       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915624849335       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915624849348       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915624849312       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915624849284       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915624849330       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915624849335       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915624849321       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.043244e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6416e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025943e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657957e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364424e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732894e-02 1 1  ON 12
 ud_3                -1.305454e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112239e-02 1 1  ON 22
 eO_3                 3.007375e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899587e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177881e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204011e-02 1 1  ON 32
eH1_3                -3.799939e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149156e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893502e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109305e-02 1 1  ON 44
eH2_5                 4.339711e-02 1 1  ON 45
eH2_6                 9.948452e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488965e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9741
    reference variance = 0.168141
====================================================
  Execution time = 2.0102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.3930e-01
  Total weights = 2.0000e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362792217
                                         uncertainty =       0.003808549019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362792217
                                         uncertainty =       0.003808549019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411888411
  error estimate for blocks of size 2^( 2) =       0.000425763946
  error estimate for blocks of size 2^( 3) =       0.000441612174
  error estimate for blocks of size 2^( 4) =       0.000458939620
  error estimate for blocks of size 2^( 5) =       0.000475806833
  error estimate for blocks of size 2^( 6) =       0.000494171398
  error estimate for blocks of size 2^( 7) =       0.000509591111

      target function =                  N/A
              le_mean =     -16.914203719470
             les_mean =     286.429591420206
             stat err =       0.000484627241
             autocorr =       1.384383767905
              std dev =       0.582498176917
             le_variance =       0.339304126111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362779676
                                         uncertainty =       0.003808551466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362779676
                                         uncertainty =       0.003808551466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411888403
  error estimate for blocks of size 2^( 2) =       0.000425763940
  error estimate for blocks of size 2^( 3) =       0.000441612169
  error estimate for blocks of size 2^( 4) =       0.000458939617
  error estimate for blocks of size 2^( 5) =       0.000475806823
  error estimate for blocks of size 2^( 6) =       0.000494171383
  error estimate for blocks of size 2^( 7) =       0.000509591093

      target function =                  N/A
              le_mean =     -16.914203717792
             les_mean =     286.429591350933
             stat err =       0.000484627229
             autocorr =       1.384383753007
              std dev =       0.582498166188
             le_variance =       0.339304113612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362785950
                                         uncertainty =       0.003808550243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362785950
                                         uncertainty =       0.003808550243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411888407
  error estimate for blocks of size 2^( 2) =       0.000425763943
  error estimate for blocks of size 2^( 3) =       0.000441612171
  error estimate for blocks of size 2^( 4) =       0.000458939619
  error estimate for blocks of size 2^( 5) =       0.000475806828
  error estimate for blocks of size 2^( 6) =       0.000494171391
  error estimate for blocks of size 2^( 7) =       0.000509591102

      target function =                  N/A
              le_mean =     -16.914203718631
             les_mean =     286.429591385565
             stat err =       0.000484627235
             autocorr =       1.384383760458
              std dev =       0.582498171555
             le_variance =       0.339304119865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362791434
                                         uncertainty =       0.003808549172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339362791434
                                         uncertainty =       0.003808549172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411888410
  error estimate for blocks of size 2^( 2) =       0.000425763946
  error estimate for blocks of size 2^( 3) =       0.000441612173
  error estimate for blocks of size 2^( 4) =       0.000458939620
  error estimate for blocks of size 2^( 5) =       0.000475806832
  error estimate for blocks of size 2^( 6) =       0.000494171397
  error estimate for blocks of size 2^( 7) =       0.000509591109

      target function =                  N/A
              le_mean =     -16.914203719365
             les_mean =     286.429591415876
             stat err =       0.000484627240
             autocorr =       1.384383766968
              std dev =       0.582498176246
             le_variance =       0.339304125330


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914203719470        initial  <--
     9.7656e+02     9.7656e+03             3.2692e-07       -16.914203717792
     3.9062e+03     3.9062e+04             8.1730e-08       -16.914203718631
     1.5625e+04     1.5625e+05             2.0432e-08       -16.914203719365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5998
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732896e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6932e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.373704
====================================================
  Execution time = 2.0877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.4585e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345842619014
                                         uncertainty =       0.009290255068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345842619014
                                         uncertainty =       0.009290255068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415843812
  error estimate for blocks of size 2^( 2) =       0.000429859114
  error estimate for blocks of size 2^( 3) =       0.000444741024
  error estimate for blocks of size 2^( 4) =       0.000460129070
  error estimate for blocks of size 2^( 5) =       0.000477607889
  error estimate for blocks of size 2^( 6) =       0.000493451848
  error estimate for blocks of size 2^( 7) =       0.000505273484

      target function =                  N/A
              le_mean =     -16.915651404234
             les_mean =     286.485114408980
             stat err =       0.000484115573
             autocorr =       1.355306803975
              std dev =       0.588091959100
             le_variance =       0.345852152358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691565140423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915651404234       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915651404314       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915651404296       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915651404291       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915651404313       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915651404332       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915651404333       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915651404347       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 2.617669e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915651404234       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915651404254       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915651404249       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915651404236       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915651404253       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915651404254       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915651404205       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915651404289       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 6.543858e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915651404234       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915651404239       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915651404237       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915651404225       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915651404246       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915651404256       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915651404185       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915651404193       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 1.635945e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039336 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6367e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887301e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9223
    reference variance = 0.225553
====================================================
  Execution time = 2.0488e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.4534e-01
  Total weights = 2.0000e+06
  Execution time = 1.8908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445450298
                                         uncertainty =       0.009318245658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445450298
                                         uncertainty =       0.009318245658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415535588
  error estimate for blocks of size 2^( 2) =       0.000429468343
  error estimate for blocks of size 2^( 3) =       0.000444950086
  error estimate for blocks of size 2^( 4) =       0.000461173534
  error estimate for blocks of size 2^( 5) =       0.000478324595
  error estimate for blocks of size 2^( 6) =       0.000494129246
  error estimate for blocks of size 2^( 7) =       0.000507696130

      target function =                  N/A
              le_mean =     -16.915624083834
             les_mean =     286.483677623336
             stat err =       0.000485330876
             autocorr =       1.364141412812
              std dev =       0.587656064723
             le_variance =       0.345339650405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445457341
                                         uncertainty =       0.009318246382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445457341
                                         uncertainty =       0.009318246382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415535593
  error estimate for blocks of size 2^( 2) =       0.000429468346
  error estimate for blocks of size 2^( 3) =       0.000444950089
  error estimate for blocks of size 2^( 4) =       0.000461173537
  error estimate for blocks of size 2^( 5) =       0.000478324598
  error estimate for blocks of size 2^( 6) =       0.000494129248
  error estimate for blocks of size 2^( 7) =       0.000507696131

      target function =                  N/A
              le_mean =     -16.915624083831
             les_mean =     286.483677630279
             stat err =       0.000485330879
             autocorr =       1.364141398777
              std dev =       0.587656070720
             le_variance =       0.345339657454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445453820
                                         uncertainty =       0.009318246020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445453820
                                         uncertainty =       0.009318246020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415535590
  error estimate for blocks of size 2^( 2) =       0.000429468344
  error estimate for blocks of size 2^( 3) =       0.000444950088
  error estimate for blocks of size 2^( 4) =       0.000461173535
  error estimate for blocks of size 2^( 5) =       0.000478324596
  error estimate for blocks of size 2^( 6) =       0.000494129247
  error estimate for blocks of size 2^( 7) =       0.000507696131

      target function =                  N/A
              le_mean =     -16.915624083833
             les_mean =     286.483677626808
             stat err =       0.000485330877
             autocorr =       1.364141405797
              std dev =       0.587656067721
             le_variance =       0.345339653930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445450738
                                         uncertainty =       0.009318245703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345445450738
                                         uncertainty =       0.009318245703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415535589
  error estimate for blocks of size 2^( 2) =       0.000429468343
  error estimate for blocks of size 2^( 3) =       0.000444950086
  error estimate for blocks of size 2^( 4) =       0.000461173534
  error estimate for blocks of size 2^( 5) =       0.000478324595
  error estimate for blocks of size 2^( 6) =       0.000494129246
  error estimate for blocks of size 2^( 7) =       0.000507696130

      target function =                  N/A
              le_mean =     -16.915624083834
             les_mean =     286.483677623770
             stat err =       0.000485330876
             autocorr =       1.364141411933
              std dev =       0.587656065098
             le_variance =       0.345339650846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915624083834        initial  <--
     9.7656e+03     9.7656e+04             2.6177e-08       -16.915624083831
     3.9062e+04     3.9062e+05             6.5439e-09       -16.915624083833
     1.5625e+05     1.5625e+06             1.6359e-09       -16.915624083834

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0256
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732896e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6403e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9356
    reference variance = 0.155979
====================================================
  Execution time = 2.1071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335497580802
                                         uncertainty =       0.002840422926

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335497580802
                                         uncertainty =       0.002840422926

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409617423
  error estimate for blocks of size 2^( 2) =       0.000423974375
  error estimate for blocks of size 2^( 3) =       0.000440146263
  error estimate for blocks of size 2^( 4) =       0.000457159159
  error estimate for blocks of size 2^( 5) =       0.000473938710
  error estimate for blocks of size 2^( 6) =       0.000491211188
  error estimate for blocks of size 2^( 7) =       0.000506964547

      target function =                  N/A
              le_mean =     -16.915249377065
             les_mean =     286.461234186183
             stat err =       0.000482318401
             autocorr =       1.386471099491
              std dev =       0.579286514305
             le_variance =       0.335572865655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691524937707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915249377065       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915249377075       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915249377077       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915249377080       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915249377063       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915249377046       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915249377087       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915249377041       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 3.147751e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915249377065       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915249377068       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915249377068       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915249377069       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915249377125       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915249377216       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915249376819       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915249377152       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 7.869384e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915249377065       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915249377066       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915249377066       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915249377124       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915249376896       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915249377063       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915249376492       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915249377016       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 1.967345e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041947 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6601e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732896e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.256443
====================================================
  Execution time = 2.0496e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3674e-01
  Total weights = 2.0000e+06
  Execution time = 1.8857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793115340
                                         uncertainty =       0.003375826162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793115340
                                         uncertainty =       0.003375826162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329617
  error estimate for blocks of size 2^( 2) =       0.000424414467
  error estimate for blocks of size 2^( 3) =       0.000440038968
  error estimate for blocks of size 2^( 4) =       0.000456141436
  error estimate for blocks of size 2^( 5) =       0.000472106510
  error estimate for blocks of size 2^( 6) =       0.000487076917
  error estimate for blocks of size 2^( 7) =       0.000498961594

      target function =                  N/A
              le_mean =     -16.915213413094
             les_mean =     286.461185431173
             stat err =       0.000478571614
             autocorr =       1.360279464411
              std dev =       0.580293709267
             le_variance =       0.336740789015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793116536
                                         uncertainty =       0.003375826170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793116536
                                         uncertainty =       0.003375826170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329618
  error estimate for blocks of size 2^( 2) =       0.000424414468
  error estimate for blocks of size 2^( 3) =       0.000440038969
  error estimate for blocks of size 2^( 4) =       0.000456141437
  error estimate for blocks of size 2^( 5) =       0.000472106511
  error estimate for blocks of size 2^( 6) =       0.000487076918
  error estimate for blocks of size 2^( 7) =       0.000498961594

      target function =                  N/A
              le_mean =     -16.915213413102
             les_mean =     286.461185432628
             stat err =       0.000478571615
             autocorr =       1.360279462496
              std dev =       0.580293710297
             le_variance =       0.336740790210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793115938
                                         uncertainty =       0.003375826166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793115938
                                         uncertainty =       0.003375826166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329617
  error estimate for blocks of size 2^( 2) =       0.000424414467
  error estimate for blocks of size 2^( 3) =       0.000440038968
  error estimate for blocks of size 2^( 4) =       0.000456141436
  error estimate for blocks of size 2^( 5) =       0.000472106511
  error estimate for blocks of size 2^( 6) =       0.000487076918
  error estimate for blocks of size 2^( 7) =       0.000498961594

      target function =                  N/A
              le_mean =     -16.915213413098
             les_mean =     286.461185431901
             stat err =       0.000478571615
             autocorr =       1.360279463457
              std dev =       0.580293709782
             le_variance =       0.336740789612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793115415
                                         uncertainty =       0.003375826163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336793115415
                                         uncertainty =       0.003375826163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410329617
  error estimate for blocks of size 2^( 2) =       0.000424414467
  error estimate for blocks of size 2^( 3) =       0.000440038968
  error estimate for blocks of size 2^( 4) =       0.000456141436
  error estimate for blocks of size 2^( 5) =       0.000472106510
  error estimate for blocks of size 2^( 6) =       0.000487076917
  error estimate for blocks of size 2^( 7) =       0.000498961594

      target function =                  N/A
              le_mean =     -16.915213413095
             les_mean =     286.461185431264
             stat err =       0.000478571614
             autocorr =       1.360279464290
              std dev =       0.580293709331
             le_variance =       0.336740789089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915213413094        initial
     9.7656e+04     9.7656e+05             3.1478e-09       -16.915213413102  <--
     3.9062e+05     3.9062e+06             7.8694e-10       -16.915213413098
     1.5625e+06     1.5625e+07             1.9673e-10       -16.915213413095

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 3.0003e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6930e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9749
    reference variance = 0.595259
====================================================
  Execution time = 2.2203e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3829e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338387418742
                                         uncertainty =       0.004650585075

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338387418742
                                         uncertainty =       0.004650585075

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411270080
  error estimate for blocks of size 2^( 2) =       0.000425517986
  error estimate for blocks of size 2^( 3) =       0.000441460101
  error estimate for blocks of size 2^( 4) =       0.000458865051
  error estimate for blocks of size 2^( 5) =       0.000477576614
  error estimate for blocks of size 2^( 6) =       0.000494465211
  error estimate for blocks of size 2^( 7) =       0.000507028921

      target function =                  N/A
              le_mean =     -16.914765345478
             les_mean =     286.447572681302
             stat err =       0.000484483949
             autocorr =       1.387728653426
              std dev =       0.581623725318
             le_variance =       0.338286157852


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691476534548e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914765345478       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914765345541       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914765345546       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914765345515       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914765345513       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914765345565       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914765345532       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914765345546       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.095857e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914765345478       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914765345494       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914765345495       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914765345483       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914765345484       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914765345490       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914765345477       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914765345529       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 2.739656e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914765345478       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914765345482       residual = 7.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914765345483       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914765345519       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914765345439       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914765345501       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914765345579       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914765345688       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 6.849147e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7732e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380343e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.213581
====================================================
  Execution time = 2.0250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3867e-01
  Total weights = 2.0000e+06
  Execution time = 1.8854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652739310
                                         uncertainty =       0.005697385145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652739310
                                         uncertainty =       0.005697385145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411501131
  error estimate for blocks of size 2^( 2) =       0.000425847954
  error estimate for blocks of size 2^( 3) =       0.000441561521
  error estimate for blocks of size 2^( 4) =       0.000458782820
  error estimate for blocks of size 2^( 5) =       0.000476740334
  error estimate for blocks of size 2^( 6) =       0.000493716962
  error estimate for blocks of size 2^( 7) =       0.000506684121

      target function =                  N/A
              le_mean =     -16.914718634810
             les_mean =     286.446372686591
             stat err =       0.000483981059
             autocorr =       1.383294549571
              std dev =       0.581950479967
             le_variance =       0.338666361134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652738440
                                         uncertainty =       0.005697385300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652738440
                                         uncertainty =       0.005697385300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411501130
  error estimate for blocks of size 2^( 2) =       0.000425847953
  error estimate for blocks of size 2^( 3) =       0.000441561521
  error estimate for blocks of size 2^( 4) =       0.000458782819
  error estimate for blocks of size 2^( 5) =       0.000476740333
  error estimate for blocks of size 2^( 6) =       0.000493716961
  error estimate for blocks of size 2^( 7) =       0.000506684119

      target function =                  N/A
              le_mean =     -16.914718634801
             les_mean =     286.446372685403
             stat err =       0.000483981058
             autocorr =       1.383294547208
              std dev =       0.581950479219
             le_variance =       0.338666360263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652738875
                                         uncertainty =       0.005697385222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652738875
                                         uncertainty =       0.005697385222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411501130
  error estimate for blocks of size 2^( 2) =       0.000425847954
  error estimate for blocks of size 2^( 3) =       0.000441561521
  error estimate for blocks of size 2^( 4) =       0.000458782820
  error estimate for blocks of size 2^( 5) =       0.000476740334
  error estimate for blocks of size 2^( 6) =       0.000493716961
  error estimate for blocks of size 2^( 7) =       0.000506684120

      target function =                  N/A
              le_mean =     -16.914718634805
             les_mean =     286.446372685997
             stat err =       0.000483981059
             autocorr =       1.383294548394
              std dev =       0.581950479593
             le_variance =       0.338666360698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652739255
                                         uncertainty =       0.005697385154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338652739255
                                         uncertainty =       0.005697385154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411501131
  error estimate for blocks of size 2^( 2) =       0.000425847954
  error estimate for blocks of size 2^( 3) =       0.000441561521
  error estimate for blocks of size 2^( 4) =       0.000458782820
  error estimate for blocks of size 2^( 5) =       0.000476740334
  error estimate for blocks of size 2^( 6) =       0.000493716962
  error estimate for blocks of size 2^( 7) =       0.000506684121

      target function =                  N/A
              le_mean =     -16.914718634809
             les_mean =     286.446372686517
             stat err =       0.000483981059
             autocorr =       1.383294549430
              std dev =       0.581950479920
             le_variance =       0.338666361079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914718634810        initial  <--
     2.4414e+04     2.4414e+05             1.0959e-08       -16.914718634801
     9.7656e+04     9.7656e+05             2.7397e-09       -16.914718634805
     3.9062e+05     3.9062e+06             6.8491e-10       -16.914718634809

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7605
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9559
    reference variance = 0.357355
====================================================
  Execution time = 2.0878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.3672e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336683786725
                                         uncertainty =       0.004745965917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336683786725
                                         uncertainty =       0.004745965917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410315025
  error estimate for blocks of size 2^( 2) =       0.000423923746
  error estimate for blocks of size 2^( 3) =       0.000439117017
  error estimate for blocks of size 2^( 4) =       0.000455830589
  error estimate for blocks of size 2^( 5) =       0.000472935283
  error estimate for blocks of size 2^( 6) =       0.000489654057
  error estimate for blocks of size 2^( 7) =       0.000500090553

      target function =                  N/A
              le_mean =     -16.913906830572
             les_mean =     286.416960944137
             stat err =       0.000479627620
             autocorr =       1.366386396774
              std dev =       0.580273072975
             le_variance =       0.336716839220


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691390683057e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.913906830572       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.913906830572       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.913906830573       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.913906830570       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.913906830538       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913906830253       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.913906830610       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.913906830476       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 1.239972e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.913906830572       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.913906830572       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.913906830572       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.913906831307       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.913906830100       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913906830489       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.913906830778       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.913906830486       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 3.099931e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.913906830572       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.913906830572       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.913906830572       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.913906829582       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.913906829810       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913906835876       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.913906827972       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.913906830893       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 7.749829e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6342e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9088
    reference variance = 0.316257
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.5138e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471132871
                                         uncertainty =       0.012519106178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471132871
                                         uncertainty =       0.012519106178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419155063
  error estimate for blocks of size 2^( 2) =       0.000433356430
  error estimate for blocks of size 2^( 3) =       0.000449307799
  error estimate for blocks of size 2^( 4) =       0.000465660732
  error estimate for blocks of size 2^( 5) =       0.000483373924
  error estimate for blocks of size 2^( 6) =       0.000501083871
  error estimate for blocks of size 2^( 7) =       0.000513356999

      target function =                  N/A
              le_mean =     -16.914337587206
             les_mean =     286.446197772416
             stat err =       0.000490868882
             autocorr =       1.371455020647
              std dev =       0.592774775233
             le_variance =       0.351381934153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471133587
                                         uncertainty =       0.012519106218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471133587
                                         uncertainty =       0.012519106218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419155064
  error estimate for blocks of size 2^( 2) =       0.000433356430
  error estimate for blocks of size 2^( 3) =       0.000449307799
  error estimate for blocks of size 2^( 4) =       0.000465660732
  error estimate for blocks of size 2^( 5) =       0.000483373924
  error estimate for blocks of size 2^( 6) =       0.000501083871
  error estimate for blocks of size 2^( 7) =       0.000513357000

      target function =                  N/A
              le_mean =     -16.914337587205
             les_mean =     286.446197773113
             stat err =       0.000490868882
             autocorr =       1.371455019772
              std dev =       0.592774775837
             le_variance =       0.351381934868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471133229
                                         uncertainty =       0.012519106198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471133229
                                         uncertainty =       0.012519106198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419155063
  error estimate for blocks of size 2^( 2) =       0.000433356430
  error estimate for blocks of size 2^( 3) =       0.000449307799
  error estimate for blocks of size 2^( 4) =       0.000465660732
  error estimate for blocks of size 2^( 5) =       0.000483373924
  error estimate for blocks of size 2^( 6) =       0.000501083871
  error estimate for blocks of size 2^( 7) =       0.000513357000

      target function =                  N/A
              le_mean =     -16.914337587205
             les_mean =     286.446197772765
             stat err =       0.000490868882
             autocorr =       1.371455020213
              std dev =       0.592774775535
             le_variance =       0.351381934510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471132916
                                         uncertainty =       0.012519106181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351471132916
                                         uncertainty =       0.012519106181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419155063
  error estimate for blocks of size 2^( 2) =       0.000433356430
  error estimate for blocks of size 2^( 3) =       0.000449307799
  error estimate for blocks of size 2^( 4) =       0.000465660732
  error estimate for blocks of size 2^( 5) =       0.000483373924
  error estimate for blocks of size 2^( 6) =       0.000501083871
  error estimate for blocks of size 2^( 7) =       0.000513356999

      target function =                  N/A
              le_mean =     -16.914337587206
             les_mean =     286.446197772460
             stat err =       0.000490868882
             autocorr =       1.371455020596
              std dev =       0.592774775271
             le_variance =       0.351381934197


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914337587206        initial  <--
     2.4414e+05     2.4414e+06             1.2400e-09       -16.914337587205
     9.7656e+05     9.7656e+06             3.0999e-10       -16.914337587205
     3.9062e+06     3.9062e+07             7.7498e-11       -16.914337587206

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7127
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6931e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8718
    reference variance = 0.358554
====================================================
  Execution time = 2.0667e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3209e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332107367202
                                         uncertainty =       0.004037647342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332107367202
                                         uncertainty =       0.004037647342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407485728
  error estimate for blocks of size 2^( 2) =       0.000421947656
  error estimate for blocks of size 2^( 3) =       0.000437872268
  error estimate for blocks of size 2^( 4) =       0.000454499645
  error estimate for blocks of size 2^( 5) =       0.000472421318
  error estimate for blocks of size 2^( 6) =       0.000488207466
  error estimate for blocks of size 2^( 7) =       0.000501528383

      target function =                  N/A
              le_mean =     -16.915314274146
             les_mean =     286.459946063968
             stat err =       0.000479164203
             autocorr =       1.382750826598
              std dev =       0.576271842881
             le_variance =       0.332089236897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691531427415e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915314274146       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915314274146       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915314274147       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915314274147       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915314273926       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915314273605       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915314275401       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915314274725       residual = 5.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.352357e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915314274146       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915314274146       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915314274146       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915314275047       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915314271749       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915314279799       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915314277893       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915314276598       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 3.380912e-11

solving harmonic davidson linear method for identity shift 3.9062e+07, overlap shift 3.9062e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915314274146       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915314274146       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915314274146       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915314274146       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915314276039       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915314286646       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915314277414       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915314267294       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+07 is 8.452328e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049885 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6243e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9067
    reference variance = 0.184545
====================================================
  Execution time = 2.0547e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3616e-01
  Total weights = 2.0000e+06
  Execution time = 1.8819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141412
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141412
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409976649
  error estimate for blocks of size 2^( 2) =       0.000423896267
  error estimate for blocks of size 2^( 3) =       0.000439742138
  error estimate for blocks of size 2^( 4) =       0.000456538915
  error estimate for blocks of size 2^( 5) =       0.000474079256
  error estimate for blocks of size 2^( 6) =       0.000492286001
  error estimate for blocks of size 2^( 7) =       0.000505957674

      target function =                  N/A
              le_mean =     -16.914738521991
             les_mean =     286.444540805272
             stat err =       0.000482215461
             autocorr =       1.383451754728
              std dev =       0.579794537782
             le_variance =       0.336161706041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141389
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141389
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409976649
  error estimate for blocks of size 2^( 2) =       0.000423896267
  error estimate for blocks of size 2^( 3) =       0.000439742138
  error estimate for blocks of size 2^( 4) =       0.000456538914
  error estimate for blocks of size 2^( 5) =       0.000474079256
  error estimate for blocks of size 2^( 6) =       0.000492286001
  error estimate for blocks of size 2^( 7) =       0.000505957674

      target function =                  N/A
              le_mean =     -16.914738521991
             les_mean =     286.444540805255
             stat err =       0.000482215461
             autocorr =       1.383451754753
              std dev =       0.579794537761
             le_variance =       0.336161706018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141400
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141400
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409976649
  error estimate for blocks of size 2^( 2) =       0.000423896267
  error estimate for blocks of size 2^( 3) =       0.000439742138
  error estimate for blocks of size 2^( 4) =       0.000456538915
  error estimate for blocks of size 2^( 5) =       0.000474079256
  error estimate for blocks of size 2^( 6) =       0.000492286001
  error estimate for blocks of size 2^( 7) =       0.000505957674

      target function =                  N/A
              le_mean =     -16.914738521991
             les_mean =     286.444540805263
             stat err =       0.000482215461
             autocorr =       1.383451754738
              std dev =       0.579794537771
             le_variance =       0.336161706029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141410
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335888141410
                                         uncertainty =       0.003171104668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409976649
  error estimate for blocks of size 2^( 2) =       0.000423896267
  error estimate for blocks of size 2^( 3) =       0.000439742138
  error estimate for blocks of size 2^( 4) =       0.000456538915
  error estimate for blocks of size 2^( 5) =       0.000474079256
  error estimate for blocks of size 2^( 6) =       0.000492286001
  error estimate for blocks of size 2^( 7) =       0.000505957674

      target function =                  N/A
              le_mean =     -16.914738521991
             les_mean =     286.444540805271
             stat err =       0.000482215461
             autocorr =       1.383451754724
              std dev =       0.579794537780
             le_variance =       0.336161706040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914738521991        initial
     2.4414e+06     2.4414e+07             1.3524e-10       -16.914738521991  <--
     9.7656e+06     9.7656e+07             3.3809e-11       -16.914738521991
     3.9062e+07     3.9062e+08             8.4523e-12       -16.914738521991

*****************************************************************************
Applying the update for shift_i =   2.4414e+06     and shift_s =   2.4414e+07
*****************************************************************************

  Execution time = 3.0038e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6287e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9171
    reference variance = 0.300227
====================================================
  Execution time = 2.0764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.4392e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344022825174
                                         uncertainty =       0.003683881813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344022825174
                                         uncertainty =       0.003683881813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414681091
  error estimate for blocks of size 2^( 2) =       0.000428849205
  error estimate for blocks of size 2^( 3) =       0.000444089373
  error estimate for blocks of size 2^( 4) =       0.000459849908
  error estimate for blocks of size 2^( 5) =       0.000476131650
  error estimate for blocks of size 2^( 6) =       0.000490415921
  error estimate for blocks of size 2^( 7) =       0.000503698393

      target function =                  N/A
              le_mean =     -16.915799705847
             les_mean =     286.488200330846
             stat err =       0.000482523968
             autocorr =       1.353970856106
              std dev =       0.586447622965
             le_variance =       0.343920814481


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691579970585e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915799705847       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915799705848       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915799705848       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915799705847       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915799705991       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915799705631       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915799705680       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915799705875       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.653082e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915799705847       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915799705847       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915799705847       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915799705847       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915799705152       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915799705034       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915799705653       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915799703894       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.163270e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915799705847       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915799705847       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915799705847       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915799705847       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915799705131       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915799714691       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915799711400       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915799703071       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 2.908206e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6284e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9165
    reference variance = 0.216752
====================================================
  Execution time = 2.0117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.4005e-01
  Total weights = 2.0000e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129741
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129741
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412341882
  error estimate for blocks of size 2^( 2) =       0.000426524604
  error estimate for blocks of size 2^( 3) =       0.000442253959
  error estimate for blocks of size 2^( 4) =       0.000458741984
  error estimate for blocks of size 2^( 5) =       0.000475488407
  error estimate for blocks of size 2^( 6) =       0.000492975852
  error estimate for blocks of size 2^( 7) =       0.000507266483

      target function =                  N/A
              le_mean =     -16.914410575684
             les_mean =     286.437336607432
             stat err =       0.000483618182
             autocorr =       1.375594221842
              std dev =       0.583139481283
             le_variance =       0.340051654631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129789
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129789
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412341882
  error estimate for blocks of size 2^( 2) =       0.000426524604
  error estimate for blocks of size 2^( 3) =       0.000442253960
  error estimate for blocks of size 2^( 4) =       0.000458741984
  error estimate for blocks of size 2^( 5) =       0.000475488407
  error estimate for blocks of size 2^( 6) =       0.000492975852
  error estimate for blocks of size 2^( 7) =       0.000507266483

      target function =                  N/A
              le_mean =     -16.914410575685
             les_mean =     286.437336607503
             stat err =       0.000483618182
             autocorr =       1.375594221701
              std dev =       0.583139481324
             le_variance =       0.340051654679

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129765
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129765
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412341882
  error estimate for blocks of size 2^( 2) =       0.000426524604
  error estimate for blocks of size 2^( 3) =       0.000442253960
  error estimate for blocks of size 2^( 4) =       0.000458741984
  error estimate for blocks of size 2^( 5) =       0.000475488407
  error estimate for blocks of size 2^( 6) =       0.000492975852
  error estimate for blocks of size 2^( 7) =       0.000507266483

      target function =                  N/A
              le_mean =     -16.914410575685
             les_mean =     286.437336607467
             stat err =       0.000483618182
             autocorr =       1.375594221773
              std dev =       0.583139481303
             le_variance =       0.340051654655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129744
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340054129744
                                         uncertainty =       0.004919247304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412341882
  error estimate for blocks of size 2^( 2) =       0.000426524604
  error estimate for blocks of size 2^( 3) =       0.000442253959
  error estimate for blocks of size 2^( 4) =       0.000458741984
  error estimate for blocks of size 2^( 5) =       0.000475488407
  error estimate for blocks of size 2^( 6) =       0.000492975852
  error estimate for blocks of size 2^( 7) =       0.000507266483

      target function =                  N/A
              le_mean =     -16.914410575685
             les_mean =     286.437336607436
             stat err =       0.000483618182
             autocorr =       1.375594221833
              std dev =       0.583139481285
             le_variance =       0.340051654634


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914410575684        initial
     6.1035e+05     6.1035e+06             4.6531e-10       -16.914410575685  <--
     2.4414e+06     2.4414e+07             1.1633e-10       -16.914410575685
     9.7656e+06     9.7656e+07             2.9082e-11       -16.914410575685

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 2.9620e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.849
    reference variance = 0.218609
====================================================
  Execution time = 2.0807e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4345e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343462998947
                                         uncertainty =       0.005094232583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343462998947
                                         uncertainty =       0.005094232583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414397648
  error estimate for blocks of size 2^( 2) =       0.000428191673
  error estimate for blocks of size 2^( 3) =       0.000444103510
  error estimate for blocks of size 2^( 4) =       0.000461148357
  error estimate for blocks of size 2^( 5) =       0.000477817793
  error estimate for blocks of size 2^( 6) =       0.000495341689
  error estimate for blocks of size 2^( 7) =       0.000507022619

      target function =                  N/A
              le_mean =     -16.915339527038
             les_mean =     286.472161964688
             stat err =       0.000485332614
             autocorr =       1.371653418696
              std dev =       0.586046774101
             le_variance =       0.343450821435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691533952704e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915339527038       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915339527042       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915339527044       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915339527036       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915339527051       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915339527061       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915339527090       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915339527073       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.873277e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915339527038       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915339527039       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915339527040       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915339527042       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915339526917       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915339527198       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915339527053       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915339526959       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.683193e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915339527038       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915339527038       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915339527038       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915339527667       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915339526568       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915339526774       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915339527041       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915339525035       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 1.170798e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055163 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6312e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290186e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488959e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.253768
====================================================
  Execution time = 2.0622e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4376e-01
  Total weights = 2.0000e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174526
                                         uncertainty =       0.004857638586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174526
                                         uncertainty =       0.004857638586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414584154
  error estimate for blocks of size 2^( 2) =       0.000428865136
  error estimate for blocks of size 2^( 3) =       0.000444787743
  error estimate for blocks of size 2^( 4) =       0.000461957505
  error estimate for blocks of size 2^( 5) =       0.000480793006
  error estimate for blocks of size 2^( 6) =       0.000498354091
  error estimate for blocks of size 2^( 7) =       0.000511807473

      target function =                  N/A
              le_mean =     -16.915260324681
             les_mean =     286.469791720654
             stat err =       0.000488228019
             autocorr =       1.386819699471
              std dev =       0.586310532746
             le_variance =       0.343760040809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174427
                                         uncertainty =       0.004857638590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174427
                                         uncertainty =       0.004857638590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414584154
  error estimate for blocks of size 2^( 2) =       0.000428865136
  error estimate for blocks of size 2^( 3) =       0.000444787743
  error estimate for blocks of size 2^( 4) =       0.000461957505
  error estimate for blocks of size 2^( 5) =       0.000480793006
  error estimate for blocks of size 2^( 6) =       0.000498354091
  error estimate for blocks of size 2^( 7) =       0.000511807473

      target function =                  N/A
              le_mean =     -16.915260324685
             les_mean =     286.469791720691
             stat err =       0.000488228019
             autocorr =       1.386819699146
              std dev =       0.586310532662
             le_variance =       0.343760040710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174476
                                         uncertainty =       0.004857638588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174476
                                         uncertainty =       0.004857638588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414584154
  error estimate for blocks of size 2^( 2) =       0.000428865136
  error estimate for blocks of size 2^( 3) =       0.000444787743
  error estimate for blocks of size 2^( 4) =       0.000461957505
  error estimate for blocks of size 2^( 5) =       0.000480793006
  error estimate for blocks of size 2^( 6) =       0.000498354091
  error estimate for blocks of size 2^( 7) =       0.000511807473

      target function =                  N/A
              le_mean =     -16.915260324683
             les_mean =     286.469791720673
             stat err =       0.000488228019
             autocorr =       1.386819699311
              std dev =       0.586310532704
             le_variance =       0.343760040759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174520
                                         uncertainty =       0.004857638586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343697174520
                                         uncertainty =       0.004857638586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414584154
  error estimate for blocks of size 2^( 2) =       0.000428865136
  error estimate for blocks of size 2^( 3) =       0.000444787743
  error estimate for blocks of size 2^( 4) =       0.000461957505
  error estimate for blocks of size 2^( 5) =       0.000480793006
  error estimate for blocks of size 2^( 6) =       0.000498354091
  error estimate for blocks of size 2^( 7) =       0.000511807473

      target function =                  N/A
              le_mean =     -16.915260324681
             les_mean =     286.469791720656
             stat err =       0.000488228019
             autocorr =       1.386819699452
              std dev =       0.586310532741
             le_variance =       0.343760040802


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915260324681        initial
     1.5259e+05     1.5259e+06             1.8733e-09       -16.915260324685  <--
     6.1035e+05     6.1035e+06             4.6832e-10       -16.915260324683
     2.4414e+06     2.4414e+07             1.1708e-10       -16.915260324681

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 3.0141e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117919e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290187e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109308e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6460e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8946
    reference variance = 0.288238
====================================================
  Execution time = 2.0679e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.5409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354165410305
                                         uncertainty =       0.015720691027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354165410305
                                         uncertainty =       0.015720691027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420767718
  error estimate for blocks of size 2^( 2) =       0.000434929598
  error estimate for blocks of size 2^( 3) =       0.000450369843
  error estimate for blocks of size 2^( 4) =       0.000466502631
  error estimate for blocks of size 2^( 5) =       0.000484850799
  error estimate for blocks of size 2^( 6) =       0.000502548650
  error estimate for blocks of size 2^( 7) =       0.000513629464

      target function =                  N/A
              le_mean =     -16.914888234436
             les_mean =     286.467534750717
             stat err =       0.000491882886
             autocorr =       1.366591139268
              std dev =       0.595055412798
             le_variance =       0.354090944301


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691488823444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914888234436       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914888234480       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914888234478       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914888234475       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914888234478       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914888234483       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914888234490       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914888234497       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.798983e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914888234436       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914888234447       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914888234446       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914888234478       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914888234449       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914888234449       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914888234527       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914888234347       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.949747e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914888234436       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914888234439       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914888234439       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914888234339       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914888234427       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914888234105       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914888234124       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914888238210       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 4.874364e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6136e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305451e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899589e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177878e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290187e-03 1 1  ON 34
eH1_5                 4.117149e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149153e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9221
    reference variance = 0.256022
====================================================
  Execution time = 2.2317e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.4026e-01
  Total weights = 2.0000e+06
  Execution time = 1.8886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269514960
                                         uncertainty =       0.004007242738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269514960
                                         uncertainty =       0.004007242738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469451
  error estimate for blocks of size 2^( 2) =       0.000426844902
  error estimate for blocks of size 2^( 3) =       0.000442566075
  error estimate for blocks of size 2^( 4) =       0.000458774822
  error estimate for blocks of size 2^( 5) =       0.000474859164
  error estimate for blocks of size 2^( 6) =       0.000490267873
  error estimate for blocks of size 2^( 7) =       0.000501894399

      target function =                  N/A
              le_mean =     -16.915641071374
             les_mean =     286.479174782062
             stat err =       0.000481449065
             autocorr =       1.362439155346
              std dev =       0.583319892199
             le_variance =       0.340262096635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269515538
                                         uncertainty =       0.004007242744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269515538
                                         uncertainty =       0.004007242744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469452
  error estimate for blocks of size 2^( 2) =       0.000426844902
  error estimate for blocks of size 2^( 3) =       0.000442566075
  error estimate for blocks of size 2^( 4) =       0.000458774822
  error estimate for blocks of size 2^( 5) =       0.000474859164
  error estimate for blocks of size 2^( 6) =       0.000490267873
  error estimate for blocks of size 2^( 7) =       0.000501894399

      target function =                  N/A
              le_mean =     -16.915641071401
             les_mean =     286.479174783565
             stat err =       0.000481449065
             autocorr =       1.362439153527
              std dev =       0.583319892696
             le_variance =       0.340262097215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269515249
                                         uncertainty =       0.004007242741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269515249
                                         uncertainty =       0.004007242741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469452
  error estimate for blocks of size 2^( 2) =       0.000426844902
  error estimate for blocks of size 2^( 3) =       0.000442566075
  error estimate for blocks of size 2^( 4) =       0.000458774822
  error estimate for blocks of size 2^( 5) =       0.000474859164
  error estimate for blocks of size 2^( 6) =       0.000490267873
  error estimate for blocks of size 2^( 7) =       0.000501894399

      target function =                  N/A
              le_mean =     -16.915641071388
             les_mean =     286.479174782813
             stat err =       0.000481449065
             autocorr =       1.362439154432
              std dev =       0.583319892447
             le_variance =       0.340262096925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269514996
                                         uncertainty =       0.004007242739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340269514996
                                         uncertainty =       0.004007242739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412469451
  error estimate for blocks of size 2^( 2) =       0.000426844902
  error estimate for blocks of size 2^( 3) =       0.000442566075
  error estimate for blocks of size 2^( 4) =       0.000458774822
  error estimate for blocks of size 2^( 5) =       0.000474859164
  error estimate for blocks of size 2^( 6) =       0.000490267873
  error estimate for blocks of size 2^( 7) =       0.000501894399

      target function =                  N/A
              le_mean =     -16.915641071376
             les_mean =     286.479174782156
             stat err =       0.000481449065
             autocorr =       1.362439155238
              std dev =       0.583319892230
             le_variance =       0.340262096671


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915641071374        initial
     3.8147e+04     3.8147e+05             7.7990e-09       -16.915641071401  <--
     1.5259e+05     1.5259e+06             1.9497e-09       -16.915641071388
     6.1035e+05     6.1035e+06             4.8744e-10       -16.915641071376

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 3.1851e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7993e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.933
    reference variance = 0.233993
====================================================
  Execution time = 2.0531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3216e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253568352
                                         uncertainty =       0.002439422330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332253568352
                                         uncertainty =       0.002439422330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407527413
  error estimate for blocks of size 2^( 2) =       0.000422091709
  error estimate for blocks of size 2^( 3) =       0.000437771339
  error estimate for blocks of size 2^( 4) =       0.000454649596
  error estimate for blocks of size 2^( 5) =       0.000471930166
  error estimate for blocks of size 2^( 6) =       0.000488075104
  error estimate for blocks of size 2^( 7) =       0.000500403545

      target function =                  N/A
              le_mean =     -16.915053198243
             les_mean =     286.451181718352
             stat err =       0.000478764603
             autocorr =       1.380163097889
              std dev =       0.576330794792
             le_variance =       0.332157185026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691505319824e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915053198243       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915053198359       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915053198402       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915053198433       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915053198509       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915053198515       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915053198544       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915053198539       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.939387e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915053198243       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915053198272       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915053198283       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915053198291       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915053198307       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915053198304       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915053198345       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915053198305       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 7.348475e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915053198243       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915053198251       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915053198253       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915053198329       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915053198283       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915053198257       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915053198265       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915053198256       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.837119e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060396 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6004e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112237e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290189e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663576e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9368
    reference variance = 0.286121
====================================================
  Execution time = 2.0220e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.0000e+06
  Execution time = 1.8942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297888528
                                         uncertainty =       0.004252713181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297888528
                                         uncertainty =       0.004252713181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214696
  error estimate for blocks of size 2^( 2) =       0.000425503823
  error estimate for blocks of size 2^( 3) =       0.000441555991
  error estimate for blocks of size 2^( 4) =       0.000459293486
  error estimate for blocks of size 2^( 5) =       0.000478007663
  error estimate for blocks of size 2^( 6) =       0.000495016174
  error estimate for blocks of size 2^( 7) =       0.000508138103

      target function =                  N/A
              le_mean =     -16.914866622986
             les_mean =     286.450907757282
             stat err =       0.000485113856
             autocorr =       1.391714347572
              std dev =       0.581545400622
             le_variance =       0.338195052985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297904720
                                         uncertainty =       0.004252713635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297904720
                                         uncertainty =       0.004252713635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214706
  error estimate for blocks of size 2^( 2) =       0.000425503833
  error estimate for blocks of size 2^( 3) =       0.000441556000
  error estimate for blocks of size 2^( 4) =       0.000459293494
  error estimate for blocks of size 2^( 5) =       0.000478007670
  error estimate for blocks of size 2^( 6) =       0.000495016181
  error estimate for blocks of size 2^( 7) =       0.000508138110

      target function =                  N/A
              le_mean =     -16.914866622919
             les_mean =     286.450907771207
             stat err =       0.000485113864
             autocorr =       1.391714322894
              std dev =       0.581545414543
             le_variance =       0.338195069176

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297896624
                                         uncertainty =       0.004252713408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297896624
                                         uncertainty =       0.004252713408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214701
  error estimate for blocks of size 2^( 2) =       0.000425503828
  error estimate for blocks of size 2^( 3) =       0.000441555996
  error estimate for blocks of size 2^( 4) =       0.000459293490
  error estimate for blocks of size 2^( 5) =       0.000478007667
  error estimate for blocks of size 2^( 6) =       0.000495016178
  error estimate for blocks of size 2^( 7) =       0.000508138106

      target function =                  N/A
              le_mean =     -16.914866622952
             les_mean =     286.450907764245
             stat err =       0.000485113860
             autocorr =       1.391714335228
              std dev =       0.581545407583
             le_variance =       0.338195061080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297889540
                                         uncertainty =       0.004252713209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338297889540
                                         uncertainty =       0.004252713209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214697
  error estimate for blocks of size 2^( 2) =       0.000425503824
  error estimate for blocks of size 2^( 3) =       0.000441555992
  error estimate for blocks of size 2^( 4) =       0.000459293486
  error estimate for blocks of size 2^( 5) =       0.000478007663
  error estimate for blocks of size 2^( 6) =       0.000495016175
  error estimate for blocks of size 2^( 7) =       0.000508138103

      target function =                  N/A
              le_mean =     -16.914866622981
             les_mean =     286.450907758152
             stat err =       0.000485113857
             autocorr =       1.391714346038
              std dev =       0.581545401492
             le_variance =       0.338195053997


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914866622986        initial  <--
     9.5367e+03     9.5367e+04             2.9394e-08       -16.914866622919
     3.8147e+04     3.8147e+05             7.3485e-09       -16.914866622952
     1.5259e+05     1.5259e+06             1.8371e-09       -16.914866622981

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7721
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5783e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8524
    reference variance = 0.510389
====================================================
  Execution time = 2.0674e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5163e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341106091246
                                         uncertainty =       0.005417876920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341106091246
                                         uncertainty =       0.005417876920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413009272
  error estimate for blocks of size 2^( 2) =       0.000426956379
  error estimate for blocks of size 2^( 3) =       0.000442776379
  error estimate for blocks of size 2^( 4) =       0.000458788199
  error estimate for blocks of size 2^( 5) =       0.000476533401
  error estimate for blocks of size 2^( 6) =       0.000493022154
  error estimate for blocks of size 2^( 7) =       0.000505405225

      target function =                  N/A
              le_mean =     -16.915422513778
             les_mean =     286.472671965909
             stat err =       0.000483437245
             autocorr =       1.370126322930
              std dev =       0.584083313273
             le_variance =       0.341153316844


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691542251378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915422513778       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915422513778       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915422513784       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915422513750       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915422513803       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915422513718       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915422513770       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915422513845       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.976907e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915422513778       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915422513778       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915422513780       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915422513779       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915422513664       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915422513778       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915422513785       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915422513787       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 7.442269e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915422513778       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915422513778       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915422513779       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915422514516       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915422512986       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915422512834       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915422514614       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915422513774       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 1.860568e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6197e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.234984
====================================================
  Execution time = 2.0656e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4445e-01
  Total weights = 2.0000e+06
  Execution time = 1.8812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345083392
                                         uncertainty =       0.008540432567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345083392
                                         uncertainty =       0.008540432567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415002965
  error estimate for blocks of size 2^( 2) =       0.000429565727
  error estimate for blocks of size 2^( 3) =       0.000445333448
  error estimate for blocks of size 2^( 4) =       0.000463603679
  error estimate for blocks of size 2^( 5) =       0.000481831308
  error estimate for blocks of size 2^( 6) =       0.000499423978
  error estimate for blocks of size 2^( 7) =       0.000512382173

      target function =                  N/A
              le_mean =     -16.914679330857
             les_mean =     286.450831615742
             stat err =       0.000489310285
             autocorr =       1.390164803590
              std dev =       0.586902821796
             le_variance =       0.344454922232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345085451
                                         uncertainty =       0.008540432575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345085451
                                         uncertainty =       0.008540432575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415002966
  error estimate for blocks of size 2^( 2) =       0.000429565728
  error estimate for blocks of size 2^( 3) =       0.000445333449
  error estimate for blocks of size 2^( 4) =       0.000463603680
  error estimate for blocks of size 2^( 5) =       0.000481831309
  error estimate for blocks of size 2^( 6) =       0.000499423979
  error estimate for blocks of size 2^( 7) =       0.000512382174

      target function =                  N/A
              le_mean =     -16.914679330837
             les_mean =     286.450831617116
             stat err =       0.000489310286
             autocorr =       1.390164800571
              std dev =       0.586902823555
             le_variance =       0.344454924297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345084421
                                         uncertainty =       0.008540432571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345084421
                                         uncertainty =       0.008540432571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415002966
  error estimate for blocks of size 2^( 2) =       0.000429565728
  error estimate for blocks of size 2^( 3) =       0.000445333448
  error estimate for blocks of size 2^( 4) =       0.000463603680
  error estimate for blocks of size 2^( 5) =       0.000481831309
  error estimate for blocks of size 2^( 6) =       0.000499423979
  error estimate for blocks of size 2^( 7) =       0.000512382173

      target function =                  N/A
              le_mean =     -16.914679330847
             les_mean =     286.450831616429
             stat err =       0.000489310285
             autocorr =       1.390164802082
              std dev =       0.586902822675
             le_variance =       0.344454923264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345083520
                                         uncertainty =       0.008540432568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343345083520
                                         uncertainty =       0.008540432568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415002965
  error estimate for blocks of size 2^( 2) =       0.000429565727
  error estimate for blocks of size 2^( 3) =       0.000445333448
  error estimate for blocks of size 2^( 4) =       0.000463603679
  error estimate for blocks of size 2^( 5) =       0.000481831308
  error estimate for blocks of size 2^( 6) =       0.000499423978
  error estimate for blocks of size 2^( 7) =       0.000512382173

      target function =                  N/A
              le_mean =     -16.914679330856
             les_mean =     286.450831615828
             stat err =       0.000489310285
             autocorr =       1.390164803396
              std dev =       0.586902821906
             le_variance =       0.344454922361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914679330857        initial  <--
     9.5367e+04     9.5367e+05             2.9769e-09       -16.914679330837
     3.8147e+05     3.8147e+06             7.4423e-10       -16.914679330847
     1.5259e+06     1.5259e+07             1.8606e-10       -16.914679330856

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1326
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6336e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8911
    reference variance = 0.218772
====================================================
  Execution time = 2.0896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.5026e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5466e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350362483968
                                         uncertainty =       0.009419868808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350362483968
                                         uncertainty =       0.009419868808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418486860
  error estimate for blocks of size 2^( 2) =       0.000432656662
  error estimate for blocks of size 2^( 3) =       0.000448665504
  error estimate for blocks of size 2^( 4) =       0.000465235303
  error estimate for blocks of size 2^( 5) =       0.000482414559
  error estimate for blocks of size 2^( 6) =       0.000498500787
  error estimate for blocks of size 2^( 7) =       0.000510263103

      target function =                  N/A
              le_mean =     -16.914624323647
             les_mean =     286.454778339704
             stat err =       0.000489103438
             autocorr =       1.365959356985
              std dev =       0.591829793720
             le_variance =       0.350262504735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691462432365e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914624323647       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914624323649       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914624323650       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914624323650       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914624323877       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914624324137       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914624323840       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914624323620       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.827055e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914624323647       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914624323647       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914624323647       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914624323647       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914624325165       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914624323385       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914624323139       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914624320164       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 9.567632e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914624323647       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914624323647       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914624323647       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914624307999       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914624320696       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914624319493       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914624328028       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914624318115       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 2.391868e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6449e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9753
    reference variance = 0.240355
====================================================
  Execution time = 2.0432e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4322e-01
  Total weights = 2.0000e+06
  Execution time = 1.8973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289713003
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289713003
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414257575
  error estimate for blocks of size 2^( 2) =       0.000428362472
  error estimate for blocks of size 2^( 3) =       0.000444328992
  error estimate for blocks of size 2^( 4) =       0.000460588115
  error estimate for blocks of size 2^( 5) =       0.000478202091
  error estimate for blocks of size 2^( 6) =       0.000496547844
  error estimate for blocks of size 2^( 7) =       0.000507560352

      target function =                  N/A
              le_mean =     -16.915127104013
             les_mean =     286.464743449403
             stat err =       0.000485724600
             autocorr =       1.374799238916
              std dev =       0.585848680208
             le_variance =       0.343218676101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289712983
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289712983
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414257575
  error estimate for blocks of size 2^( 2) =       0.000428362472
  error estimate for blocks of size 2^( 3) =       0.000444328992
  error estimate for blocks of size 2^( 4) =       0.000460588115
  error estimate for blocks of size 2^( 5) =       0.000478202091
  error estimate for blocks of size 2^( 6) =       0.000496547844
  error estimate for blocks of size 2^( 7) =       0.000507560352

      target function =                  N/A
              le_mean =     -16.915127104013
             les_mean =     286.464743449397
             stat err =       0.000485724600
             autocorr =       1.374799238910
              std dev =       0.585848680191
             le_variance =       0.343218676081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289712993
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289712993
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414257575
  error estimate for blocks of size 2^( 2) =       0.000428362472
  error estimate for blocks of size 2^( 3) =       0.000444328992
  error estimate for blocks of size 2^( 4) =       0.000460588115
  error estimate for blocks of size 2^( 5) =       0.000478202091
  error estimate for blocks of size 2^( 6) =       0.000496547844
  error estimate for blocks of size 2^( 7) =       0.000507560352

      target function =                  N/A
              le_mean =     -16.915127104013
             les_mean =     286.464743449400
             stat err =       0.000485724600
             autocorr =       1.374799238914
              std dev =       0.585848680199
             le_variance =       0.343218676091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289713002
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343289713002
                                         uncertainty =       0.004335520069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414257575
  error estimate for blocks of size 2^( 2) =       0.000428362472
  error estimate for blocks of size 2^( 3) =       0.000444328992
  error estimate for blocks of size 2^( 4) =       0.000460588115
  error estimate for blocks of size 2^( 5) =       0.000478202091
  error estimate for blocks of size 2^( 6) =       0.000496547844
  error estimate for blocks of size 2^( 7) =       0.000507560352

      target function =                  N/A
              le_mean =     -16.915127104013
             les_mean =     286.464743449403
             stat err =       0.000485724600
             autocorr =       1.374799238916
              std dev =       0.585848680207
             le_variance =       0.343218676100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915127104013        initial
     9.5367e+05     9.5367e+06             3.8271e-10       -16.915127104013  <--
     3.8147e+06     3.8147e+07             9.5676e-11       -16.915127104013
     1.5259e+07     1.5259e+08             2.3919e-11       -16.915127104013

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 2.9983e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6439e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9873
    reference variance = 0.206129
====================================================
  Execution time = 2.0833e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3358e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333601440171
                                         uncertainty =       0.003072317086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333601440171
                                         uncertainty =       0.003072317086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408399082
  error estimate for blocks of size 2^( 2) =       0.000422173818
  error estimate for blocks of size 2^( 3) =       0.000437635137
  error estimate for blocks of size 2^( 4) =       0.000453404899
  error estimate for blocks of size 2^( 5) =       0.000469237516
  error estimate for blocks of size 2^( 6) =       0.000484424793
  error estimate for blocks of size 2^( 7) =       0.000496369798

      target function =                  N/A
              le_mean =     -16.916388487926
             les_mean =     286.497778927597
             stat err =       0.000475859252
             autocorr =       1.357649051306
              std dev =       0.577563520265
             le_variance =       0.333579619940


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691638848793e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916388487926       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916388487926       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916388487926       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916388487926       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916388487932       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916388487919       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916388487736       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916388487793       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.389824e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916388487926       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916388487926       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916388487926       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916388487926       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916388488099       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916388488110       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916388487755       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916388487409       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.474562e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916388487926       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916388487926       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916388487926       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916388487926       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916388487709       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916388488230       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916388490380       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916388486060       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 8.686412e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068309 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6337e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.543168
====================================================
  Execution time = 2.0603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.5142e-01
  Total weights = 2.0000e+06
  Execution time = 1.8762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488042319
                                         uncertainty =       0.016061629178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488042319
                                         uncertainty =       0.016061629178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419178271
  error estimate for blocks of size 2^( 2) =       0.000432740886
  error estimate for blocks of size 2^( 3) =       0.000448433818
  error estimate for blocks of size 2^( 4) =       0.000465815007
  error estimate for blocks of size 2^( 5) =       0.000483957222
  error estimate for blocks of size 2^( 6) =       0.000502388080
  error estimate for blocks of size 2^( 7) =       0.000514647368

      target function =                  N/A
              le_mean =     -16.915589885988
             les_mean =     286.488601860242
             stat err =       0.000491701919
             autocorr =       1.375961505949
              std dev =       0.592807595275
             le_variance =       0.351420845016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488041905
                                         uncertainty =       0.016061629134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488041905
                                         uncertainty =       0.016061629134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419178270
  error estimate for blocks of size 2^( 2) =       0.000432740886
  error estimate for blocks of size 2^( 3) =       0.000448433818
  error estimate for blocks of size 2^( 4) =       0.000465815007
  error estimate for blocks of size 2^( 5) =       0.000483957222
  error estimate for blocks of size 2^( 6) =       0.000502388080
  error estimate for blocks of size 2^( 7) =       0.000514647368

      target function =                  N/A
              le_mean =     -16.915589885990
             les_mean =     286.488601859887
             stat err =       0.000491701919
             autocorr =       1.375961506150
              std dev =       0.592807594927
             le_variance =       0.351420844603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488042112
                                         uncertainty =       0.016061629156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488042112
                                         uncertainty =       0.016061629156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419178270
  error estimate for blocks of size 2^( 2) =       0.000432740886
  error estimate for blocks of size 2^( 3) =       0.000448433818
  error estimate for blocks of size 2^( 4) =       0.000465815007
  error estimate for blocks of size 2^( 5) =       0.000483957222
  error estimate for blocks of size 2^( 6) =       0.000502388080
  error estimate for blocks of size 2^( 7) =       0.000514647368

      target function =                  N/A
              le_mean =     -16.915589885989
             les_mean =     286.488601860064
             stat err =       0.000491701919
             autocorr =       1.375961506049
              std dev =       0.592807595101
             le_variance =       0.351420844809

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488042293
                                         uncertainty =       0.016061629175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351488042293
                                         uncertainty =       0.016061629175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419178271
  error estimate for blocks of size 2^( 2) =       0.000432740886
  error estimate for blocks of size 2^( 3) =       0.000448433818
  error estimate for blocks of size 2^( 4) =       0.000465815007
  error estimate for blocks of size 2^( 5) =       0.000483957222
  error estimate for blocks of size 2^( 6) =       0.000502388080
  error estimate for blocks of size 2^( 7) =       0.000514647368

      target function =                  N/A
              le_mean =     -16.915589885988
             les_mean =     286.488601860220
             stat err =       0.000491701919
             autocorr =       1.375961505956
              std dev =       0.592807595253
             le_variance =       0.351420844990


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915589885988        initial
     2.3842e+05     2.3842e+06             1.3898e-09       -16.915589885990  <--
     9.5367e+05     9.5367e+06             3.4746e-10       -16.915589885989
     3.8147e+06     3.8147e+07             8.6864e-11       -16.915589885988

*****************************************************************************
Applying the update for shift_i =   2.3842e+05     and shift_s =   2.3842e+06
*****************************************************************************

  Execution time = 3.0064e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112236e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290187e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6415e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8574
    reference variance = 0.210169
====================================================
  Execution time = 2.0652e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3769e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337710060428
                                         uncertainty =       0.004209445156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337710060428
                                         uncertainty =       0.004209445156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410909577
  error estimate for blocks of size 2^( 2) =       0.000424871282
  error estimate for blocks of size 2^( 3) =       0.000440185458
  error estimate for blocks of size 2^( 4) =       0.000456275918
  error estimate for blocks of size 2^( 5) =       0.000474535796
  error estimate for blocks of size 2^( 6) =       0.000493679677
  error estimate for blocks of size 2^( 7) =       0.000509266853

      target function =                  N/A
              le_mean =     -16.914822685912
             les_mean =     286.448919688189
             stat err =       0.000483439561
             autocorr =       1.384177694697
              std dev =       0.581113896905
             le_variance =       0.337693361176


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691482268591e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914822685912       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914822685930       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914822685920       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914822685872       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914822685906       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914822685907       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914822685939       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914822685887       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.032195e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914822685912       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914822685917       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914822685914       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914822686061       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914822685971       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914822685843       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914822685912       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914822686074       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.258049e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914822685912       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914822685914       residual = 6.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914822685913       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914822685912       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914822685912       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914822685583       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914822686129       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914822686820       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.145121e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6208e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112237e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290187e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488960e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9174
    reference variance = 0.170982
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3242e-01
  Total weights = 2.0000e+06
  Execution time = 1.8971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550657
                                         uncertainty =       0.002634739616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550657
                                         uncertainty =       0.002634739616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407689457
  error estimate for blocks of size 2^( 2) =       0.000421874423
  error estimate for blocks of size 2^( 3) =       0.000437382782
  error estimate for blocks of size 2^( 4) =       0.000453706602
  error estimate for blocks of size 2^( 5) =       0.000470927308
  error estimate for blocks of size 2^( 6) =       0.000487809510
  error estimate for blocks of size 2^( 7) =       0.000499766847

      target function =                  N/A
              le_mean =     -16.915721843972
             les_mean =     286.474066723814
             stat err =       0.000478052567
             autocorr =       1.374967226108
              std dev =       0.576559959942
             le_variance =       0.332421387408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550301
                                         uncertainty =       0.002634739611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550301
                                         uncertainty =       0.002634739611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407689457
  error estimate for blocks of size 2^( 2) =       0.000421874423
  error estimate for blocks of size 2^( 3) =       0.000437382782
  error estimate for blocks of size 2^( 4) =       0.000453706601
  error estimate for blocks of size 2^( 5) =       0.000470927308
  error estimate for blocks of size 2^( 6) =       0.000487809510
  error estimate for blocks of size 2^( 7) =       0.000499766846

      target function =                  N/A
              le_mean =     -16.915721843982
             les_mean =     286.474066723808
             stat err =       0.000478052566
             autocorr =       1.374967225515
              std dev =       0.576559959632
             le_variance =       0.332421387051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550479
                                         uncertainty =       0.002634739613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550479
                                         uncertainty =       0.002634739613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407689457
  error estimate for blocks of size 2^( 2) =       0.000421874423
  error estimate for blocks of size 2^( 3) =       0.000437382782
  error estimate for blocks of size 2^( 4) =       0.000453706601
  error estimate for blocks of size 2^( 5) =       0.000470927308
  error estimate for blocks of size 2^( 6) =       0.000487809510
  error estimate for blocks of size 2^( 7) =       0.000499766847

      target function =                  N/A
              le_mean =     -16.915721843977
             les_mean =     286.474066723811
             stat err =       0.000478052566
             autocorr =       1.374967225804
              std dev =       0.576559959787
             le_variance =       0.332421387229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550635
                                         uncertainty =       0.002634739615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332446550635
                                         uncertainty =       0.002634739615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407689457
  error estimate for blocks of size 2^( 2) =       0.000421874423
  error estimate for blocks of size 2^( 3) =       0.000437382782
  error estimate for blocks of size 2^( 4) =       0.000453706602
  error estimate for blocks of size 2^( 5) =       0.000470927308
  error estimate for blocks of size 2^( 6) =       0.000487809510
  error estimate for blocks of size 2^( 7) =       0.000499766847

      target function =                  N/A
              le_mean =     -16.915721843972
             les_mean =     286.474066723814
             stat err =       0.000478052567
             autocorr =       1.374967226077
              std dev =       0.576559959923
             le_variance =       0.332421387386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915721843972        initial
     5.9605e+04     5.9605e+05             5.0322e-09       -16.915721843982  <--
     2.3842e+05     2.3842e+06             1.2580e-09       -16.915721843977
     9.5367e+05     9.5367e+06             3.1451e-10       -16.915721843972

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 3.2800e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112237e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347562e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488961e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9027e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9283
    reference variance = 0.27176
====================================================
  Execution time = 2.1165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4308e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5319e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343071394245
                                         uncertainty =       0.003359287132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343071394245
                                         uncertainty =       0.003359287132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414176668
  error estimate for blocks of size 2^( 2) =       0.000428638099
  error estimate for blocks of size 2^( 3) =       0.000444543414
  error estimate for blocks of size 2^( 4) =       0.000461903248
  error estimate for blocks of size 2^( 5) =       0.000480322007
  error estimate for blocks of size 2^( 6) =       0.000495219814
  error estimate for blocks of size 2^( 7) =       0.000504616639

      target function =                  N/A
              le_mean =     -16.914866001165
             les_mean =     286.455776290540
             stat err =       0.000485515427
             autocorr =       1.374152106440
              std dev =       0.585734261172
             le_variance =       0.343084624711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691486600117e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914866001165       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914866001255       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914866001315       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914866001328       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914866001386       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914866001409       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914866001418       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914866001371       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.898888e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914866001165       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914866001188       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914866001203       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914866001211       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914866001168       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914866001194       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914866001253       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914866001217       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.747221e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914866001165       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914866001171       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914866001174       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914866001248       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914866001222       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914866001415       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914866001238       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914866001270       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.186806e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6704e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417771e-01 1 1  ON 1
 uu_2                 4.117920e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657956e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732895e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112237e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108294e-01 1 1  ON 28
 eO_9                -7.177879e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290188e-03 1 1  ON 34
eH1_5                 4.117148e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149154e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109307e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948453e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697963e-01 1 1  ON 48
eH2_9                 3.488961e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8813
    reference variance = 0.247848
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4038e-01
  Total weights = 2.0000e+06
  Execution time = 1.8872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421278484
                                         uncertainty =       0.004765419137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421278484
                                         uncertainty =       0.004765419137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538885
  error estimate for blocks of size 2^( 2) =       0.000426740101
  error estimate for blocks of size 2^( 3) =       0.000441950912
  error estimate for blocks of size 2^( 4) =       0.000458629862
  error estimate for blocks of size 2^( 5) =       0.000475539638
  error estimate for blocks of size 2^( 6) =       0.000490353366
  error estimate for blocks of size 2^( 7) =       0.000501435031

      target function =                  N/A
              le_mean =     -16.914949302817
             les_mean =     286.455886410198
             stat err =       0.000481489475
             autocorr =       1.362209216575
              std dev =       0.583418086368
             le_variance =       0.340376663501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421283558
                                         uncertainty =       0.004765419230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421283558
                                         uncertainty =       0.004765419230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538888
  error estimate for blocks of size 2^( 2) =       0.000426740104
  error estimate for blocks of size 2^( 3) =       0.000441950915
  error estimate for blocks of size 2^( 4) =       0.000458629865
  error estimate for blocks of size 2^( 5) =       0.000475539641
  error estimate for blocks of size 2^( 6) =       0.000490353369
  error estimate for blocks of size 2^( 7) =       0.000501435033

      target function =                  N/A
              le_mean =     -16.914949302830
             les_mean =     286.455886415699
             stat err =       0.000481489477
             autocorr =       1.362209208209
              std dev =       0.583418090714
             le_variance =       0.340376668573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421281021
                                         uncertainty =       0.004765419183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421281021
                                         uncertainty =       0.004765419183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538887
  error estimate for blocks of size 2^( 2) =       0.000426740103
  error estimate for blocks of size 2^( 3) =       0.000441950913
  error estimate for blocks of size 2^( 4) =       0.000458629864
  error estimate for blocks of size 2^( 5) =       0.000475539639
  error estimate for blocks of size 2^( 6) =       0.000490353367
  error estimate for blocks of size 2^( 7) =       0.000501435032

      target function =                  N/A
              le_mean =     -16.914949302824
             les_mean =     286.455886412949
             stat err =       0.000481489476
             autocorr =       1.362209212396
              std dev =       0.583418088541
             le_variance =       0.340376666037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421278801
                                         uncertainty =       0.004765419142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340421278801
                                         uncertainty =       0.004765419142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412538885
  error estimate for blocks of size 2^( 2) =       0.000426740101
  error estimate for blocks of size 2^( 3) =       0.000441950912
  error estimate for blocks of size 2^( 4) =       0.000458629863
  error estimate for blocks of size 2^( 5) =       0.000475539638
  error estimate for blocks of size 2^( 6) =       0.000490353367
  error estimate for blocks of size 2^( 7) =       0.000501435031

      target function =                  N/A
              le_mean =     -16.914949302818
             les_mean =     286.455886410542
             stat err =       0.000481489475
             autocorr =       1.362209216061
              std dev =       0.583418086639
             le_variance =       0.340376663818


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914949302817        initial
     1.4901e+04     1.4901e+05             1.8989e-08       -16.914949302830  <--
     5.9605e+04     5.9605e+05             4.7472e-09       -16.914949302824
     2.3842e+05     2.3842e+06             1.1868e-09       -16.914949302818

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.9771e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380342e-02 1 1  ON 4
 uu_5                -9.657957e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978131e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732894e-02 1 1  ON 12
 ud_3                -1.305452e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647163e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112238e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899588e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177880e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204012e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290187e-03 1 1  ON 34
eH1_5                 4.117146e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149155e-02 1 1  ON 39
eH2_0                -2.336029e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893501e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109306e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948452e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488962e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6481e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9463
    reference variance = 0.166653
====================================================
  Execution time = 2.0701e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3527e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335337489209
                                         uncertainty =       0.003965348028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335337489209
                                         uncertainty =       0.003965348028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409431543
  error estimate for blocks of size 2^( 2) =       0.000424226829
  error estimate for blocks of size 2^( 3) =       0.000440332493
  error estimate for blocks of size 2^( 4) =       0.000458167173
  error estimate for blocks of size 2^( 5) =       0.000475980216
  error estimate for blocks of size 2^( 6) =       0.000492695139
  error estimate for blocks of size 2^( 7) =       0.000505787787

      target function =                  N/A
              le_mean =     -16.914606778352
             les_mean =     286.439190676067
             stat err =       0.000483157579
             autocorr =       1.392563460789
              std dev =       0.579023641508
             le_variance =       0.335268377426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691460677835e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914606778352       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914606779490       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914606779439       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914606779568       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914606779655       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914606779721       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914606779658       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914606779655       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 6.563767e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914606778352       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914606778637       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914606778624       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914606778655       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914606778671       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914606778699       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914606778683       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914606778655       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.640948e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914606778352       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914606778423       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914606778420       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914606778428       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914606778439       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914606778438       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914606778417       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914606778423       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 4.102374e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6302e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380343e-02 1 1  ON 4
 uu_5                -9.657958e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434509e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732894e-02 1 1  ON 12
 ud_3                -1.305454e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454808e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429564e-01 1 1  ON 21
 eO_2                -2.112239e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823717e-01 1 1  ON 25
 eO_6                 2.507927e-01 1 1  ON 26
 eO_7                -4.899587e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177881e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204014e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290189e-03 1 1  ON 34
eH1_5                 4.117146e-02 1 1  ON 35
eH1_6                 9.663577e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149156e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893502e-02 1 1  ON 42
eH2_3                -3.493055e-02 1 1  ON 43
eH2_4                 1.109306e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948452e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488964e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8809
    reference variance = 0.233334
====================================================
  Execution time = 2.0517e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3435e-01
  Total weights = 2.0000e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406800348
                                         uncertainty =       0.003232432466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406800348
                                         uncertainty =       0.003232432466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408868217
  error estimate for blocks of size 2^( 2) =       0.000423543836
  error estimate for blocks of size 2^( 3) =       0.000439430767
  error estimate for blocks of size 2^( 4) =       0.000456528597
  error estimate for blocks of size 2^( 5) =       0.000473718575
  error estimate for blocks of size 2^( 6) =       0.000490802091
  error estimate for blocks of size 2^( 7) =       0.000503067685

      target function =                  N/A
              le_mean =     -16.914916015243
             les_mean =     286.448730073565
             stat err =       0.000481029237
             autocorr =       1.384127962667
              std dev =       0.578226977922
             le_variance =       0.334346437997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406774890
                                         uncertainty =       0.003232431839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406774890
                                         uncertainty =       0.003232431839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408868202
  error estimate for blocks of size 2^( 2) =       0.000423543821
  error estimate for blocks of size 2^( 3) =       0.000439430754
  error estimate for blocks of size 2^( 4) =       0.000456528585
  error estimate for blocks of size 2^( 5) =       0.000473718562
  error estimate for blocks of size 2^( 6) =       0.000490802078
  error estimate for blocks of size 2^( 7) =       0.000503067674

      target function =                  N/A
              le_mean =     -16.914916015554
             les_mean =     286.448730058629
             stat err =       0.000481029225
             autocorr =       1.384127996101
              std dev =       0.578226955935
             le_variance =       0.334346412570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406787617
                                         uncertainty =       0.003232432152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406787617
                                         uncertainty =       0.003232432152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408868209
  error estimate for blocks of size 2^( 2) =       0.000423543829
  error estimate for blocks of size 2^( 3) =       0.000439430760
  error estimate for blocks of size 2^( 4) =       0.000456528591
  error estimate for blocks of size 2^( 5) =       0.000473718568
  error estimate for blocks of size 2^( 6) =       0.000490802085
  error estimate for blocks of size 2^( 7) =       0.000503067680

      target function =                  N/A
              le_mean =     -16.914916015399
             les_mean =     286.448730066096
             stat err =       0.000481029231
             autocorr =       1.384127979389
              std dev =       0.578226966928
             le_variance =       0.334346425282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406798756
                                         uncertainty =       0.003232432427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334406798756
                                         uncertainty =       0.003232432427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408868216
  error estimate for blocks of size 2^( 2) =       0.000423543835
  error estimate for blocks of size 2^( 3) =       0.000439430766
  error estimate for blocks of size 2^( 4) =       0.000456528597
  error estimate for blocks of size 2^( 5) =       0.000473718574
  error estimate for blocks of size 2^( 6) =       0.000490802090
  error estimate for blocks of size 2^( 7) =       0.000503067685

      target function =                  N/A
              le_mean =     -16.914916015263
             les_mean =     286.448730072631
             stat err =       0.000481029236
             autocorr =       1.384127964758
              std dev =       0.578226976548
             le_variance =       0.334346436408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914916015243        initial
     3.7253e+03     3.7253e+04             6.5638e-08       -16.914916015554  <--
     1.4901e+04     1.4901e+05             1.6409e-08       -16.914916015399
     5.9605e+04     5.9605e+05             4.1024e-09       -16.914916015263

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 3.0007e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112240e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290194e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8612
    reference variance = 0.324954
====================================================
  Execution time = 2.0634e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.3922e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339160394071
                                         uncertainty =       0.003840778978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339160394071
                                         uncertainty =       0.003840778978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411836756
  error estimate for blocks of size 2^( 2) =       0.000425631194
  error estimate for blocks of size 2^( 3) =       0.000442038014
  error estimate for blocks of size 2^( 4) =       0.000458860018
  error estimate for blocks of size 2^( 5) =       0.000476845174
  error estimate for blocks of size 2^( 6) =       0.000495989723
  error estimate for blocks of size 2^( 7) =       0.000511226934

      target function =                  N/A
              le_mean =     -16.914451275649
             les_mean =     286.437880813438
             stat err =       0.000485730462
             autocorr =       1.391042737467
              std dev =       0.582425125454
             le_variance =       0.339219026760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691445127565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914451275649       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914451277644       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914451278440       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914451278491       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914451278160       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914451278328       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914451278764       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914451278761       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 3.174641e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914451275649       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914451276147       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914451276346       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914451276359       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914451276277       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914451276321       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914451276427       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914451276428       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 7.936630e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914451275649       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914451275773       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914451275823       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914451275826       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914451275806       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914451275818       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914451275850       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914451275831       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.984159e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6146e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.081592e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117924e-02 1 1  ON 2
 uu_3                -2.025944e-02 1 1  ON 3
 uu_4                -6.380348e-02 1 1  ON 4
 uu_5                -9.657959e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978130e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732889e-02 1 1  ON 12
 ud_3                -1.305462e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467602e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647165e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112246e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262862e-01 1 1  ON 24
 eO_5                 4.823719e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899581e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177886e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290193e-03 1 1  ON 34
eH1_5                 4.117139e-02 1 1  ON 35
eH1_6                 9.663573e-02 1 1  ON 36
eH1_7                 1.470850e-01 1 1  ON 37
eH1_8                 1.643006e-01 1 1  ON 38
eH1_9                 5.149165e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893504e-02 1 1  ON 42
eH2_3                -3.493058e-02 1 1  ON 43
eH2_4                 1.109301e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948450e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488976e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.424064
====================================================
  Execution time = 2.0300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.3387e-01
  Total weights = 2.0000e+06
  Execution time = 1.8919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867836489
                                         uncertainty =       0.002685484457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867836489
                                         uncertainty =       0.002685484457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575731
  error estimate for blocks of size 2^( 2) =       0.000422720825
  error estimate for blocks of size 2^( 3) =       0.000439373993
  error estimate for blocks of size 2^( 4) =       0.000457160094
  error estimate for blocks of size 2^( 5) =       0.000475904499
  error estimate for blocks of size 2^( 6) =       0.000495751100
  error estimate for blocks of size 2^( 7) =       0.000511615639

      target function =                  N/A
              le_mean =     -16.914190828147
             les_mean =     286.423719460750
             stat err =       0.000485107833
             autocorr =       1.409715388563
              std dev =       0.577813340704
             le_variance =       0.333868256695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867826477
                                         uncertainty =       0.002685484596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867826477
                                         uncertainty =       0.002685484596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575725
  error estimate for blocks of size 2^( 2) =       0.000422720820
  error estimate for blocks of size 2^( 3) =       0.000439373989
  error estimate for blocks of size 2^( 4) =       0.000457160091
  error estimate for blocks of size 2^( 5) =       0.000475904493
  error estimate for blocks of size 2^( 6) =       0.000495751086
  error estimate for blocks of size 2^( 7) =       0.000511615621

      target function =                  N/A
              le_mean =     -16.914190827870
             les_mean =     286.423719441389
             stat err =       0.000485107823
             autocorr =       1.409715370622
              std dev =       0.577813332069
             le_variance =       0.333868246716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867831487
                                         uncertainty =       0.002685484527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867831487
                                         uncertainty =       0.002685484527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575728
  error estimate for blocks of size 2^( 2) =       0.000422720822
  error estimate for blocks of size 2^( 3) =       0.000439373991
  error estimate for blocks of size 2^( 4) =       0.000457160092
  error estimate for blocks of size 2^( 5) =       0.000475904496
  error estimate for blocks of size 2^( 6) =       0.000495751093
  error estimate for blocks of size 2^( 7) =       0.000511615630

      target function =                  N/A
              le_mean =     -16.914190828009
             les_mean =     286.423719451071
             stat err =       0.000485107828
             autocorr =       1.409715379583
              std dev =       0.577813336389
             le_variance =       0.333868251709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867835864
                                         uncertainty =       0.002685484465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333867835864
                                         uncertainty =       0.002685484465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575731
  error estimate for blocks of size 2^( 2) =       0.000422720825
  error estimate for blocks of size 2^( 3) =       0.000439373993
  error estimate for blocks of size 2^( 4) =       0.000457160094
  error estimate for blocks of size 2^( 5) =       0.000475904498
  error estimate for blocks of size 2^( 6) =       0.000495751099
  error estimate for blocks of size 2^( 7) =       0.000511615638

      target function =                  N/A
              le_mean =     -16.914190828130
             les_mean =     286.423719459540
             stat err =       0.000485107832
             autocorr =       1.409715387443
              std dev =       0.577813340164
             le_variance =       0.333868256072


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914190828147        initial  <--
     9.3132e+02     9.3132e+03             3.1746e-07       -16.914190827870
     3.7253e+03     3.7253e+04             7.9366e-08       -16.914190828009
     1.4901e+04     1.4901e+05             1.9842e-08       -16.914190828130

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8611
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112240e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290194e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.271133
====================================================
  Execution time = 2.0636e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3387e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333941810301
                                         uncertainty =       0.003244291812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333941810301
                                         uncertainty =       0.003244291812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408575419
  error estimate for blocks of size 2^( 2) =       0.000422647038
  error estimate for blocks of size 2^( 3) =       0.000438546375
  error estimate for blocks of size 2^( 4) =       0.000454738570
  error estimate for blocks of size 2^( 5) =       0.000472245683
  error estimate for blocks of size 2^( 6) =       0.000489122764
  error estimate for blocks of size 2^( 7) =       0.000503700859

      target function =                  N/A
              le_mean =     -16.916139335320
             les_mean =     286.489637590757
             stat err =       0.000479951969
             autocorr =       1.379911030793
              std dev =       0.577812898558
             le_variance =       0.333867745740


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691613933532e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916139335320       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916139335320       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916139335402       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916139335484       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916139335396       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916139335393       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916139335401       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916139335414       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 3.095072e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916139335320       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916139335320       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916139335340       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916139335362       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916139335339       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916139335342       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916139335361       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916139335328       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 7.737697e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916139335320       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916139335320       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916139335325       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916139335317       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916139335324       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916139335336       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916139335325       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916139335371       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.934425e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081507 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6201e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290194e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339709e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8456
    reference variance = 0.207651
====================================================
  Execution time = 2.0448e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4127e-01
  Total weights = 2.0000e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289896784
                                         uncertainty =       0.006683339400

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289896784
                                         uncertainty =       0.006683339400

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413079206
  error estimate for blocks of size 2^( 2) =       0.000427117047
  error estimate for blocks of size 2^( 3) =       0.000442725997
  error estimate for blocks of size 2^( 4) =       0.000459543486
  error estimate for blocks of size 2^( 5) =       0.000476793890
  error estimate for blocks of size 2^( 6) =       0.000492014895
  error estimate for blocks of size 2^( 7) =       0.000500733522

      target function =                  N/A
              le_mean =     -16.914719139892
             les_mean =     286.448992271769
             stat err =       0.000482271448
             autocorr =       1.363064590002
              std dev =       0.584182215551
             le_variance =       0.341268860966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289887992
                                         uncertainty =       0.006683339325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289887992
                                         uncertainty =       0.006683339325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413079201
  error estimate for blocks of size 2^( 2) =       0.000427117042
  error estimate for blocks of size 2^( 3) =       0.000442725992
  error estimate for blocks of size 2^( 4) =       0.000459543481
  error estimate for blocks of size 2^( 5) =       0.000476793885
  error estimate for blocks of size 2^( 6) =       0.000492014890
  error estimate for blocks of size 2^( 7) =       0.000500733517

      target function =                  N/A
              le_mean =     -16.914719139676
             les_mean =     286.448992255640
             stat err =       0.000482271443
             autocorr =       1.363064595774
              std dev =       0.584182208022
             le_variance =       0.341268852169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289892388
                                         uncertainty =       0.006683339363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289892388
                                         uncertainty =       0.006683339363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413079203
  error estimate for blocks of size 2^( 2) =       0.000427117044
  error estimate for blocks of size 2^( 3) =       0.000442725995
  error estimate for blocks of size 2^( 4) =       0.000459543484
  error estimate for blocks of size 2^( 5) =       0.000476793888
  error estimate for blocks of size 2^( 6) =       0.000492014893
  error estimate for blocks of size 2^( 7) =       0.000500733519

      target function =                  N/A
              le_mean =     -16.914719139784
             les_mean =     286.448992263704
             stat err =       0.000482271446
             autocorr =       1.363064592891
              std dev =       0.584182211787
             le_variance =       0.341268856568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289896234
                                         uncertainty =       0.006683339396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341289896234
                                         uncertainty =       0.006683339396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413079206
  error estimate for blocks of size 2^( 2) =       0.000427117047
  error estimate for blocks of size 2^( 3) =       0.000442725997
  error estimate for blocks of size 2^( 4) =       0.000459543486
  error estimate for blocks of size 2^( 5) =       0.000476793890
  error estimate for blocks of size 2^( 6) =       0.000492014895
  error estimate for blocks of size 2^( 7) =       0.000500733522

      target function =                  N/A
              le_mean =     -16.914719139879
             les_mean =     286.448992270761
             stat err =       0.000482271448
             autocorr =       1.363064590356
              std dev =       0.584182215081
             le_variance =       0.341268860417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914719139892        initial  <--
     9.3132e+03     9.3132e+04             3.0951e-08       -16.914719139676
     3.7253e+04     3.7253e+05             7.7377e-09       -16.914719139784
     1.4901e+05     1.4901e+06             1.9344e-09       -16.914719139879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5816
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112240e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290194e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6789e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9176
    reference variance = 0.162048
====================================================
  Execution time = 2.2746e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3658e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336616127067
                                         uncertainty =       0.003279985771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336616127067
                                         uncertainty =       0.003279985771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410229008
  error estimate for blocks of size 2^( 2) =       0.000424078520
  error estimate for blocks of size 2^( 3) =       0.000439336987
  error estimate for blocks of size 2^( 4) =       0.000455378834
  error estimate for blocks of size 2^( 5) =       0.000471857982
  error estimate for blocks of size 2^( 6) =       0.000485255452
  error estimate for blocks of size 2^( 7) =       0.000498684066

      target function =                  N/A
              le_mean =     -16.916059878658
             les_mean =     286.489657327622
             stat err =       0.000477794083
             autocorr =       1.356528122710
              std dev =       0.580151426423
             le_variance =       0.336575677581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691605987866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916059878658       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916059878665       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916059878665       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916059878677       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916059878640       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916059878789       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916059878581       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916059878691       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.312593e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916059878658       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916059878659       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916059878659       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916059878755       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916059878653       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916059878613       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916059878660       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916059878664       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 8.281483e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916059878658       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916059878658       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916059878658       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916059878874       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916059878263       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916059878729       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916059878313       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916059880264       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.070370e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8319e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112240e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290195e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9461
    reference variance = 0.224456
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4759e-01
  Total weights = 2.0000e+06
  Execution time = 1.8936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689879572
                                         uncertainty =       0.008566267642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689879572
                                         uncertainty =       0.008566267642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416888466
  error estimate for blocks of size 2^( 2) =       0.000430834463
  error estimate for blocks of size 2^( 3) =       0.000446644857
  error estimate for blocks of size 2^( 4) =       0.000463209551
  error estimate for blocks of size 2^( 5) =       0.000481132612
  error estimate for blocks of size 2^( 6) =       0.000497357135
  error estimate for blocks of size 2^( 7) =       0.000512276510

      target function =                  N/A
              le_mean =     -16.915291325214
             les_mean =     286.474672429262
             stat err =       0.000488493952
             autocorr =       1.373025561910
              std dev =       0.589569322653
             le_variance =       0.347591986214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689880070
                                         uncertainty =       0.008566267627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689880070
                                         uncertainty =       0.008566267627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416888466
  error estimate for blocks of size 2^( 2) =       0.000430834463
  error estimate for blocks of size 2^( 3) =       0.000446644857
  error estimate for blocks of size 2^( 4) =       0.000463209551
  error estimate for blocks of size 2^( 5) =       0.000481132612
  error estimate for blocks of size 2^( 6) =       0.000497357135
  error estimate for blocks of size 2^( 7) =       0.000512276510

      target function =                  N/A
              le_mean =     -16.915291325222
             les_mean =     286.474672430035
             stat err =       0.000488493952
             autocorr =       1.373025560486
              std dev =       0.589569323075
             le_variance =       0.347591986712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689879821
                                         uncertainty =       0.008566267635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689879821
                                         uncertainty =       0.008566267635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416888466
  error estimate for blocks of size 2^( 2) =       0.000430834463
  error estimate for blocks of size 2^( 3) =       0.000446644857
  error estimate for blocks of size 2^( 4) =       0.000463209551
  error estimate for blocks of size 2^( 5) =       0.000481132612
  error estimate for blocks of size 2^( 6) =       0.000497357135
  error estimate for blocks of size 2^( 7) =       0.000512276510

      target function =                  N/A
              le_mean =     -16.915291325218
             les_mean =     286.474672429648
             stat err =       0.000488493952
             autocorr =       1.373025561196
              std dev =       0.589569322864
             le_variance =       0.347591986462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689879603
                                         uncertainty =       0.008566267641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347689879603
                                         uncertainty =       0.008566267641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416888466
  error estimate for blocks of size 2^( 2) =       0.000430834463
  error estimate for blocks of size 2^( 3) =       0.000446644857
  error estimate for blocks of size 2^( 4) =       0.000463209551
  error estimate for blocks of size 2^( 5) =       0.000481132612
  error estimate for blocks of size 2^( 6) =       0.000497357135
  error estimate for blocks of size 2^( 7) =       0.000512276510

      target function =                  N/A
              le_mean =     -16.915291325214
             les_mean =     286.474672429310
             stat err =       0.000488493952
             autocorr =       1.373025561811
              std dev =       0.589569322680
             le_variance =       0.347591986245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915291325214        initial
     9.3132e+04     9.3132e+05             3.3126e-09       -16.915291325222  <--
     3.7253e+05     3.7253e+06             8.2815e-10       -16.915291325218
     1.4901e+06     1.4901e+07             2.0704e-10       -16.915291325214

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.9926e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8251e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9061
    reference variance = 0.201444
====================================================
  Execution time = 2.2798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3892e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4813e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980574989
                                         uncertainty =       0.003491868453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338980574989
                                         uncertainty =       0.003491868453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411656853
  error estimate for blocks of size 2^( 2) =       0.000425954378
  error estimate for blocks of size 2^( 3) =       0.000441603528
  error estimate for blocks of size 2^( 4) =       0.000458724459
  error estimate for blocks of size 2^( 5) =       0.000476696311
  error estimate for blocks of size 2^( 6) =       0.000493830096
  error estimate for blocks of size 2^( 7) =       0.000508413765

      target function =                  N/A
              le_mean =     -16.916311428711
             les_mean =     286.500514912965
             stat err =       0.000484416158
             autocorr =       1.384734593980
              std dev =       0.582170704604
             le_variance =       0.338922729299


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691631142871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916311428711       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916311428753       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916311428750       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916311428727       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916311428762       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916311428768       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916311428770       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916311428801       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.552266e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916311428711       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916311428721       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916311428720       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916311428715       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916311428722       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916311428718       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916311428659       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916311428684       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.880666e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.916311428711       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.916311428713       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.916311428713       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.916311428550       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.916311428714       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.916311428901       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.916311428714       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.916311428697       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 9.701668e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8287e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290194e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9323
    reference variance = 0.174938
====================================================
  Execution time = 2.0357e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3230e-01
  Total weights = 2.0000e+06
  Execution time = 1.8812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372648932
                                         uncertainty =       0.002569354550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372648932
                                         uncertainty =       0.002569354550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613938
  error estimate for blocks of size 2^( 2) =       0.000421158349
  error estimate for blocks of size 2^( 3) =       0.000436784180
  error estimate for blocks of size 2^( 4) =       0.000453231008
  error estimate for blocks of size 2^( 5) =       0.000469921872
  error estimate for blocks of size 2^( 6) =       0.000486037341
  error estimate for blocks of size 2^( 7) =       0.000496512453

      target function =                  N/A
              le_mean =     -16.915951492755
             les_mean =     286.481712983376
             stat err =       0.000476425669
             autocorr =       1.366130706807
              std dev =       0.576453158806
             le_variance =       0.332298244297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372646638
                                         uncertainty =       0.002569354525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372646638
                                         uncertainty =       0.002569354525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613936
  error estimate for blocks of size 2^( 2) =       0.000421158347
  error estimate for blocks of size 2^( 3) =       0.000436784179
  error estimate for blocks of size 2^( 4) =       0.000453231007
  error estimate for blocks of size 2^( 5) =       0.000469921870
  error estimate for blocks of size 2^( 6) =       0.000486037339
  error estimate for blocks of size 2^( 7) =       0.000496512451

      target function =                  N/A
              le_mean =     -16.915951492702
             les_mean =     286.481712979312
             stat err =       0.000476425667
             autocorr =       1.366130707246
              std dev =       0.576453156816
             le_variance =       0.332298242003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372647785
                                         uncertainty =       0.002569354538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372647785
                                         uncertainty =       0.002569354538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613937
  error estimate for blocks of size 2^( 2) =       0.000421158348
  error estimate for blocks of size 2^( 3) =       0.000436784179
  error estimate for blocks of size 2^( 4) =       0.000453231008
  error estimate for blocks of size 2^( 5) =       0.000469921871
  error estimate for blocks of size 2^( 6) =       0.000486037340
  error estimate for blocks of size 2^( 7) =       0.000496512452

      target function =                  N/A
              le_mean =     -16.915951492728
             les_mean =     286.481712981344
             stat err =       0.000476425668
             autocorr =       1.366130707025
              std dev =       0.576453157811
             le_variance =       0.332298243150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372648789
                                         uncertainty =       0.002569354548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332372648789
                                         uncertainty =       0.002569354548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407613938
  error estimate for blocks of size 2^( 2) =       0.000421158349
  error estimate for blocks of size 2^( 3) =       0.000436784180
  error estimate for blocks of size 2^( 4) =       0.000453231008
  error estimate for blocks of size 2^( 5) =       0.000469921872
  error estimate for blocks of size 2^( 6) =       0.000486037341
  error estimate for blocks of size 2^( 7) =       0.000496512453

      target function =                  N/A
              le_mean =     -16.915951492751
             les_mean =     286.481712983122
             stat err =       0.000476425668
             autocorr =       1.366130706848
              std dev =       0.576453158681
             le_variance =       0.332298244154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915951492755        initial  <--
     2.3283e+04     2.3283e+05             1.5523e-08       -16.915951492702
     9.3132e+04     9.3132e+05             3.8807e-09       -16.915951492728
     3.7253e+05     3.7253e+06             9.7017e-10       -16.915951492751

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8572
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8150e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8707
    reference variance = 0.256285
====================================================
  Execution time = 2.0736e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4515e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339560339188
                                         uncertainty =       0.005046067344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339560339188
                                         uncertainty =       0.005046067344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411992772
  error estimate for blocks of size 2^( 2) =       0.000426350882
  error estimate for blocks of size 2^( 3) =       0.000442313116
  error estimate for blocks of size 2^( 4) =       0.000459985801
  error estimate for blocks of size 2^( 5) =       0.000478922977
  error estimate for blocks of size 2^( 6) =       0.000494149602
  error estimate for blocks of size 2^( 7) =       0.000505193934

      target function =                  N/A
              le_mean =     -16.914651956850
             les_mean =     286.444926739557
             stat err =       0.000484563078
             autocorr =       1.383316146890
              std dev =       0.582645765381
             le_variance =       0.339476087916


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691465195685e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914651956850       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914651956857       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914651956862       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914651956796       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914651956882       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914651957154       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914651956724       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914651956808       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.240666e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914651956850       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914651956852       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914651956853       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914651957160       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914651956656       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914651956623       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914651957553       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914651956086       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.101668e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914651956850       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914651956851       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914651956851       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914651956121       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914651956712       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914651955625       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914651957651       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914651957364       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.754162e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089488 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6194e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117921e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8823
    reference variance = 0.288365
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3741e-01
  Total weights = 2.0000e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524215283
                                         uncertainty =       0.003851576060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524215283
                                         uncertainty =       0.003851576060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410737358
  error estimate for blocks of size 2^( 2) =       0.000424459102
  error estimate for blocks of size 2^( 3) =       0.000439768511
  error estimate for blocks of size 2^( 4) =       0.000455808151
  error estimate for blocks of size 2^( 5) =       0.000472967502
  error estimate for blocks of size 2^( 6) =       0.000487707397
  error estimate for blocks of size 2^( 7) =       0.000499792607

      target function =                  N/A
              le_mean =     -16.914563150450
             les_mean =     286.439856756559
             stat err =       0.000479068914
             autocorr =       1.360402973019
              std dev =       0.580870342408
             le_variance =       0.337410354689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524214880
                                         uncertainty =       0.003851576052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524214880
                                         uncertainty =       0.003851576052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410737358
  error estimate for blocks of size 2^( 2) =       0.000424459102
  error estimate for blocks of size 2^( 3) =       0.000439768510
  error estimate for blocks of size 2^( 4) =       0.000455808151
  error estimate for blocks of size 2^( 5) =       0.000472967502
  error estimate for blocks of size 2^( 6) =       0.000487707397
  error estimate for blocks of size 2^( 7) =       0.000499792606

      target function =                  N/A
              le_mean =     -16.914563150451
             les_mean =     286.439856756187
             stat err =       0.000479068914
             autocorr =       1.360402973400
              std dev =       0.580870342062
             le_variance =       0.337410354287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524215081
                                         uncertainty =       0.003851576056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524215081
                                         uncertainty =       0.003851576056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410737358
  error estimate for blocks of size 2^( 2) =       0.000424459102
  error estimate for blocks of size 2^( 3) =       0.000439768510
  error estimate for blocks of size 2^( 4) =       0.000455808151
  error estimate for blocks of size 2^( 5) =       0.000472967502
  error estimate for blocks of size 2^( 6) =       0.000487707397
  error estimate for blocks of size 2^( 7) =       0.000499792607

      target function =                  N/A
              le_mean =     -16.914563150451
             les_mean =     286.439856756373
             stat err =       0.000479068914
             autocorr =       1.360402973204
              std dev =       0.580870342235
             le_variance =       0.337410354488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524215257
                                         uncertainty =       0.003851576059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337524215257
                                         uncertainty =       0.003851576059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410737358
  error estimate for blocks of size 2^( 2) =       0.000424459102
  error estimate for blocks of size 2^( 3) =       0.000439768511
  error estimate for blocks of size 2^( 4) =       0.000455808151
  error estimate for blocks of size 2^( 5) =       0.000472967502
  error estimate for blocks of size 2^( 6) =       0.000487707397
  error estimate for blocks of size 2^( 7) =       0.000499792607

      target function =                  N/A
              le_mean =     -16.914563150450
             les_mean =     286.439856756536
             stat err =       0.000479068914
             autocorr =       1.360402973046
              std dev =       0.580870342386
             le_variance =       0.337410354664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914563150450        initial
     2.3283e+05     2.3283e+06             1.2407e-09       -16.914563150451  <--
     9.3132e+05     9.3132e+06             3.1017e-10       -16.914563150451
     3.7253e+06     3.7253e+07             7.7542e-11       -16.914563150450

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 2.9869e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290195e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9681
    reference variance = 0.193365
====================================================
  Execution time = 2.0427e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3544e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330229530
                                         uncertainty =       0.003563005770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335330229530
                                         uncertainty =       0.003563005770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409536332
  error estimate for blocks of size 2^( 2) =       0.000424121960
  error estimate for blocks of size 2^( 3) =       0.000439537892
  error estimate for blocks of size 2^( 4) =       0.000455931158
  error estimate for blocks of size 2^( 5) =       0.000472803621
  error estimate for blocks of size 2^( 6) =       0.000487199683
  error estimate for blocks of size 2^( 7) =       0.000497911853

      target function =                  N/A
              le_mean =     -16.915369929892
             les_mean =     286.465179711308
             stat err =       0.000478461579
             autocorr =       1.364926502520
              std dev =       0.579171834544
             le_variance =       0.335440013929


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691536992989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915369929892       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915369929899       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915369929910       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915369929922       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915369929913       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915369929899       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915369929925       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915369929896       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.762187e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915369929892       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915369929894       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915369929897       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915369929934       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915369929853       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915369929935       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915369929675       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915369929958       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.440547e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915369929892       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915369929893       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915369929893       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915369928921       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915369929936       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915369927105       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915369929979       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915369931165       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.601367e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092122 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5931e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109304e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9618
    reference variance = 0.200375
====================================================
  Execution time = 2.0034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4224e-01
  Total weights = 2.0000e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298737294
                                         uncertainty =       0.005928195352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298737294
                                         uncertainty =       0.005928195352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413664340
  error estimate for blocks of size 2^( 2) =       0.000427682702
  error estimate for blocks of size 2^( 3) =       0.000443260277
  error estimate for blocks of size 2^( 4) =       0.000458241185
  error estimate for blocks of size 2^( 5) =       0.000476184380
  error estimate for blocks of size 2^( 6) =       0.000493554000
  error estimate for blocks of size 2^( 7) =       0.000504955378

      target function =                  N/A
              le_mean =     -16.915333299602
             les_mean =     286.470736838229
             stat err =       0.000483233736
             autocorr =       1.364640711216
              std dev =       0.585009720201
             le_variance =       0.342236372729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298738109
                                         uncertainty =       0.005928195371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298738109
                                         uncertainty =       0.005928195371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413664341
  error estimate for blocks of size 2^( 2) =       0.000427682702
  error estimate for blocks of size 2^( 3) =       0.000443260277
  error estimate for blocks of size 2^( 4) =       0.000458241185
  error estimate for blocks of size 2^( 5) =       0.000476184381
  error estimate for blocks of size 2^( 6) =       0.000493554001
  error estimate for blocks of size 2^( 7) =       0.000504955378

      target function =                  N/A
              le_mean =     -16.915333299615
             les_mean =     286.470736839491
             stat err =       0.000483233736
             autocorr =       1.364640709426
              std dev =       0.585009720896
             le_variance =       0.342236373543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298737701
                                         uncertainty =       0.005928195361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298737701
                                         uncertainty =       0.005928195361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413664340
  error estimate for blocks of size 2^( 2) =       0.000427682702
  error estimate for blocks of size 2^( 3) =       0.000443260277
  error estimate for blocks of size 2^( 4) =       0.000458241185
  error estimate for blocks of size 2^( 5) =       0.000476184381
  error estimate for blocks of size 2^( 6) =       0.000493554001
  error estimate for blocks of size 2^( 7) =       0.000504955378

      target function =                  N/A
              le_mean =     -16.915333299608
             les_mean =     286.470736838860
             stat err =       0.000483233736
             autocorr =       1.364640710320
              std dev =       0.585009720549
             le_variance =       0.342236373136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298737345
                                         uncertainty =       0.005928195353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342298737345
                                         uncertainty =       0.005928195353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413664340
  error estimate for blocks of size 2^( 2) =       0.000427682702
  error estimate for blocks of size 2^( 3) =       0.000443260277
  error estimate for blocks of size 2^( 4) =       0.000458241185
  error estimate for blocks of size 2^( 5) =       0.000476184380
  error estimate for blocks of size 2^( 6) =       0.000493554001
  error estimate for blocks of size 2^( 7) =       0.000504955378

      target function =                  N/A
              le_mean =     -16.915333299603
             les_mean =     286.470736838308
             stat err =       0.000483233736
             autocorr =       1.364640711102
              std dev =       0.585009720244
             le_variance =       0.342236372780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915333299602        initial
     5.8208e+04     5.8208e+05             5.7622e-09       -16.915333299615  <--
     2.3283e+05     2.3283e+06             1.4405e-09       -16.915333299608
     9.3132e+05     9.3132e+06             3.6014e-10       -16.915333299603

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.9520e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5457e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9403
    reference variance = 0.328249
====================================================
  Execution time = 2.0363e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3835e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4702e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347013141
                                         uncertainty =       0.003618775561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338347013141
                                         uncertainty =       0.003618775561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411309299
  error estimate for blocks of size 2^( 2) =       0.000425709284
  error estimate for blocks of size 2^( 3) =       0.000440992591
  error estimate for blocks of size 2^( 4) =       0.000456954019
  error estimate for blocks of size 2^( 5) =       0.000473929747
  error estimate for blocks of size 2^( 6) =       0.000488118573
  error estimate for blocks of size 2^( 7) =       0.000498253077

      target function =                  N/A
              le_mean =     -16.914959913487
             les_mean =     286.454219383816
             stat err =       0.000479313854
             autocorr =       1.358009811934
              std dev =       0.581679188304
             le_variance =       0.338350678106


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691495991349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914959913487       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914959913570       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914959913542       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914959913494       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914959913570       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914959913601       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914959913608       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914959913614       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.361842e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914959913487       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914959913508       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914959913501       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914959913490       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914959913508       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914959913560       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914959913515       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914959913523       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.904610e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914959913487       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914959913493       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914959913491       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914959913488       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914959913502       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914959913106       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914959913759       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914959913641       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.476154e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5840e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978129e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177884e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290198e-03 1 1  ON 34
eH1_5                 4.117143e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488970e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9756
    reference variance = 0.302185
====================================================
  Execution time = 2.1077e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.2943e-01
  Total weights = 2.0000e+06
  Execution time = 1.8818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496762383
                                         uncertainty =       0.002743050459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496762383
                                         uncertainty =       0.002743050459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405852462
  error estimate for blocks of size 2^( 2) =       0.000420289864
  error estimate for blocks of size 2^( 3) =       0.000436287577
  error estimate for blocks of size 2^( 4) =       0.000453050795
  error estimate for blocks of size 2^( 5) =       0.000470765437
  error estimate for blocks of size 2^( 6) =       0.000486206972
  error estimate for blocks of size 2^( 7) =       0.000498416603

      target function =                  N/A
              le_mean =     -16.915051424992
             les_mean =     286.448396986730
             stat err =       0.000477109952
             autocorr =       1.381976257446
              std dev =       0.573962055636
             le_variance =       0.329432441309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496766994
                                         uncertainty =       0.002743050584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496766994
                                         uncertainty =       0.002743050584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405852465
  error estimate for blocks of size 2^( 2) =       0.000420289867
  error estimate for blocks of size 2^( 3) =       0.000436287579
  error estimate for blocks of size 2^( 4) =       0.000453050797
  error estimate for blocks of size 2^( 5) =       0.000470765439
  error estimate for blocks of size 2^( 6) =       0.000486206974
  error estimate for blocks of size 2^( 7) =       0.000498416604

      target function =                  N/A
              le_mean =     -16.915051424953
             les_mean =     286.448396990023
             stat err =       0.000477109954
             autocorr =       1.381976249150
              std dev =       0.573962059653
             le_variance =       0.329432445922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496764689
                                         uncertainty =       0.002743050521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496764689
                                         uncertainty =       0.002743050521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405852463
  error estimate for blocks of size 2^( 2) =       0.000420289865
  error estimate for blocks of size 2^( 3) =       0.000436287578
  error estimate for blocks of size 2^( 4) =       0.000453050796
  error estimate for blocks of size 2^( 5) =       0.000470765438
  error estimate for blocks of size 2^( 6) =       0.000486206973
  error estimate for blocks of size 2^( 7) =       0.000498416603

      target function =                  N/A
              le_mean =     -16.915051424973
             les_mean =     286.448396988377
             stat err =       0.000477109953
             autocorr =       1.381976253296
              std dev =       0.573962057645
             le_variance =       0.329432443616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496762671
                                         uncertainty =       0.002743050467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329496762671
                                         uncertainty =       0.002743050467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405852462
  error estimate for blocks of size 2^( 2) =       0.000420289864
  error estimate for blocks of size 2^( 3) =       0.000436287577
  error estimate for blocks of size 2^( 4) =       0.000453050795
  error estimate for blocks of size 2^( 5) =       0.000470765437
  error estimate for blocks of size 2^( 6) =       0.000486206973
  error estimate for blocks of size 2^( 7) =       0.000498416603

      target function =                  N/A
              le_mean =     -16.915051424990
             les_mean =     286.448396986936
             stat err =       0.000477109952
             autocorr =       1.381976256926
              std dev =       0.573962055887
             le_variance =       0.329432441598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915051424992        initial  <--
     1.4552e+04     1.4552e+05             2.3618e-08       -16.915051424953
     5.8208e+04     5.8208e+05             5.9046e-09       -16.915051424973
     2.3283e+05     2.3283e+06             1.4762e-09       -16.915051424990

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5697
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8508
    reference variance = 0.236519
====================================================
  Execution time = 2.0502e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3631e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336226520260
                                         uncertainty =       0.004778708031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336226520260
                                         uncertainty =       0.004778708031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410064318
  error estimate for blocks of size 2^( 2) =       0.000424550387
  error estimate for blocks of size 2^( 3) =       0.000440497189
  error estimate for blocks of size 2^( 4) =       0.000457137795
  error estimate for blocks of size 2^( 5) =       0.000475516907
  error estimate for blocks of size 2^( 6) =       0.000492915856
  error estimate for blocks of size 2^( 7) =       0.000505202441

      target function =                  N/A
              le_mean =     -16.915627128425
             les_mean =     286.474746470032
             stat err =       0.000482693250
             autocorr =       1.385601960872
              std dev =       0.579918520372
             le_variance =       0.336305490271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691562712843e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915627128425       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915627128428       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915627128431       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915627128430       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915627128428       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915627128438       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915627128505       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915627128405       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.935635e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915627128425       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915627128426       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915627128427       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915627128426       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915627128436       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915627128731       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915627128345       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915627127895       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.839091e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915627128425       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915627128425       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915627128426       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915627128438       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915627128490       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915627127817       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915627128951       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915627128011       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.209772e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5969e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.893
    reference variance = 0.473158
====================================================
  Execution time = 2.0285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3883e-01
  Total weights = 2.0000e+06
  Execution time = 1.8763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473111
                                         uncertainty =       0.004036669195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473111
                                         uncertainty =       0.004036669195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602550
  error estimate for blocks of size 2^( 2) =       0.000425740255
  error estimate for blocks of size 2^( 3) =       0.000441080486
  error estimate for blocks of size 2^( 4) =       0.000456847499
  error estimate for blocks of size 2^( 5) =       0.000474024707
  error estimate for blocks of size 2^( 6) =       0.000490817936
  error estimate for blocks of size 2^( 7) =       0.000503852954

      target function =                  N/A
              le_mean =     -16.915055485055
             les_mean =     286.457935211481
             stat err =       0.000481385774
             autocorr =       1.367824537588
              std dev =       0.582093908577
             le_variance =       0.338833318402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473455
                                         uncertainty =       0.004036669201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473455
                                         uncertainty =       0.004036669201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602550
  error estimate for blocks of size 2^( 2) =       0.000425740255
  error estimate for blocks of size 2^( 3) =       0.000441080486
  error estimate for blocks of size 2^( 4) =       0.000456847500
  error estimate for blocks of size 2^( 5) =       0.000474024707
  error estimate for blocks of size 2^( 6) =       0.000490817936
  error estimate for blocks of size 2^( 7) =       0.000503852954

      target function =                  N/A
              le_mean =     -16.915055485036
             les_mean =     286.457935211167
             stat err =       0.000481385774
             autocorr =       1.367824537253
              std dev =       0.582093908872
             le_variance =       0.338833318746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473283
                                         uncertainty =       0.004036669198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473283
                                         uncertainty =       0.004036669198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602550
  error estimate for blocks of size 2^( 2) =       0.000425740255
  error estimate for blocks of size 2^( 3) =       0.000441080486
  error estimate for blocks of size 2^( 4) =       0.000456847499
  error estimate for blocks of size 2^( 5) =       0.000474024707
  error estimate for blocks of size 2^( 6) =       0.000490817936
  error estimate for blocks of size 2^( 7) =       0.000503852954

      target function =                  N/A
              le_mean =     -16.915055485045
             les_mean =     286.457935211324
             stat err =       0.000481385774
             autocorr =       1.367824537426
              std dev =       0.582093908725
             le_variance =       0.338833318574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473132
                                         uncertainty =       0.004036669195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338393473132
                                         uncertainty =       0.004036669195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411602550
  error estimate for blocks of size 2^( 2) =       0.000425740255
  error estimate for blocks of size 2^( 3) =       0.000441080486
  error estimate for blocks of size 2^( 4) =       0.000456847499
  error estimate for blocks of size 2^( 5) =       0.000474024707
  error estimate for blocks of size 2^( 6) =       0.000490817936
  error estimate for blocks of size 2^( 7) =       0.000503852954

      target function =                  N/A
              le_mean =     -16.915055485054
             les_mean =     286.457935211461
             stat err =       0.000481385774
             autocorr =       1.367824537571
              std dev =       0.582093908595
             le_variance =       0.338833318424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915055485055        initial  <--
     1.4552e+05     1.4552e+06             1.9356e-09       -16.915055485036
     5.8208e+05     5.8208e+06             4.8391e-10       -16.915055485045
     2.3283e+06     2.3283e+07             1.2098e-10       -16.915055485054

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7535
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9438
    reference variance = 0.290868
====================================================
  Execution time = 2.0458e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331146485555
                                         uncertainty =       0.002636918760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331146485555
                                         uncertainty =       0.002636918760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406886883
  error estimate for blocks of size 2^( 2) =       0.000421304401
  error estimate for blocks of size 2^( 3) =       0.000437442449
  error estimate for blocks of size 2^( 4) =       0.000453967034
  error estimate for blocks of size 2^( 5) =       0.000470615175
  error estimate for blocks of size 2^( 6) =       0.000488484660
  error estimate for blocks of size 2^( 7) =       0.000500804157

      target function =                  N/A
              le_mean =     -16.915749032004
             les_mean =     286.473679019856
             stat err =       0.000478467756
             autocorr =       1.382795548901
              std dev =       0.575424948774
             le_variance =       0.331113871672


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691574903200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915749032004       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915749032005       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915749032005       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915749032183       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915749032271       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915749031345       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915749031992       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915749031452       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 2.068373e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915749032004       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915749032004       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915749032004       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915749032167       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915749030061       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915749028795       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915749032210       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915749029824       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 5.170947e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915749032004       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915749032004       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915749032004       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915749032004       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915749032004       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915749024761       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915749016367       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915749021977       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.292742e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6162e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9442
    reference variance = 0.35178
====================================================
  Execution time = 2.2266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6916e+01
  VMC Evar = 3.3715e-01
  Total weights = 2.0000e+06
  Execution time = 1.8775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869358
                                         uncertainty =       0.004764724845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869358
                                         uncertainty =       0.004764724845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410577657
  error estimate for blocks of size 2^( 2) =       0.000424437351
  error estimate for blocks of size 2^( 3) =       0.000439500094
  error estimate for blocks of size 2^( 4) =       0.000455831446
  error estimate for blocks of size 2^( 5) =       0.000472330575
  error estimate for blocks of size 2^( 6) =       0.000488340870
  error estimate for blocks of size 2^( 7) =       0.000497879373

      target function =                  N/A
              le_mean =     -16.916008017100
             les_mean =     286.488475091594
             stat err =       0.000478595566
             autocorr =       1.358772398306
              std dev =       0.580644491553
             le_variance =       0.337148025571

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869490
                                         uncertainty =       0.004764724846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869490
                                         uncertainty =       0.004764724846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410577658
  error estimate for blocks of size 2^( 2) =       0.000424437351
  error estimate for blocks of size 2^( 3) =       0.000439500094
  error estimate for blocks of size 2^( 4) =       0.000455831446
  error estimate for blocks of size 2^( 5) =       0.000472330575
  error estimate for blocks of size 2^( 6) =       0.000488340870
  error estimate for blocks of size 2^( 7) =       0.000497879373

      target function =                  N/A
              le_mean =     -16.916008017099
             les_mean =     286.488475091676
             stat err =       0.000478595566
             autocorr =       1.358772398110
              std dev =       0.580644491667
             le_variance =       0.337148025704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869424
                                         uncertainty =       0.004764724846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869424
                                         uncertainty =       0.004764724846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410577657
  error estimate for blocks of size 2^( 2) =       0.000424437351
  error estimate for blocks of size 2^( 3) =       0.000439500094
  error estimate for blocks of size 2^( 4) =       0.000455831446
  error estimate for blocks of size 2^( 5) =       0.000472330575
  error estimate for blocks of size 2^( 6) =       0.000488340870
  error estimate for blocks of size 2^( 7) =       0.000497879373

      target function =                  N/A
              le_mean =     -16.916008017099
             les_mean =     286.488475091635
             stat err =       0.000478595566
             autocorr =       1.358772398202
              std dev =       0.580644491610
             le_variance =       0.337148025638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869366
                                         uncertainty =       0.004764724845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337132869366
                                         uncertainty =       0.004764724845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410577657
  error estimate for blocks of size 2^( 2) =       0.000424437351
  error estimate for blocks of size 2^( 3) =       0.000439500094
  error estimate for blocks of size 2^( 4) =       0.000455831446
  error estimate for blocks of size 2^( 5) =       0.000472330575
  error estimate for blocks of size 2^( 6) =       0.000488340870
  error estimate for blocks of size 2^( 7) =       0.000497879373

      target function =                  N/A
              le_mean =     -16.916008017100
             les_mean =     286.488475091599
             stat err =       0.000478595566
             autocorr =       1.358772398287
              std dev =       0.580644491560
             le_variance =       0.337148025579


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.916008017100        initial  <--
     1.4552e+06     1.4552e+07             2.0684e-10       -16.916008017099
     5.8208e+06     5.8208e+07             5.1709e-11       -16.916008017099
     2.3283e+07     2.3283e+08             1.2927e-11       -16.916008017100

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7572
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7925e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9832
    reference variance = 0.334603
====================================================
  Execution time = 2.0205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.4416e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5774e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344236429371
                                         uncertainty =       0.008325190121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344236429371
                                         uncertainty =       0.008325190121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414827254
  error estimate for blocks of size 2^( 2) =       0.000428870486
  error estimate for blocks of size 2^( 3) =       0.000444519773
  error estimate for blocks of size 2^( 4) =       0.000460878813
  error estimate for blocks of size 2^( 5) =       0.000478758087
  error estimate for blocks of size 2^( 6) =       0.000493790512
  error estimate for blocks of size 2^( 7) =       0.000507882727

      target function =                  N/A
              le_mean =     -16.914475833209
             les_mean =     286.443655840912
             stat err =       0.000485327535
             autocorr =       1.368785197653
              std dev =       0.586654328196
             le_variance =       0.344163300791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691447583321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914475833209       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914475833209       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914475833209       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914475834190       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914475846840       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914475833390       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914475833545       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914475832118       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 2.507842e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914475833209       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914475833209       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914475833209       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914475828447       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914475795966       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914475831314       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914475818075       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914475752939       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 6.269403e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914475833209       residual = 5.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914475833209       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914475833209       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914475833209       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914475818404       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914475841563       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914475812293       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914475692109       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.567356e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5789e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.7974
    reference variance = 0.617742
====================================================
  Execution time = 2.0362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3655e-01
  Total weights = 2.0000e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797399
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797399
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410215064
  error estimate for blocks of size 2^( 2) =       0.000424777249
  error estimate for blocks of size 2^( 3) =       0.000440321595
  error estimate for blocks of size 2^( 4) =       0.000457585366
  error estimate for blocks of size 2^( 5) =       0.000475865245
  error estimate for blocks of size 2^( 6) =       0.000493972837
  error estimate for blocks of size 2^( 7) =       0.000507000127

      target function =                  N/A
              le_mean =     -16.915311658545
             les_mean =     286.464321135659
             stat err =       0.000483605894
             autocorr =       1.389824488267
              std dev =       0.580131707644
             le_variance =       0.336552798214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797409
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797409
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410215064
  error estimate for blocks of size 2^( 2) =       0.000424777249
  error estimate for blocks of size 2^( 3) =       0.000440321595
  error estimate for blocks of size 2^( 4) =       0.000457585366
  error estimate for blocks of size 2^( 5) =       0.000475865245
  error estimate for blocks of size 2^( 6) =       0.000493972837
  error estimate for blocks of size 2^( 7) =       0.000507000127

      target function =                  N/A
              le_mean =     -16.915311658545
             les_mean =     286.464321135664
             stat err =       0.000483605894
             autocorr =       1.389824488247
              std dev =       0.580131707653
             le_variance =       0.336552798224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797404
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797404
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410215064
  error estimate for blocks of size 2^( 2) =       0.000424777249
  error estimate for blocks of size 2^( 3) =       0.000440321595
  error estimate for blocks of size 2^( 4) =       0.000457585366
  error estimate for blocks of size 2^( 5) =       0.000475865245
  error estimate for blocks of size 2^( 6) =       0.000493972837
  error estimate for blocks of size 2^( 7) =       0.000507000127

      target function =                  N/A
              le_mean =     -16.915311658545
             les_mean =     286.464321135661
             stat err =       0.000483605894
             autocorr =       1.389824488257
              std dev =       0.580131707649
             le_variance =       0.336552798219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797400
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336502797400
                                         uncertainty =       0.003214633338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410215064
  error estimate for blocks of size 2^( 2) =       0.000424777249
  error estimate for blocks of size 2^( 3) =       0.000440321595
  error estimate for blocks of size 2^( 4) =       0.000457585366
  error estimate for blocks of size 2^( 5) =       0.000475865245
  error estimate for blocks of size 2^( 6) =       0.000493972837
  error estimate for blocks of size 2^( 7) =       0.000507000127

      target function =                  N/A
              le_mean =     -16.915311658545
             les_mean =     286.464321135660
             stat err =       0.000483605894
             autocorr =       1.389824488262
              std dev =       0.580131707645
             le_variance =       0.336552798215


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915311658545        initial  <--
     1.4552e+07     1.4552e+08             2.5078e-11       -16.915311658545
     5.8208e+07     5.8208e+08             6.2694e-12       -16.915311658545
     2.3283e+08     2.3283e+09             1.5674e-12       -16.915311658545

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8558
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8457
    reference variance = 0.389696
====================================================
  Execution time = 2.0568e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3130e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330955435300
                                         uncertainty =       0.002286996867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330955435300
                                         uncertainty =       0.002286996867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407003672
  error estimate for blocks of size 2^( 2) =       0.000421381598
  error estimate for blocks of size 2^( 3) =       0.000437113116
  error estimate for blocks of size 2^( 4) =       0.000453584107
  error estimate for blocks of size 2^( 5) =       0.000471361911
  error estimate for blocks of size 2^( 6) =       0.000487488996
  error estimate for blocks of size 2^( 7) =       0.000502216110

      target function =                  N/A
              le_mean =     -16.915147739242
             les_mean =     286.453526853082
             stat err =       0.000478662781
             autocorr =       1.383128924761
              std dev =       0.575590113144
             le_variance =       0.331303978349


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691514773924e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915147739242       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915147739242       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915147739242       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915147765378       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915147693624       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915147795759       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915147759141       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915147704611       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 2.011410e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915147739242       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915147739242       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915147739242       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915147739242       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915147997595       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915147817176       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915147906435       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915147804540       residual = 3.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 5.029934e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915147739242       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915147739242       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915147739242       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915147739242       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915147787817       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915153537292       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915147192775       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915147821521       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.259746e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105319 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6133e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8711
    reference variance = 0.186078
====================================================
  Execution time = 2.0384e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4302e-01
  Total weights = 2.0000e+06
  Execution time = 1.8847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414137204
  error estimate for blocks of size 2^( 2) =       0.000427793105
  error estimate for blocks of size 2^( 3) =       0.000443540983
  error estimate for blocks of size 2^( 4) =       0.000459452484
  error estimate for blocks of size 2^( 5) =       0.000477034443
  error estimate for blocks of size 2^( 6) =       0.000495183745
  error estimate for blocks of size 2^( 7) =       0.000510603947

      target function =                  N/A
              le_mean =     -16.914975241875
             les_mean =     286.459406509163
             stat err =       0.000485568655
             autocorr =       1.374715384719
              std dev =       0.585678450548
             le_variance =       0.343019247436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414137204
  error estimate for blocks of size 2^( 2) =       0.000427793105
  error estimate for blocks of size 2^( 3) =       0.000443540983
  error estimate for blocks of size 2^( 4) =       0.000459452484
  error estimate for blocks of size 2^( 5) =       0.000477034443
  error estimate for blocks of size 2^( 6) =       0.000495183745
  error estimate for blocks of size 2^( 7) =       0.000510603947

      target function =                  N/A
              le_mean =     -16.914975241875
             les_mean =     286.459406509164
             stat err =       0.000485568655
             autocorr =       1.374715384711
              std dev =       0.585678450548
             le_variance =       0.343019247437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414137204
  error estimate for blocks of size 2^( 2) =       0.000427793105
  error estimate for blocks of size 2^( 3) =       0.000443540983
  error estimate for blocks of size 2^( 4) =       0.000459452484
  error estimate for blocks of size 2^( 5) =       0.000477034443
  error estimate for blocks of size 2^( 6) =       0.000495183745
  error estimate for blocks of size 2^( 7) =       0.000510603947

      target function =                  N/A
              le_mean =     -16.914975241875
             les_mean =     286.459406509164
             stat err =       0.000485568655
             autocorr =       1.374715384705
              std dev =       0.585678450548
             le_variance =       0.343019247437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343114406154
                                         uncertainty =       0.005316638386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414137204
  error estimate for blocks of size 2^( 2) =       0.000427793105
  error estimate for blocks of size 2^( 3) =       0.000443540983
  error estimate for blocks of size 2^( 4) =       0.000459452484
  error estimate for blocks of size 2^( 5) =       0.000477034443
  error estimate for blocks of size 2^( 6) =       0.000495183745
  error estimate for blocks of size 2^( 7) =       0.000510603947

      target function =                  N/A
              le_mean =     -16.914975241875
             les_mean =     286.459406509163
             stat err =       0.000485568655
             autocorr =       1.374715384721
              std dev =       0.585678450548
             le_variance =       0.343019247436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914975241875        initial  <--
     1.4552e+08     1.4552e+09             2.0114e-12       -16.914975241875
     5.8208e+08     5.8208e+09             5.0299e-13       -16.914975241875
     2.3283e+09     2.3283e+10             1.2597e-13       -16.914975241875

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8662
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6005e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8592
    reference variance = 0.386359
====================================================
  Execution time = 2.0539e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346071485734
                                         uncertainty =       0.007471982474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346071485734
                                         uncertainty =       0.007471982474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415972616
  error estimate for blocks of size 2^( 2) =       0.000429598610
  error estimate for blocks of size 2^( 3) =       0.000445006093
  error estimate for blocks of size 2^( 4) =       0.000461635528
  error estimate for blocks of size 2^( 5) =       0.000478198715
  error estimate for blocks of size 2^( 6) =       0.000494660850
  error estimate for blocks of size 2^( 7) =       0.000505206757

      target function =                  N/A
              le_mean =     -16.915138696517
             les_mean =     286.467983384168
             stat err =       0.000484925462
             autocorr =       1.359003245474
              std dev =       0.588274115356
             le_variance =       0.346066434798


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691513869652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915138696517       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915138696517       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915138696517       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915138696517       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915138044450       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915138486813       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915139113023       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915138680235       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 1.706191e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915138696517       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915138696517       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915138696517       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915138094943       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915135427500       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915139039228       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915138099869       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915141042898       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 4.253584e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.915138696517       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.915138696517       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.915138696517       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.915138696517       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.915138696517       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.915153314658       residual = 9.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.915134872915       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915159325944       residual = 9.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.915139164889       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.915168934806       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.915308453620       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.915300868046       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.915116517371       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.915182575886       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.914876773586       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.915273048374       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.915292507413       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.914394051184       residual = 8.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.915004530772       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.916098577402       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.915344672702       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.915464352674       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.915592610098       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914992791855       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.915911788993       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914474270927       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.913419984627       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.913465444696       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.915391747778       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.914459364703       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.912466026381       residual = 8.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.913760711038       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.918619858636       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.916737178631       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.916400777176       residual = 3.66e-04           smallest_sin_value = 9.96e-01
davidson iteration   35 stopping due to small subspace S singular value of 9.62e-01
davidson solver did not converge after         35 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.017207e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.127828 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6096e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.848
    reference variance = 0.319792
====================================================
  Execution time = 1.9992e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.4377e-01
  Total weights = 2.0000e+06
  Execution time = 1.8806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589793
  error estimate for blocks of size 2^( 2) =       0.000428188631
  error estimate for blocks of size 2^( 3) =       0.000443480157
  error estimate for blocks of size 2^( 4) =       0.000459598568
  error estimate for blocks of size 2^( 5) =       0.000477022449
  error estimate for blocks of size 2^( 6) =       0.000492450151
  error estimate for blocks of size 2^( 7) =       0.000503836563

      target function =                  N/A
              le_mean =     -16.914428569565
             les_mean =     286.441663055259
             stat err =       0.000483226933
             autocorr =       1.358516922486
              std dev =       0.586318507499
             le_variance =       0.343769392235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589793
  error estimate for blocks of size 2^( 2) =       0.000428188631
  error estimate for blocks of size 2^( 3) =       0.000443480157
  error estimate for blocks of size 2^( 4) =       0.000459598568
  error estimate for blocks of size 2^( 5) =       0.000477022449
  error estimate for blocks of size 2^( 6) =       0.000492450151
  error estimate for blocks of size 2^( 7) =       0.000503836563

      target function =                  N/A
              le_mean =     -16.914428569565
             les_mean =     286.441663055259
             stat err =       0.000483226933
             autocorr =       1.358516922489
              std dev =       0.586318507499
             le_variance =       0.343769392235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589793
  error estimate for blocks of size 2^( 2) =       0.000428188631
  error estimate for blocks of size 2^( 3) =       0.000443480157
  error estimate for blocks of size 2^( 4) =       0.000459598568
  error estimate for blocks of size 2^( 5) =       0.000477022449
  error estimate for blocks of size 2^( 6) =       0.000492450151
  error estimate for blocks of size 2^( 7) =       0.000503836563

      target function =                  N/A
              le_mean =     -16.914428569565
             les_mean =     286.441663055259
             stat err =       0.000483226933
             autocorr =       1.358516922490
              std dev =       0.586318507499
             le_variance =       0.343769392235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343805480880
                                         uncertainty =       0.006753330111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414589793
  error estimate for blocks of size 2^( 2) =       0.000428188631
  error estimate for blocks of size 2^( 3) =       0.000443480157
  error estimate for blocks of size 2^( 4) =       0.000459598568
  error estimate for blocks of size 2^( 5) =       0.000477022449
  error estimate for blocks of size 2^( 6) =       0.000492450151
  error estimate for blocks of size 2^( 7) =       0.000503836563

      target function =                  N/A
              le_mean =     -16.914428569565
             les_mean =     286.441663055259
             stat err =       0.000483226933
             autocorr =       1.358516922486
              std dev =       0.586318507499
             le_variance =       0.343769392235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.914428569565        initial  <--
     1.4552e+09     1.4552e+10             1.7062e-13       -16.914428569565
     5.8208e+09     5.8208e+10             4.2536e-14       -16.914428569565
     2.3283e+10     2.3283e+11             1.0172e-14       -16.914428569565

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5058
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5608e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.7741
    reference variance = 0.758589
====================================================
  Execution time = 2.0353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.3813e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338238416383
                                         uncertainty =       0.003998873757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338238416383
                                         uncertainty =       0.003998873757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411177758
  error estimate for blocks of size 2^( 2) =       0.000425618712
  error estimate for blocks of size 2^( 3) =       0.000442022149
  error estimate for blocks of size 2^( 4) =       0.000459837638
  error estimate for blocks of size 2^( 5) =       0.000479036182
  error estimate for blocks of size 2^( 6) =       0.000498709266
  error estimate for blocks of size 2^( 7) =       0.000513756622

      target function =                  N/A
              le_mean =     -16.914004584020
             les_mean =     286.421685196463
             stat err =       0.000487834927
             autocorr =       1.407623644107
              std dev =       0.581493161861
             le_variance =       0.338134297291


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691400458402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+10, overlap shift 1.4552e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914004584020       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914004584020       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914004584020       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914004584020       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914006669298       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.914003841037       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.913998492574       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914004351701       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+10 is 1.770032e-14

solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914004584020       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914004584020       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914004584020       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914004584020       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.914004578027       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913997716936       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914008673565       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.913996280484       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.914157544179       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.914119489447       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.914015739571       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.914202482614       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.913967110002       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.913489718936       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.914358585339       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910619820013       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.913256429695       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.914162564596       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.914720335409       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910875251156       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.910151256220       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.918793796652       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.917715537039       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.917120535303       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.924557220436       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.917173981656       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.921738308071       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.921400193864       residual = 7.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.914173691591       residual = 6.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.913401231615       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.911994289594       residual = 7.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.916949412111       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.914314979602       residual = 3.58e-05           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.906030109083       residual = 8.07e-03           smallest_sin_value = 9.94e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.76e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+10 is 4.302210e-15

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.914004584020       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.914004584020       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.914004584020       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.914004584020       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.913927140737       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913934612069       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914063061917       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.914615392313       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.914184061503       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.914456641169       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.914676907324       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.913892137606       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.914298822959       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.913761248180       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911391788576       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.918025911748       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.919898372908       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.903048341980       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.912148706042       residual = 4.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.929764314550       residual = 3.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.893070744575       residual = 5.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.881239338510       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.932815336698       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.878560017894       residual = 1.72e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.886053517294       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.925650934016       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.933993368755       residual = 5.36e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.901847436876       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.918969430774       residual = 3.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.885783347719       residual = 1.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.890774316792       residual = 7.25e-02           smallest_sin_value = 9.98e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.70e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+11 is 9.683442e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158244 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5891e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.7792
    reference variance = 0.658421
====================================================
  Execution time = 2.0202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.3636e-01
  Total weights = 2.0000e+06
  Execution time = 1.8821e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410096819
  error estimate for blocks of size 2^( 2) =       0.000424333866
  error estimate for blocks of size 2^( 3) =       0.000439565704
  error estimate for blocks of size 2^( 4) =       0.000456489843
  error estimate for blocks of size 2^( 5) =       0.000472255178
  error estimate for blocks of size 2^( 6) =       0.000488241877
  error estimate for blocks of size 2^( 7) =       0.000500501806

      target function =                  N/A
              le_mean =     -16.915060828583
             les_mean =     286.455641468542
             stat err =       0.000479372176
             autocorr =       1.366384239639
              std dev =       0.579964483449
             le_variance =       0.336358802063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410096819
  error estimate for blocks of size 2^( 2) =       0.000424333866
  error estimate for blocks of size 2^( 3) =       0.000439565704
  error estimate for blocks of size 2^( 4) =       0.000456489843
  error estimate for blocks of size 2^( 5) =       0.000472255178
  error estimate for blocks of size 2^( 6) =       0.000488241877
  error estimate for blocks of size 2^( 7) =       0.000500501806

      target function =                  N/A
              le_mean =     -16.915060828583
             les_mean =     286.455641468542
             stat err =       0.000479372176
             autocorr =       1.366384239641
              std dev =       0.579964483449
             le_variance =       0.336358802063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410096819
  error estimate for blocks of size 2^( 2) =       0.000424333866
  error estimate for blocks of size 2^( 3) =       0.000439565704
  error estimate for blocks of size 2^( 4) =       0.000456489843
  error estimate for blocks of size 2^( 5) =       0.000472255178
  error estimate for blocks of size 2^( 6) =       0.000488241877
  error estimate for blocks of size 2^( 7) =       0.000500501806

      target function =                  N/A
              le_mean =     -16.915060828583
             les_mean =     286.455641468542
             stat err =       0.000479372176
             autocorr =       1.366384239640
              std dev =       0.579964483449
             le_variance =       0.336358802063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336413525591
                                         uncertainty =       0.003630327390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410096819
  error estimate for blocks of size 2^( 2) =       0.000424333866
  error estimate for blocks of size 2^( 3) =       0.000439565704
  error estimate for blocks of size 2^( 4) =       0.000456489843
  error estimate for blocks of size 2^( 5) =       0.000472255178
  error estimate for blocks of size 2^( 6) =       0.000488241877
  error estimate for blocks of size 2^( 7) =       0.000500501806

      target function =                  N/A
              le_mean =     -16.915060828583
             les_mean =     286.455641468542
             stat err =       0.000479372176
             autocorr =       1.366384239640
              std dev =       0.579964483449
             le_variance =       0.336358802063


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915060828583        initial
     1.4552e+10     1.4552e+11             1.7700e-14       -16.915060828583
     5.8208e+10     5.8208e+11             4.3022e-15       -16.915060828583
     2.3283e+11     2.3283e+12             9.6834e-16       -16.915060828583  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+11     and shift_s =   2.3283e+12
*****************************************************************************

  Execution time = 2.9692e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9905
    reference variance = 0.38545
====================================================
  Execution time = 2.0530e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6914e+01
  VMC Evar = 3.4091e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5648e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341020297260
                                         uncertainty =       0.003858861207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341020297260
                                         uncertainty =       0.003858861207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412864001
  error estimate for blocks of size 2^( 2) =       0.000427525293
  error estimate for blocks of size 2^( 3) =       0.000443446112
  error estimate for blocks of size 2^( 4) =       0.000460403333
  error estimate for blocks of size 2^( 5) =       0.000477535983
  error estimate for blocks of size 2^( 6) =       0.000493708866
  error estimate for blocks of size 2^( 7) =       0.000504578251

      target function =                  N/A
              le_mean =     -16.913905960657
             les_mean =     286.421128041824
             stat err =       0.000484056608
             autocorr =       1.374606119903
              std dev =       0.583877869362
             le_variance =       0.340913366331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691390596066e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.913905960657       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.913905960657       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.913905960657       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.913860907953       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.913933616736       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913898196531       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.913910520836       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.913905552872       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.913931048817       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.913616577966       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.913919522679       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.914038733873       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.914310701649       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.914533809737       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.913066370893       residual = 8.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.912828414576       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.913647744385       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.913846108723       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.914266332119       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.913621240005       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.913735299571       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910338682574       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.915952006050       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.913384598279       residual = 4.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.918200338681       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.914550147620       residual = 5.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.917098532235       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.910943065064       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.915069262439       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910593880972       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.910460175364       residual = 1.62e-03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.915236174001       residual = 4.37e-04           smallest_sin_value = 9.98e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+10 is 5.561489e-15

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.913905960657       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.913905960657       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.913905960657       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.913905960657       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.913842183010       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913935665335       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914126831810       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.913846955741       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.913161256679       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.912613679393       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.913535811752       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.916799649266       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.908723062167       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.917032970119       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907216315989       residual = 5.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905595377864       residual = 9.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.923818845861       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910998046422       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.925236463723       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909540102334       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.912051703518       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.908847375234       residual = 3.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.919262048301       residual = 3.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.937038696719       residual = 6.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905253020684       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.902713130895       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.927742660533       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.889066285190       residual = 7.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.904761229549       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.891525057435       residual = 6.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.935701867898       residual = 6.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.887851921477       residual = 8.50e-02           smallest_sin_value = 9.99e-01
davidson iteration   32:   krylov dim =  33   energy =     -16.942539086157       residual = 9.79e-02           smallest_sin_value = 9.93e-01
davidson iteration   33 stopping due to small subspace S singular value of 9.39e-01
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+11 is 1.193953e-15

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.913905960657       residual = 5.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.913905960657       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.913905960657       residual = 5.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.913905960657       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.913855252652       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.913761087317       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.914305589752       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.915026799799       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910584453696       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910332254824       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.915986864520       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909156262243       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.926020632478       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.916712215960       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.927126552846       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907667625595       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.913422718205       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.894222010738       residual = 4.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.909636033027       residual = 2.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.898361676157       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.928737801135       residual = 3.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.864989192872       residual = 3.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.918736593071       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.960543274264       residual = 3.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.960865976029       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.137639749428       residual = 6.25e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.966760062789       residual = 3.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.876789345326       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.867522521589       residual = 2.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.946459799371       residual = 1.77e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.959595922486       residual = 2.62e-01           smallest_sin_value = 9.95e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.53e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+11 is 2.301573e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6155e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9473
    reference variance = 0.233012
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6915e+01
  VMC Evar = 3.4030e-01
  Total weights = 2.0000e+06
  Execution time = 2.2003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412491725
  error estimate for blocks of size 2^( 2) =       0.000426228194
  error estimate for blocks of size 2^( 3) =       0.000442162829
  error estimate for blocks of size 2^( 4) =       0.000457401259
  error estimate for blocks of size 2^( 5) =       0.000474395706
  error estimate for blocks of size 2^( 6) =       0.000490480225
  error estimate for blocks of size 2^( 7) =       0.000503158009

      target function =                  N/A
              le_mean =     -16.915465905198
             les_mean =     286.473285466126
             stat err =       0.000481358800
             autocorr =       1.361781249785
              std dev =       0.583351391830
             le_variance =       0.340298846350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412491725
  error estimate for blocks of size 2^( 2) =       0.000426228194
  error estimate for blocks of size 2^( 3) =       0.000442162829
  error estimate for blocks of size 2^( 4) =       0.000457401259
  error estimate for blocks of size 2^( 5) =       0.000474395706
  error estimate for blocks of size 2^( 6) =       0.000490480225
  error estimate for blocks of size 2^( 7) =       0.000503158009

      target function =                  N/A
              le_mean =     -16.915465905198
             les_mean =     286.473285466126
             stat err =       0.000481358800
             autocorr =       1.361781249781
              std dev =       0.583351391830
             le_variance =       0.340298846350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412491725
  error estimate for blocks of size 2^( 2) =       0.000426228194
  error estimate for blocks of size 2^( 3) =       0.000442162829
  error estimate for blocks of size 2^( 4) =       0.000457401259
  error estimate for blocks of size 2^( 5) =       0.000474395706
  error estimate for blocks of size 2^( 6) =       0.000490480225
  error estimate for blocks of size 2^( 7) =       0.000503158009

      target function =                  N/A
              le_mean =     -16.915465905198
             les_mean =     286.473285466126
             stat err =       0.000481358800
             autocorr =       1.361781249785
              std dev =       0.583351391830
             le_variance =       0.340298846350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340316906815
                                         uncertainty =       0.004307870976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412491725
  error estimate for blocks of size 2^( 2) =       0.000426228194
  error estimate for blocks of size 2^( 3) =       0.000442162829
  error estimate for blocks of size 2^( 4) =       0.000457401259
  error estimate for blocks of size 2^( 5) =       0.000474395706
  error estimate for blocks of size 2^( 6) =       0.000490480225
  error estimate for blocks of size 2^( 7) =       0.000503158009

      target function =                  N/A
              le_mean =     -16.915465905198
             les_mean =     286.473285466126
             stat err =       0.000481358800
             autocorr =       1.361781249786
              std dev =       0.583351391830
             le_variance =       0.340298846350


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.915465905198        initial
     5.8208e+10     5.8208e+11             5.5615e-15       -16.915465905198
     2.3283e+11     2.3283e+12             1.1940e-15       -16.915465905198
     9.3132e+11     9.3132e+12             2.3016e-16       -16.915465905198  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+11     and shift_s =   9.3132e+12
*****************************************************************************

  Execution time = 3.1307e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.081593e-01 1 1  ON 0
 uu_1                 1.417770e-01 1 1  ON 1
 uu_2                 4.117922e-02 1 1  ON 2
 uu_3                -2.025945e-02 1 1  ON 3
 uu_4                -6.380345e-02 1 1  ON 4
 uu_5                -9.657960e-02 1 1  ON 5
 uu_6                -1.231284e-01 1 1  ON 6
 uu_7                -1.364423e-01 1 1  ON 7
 uu_8                -1.290703e-01 1 1  ON 8
 uu_9                -9.978128e-02 1 1  ON 9
 ud_0                 4.434508e-01 1 1  ON 10
 ud_1                 1.774977e-01 1 1  ON 11
 ud_2                 5.732892e-02 1 1  ON 12
 ud_3                -1.305458e-02 1 1  ON 13
 ud_4                -6.887302e-02 1 1  ON 14
 ud_5                -1.077707e-01 1 1  ON 15
 ud_6                -1.325765e-01 1 1  ON 16
 ud_7                -1.467603e-01 1 1  ON 17
 ud_8                -1.454807e-01 1 1  ON 18
 ud_9                -1.351190e-01 1 1  ON 19
 eO_0                -7.647164e-01 1 1  ON 20
 eO_1                -4.429565e-01 1 1  ON 21
 eO_2                -2.112241e-02 1 1  ON 22
 eO_3                 3.007376e-01 1 1  ON 23
 eO_4                 5.262861e-01 1 1  ON 24
 eO_5                 4.823718e-01 1 1  ON 25
 eO_6                 2.507928e-01 1 1  ON 26
 eO_7                -4.899585e-02 1 1  ON 27
 eO_8                -2.108295e-01 1 1  ON 28
 eO_9                -7.177883e-02 1 1  ON 29
eH1_0                -2.368153e-01 1 1  ON 30
eH1_1                -1.377198e-01 1 1  ON 31
eH1_2                -9.204017e-02 1 1  ON 32
eH1_3                -3.799938e-02 1 1  ON 33
eH1_4                 7.290196e-03 1 1  ON 34
eH1_5                 4.117144e-02 1 1  ON 35
eH1_6                 9.663575e-02 1 1  ON 36
eH1_7                 1.470849e-01 1 1  ON 37
eH1_8                 1.643005e-01 1 1  ON 38
eH1_9                 5.149161e-02 1 1  ON 39
eH2_0                -2.336030e-01 1 1  ON 40
eH2_1                -1.347563e-01 1 1  ON 41
eH2_2                -8.893503e-02 1 1  ON 42
eH2_3                -3.493056e-02 1 1  ON 43
eH2_4                 1.109303e-02 1 1  ON 44
eH2_5                 4.339708e-02 1 1  ON 45
eH2_6                 9.948451e-02 1 1  ON 46
eH2_7                 1.513527e-01 1 1  ON 47
eH2_8                 1.697964e-01 1 1  ON 48
eH2_9                 3.488969e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7468e+01 secs
  Total Execution time = 2.2622e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
