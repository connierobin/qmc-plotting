Rank =    0  Free Memory = 87814 MB
Rank =    1  Free Memory = 87814 MB
Rank =    2  Free Memory = 87814 MB
Rank =    3  Free Memory = 87814 MB
Rank =    4  Free Memory = 87814 MB
Rank =    5  Free Memory = 87813 MB
Rank =    6  Free Memory = 87813 MB
Rank =    7  Free Memory = 87813 MB
Rank =    8  Free Memory = 87813 MB
Rank =    9  Free Memory = 87813 MB
Rank =   10  Free Memory = 87812 MB
Rank =   11  Free Memory = 87812 MB
Rank =   12  Free Memory = 87812 MB
Rank =   13  Free Memory = 87812 MB
Rank =   14  Free Memory = 87812 MB
Rank =   15  Free Memory = 87797 MB
Rank =   16  Free Memory = 87797 MB
Rank =   17  Free Memory = 87797 MB
Rank =   18  Free Memory = 87797 MB
Rank =   19  Free Memory = 87797 MB
Rank =   20  Free Memory = 87797 MB
Rank =   21  Free Memory = 87797 MB
Rank =   22  Free Memory = 87797 MB
Rank =   23  Free Memory = 87797 MB
Rank =   24  Free Memory = 87797 MB
Rank =   25  Free Memory = 87797 MB
Rank =   26  Free Memory = 87797 MB
Rank =   27  Free Memory = 87797 MB
Rank =   28  Free Memory = 87797 MB
Rank =   29  Free Memory = 87797 MB
Rank =   30  Free Memory = 87797 MB
Rank =   31  Free Memory = 87797 MB
Rank =   32  Free Memory = 89942 MB
Rank =   33  Free Memory = 89942 MB
Rank =   34  Free Memory = 89942 MB
Rank =   35  Free Memory = 89942 MB
Rank =   36  Free Memory = 89942 MB
Rank =   37  Free Memory = 89942 MB
Rank =   38  Free Memory = 89942 MB
Rank =   39  Free Memory = 89942 MB
Rank =   40  Free Memory = 89942 MB
Rank =   41  Free Memory = 89942 MB
Rank =   42  Free Memory = 89942 MB
Rank =   43  Free Memory = 89942 MB
Rank =   44  Free Memory = 89942 MB
Rank =   45  Free Memory = 89942 MB
Rank =   46  Free Memory = 89942 MB
Rank =   47  Free Memory = 89942 MB
Rank =   48  Free Memory = 89942 MB
Rank =   49  Free Memory = 89942 MB
Rank =   50  Free Memory = 89942 MB
Rank =   51  Free Memory = 89942 MB
Rank =   52  Free Memory = 89942 MB
Rank =   53  Free Memory = 89942 MB
Rank =   54  Free Memory = 89942 MB
Rank =   55  Free Memory = 89942 MB
Rank =   56  Free Memory = 89942 MB
Rank =   57  Free Memory = 89942 MB
Rank =   58  Free Memory = 89942 MB
Rank =   59  Free Memory = 89942 MB
Rank =   60  Free Memory = 89942 MB
Rank =   61  Free Memory = 89942 MB
Rank =   62  Free Memory = 89942 MB
Rank =   63  Free Memory = 89942 MB
Rank =   64  Free Memory = 86498 MB
Rank =   65  Free Memory = 86498 MB
Rank =   66  Free Memory = 86498 MB
Rank =   67  Free Memory = 86498 MB
Rank =   68  Free Memory = 86498 MB
Rank =   69  Free Memory = 86498 MB
Rank =   70  Free Memory = 86498 MB
Rank =   71  Free Memory = 86498 MB
Rank =   72  Free Memory = 86498 MB
Rank =   73  Free Memory = 86498 MB
Rank =   74  Free Memory = 86498 MB
Rank =   75  Free Memory = 86498 MB
Rank =   76  Free Memory = 86498 MB
Rank =   77  Free Memory = 86498 MB
Rank =   78  Free Memory = 86498 MB
Rank =   79  Free Memory = 86498 MB
Rank =   80  Free Memory = 86498 MB
Rank =   81  Free Memory = 86498 MB
Rank =   82  Free Memory = 86498 MB
Rank =   83  Free Memory = 86498 MB
Rank =   84  Free Memory = 86498 MB
Rank =   85  Free Memory = 86498 MB
Rank =   86  Free Memory = 86498 MB
Rank =   87  Free Memory = 86498 MB
Rank =   88  Free Memory = 86498 MB
Rank =   89  Free Memory = 86498 MB
Rank =   90  Free Memory = 86498 MB
Rank =   91  Free Memory = 86498 MB
Rank =   92  Free Memory = 86498 MB
Rank =   93  Free Memory = 86498 MB
Rank =   94  Free Memory = 86498 MB
Rank =   95  Free Memory = 86498 MB
Rank =   96  Free Memory = 87950 MB
Rank =   97  Free Memory = 87950 MB
Rank =   98  Free Memory = 87950 MB
Rank =   99  Free Memory = 87950 MB
Rank =  100  Free Memory = 87950 MB
Rank =  101  Free Memory = 87950 MB
Rank =  102  Free Memory = 87950 MB
Rank =  103  Free Memory = 87950 MB
Rank =  104  Free Memory = 87950 MB
Rank =  105  Free Memory = 87950 MB
Rank =  106  Free Memory = 87950 MB
Rank =  107  Free Memory = 87950 MB
Rank =  108  Free Memory = 87950 MB
Rank =  109  Free Memory = 87950 MB
Rank =  110  Free Memory = 87950 MB
Rank =  111  Free Memory = 87950 MB
Rank =  112  Free Memory = 87950 MB
Rank =  113  Free Memory = 87950 MB
Rank =  114  Free Memory = 87950 MB
Rank =  115  Free Memory = 87950 MB
Rank =  116  Free Memory = 87950 MB
Rank =  117  Free Memory = 87950 MB
Rank =  118  Free Memory = 87950 MB
Rank =  119  Free Memory = 87950 MB
Rank =  120  Free Memory = 87950 MB
Rank =  121  Free Memory = 87950 MB
Rank =  122  Free Memory = 87950 MB
Rank =  123  Free Memory = 87950 MB
Rank =  124  Free Memory = 87950 MB
Rank =  125  Free Memory = 87950 MB
Rank =  126  Free Memory = 87950 MB
Rank =  127  Free Memory = 87950 MB
  Input file(s): opt_h2o_gs_gvpabs_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvpabs_run001d.xml

  Project = H2O
  date    = 2023-03-24 19:11:30 PDT
  host    = n0016.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 82

  Range of prime numbers to use as seeds over processors and threads = 433-1301


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.081671e-01    1         1  ON     0
     uu_1                 4.726853e-02    1         1  ON     1
     uu_2                -4.526983e-02    1         1  ON     2
     uu_3                -9.891511e-02    1         1  ON     3
     uu_4                -1.319824e-01    1         1  ON     4
     uu_5                -1.385305e-01    1         1  ON     5
     uu_6                -1.149988e-01    1         1  ON     6
     uu_7                -4.128233e-02    1         1  ON     7
     uu_8                 9.853585e-02    1         1  ON     8
     uu_9                 1.226851e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.458595e-01    1         1  ON     0
     ud_1                 9.101180e-02    1         1  ON     1
     ud_2                -1.328652e-02    1         1  ON     2
     ud_3                -7.124742e-02    1         1  ON     3
     ud_4                -1.194124e-01    1         1  ON     4
     ud_5                -1.532908e-01    1         1  ON     5
     ud_6                -1.565760e-01    1         1  ON     6
     ud_7                -1.115047e-01    1         1  ON     7
     ud_8                 2.024027e-03    1         1  ON     8
     ud_9                 9.254221e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.541822e-01    1         1  ON     0
     eO_1                -4.421407e-01    1         1  ON     1
     eO_2                -4.679248e-02    1         1  ON     2
     eO_3                 2.024218e-01    1         1  ON     3
     eO_4                 2.975349e-01    1         1  ON     4
     eO_5                 3.144492e-01    1         1  ON     5
     eO_6                 2.543406e-01    1         1  ON     6
     eO_7                 1.164821e-01    1         1  ON     7
     eO_8                 2.861513e-02    1         1  ON     8
     eO_9                 1.857033e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.814956e-01    1         1  ON     0
     eH1_1                -1.030464e-01    1         1  ON     1
     eH1_2                -6.277820e-02    1         1  ON     2
     eH1_3                -2.663418e-02    1         1  ON     3
     eH1_4                 1.879850e-02    1         1  ON     4
     eH1_5                 3.320537e-02    1         1  ON     5
     eH1_6                 7.824348e-02    1         1  ON     6
     eH1_7                 1.100692e-01    1         1  ON     7
     eH1_8                 9.309657e-02    1         1  ON     8
     eH1_9                 2.506717e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.835822e-01    1         1  ON     0
     eH2_1                -1.045920e-01    1         1  ON     1
     eH2_2                -6.432943e-02    1         1  ON     2
     eH2_3                -2.816145e-02    1         1  ON     3
     eH2_4                 1.757844e-02    1         1  ON     4
     eH2_5                 3.290948e-02    1         1  ON     5
     eH2_6                 8.016997e-02    1         1  ON     6
     eH2_7                 1.144737e-01    1         1  ON     7
     eH2_8                 9.596918e-02    1         1  ON     8
     eH2_9                 2.718379e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.707403e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.5874e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2021
    reference variance = 0.234223
====================================================
  Execution time = 2.0071e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1065e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310706384285
                                         uncertainty =       0.002879141809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310706384285
                                         uncertainty =       0.002879141809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394110008
  error estimate for blocks of size 2^( 2) =       0.000404203301
  error estimate for blocks of size 2^( 3) =       0.000413038013
  error estimate for blocks of size 2^( 4) =       0.000419571974
  error estimate for blocks of size 2^( 5) =       0.000424969430
  error estimate for blocks of size 2^( 6) =       0.000427881697
  error estimate for blocks of size 2^( 7) =       0.000431421807

      target function =                  N/A
              le_mean =     -17.216782397715
             les_mean =     296.728241371500
             stat err =       0.000425961227
             autocorr =       1.168167748969
              std dev =       0.557355718161
             le_variance =       0.310645396567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721678239771e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782397715       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216786775029       residual = 7.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216790781951       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216796341726       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216808318825       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216810193193       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216811971177       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216812870247       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216812037066       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216812682824       residual = 3.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216812806528       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.370700e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782397715       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216784251172       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216785751817       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216787303130       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216792191026       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216793084057       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216793398576       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216793332706       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216793199618       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216793293254       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.363135e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216782397715       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216782958297       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216783397481       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216783775238       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216785147871       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216785450905       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216785502678       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216785472598       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216785452259       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 3.656947e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006674 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5531e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.084440e-01                 1 1 ON  0
uu_1  4.742672e-02                 1 1 ON  1
uu_2  -4.538333e-02                1 1 ON  2
uu_3  -9.907136e-02                1 1 ON  3
uu_4  -1.319730e-01                1 1 ON  4
uu_5  -1.385002e-01                1 1 ON  5
uu_6  -1.150885e-01                1 1 ON  6
uu_7  -4.142736e-02                1 1 ON  7
uu_8  9.845552e-02                 1 1 ON  8
uu_9  1.227356e-01                 1 1 ON  9
ud_0  3.467876e-01                 1 1 ON  10
ud_1  9.151678e-02                 1 1 ON  11
ud_2  -1.376383e-02                1 1 ON  12
ud_3  -7.186380e-02                1 1 ON  13
ud_4  -1.196082e-01                1 1 ON  14
ud_5  -1.531878e-01                1 1 ON  15
ud_6  -1.566031e-01                1 1 ON  16
ud_7  -1.116053e-01                1 1 ON  17
ud_8  1.863285e-03                 1 1 ON  18
ud_9  9.252614e-02                 1 1 ON  19
eO_0  -7.555453e-01                1 1 ON  20
eO_1  -4.428004e-01                1 1 ON  21
eO_2  -4.588666e-02                1 1 ON  22
eO_3  2.030275e-01                 1 1 ON  23
eO_4  2.977470e-01                 1 1 ON  24
eO_5  3.145411e-01                 1 1 ON  25
eO_6  2.544122e-01                 1 1 ON  26
eO_7  1.165897e-01                 1 1 ON  27
eO_8  2.863418e-02                 1 1 ON  28
eO_9  1.857657e-02                 1 1 ON  29
eH1_0 -1.815794e-01                1 1 ON  30
eH1_1 -1.030262e-01                1 1 ON  31
eH1_2 -6.285976e-02                1 1 ON  32
eH1_3 -2.658753e-02                1 1 ON  33
eH1_4 1.886426e-02                 1 1 ON  34
eH1_5 3.324625e-02                 1 1 ON  35
eH1_6 7.820757e-02                 1 1 ON  36
eH1_7 1.100319e-01                 1 1 ON  37
eH1_8 9.314734e-02                 1 1 ON  38
eH1_9 2.507884e-02                 1 1 ON  39
eH2_0 -1.836619e-01                1 1 ON  40
eH2_1 -1.045610e-01                1 1 ON  41
eH2_2 -6.432258e-02                1 1 ON  42
eH2_3 -2.808148e-02                1 1 ON  43
eH2_4 1.765932e-02                 1 1 ON  44
eH2_5 3.286391e-02                 1 1 ON  45
eH2_6 8.004310e-02                 1 1 ON  46
eH2_7 1.144227e-01                 1 1 ON  47
eH2_8 9.604238e-02                 1 1 ON  48
eH2_9 2.721160e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.250205
====================================================
  Execution time = 2.0186e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1713e-01
  Total weights = 2.0000e+06
  Execution time = 1.8457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316261448206
                                         uncertainty =       0.007392354093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316261448206
                                         uncertainty =       0.007392354093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397635159
  error estimate for blocks of size 2^( 2) =       0.000407781006
  error estimate for blocks of size 2^( 3) =       0.000417022340
  error estimate for blocks of size 2^( 4) =       0.000423410929
  error estimate for blocks of size 2^( 5) =       0.000426773794
  error estimate for blocks of size 2^( 6) =       0.000428521969
  error estimate for blocks of size 2^( 7) =       0.000429015142

      target function =                  N/A
              le_mean =     -17.216624201324
             les_mean =     296.728376171378
             stat err =       0.000426930459
             autocorr =       1.152775461016
              std dev =       0.562341035211
             le_variance =       0.316227439882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318697532494
                                         uncertainty =       0.007443971215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318697532494
                                         uncertainty =       0.007443971215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399163761
  error estimate for blocks of size 2^( 2) =       0.000409189440
  error estimate for blocks of size 2^( 3) =       0.000418332408
  error estimate for blocks of size 2^( 4) =       0.000424656690
  error estimate for blocks of size 2^( 5) =       0.000427996874
  error estimate for blocks of size 2^( 6) =       0.000429752498
  error estimate for blocks of size 2^( 7) =       0.000430242219

      target function =                  N/A
              le_mean =     -17.216622338897
             les_mean =     296.730748016664
             stat err =       0.000428162070
             autocorr =       1.150572982784
              std dev =       0.564502804056
             le_variance =       0.318663415787

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110040369
                                         uncertainty =       0.007431779248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318110040369
                                         uncertainty =       0.007431779248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398795676
  error estimate for blocks of size 2^( 2) =       0.000408844849
  error estimate for blocks of size 2^( 3) =       0.000418008235
  error estimate for blocks of size 2^( 4) =       0.000424347269
  error estimate for blocks of size 2^( 5) =       0.000427689520
  error estimate for blocks of size 2^( 6) =       0.000429441685
  error estimate for blocks of size 2^( 7) =       0.000429929038

      target function =                  N/A
              le_mean =     -17.216620549328
             les_mean =     296.730098963205
             stat err =       0.000427851878
             autocorr =       1.151028304304
              std dev =       0.563982253884
             le_variance =       0.318075982696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316520588370
                                         uncertainty =       0.007398119468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316520588370
                                         uncertainty =       0.007398119468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397798049
  error estimate for blocks of size 2^( 2) =       0.000407928598
  error estimate for blocks of size 2^( 3) =       0.000417157726
  error estimate for blocks of size 2^( 4) =       0.000423538704
  error estimate for blocks of size 2^( 5) =       0.000426898017
  error estimate for blocks of size 2^( 6) =       0.000428646377
  error estimate for blocks of size 2^( 7) =       0.000429138368

      target function =                  N/A
              le_mean =     -17.216621948200
             les_mean =     296.728557724444
             stat err =       0.000427055367
             autocorr =       1.152505668269
              std dev =       0.562571395877
             le_variance =       0.316486575459


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216624201324        initial  <--
     2.5000e-01     2.5000e+00             4.3707e-03       -17.216622338897
     1.0000e+00     1.0000e+01             1.3631e-03       -17.216620549328
     4.0000e+00     4.0000e+01             3.6569e-04       -17.216621948200

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.7063
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726853e-02 1 1  ON 1
 uu_2                -4.526983e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128233e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124742e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532908e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024027e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679248e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814956e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432943e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596918e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8244e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2823
    reference variance = 0.174561
====================================================
  Execution time = 2.0016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1254e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312519038233
                                         uncertainty =       0.003375418892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312519038233
                                         uncertainty =       0.003375418892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395309107
  error estimate for blocks of size 2^( 2) =       0.000404906054
  error estimate for blocks of size 2^( 3) =       0.000414056902
  error estimate for blocks of size 2^( 4) =       0.000420754397
  error estimate for blocks of size 2^( 5) =       0.000425315937
  error estimate for blocks of size 2^( 6) =       0.000427970636
  error estimate for blocks of size 2^( 7) =       0.000428786458

      target function =                  N/A
              le_mean =     -17.216565590709
             les_mean =     296.722669162691
             stat err =       0.000425706857
             autocorr =       1.159705328559
              std dev =       0.559051500106
             le_variance =       0.312538579771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656559071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216565590709       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216568542681       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216569544891       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216571006133       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216571399843       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216572194896       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216572333262       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216572398115       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216572355969       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 5.940230e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216565590709       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566400850       residual = 6.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566670680       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216567056410       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216567136470       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216567341644       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216567379487       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216567397608       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216567389365       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.537557e-04

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216565590709       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216565798319       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216565867168       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216565965047       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216565983493       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566034802       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566044958       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216566049342       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216566047505       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 3.879444e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5524e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.081780e-01 1 1  ON 0
 uu_1                 4.729003e-02 1 1  ON 1
 uu_2                -4.528415e-02 1 1  ON 2
 uu_3                -9.892190e-02 1 1  ON 3
 uu_4                -1.319746e-01 1 1  ON 4
 uu_5                -1.385323e-01 1 1  ON 5
 uu_6                -1.150092e-01 1 1  ON 6
 uu_7                -4.129745e-02 1 1  ON 7
 uu_8                 9.852756e-02 1 1  ON 8
 uu_9                 1.226897e-01 1 1  ON 9
 ud_0                 3.459738e-01 1 1  ON 10
 ud_1                 9.107111e-02 1 1  ON 11
 ud_2                -1.335339e-02 1 1  ON 12
 ud_3                -7.132187e-02 1 1  ON 13
 ud_4                -1.194317e-01 1 1  ON 14
 ud_5                -1.532776e-01 1 1  ON 15
 ud_6                -1.565859e-01 1 1  ON 16
 ud_7                -1.115183e-01 1 1  ON 17
 ud_8                 2.010837e-03 1 1  ON 18
 ud_9                 9.254286e-02 1 1  ON 19
 eO_0                -7.543359e-01 1 1  ON 20
 eO_1                -4.422097e-01 1 1  ON 21
 eO_2                -4.668251e-02 1 1  ON 22
 eO_3                 2.024838e-01 1 1  ON 23
 eO_4                 2.975539e-01 1 1  ON 24
 eO_5                 3.144621e-01 1 1  ON 25
 eO_6                 2.543457e-01 1 1  ON 26
 eO_7                 1.164911e-01 1 1  ON 27
 eO_8                 2.861689e-02 1 1  ON 28
 eO_9                 1.857123e-02 1 1  ON 29
eH1_0                -1.815056e-01 1 1  ON 30
eH1_1                -1.030450e-01 1 1  ON 31
eH1_2                -6.279122e-02 1 1  ON 32
eH1_3                -2.662171e-02 1 1  ON 33
eH1_4                 1.880798e-02 1 1  ON 34
eH1_5                 3.320225e-02 1 1  ON 35
eH1_6                 7.824206e-02 1 1  ON 36
eH1_7                 1.100648e-01 1 1  ON 37
eH1_8                 9.310138e-02 1 1  ON 38
eH1_9                 2.506841e-02 1 1  ON 39
eH2_0                -1.835890e-01 1 1  ON 40
eH2_1                -1.045881e-01 1 1  ON 41
eH2_2                -6.434069e-02 1 1  ON 42
eH2_3                -2.815512e-02 1 1  ON 43
eH2_4                 1.759129e-02 1 1  ON 44
eH2_5                 3.290399e-02 1 1  ON 45
eH2_6                 8.015896e-02 1 1  ON 46
eH2_7                 1.144735e-01 1 1  ON 47
eH2_8                 9.597716e-02 1 1  ON 48
eH2_9                 2.718667e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1141
    reference variance = 0.53172
====================================================
  Execution time = 1.9733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1409e-01
  Total weights = 2.0000e+06
  Execution time = 1.8603e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314076634472
                                         uncertainty =       0.004262737951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314076634472
                                         uncertainty =       0.004262737951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396219925
  error estimate for blocks of size 2^( 2) =       0.000406417695
  error estimate for blocks of size 2^( 3) =       0.000415372323
  error estimate for blocks of size 2^( 4) =       0.000422223716
  error estimate for blocks of size 2^( 5) =       0.000427529765
  error estimate for blocks of size 2^( 6) =       0.000429479833
  error estimate for blocks of size 2^( 7) =       0.000430634423

      target function =                  N/A
              le_mean =     -17.217089919048
             les_mean =     296.742165581045
             stat err =       0.000427466934
             autocorr =       1.163944924213
              std dev =       0.560339591177
             le_variance =       0.313980457441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314483752582
                                         uncertainty =       0.004268522645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314483752582
                                         uncertainty =       0.004268522645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396476453
  error estimate for blocks of size 2^( 2) =       0.000406651102
  error estimate for blocks of size 2^( 3) =       0.000415587495
  error estimate for blocks of size 2^( 4) =       0.000422423771
  error estimate for blocks of size 2^( 5) =       0.000427724103
  error estimate for blocks of size 2^( 6) =       0.000429665708
  error estimate for blocks of size 2^( 7) =       0.000430814550

      target function =                  N/A
              le_mean =     -17.217088176720
             les_mean =     296.742512282724
             stat err =       0.000427657033
             autocorr =       1.163473347397
              std dev =       0.560702376448
             le_variance =       0.314387154954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314293978938
                                         uncertainty =       0.004265901097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314293978938
                                         uncertainty =       0.004265901097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396356892
  error estimate for blocks of size 2^( 2) =       0.000406542028
  error estimate for blocks of size 2^( 3) =       0.000415486780
  error estimate for blocks of size 2^( 4) =       0.000422329964
  error estimate for blocks of size 2^( 5) =       0.000427632997
  error estimate for blocks of size 2^( 6) =       0.000429578456
  error estimate for blocks of size 2^( 7) =       0.000430729895

      target function =                  N/A
              le_mean =     -17.217088780702
             les_mean =     296.742343497001
             stat err =       0.000427567828
             autocorr =       1.163689755455
              std dev =       0.560533292080
             le_variance =       0.314197571531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314104137903
                                         uncertainty =       0.004263142603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314104137903
                                         uncertainty =       0.004263142603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396237259
  error estimate for blocks of size 2^( 2) =       0.000406433405
  error estimate for blocks of size 2^( 3) =       0.000415386766
  error estimate for blocks of size 2^( 4) =       0.000422237107
  error estimate for blocks of size 2^( 5) =       0.000427542774
  error estimate for blocks of size 2^( 6) =       0.000429492251
  error estimate for blocks of size 2^( 7) =       0.000430646438

      target function =                  N/A
              le_mean =     -17.217089748532
             les_mean =     296.742187183347
             stat err =       0.000427479643
             autocorr =       1.163912287581
              std dev =       0.560364106042
             le_variance =       0.314007931340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217089919048        initial  <--
     2.5000e+00     2.5000e+01             5.9402e-04       -17.217088176720
     1.0000e+01     1.0000e+02             1.5376e-04       -17.217088780702
     4.0000e+01     4.0000e+02             3.8794e-05       -17.217089748532

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1290
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.081671e-01 1 1  ON 0
 uu_1                 4.726853e-02 1 1  ON 1
 uu_2                -4.526983e-02 1 1  ON 2
 uu_3                -9.891511e-02 1 1  ON 3
 uu_4                -1.319824e-01 1 1  ON 4
 uu_5                -1.385305e-01 1 1  ON 5
 uu_6                -1.149988e-01 1 1  ON 6
 uu_7                -4.128233e-02 1 1  ON 7
 uu_8                 9.853585e-02 1 1  ON 8
 uu_9                 1.226851e-01 1 1  ON 9
 ud_0                 3.458595e-01 1 1  ON 10
 ud_1                 9.101180e-02 1 1  ON 11
 ud_2                -1.328652e-02 1 1  ON 12
 ud_3                -7.124742e-02 1 1  ON 13
 ud_4                -1.194124e-01 1 1  ON 14
 ud_5                -1.532908e-01 1 1  ON 15
 ud_6                -1.565760e-01 1 1  ON 16
 ud_7                -1.115047e-01 1 1  ON 17
 ud_8                 2.024027e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541822e-01 1 1  ON 20
 eO_1                -4.421407e-01 1 1  ON 21
 eO_2                -4.679248e-02 1 1  ON 22
 eO_3                 2.024218e-01 1 1  ON 23
 eO_4                 2.975349e-01 1 1  ON 24
 eO_5                 3.144492e-01 1 1  ON 25
 eO_6                 2.543406e-01 1 1  ON 26
 eO_7                 1.164821e-01 1 1  ON 27
 eO_8                 2.861513e-02 1 1  ON 28
 eO_9                 1.857033e-02 1 1  ON 29
eH1_0                -1.814956e-01 1 1  ON 30
eH1_1                -1.030464e-01 1 1  ON 31
eH1_2                -6.277820e-02 1 1  ON 32
eH1_3                -2.663418e-02 1 1  ON 33
eH1_4                 1.879850e-02 1 1  ON 34
eH1_5                 3.320537e-02 1 1  ON 35
eH1_6                 7.824348e-02 1 1  ON 36
eH1_7                 1.100692e-01 1 1  ON 37
eH1_8                 9.309657e-02 1 1  ON 38
eH1_9                 2.506717e-02 1 1  ON 39
eH2_0                -1.835822e-01 1 1  ON 40
eH2_1                -1.045920e-01 1 1  ON 41
eH2_2                -6.432943e-02 1 1  ON 42
eH2_3                -2.816145e-02 1 1  ON 43
eH2_4                 1.757844e-02 1 1  ON 44
eH2_5                 3.290948e-02 1 1  ON 45
eH2_6                 8.016997e-02 1 1  ON 46
eH2_7                 1.144737e-01 1 1  ON 47
eH2_8                 9.596918e-02 1 1  ON 48
eH2_9                 2.718379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1555
    reference variance = 0.304231
====================================================
  Execution time = 1.9961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1896e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318936149027
                                         uncertainty =       0.006447460044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318936149027
                                         uncertainty =       0.006447460044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399348469
  error estimate for blocks of size 2^( 2) =       0.000408917033
  error estimate for blocks of size 2^( 3) =       0.000417677529
  error estimate for blocks of size 2^( 4) =       0.000423650993
  error estimate for blocks of size 2^( 5) =       0.000426902137
  error estimate for blocks of size 2^( 6) =       0.000429509036
  error estimate for blocks of size 2^( 7) =       0.000429269198

      target function =                  N/A
              le_mean =     -17.216777436137
             les_mean =     296.736383524866
             stat err =       0.000427332841
             autocorr =       1.145060657240
              std dev =       0.564764020524
             le_variance =       0.318958398879


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677743614e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777436137       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216777752023       residual = 9.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216777843399       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216778022318       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216778179694       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216778299660       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216778303771       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216778303870       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216778300484       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 6.000167e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777436137       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216777515915       residual = 9.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216777538916       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216777583798       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216777622780       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216777653265       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216777653798       residual = 9.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216777654246       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216777653319       residual = 2.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 1.505202e-05

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216777436137       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216777456132       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216777461892       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216777473123       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216777482845       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216777490496       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216777490601       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216777490735       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216777490501       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 3.766289e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5543e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.081674e-01 1 1  ON 0
 uu_1                 4.727138e-02 1 1  ON 1
 uu_2                -4.527008e-02 1 1  ON 2
 uu_3                -9.891658e-02 1 1  ON 3
 uu_4                -1.319819e-01 1 1  ON 4
 uu_5                -1.385303e-01 1 1  ON 5
 uu_6                -1.149998e-01 1 1  ON 6
 uu_7                -4.128380e-02 1 1  ON 7
 uu_8                 9.853497e-02 1 1  ON 8
 uu_9                 1.226856e-01 1 1  ON 9
 ud_0                 3.458707e-01 1 1  ON 10
 ud_1                 9.101825e-02 1 1  ON 11
 ud_2                -1.329342e-02 1 1  ON 12
 ud_3                -7.125401e-02 1 1  ON 13
 ud_4                -1.194130e-01 1 1  ON 14
 ud_5                -1.532903e-01 1 1  ON 15
 ud_6                -1.565773e-01 1 1  ON 16
 ud_7                -1.115062e-01 1 1  ON 17
 ud_8                 2.022208e-03 1 1  ON 18
 ud_9                 9.254221e-02 1 1  ON 19
 eO_0                -7.541972e-01 1 1  ON 20
 eO_1                -4.421484e-01 1 1  ON 21
 eO_2                -4.678071e-02 1 1  ON 22
 eO_3                 2.024282e-01 1 1  ON 23
 eO_4                 2.975369e-01 1 1  ON 24
 eO_5                 3.144500e-01 1 1  ON 25
 eO_6                 2.543413e-01 1 1  ON 26
 eO_7                 1.164830e-01 1 1  ON 27
 eO_8                 2.861523e-02 1 1  ON 28
 eO_9                 1.857043e-02 1 1  ON 29
eH1_0                -1.814957e-01 1 1  ON 30
eH1_1                -1.030461e-01 1 1  ON 31
eH1_2                -6.277952e-02 1 1  ON 32
eH1_3                -2.663314e-02 1 1  ON 33
eH1_4                 1.879946e-02 1 1  ON 34
eH1_5                 3.320483e-02 1 1  ON 35
eH1_6                 7.824290e-02 1 1  ON 36
eH1_7                 1.100687e-01 1 1  ON 37
eH1_8                 9.309704e-02 1 1  ON 38
eH1_9                 2.506735e-02 1 1  ON 39
eH2_0                -1.835823e-01 1 1  ON 40
eH2_1                -1.045919e-01 1 1  ON 41
eH2_2                -6.433067e-02 1 1  ON 42
eH2_3                -2.816024e-02 1 1  ON 43
eH2_4                 1.757831e-02 1 1  ON 44
eH2_5                 3.290972e-02 1 1  ON 45
eH2_6                 8.016961e-02 1 1  ON 46
eH2_7                 1.144732e-01 1 1  ON 47
eH2_8                 9.596982e-02 1 1  ON 48
eH2_9                 2.718394e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1245
    reference variance = 0.249577
====================================================
  Execution time = 1.9620e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2329e-01
  Total weights = 2.0000e+06
  Execution time = 1.8624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323357406376
                                         uncertainty =       0.005977660611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323357406376
                                         uncertainty =       0.005977660611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402042997
  error estimate for blocks of size 2^( 2) =       0.000411541899
  error estimate for blocks of size 2^( 3) =       0.000420035203
  error estimate for blocks of size 2^( 4) =       0.000426756243
  error estimate for blocks of size 2^( 5) =       0.000430315649
  error estimate for blocks of size 2^( 6) =       0.000432340405
  error estimate for blocks of size 2^( 7) =       0.000433590129

      target function =                  N/A
              le_mean =     -17.216384729501
             les_mean =     296.727180136140
             stat err =       0.000430750606
             autocorr =       1.147907228102
              std dev =       0.568574659637
             le_variance =       0.323277143581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323400235169
                                         uncertainty =       0.005978974068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323400235169
                                         uncertainty =       0.005978974068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402069620
  error estimate for blocks of size 2^( 2) =       0.000411566057
  error estimate for blocks of size 2^( 3) =       0.000420057512
  error estimate for blocks of size 2^( 4) =       0.000426777125
  error estimate for blocks of size 2^( 5) =       0.000430336106
  error estimate for blocks of size 2^( 6) =       0.000432361038
  error estimate for blocks of size 2^( 7) =       0.000433610615

      target function =                  N/A
              le_mean =     -17.216384776159
             les_mean =     296.727224557512
             stat err =       0.000430771221
             autocorr =       1.147865078201
              std dev =       0.568612309404
             le_variance =       0.323319958405

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323378952416
                                         uncertainty =       0.005978321882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323378952416
                                         uncertainty =       0.005978321882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402056391
  error estimate for blocks of size 2^( 2) =       0.000411554048
  error estimate for blocks of size 2^( 3) =       0.000420046420
  error estimate for blocks of size 2^( 4) =       0.000426766742
  error estimate for blocks of size 2^( 5) =       0.000430325934
  error estimate for blocks of size 2^( 6) =       0.000432350780
  error estimate for blocks of size 2^( 7) =       0.000433600431

      target function =                  N/A
              le_mean =     -17.216384751785
             les_mean =     296.727202442477
             stat err =       0.000430760972
             autocorr =       1.147885993933
              std dev =       0.568593600587
             le_variance =       0.323298682629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323360102465
                                         uncertainty =       0.005977743405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323360102465
                                         uncertainty =       0.005977743405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402044673
  error estimate for blocks of size 2^( 2) =       0.000411543419
  error estimate for blocks of size 2^( 3) =       0.000420036606
  error estimate for blocks of size 2^( 4) =       0.000426757556
  error estimate for blocks of size 2^( 5) =       0.000430316936
  error estimate for blocks of size 2^( 6) =       0.000432341702
  error estimate for blocks of size 2^( 7) =       0.000433591417

      target function =                  N/A
              le_mean =     -17.216384732075
             les_mean =     296.727182919971
             stat err =       0.000430751903
             autocorr =       1.147904568125
              std dev =       0.568577029783
             le_variance =       0.323279838796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216384729501        initial
     2.5000e+01     2.5000e+02             6.0002e-05       -17.216384776159  <--
     1.0000e+02     1.0000e+03             1.5052e-05       -17.216384751785
     4.0000e+02     4.0000e+03             3.7663e-06       -17.216384732075

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.9026e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.081682e-01 1 1  ON 0
 uu_1                 4.727984e-02 1 1  ON 1
 uu_2                -4.527080e-02 1 1  ON 2
 uu_3                -9.892096e-02 1 1  ON 3
 uu_4                -1.319803e-01 1 1  ON 4
 uu_5                -1.385296e-01 1 1  ON 5
 uu_6                -1.150029e-01 1 1  ON 6
 uu_7                -4.128822e-02 1 1  ON 7
 uu_8                 9.853235e-02 1 1  ON 8
 uu_9                 1.226870e-01 1 1  ON 9
 ud_0                 3.459042e-01 1 1  ON 10
 ud_1                 9.103723e-02 1 1  ON 11
 ud_2                -1.331369e-02 1 1  ON 12
 ud_3                -7.127369e-02 1 1  ON 13
 ud_4                -1.194147e-01 1 1  ON 14
 ud_5                -1.532890e-01 1 1  ON 15
 ud_6                -1.565813e-01 1 1  ON 16
 ud_7                -1.115105e-01 1 1  ON 17
 ud_8                 2.016756e-03 1 1  ON 18
 ud_9                 9.254219e-02 1 1  ON 19
 eO_0                -7.542422e-01 1 1  ON 20
 eO_1                -4.421715e-01 1 1  ON 21
 eO_2                -4.674588e-02 1 1  ON 22
 eO_3                 2.024476e-01 1 1  ON 23
 eO_4                 2.975429e-01 1 1  ON 24
 eO_5                 3.144523e-01 1 1  ON 25
 eO_6                 2.543432e-01 1 1  ON 26
 eO_7                 1.164859e-01 1 1  ON 27
 eO_8                 2.861554e-02 1 1  ON 28
 eO_9                 1.857074e-02 1 1  ON 29
eH1_0                -1.814960e-01 1 1  ON 30
eH1_1                -1.030450e-01 1 1  ON 31
eH1_2                -6.278344e-02 1 1  ON 32
eH1_3                -2.663008e-02 1 1  ON 33
eH1_4                 1.880232e-02 1 1  ON 34
eH1_5                 3.320322e-02 1 1  ON 35
eH1_6                 7.824117e-02 1 1  ON 36
eH1_7                 1.100672e-01 1 1  ON 37
eH1_8                 9.309843e-02 1 1  ON 38
eH1_9                 2.506789e-02 1 1  ON 39
eH2_0                -1.835828e-01 1 1  ON 40
eH2_1                -1.045916e-01 1 1  ON 41
eH2_2                -6.433434e-02 1 1  ON 42
eH2_3                -2.815666e-02 1 1  ON 43
eH2_4                 1.757791e-02 1 1  ON 44
eH2_5                 3.291047e-02 1 1  ON 45
eH2_6                 8.016855e-02 1 1  ON 46
eH2_7                 1.144718e-01 1 1  ON 47
eH2_8                 9.597175e-02 1 1  ON 48
eH2_9                 2.718439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7176e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1985
    reference variance = 0.151947
====================================================
  Execution time = 2.2152e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1124e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311345799497
                                         uncertainty =       0.002606475684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311345799497
                                         uncertainty =       0.002606475684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394486944
  error estimate for blocks of size 2^( 2) =       0.000404233609
  error estimate for blocks of size 2^( 3) =       0.000412939856
  error estimate for blocks of size 2^( 4) =       0.000419856843
  error estimate for blocks of size 2^( 5) =       0.000423489533
  error estimate for blocks of size 2^( 6) =       0.000425538858
  error estimate for blocks of size 2^( 7) =       0.000423521937

      target function =                  N/A
              le_mean =     -17.215250367025
             les_mean =     296.676084942165
             stat err =       0.000423101793
             autocorr =       1.150335339584
              std dev =       0.557888786805
             le_variance =       0.311239898443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721525036702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215250367025       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215250986630       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215251329584       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215252305485       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215253023770       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215252934362       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215252828950       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215252831215       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215252850641       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.276939e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215250367025       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215250527673       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215250616478       residual = 4.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215250871137       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215251060606       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215251035707       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215251008958       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215251009324       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215251013377       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 5.757711e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215250367025       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215250407563       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215250429967       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215250494344       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215250542375       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215250536021       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215250529291       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215250529378       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215250530339       residual = 2.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 1.443622e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7743e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.081816e-01 1 1  ON 0
 uu_1                 4.728853e-02 1 1  ON 1
 uu_2                -4.527613e-02 1 1  ON 2
 uu_3                -9.892754e-02 1 1  ON 3
 uu_4                -1.319766e-01 1 1  ON 4
 uu_5                -1.385322e-01 1 1  ON 5
 uu_6                -1.150090e-01 1 1  ON 6
 uu_7                -4.129387e-02 1 1  ON 7
 uu_8                 9.852948e-02 1 1  ON 8
 uu_9                 1.226890e-01 1 1  ON 9
 ud_0                 3.459527e-01 1 1  ON 10
 ud_1                 9.106302e-02 1 1  ON 11
 ud_2                -1.333974e-02 1 1  ON 12
 ud_3                -7.130268e-02 1 1  ON 13
 ud_4                -1.194227e-01 1 1  ON 14
 ud_5                -1.532863e-01 1 1  ON 15
 ud_6                -1.565851e-01 1 1  ON 16
 ud_7                -1.115157e-01 1 1  ON 17
 ud_8                 2.010758e-03 1 1  ON 18
 ud_9                 9.254200e-02 1 1  ON 19
 eO_0                -7.542998e-01 1 1  ON 20
 eO_1                -4.422048e-01 1 1  ON 21
 eO_2                -4.669982e-02 1 1  ON 22
 eO_3                 2.024737e-01 1 1  ON 23
 eO_4                 2.975513e-01 1 1  ON 24
 eO_5                 3.144551e-01 1 1  ON 25
 eO_6                 2.543459e-01 1 1  ON 26
 eO_7                 1.164899e-01 1 1  ON 27
 eO_8                 2.861616e-02 1 1  ON 28
 eO_9                 1.857081e-02 1 1  ON 29
eH1_0                -1.815010e-01 1 1  ON 30
eH1_1                -1.030388e-01 1 1  ON 31
eH1_2                -6.279122e-02 1 1  ON 32
eH1_3                -2.662676e-02 1 1  ON 33
eH1_4                 1.880684e-02 1 1  ON 34
eH1_5                 3.320208e-02 1 1  ON 35
eH1_6                 7.823948e-02 1 1  ON 36
eH1_7                 1.100649e-01 1 1  ON 37
eH1_8                 9.310130e-02 1 1  ON 38
eH1_9                 2.506885e-02 1 1  ON 39
eH2_0                -1.835821e-01 1 1  ON 40
eH2_1                -1.045892e-01 1 1  ON 41
eH2_2                -6.434076e-02 1 1  ON 42
eH2_3                -2.815082e-02 1 1  ON 43
eH2_4                 1.758445e-02 1 1  ON 44
eH2_5                 3.290708e-02 1 1  ON 45
eH2_6                 8.016354e-02 1 1  ON 46
eH2_7                 1.144689e-01 1 1  ON 47
eH2_8                 9.597322e-02 1 1  ON 48
eH2_9                 2.718494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1357
    reference variance = 0.460426
====================================================
  Execution time = 1.9753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1624e-01
  Total weights = 2.0000e+06
  Execution time = 1.8597e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315866084473
                                         uncertainty =       0.003897651903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315866084473
                                         uncertainty =       0.003897651903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397614413
  error estimate for blocks of size 2^( 2) =       0.000407383335
  error estimate for blocks of size 2^( 3) =       0.000416525347
  error estimate for blocks of size 2^( 4) =       0.000423215255
  error estimate for blocks of size 2^( 5) =       0.000427707276
  error estimate for blocks of size 2^( 6) =       0.000428518327
  error estimate for blocks of size 2^( 7) =       0.000430273295

      target function =                  N/A
              le_mean =     -17.215915325987
             les_mean =     296.703934796812
             stat err =       0.000427428538
             autocorr =       1.155587386658
              std dev =       0.562311695911
             le_variance =       0.316194443359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316037360990
                                         uncertainty =       0.003895695211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316037360990
                                         uncertainty =       0.003895695211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397722135
  error estimate for blocks of size 2^( 2) =       0.000407480944
  error estimate for blocks of size 2^( 3) =       0.000416613257
  error estimate for blocks of size 2^( 4) =       0.000423296829
  error estimate for blocks of size 2^( 5) =       0.000427785309
  error estimate for blocks of size 2^( 6) =       0.000428593361
  error estimate for blocks of size 2^( 7) =       0.000430347773

      target function =                  N/A
              le_mean =     -17.215915464462
             les_mean =     296.704110914831
             stat err =       0.000427505818
             autocorr =       1.155379172694
              std dev =       0.562464037528
             le_variance =       0.316365793512

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953846236
                                         uncertainty =       0.003896607171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953846236
                                         uncertainty =       0.003896607171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397669612
  error estimate for blocks of size 2^( 2) =       0.000407433279
  error estimate for blocks of size 2^( 3) =       0.000416570272
  error estimate for blocks of size 2^( 4) =       0.000423256908
  error estimate for blocks of size 2^( 5) =       0.000427747128
  error estimate for blocks of size 2^( 6) =       0.000428556617
  error estimate for blocks of size 2^( 7) =       0.000430311358

      target function =                  N/A
              le_mean =     -17.215915365728
             les_mean =     296.704023963010
             stat err =       0.000427468003
             autocorr =       1.155479945593
              std dev =       0.562389759189
             le_variance =       0.316282241241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315877101480
                                         uncertainty =       0.003897518779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315877101480
                                         uncertainty =       0.003897518779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397621343
  error estimate for blocks of size 2^( 2) =       0.000407389600
  error estimate for blocks of size 2^( 3) =       0.000416530978
  error estimate for blocks of size 2^( 4) =       0.000423220473
  error estimate for blocks of size 2^( 5) =       0.000427712268
  error estimate for blocks of size 2^( 6) =       0.000428523121
  error estimate for blocks of size 2^( 7) =       0.000430278063

      target function =                  N/A
              le_mean =     -17.215915327000
             les_mean =     296.703945853160
             stat err =       0.000427433481
             autocorr =       1.155573836282
              std dev =       0.562321495983
             le_variance =       0.316205464845


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215915325987        initial
     6.2500e+00     6.2500e+01             2.2769e-04       -17.215915464462  <--
     2.5000e+01     2.5000e+02             5.7577e-05       -17.215915365728
     1.0000e+02     1.0000e+03             1.4436e-05       -17.215915327000

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9145e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.082213e-01 1 1  ON 0
 uu_1                 4.731333e-02 1 1  ON 1
 uu_2                -4.529083e-02 1 1  ON 2
 uu_3                -9.894675e-02 1 1  ON 3
 uu_4                -1.319667e-01 1 1  ON 4
 uu_5                -1.385394e-01 1 1  ON 5
 uu_6                -1.150271e-01 1 1  ON 6
 uu_7                -4.131066e-02 1 1  ON 7
 uu_8                 9.852093e-02 1 1  ON 8
 uu_9                 1.226949e-01 1 1  ON 9
 ud_0                 3.460934e-01 1 1  ON 10
 ud_1                 9.113552e-02 1 1  ON 11
 ud_2                -1.341193e-02 1 1  ON 12
 ud_3                -7.138755e-02 1 1  ON 13
 ud_4                -1.194471e-01 1 1  ON 14
 ud_5                -1.532776e-01 1 1  ON 15
 ud_6                -1.565954e-01 1 1  ON 16
 ud_7                -1.115312e-01 1 1  ON 17
 ud_8                 1.992901e-03 1 1  ON 18
 ud_9                 9.254144e-02 1 1  ON 19
 eO_0                -7.544699e-01 1 1  ON 20
 eO_1                -4.423012e-01 1 1  ON 21
 eO_2                -4.656868e-02 1 1  ON 22
 eO_3                 2.025523e-01 1 1  ON 23
 eO_4                 2.975771e-01 1 1  ON 24
 eO_5                 3.144638e-01 1 1  ON 25
 eO_6                 2.543542e-01 1 1  ON 26
 eO_7                 1.165018e-01 1 1  ON 27
 eO_8                 2.861803e-02 1 1  ON 28
 eO_9                 1.857103e-02 1 1  ON 29
eH1_0                -1.815160e-01 1 1  ON 30
eH1_1                -1.030214e-01 1 1  ON 31
eH1_2                -6.281330e-02 1 1  ON 32
eH1_3                -2.661725e-02 1 1  ON 33
eH1_4                 1.881998e-02 1 1  ON 34
eH1_5                 3.319924e-02 1 1  ON 35
eH1_6                 7.823460e-02 1 1  ON 36
eH1_7                 1.100578e-01 1 1  ON 37
eH1_8                 9.310988e-02 1 1  ON 38
eH1_9                 2.507174e-02 1 1  ON 39
eH2_0                -1.835801e-01 1 1  ON 40
eH2_1                -1.045826e-01 1 1  ON 41
eH2_2                -6.435878e-02 1 1  ON 42
eH2_3                -2.813405e-02 1 1  ON 43
eH2_4                 1.760367e-02 1 1  ON 44
eH2_5                 3.289751e-02 1 1  ON 45
eH2_6                 8.014870e-02 1 1  ON 46
eH2_7                 1.144603e-01 1 1  ON 47
eH2_8                 9.597763e-02 1 1  ON 48
eH2_9                 2.718658e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6894e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7174e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1465
    reference variance = 0.241316
====================================================
  Execution time = 2.0080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315236512825
                                         uncertainty =       0.004166994344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315236512825
                                         uncertainty =       0.004166994344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396966819
  error estimate for blocks of size 2^( 2) =       0.000406929252
  error estimate for blocks of size 2^( 3) =       0.000415455137
  error estimate for blocks of size 2^( 4) =       0.000422533244
  error estimate for blocks of size 2^( 5) =       0.000425544893
  error estimate for blocks of size 2^( 6) =       0.000426231023
  error estimate for blocks of size 2^( 7) =       0.000428146657

      target function =                  N/A
              le_mean =     -17.216298047053
             les_mean =     296.716083598147
             stat err =       0.000425613954
             autocorr =       1.149537921754
              std dev =       0.561395859244
             le_variance =       0.315165310776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629804705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298047053       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216303213192       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216304747184       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216306717399       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216310163565       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216310737046       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216310697175       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216310524735       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216310578257       residual = 3.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 8.530728e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298047053       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216299531078       residual = 9.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216299977508       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216300536344       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216301495974       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216301644540       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216301606206       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216301571759       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216301579086       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.239971e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216298047053       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216298432418       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216298548985       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216298694163       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216298940704       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216298978271       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216298966027       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216298959291       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216298960614       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 5.673745e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5686e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.082541e-01 1 1  ON 0
 uu_1                 4.733796e-02 1 1  ON 1
 uu_2                -4.530645e-02 1 1  ON 2
 uu_3                -9.896128e-02 1 1  ON 3
 uu_4                -1.319491e-01 1 1  ON 4
 uu_5                -1.385597e-01 1 1  ON 5
 uu_6                -1.150422e-01 1 1  ON 6
 uu_7                -4.132760e-02 1 1  ON 7
 uu_8                 9.851121e-02 1 1  ON 8
 uu_9                 1.227040e-01 1 1  ON 9
 ud_0                 3.462707e-01 1 1  ON 10
 ud_1                 9.123383e-02 1 1  ON 11
 ud_2                -1.351482e-02 1 1  ON 12
 ud_3                -7.149372e-02 1 1  ON 13
 ud_4                -1.194761e-01 1 1  ON 14
 ud_5                -1.532662e-01 1 1  ON 15
 ud_6                -1.566025e-01 1 1  ON 16
 ud_7                -1.115505e-01 1 1  ON 17
 ud_8                 1.967459e-03 1 1  ON 18
 ud_9                 9.253861e-02 1 1  ON 19
 eO_0                -7.546939e-01 1 1  ON 20
 eO_1                -4.424094e-01 1 1  ON 21
 eO_2                -4.640830e-02 1 1  ON 22
 eO_3                 2.026479e-01 1 1  ON 23
 eO_4                 2.976106e-01 1 1  ON 24
 eO_5                 3.144661e-01 1 1  ON 25
 eO_6                 2.543705e-01 1 1  ON 26
 eO_7                 1.165217e-01 1 1  ON 27
 eO_8                 2.862099e-02 1 1  ON 28
 eO_9                 1.857162e-02 1 1  ON 29
eH1_0                -1.815328e-01 1 1  ON 30
eH1_1                -1.030286e-01 1 1  ON 31
eH1_2                -6.282631e-02 1 1  ON 32
eH1_3                -2.660287e-02 1 1  ON 33
eH1_4                 1.883078e-02 1 1  ON 34
eH1_5                 3.320049e-02 1 1  ON 35
eH1_6                 7.823174e-02 1 1  ON 36
eH1_7                 1.100581e-01 1 1  ON 37
eH1_8                 9.311947e-02 1 1  ON 38
eH1_9                 2.507433e-02 1 1  ON 39
eH2_0                -1.835890e-01 1 1  ON 40
eH2_1                -1.045894e-01 1 1  ON 41
eH2_2                -6.437479e-02 1 1  ON 42
eH2_3                -2.811791e-02 1 1  ON 43
eH2_4                 1.761691e-02 1 1  ON 44
eH2_5                 3.289996e-02 1 1  ON 45
eH2_6                 8.013956e-02 1 1  ON 46
eH2_7                 1.144537e-01 1 1  ON 47
eH2_8                 9.598897e-02 1 1  ON 48
eH2_9                 2.719002e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2095
    reference variance = 0.206768
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2755e-01
  Total weights = 2.0000e+06
  Execution time = 1.8432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327475740332
                                         uncertainty =       0.005616849505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327475740332
                                         uncertainty =       0.005616849505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404585004
  error estimate for blocks of size 2^( 2) =       0.000414203762
  error estimate for blocks of size 2^( 3) =       0.000423063395
  error estimate for blocks of size 2^( 4) =       0.000428873488
  error estimate for blocks of size 2^( 5) =       0.000433129745
  error estimate for blocks of size 2^( 6) =       0.000435483376
  error estimate for blocks of size 2^( 7) =       0.000437200502

      target function =                  N/A
              le_mean =     -17.216304804304
             les_mean =     296.728529002675
             stat err =       0.000433671778
             autocorr =       1.148954304536
              std dev =       0.572169600447
             le_variance =       0.327378051676

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328099335110
                                         uncertainty =       0.005621835933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328099335110
                                         uncertainty =       0.005621835933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404969918
  error estimate for blocks of size 2^( 2) =       0.000414558617
  error estimate for blocks of size 2^( 3) =       0.000423386152
  error estimate for blocks of size 2^( 4) =       0.000429177984
  error estimate for blocks of size 2^( 5) =       0.000433423181
  error estimate for blocks of size 2^( 6) =       0.000435759376
  error estimate for blocks of size 2^( 7) =       0.000437473582

      target function =                  N/A
              le_mean =     -17.216306193414
             les_mean =     296.729200050810
             stat err =       0.000433958531
             autocorr =       1.148288278002
              std dev =       0.572713950800
             le_variance =       0.328001269441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327821378261
                                         uncertainty =       0.005619335552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327821378261
                                         uncertainty =       0.005619335552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404798392
  error estimate for blocks of size 2^( 2) =       0.000414399922
  error estimate for blocks of size 2^( 3) =       0.000423241175
  error estimate for blocks of size 2^( 4) =       0.000429040884
  error estimate for blocks of size 2^( 5) =       0.000433290982
  error estimate for blocks of size 2^( 6) =       0.000435634690
  error estimate for blocks of size 2^( 7) =       0.000437349866

      target function =                  N/A
              le_mean =     -17.216305245818
             les_mean =     296.728889629965
             stat err =       0.000433829105
             autocorr =       1.148576199971
              std dev =       0.572471376260
             le_variance =       0.327723476637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327519803358
                                         uncertainty =       0.005617154007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327519803358
                                         uncertainty =       0.005617154007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404612214
  error estimate for blocks of size 2^( 2) =       0.000414228716
  error estimate for blocks of size 2^( 3) =       0.000423085949
  error estimate for blocks of size 2^( 4) =       0.000428894691
  error estimate for blocks of size 2^( 5) =       0.000433150155
  error estimate for blocks of size 2^( 6) =       0.000435502497
  error estimate for blocks of size 2^( 7) =       0.000437219357

      target function =                  N/A
              le_mean =     -17.216304804277
             les_mean =     296.728573037235
             stat err =       0.000433691675
             autocorr =       1.148905198400
              std dev =       0.572208080321
             le_variance =       0.327422087185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216304804304        initial
     1.5625e+00     1.5625e+01             8.5307e-04       -17.216306193414  <--
     6.2500e+00     6.2500e+01             2.2400e-04       -17.216305245818
     2.5000e+01     2.5000e+02             5.6737e-05       -17.216304804277

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9457e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.083511e-01 1 1  ON 0
 uu_1                 4.740093e-02 1 1  ON 1
 uu_2                -4.534093e-02 1 1  ON 2
 uu_3                -9.900273e-02 1 1  ON 3
 uu_4                -1.319145e-01 1 1  ON 4
 uu_5                -1.386097e-01 1 1  ON 5
 uu_6                -1.150842e-01 1 1  ON 6
 uu_7                -4.137700e-02 1 1  ON 7
 uu_8                 9.848281e-02 1 1  ON 8
 uu_9                 1.227310e-01 1 1  ON 9
 ud_0                 3.467397e-01 1 1  ON 10
 ud_1                 9.147009e-02 1 1  ON 11
 ud_2                -1.374767e-02 1 1  ON 12
 ud_3                -7.178201e-02 1 1  ON 13
 ud_4                -1.195686e-01 1 1  ON 14
 ud_5                -1.532295e-01 1 1  ON 15
 ud_6                -1.566121e-01 1 1  ON 16
 ud_7                -1.116034e-01 1 1  ON 17
 ud_8                 1.893211e-03 1 1  ON 18
 ud_9                 9.253041e-02 1 1  ON 19
 eO_0                -7.553229e-01 1 1  ON 20
 eO_1                -4.427052e-01 1 1  ON 21
 eO_2                -4.601118e-02 1 1  ON 22
 eO_3                 2.029351e-01 1 1  ON 23
 eO_4                 2.977194e-01 1 1  ON 24
 eO_5                 3.144773e-01 1 1  ON 25
 eO_6                 2.544197e-01 1 1  ON 26
 eO_7                 1.165809e-01 1 1  ON 27
 eO_8                 2.862976e-02 1 1  ON 28
 eO_9                 1.857339e-02 1 1  ON 29
eH1_0                -1.815844e-01 1 1  ON 30
eH1_1                -1.030537e-01 1 1  ON 31
eH1_2                -6.285600e-02 1 1  ON 32
eH1_3                -2.656867e-02 1 1  ON 33
eH1_4                 1.885983e-02 1 1  ON 34
eH1_5                 3.320953e-02 1 1  ON 35
eH1_6                 7.822547e-02 1 1  ON 36
eH1_7                 1.100595e-01 1 1  ON 37
eH1_8                 9.314793e-02 1 1  ON 38
eH1_9                 2.508202e-02 1 1  ON 39
eH2_0                -1.836182e-01 1 1  ON 40
eH2_1                -1.046137e-01 1 1  ON 41
eH2_2                -6.441147e-02 1 1  ON 42
eH2_3                -2.807943e-02 1 1  ON 43
eH2_4                 1.765317e-02 1 1  ON 44
eH2_5                 3.291289e-02 1 1  ON 45
eH2_6                 8.011482e-02 1 1  ON 46
eH2_7                 1.144348e-01 1 1  ON 47
eH2_8                 9.602255e-02 1 1  ON 48
eH2_9                 2.720018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5150e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7175e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2333
    reference variance = 0.246507
====================================================
  Execution time = 2.0068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1911e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319206319484
                                         uncertainty =       0.007727535066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319206319484
                                         uncertainty =       0.007727535066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399444077
  error estimate for blocks of size 2^( 2) =       0.000409303732
  error estimate for blocks of size 2^( 3) =       0.000418301496
  error estimate for blocks of size 2^( 4) =       0.000424823143
  error estimate for blocks of size 2^( 5) =       0.000429355726
  error estimate for blocks of size 2^( 6) =       0.000432171809
  error estimate for blocks of size 2^( 7) =       0.000432331784

      target function =                  N/A
              le_mean =     -17.216045033205
             les_mean =     296.711317567734
             stat err =       0.000429670615
             autocorr =       1.157069205526
              std dev =       0.564899231664
             le_variance =       0.319111141935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721604503321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216045033205       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216050204734       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216049819665       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216052276483       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216054468179       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216056063845       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216056335578       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216057586194       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216057297599       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216057138645       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216057180451       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 2.858661e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216045033205       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216046887252       residual = 7.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216046843598       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216047678192       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216048688458       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216049052827       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216049032019       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216049240666       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216049169469       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 8.380044e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216045033205       residual = 8.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216045553134       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216045553443       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216045787651       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216046098038       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216046172736       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216046168050       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216046204523       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216046189482       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.204237e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.022384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5704e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.084615e-01 1 1  ON 0
 uu_1                 4.751915e-02 1 1  ON 1
 uu_2                -4.540354e-02 1 1  ON 2
 uu_3                -9.904863e-02 1 1  ON 3
 uu_4                -1.319578e-01 1 1  ON 4
 uu_5                -1.386292e-01 1 1  ON 5
 uu_6                -1.151236e-01 1 1  ON 6
 uu_7                -4.142631e-02 1 1  ON 7
 uu_8                 9.844182e-02 1 1  ON 8
 uu_9                 1.227685e-01 1 1  ON 9
 ud_0                 3.472215e-01 1 1  ON 10
 ud_1                 9.174215e-02 1 1  ON 11
 ud_2                -1.398763e-02 1 1  ON 12
 ud_3                -7.214409e-02 1 1  ON 13
 ud_4                -1.196735e-01 1 1  ON 14
 ud_5                -1.531861e-01 1 1  ON 15
 ud_6                -1.566111e-01 1 1  ON 16
 ud_7                -1.116197e-01 1 1  ON 17
 ud_8                 1.803153e-03 1 1  ON 18
 ud_9                 9.252449e-02 1 1  ON 19
 eO_0                -7.561609e-01 1 1  ON 20
 eO_1                -4.430628e-01 1 1  ON 21
 eO_2                -4.552676e-02 1 1  ON 22
 eO_3                 2.032953e-01 1 1  ON 23
 eO_4                 2.978694e-01 1 1  ON 24
 eO_5                 3.145351e-01 1 1  ON 25
 eO_6                 2.544650e-01 1 1  ON 26
 eO_7                 1.166612e-01 1 1  ON 27
 eO_8                 2.864334e-02 1 1  ON 28
 eO_9                 1.857644e-02 1 1  ON 29
eH1_0                -1.816302e-01 1 1  ON 30
eH1_1                -1.029986e-01 1 1  ON 31
eH1_2                -6.289708e-02 1 1  ON 32
eH1_3                -2.661907e-02 1 1  ON 33
eH1_4                 1.890613e-02 1 1  ON 34
eH1_5                 3.319095e-02 1 1  ON 35
eH1_6                 7.823935e-02 1 1  ON 36
eH1_7                 1.100529e-01 1 1  ON 37
eH1_8                 9.318919e-02 1 1  ON 38
eH1_9                 2.508781e-02 1 1  ON 39
eH2_0                -1.836409e-01 1 1  ON 40
eH2_1                -1.045392e-01 1 1  ON 41
eH2_2                -6.446932e-02 1 1  ON 42
eH2_3                -2.809281e-02 1 1  ON 43
eH2_4                 1.766684e-02 1 1  ON 44
eH2_5                 3.293286e-02 1 1  ON 45
eH2_6                 8.005375e-02 1 1  ON 46
eH2_7                 1.144170e-01 1 1  ON 47
eH2_8                 9.607129e-02 1 1  ON 48
eH2_9                 2.721453e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2252
    reference variance = 0.245334
====================================================
  Execution time = 1.9809e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1390e-01
  Total weights = 2.0000e+06
  Execution time = 1.8595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313486677687
                                         uncertainty =       0.005319273352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313486677687
                                         uncertainty =       0.005319273352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395865613
  error estimate for blocks of size 2^( 2) =       0.000405660714
  error estimate for blocks of size 2^( 3) =       0.000414396672
  error estimate for blocks of size 2^( 4) =       0.000421508272
  error estimate for blocks of size 2^( 5) =       0.000425532692
  error estimate for blocks of size 2^( 6) =       0.000427819000
  error estimate for blocks of size 2^( 7) =       0.000428763653

      target function =                  N/A
              le_mean =     -17.217091097786
             les_mean =     296.741644879765
             stat err =       0.000425905904
             autocorr =       1.157528693068
              std dev =       0.559838518701
             le_variance =       0.313419167021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314937318255
                                         uncertainty =       0.005321476808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314937318255
                                         uncertainty =       0.005321476808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396780504
  error estimate for blocks of size 2^( 2) =       0.000406512824
  error estimate for blocks of size 2^( 3) =       0.000415182292
  error estimate for blocks of size 2^( 4) =       0.000422248215
  error estimate for blocks of size 2^( 5) =       0.000426271077
  error estimate for blocks of size 2^( 6) =       0.000428577508
  error estimate for blocks of size 2^( 7) =       0.000429540557

      target function =                  N/A
              le_mean =     -17.217088625879
             les_mean =     296.743010130941
             stat err =       0.000426659339
             autocorr =       1.156276935858
              std dev =       0.561132370317
             le_variance =       0.314869537018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314454858691
                                         uncertainty =       0.005318158201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314454858691
                                         uncertainty =       0.005318158201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396476444
  error estimate for blocks of size 2^( 2) =       0.000406226941
  error estimate for blocks of size 2^( 3) =       0.000414916812
  error estimate for blocks of size 2^( 4) =       0.000421996743
  error estimate for blocks of size 2^( 5) =       0.000426020912
  error estimate for blocks of size 2^( 6) =       0.000428323565
  error estimate for blocks of size 2^( 7) =       0.000429279302

      target function =                  N/A
              le_mean =     -17.217088579816
             les_mean =     296.742526149729
             stat err =       0.000426405130
             autocorr =       1.156671575427
              std dev =       0.560702364621
             le_variance =       0.314387141692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313616458766
                                         uncertainty =       0.005318931118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313616458766
                                         uncertainty =       0.005318931118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395947546
  error estimate for blocks of size 2^( 2) =       0.000405736162
  error estimate for blocks of size 2^( 3) =       0.000414465543
  error estimate for blocks of size 2^( 4) =       0.000421572654
  error estimate for blocks of size 2^( 5) =       0.000425597060
  error estimate for blocks of size 2^( 6) =       0.000427885800
  error estimate for blocks of size 2^( 7) =       0.000428831844

      target function =                  N/A
              le_mean =     -17.217090310188
             les_mean =     296.741747510166
             stat err =       0.000425971839
             autocorr =       1.157407968858
              std dev =       0.559954389012
             le_variance =       0.313548917774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217091097786        initial  <--
     3.9062e-01     3.9062e+00             2.8587e-03       -17.217088625879
     1.5625e+00     1.5625e+01             8.3800e-04       -17.217088579816
     6.2500e+00     6.2500e+01             2.2042e-04       -17.217090310188

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1993
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.083511e-01 1 1  ON 0
 uu_1                 4.740093e-02 1 1  ON 1
 uu_2                -4.534093e-02 1 1  ON 2
 uu_3                -9.900273e-02 1 1  ON 3
 uu_4                -1.319145e-01 1 1  ON 4
 uu_5                -1.386097e-01 1 1  ON 5
 uu_6                -1.150842e-01 1 1  ON 6
 uu_7                -4.137700e-02 1 1  ON 7
 uu_8                 9.848281e-02 1 1  ON 8
 uu_9                 1.227310e-01 1 1  ON 9
 ud_0                 3.467397e-01 1 1  ON 10
 ud_1                 9.147009e-02 1 1  ON 11
 ud_2                -1.374767e-02 1 1  ON 12
 ud_3                -7.178201e-02 1 1  ON 13
 ud_4                -1.195686e-01 1 1  ON 14
 ud_5                -1.532295e-01 1 1  ON 15
 ud_6                -1.566121e-01 1 1  ON 16
 ud_7                -1.116034e-01 1 1  ON 17
 ud_8                 1.893211e-03 1 1  ON 18
 ud_9                 9.253041e-02 1 1  ON 19
 eO_0                -7.553229e-01 1 1  ON 20
 eO_1                -4.427052e-01 1 1  ON 21
 eO_2                -4.601118e-02 1 1  ON 22
 eO_3                 2.029351e-01 1 1  ON 23
 eO_4                 2.977194e-01 1 1  ON 24
 eO_5                 3.144773e-01 1 1  ON 25
 eO_6                 2.544197e-01 1 1  ON 26
 eO_7                 1.165809e-01 1 1  ON 27
 eO_8                 2.862976e-02 1 1  ON 28
 eO_9                 1.857339e-02 1 1  ON 29
eH1_0                -1.815844e-01 1 1  ON 30
eH1_1                -1.030537e-01 1 1  ON 31
eH1_2                -6.285600e-02 1 1  ON 32
eH1_3                -2.656867e-02 1 1  ON 33
eH1_4                 1.885983e-02 1 1  ON 34
eH1_5                 3.320953e-02 1 1  ON 35
eH1_6                 7.822547e-02 1 1  ON 36
eH1_7                 1.100595e-01 1 1  ON 37
eH1_8                 9.314793e-02 1 1  ON 38
eH1_9                 2.508202e-02 1 1  ON 39
eH2_0                -1.836182e-01 1 1  ON 40
eH2_1                -1.046137e-01 1 1  ON 41
eH2_2                -6.441147e-02 1 1  ON 42
eH2_3                -2.807943e-02 1 1  ON 43
eH2_4                 1.765317e-02 1 1  ON 44
eH2_5                 3.291289e-02 1 1  ON 45
eH2_6                 8.011482e-02 1 1  ON 46
eH2_7                 1.144348e-01 1 1  ON 47
eH2_8                 9.602255e-02 1 1  ON 48
eH2_9                 2.720018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7184e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2785
    reference variance = 0.457503
====================================================
  Execution time = 2.2011e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1809e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317921601239
                                         uncertainty =       0.005225071922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317921601239
                                         uncertainty =       0.005225071922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398803376
  error estimate for blocks of size 2^( 2) =       0.000408725873
  error estimate for blocks of size 2^( 3) =       0.000417362631
  error estimate for blocks of size 2^( 4) =       0.000422124366
  error estimate for blocks of size 2^( 5) =       0.000426992924
  error estimate for blocks of size 2^( 6) =       0.000429844525
  error estimate for blocks of size 2^( 7) =       0.000430052253

      target function =                  N/A
              le_mean =     -17.216208617068
             les_mean =     296.715927253075
             stat err =       0.000427253517
             autocorr =       1.147766751812
              std dev =       0.563993143315
             le_variance =       0.318088265706


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721620861707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216208617068       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216210335054       residual = 6.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216211061731       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216211677223       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216213471552       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216214060683       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216213972476       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216213926916       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216213891577       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.453443e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216208617068       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216209072030       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216209263951       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216209425909       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216209895679       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216210039489       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216210017443       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216210011656       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216210003294       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 8.820841e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216208617068       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216208732520       residual = 6.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216208781199       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216208822257       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216208941087       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216208976731       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216208971319       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216208970232       residual = 9.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 2.209550e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025306 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7494e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.083572e-01 1 1  ON 0
 uu_1                 4.741409e-02 1 1  ON 1
 uu_2                -4.534677e-02 1 1  ON 2
 uu_3                -9.900527e-02 1 1  ON 3
 uu_4                -1.319167e-01 1 1  ON 4
 uu_5                -1.386089e-01 1 1  ON 5
 uu_6                -1.150857e-01 1 1  ON 6
 uu_7                -4.138649e-02 1 1  ON 7
 uu_8                 9.847694e-02 1 1  ON 8
 uu_9                 1.227346e-01 1 1  ON 9
 ud_0                 3.468051e-01 1 1  ON 10
 ud_1                 9.149768e-02 1 1  ON 11
 ud_2                -1.377984e-02 1 1  ON 12
 ud_3                -7.182147e-02 1 1  ON 13
 ud_4                -1.195861e-01 1 1  ON 14
 ud_5                -1.532202e-01 1 1  ON 15
 ud_6                -1.566106e-01 1 1  ON 16
 ud_7                -1.116115e-01 1 1  ON 17
 ud_8                 1.883207e-03 1 1  ON 18
 ud_9                 9.253051e-02 1 1  ON 19
 eO_0                -7.554111e-01 1 1  ON 20
 eO_1                -4.427446e-01 1 1  ON 21
 eO_2                -4.595856e-02 1 1  ON 22
 eO_3                 2.029796e-01 1 1  ON 23
 eO_4                 2.977327e-01 1 1  ON 24
 eO_5                 3.144797e-01 1 1  ON 25
 eO_6                 2.544261e-01 1 1  ON 26
 eO_7                 1.165876e-01 1 1  ON 27
 eO_8                 2.863054e-02 1 1  ON 28
 eO_9                 1.857394e-02 1 1  ON 29
eH1_0                -1.815923e-01 1 1  ON 30
eH1_1                -1.030569e-01 1 1  ON 31
eH1_2                -6.286030e-02 1 1  ON 32
eH1_3                -2.656638e-02 1 1  ON 33
eH1_4                 1.886869e-02 1 1  ON 34
eH1_5                 3.321211e-02 1 1  ON 35
eH1_6                 7.822250e-02 1 1  ON 36
eH1_7                 1.100583e-01 1 1  ON 37
eH1_8                 9.315238e-02 1 1  ON 38
eH1_9                 2.508302e-02 1 1  ON 39
eH2_0                -1.836193e-01 1 1  ON 40
eH2_1                -1.046114e-01 1 1  ON 41
eH2_2                -6.441879e-02 1 1  ON 42
eH2_3                -2.806705e-02 1 1  ON 43
eH2_4                 1.765455e-02 1 1  ON 44
eH2_5                 3.290465e-02 1 1  ON 45
eH2_6                 8.010873e-02 1 1  ON 46
eH2_7                 1.144341e-01 1 1  ON 47
eH2_8                 9.602769e-02 1 1  ON 48
eH2_9                 2.720205e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2662
    reference variance = 0.51601
====================================================
  Execution time = 1.9979e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1569e-01
  Total weights = 2.0000e+06
  Execution time = 1.8545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315717453350
                                         uncertainty =       0.003638528150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315717453350
                                         uncertainty =       0.003638528150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397258528
  error estimate for blocks of size 2^( 2) =       0.000406985594
  error estimate for blocks of size 2^( 3) =       0.000415638417
  error estimate for blocks of size 2^( 4) =       0.000422143855
  error estimate for blocks of size 2^( 5) =       0.000426135520
  error estimate for blocks of size 2^( 6) =       0.000429222532
  error estimate for blocks of size 2^( 7) =       0.000431387284

      target function =                  N/A
              le_mean =     -17.216282145439
             les_mean =     296.715999430212
             stat err =       0.000427222298
             autocorr =       1.156541882006
              std dev =       0.561808398536
             le_variance =       0.315628676665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957882884
                                         uncertainty =       0.003640534827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957882884
                                         uncertainty =       0.003640534827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397409768
  error estimate for blocks of size 2^( 2) =       0.000407124438
  error estimate for blocks of size 2^( 3) =       0.000415765467
  error estimate for blocks of size 2^( 4) =       0.000422263139
  error estimate for blocks of size 2^( 5) =       0.000426249325
  error estimate for blocks of size 2^( 6) =       0.000429331662
  error estimate for blocks of size 2^( 7) =       0.000431494706

      target function =                  N/A
              le_mean =     -17.216282582638
             les_mean =     296.716254854479
             stat err =       0.000427334708
             autocorr =       1.156270006705
              std dev =       0.562022283514
             le_variance =       0.315869047166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315843569990
                                         uncertainty =       0.003639567359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315843569990
                                         uncertainty =       0.003639567359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397337868
  error estimate for blocks of size 2^( 2) =       0.000407058377
  error estimate for blocks of size 2^( 3) =       0.000415704953
  error estimate for blocks of size 2^( 4) =       0.000422206283
  error estimate for blocks of size 2^( 5) =       0.000426195040
  error estimate for blocks of size 2^( 6) =       0.000429279568
  error estimate for blocks of size 2^( 7) =       0.000431443342

      target function =                  N/A
              le_mean =     -17.216282355127
             les_mean =     296.716132736025
             stat err =       0.000427281058
             autocorr =       1.156398093588
              std dev =       0.561920601542
             le_variance =       0.315754762437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315733437878
                                         uncertainty =       0.003638659812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315733437878
                                         uncertainty =       0.003638659812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397268585
  error estimate for blocks of size 2^( 2) =       0.000406994812
  error estimate for blocks of size 2^( 3) =       0.000415646839
  error estimate for blocks of size 2^( 4) =       0.000422151758
  error estimate for blocks of size 2^( 5) =       0.000426143051
  error estimate for blocks of size 2^( 6) =       0.000429229746
  error estimate for blocks of size 2^( 7) =       0.000431394372

      target function =                  N/A
              le_mean =     -17.216282165434
             les_mean =     296.716016099233
             stat err =       0.000427229732
             autocorr =       1.156523576187
              std dev =       0.561822620778
             le_variance =       0.315644657217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216282145439        initial
     3.9062e+00     3.9062e+01             3.4534e-04       -17.216282582638  <--
     1.5625e+01     1.5625e+02             8.8208e-05       -17.216282355127
     6.2500e+01     6.2500e+02             2.2096e-05       -17.216282165434

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.9325e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.083768e-01 1 1  ON 0
 uu_1                 4.745082e-02 1 1  ON 1
 uu_2                -4.536216e-02 1 1  ON 2
 uu_3                -9.901366e-02 1 1  ON 3
 uu_4                -1.319240e-01 1 1  ON 4
 uu_5                -1.386066e-01 1 1  ON 5
 uu_6                -1.150898e-01 1 1  ON 6
 uu_7                -4.141447e-02 1 1  ON 7
 uu_8                 9.845956e-02 1 1  ON 8
 uu_9                 1.227454e-01 1 1  ON 9
 ud_0                 3.469903e-01 1 1  ON 10
 ud_1                 9.157371e-02 1 1  ON 11
 ud_2                -1.386579e-02 1 1  ON 12
 ud_3                -7.193496e-02 1 1  ON 13
 ud_4                -1.196381e-01 1 1  ON 14
 ud_5                -1.531931e-01 1 1  ON 15
 ud_6                -1.566045e-01 1 1  ON 16
 ud_7                -1.116347e-01 1 1  ON 17
 ud_8                 1.853581e-03 1 1  ON 18
 ud_9                 9.253084e-02 1 1  ON 19
 eO_0                -7.556683e-01 1 1  ON 20
 eO_1                -4.428592e-01 1 1  ON 21
 eO_2                -4.581270e-02 1 1  ON 22
 eO_3                 2.031126e-01 1 1  ON 23
 eO_4                 2.977735e-01 1 1  ON 24
 eO_5                 3.144872e-01 1 1  ON 25
 eO_6                 2.544456e-01 1 1  ON 26
 eO_7                 1.166076e-01 1 1  ON 27
 eO_8                 2.863289e-02 1 1  ON 28
 eO_9                 1.857558e-02 1 1  ON 29
eH1_0                -1.816163e-01 1 1  ON 30
eH1_1                -1.030671e-01 1 1  ON 31
eH1_2                -6.287191e-02 1 1  ON 32
eH1_3                -2.656003e-02 1 1  ON 33
eH1_4                 1.889399e-02 1 1  ON 34
eH1_5                 3.322062e-02 1 1  ON 35
eH1_6                 7.821406e-02 1 1  ON 36
eH1_7                 1.100551e-01 1 1  ON 37
eH1_8                 9.316568e-02 1 1  ON 38
eH1_9                 2.508602e-02 1 1  ON 39
eH2_0                -1.836228e-01 1 1  ON 40
eH2_1                -1.046060e-01 1 1  ON 41
eH2_2                -6.443790e-02 1 1  ON 42
eH2_3                -2.803236e-02 1 1  ON 43
eH2_4                 1.765875e-02 1 1  ON 44
eH2_5                 3.288079e-02 1 1  ON 45
eH2_6                 8.009083e-02 1 1  ON 46
eH2_7                 1.144321e-01 1 1  ON 47
eH2_8                 9.604300e-02 1 1  ON 48
eH2_9                 2.720764e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6825e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.143
    reference variance = 0.171959
====================================================
  Execution time = 1.9967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1273e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312807752673
                                         uncertainty =       0.003267415020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312807752673
                                         uncertainty =       0.003267415020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395430535
  error estimate for blocks of size 2^( 2) =       0.000405499990
  error estimate for blocks of size 2^( 3) =       0.000413972106
  error estimate for blocks of size 2^( 4) =       0.000419879538
  error estimate for blocks of size 2^( 5) =       0.000424385482
  error estimate for blocks of size 2^( 6) =       0.000425412626
  error estimate for blocks of size 2^( 7) =       0.000425358113

      target function =                  N/A
              le_mean =     -17.215986545093
             les_mean =     296.702923181082
             stat err =       0.000423758940
             autocorr =       1.148410993594
              std dev =       0.559223226123
             le_variance =       0.312730616635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721598654509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215986545093       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215992877087       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215996231790       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215997660802       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215998337434       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215999538780       residual = 7.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215999656946       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215999583217       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215999506239       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.226888e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215986545093       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215988484431       residual = 5.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215989500604       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215989986026       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215990186348       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215990489512       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215990467228       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215990447490       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215990437495       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.290335e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215986545093       residual = 5.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215987058839       residual = 5.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215987327883       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215987461554       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215987515322       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215987588708       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215987579819       residual = 7.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215987575465       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215987573333       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 8.385249e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5498e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.084536e-01 1 1  ON 0
 uu_1                 4.750193e-02 1 1  ON 1
 uu_2                -4.539237e-02 1 1  ON 2
 uu_3                -9.903782e-02 1 1  ON 3
 uu_4                -1.319569e-01 1 1  ON 4
 uu_5                -1.386380e-01 1 1  ON 5
 uu_6                -1.150751e-01 1 1  ON 6
 uu_7                -4.144253e-02 1 1  ON 7
 uu_8                 9.843602e-02 1 1  ON 8
 uu_9                 1.227561e-01 1 1  ON 9
 ud_0                 3.472026e-01 1 1  ON 10
 ud_1                 9.166441e-02 1 1  ON 11
 ud_2                -1.398200e-02 1 1  ON 12
 ud_3                -7.207816e-02 1 1  ON 13
 ud_4                -1.196814e-01 1 1  ON 14
 ud_5                -1.531861e-01 1 1  ON 15
 ud_6                -1.565751e-01 1 1  ON 16
 ud_7                -1.116406e-01 1 1  ON 17
 ud_8                 1.812725e-03 1 1  ON 18
 ud_9                 9.252684e-02 1 1  ON 19
 eO_0                -7.559973e-01 1 1  ON 20
 eO_1                -4.430124e-01 1 1  ON 21
 eO_2                -4.563254e-02 1 1  ON 22
 eO_3                 2.032831e-01 1 1  ON 23
 eO_4                 2.978194e-01 1 1  ON 24
 eO_5                 3.145022e-01 1 1  ON 25
 eO_6                 2.544845e-01 1 1  ON 26
 eO_7                 1.166358e-01 1 1  ON 27
 eO_8                 2.863336e-02 1 1  ON 28
 eO_9                 1.857695e-02 1 1  ON 29
eH1_0                -1.816338e-01 1 1  ON 30
eH1_1                -1.030632e-01 1 1  ON 31
eH1_2                -6.291389e-02 1 1  ON 32
eH1_3                -2.653334e-02 1 1  ON 33
eH1_4                 1.891223e-02 1 1  ON 34
eH1_5                 3.322796e-02 1 1  ON 35
eH1_6                 7.819556e-02 1 1  ON 36
eH1_7                 1.100549e-01 1 1  ON 37
eH1_8                 9.318278e-02 1 1  ON 38
eH1_9                 2.508967e-02 1 1  ON 39
eH2_0                -1.836361e-01 1 1  ON 40
eH2_1                -1.045990e-01 1 1  ON 41
eH2_2                -6.444495e-02 1 1  ON 42
eH2_3                -2.801622e-02 1 1  ON 43
eH2_4                 1.766809e-02 1 1  ON 44
eH2_5                 3.287657e-02 1 1  ON 45
eH2_6                 8.006607e-02 1 1  ON 46
eH2_7                 1.144266e-01 1 1  ON 47
eH2_8                 9.606093e-02 1 1  ON 48
eH2_9                 2.721072e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1542
    reference variance = 0.654288
====================================================
  Execution time = 1.9598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1796e-01
  Total weights = 2.0000e+06
  Execution time = 1.8432e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317756645789
                                         uncertainty =       0.003561113583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317756645789
                                         uncertainty =       0.003561113583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398578954
  error estimate for blocks of size 2^( 2) =       0.000408575565
  error estimate for blocks of size 2^( 3) =       0.000416815145
  error estimate for blocks of size 2^( 4) =       0.000423799968
  error estimate for blocks of size 2^( 5) =       0.000428483219
  error estimate for blocks of size 2^( 6) =       0.000430878070
  error estimate for blocks of size 2^( 7) =       0.000433949424

      target function =                  N/A
              le_mean =     -17.216662761966
             les_mean =     296.731206866237
             stat err =       0.000429277670
             autocorr =       1.159972970783
              std dev =       0.563675763052
             le_variance =       0.317730365852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318555460022
                                         uncertainty =       0.003565752984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318555460022
                                         uncertainty =       0.003565752984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399079547
  error estimate for blocks of size 2^( 2) =       0.000409043218
  error estimate for blocks of size 2^( 3) =       0.000417249309
  error estimate for blocks of size 2^( 4) =       0.000424209551
  error estimate for blocks of size 2^( 5) =       0.000428886520
  error estimate for blocks of size 2^( 6) =       0.000431264453
  error estimate for blocks of size 2^( 7) =       0.000434350990

      target function =                  N/A
              le_mean =     -17.216663640065
             les_mean =     296.732035705393
             stat err =       0.000429677878
             autocorr =       1.159223159553
              std dev =       0.564383707690
             le_variance =       0.318528969506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318227603169
                                         uncertainty =       0.003563787999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318227603169
                                         uncertainty =       0.003563787999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398874181
  error estimate for blocks of size 2^( 2) =       0.000408850801
  error estimate for blocks of size 2^( 3) =       0.000417070146
  error estimate for blocks of size 2^( 4) =       0.000424040348
  error estimate for blocks of size 2^( 5) =       0.000428719974
  error estimate for blocks of size 2^( 6) =       0.000431104589
  error estimate for blocks of size 2^( 7) =       0.000434185523

      target function =                  N/A
              le_mean =     -17.216662850640
             les_mean =     296.731680778295
             stat err =       0.000429512609
             autocorr =       1.159524643689
              std dev =       0.564093276664
             le_variance =       0.318201224778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317817888978
                                         uncertainty =       0.003561457899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317817888978
                                         uncertainty =       0.003561457899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398617359
  error estimate for blocks of size 2^( 2) =       0.000408611298
  error estimate for blocks of size 2^( 3) =       0.000416848183
  error estimate for blocks of size 2^( 4) =       0.000423831074
  error estimate for blocks of size 2^( 5) =       0.000428513850
  error estimate for blocks of size 2^( 6) =       0.000430907347
  error estimate for blocks of size 2^( 7) =       0.000433979984

      target function =                  N/A
              le_mean =     -17.216662698105
             les_mean =     296.731265898855
             stat err =       0.000429308064
             autocorr =       1.159913698868
              std dev =       0.563730074978
             le_variance =       0.317791597435


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216662761966        initial
     9.7656e-01     9.7656e+00             1.2269e-03       -17.216663640065  <--
     3.9062e+00     3.9062e+01             3.2903e-04       -17.216662850640
     1.5625e+01     1.5625e+02             8.3852e-05       -17.216662698105

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.8937e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.086701e-01 1 1  ON 0
 uu_1                 4.762315e-02 1 1  ON 1
 uu_2                -4.545000e-02 1 1  ON 2
 uu_3                -9.911390e-02 1 1  ON 3
 uu_4                -1.320537e-01 1 1  ON 4
 uu_5                -1.387250e-01 1 1  ON 5
 uu_6                -1.150312e-01 1 1  ON 6
 uu_7                -4.152034e-02 1 1  ON 7
 uu_8                 9.836898e-02 1 1  ON 8
 uu_9                 1.227873e-01 1 1  ON 9
 ud_0                 3.477133e-01 1 1  ON 10
 ud_1                 9.186824e-02 1 1  ON 11
 ud_2                -1.422397e-02 1 1  ON 12
 ud_3                -7.243789e-02 1 1  ON 13
 ud_4                -1.198228e-01 1 1  ON 14
 ud_5                -1.531628e-01 1 1  ON 15
 ud_6                -1.564746e-01 1 1  ON 16
 ud_7                -1.116489e-01 1 1  ON 17
 ud_8                 1.696545e-03 1 1  ON 18
 ud_9                 9.251567e-02 1 1  ON 19
 eO_0                -7.568952e-01 1 1  ON 20
 eO_1                -4.434248e-01 1 1  ON 21
 eO_2                -4.522688e-02 1 1  ON 22
 eO_3                 2.037789e-01 1 1  ON 23
 eO_4                 2.979690e-01 1 1  ON 24
 eO_5                 3.145523e-01 1 1  ON 25
 eO_6                 2.545999e-01 1 1  ON 26
 eO_7                 1.167186e-01 1 1  ON 27
 eO_8                 2.863488e-02 1 1  ON 28
 eO_9                 1.858094e-02 1 1  ON 29
eH1_0                -1.816882e-01 1 1  ON 30
eH1_1                -1.030698e-01 1 1  ON 31
eH1_2                -6.300518e-02 1 1  ON 32
eH1_3                -2.647529e-02 1 1  ON 33
eH1_4                 1.895930e-02 1 1  ON 34
eH1_5                 3.325912e-02 1 1  ON 35
eH1_6                 7.814618e-02 1 1  ON 36
eH1_7                 1.100561e-01 1 1  ON 37
eH1_8                 9.323293e-02 1 1  ON 38
eH1_9                 2.510037e-02 1 1  ON 39
eH2_0                -1.836766e-01 1 1  ON 40
eH2_1                -1.045906e-01 1 1  ON 41
eH2_2                -6.445063e-02 1 1  ON 42
eH2_3                -2.797582e-02 1 1  ON 43
eH2_4                 1.768809e-02 1 1  ON 44
eH2_5                 3.287130e-02 1 1  ON 45
eH2_6                 7.999776e-02 1 1  ON 46
eH2_7                 1.144120e-01 1 1  ON 47
eH2_8                 9.611345e-02 1 1  ON 48
eH2_9                 2.721975e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4442e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2289
    reference variance = 0.167486
====================================================
  Execution time = 2.0317e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1744e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317412008604
                                         uncertainty =       0.004895651108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317412008604
                                         uncertainty =       0.004895651108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398396190
  error estimate for blocks of size 2^( 2) =       0.000408232907
  error estimate for blocks of size 2^( 3) =       0.000416816937
  error estimate for blocks of size 2^( 4) =       0.000423488844
  error estimate for blocks of size 2^( 5) =       0.000427681022
  error estimate for blocks of size 2^( 6) =       0.000431045958
  error estimate for blocks of size 2^( 7) =       0.000432888708

      target function =                  N/A
              le_mean =     -17.216150815047
             les_mean =     296.713287775875
             stat err =       0.000428776133
             autocorr =       1.158326130247
              std dev =       0.563417294862
             le_variance =       0.317439048150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615081505e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216150815047       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216154066222       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216156380087       residual = 9.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216158325104       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216162016895       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216163956607       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216162991216       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216163144087       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216164355599       residual = 8.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216164774410       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216164631288       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 3.404413e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216150815047       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216152110880       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216153173007       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216153618533       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216155093730       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216155629532       residual = 7.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216155160014       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216155194966       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216155381028       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.020154e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216150815047       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216151195536       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216151531053       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216151644428       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216152062387       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216152194110       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216152068292       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216152072771       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216152099547       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 2.689496e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031911 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5884e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.088299e-01 1 1  ON 0
 uu_1                 4.781534e-02 1 1  ON 1
 uu_2                -4.535624e-02 1 1  ON 2
 uu_3                -9.920759e-02 1 1  ON 3
 uu_4                -1.319764e-01 1 1  ON 4
 uu_5                -1.388271e-01 1 1  ON 5
 uu_6                -1.151831e-01 1 1  ON 6
 uu_7                -4.167485e-02 1 1  ON 7
 uu_8                 9.827647e-02 1 1  ON 8
 uu_9                 1.228222e-01 1 1  ON 9
 ud_0                 3.481840e-01 1 1  ON 10
 ud_1                 9.215301e-02 1 1  ON 11
 ud_2                -1.435100e-02 1 1  ON 12
 ud_3                -7.285451e-02 1 1  ON 13
 ud_4                -1.200099e-01 1 1  ON 14
 ud_5                -1.531000e-01 1 1  ON 15
 ud_6                -1.563682e-01 1 1  ON 16
 ud_7                -1.117005e-01 1 1  ON 17
 ud_8                 1.525750e-03 1 1  ON 18
 ud_9                 9.249874e-02 1 1  ON 19
 eO_0                -7.579153e-01 1 1  ON 20
 eO_1                -4.440478e-01 1 1  ON 21
 eO_2                -4.479125e-02 1 1  ON 22
 eO_3                 2.043477e-01 1 1  ON 23
 eO_4                 2.982934e-01 1 1  ON 24
 eO_5                 3.146672e-01 1 1  ON 25
 eO_6                 2.546693e-01 1 1  ON 26
 eO_7                 1.168278e-01 1 1  ON 27
 eO_8                 2.864822e-02 1 1  ON 28
 eO_9                 1.858422e-02 1 1  ON 29
eH1_0                -1.818057e-01 1 1  ON 30
eH1_1                -1.031026e-01 1 1  ON 31
eH1_2                -6.300506e-02 1 1  ON 32
eH1_3                -2.643433e-02 1 1  ON 33
eH1_4                 1.908574e-02 1 1  ON 34
eH1_5                 3.333134e-02 1 1  ON 35
eH1_6                 7.805263e-02 1 1  ON 36
eH1_7                 1.099964e-01 1 1  ON 37
eH1_8                 9.327407e-02 1 1  ON 38
eH1_9                 2.511922e-02 1 1  ON 39
eH2_0                -1.837149e-01 1 1  ON 40
eH2_1                -1.046523e-01 1 1  ON 41
eH2_2                -6.452355e-02 1 1  ON 42
eH2_3                -2.790977e-02 1 1  ON 43
eH2_4                 1.775123e-02 1 1  ON 44
eH2_5                 3.284773e-02 1 1  ON 45
eH2_6                 7.996936e-02 1 1  ON 46
eH2_7                 1.144227e-01 1 1  ON 47
eH2_8                 9.617996e-02 1 1  ON 48
eH2_9                 2.723462e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.252812
====================================================
  Execution time = 2.1870e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1227e-01
  Total weights = 2.0000e+06
  Execution time = 1.8486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312013374294
                                         uncertainty =       0.002996202627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312013374294
                                         uncertainty =       0.002996202627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394889048
  error estimate for blocks of size 2^( 2) =       0.000404283137
  error estimate for blocks of size 2^( 3) =       0.000413366633
  error estimate for blocks of size 2^( 4) =       0.000419132348
  error estimate for blocks of size 2^( 5) =       0.000421966497
  error estimate for blocks of size 2^( 6) =       0.000422761296
  error estimate for blocks of size 2^( 7) =       0.000425278327

      target function =                  N/A
              le_mean =     -17.216659224392
             les_mean =     296.725229413332
             stat err =       0.000422284617
             autocorr =       1.143563656766
              std dev =       0.558457447283
             le_variance =       0.311874720426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313176977577
                                         uncertainty =       0.003006818990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313176977577
                                         uncertainty =       0.003006818990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395624719
  error estimate for blocks of size 2^( 2) =       0.000404965166
  error estimate for blocks of size 2^( 3) =       0.000413992556
  error estimate for blocks of size 2^( 4) =       0.000419717556
  error estimate for blocks of size 2^( 5) =       0.000422526760
  error estimate for blocks of size 2^( 6) =       0.000423315934
  error estimate for blocks of size 2^( 7) =       0.000425820637

      target function =                  N/A
              le_mean =     -17.216657760150
             les_mean =     296.726342109754
             stat err =       0.000422845222
             autocorr =       1.142341666014
              std dev =       0.559497842846
             le_variance =       0.313037836150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312812333413
                                         uncertainty =       0.003003372430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312812333413
                                         uncertainty =       0.003003372430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395394332
  error estimate for blocks of size 2^( 2) =       0.000404749829
  error estimate for blocks of size 2^( 3) =       0.000413793018
  error estimate for blocks of size 2^( 4) =       0.000419530561
  error estimate for blocks of size 2^( 5) =       0.000422347086
  error estimate for blocks of size 2^( 6) =       0.000423136633
  error estimate for blocks of size 2^( 7) =       0.000425641811

      target function =                  N/A
              le_mean =     -17.216658642413
             les_mean =     296.726008008267
             stat err =       0.000422664023
             autocorr =       1.142693314291
              std dev =       0.559172026503
             le_variance =       0.312673355223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312121039326
                                         uncertainty =       0.002997179517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312121039326
                                         uncertainty =       0.002997179517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394957178
  error estimate for blocks of size 2^( 2) =       0.000404345633
  error estimate for blocks of size 2^( 3) =       0.000413423249
  error estimate for blocks of size 2^( 4) =       0.000419184970
  error estimate for blocks of size 2^( 5) =       0.000422016549
  error estimate for blocks of size 2^( 6) =       0.000422810492
  error estimate for blocks of size 2^( 7) =       0.000425325752

      target function =                  N/A
              le_mean =     -17.216658771554
             les_mean =     296.725321444866
             stat err =       0.000422334441
             autocorr =       1.143438933991
              std dev =       0.558553797513
             le_variance =       0.311982344716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216659224392        initial  <--
     2.4414e-01     2.4414e+00             3.4044e-03       -17.216657760150
     9.7656e-01     9.7656e+00             1.0202e-03       -17.216658642413
     3.9062e+00     3.9062e+01             2.6895e-04       -17.216658771554

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2301
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.086701e-01 1 1  ON 0
 uu_1                 4.762315e-02 1 1  ON 1
 uu_2                -4.545000e-02 1 1  ON 2
 uu_3                -9.911390e-02 1 1  ON 3
 uu_4                -1.320537e-01 1 1  ON 4
 uu_5                -1.387250e-01 1 1  ON 5
 uu_6                -1.150312e-01 1 1  ON 6
 uu_7                -4.152034e-02 1 1  ON 7
 uu_8                 9.836898e-02 1 1  ON 8
 uu_9                 1.227873e-01 1 1  ON 9
 ud_0                 3.477133e-01 1 1  ON 10
 ud_1                 9.186824e-02 1 1  ON 11
 ud_2                -1.422397e-02 1 1  ON 12
 ud_3                -7.243789e-02 1 1  ON 13
 ud_4                -1.198228e-01 1 1  ON 14
 ud_5                -1.531628e-01 1 1  ON 15
 ud_6                -1.564746e-01 1 1  ON 16
 ud_7                -1.116489e-01 1 1  ON 17
 ud_8                 1.696545e-03 1 1  ON 18
 ud_9                 9.251567e-02 1 1  ON 19
 eO_0                -7.568952e-01 1 1  ON 20
 eO_1                -4.434248e-01 1 1  ON 21
 eO_2                -4.522688e-02 1 1  ON 22
 eO_3                 2.037789e-01 1 1  ON 23
 eO_4                 2.979690e-01 1 1  ON 24
 eO_5                 3.145523e-01 1 1  ON 25
 eO_6                 2.545999e-01 1 1  ON 26
 eO_7                 1.167186e-01 1 1  ON 27
 eO_8                 2.863488e-02 1 1  ON 28
 eO_9                 1.858094e-02 1 1  ON 29
eH1_0                -1.816882e-01 1 1  ON 30
eH1_1                -1.030698e-01 1 1  ON 31
eH1_2                -6.300518e-02 1 1  ON 32
eH1_3                -2.647529e-02 1 1  ON 33
eH1_4                 1.895930e-02 1 1  ON 34
eH1_5                 3.325912e-02 1 1  ON 35
eH1_6                 7.814618e-02 1 1  ON 36
eH1_7                 1.100561e-01 1 1  ON 37
eH1_8                 9.323293e-02 1 1  ON 38
eH1_9                 2.510037e-02 1 1  ON 39
eH2_0                -1.836766e-01 1 1  ON 40
eH2_1                -1.045906e-01 1 1  ON 41
eH2_2                -6.445063e-02 1 1  ON 42
eH2_3                -2.797582e-02 1 1  ON 43
eH2_4                 1.768809e-02 1 1  ON 44
eH2_5                 3.287130e-02 1 1  ON 45
eH2_6                 7.999776e-02 1 1  ON 46
eH2_7                 1.144120e-01 1 1  ON 47
eH2_8                 9.611345e-02 1 1  ON 48
eH2_9                 2.721975e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7121e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7192e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.3172
    reference variance = 0.571341
====================================================
  Execution time = 2.0182e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1058e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5056e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310464812326
                                         uncertainty =       0.003638020595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310464812326
                                         uncertainty =       0.003638020595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394066997
  error estimate for blocks of size 2^( 2) =       0.000403628666
  error estimate for blocks of size 2^( 3) =       0.000412410021
  error estimate for blocks of size 2^( 4) =       0.000418330302
  error estimate for blocks of size 2^( 5) =       0.000422498239
  error estimate for blocks of size 2^( 6) =       0.000424135510
  error estimate for blocks of size 2^( 7) =       0.000425367277

      target function =                  N/A
              le_mean =     -17.217033580960
             les_mean =     296.736822769007
             stat err =       0.000422582832
             autocorr =       1.149962212369
              std dev =       0.557294891784
             le_variance =       0.310577596408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721703358096e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033580960       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033950599       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217034223558       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217034342842       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217036378639       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217036476159       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217036305456       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217036225626       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217036225878       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 4.521653e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033580960       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033681512       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033756586       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217033781756       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217034322478       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217034344316       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217034305338       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217034286336       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.157954e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217033580960       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217033606664       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033625919       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217033631886       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217033769154       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217033774479       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217033765033       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217033760398       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 2.915043e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5698e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.086823e-01 1 1  ON 0
 uu_1                 4.763600e-02 1 1  ON 1
 uu_2                -4.545083e-02 1 1  ON 2
 uu_3                -9.912492e-02 1 1  ON 3
 uu_4                -1.320425e-01 1 1  ON 4
 uu_5                -1.387287e-01 1 1  ON 5
 uu_6                -1.150470e-01 1 1  ON 6
 uu_7                -4.153235e-02 1 1  ON 7
 uu_8                 9.836294e-02 1 1  ON 8
 uu_9                 1.227934e-01 1 1  ON 9
 ud_0                 3.477818e-01 1 1  ON 10
 ud_1                 9.190993e-02 1 1  ON 11
 ud_2                -1.424941e-02 1 1  ON 12
 ud_3                -7.248905e-02 1 1  ON 13
 ud_4                -1.198378e-01 1 1  ON 14
 ud_5                -1.531545e-01 1 1  ON 15
 ud_6                -1.564839e-01 1 1  ON 16
 ud_7                -1.116571e-01 1 1  ON 17
 ud_8                 1.682623e-03 1 1  ON 18
 ud_9                 9.251518e-02 1 1  ON 19
 eO_0                -7.570110e-01 1 1  ON 20
 eO_1                -4.434865e-01 1 1  ON 21
 eO_2                -4.516734e-02 1 1  ON 22
 eO_3                 2.038384e-01 1 1  ON 23
 eO_4                 2.979970e-01 1 1  ON 24
 eO_5                 3.145595e-01 1 1  ON 25
 eO_6                 2.546072e-01 1 1  ON 26
 eO_7                 1.167311e-01 1 1  ON 27
 eO_8                 2.863695e-02 1 1  ON 28
 eO_9                 1.858164e-02 1 1  ON 29
eH1_0                -1.816948e-01 1 1  ON 30
eH1_1                -1.030763e-01 1 1  ON 31
eH1_2                -6.300626e-02 1 1  ON 32
eH1_3                -2.646703e-02 1 1  ON 33
eH1_4                 1.896623e-02 1 1  ON 34
eH1_5                 3.325420e-02 1 1  ON 35
eH1_6                 7.814116e-02 1 1  ON 36
eH1_7                 1.100545e-01 1 1  ON 37
eH1_8                 9.324022e-02 1 1  ON 38
eH1_9                 2.510263e-02 1 1  ON 39
eH2_0                -1.836836e-01 1 1  ON 40
eH2_1                -1.046016e-01 1 1  ON 41
eH2_2                -6.444758e-02 1 1  ON 42
eH2_3                -2.796743e-02 1 1  ON 43
eH2_4                 1.770212e-02 1 1  ON 44
eH2_5                 3.286875e-02 1 1  ON 45
eH2_6                 7.998633e-02 1 1  ON 46
eH2_7                 1.144085e-01 1 1  ON 47
eH2_8                 9.612091e-02 1 1  ON 48
eH2_9                 2.722175e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1934
    reference variance = 0.166197
====================================================
  Execution time = 1.9764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1795e-01
  Total weights = 2.0000e+06
  Execution time = 1.8451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838502571
                                         uncertainty =       0.003857438293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838502571
                                         uncertainty =       0.003857438293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398677043
  error estimate for blocks of size 2^( 2) =       0.000408423870
  error estimate for blocks of size 2^( 3) =       0.000416875293
  error estimate for blocks of size 2^( 4) =       0.000423403929
  error estimate for blocks of size 2^( 5) =       0.000428805140
  error estimate for blocks of size 2^( 6) =       0.000431845968
  error estimate for blocks of size 2^( 7) =       0.000432548065

      target function =                  N/A
              le_mean =     -17.216968175792
             les_mean =     296.741879777283
             stat err =       0.000429150775
             autocorr =       1.158716910552
              std dev =       0.563814481901
             le_variance =       0.317886770001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318058797048
                                         uncertainty =       0.003859115049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318058797048
                                         uncertainty =       0.003859115049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398815175
  error estimate for blocks of size 2^( 2) =       0.000408550896
  error estimate for blocks of size 2^( 3) =       0.000416990814
  error estimate for blocks of size 2^( 4) =       0.000423512984
  error estimate for blocks of size 2^( 5) =       0.000428911790
  error estimate for blocks of size 2^( 6) =       0.000431950910
  error estimate for blocks of size 2^( 7) =       0.000432645340

      target function =                  N/A
              le_mean =     -17.216968815800
             les_mean =     296.742122132640
             stat err =       0.000429255256
             autocorr =       1.158478273191
              std dev =       0.564009829212
             le_variance =       0.318107087448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317955479313
                                         uncertainty =       0.003858309634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317955479313
                                         uncertainty =       0.003858309634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398750396
  error estimate for blocks of size 2^( 2) =       0.000408491217
  error estimate for blocks of size 2^( 3) =       0.000416936457
  error estimate for blocks of size 2^( 4) =       0.000423461614
  error estimate for blocks of size 2^( 5) =       0.000428861575
  error estimate for blocks of size 2^( 6) =       0.000431901508
  error estimate for blocks of size 2^( 7) =       0.000432599511

      target function =                  N/A
              le_mean =     -17.216968482292
             les_mean =     296.742007318123
             stat err =       0.000429206052
             autocorr =       1.158589048776
              std dev =       0.563918218258
             le_variance =       0.318003756883

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317853253523
                                         uncertainty =       0.003857546891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317853253523
                                         uncertainty =       0.003857546891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398686294
  error estimate for blocks of size 2^( 2) =       0.000408432354
  error estimate for blocks of size 2^( 3) =       0.000416882988
  error estimate for blocks of size 2^( 4) =       0.000423411180
  error estimate for blocks of size 2^( 5) =       0.000428812233
  error estimate for blocks of size 2^( 6) =       0.000431852949
  error estimate for blocks of size 2^( 7) =       0.000432554528

      target function =                  N/A
              le_mean =     -17.216968206919
             les_mean =     296.741895601244
             stat err =       0.000429157722
             autocorr =       1.158700653300
              std dev =       0.563827564188
             le_variance =       0.317901522138


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216968175792        initial
     2.4414e+00     2.4414e+01             4.5217e-04       -17.216968815800  <--
     9.7656e+00     9.7656e+01             1.1580e-04       -17.216968482292
     3.9062e+01     3.9062e+02             2.9150e-05       -17.216968206919

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9093e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.087220e-01 1 1  ON 0
 uu_1                 4.767130e-02 1 1  ON 1
 uu_2                -4.545366e-02 1 1  ON 2
 uu_3                -9.915278e-02 1 1  ON 3
 uu_4                -1.320154e-01 1 1  ON 4
 uu_5                -1.387388e-01 1 1  ON 5
 uu_6                -1.150939e-01 1 1  ON 6
 uu_7                -4.156871e-02 1 1  ON 7
 uu_8                 9.834455e-02 1 1  ON 8
 uu_9                 1.228119e-01 1 1  ON 9
 ud_0                 3.479731e-01 1 1  ON 10
 ud_1                 9.202459e-02 1 1  ON 11
 ud_2                -1.431204e-02 1 1  ON 12
 ud_3                -7.262727e-02 1 1  ON 13
 ud_4                -1.198875e-01 1 1  ON 14
 ud_5                -1.531332e-01 1 1  ON 15
 ud_6                -1.565087e-01 1 1  ON 16
 ud_7                -1.116806e-01 1 1  ON 17
 ud_8                 1.640437e-03 1 1  ON 18
 ud_9                 9.251372e-02 1 1  ON 19
 eO_0                -7.573473e-01 1 1  ON 20
 eO_1                -4.436638e-01 1 1  ON 21
 eO_2                -4.501425e-02 1 1  ON 22
 eO_3                 2.040136e-01 1 1  ON 23
 eO_4                 2.980866e-01 1 1  ON 24
 eO_5                 3.145839e-01 1 1  ON 25
 eO_6                 2.546298e-01 1 1  ON 26
 eO_7                 1.167694e-01 1 1  ON 27
 eO_8                 2.864329e-02 1 1  ON 28
 eO_9                 1.858376e-02 1 1  ON 29
eH1_0                -1.817146e-01 1 1  ON 30
eH1_1                -1.030954e-01 1 1  ON 31
eH1_2                -6.300801e-02 1 1  ON 32
eH1_3                -2.644620e-02 1 1  ON 33
eH1_4                 1.898603e-02 1 1  ON 34
eH1_5                 3.324110e-02 1 1  ON 35
eH1_6                 7.812697e-02 1 1  ON 36
eH1_7                 1.100497e-01 1 1  ON 37
eH1_8                 9.326252e-02 1 1  ON 38
eH1_9                 2.510954e-02 1 1  ON 39
eH2_0                -1.837044e-01 1 1  ON 40
eH2_1                -1.046312e-01 1 1  ON 41
eH2_2                -6.443761e-02 1 1  ON 42
eH2_3                -2.794763e-02 1 1  ON 43
eH2_4                 1.774149e-02 1 1  ON 44
eH2_5                 3.286314e-02 1 1  ON 45
eH2_6                 7.995289e-02 1 1  ON 46
eH2_7                 1.143985e-01 1 1  ON 47
eH2_8                 9.614375e-02 1 1  ON 48
eH2_9                 2.722786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4798e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1515
    reference variance = 0.251017
====================================================
  Execution time = 1.9988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1770e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317775709351
                                         uncertainty =       0.005319898327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317775709351
                                         uncertainty =       0.005319898327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398557838
  error estimate for blocks of size 2^( 2) =       0.000408481174
  error estimate for blocks of size 2^( 3) =       0.000417156615
  error estimate for blocks of size 2^( 4) =       0.000423889997
  error estimate for blocks of size 2^( 5) =       0.000428607751
  error estimate for blocks of size 2^( 6) =       0.000431676135
  error estimate for blocks of size 2^( 7) =       0.000432904457

      target function =                  N/A
              le_mean =     -17.216472983343
             les_mean =     296.724638527776
             stat err =       0.000429269585
             autocorr =       1.160052191836
              std dev =       0.563645899883
             le_variance =       0.317696700455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647298334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216472983343       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216474950274       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216480668578       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216482132928       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216484452969       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216485190972       residual = 9.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216485679389       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216485483005       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216485202221       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216485068786       residual = 6.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 1.596482e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216472983343       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216473603453       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475441640       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216475845432       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216476553652       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216476791639       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216476916329       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216476874413       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216476819377       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 4.361232e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216472983343       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216473149195       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216473645008       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216473750777       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216473934736       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216473997676       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216474030448       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216474022204       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216474011430       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.117506e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.038100 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5553e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.087432e-01 1 1  ON 0
 uu_1                 4.772811e-02 1 1  ON 1
 uu_2                -4.544199e-02 1 1  ON 2
 uu_3                -9.919922e-02 1 1  ON 3
 uu_4                -1.320096e-01 1 1  ON 4
 uu_5                -1.387273e-01 1 1  ON 5
 uu_6                -1.151301e-01 1 1  ON 6
 uu_7                -4.160703e-02 1 1  ON 7
 uu_8                 9.831268e-02 1 1  ON 8
 uu_9                 1.228321e-01 1 1  ON 9
 ud_0                 3.482204e-01 1 1  ON 10
 ud_1                 9.212238e-02 1 1  ON 11
 ud_2                -1.438132e-02 1 1  ON 12
 ud_3                -7.281632e-02 1 1  ON 13
 ud_4                -1.199896e-01 1 1  ON 14
 ud_5                -1.531301e-01 1 1  ON 15
 ud_6                -1.564644e-01 1 1  ON 16
 ud_7                -1.116902e-01 1 1  ON 17
 ud_8                 1.594849e-03 1 1  ON 18
 ud_9                 9.251303e-02 1 1  ON 19
 eO_0                -7.577835e-01 1 1  ON 20
 eO_1                -4.439125e-01 1 1  ON 21
 eO_2                -4.483067e-02 1 1  ON 22
 eO_3                 2.042576e-01 1 1  ON 23
 eO_4                 2.982072e-01 1 1  ON 24
 eO_5                 3.146180e-01 1 1  ON 25
 eO_6                 2.546655e-01 1 1  ON 26
 eO_7                 1.168229e-01 1 1  ON 27
 eO_8                 2.865187e-02 1 1  ON 28
 eO_9                 1.858667e-02 1 1  ON 29
eH1_0                -1.817290e-01 1 1  ON 30
eH1_1                -1.031095e-01 1 1  ON 31
eH1_2                -6.304751e-02 1 1  ON 32
eH1_3                -2.641086e-02 1 1  ON 33
eH1_4                 1.900195e-02 1 1  ON 34
eH1_5                 3.322001e-02 1 1  ON 35
eH1_6                 7.812270e-02 1 1  ON 36
eH1_7                 1.100448e-01 1 1  ON 37
eH1_8                 9.329525e-02 1 1  ON 38
eH1_9                 2.512070e-02 1 1  ON 39
eH2_0                -1.837112e-01 1 1  ON 40
eH2_1                -1.046437e-01 1 1  ON 41
eH2_2                -6.443902e-02 1 1  ON 42
eH2_3                -2.793209e-02 1 1  ON 43
eH2_4                 1.771186e-02 1 1  ON 44
eH2_5                 3.286799e-02 1 1  ON 45
eH2_6                 7.994093e-02 1 1  ON 46
eH2_7                 1.143969e-01 1 1  ON 47
eH2_8                 9.617570e-02 1 1  ON 48
eH2_9                 2.723688e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.3849
    reference variance = 2.47744
====================================================
  Execution time = 1.9626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1985e-01
  Total weights = 2.0000e+06
  Execution time = 1.8580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319479960552
                                         uncertainty =       0.003830020923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319479960552
                                         uncertainty =       0.003830020923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399762233
  error estimate for blocks of size 2^( 2) =       0.000409142460
  error estimate for blocks of size 2^( 3) =       0.000417944558
  error estimate for blocks of size 2^( 4) =       0.000424148530
  error estimate for blocks of size 2^( 5) =       0.000428179412
  error estimate for blocks of size 2^( 6) =       0.000430391320
  error estimate for blocks of size 2^( 7) =       0.000432124313

      target function =                  N/A
              le_mean =     -17.217029195693
             les_mean =     296.745713850982
             stat err =       0.000428710894
             autocorr =       1.150073282415
              std dev =       0.565349171259
             le_variance =       0.319619685443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320235555733
                                         uncertainty =       0.003842739120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320235555733
                                         uncertainty =       0.003842739120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400234671
  error estimate for blocks of size 2^( 2) =       0.000409583230
  error estimate for blocks of size 2^( 3) =       0.000418357004
  error estimate for blocks of size 2^( 4) =       0.000424538614
  error estimate for blocks of size 2^( 5) =       0.000428559916
  error estimate for blocks of size 2^( 6) =       0.000430765753
  error estimate for blocks of size 2^( 7) =       0.000432501252

      target function =                  N/A
              le_mean =     -17.217028795363
             les_mean =     296.746455963400
             stat err =       0.000429091384
             autocorr =       1.149397304441
              std dev =       0.566017299412
             le_variance =       0.320375583233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319950892807
                                         uncertainty =       0.003838005218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319950892807
                                         uncertainty =       0.003838005218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400056756
  error estimate for blocks of size 2^( 2) =       0.000409416816
  error estimate for blocks of size 2^( 3) =       0.000418201161
  error estimate for blocks of size 2^( 4) =       0.000424390966
  error estimate for blocks of size 2^( 5) =       0.000428415853
  error estimate for blocks of size 2^( 6) =       0.000430622963
  error estimate for blocks of size 2^( 7) =       0.000432357521

      target function =                  N/A
              le_mean =     -17.217028385463
             les_mean =     296.746157081794
             stat err =       0.000428946826
             autocorr =       1.149644851776
              std dev =       0.565765690024
             le_variance =       0.320090816008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319542353912
                                         uncertainty =       0.003831090688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319542353912
                                         uncertainty =       0.003831090688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399801266
  error estimate for blocks of size 2^( 2) =       0.000409178750
  error estimate for blocks of size 2^( 3) =       0.000417978446
  error estimate for blocks of size 2^( 4) =       0.000424180498
  error estimate for blocks of size 2^( 5) =       0.000428210583
  error estimate for blocks of size 2^( 6) =       0.000430421794
  error estimate for blocks of size 2^( 7) =       0.000432155000

      target function =                  N/A
              le_mean =     -17.217029000492
             les_mean =     296.745769549184
             stat err =       0.000428741969
             autocorr =       1.150015422925
              std dev =       0.565404373199
             le_variance =       0.319682105233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217029195693        initial  <--
     6.1035e-01     6.1035e+00             1.5965e-03       -17.217028795363
     2.4414e+00     2.4414e+01             4.3612e-04       -17.217028385463
     9.7656e+00     9.7656e+01             1.1175e-04       -17.217029000492

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0073
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.087220e-01 1 1  ON 0
 uu_1                 4.767130e-02 1 1  ON 1
 uu_2                -4.545366e-02 1 1  ON 2
 uu_3                -9.915278e-02 1 1  ON 3
 uu_4                -1.320154e-01 1 1  ON 4
 uu_5                -1.387388e-01 1 1  ON 5
 uu_6                -1.150939e-01 1 1  ON 6
 uu_7                -4.156871e-02 1 1  ON 7
 uu_8                 9.834455e-02 1 1  ON 8
 uu_9                 1.228119e-01 1 1  ON 9
 ud_0                 3.479731e-01 1 1  ON 10
 ud_1                 9.202459e-02 1 1  ON 11
 ud_2                -1.431204e-02 1 1  ON 12
 ud_3                -7.262727e-02 1 1  ON 13
 ud_4                -1.198875e-01 1 1  ON 14
 ud_5                -1.531332e-01 1 1  ON 15
 ud_6                -1.565087e-01 1 1  ON 16
 ud_7                -1.116806e-01 1 1  ON 17
 ud_8                 1.640437e-03 1 1  ON 18
 ud_9                 9.251372e-02 1 1  ON 19
 eO_0                -7.573473e-01 1 1  ON 20
 eO_1                -4.436638e-01 1 1  ON 21
 eO_2                -4.501425e-02 1 1  ON 22
 eO_3                 2.040136e-01 1 1  ON 23
 eO_4                 2.980866e-01 1 1  ON 24
 eO_5                 3.145839e-01 1 1  ON 25
 eO_6                 2.546298e-01 1 1  ON 26
 eO_7                 1.167694e-01 1 1  ON 27
 eO_8                 2.864329e-02 1 1  ON 28
 eO_9                 1.858376e-02 1 1  ON 29
eH1_0                -1.817146e-01 1 1  ON 30
eH1_1                -1.030954e-01 1 1  ON 31
eH1_2                -6.300801e-02 1 1  ON 32
eH1_3                -2.644620e-02 1 1  ON 33
eH1_4                 1.898603e-02 1 1  ON 34
eH1_5                 3.324110e-02 1 1  ON 35
eH1_6                 7.812697e-02 1 1  ON 36
eH1_7                 1.100497e-01 1 1  ON 37
eH1_8                 9.326252e-02 1 1  ON 38
eH1_9                 2.510954e-02 1 1  ON 39
eH2_0                -1.837044e-01 1 1  ON 40
eH2_1                -1.046312e-01 1 1  ON 41
eH2_2                -6.443761e-02 1 1  ON 42
eH2_3                -2.794763e-02 1 1  ON 43
eH2_4                 1.774149e-02 1 1  ON 44
eH2_5                 3.286314e-02 1 1  ON 45
eH2_6                 7.995289e-02 1 1  ON 46
eH2_7                 1.143985e-01 1 1  ON 47
eH2_8                 9.614375e-02 1 1  ON 48
eH2_9                 2.722786e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1482
    reference variance = 0.377658
====================================================
  Execution time = 2.0272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1993e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4629e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320034411644
                                         uncertainty =       0.005084676689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320034411644
                                         uncertainty =       0.005084676689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399957241
  error estimate for blocks of size 2^( 2) =       0.000409553014
  error estimate for blocks of size 2^( 3) =       0.000417981833
  error estimate for blocks of size 2^( 4) =       0.000424530202
  error estimate for blocks of size 2^( 5) =       0.000428757164
  error estimate for blocks of size 2^( 6) =       0.000431106027
  error estimate for blocks of size 2^( 7) =       0.000431860565

      target function =                  N/A
              le_mean =     -17.216184180382
             les_mean =     296.716929162056
             stat err =       0.000429063490
             autocorr =       1.150842769259
              std dev =       0.565624954518
             le_variance =       0.319931589174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721618418038e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216184180382       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216184833329       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216185459454       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216185552387       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216185778631       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216185948340       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216185845649       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216185901052       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 1.868877e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216184180382       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216184348690       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216184512065       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216184537035       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216184595820       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216184636334       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216184610472       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216184624298       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 4.730104e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216184180382       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216184222789       residual = 4.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216184264084       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216184270445       residual = 8.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216184285297       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216184295296       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216184288820       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216184292273       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.186268e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040723 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5746e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.087279e-01 1 1  ON 0
 uu_1                 4.767469e-02 1 1  ON 1
 uu_2                -4.545552e-02 1 1  ON 2
 uu_3                -9.915377e-02 1 1  ON 3
 uu_4                -1.320166e-01 1 1  ON 4
 uu_5                -1.387371e-01 1 1  ON 5
 uu_6                -1.150966e-01 1 1  ON 6
 uu_7                -4.157439e-02 1 1  ON 7
 uu_8                 9.834214e-02 1 1  ON 8
 uu_9                 1.228142e-01 1 1  ON 9
 ud_0                 3.480000e-01 1 1  ON 10
 ud_1                 9.204024e-02 1 1  ON 11
 ud_2                -1.432136e-02 1 1  ON 12
 ud_3                -7.264664e-02 1 1  ON 13
 ud_4                -1.198967e-01 1 1  ON 14
 ud_5                -1.531341e-01 1 1  ON 15
 ud_6                -1.565057e-01 1 1  ON 16
 ud_7                -1.116819e-01 1 1  ON 17
 ud_8                 1.634566e-03 1 1  ON 18
 ud_9                 9.251271e-02 1 1  ON 19
 eO_0                -7.573946e-01 1 1  ON 20
 eO_1                -4.436861e-01 1 1  ON 21
 eO_2                -4.499275e-02 1 1  ON 22
 eO_3                 2.040376e-01 1 1  ON 23
 eO_4                 2.980972e-01 1 1  ON 24
 eO_5                 3.145882e-01 1 1  ON 25
 eO_6                 2.546334e-01 1 1  ON 26
 eO_7                 1.167741e-01 1 1  ON 27
 eO_8                 2.864403e-02 1 1  ON 28
 eO_9                 1.858386e-02 1 1  ON 29
eH1_0                -1.817184e-01 1 1  ON 30
eH1_1                -1.030997e-01 1 1  ON 31
eH1_2                -6.301004e-02 1 1  ON 32
eH1_3                -2.644305e-02 1 1  ON 33
eH1_4                 1.898776e-02 1 1  ON 34
eH1_5                 3.324445e-02 1 1  ON 35
eH1_6                 7.812669e-02 1 1  ON 36
eH1_7                 1.100488e-01 1 1  ON 37
eH1_8                 9.326472e-02 1 1  ON 38
eH1_9                 2.511024e-02 1 1  ON 39
eH2_0                -1.837054e-01 1 1  ON 40
eH2_1                -1.046355e-01 1 1  ON 41
eH2_2                -6.443841e-02 1 1  ON 42
eH2_3                -2.794238e-02 1 1  ON 43
eH2_4                 1.774611e-02 1 1  ON 44
eH2_5                 3.286077e-02 1 1  ON 45
eH2_6                 7.994924e-02 1 1  ON 46
eH2_7                 1.143971e-01 1 1  ON 47
eH2_8                 9.614653e-02 1 1  ON 48
eH2_9                 2.722863e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.211694
====================================================
  Execution time = 2.1714e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1088e-01
  Total weights = 2.0000e+06
  Execution time = 1.8486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310886058293
                                         uncertainty =       0.002957048199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310886058293
                                         uncertainty =       0.002957048199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394243463
  error estimate for blocks of size 2^( 2) =       0.000404003840
  error estimate for blocks of size 2^( 3) =       0.000413055872
  error estimate for blocks of size 2^( 4) =       0.000419144231
  error estimate for blocks of size 2^( 5) =       0.000421573459
  error estimate for blocks of size 2^( 6) =       0.000424498015
  error estimate for blocks of size 2^( 7) =       0.000425221157

      target function =                  N/A
              le_mean =     -17.215777654577
             les_mean =     296.693855913381
             stat err =       0.000422609216
             autocorr =       1.149076448223
              std dev =       0.557544452926
             le_variance =       0.310855816989

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310979517863
                                         uncertainty =       0.002958114646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310979517863
                                         uncertainty =       0.002958114646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394302706
  error estimate for blocks of size 2^( 2) =       0.000404058791
  error estimate for blocks of size 2^( 3) =       0.000413106194
  error estimate for blocks of size 2^( 4) =       0.000419192315
  error estimate for blocks of size 2^( 5) =       0.000421619818
  error estimate for blocks of size 2^( 6) =       0.000424543193
  error estimate for blocks of size 2^( 7) =       0.000425262980

      target function =                  N/A
              le_mean =     -17.215777853376
             les_mean =     296.693956189014
             stat err =       0.000422654576
             autocorr =       1.148977798434
              std dev =       0.557628234322
             le_variance =       0.310949247713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310933817955
                                         uncertainty =       0.002957596226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310933817955
                                         uncertainty =       0.002957596226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394273739
  error estimate for blocks of size 2^( 2) =       0.000404031905
  error estimate for blocks of size 2^( 3) =       0.000413081554
  error estimate for blocks of size 2^( 4) =       0.000419168764
  error estimate for blocks of size 2^( 5) =       0.000421597106
  error estimate for blocks of size 2^( 6) =       0.000424521055
  error estimate for blocks of size 2^( 7) =       0.000425242479

      target function =                  N/A
              le_mean =     -17.215777746753
             les_mean =     296.693906831961
             stat err =       0.000422632351
             autocorr =       1.149025782756
              std dev =       0.557587268349
             le_variance =       0.310903561825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310892056029
                                         uncertainty =       0.002957117169

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310892056029
                                         uncertainty =       0.002957117169

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394247266
  error estimate for blocks of size 2^( 2) =       0.000404007364
  error estimate for blocks of size 2^( 3) =       0.000413059095
  error estimate for blocks of size 2^( 4) =       0.000419147309
  error estimate for blocks of size 2^( 5) =       0.000421576426
  error estimate for blocks of size 2^( 6) =       0.000424500905
  error estimate for blocks of size 2^( 7) =       0.000425223831

      target function =                  N/A
              le_mean =     -17.215777665106
             les_mean =     296.693862271795
             stat err =       0.000422612118
             autocorr =       1.149070067380
              std dev =       0.557549829933
             le_variance =       0.310861812858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215777654577        initial
     6.1035e+00     6.1035e+01             1.8689e-04       -17.215777853376  <--
     2.4414e+01     2.4414e+02             4.7301e-05       -17.215777746753
     9.7656e+01     9.7656e+02             1.1863e-05       -17.215777665106

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 3.1057e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.087453e-01 1 1  ON 0
 uu_1                 4.768484e-02 1 1  ON 1
 uu_2                -4.546054e-02 1 1  ON 2
 uu_3                -9.915699e-02 1 1  ON 3
 uu_4                -1.320204e-01 1 1  ON 4
 uu_5                -1.387321e-01 1 1  ON 5
 uu_6                -1.151045e-01 1 1  ON 6
 uu_7                -4.159130e-02 1 1  ON 7
 uu_8                 9.833494e-02 1 1  ON 8
 uu_9                 1.228209e-01 1 1  ON 9
 ud_0                 3.480790e-01 1 1  ON 10
 ud_1                 9.208473e-02 1 1  ON 11
 ud_2                -1.434718e-02 1 1  ON 12
 ud_3                -7.270297e-02 1 1  ON 13
 ud_4                -1.199244e-01 1 1  ON 14
 ud_5                -1.531369e-01 1 1  ON 15
 ud_6                -1.564965e-01 1 1  ON 16
 ud_7                -1.116855e-01 1 1  ON 17
 ud_8                 1.617115e-03 1 1  ON 18
 ud_9                 9.250970e-02 1 1  ON 19
 eO_0                -7.575342e-01 1 1  ON 20
 eO_1                -4.437515e-01 1 1  ON 21
 eO_2                -4.493141e-02 1 1  ON 22
 eO_3                 2.041092e-01 1 1  ON 23
 eO_4                 2.981293e-01 1 1  ON 24
 eO_5                 3.146009e-01 1 1  ON 25
 eO_6                 2.546440e-01 1 1  ON 26
 eO_7                 1.167879e-01 1 1  ON 27
 eO_8                 2.864626e-02 1 1  ON 28
 eO_9                 1.858416e-02 1 1  ON 29
eH1_0                -1.817298e-01 1 1  ON 30
eH1_1                -1.031127e-01 1 1  ON 31
eH1_2                -6.301566e-02 1 1  ON 32
eH1_3                -2.643407e-02 1 1  ON 33
eH1_4                 1.899280e-02 1 1  ON 34
eH1_5                 3.325461e-02 1 1  ON 35
eH1_6                 7.812596e-02 1 1  ON 36
eH1_7                 1.100462e-01 1 1  ON 37
eH1_8                 9.327128e-02 1 1  ON 38
eH1_9                 2.511234e-02 1 1  ON 39
eH2_0                -1.837087e-01 1 1  ON 40
eH2_1                -1.046485e-01 1 1  ON 41
eH2_2                -6.444035e-02 1 1  ON 42
eH2_3                -2.792712e-02 1 1  ON 43
eH2_4                 1.775975e-02 1 1  ON 44
eH2_5                 3.285388e-02 1 1  ON 45
eH2_6                 7.993840e-02 1 1  ON 46
eH2_7                 1.143932e-01 1 1  ON 47
eH2_8                 9.615482e-02 1 1  ON 48
eH2_9                 2.723094e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2169
    reference variance = 0.139447
====================================================
  Execution time = 1.9869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323288401433
                                         uncertainty =       0.007462351445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323288401433
                                         uncertainty =       0.007462351445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402005429
  error estimate for blocks of size 2^( 2) =       0.000412023823
  error estimate for blocks of size 2^( 3) =       0.000420532499
  error estimate for blocks of size 2^( 4) =       0.000427323556
  error estimate for blocks of size 2^( 5) =       0.000431813460
  error estimate for blocks of size 2^( 6) =       0.000434034858
  error estimate for blocks of size 2^( 7) =       0.000437780873

      target function =                  N/A
              le_mean =     -17.216717412982
             les_mean =     296.738575046314
             stat err =       0.000432738187
             autocorr =       1.158741619283
              std dev =       0.568521529434
             le_variance =       0.323216729430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671741298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717412982       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717908446       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216718874806       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216718975338       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216720669491       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216721365391       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216721077375       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216721038112       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216721088800       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 6.598918e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717412982       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717551686       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717826754       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717865780       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216718339349       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216718501242       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216718415100       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216718404250       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216718412591       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 1.712973e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717412982       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717448729       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717519984       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717530944       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717653149       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717692591       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717670357       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216717667533       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 4.315881e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5509e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.087634e-01 1 1  ON 0
 uu_1                 4.769537e-02 1 1  ON 1
 uu_2                -4.545842e-02 1 1  ON 2
 uu_3                -9.917449e-02 1 1  ON 3
 uu_4                -1.320133e-01 1 1  ON 4
 uu_5                -1.387305e-01 1 1  ON 5
 uu_6                -1.151186e-01 1 1  ON 6
 uu_7                -4.161564e-02 1 1  ON 7
 uu_8                 9.832287e-02 1 1  ON 8
 uu_9                 1.228332e-01 1 1  ON 9
 ud_0                 3.481711e-01 1 1  ON 10
 ud_1                 9.213458e-02 1 1  ON 11
 ud_2                -1.438046e-02 1 1  ON 12
 ud_3                -7.277599e-02 1 1  ON 13
 ud_4                -1.199620e-01 1 1  ON 14
 ud_5                -1.531299e-01 1 1  ON 15
 ud_6                -1.564956e-01 1 1  ON 16
 ud_7                -1.116882e-01 1 1  ON 17
 ud_8                 1.598085e-03 1 1  ON 18
 ud_9                 9.251252e-02 1 1  ON 19
 eO_0                -7.577055e-01 1 1  ON 20
 eO_1                -4.438440e-01 1 1  ON 21
 eO_2                -4.485728e-02 1 1  ON 22
 eO_3                 2.041881e-01 1 1  ON 23
 eO_4                 2.981732e-01 1 1  ON 24
 eO_5                 3.146205e-01 1 1  ON 25
 eO_6                 2.546641e-01 1 1  ON 26
 eO_7                 1.168075e-01 1 1  ON 27
 eO_8                 2.864971e-02 1 1  ON 28
 eO_9                 1.858648e-02 1 1  ON 29
eH1_0                -1.817410e-01 1 1  ON 30
eH1_1                -1.031295e-01 1 1  ON 31
eH1_2                -6.301640e-02 1 1  ON 32
eH1_3                -2.643879e-02 1 1  ON 33
eH1_4                 1.899925e-02 1 1  ON 34
eH1_5                 3.325927e-02 1 1  ON 35
eH1_6                 7.813084e-02 1 1  ON 36
eH1_7                 1.100485e-01 1 1  ON 37
eH1_8                 9.328036e-02 1 1  ON 38
eH1_9                 2.511516e-02 1 1  ON 39
eH2_0                -1.837152e-01 1 1  ON 40
eH2_1                -1.046513e-01 1 1  ON 41
eH2_2                -6.444353e-02 1 1  ON 42
eH2_3                -2.792923e-02 1 1  ON 43
eH2_4                 1.776094e-02 1 1  ON 44
eH2_5                 3.285123e-02 1 1  ON 45
eH2_6                 7.993109e-02 1 1  ON 46
eH2_7                 1.143926e-01 1 1  ON 47
eH2_8                 9.617100e-02 1 1  ON 48
eH2_9                 2.723680e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2085
    reference variance = 0.344814
====================================================
  Execution time = 1.9500e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2367e-01
  Total weights = 2.0000e+06
  Execution time = 1.8567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323647655397
                                         uncertainty =       0.006810988134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323647655397
                                         uncertainty =       0.006810988134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402233160
  error estimate for blocks of size 2^( 2) =       0.000412094402
  error estimate for blocks of size 2^( 3) =       0.000421163760
  error estimate for blocks of size 2^( 4) =       0.000427841502
  error estimate for blocks of size 2^( 5) =       0.000432972016
  error estimate for blocks of size 2^( 6) =       0.000434376805
  error estimate for blocks of size 2^( 7) =       0.000434884170

      target function =                  N/A
              le_mean =     -17.216683910378
             les_mean =     296.737787737437
             stat err =       0.000432518623
             autocorr =       1.156255690135
              std dev =       0.568843589543
             le_variance =       0.323583029364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323964962575
                                         uncertainty =       0.006826763259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323964962575
                                         uncertainty =       0.006826763259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402430318
  error estimate for blocks of size 2^( 2) =       0.000412277016
  error estimate for blocks of size 2^( 3) =       0.000421334200
  error estimate for blocks of size 2^( 4) =       0.000428001680
  error estimate for blocks of size 2^( 5) =       0.000433128243
  error estimate for blocks of size 2^( 6) =       0.000434533555
  error estimate for blocks of size 2^( 7) =       0.000435040595

      target function =                  N/A
              le_mean =     -17.216683533423
             les_mean =     296.738092050392
             stat err =       0.000432676018
             autocorr =       1.155963880924
              std dev =       0.569122414150
             le_variance =       0.323900322288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323820192180
                                         uncertainty =       0.006819714011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323820192180
                                         uncertainty =       0.006819714011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402340377
  error estimate for blocks of size 2^( 2) =       0.000412193586
  error estimate for blocks of size 2^( 3) =       0.000421256241
  error estimate for blocks of size 2^( 4) =       0.000427928328
  error estimate for blocks of size 2^( 5) =       0.000433056802
  error estimate for blocks of size 2^( 6) =       0.000434461886
  error estimate for blocks of size 2^( 7) =       0.000434969101

      target function =                  N/A
              le_mean =     -17.216683586931
             les_mean =     296.737949128832
             stat err =       0.000432604029
             autocorr =       1.156095958705
              std dev =       0.568995218102
             le_variance =       0.323755558223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323669729955
                                         uncertainty =       0.006812100886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323669729955
                                         uncertainty =       0.006812100886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402246879
  error estimate for blocks of size 2^( 2) =       0.000412107081
  error estimate for blocks of size 2^( 3) =       0.000421175573
  error estimate for blocks of size 2^( 4) =       0.000427852588
  error estimate for blocks of size 2^( 5) =       0.000432982847
  error estimate for blocks of size 2^( 6) =       0.000434387679
  error estimate for blocks of size 2^( 7) =       0.000434895012

      target function =                  N/A
              le_mean =     -17.216683853081
             les_mean =     296.737807837886
             stat err =       0.000432529532
             autocorr =       1.156235139897
              std dev =       0.568862991204
             le_variance =       0.323605102762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216683910378        initial  <--
     1.5259e+00     1.5259e+01             6.5989e-04       -17.216683533423
     6.1035e+00     6.1035e+01             1.7130e-04       -17.216683586931
     2.4414e+01     2.4414e+02             4.3159e-05       -17.216683853081

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9006
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.087453e-01 1 1  ON 0
 uu_1                 4.768484e-02 1 1  ON 1
 uu_2                -4.546054e-02 1 1  ON 2
 uu_3                -9.915699e-02 1 1  ON 3
 uu_4                -1.320204e-01 1 1  ON 4
 uu_5                -1.387321e-01 1 1  ON 5
 uu_6                -1.151045e-01 1 1  ON 6
 uu_7                -4.159130e-02 1 1  ON 7
 uu_8                 9.833494e-02 1 1  ON 8
 uu_9                 1.228209e-01 1 1  ON 9
 ud_0                 3.480790e-01 1 1  ON 10
 ud_1                 9.208473e-02 1 1  ON 11
 ud_2                -1.434718e-02 1 1  ON 12
 ud_3                -7.270297e-02 1 1  ON 13
 ud_4                -1.199244e-01 1 1  ON 14
 ud_5                -1.531369e-01 1 1  ON 15
 ud_6                -1.564965e-01 1 1  ON 16
 ud_7                -1.116855e-01 1 1  ON 17
 ud_8                 1.617115e-03 1 1  ON 18
 ud_9                 9.250970e-02 1 1  ON 19
 eO_0                -7.575342e-01 1 1  ON 20
 eO_1                -4.437515e-01 1 1  ON 21
 eO_2                -4.493141e-02 1 1  ON 22
 eO_3                 2.041092e-01 1 1  ON 23
 eO_4                 2.981293e-01 1 1  ON 24
 eO_5                 3.146009e-01 1 1  ON 25
 eO_6                 2.546440e-01 1 1  ON 26
 eO_7                 1.167879e-01 1 1  ON 27
 eO_8                 2.864626e-02 1 1  ON 28
 eO_9                 1.858416e-02 1 1  ON 29
eH1_0                -1.817298e-01 1 1  ON 30
eH1_1                -1.031127e-01 1 1  ON 31
eH1_2                -6.301566e-02 1 1  ON 32
eH1_3                -2.643407e-02 1 1  ON 33
eH1_4                 1.899280e-02 1 1  ON 34
eH1_5                 3.325461e-02 1 1  ON 35
eH1_6                 7.812596e-02 1 1  ON 36
eH1_7                 1.100462e-01 1 1  ON 37
eH1_8                 9.327128e-02 1 1  ON 38
eH1_9                 2.511234e-02 1 1  ON 39
eH2_0                -1.837087e-01 1 1  ON 40
eH2_1                -1.046485e-01 1 1  ON 41
eH2_2                -6.444035e-02 1 1  ON 42
eH2_3                -2.792712e-02 1 1  ON 43
eH2_4                 1.775975e-02 1 1  ON 44
eH2_5                 3.285388e-02 1 1  ON 45
eH2_6                 7.993840e-02 1 1  ON 46
eH2_7                 1.143932e-01 1 1  ON 47
eH2_8                 9.615482e-02 1 1  ON 48
eH2_9                 2.723094e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1729
    reference variance = 0.141043
====================================================
  Execution time = 1.9895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316305004556
                                         uncertainty =       0.003058044795

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316305004556
                                         uncertainty =       0.003058044795

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397692703
  error estimate for blocks of size 2^( 2) =       0.000407460344
  error estimate for blocks of size 2^( 3) =       0.000416481076
  error estimate for blocks of size 2^( 4) =       0.000423037262
  error estimate for blocks of size 2^( 5) =       0.000427404968
  error estimate for blocks of size 2^( 6) =       0.000428466277
  error estimate for blocks of size 2^( 7) =       0.000428927043

      target function =                  N/A
              le_mean =     -17.216163863441
             les_mean =     296.712616986092
             stat err =       0.000426958887
             autocorr =       1.152595373870
              std dev =       0.562422413669
             le_variance =       0.316318971398


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721616386344e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216163863441       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216163815349       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216163832338       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216163820420       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216163844627       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216163850653       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216163873731       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216163869799       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216163877301       residual = 1.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 7.069203e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216163863441       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216163851268       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216163855529       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216163852569       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216163858541       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216163860241       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216163865966       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216163865044       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.769848e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216163863441       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216163860388       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216163861454       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216163860716       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216163862203       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216163862640       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216163864069       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216163863843       residual = 8.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 4.429441e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.046547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5424e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.087478e-01 1 1  ON 0
 uu_1                 4.768714e-02 1 1  ON 1
 uu_2                -4.546085e-02 1 1  ON 2
 uu_3                -9.915840e-02 1 1  ON 3
 uu_4                -1.320215e-01 1 1  ON 4
 uu_5                -1.387312e-01 1 1  ON 5
 uu_6                -1.151057e-01 1 1  ON 6
 uu_7                -4.159324e-02 1 1  ON 7
 uu_8                 9.833364e-02 1 1  ON 8
 uu_9                 1.228217e-01 1 1  ON 9
 ud_0                 3.480882e-01 1 1  ON 10
 ud_1                 9.208867e-02 1 1  ON 11
 ud_2                -1.434979e-02 1 1  ON 12
 ud_3                -7.271153e-02 1 1  ON 13
 ud_4                -1.199268e-01 1 1  ON 14
 ud_5                -1.531349e-01 1 1  ON 15
 ud_6                -1.564960e-01 1 1  ON 16
 ud_7                -1.116863e-01 1 1  ON 17
 ud_8                 1.615466e-03 1 1  ON 18
 ud_9                 9.250962e-02 1 1  ON 19
 eO_0                -7.575519e-01 1 1  ON 20
 eO_1                -4.437609e-01 1 1  ON 21
 eO_2                -4.492321e-02 1 1  ON 22
 eO_3                 2.041182e-01 1 1  ON 23
 eO_4                 2.981337e-01 1 1  ON 24
 eO_5                 3.146022e-01 1 1  ON 25
 eO_6                 2.546456e-01 1 1  ON 26
 eO_7                 1.167900e-01 1 1  ON 27
 eO_8                 2.864650e-02 1 1  ON 28
 eO_9                 1.858419e-02 1 1  ON 29
eH1_0                -1.817307e-01 1 1  ON 30
eH1_1                -1.031126e-01 1 1  ON 31
eH1_2                -6.301633e-02 1 1  ON 32
eH1_3                -2.643401e-02 1 1  ON 33
eH1_4                 1.899297e-02 1 1  ON 34
eH1_5                 3.325495e-02 1 1  ON 35
eH1_6                 7.812539e-02 1 1  ON 36
eH1_7                 1.100459e-01 1 1  ON 37
eH1_8                 9.327260e-02 1 1  ON 38
eH1_9                 2.511276e-02 1 1  ON 39
eH2_0                -1.837095e-01 1 1  ON 40
eH2_1                -1.046489e-01 1 1  ON 41
eH2_2                -6.443975e-02 1 1  ON 42
eH2_3                -2.792573e-02 1 1  ON 43
eH2_4                 1.775975e-02 1 1  ON 44
eH2_5                 3.285393e-02 1 1  ON 45
eH2_6                 7.993709e-02 1 1  ON 46
eH2_7                 1.143925e-01 1 1  ON 47
eH2_8                 9.615570e-02 1 1  ON 48
eH2_9                 2.723121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2147
    reference variance = 0.211688
====================================================
  Execution time = 1.9690e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2222e-01
  Total weights = 2.0000e+06
  Execution time = 1.8442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322236210353
                                         uncertainty =       0.004758351547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322236210353
                                         uncertainty =       0.004758351547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401380940
  error estimate for blocks of size 2^( 2) =       0.000410999548
  error estimate for blocks of size 2^( 3) =       0.000419659216
  error estimate for blocks of size 2^( 4) =       0.000426142109
  error estimate for blocks of size 2^( 5) =       0.000431064039
  error estimate for blocks of size 2^( 6) =       0.000434577888
  error estimate for blocks of size 2^( 7) =       0.000435229236

      target function =                  N/A
              le_mean =     -17.216466925776
             les_mean =     296.728946563350
             stat err =       0.000431753318
             autocorr =       1.157065316521
              std dev =       0.567638369141
             le_variance =       0.322213318121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322270667802
                                         uncertainty =       0.004758878894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322270667802
                                         uncertainty =       0.004758878894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401402398
  error estimate for blocks of size 2^( 2) =       0.000411019414
  error estimate for blocks of size 2^( 3) =       0.000419677621
  error estimate for blocks of size 2^( 4) =       0.000426159580
  error estimate for blocks of size 2^( 5) =       0.000431080493
  error estimate for blocks of size 2^( 6) =       0.000434594015
  error estimate for blocks of size 2^( 7) =       0.000435244804

      target function =                  N/A
              le_mean =     -17.216466989557
             les_mean =     296.728983211844
             stat err =       0.000431769723
             autocorr =       1.157029534583
              std dev =       0.567668715407
             le_variance =       0.322247770451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322253630495
                                         uncertainty =       0.004758619582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322253630495
                                         uncertainty =       0.004758619582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401391788
  error estimate for blocks of size 2^( 2) =       0.000411009589
  error estimate for blocks of size 2^( 3) =       0.000419668521
  error estimate for blocks of size 2^( 4) =       0.000426150946
  error estimate for blocks of size 2^( 5) =       0.000431072361
  error estimate for blocks of size 2^( 6) =       0.000434586057
  error estimate for blocks of size 2^( 7) =       0.000435237123

      target function =                  N/A
              le_mean =     -17.216466953217
             les_mean =     296.728964925641
             stat err =       0.000431761622
             autocorr =       1.157047278996
              std dev =       0.567653710939
             le_variance =       0.322230735543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322238392082
                                         uncertainty =       0.004758385129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322238392082
                                         uncertainty =       0.004758385129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401382299
  error estimate for blocks of size 2^( 2) =       0.000411000805
  error estimate for blocks of size 2^( 3) =       0.000419660381
  error estimate for blocks of size 2^( 4) =       0.000426143216
  error estimate for blocks of size 2^( 5) =       0.000431065080
  error estimate for blocks of size 2^( 6) =       0.000434578910
  error estimate for blocks of size 2^( 7) =       0.000435230223

      target function =                  N/A
              le_mean =     -17.216466929106
             les_mean =     296.728948859392
             stat err =       0.000431754357
             autocorr =       1.157063055040
              std dev =       0.567640290600
             le_variance =       0.322215499513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216466925776        initial
     1.5259e+01     1.5259e+02             7.0692e-05       -17.216466989557  <--
     6.1035e+01     6.1035e+02             1.7698e-05       -17.216466953217
     2.4414e+02     2.4414e+03             4.4294e-06       -17.216466929106

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 3.2282e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.087556e-01 1 1  ON 0
 uu_1                 4.769391e-02 1 1  ON 1
 uu_2                -4.546219e-02 1 1  ON 2
 uu_3                -9.916220e-02 1 1  ON 3
 uu_4                -1.320246e-01 1 1  ON 4
 uu_5                -1.387287e-01 1 1  ON 5
 uu_6                -1.151095e-01 1 1  ON 6
 uu_7                -4.159911e-02 1 1  ON 7
 uu_8                 9.832967e-02 1 1  ON 8
 uu_9                 1.228243e-01 1 1  ON 9
 ud_0                 3.481154e-01 1 1  ON 10
 ud_1                 9.210089e-02 1 1  ON 11
 ud_2                -1.435737e-02 1 1  ON 12
 ud_3                -7.273655e-02 1 1  ON 13
 ud_4                -1.199347e-01 1 1  ON 14
 ud_5                -1.531296e-01 1 1  ON 15
 ud_6                -1.564944e-01 1 1  ON 16
 ud_7                -1.116889e-01 1 1  ON 17
 ud_8                 1.610426e-03 1 1  ON 18
 ud_9                 9.250938e-02 1 1  ON 19
 eO_0                -7.576049e-01 1 1  ON 20
 eO_1                -4.437891e-01 1 1  ON 21
 eO_2                -4.489968e-02 1 1  ON 22
 eO_3                 2.041450e-01 1 1  ON 23
 eO_4                 2.981476e-01 1 1  ON 24
 eO_5                 3.146065e-01 1 1  ON 25
 eO_6                 2.546507e-01 1 1  ON 26
 eO_7                 1.167967e-01 1 1  ON 27
 eO_8                 2.864724e-02 1 1  ON 28
 eO_9                 1.858430e-02 1 1  ON 29
eH1_0                -1.817334e-01 1 1  ON 30
eH1_1                -1.031124e-01 1 1  ON 31
eH1_2                -6.301860e-02 1 1  ON 32
eH1_3                -2.643399e-02 1 1  ON 33
eH1_4                 1.899363e-02 1 1  ON 34
eH1_5                 3.325598e-02 1 1  ON 35
eH1_6                 7.812367e-02 1 1  ON 36
eH1_7                 1.100451e-01 1 1  ON 37
eH1_8                 9.327669e-02 1 1  ON 38
eH1_9                 2.511406e-02 1 1  ON 39
eH2_0                -1.837117e-01 1 1  ON 40
eH2_1                -1.046499e-01 1 1  ON 41
eH2_2                -6.443824e-02 1 1  ON 42
eH2_3                -2.792203e-02 1 1  ON 43
eH2_4                 1.775993e-02 1 1  ON 44
eH2_5                 3.285416e-02 1 1  ON 45
eH2_6                 7.993317e-02 1 1  ON 46
eH2_7                 1.143903e-01 1 1  ON 47
eH2_8                 9.615841e-02 1 1  ON 48
eH2_9                 2.723204e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7713e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2438
    reference variance = 0.335004
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1904e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319070269175
                                         uncertainty =       0.005478608534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319070269175
                                         uncertainty =       0.005478608534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399400020
  error estimate for blocks of size 2^( 2) =       0.000408827763
  error estimate for blocks of size 2^( 3) =       0.000417951932
  error estimate for blocks of size 2^( 4) =       0.000424163518
  error estimate for blocks of size 2^( 5) =       0.000429065395
  error estimate for blocks of size 2^( 6) =       0.000432728873
  error estimate for blocks of size 2^( 7) =       0.000435269859

      target function =                  N/A
              le_mean =     -17.217490885945
             les_mean =     296.761033000110
             stat err =       0.000430306911
             autocorr =       1.160754773809
              std dev =       0.564836925176
             le_variance =       0.319040752042


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721749088594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217490885945       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217491374907       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217491260865       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217491514129       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217492005048       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217492185720       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217492299247       residual = 6.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217492354681       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217492328752       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 2.895062e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217490885945       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217491014013       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217490984654       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217491044180       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217491171515       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217491216849       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217491247410       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217491261408       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 7.346044e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217490885945       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217490918348       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217490910956       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217490925579       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217490957678       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217490969013       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217490976815       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217490980314       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.845592e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5785e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.087620e-01 1 1  ON 0
 uu_1                 4.770021e-02 1 1  ON 1
 uu_2                -4.546054e-02 1 1  ON 2
 uu_3                -9.916494e-02 1 1  ON 3
 uu_4                -1.320193e-01 1 1  ON 4
 uu_5                -1.387358e-01 1 1  ON 5
 uu_6                -1.151149e-01 1 1  ON 6
 uu_7                -4.160702e-02 1 1  ON 7
 uu_8                 9.832528e-02 1 1  ON 8
 uu_9                 1.228277e-01 1 1  ON 9
 ud_0                 3.481606e-01 1 1  ON 10
 ud_1                 9.211580e-02 1 1  ON 11
 ud_2                -1.436997e-02 1 1  ON 12
 ud_3                -7.276889e-02 1 1  ON 13
 ud_4                -1.199491e-01 1 1  ON 14
 ud_5                -1.531239e-01 1 1  ON 15
 ud_6                -1.564915e-01 1 1  ON 16
 ud_7                -1.116919e-01 1 1  ON 17
 ud_8                 1.601460e-03 1 1  ON 18
 ud_9                 9.250899e-02 1 1  ON 19
 eO_0                -7.576784e-01 1 1  ON 20
 eO_1                -4.438208e-01 1 1  ON 21
 eO_2                -4.486942e-02 1 1  ON 22
 eO_3                 2.041833e-01 1 1  ON 23
 eO_4                 2.981616e-01 1 1  ON 24
 eO_5                 3.146150e-01 1 1  ON 25
 eO_6                 2.546560e-01 1 1  ON 26
 eO_7                 1.168037e-01 1 1  ON 27
 eO_8                 2.864838e-02 1 1  ON 28
 eO_9                 1.858471e-02 1 1  ON 29
eH1_0                -1.817458e-01 1 1  ON 30
eH1_1                -1.031119e-01 1 1  ON 31
eH1_2                -6.301153e-02 1 1  ON 32
eH1_3                -2.643278e-02 1 1  ON 33
eH1_4                 1.899156e-02 1 1  ON 34
eH1_5                 3.326027e-02 1 1  ON 35
eH1_6                 7.812204e-02 1 1  ON 36
eH1_7                 1.100426e-01 1 1  ON 37
eH1_8                 9.328031e-02 1 1  ON 38
eH1_9                 2.511536e-02 1 1  ON 39
eH2_0                -1.837124e-01 1 1  ON 40
eH2_1                -1.046503e-01 1 1  ON 41
eH2_2                -6.444315e-02 1 1  ON 42
eH2_3                -2.791866e-02 1 1  ON 43
eH2_4                 1.776556e-02 1 1  ON 44
eH2_5                 3.285006e-02 1 1  ON 45
eH2_6                 7.992850e-02 1 1  ON 46
eH2_7                 1.143895e-01 1 1  ON 47
eH2_8                 9.616324e-02 1 1  ON 48
eH2_9                 2.723347e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2915
    reference variance = 0.453971
====================================================
  Execution time = 1.9511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2184e-01
  Total weights = 2.0000e+06
  Execution time = 1.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321718068561
                                         uncertainty =       0.007705244723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321718068561
                                         uncertainty =       0.007705244723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401124277
  error estimate for blocks of size 2^( 2) =       0.000410925076
  error estimate for blocks of size 2^( 3) =       0.000419268354
  error estimate for blocks of size 2^( 4) =       0.000424994887
  error estimate for blocks of size 2^( 5) =       0.000429019124
  error estimate for blocks of size 2^( 6) =       0.000431510398
  error estimate for blocks of size 2^( 7) =       0.000431404633

      target function =                  N/A
              le_mean =     -17.216614411666
             les_mean =     296.733613009738
             stat err =       0.000429232261
             autocorr =       1.145056238375
              std dev =       0.567275392253
             le_variance =       0.321801370656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321868937401
                                         uncertainty =       0.007707304874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321868937401
                                         uncertainty =       0.007707304874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401218284
  error estimate for blocks of size 2^( 2) =       0.000411012861
  error estimate for blocks of size 2^( 3) =       0.000419349731
  error estimate for blocks of size 2^( 4) =       0.000425072632
  error estimate for blocks of size 2^( 5) =       0.000429095280
  error estimate for blocks of size 2^( 6) =       0.000431585032
  error estimate for blocks of size 2^( 7) =       0.000431478255

      target function =                  N/A
              le_mean =     -17.216614826883
             les_mean =     296.733778158888
             stat err =       0.000429307800
             autocorr =       1.144922594439
              std dev =       0.567408338515
             le_variance =       0.321952222616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321797471749
                                         uncertainty =       0.007706352597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321797471749
                                         uncertainty =       0.007706352597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401173756
  error estimate for blocks of size 2^( 2) =       0.000410971275
  error estimate for blocks of size 2^( 3) =       0.000419311199
  error estimate for blocks of size 2^( 4) =       0.000425035858
  error estimate for blocks of size 2^( 5) =       0.000429059267
  error estimate for blocks of size 2^( 6) =       0.000431549733
  error estimate for blocks of size 2^( 7) =       0.000431443432

      target function =                  N/A
              le_mean =     -17.216614621693
             les_mean =     296.733699635583
             stat err =       0.000429272072
             autocorr =       1.144986171737
              std dev =       0.567345366276
             le_variance =       0.321880764634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321728098259
                                         uncertainty =       0.007705384568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321728098259
                                         uncertainty =       0.007705384568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401130527
  error estimate for blocks of size 2^( 2) =       0.000410930911
  error estimate for blocks of size 2^( 3) =       0.000419273764
  error estimate for blocks of size 2^( 4) =       0.000425000059
  error estimate for blocks of size 2^( 5) =       0.000429024191
  error estimate for blocks of size 2^( 6) =       0.000431515362
  error estimate for blocks of size 2^( 7) =       0.000431409529

      target function =                  N/A
              le_mean =     -17.216614436462
             les_mean =     296.733623892118
             stat err =       0.000429237285
             autocorr =       1.145047362346
              std dev =       0.567284231427
             le_variance =       0.321811399226


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216614411666        initial
     3.8147e+00     3.8147e+01             2.8951e-04       -17.216614826883  <--
     1.5259e+01     1.5259e+02             7.3460e-05       -17.216614621693
     6.1035e+01     6.1035e+02             1.8456e-05       -17.216614436462

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.8893e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.087838e-01 1 1  ON 0
 uu_1                 4.771808e-02 1 1  ON 1
 uu_2                -4.545706e-02 1 1  ON 2
 uu_3                -9.917176e-02 1 1  ON 3
 uu_4                -1.320054e-01 1 1  ON 4
 uu_5                -1.387561e-01 1 1  ON 5
 uu_6                -1.151312e-01 1 1  ON 6
 uu_7                -4.163125e-02 1 1  ON 7
 uu_8                 9.831182e-02 1 1  ON 8
 uu_9                 1.228381e-01 1 1  ON 9
 ud_0                 3.482875e-01 1 1  ON 10
 ud_1                 9.216176e-02 1 1  ON 11
 ud_2                -1.440401e-02 1 1  ON 12
 ud_3                -7.285847e-02 1 1  ON 13
 ud_4                -1.199943e-01 1 1  ON 14
 ud_5                -1.531093e-01 1 1  ON 15
 ud_6                -1.564817e-01 1 1  ON 16
 ud_7                -1.117003e-01 1 1  ON 17
 ud_8                 1.574032e-03 1 1  ON 18
 ud_9                 9.250783e-02 1 1  ON 19
 eO_0                -7.578944e-01 1 1  ON 20
 eO_1                -4.439159e-01 1 1  ON 21
 eO_2                -4.478784e-02 1 1  ON 22
 eO_3                 2.042968e-01 1 1  ON 23
 eO_4                 2.982063e-01 1 1  ON 24
 eO_5                 3.146424e-01 1 1  ON 25
 eO_6                 2.546727e-01 1 1  ON 26
 eO_7                 1.168254e-01 1 1  ON 27
 eO_8                 2.865193e-02 1 1  ON 28
 eO_9                 1.858597e-02 1 1  ON 29
eH1_0                -1.817817e-01 1 1  ON 30
eH1_1                -1.031108e-01 1 1  ON 31
eH1_2                -6.299339e-02 1 1  ON 32
eH1_3                -2.642943e-02 1 1  ON 33
eH1_4                 1.898642e-02 1 1  ON 34
eH1_5                 3.327347e-02 1 1  ON 35
eH1_6                 7.811742e-02 1 1  ON 36
eH1_7                 1.100353e-01 1 1  ON 37
eH1_8                 9.329149e-02 1 1  ON 38
eH1_9                 2.511939e-02 1 1  ON 39
eH2_0                -1.837142e-01 1 1  ON 40
eH2_1                -1.046513e-01 1 1  ON 41
eH2_2                -6.445632e-02 1 1  ON 42
eH2_3                -2.791124e-02 1 1  ON 43
eH2_4                 1.778117e-02 1 1  ON 44
eH2_5                 3.283864e-02 1 1  ON 45
eH2_6                 7.991494e-02 1 1  ON 46
eH2_7                 1.143871e-01 1 1  ON 47
eH2_8                 9.617812e-02 1 1  ON 48
eH2_9                 2.723790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2571
    reference variance = 0.167528
====================================================
  Execution time = 2.0029e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1272e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312788894567
                                         uncertainty =       0.003218092445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312788894567
                                         uncertainty =       0.003218092445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395423250
  error estimate for blocks of size 2^( 2) =       0.000404939232
  error estimate for blocks of size 2^( 3) =       0.000413488537
  error estimate for blocks of size 2^( 4) =       0.000420075920
  error estimate for blocks of size 2^( 5) =       0.000424757660
  error estimate for blocks of size 2^( 6) =       0.000428013494
  error estimate for blocks of size 2^( 7) =       0.000430982396

      target function =                  N/A
              le_mean =     -17.215926760288
             les_mean =     296.700853152114
             stat err =       0.000425957367
             autocorr =       1.160400391080
              std dev =       0.559212922677
             le_variance =       0.312719092889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721592676029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215926760288       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215926735130       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215926668264       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215927589707       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215927978293       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215928832193       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215929088179       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215929225324       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215929262342       residual = 9.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 1.046070e-03

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215926760288       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215926752963       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215926708982       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215926957371       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215927029166       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215927259584       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215927318968       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215927348823       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 2.784263e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215926760288       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215926758378       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215926745034       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215926808310       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215926823037       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215926881798       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215926896479       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215926903324       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 7.083273e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5543e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.088267e-01 1 1  ON 0
 uu_1                 4.775532e-02 1 1  ON 1
 uu_2                -4.545217e-02 1 1  ON 2
 uu_3                -9.920496e-02 1 1  ON 3
 uu_4                -1.319843e-01 1 1  ON 4
 uu_5                -1.387657e-01 1 1  ON 5
 uu_6                -1.151606e-01 1 1  ON 6
 uu_7                -4.167383e-02 1 1  ON 7
 uu_8                 9.829017e-02 1 1  ON 8
 uu_9                 1.228506e-01 1 1  ON 9
 ud_0                 3.484568e-01 1 1  ON 10
 ud_1                 9.222511e-02 1 1  ON 11
 ud_2                -1.444675e-02 1 1  ON 12
 ud_3                -7.295967e-02 1 1  ON 13
 ud_4                -1.200443e-01 1 1  ON 14
 ud_5                -1.531109e-01 1 1  ON 15
 ud_6                -1.564721e-01 1 1  ON 16
 ud_7                -1.117239e-01 1 1  ON 17
 ud_8                 1.535483e-03 1 1  ON 18
 ud_9                 9.250648e-02 1 1  ON 19
 eO_0                -7.581729e-01 1 1  ON 20
 eO_1                -4.440484e-01 1 1  ON 21
 eO_2                -4.468388e-02 1 1  ON 22
 eO_3                 2.044402e-01 1 1  ON 23
 eO_4                 2.982797e-01 1 1  ON 24
 eO_5                 3.146718e-01 1 1  ON 25
 eO_6                 2.546966e-01 1 1  ON 26
 eO_7                 1.168539e-01 1 1  ON 27
 eO_8                 2.865575e-02 1 1  ON 28
 eO_9                 1.858818e-02 1 1  ON 29
eH1_0                -1.817892e-01 1 1  ON 30
eH1_1                -1.031219e-01 1 1  ON 31
eH1_2                -6.299482e-02 1 1  ON 32
eH1_3                -2.639445e-02 1 1  ON 33
eH1_4                 1.898253e-02 1 1  ON 34
eH1_5                 3.327222e-02 1 1  ON 35
eH1_6                 7.809580e-02 1 1  ON 36
eH1_7                 1.100248e-01 1 1  ON 37
eH1_8                 9.330713e-02 1 1  ON 38
eH1_9                 2.512481e-02 1 1  ON 39
eH2_0                -1.837357e-01 1 1  ON 40
eH2_1                -1.046569e-01 1 1  ON 41
eH2_2                -6.445733e-02 1 1  ON 42
eH2_3                -2.788645e-02 1 1  ON 43
eH2_4                 1.779173e-02 1 1  ON 44
eH2_5                 3.281883e-02 1 1  ON 45
eH2_6                 7.990504e-02 1 1  ON 46
eH2_7                 1.143850e-01 1 1  ON 47
eH2_8                 9.619400e-02 1 1  ON 48
eH2_9                 2.724272e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1959
    reference variance = 0.187479
====================================================
  Execution time = 1.9598e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1857e-01
  Total weights = 2.0000e+06
  Execution time = 1.8495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318418865512
                                         uncertainty =       0.003711066517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318418865512
                                         uncertainty =       0.003711066517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399004717
  error estimate for blocks of size 2^( 2) =       0.000408512067
  error estimate for blocks of size 2^( 3) =       0.000417600328
  error estimate for blocks of size 2^( 4) =       0.000423659611
  error estimate for blocks of size 2^( 5) =       0.000427566887
  error estimate for blocks of size 2^( 6) =       0.000429651539
  error estimate for blocks of size 2^( 7) =       0.000432008768

      target function =                  N/A
              le_mean =     -17.216804943513
             les_mean =     296.736781831499
             stat err =       0.000428221701
             autocorr =       1.151811169223
              std dev =       0.564277881657
             le_variance =       0.318409527727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318949564657
                                         uncertainty =       0.003714785390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318949564657
                                         uncertainty =       0.003714785390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399337095
  error estimate for blocks of size 2^( 2) =       0.000408824007
  error estimate for blocks of size 2^( 3) =       0.000417890145
  error estimate for blocks of size 2^( 4) =       0.000423933899
  error estimate for blocks of size 2^( 5) =       0.000427834027
  error estimate for blocks of size 2^( 6) =       0.000429909679
  error estimate for blocks of size 2^( 7) =       0.000432275251

      target function =                  N/A
              le_mean =     -17.216804157701
             les_mean =     296.737285476526
             stat err =       0.000428488214
             autocorr =       1.151326371976
              std dev =       0.564747936118
             le_variance =       0.318940231349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318735147713
                                         uncertainty =       0.003713399273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318735147713
                                         uncertainty =       0.003713399273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399202835
  error estimate for blocks of size 2^( 2) =       0.000408697961
  error estimate for blocks of size 2^( 3) =       0.000417772997
  error estimate for blocks of size 2^( 4) =       0.000423822988
  error estimate for blocks of size 2^( 5) =       0.000427726313
  error estimate for blocks of size 2^( 6) =       0.000429805978
  error estimate for blocks of size 2^( 7) =       0.000432168159

      target function =                  N/A
              le_mean =     -17.216804294967
             les_mean =     296.737075779262
             stat err =       0.000428380860
             autocorr =       1.151523701751
              std dev =       0.564558063813
             le_variance =       0.318725807416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318460104123
                                         uncertainty =       0.003711374315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318460104123
                                         uncertainty =       0.003711374315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399030554
  error estimate for blocks of size 2^( 2) =       0.000408536290
  error estimate for blocks of size 2^( 3) =       0.000417622805
  error estimate for blocks of size 2^( 4) =       0.000423680862
  error estimate for blocks of size 2^( 5) =       0.000427587621
  error estimate for blocks of size 2^( 6) =       0.000429671624
  error estimate for blocks of size 2^( 7) =       0.000432029494

      target function =                  N/A
              le_mean =     -17.216804824714
             les_mean =     296.736818979293
             stat err =       0.000428242400
             autocorr =       1.151773351582
              std dev =       0.564314421408
             le_variance =       0.318450766209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216804943513        initial  <--
     9.5367e-01     9.5367e+00             1.0461e-03       -17.216804157701
     3.8147e+00     3.8147e+01             2.7843e-04       -17.216804294967
     1.5259e+01     1.5259e+02             7.0833e-05       -17.216804824714

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8116
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.087838e-01 1 1  ON 0
 uu_1                 4.771808e-02 1 1  ON 1
 uu_2                -4.545706e-02 1 1  ON 2
 uu_3                -9.917176e-02 1 1  ON 3
 uu_4                -1.320054e-01 1 1  ON 4
 uu_5                -1.387561e-01 1 1  ON 5
 uu_6                -1.151312e-01 1 1  ON 6
 uu_7                -4.163125e-02 1 1  ON 7
 uu_8                 9.831182e-02 1 1  ON 8
 uu_9                 1.228381e-01 1 1  ON 9
 ud_0                 3.482875e-01 1 1  ON 10
 ud_1                 9.216176e-02 1 1  ON 11
 ud_2                -1.440401e-02 1 1  ON 12
 ud_3                -7.285847e-02 1 1  ON 13
 ud_4                -1.199943e-01 1 1  ON 14
 ud_5                -1.531093e-01 1 1  ON 15
 ud_6                -1.564817e-01 1 1  ON 16
 ud_7                -1.117003e-01 1 1  ON 17
 ud_8                 1.574032e-03 1 1  ON 18
 ud_9                 9.250783e-02 1 1  ON 19
 eO_0                -7.578944e-01 1 1  ON 20
 eO_1                -4.439159e-01 1 1  ON 21
 eO_2                -4.478784e-02 1 1  ON 22
 eO_3                 2.042968e-01 1 1  ON 23
 eO_4                 2.982063e-01 1 1  ON 24
 eO_5                 3.146424e-01 1 1  ON 25
 eO_6                 2.546727e-01 1 1  ON 26
 eO_7                 1.168254e-01 1 1  ON 27
 eO_8                 2.865193e-02 1 1  ON 28
 eO_9                 1.858597e-02 1 1  ON 29
eH1_0                -1.817817e-01 1 1  ON 30
eH1_1                -1.031108e-01 1 1  ON 31
eH1_2                -6.299339e-02 1 1  ON 32
eH1_3                -2.642943e-02 1 1  ON 33
eH1_4                 1.898642e-02 1 1  ON 34
eH1_5                 3.327347e-02 1 1  ON 35
eH1_6                 7.811742e-02 1 1  ON 36
eH1_7                 1.100353e-01 1 1  ON 37
eH1_8                 9.329149e-02 1 1  ON 38
eH1_9                 2.511939e-02 1 1  ON 39
eH2_0                -1.837142e-01 1 1  ON 40
eH2_1                -1.046513e-01 1 1  ON 41
eH2_2                -6.445632e-02 1 1  ON 42
eH2_3                -2.791124e-02 1 1  ON 43
eH2_4                 1.778117e-02 1 1  ON 44
eH2_5                 3.283864e-02 1 1  ON 45
eH2_6                 7.991494e-02 1 1  ON 46
eH2_7                 1.143871e-01 1 1  ON 47
eH2_8                 9.617812e-02 1 1  ON 48
eH2_9                 2.723790e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4365e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1404
    reference variance = 0.236958
====================================================
  Execution time = 1.9860e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1751e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611072638
                                         uncertainty =       0.003678019162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317611072638
                                         uncertainty =       0.003678019162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398439214
  error estimate for blocks of size 2^( 2) =       0.000408148159
  error estimate for blocks of size 2^( 3) =       0.000416859965
  error estimate for blocks of size 2^( 4) =       0.000422985933
  error estimate for blocks of size 2^( 5) =       0.000426892650
  error estimate for blocks of size 2^( 6) =       0.000428769727
  error estimate for blocks of size 2^( 7) =       0.000428863921

      target function =                  N/A
              le_mean =     -17.216671894665
             les_mean =     296.731298584019
             stat err =       0.000426878058
             autocorr =       1.147845709449
              std dev =       0.563478139978
             le_variance =       0.317507614233


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667189466e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216671894665       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216672252271       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216672541112       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216672582330       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216672651124       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216672679665       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216672644441       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216672614226       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.045662e-04

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216671894665       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216671985639       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216672060029       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216672069043       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216672086304       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216672094496       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216672085132       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216672077899       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 2.629045e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216671894665       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216671917509       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216671936247       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216671938418       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216671942743       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216671944851       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216671942476       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216671940688       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 6.581915e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5540e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.087903e-01 1 1  ON 0
 uu_1                 4.771983e-02 1 1  ON 1
 uu_2                -4.545521e-02 1 1  ON 2
 uu_3                -9.917597e-02 1 1  ON 3
 uu_4                -1.320077e-01 1 1  ON 4
 uu_5                -1.387562e-01 1 1  ON 5
 uu_6                -1.151319e-01 1 1  ON 6
 uu_7                -4.163481e-02 1 1  ON 7
 uu_8                 9.830932e-02 1 1  ON 8
 uu_9                 1.228396e-01 1 1  ON 9
 ud_0                 3.483034e-01 1 1  ON 10
 ud_1                 9.216646e-02 1 1  ON 11
 ud_2                -1.440702e-02 1 1  ON 12
 ud_3                -7.286920e-02 1 1  ON 13
 ud_4                -1.200001e-01 1 1  ON 14
 ud_5                -1.531064e-01 1 1  ON 15
 ud_6                -1.564804e-01 1 1  ON 16
 ud_7                -1.117028e-01 1 1  ON 17
 ud_8                 1.569793e-03 1 1  ON 18
 ud_9                 9.250772e-02 1 1  ON 19
 eO_0                -7.579207e-01 1 1  ON 20
 eO_1                -4.439307e-01 1 1  ON 21
 eO_2                -4.477566e-02 1 1  ON 22
 eO_3                 2.043115e-01 1 1  ON 23
 eO_4                 2.982118e-01 1 1  ON 24
 eO_5                 3.146451e-01 1 1  ON 25
 eO_6                 2.546755e-01 1 1  ON 26
 eO_7                 1.168280e-01 1 1  ON 27
 eO_8                 2.865219e-02 1 1  ON 28
 eO_9                 1.858619e-02 1 1  ON 29
eH1_0                -1.817820e-01 1 1  ON 30
eH1_1                -1.031141e-01 1 1  ON 31
eH1_2                -6.299518e-02 1 1  ON 32
eH1_3                -2.642821e-02 1 1  ON 33
eH1_4                 1.898903e-02 1 1  ON 34
eH1_5                 3.327498e-02 1 1  ON 35
eH1_6                 7.811537e-02 1 1  ON 36
eH1_7                 1.100350e-01 1 1  ON 37
eH1_8                 9.329322e-02 1 1  ON 38
eH1_9                 2.511986e-02 1 1  ON 39
eH2_0                -1.837132e-01 1 1  ON 40
eH2_1                -1.046529e-01 1 1  ON 41
eH2_2                -6.445741e-02 1 1  ON 42
eH2_3                -2.791000e-02 1 1  ON 43
eH2_4                 1.778227e-02 1 1  ON 44
eH2_5                 3.283835e-02 1 1  ON 45
eH2_6                 7.991374e-02 1 1  ON 46
eH2_7                 1.143857e-01 1 1  ON 47
eH2_8                 9.617945e-02 1 1  ON 48
eH2_9                 2.723850e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1923
    reference variance = 0.225506
====================================================
  Execution time = 1.9371e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0773e-01
  Total weights = 2.0000e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307786892827
                                         uncertainty =       0.002778802714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307786892827
                                         uncertainty =       0.002778802714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392248196
  error estimate for blocks of size 2^( 2) =       0.000402496533
  error estimate for blocks of size 2^( 3) =       0.000411805311
  error estimate for blocks of size 2^( 4) =       0.000417931804
  error estimate for blocks of size 2^( 5) =       0.000422404525
  error estimate for blocks of size 2^( 6) =       0.000424166604
  error estimate for blocks of size 2^( 7) =       0.000424576281

      target function =                  N/A
              le_mean =     -17.216313990249
             les_mean =     296.709184552063
             stat err =       0.000422269803
             autocorr =       1.158932499282
              std dev =       0.554722719079
             le_variance =       0.307717295062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307844537218
                                         uncertainty =       0.002779252406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307844537218
                                         uncertainty =       0.002779252406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392284938
  error estimate for blocks of size 2^( 2) =       0.000402531064
  error estimate for blocks of size 2^( 3) =       0.000411837106
  error estimate for blocks of size 2^( 4) =       0.000417961923
  error estimate for blocks of size 2^( 5) =       0.000422434063
  error estimate for blocks of size 2^( 6) =       0.000424194768
  error estimate for blocks of size 2^( 7) =       0.000424602836

      target function =                  N/A
              le_mean =     -17.216314043394
             les_mean =     296.709244031646
             stat err =       0.000422298398
             autocorr =       1.158872349202
              std dev =       0.554774679275
             le_variance =       0.307774944765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307816214019
                                         uncertainty =       0.002779030824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307816214019
                                         uncertainty =       0.002779030824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392266886
  error estimate for blocks of size 2^( 2) =       0.000402514098
  error estimate for blocks of size 2^( 3) =       0.000411821484
  error estimate for blocks of size 2^( 4) =       0.000417947122
  error estimate for blocks of size 2^( 5) =       0.000422419548
  error estimate for blocks of size 2^( 6) =       0.000424180928
  error estimate for blocks of size 2^( 7) =       0.000424589783

      target function =                  N/A
              le_mean =     -17.216314013968
             les_mean =     296.709214692751
             stat err =       0.000422284345
             autocorr =       1.158901883950
              std dev =       0.554749149667
             le_variance =       0.307746619056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307790572717
                                         uncertainty =       0.002778831330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307790572717
                                         uncertainty =       0.002778831330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392250542
  error estimate for blocks of size 2^( 2) =       0.000402498738
  error estimate for blocks of size 2^( 3) =       0.000411807341
  error estimate for blocks of size 2^( 4) =       0.000417933726
  error estimate for blocks of size 2^( 5) =       0.000422406410
  error estimate for blocks of size 2^( 6) =       0.000424168401
  error estimate for blocks of size 2^( 7) =       0.000424577975

      target function =                  N/A
              le_mean =     -17.216313992925
             les_mean =     296.709188324438
             stat err =       0.000422271628
             autocorr =       1.158928653943
              std dev =       0.554726036263
             le_variance =       0.307720975308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216313990249        initial
     9.5367e+00     9.5367e+01             1.0457e-04       -17.216314043394  <--
     3.8147e+01     3.8147e+02             2.6290e-05       -17.216314013968
     1.5259e+02     1.5259e+03             6.5819e-06       -17.216313992925

*****************************************************************************
Applying the update for shift_i =   9.5367e+00     and shift_s =   9.5367e+01
*****************************************************************************

  Execution time = 2.8572e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.088096e-01 1 1  ON 0
 uu_1                 4.772529e-02 1 1  ON 1
 uu_2                -4.544994e-02 1 1  ON 2
 uu_3                -9.918827e-02 1 1  ON 3
 uu_4                -1.320148e-01 1 1  ON 4
 uu_5                -1.387566e-01 1 1  ON 5
 uu_6                -1.151340e-01 1 1  ON 6
 uu_7                -4.164540e-02 1 1  ON 7
 uu_8                 9.830189e-02 1 1  ON 8
 uu_9                 1.228438e-01 1 1  ON 9
 ud_0                 3.483501e-01 1 1  ON 10
 ud_1                 9.218045e-02 1 1  ON 11
 ud_2                -1.441578e-02 1 1  ON 12
 ud_3                -7.290052e-02 1 1  ON 13
 ud_4                -1.200172e-01 1 1  ON 14
 ud_5                -1.530979e-01 1 1  ON 15
 ud_6                -1.564764e-01 1 1  ON 16
 ud_7                -1.117102e-01 1 1  ON 17
 ud_8                 1.557157e-03 1 1  ON 18
 ud_9                 9.250741e-02 1 1  ON 19
 eO_0                -7.579990e-01 1 1  ON 20
 eO_1                -4.439745e-01 1 1  ON 21
 eO_2                -4.474008e-02 1 1  ON 22
 eO_3                 2.043553e-01 1 1  ON 23
 eO_4                 2.982282e-01 1 1  ON 24
 eO_5                 3.146532e-01 1 1  ON 25
 eO_6                 2.546838e-01 1 1  ON 26
 eO_7                 1.168357e-01 1 1  ON 27
 eO_8                 2.865296e-02 1 1  ON 28
 eO_9                 1.858686e-02 1 1  ON 29
eH1_0                -1.817829e-01 1 1  ON 30
eH1_1                -1.031240e-01 1 1  ON 31
eH1_2                -6.300033e-02 1 1  ON 32
eH1_3                -2.642461e-02 1 1  ON 33
eH1_4                 1.899671e-02 1 1  ON 34
eH1_5                 3.327957e-02 1 1  ON 35
eH1_6                 7.810926e-02 1 1  ON 36
eH1_7                 1.100341e-01 1 1  ON 37
eH1_8                 9.329840e-02 1 1  ON 38
eH1_9                 2.512127e-02 1 1  ON 39
eH2_0                -1.837102e-01 1 1  ON 40
eH2_1                -1.046577e-01 1 1  ON 41
eH2_2                -6.446045e-02 1 1  ON 42
eH2_3                -2.790640e-02 1 1  ON 43
eH2_4                 1.778546e-02 1 1  ON 44
eH2_5                 3.283752e-02 1 1  ON 45
eH2_6                 7.991019e-02 1 1  ON 46
eH2_7                 1.143817e-01 1 1  ON 47
eH2_8                 9.618343e-02 1 1  ON 48
eH2_9                 2.724031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2266
    reference variance = 0.345157
====================================================
  Execution time = 2.2033e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1117e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311127415528
                                         uncertainty =       0.003170479969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311127415528
                                         uncertainty =       0.003170479969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394441277
  error estimate for blocks of size 2^( 2) =       0.000404428205
  error estimate for blocks of size 2^( 3) =       0.000413131361
  error estimate for blocks of size 2^( 4) =       0.000419705614
  error estimate for blocks of size 2^( 5) =       0.000422431376
  error estimate for blocks of size 2^( 6) =       0.000423744158
  error estimate for blocks of size 2^( 7) =       0.000421867009

      target function =                  N/A
              le_mean =     -17.216461178147
             les_mean =     296.717703184327
             stat err =       0.000421937039
             autocorr =       1.144275475876
              std dev =       0.557824202848
             le_variance =       0.311167841283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646117815e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461178147       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461548454       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461888782       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461804171       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461408997       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461721347       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461988373       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216462043405       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216462058673       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 4.049605e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461178147       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461276412       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461364657       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461354279       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461240381       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461318021       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461379821       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216461395764       residual = 6.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.034059e-04

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461178147       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461203096       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461225372       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461223551       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461193964       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461213403       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461228499       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216461232639       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 2.601213e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057553 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7540e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.088204e-01 1 1  ON 0
 uu_1                 4.775026e-02 1 1  ON 1
 uu_2                -4.544981e-02 1 1  ON 2
 uu_3                -9.919047e-02 1 1  ON 3
 uu_4                -1.320123e-01 1 1  ON 4
 uu_5                -1.387582e-01 1 1  ON 5
 uu_6                -1.151480e-01 1 1  ON 6
 uu_7                -4.166463e-02 1 1  ON 7
 uu_8                 9.828965e-02 1 1  ON 8
 uu_9                 1.228479e-01 1 1  ON 9
 ud_0                 3.484183e-01 1 1  ON 10
 ud_1                 9.220715e-02 1 1  ON 11
 ud_2                -1.442805e-02 1 1  ON 12
 ud_3                -7.293856e-02 1 1  ON 13
 ud_4                -1.200379e-01 1 1  ON 14
 ud_5                -1.530912e-01 1 1  ON 15
 ud_6                -1.564783e-01 1 1  ON 16
 ud_7                -1.117236e-01 1 1  ON 17
 ud_8                 1.541915e-03 1 1  ON 18
 ud_9                 9.250438e-02 1 1  ON 19
 eO_0                -7.581024e-01 1 1  ON 20
 eO_1                -4.440344e-01 1 1  ON 21
 eO_2                -4.469106e-02 1 1  ON 22
 eO_3                 2.044112e-01 1 1  ON 23
 eO_4                 2.982572e-01 1 1  ON 24
 eO_5                 3.146644e-01 1 1  ON 25
 eO_6                 2.546904e-01 1 1  ON 26
 eO_7                 1.168454e-01 1 1  ON 27
 eO_8                 2.865437e-02 1 1  ON 28
 eO_9                 1.858715e-02 1 1  ON 29
eH1_0                -1.817905e-01 1 1  ON 30
eH1_1                -1.031364e-01 1 1  ON 31
eH1_2                -6.300348e-02 1 1  ON 32
eH1_3                -2.642250e-02 1 1  ON 33
eH1_4                 1.900586e-02 1 1  ON 34
eH1_5                 3.328453e-02 1 1  ON 35
eH1_6                 7.810997e-02 1 1  ON 36
eH1_7                 1.100322e-01 1 1  ON 37
eH1_8                 9.330443e-02 1 1  ON 38
eH1_9                 2.512309e-02 1 1  ON 39
eH2_0                -1.837053e-01 1 1  ON 40
eH2_1                -1.046531e-01 1 1  ON 41
eH2_2                -6.446619e-02 1 1  ON 42
eH2_3                -2.789955e-02 1 1  ON 43
eH2_4                 1.779229e-02 1 1  ON 44
eH2_5                 3.282437e-02 1 1  ON 45
eH2_6                 7.989891e-02 1 1  ON 46
eH2_7                 1.143803e-01 1 1  ON 47
eH2_8                 9.618970e-02 1 1  ON 48
eH2_9                 2.724195e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1365
    reference variance = 0.46664
====================================================
  Execution time = 1.9966e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1823e-01
  Total weights = 2.0000e+06
  Execution time = 1.8263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318111687345
                                         uncertainty =       0.002962032372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318111687345
                                         uncertainty =       0.002962032372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398855577
  error estimate for blocks of size 2^( 2) =       0.000408763728
  error estimate for blocks of size 2^( 3) =       0.000417486113
  error estimate for blocks of size 2^( 4) =       0.000424853173
  error estimate for blocks of size 2^( 5) =       0.000430250715
  error estimate for blocks of size 2^( 6) =       0.000431935212
  error estimate for blocks of size 2^( 7) =       0.000434454319

      target function =                  N/A
              le_mean =     -17.217205788396
             les_mean =     296.750346543087
             stat err =       0.000430373355
             autocorr =       1.164285298390
              std dev =       0.564066966060
             le_variance =       0.318171542200

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318335576236
                                         uncertainty =       0.002964637071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318335576236
                                         uncertainty =       0.002964637071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398995858
  error estimate for blocks of size 2^( 2) =       0.000408895561
  error estimate for blocks of size 2^( 3) =       0.000417609822
  error estimate for blocks of size 2^( 4) =       0.000424969888
  error estimate for blocks of size 2^( 5) =       0.000430363330
  error estimate for blocks of size 2^( 6) =       0.000432050554
  error estimate for blocks of size 2^( 7) =       0.000434566483

      target function =                  N/A
              le_mean =     -17.217206589721
             les_mean =     296.750597982995
             stat err =       0.000430487564
             autocorr =       1.164084336592
              std dev =       0.564265353402
             le_variance =       0.318395389050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318233328618
                                         uncertainty =       0.002963451635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318233328618
                                         uncertainty =       0.002963451635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398931799
  error estimate for blocks of size 2^( 2) =       0.000408835346
  error estimate for blocks of size 2^( 3) =       0.000417553346
  error estimate for blocks of size 2^( 4) =       0.000424916663
  error estimate for blocks of size 2^( 5) =       0.000430312002
  error estimate for blocks of size 2^( 6) =       0.000431998043
  error estimate for blocks of size 2^( 7) =       0.000434515508

      target function =                  N/A
              le_mean =     -17.217206184664
             les_mean =     296.750481806019
             stat err =       0.000430435554
             autocorr =       1.164176862225
              std dev =       0.564174760101
             le_variance =       0.318293159935

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318127168881
                                         uncertainty =       0.002962213506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318127168881
                                         uncertainty =       0.002962213506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398865278
  error estimate for blocks of size 2^( 2) =       0.000408772841
  error estimate for blocks of size 2^( 3) =       0.000417494666
  error estimate for blocks of size 2^( 4) =       0.000424861250
  error estimate for blocks of size 2^( 5) =       0.000430258511
  error estimate for blocks of size 2^( 6) =       0.000431943205
  error estimate for blocks of size 2^( 7) =       0.000434462104

      target function =                  N/A
              le_mean =     -17.217205835159
             les_mean =     296.750363631875
             stat err =       0.000430381267
             autocorr =       1.164271471048
              std dev =       0.564080686381
             le_variance =       0.318187020748


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217205788396        initial
     2.3842e+00     2.3842e+01             4.0496e-04       -17.217206589721  <--
     9.5367e+00     9.5367e+01             1.0341e-04       -17.217206184664
     3.8147e+01     3.8147e+02             2.6012e-05       -17.217205835159

*****************************************************************************
Applying the update for shift_i =   2.3842e+00     and shift_s =   2.3842e+01
*****************************************************************************

  Execution time = 2.9166e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.088582e-01 1 1  ON 0
 uu_1                 4.781770e-02 1 1  ON 1
 uu_2                -4.544710e-02 1 1  ON 2
 uu_3                -9.919628e-02 1 1  ON 3
 uu_4                -1.320077e-01 1 1  ON 4
 uu_5                -1.387627e-01 1 1  ON 5
 uu_6                -1.151887e-01 1 1  ON 6
 uu_7                -4.172211e-02 1 1  ON 7
 uu_8                 9.825261e-02 1 1  ON 8
 uu_9                 1.228606e-01 1 1  ON 9
 ud_0                 3.486036e-01 1 1  ON 10
 ud_1                 9.228585e-02 1 1  ON 11
 ud_2                -1.445675e-02 1 1  ON 12
 ud_3                -7.303991e-02 1 1  ON 13
 ud_4                -1.201003e-01 1 1  ON 14
 ud_5                -1.530749e-01 1 1  ON 15
 ud_6                -1.564809e-01 1 1  ON 16
 ud_7                -1.117622e-01 1 1  ON 17
 ud_8                 1.495951e-03 1 1  ON 18
 ud_9                 9.249523e-02 1 1  ON 19
 eO_0                -7.584040e-01 1 1  ON 20
 eO_1                -4.442078e-01 1 1  ON 21
 eO_2                -4.456428e-02 1 1  ON 22
 eO_3                 2.045761e-01 1 1  ON 23
 eO_4                 2.983477e-01 1 1  ON 24
 eO_5                 3.147003e-01 1 1  ON 25
 eO_6                 2.547114e-01 1 1  ON 26
 eO_7                 1.168751e-01 1 1  ON 27
 eO_8                 2.865871e-02 1 1  ON 28
 eO_9                 1.858805e-02 1 1  ON 29
eH1_0                -1.818133e-01 1 1  ON 30
eH1_1                -1.031695e-01 1 1  ON 31
eH1_2                -6.301185e-02 1 1  ON 32
eH1_3                -2.642228e-02 1 1  ON 33
eH1_4                 1.903110e-02 1 1  ON 34
eH1_5                 3.330042e-02 1 1  ON 35
eH1_6                 7.811305e-02 1 1  ON 36
eH1_7                 1.100268e-01 1 1  ON 37
eH1_8                 9.332297e-02 1 1  ON 38
eH1_9                 2.512866e-02 1 1  ON 39
eH2_0                -1.836913e-01 1 1  ON 40
eH2_1                -1.046426e-01 1 1  ON 41
eH2_2                -6.448059e-02 1 1  ON 42
eH2_3                -2.788164e-02 1 1  ON 43
eH2_4                 1.781237e-02 1 1  ON 44
eH2_5                 3.278718e-02 1 1  ON 45
eH2_6                 7.986590e-02 1 1  ON 46
eH2_7                 1.143764e-01 1 1  ON 47
eH2_8                 9.620893e-02 1 1  ON 48
eH2_9                 2.724699e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6713e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2996
    reference variance = 0.333214
====================================================
  Execution time = 1.9880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1622e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316231495123
                                         uncertainty =       0.005203351082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316231495123
                                         uncertainty =       0.005203351082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397628855
  error estimate for blocks of size 2^( 2) =       0.000407685594
  error estimate for blocks of size 2^( 3) =       0.000416346991
  error estimate for blocks of size 2^( 4) =       0.000423177801
  error estimate for blocks of size 2^( 5) =       0.000426245785
  error estimate for blocks of size 2^( 6) =       0.000427731659
  error estimate for blocks of size 2^( 7) =       0.000426474815

      target function =                  N/A
              le_mean =     -17.217170301215
             les_mean =     296.747170434802
             stat err =       0.000425907515
             autocorr =       1.147294263689
              std dev =       0.562332118846
             le_variance =       0.316217411886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717030121e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217170301215       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217171009569       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217172124138       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217173369918       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176265601       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217176816385       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217177075442       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217177246705       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217177294442       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217177121107       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 1.529222e-03

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217170301215       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217170535997       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217170893918       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217171212880       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217172149634       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217172198346       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217172212452       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217172257551       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 4.145023e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217170301215       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217170365115       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217170461870       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217170541905       residual = 7.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217170794490       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217170797099       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217170797938       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217170808552       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.058643e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5417e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.089531e-01 1 1  ON 0
 uu_1                 4.783397e-02 1 1  ON 1
 uu_2                -4.543869e-02 1 1  ON 2
 uu_3                -9.923325e-02 1 1  ON 3
 uu_4                -1.320045e-01 1 1  ON 4
 uu_5                -1.388347e-01 1 1  ON 5
 uu_6                -1.152354e-01 1 1  ON 6
 uu_7                -4.173132e-02 1 1  ON 7
 uu_8                 9.823645e-02 1 1  ON 8
 uu_9                 1.228834e-01 1 1  ON 9
 ud_0                 3.488427e-01 1 1  ON 10
 ud_1                 9.235899e-02 1 1  ON 11
 ud_2                -1.453998e-02 1 1  ON 12
 ud_3                -7.318479e-02 1 1  ON 13
 ud_4                -1.202089e-01 1 1  ON 14
 ud_5                -1.530933e-01 1 1  ON 15
 ud_6                -1.564475e-01 1 1  ON 16
 ud_7                -1.117496e-01 1 1  ON 17
 ud_8                 1.458761e-03 1 1  ON 18
 ud_9                 9.249750e-02 1 1  ON 19
 eO_0                -7.588185e-01 1 1  ON 20
 eO_1                -4.444336e-01 1 1  ON 21
 eO_2                -4.441859e-02 1 1  ON 22
 eO_3                 2.047754e-01 1 1  ON 23
 eO_4                 2.984722e-01 1 1  ON 24
 eO_5                 3.147449e-01 1 1  ON 25
 eO_6                 2.547676e-01 1 1  ON 26
 eO_7                 1.169323e-01 1 1  ON 27
 eO_8                 2.866577e-02 1 1  ON 28
 eO_9                 1.858995e-02 1 1  ON 29
eH1_0                -1.818510e-01 1 1  ON 30
eH1_1                -1.031808e-01 1 1  ON 31
eH1_2                -6.302036e-02 1 1  ON 32
eH1_3                -2.642845e-02 1 1  ON 33
eH1_4                 1.904588e-02 1 1  ON 34
eH1_5                 3.331697e-02 1 1  ON 35
eH1_6                 7.810383e-02 1 1  ON 36
eH1_7                 1.100270e-01 1 1  ON 37
eH1_8                 9.335462e-02 1 1  ON 38
eH1_9                 2.513592e-02 1 1  ON 39
eH2_0                -1.837357e-01 1 1  ON 40
eH2_1                -1.046607e-01 1 1  ON 41
eH2_2                -6.449031e-02 1 1  ON 42
eH2_3                -2.786009e-02 1 1  ON 43
eH2_4                 1.781672e-02 1 1  ON 44
eH2_5                 3.280162e-02 1 1  ON 45
eH2_6                 7.986132e-02 1 1  ON 46
eH2_7                 1.143697e-01 1 1  ON 47
eH2_8                 9.623969e-02 1 1  ON 48
eH2_9                 2.725766e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2344
    reference variance = 0.257654
====================================================
  Execution time = 1.9527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2076e-01
  Total weights = 2.0000e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320514999168
                                         uncertainty =       0.005249609030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320514999168
                                         uncertainty =       0.005249609030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400323274
  error estimate for blocks of size 2^( 2) =       0.000409629699
  error estimate for blocks of size 2^( 3) =       0.000418687644
  error estimate for blocks of size 2^( 4) =       0.000424992128
  error estimate for blocks of size 2^( 5) =       0.000428865383
  error estimate for blocks of size 2^( 6) =       0.000431540659
  error estimate for blocks of size 2^( 7) =       0.000430122795

      target function =                  N/A
              le_mean =     -17.216075582359
             les_mean =     296.713775744807
             stat err =       0.000428880241
             autocorr =       1.147758180126
              std dev =       0.566142603565
             le_variance =       0.320517447572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321252377559
                                         uncertainty =       0.005260053276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321252377559
                                         uncertainty =       0.005260053276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400783467
  error estimate for blocks of size 2^( 2) =       0.000410062240
  error estimate for blocks of size 2^( 3) =       0.000419092704
  error estimate for blocks of size 2^( 4) =       0.000425379240
  error estimate for blocks of size 2^( 5) =       0.000429239715
  error estimate for blocks of size 2^( 6) =       0.000431910339
  error estimate for blocks of size 2^( 7) =       0.000430497663

      target function =                  N/A
              le_mean =     -17.216076903200
             les_mean =     296.714558550404
             stat err =       0.000429256739
             autocorr =       1.147135315315
              std dev =       0.566793413990
             le_variance =       0.321254774142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320994739953
                                         uncertainty =       0.005256305109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320994739953
                                         uncertainty =       0.005256305109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400622732
  error estimate for blocks of size 2^( 2) =       0.000409911032
  error estimate for blocks of size 2^( 3) =       0.000418951573
  error estimate for blocks of size 2^( 4) =       0.000425244249
  error estimate for blocks of size 2^( 5) =       0.000429110031
  error estimate for blocks of size 2^( 6) =       0.000431783300
  error estimate for blocks of size 2^( 7) =       0.000430368069

      target function =                  N/A
              le_mean =     -17.216076111985
             les_mean =     296.714273680591
             stat err =       0.000429126412
             autocorr =       1.147358966189
              std dev =       0.566566101561
             le_variance =       0.320997147438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320579467875
                                         uncertainty =       0.005250510621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320579467875
                                         uncertainty =       0.005250510621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400363529
  error estimate for blocks of size 2^( 2) =       0.000409667473
  error estimate for blocks of size 2^( 3) =       0.000418723056
  error estimate for blocks of size 2^( 4) =       0.000425025908
  error estimate for blocks of size 2^( 5) =       0.000428898177
  error estimate for blocks of size 2^( 6) =       0.000431573196
  error estimate for blocks of size 2^( 7) =       0.000430155637

      target function =                  N/A
              le_mean =     -17.216075590978
             les_mean =     296.713840504649
             stat err =       0.000428913230
             autocorr =       1.147703925357
              std dev =       0.566199532550
             le_variance =       0.320581910660


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216075582359        initial
     5.9605e-01     5.9605e+00             1.5292e-03       -17.216076903200  <--
     2.3842e+00     2.3842e+01             4.1450e-04       -17.216076111985
     9.5367e+00     9.5367e+01             1.0586e-04       -17.216075590978

*****************************************************************************
Applying the update for shift_i =   5.9605e-01     and shift_s =   5.9605e+00
*****************************************************************************

  Execution time = 2.8752e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.092083e-01 1 1  ON 0
 uu_1                 4.789232e-02 1 1  ON 1
 uu_2                -4.541117e-02 1 1  ON 2
 uu_3                -9.931696e-02 1 1  ON 3
 uu_4                -1.320426e-01 1 1  ON 4
 uu_5                -1.390144e-01 1 1  ON 5
 uu_6                -1.153747e-01 1 1  ON 6
 uu_7                -4.176174e-02 1 1  ON 7
 uu_8                 9.818721e-02 1 1  ON 8
 uu_9                 1.229535e-01 1 1  ON 9
 ud_0                 3.493450e-01 1 1  ON 10
 ud_1                 9.253945e-02 1 1  ON 11
 ud_2                -1.468116e-02 1 1  ON 12
 ud_3                -7.351255e-02 1 1  ON 13
 ud_4                -1.205068e-01 1 1  ON 14
 ud_5                -1.531591e-01 1 1  ON 15
 ud_6                -1.563397e-01 1 1  ON 16
 ud_7                -1.117020e-01 1 1  ON 17
 ud_8                 1.348084e-03 1 1  ON 18
 ud_9                 9.250499e-02 1 1  ON 19
 eO_0                -7.599332e-01 1 1  ON 20
 eO_1                -4.450678e-01 1 1  ON 21
 eO_2                -4.417388e-02 1 1  ON 22
 eO_3                 2.053203e-01 1 1  ON 23
 eO_4                 2.988807e-01 1 1  ON 24
 eO_5                 3.149043e-01 1 1  ON 25
 eO_6                 2.549434e-01 1 1  ON 26
 eO_7                 1.171082e-01 1 1  ON 27
 eO_8                 2.868763e-02 1 1  ON 28
 eO_9                 1.859584e-02 1 1  ON 29
eH1_0                -1.819571e-01 1 1  ON 30
eH1_1                -1.032304e-01 1 1  ON 31
eH1_2                -6.303732e-02 1 1  ON 32
eH1_3                -2.645031e-02 1 1  ON 33
eH1_4                 1.907022e-02 1 1  ON 34
eH1_5                 3.337374e-02 1 1  ON 35
eH1_6                 7.808652e-02 1 1  ON 36
eH1_7                 1.100301e-01 1 1  ON 37
eH1_8                 9.345206e-02 1 1  ON 38
eH1_9                 2.515829e-02 1 1  ON 39
eH2_0                -1.838560e-01 1 1  ON 40
eH2_1                -1.047110e-01 1 1  ON 41
eH2_2                -6.450725e-02 1 1  ON 42
eH2_3                -2.783847e-02 1 1  ON 43
eH2_4                 1.782190e-02 1 1  ON 44
eH2_5                 3.285198e-02 1 1  ON 45
eH2_6                 7.985672e-02 1 1  ON 46
eH2_7                 1.143517e-01 1 1  ON 47
eH2_8                 9.633437e-02 1 1  ON 48
eH2_9                 2.729049e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1329
    reference variance = 0.251535
====================================================
  Execution time = 2.1476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325438438576
                                         uncertainty =       0.012368591956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325438438576
                                         uncertainty =       0.012368591956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403366219
  error estimate for blocks of size 2^( 2) =       0.000413046304
  error estimate for blocks of size 2^( 3) =       0.000421362103
  error estimate for blocks of size 2^( 4) =       0.000427845633
  error estimate for blocks of size 2^( 5) =       0.000430371748
  error estimate for blocks of size 2^( 6) =       0.000431116061
  error estimate for blocks of size 2^( 7) =       0.000432440239

      target function =                  N/A
              le_mean =     -17.217515890007
             les_mean =     296.768261873207
             stat err =       0.000430443420
             autocorr =       1.138762347197
              std dev =       0.570445977509
             le_variance =       0.325408613257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721751589001e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217515890007       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217521121250       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217522040473       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217525219640       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217527922697       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217527901465       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217529644103       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217529682532       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217529995487       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217530312482       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217530457298       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217530467956       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 4.395485e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217515890007       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217518296123       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217518851215       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217519983773       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217520988039       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217521043014       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217520877558       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217521100905       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217521124906       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 1.423748e-03

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217515890007       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217516651389       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217516868053       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217517178026       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217517437234       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217517486590       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217517408995       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217517438918       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217517444569       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 3.990245e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064401 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7087e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.094531e-01 1 1  ON 0
 uu_1                 4.814272e-02 1 1  ON 1
 uu_2                -4.544258e-02 1 1  ON 2
 uu_3                -9.926698e-02 1 1  ON 3
 uu_4                -1.321071e-01 1 1  ON 4
 uu_5                -1.389926e-01 1 1  ON 5
 uu_6                -1.155695e-01 1 1  ON 6
 uu_7                -4.203730e-02 1 1  ON 7
 uu_8                 9.801825e-02 1 1  ON 8
 uu_9                 1.230443e-01 1 1  ON 9
 ud_0                 3.497668e-01 1 1  ON 10
 ud_1                 9.284886e-02 1 1  ON 11
 ud_2                -1.466443e-02 1 1  ON 12
 ud_3                -7.383699e-02 1 1  ON 13
 ud_4                -1.207615e-01 1 1  ON 14
 ud_5                -1.531593e-01 1 1  ON 15
 ud_6                -1.563316e-01 1 1  ON 16
 ud_7                -1.117808e-01 1 1  ON 17
 ud_8                 1.194580e-03 1 1  ON 18
 ud_9                 9.249951e-02 1 1  ON 19
 eO_0                -7.613569e-01 1 1  ON 20
 eO_1                -4.456768e-01 1 1  ON 21
 eO_2                -4.394990e-02 1 1  ON 22
 eO_3                 2.060447e-01 1 1  ON 23
 eO_4                 2.993714e-01 1 1  ON 24
 eO_5                 3.151165e-01 1 1  ON 25
 eO_6                 2.551036e-01 1 1  ON 26
 eO_7                 1.172866e-01 1 1  ON 27
 eO_8                 2.871825e-02 1 1  ON 28
 eO_9                 1.860613e-02 1 1  ON 29
eH1_0                -1.820025e-01 1 1  ON 30
eH1_1                -1.032765e-01 1 1  ON 31
eH1_2                -6.307223e-02 1 1  ON 32
eH1_3                -2.637577e-02 1 1  ON 33
eH1_4                 1.901236e-02 1 1  ON 34
eH1_5                 3.341384e-02 1 1  ON 35
eH1_6                 7.804694e-02 1 1  ON 36
eH1_7                 1.099999e-01 1 1  ON 37
eH1_8                 9.355001e-02 1 1  ON 38
eH1_9                 2.519361e-02 1 1  ON 39
eH2_0                -1.840390e-01 1 1  ON 40
eH2_1                -1.048336e-01 1 1  ON 41
eH2_2                -6.452942e-02 1 1  ON 42
eH2_3                -2.767795e-02 1 1  ON 43
eH2_4                 1.793128e-02 1 1  ON 44
eH2_5                 3.287773e-02 1 1  ON 45
eH2_6                 7.981522e-02 1 1  ON 46
eH2_7                 1.143111e-01 1 1  ON 47
eH2_8                 9.641243e-02 1 1  ON 48
eH2_9                 2.732051e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.254
    reference variance = 0.208979
====================================================
  Execution time = 1.9742e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1292e-01
  Total weights = 2.0000e+06
  Execution time = 1.8646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312648602567
                                         uncertainty =       0.002886386811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312648602567
                                         uncertainty =       0.002886386811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395315749
  error estimate for blocks of size 2^( 2) =       0.000404802805
  error estimate for blocks of size 2^( 3) =       0.000413634978
  error estimate for blocks of size 2^( 4) =       0.000420421659
  error estimate for blocks of size 2^( 5) =       0.000424776358
  error estimate for blocks of size 2^( 6) =       0.000426345417
  error estimate for blocks of size 2^( 7) =       0.000428092813

      target function =                  N/A
              le_mean =     -17.216845249732
             les_mean =     296.732309280075
             stat err =       0.000424909062
             autocorr =       1.155323886539
              std dev =       0.559060893927
             le_variance =       0.312549083118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662231993
                                         uncertainty =       0.002893009005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313662231993
                                         uncertainty =       0.002893009005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395956027
  error estimate for blocks of size 2^( 2) =       0.000405403237
  error estimate for blocks of size 2^( 3) =       0.000414190755
  error estimate for blocks of size 2^( 4) =       0.000420946158
  error estimate for blocks of size 2^( 5) =       0.000425288475
  error estimate for blocks of size 2^( 6) =       0.000426856911
  error estimate for blocks of size 2^( 7) =       0.000428595758

      target function =                  N/A
              le_mean =     -17.216847994500
             les_mean =     296.733417058801
             stat err =       0.000425421825
             autocorr =       1.154371559769
              std dev =       0.559966382803
             le_variance =       0.313562349870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313393756033
                                         uncertainty =       0.002891547515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313393756033
                                         uncertainty =       0.002891547515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395786561
  error estimate for blocks of size 2^( 2) =       0.000405243501
  error estimate for blocks of size 2^( 3) =       0.000414043392
  error estimate for blocks of size 2^( 4) =       0.000420807522
  error estimate for blocks of size 2^( 5) =       0.000425151448
  error estimate for blocks of size 2^( 6) =       0.000426722480
  error estimate for blocks of size 2^( 7) =       0.000428465459

      target function =                  N/A
              le_mean =     -17.216847249174
             les_mean =     296.733123048026
             stat err =       0.000425286727
             autocorr =       1.154626634931
              std dev =       0.559726721974
             le_variance =       0.313294003291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312753954616
                                         uncertainty =       0.002887155668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312753954616
                                         uncertainty =       0.002887155668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395382350
  error estimate for blocks of size 2^( 2) =       0.000404864821
  error estimate for blocks of size 2^( 3) =       0.000413692186
  error estimate for blocks of size 2^( 4) =       0.000420475562
  error estimate for blocks of size 2^( 5) =       0.000424828527
  error estimate for blocks of size 2^( 6) =       0.000426398072
  error estimate for blocks of size 2^( 7) =       0.000428144764

      target function =                  N/A
              le_mean =     -17.216845234646
             les_mean =     296.732414082492
             stat err =       0.000424961731
             autocorr =       1.155221036918
              std dev =       0.559155081410
             le_variance =       0.312654405067


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216845249732        initial
     1.4901e-01     1.4901e+00             4.3955e-03       -17.216847994500  <--
     5.9605e-01     5.9605e+00             1.4237e-03       -17.216847249174
     2.3842e+00     2.3842e+01             3.9902e-04       -17.216845234646

*****************************************************************************
Applying the update for shift_i =   1.4901e-01     and shift_s =   1.4901e+00
*****************************************************************************

  Execution time = 2.9154e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.101778e-01 1 1  ON 0
 uu_1                 4.870188e-02 1 1  ON 1
 uu_2                -4.521894e-02 1 1  ON 2
 uu_3                -9.920496e-02 1 1  ON 3
 uu_4                -1.322373e-01 1 1  ON 4
 uu_5                -1.391915e-01 1 1  ON 5
 uu_6                -1.160345e-01 1 1  ON 6
 uu_7                -4.281336e-02 1 1  ON 7
 uu_8                 9.750569e-02 1 1  ON 8
 uu_9                 1.233207e-01 1 1  ON 9
 ud_0                 3.505761e-01 1 1  ON 10
 ud_1                 9.339011e-02 1 1  ON 11
 ud_2                -1.454211e-02 1 1  ON 12
 ud_3                -7.420872e-02 1 1  ON 13
 ud_4                -1.212516e-01 1 1  ON 14
 ud_5                -1.533790e-01 1 1  ON 15
 ud_6                -1.562887e-01 1 1  ON 16
 ud_7                -1.119414e-01 1 1  ON 17
 ud_8                 7.490531e-04 1 1  ON 18
 ud_9                 9.248419e-02 1 1  ON 19
 eO_0                -7.643287e-01 1 1  ON 20
 eO_1                -4.474474e-01 1 1  ON 21
 eO_2                -4.405484e-02 1 1  ON 22
 eO_3                 2.073154e-01 1 1  ON 23
 eO_4                 3.009440e-01 1 1  ON 24
 eO_5                 3.159152e-01 1 1  ON 25
 eO_6                 2.556285e-01 1 1  ON 26
 eO_7                 1.178361e-01 1 1  ON 27
 eO_8                 2.881214e-02 1 1  ON 28
 eO_9                 1.863752e-02 1 1  ON 29
eH1_0                -1.821192e-01 1 1  ON 30
eH1_1                -1.034233e-01 1 1  ON 31
eH1_2                -6.309242e-02 1 1  ON 32
eH1_3                -2.630397e-02 1 1  ON 33
eH1_4                 1.888023e-02 1 1  ON 34
eH1_5                 3.344858e-02 1 1  ON 35
eH1_6                 7.799453e-02 1 1  ON 36
eH1_7                 1.099316e-01 1 1  ON 37
eH1_8                 9.385248e-02 1 1  ON 38
eH1_9                 2.530178e-02 1 1  ON 39
eH2_0                -1.844177e-01 1 1  ON 40
eH2_1                -1.050975e-01 1 1  ON 41
eH2_2                -6.451844e-02 1 1  ON 42
eH2_3                -2.749684e-02 1 1  ON 43
eH2_4                 1.811394e-02 1 1  ON 44
eH2_5                 3.294873e-02 1 1  ON 45
eH2_6                 7.976360e-02 1 1  ON 46
eH2_7                 1.142074e-01 1 1  ON 47
eH2_8                 9.665334e-02 1 1  ON 48
eH2_9                 2.741256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2758
    reference variance = 0.435349
====================================================
  Execution time = 1.9961e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1383e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313756802896
                                         uncertainty =       0.002975562444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313756802896
                                         uncertainty =       0.002975562444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396126903
  error estimate for blocks of size 2^( 2) =       0.000406383056
  error estimate for blocks of size 2^( 3) =       0.000415023282
  error estimate for blocks of size 2^( 4) =       0.000421446962
  error estimate for blocks of size 2^( 5) =       0.000426631197
  error estimate for blocks of size 2^( 6) =       0.000430489746
  error estimate for blocks of size 2^( 7) =       0.000431590145

      target function =                  N/A
              le_mean =     -17.216606602576
             les_mean =     296.725375796817
             stat err =       0.000427539512
             autocorr =       1.164887107325
              std dev =       0.560208038038
             le_variance =       0.313833045882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660660258e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-02, overlap shift 3.7253e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216606602576       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216606764065       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609831518       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216613909571       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216619252747       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216624399019       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216626267471       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216622317891       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216622192471       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216622262705       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216626058251       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216625931767       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216626998287       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216626952040       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216626531510       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216626240643       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-02 is 9.536302e-03

solving harmonic davidson linear method for identity shift 1.4901e-01, overlap shift 1.4901e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216606602576       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216606713740       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216608477156       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216610478438       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216613523603       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216615406308       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216615546355       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216614136868       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216614060476       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216613848641       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216614331613       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e-01 is 3.386253e-03

solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216606602576       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216606652058       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216607337016       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216607809626       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216608823795       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216609328716       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216609242264       residual = 5.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216609040808       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216609034830       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 1.030534e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070463 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5539e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.109815e-01 1 1  ON 0
 uu_1                 4.917029e-02 1 1  ON 1
 uu_2                -4.488605e-02 1 1  ON 2
 uu_3                -9.933887e-02 1 1  ON 3
 uu_4                -1.324745e-01 1 1  ON 4
 uu_5                -1.394959e-01 1 1  ON 5
 uu_6                -1.163365e-01 1 1  ON 6
 uu_7                -4.362147e-02 1 1  ON 7
 uu_8                 9.700130e-02 1 1  ON 8
 uu_9                 1.236511e-01 1 1  ON 9
 ud_0                 3.513143e-01 1 1  ON 10
 ud_1                 9.397040e-02 1 1  ON 11
 ud_2                -1.443404e-02 1 1  ON 12
 ud_3                -7.452437e-02 1 1  ON 13
 ud_4                -1.217402e-01 1 1  ON 14
 ud_5                -1.534595e-01 1 1  ON 15
 ud_6                -1.559417e-01 1 1  ON 16
 ud_7                -1.121044e-01 1 1  ON 17
 ud_8                -1.614520e-04 1 1  ON 18
 ud_9                 9.236020e-02 1 1  ON 19
 eO_0                -7.677149e-01 1 1  ON 20
 eO_1                -4.497577e-01 1 1  ON 21
 eO_2                -4.438915e-02 1 1  ON 22
 eO_3                 2.086788e-01 1 1  ON 23
 eO_4                 3.026607e-01 1 1  ON 24
 eO_5                 3.170027e-01 1 1  ON 25
 eO_6                 2.565415e-01 1 1  ON 26
 eO_7                 1.186275e-01 1 1  ON 27
 eO_8                 2.890800e-02 1 1  ON 28
 eO_9                 1.867055e-02 1 1  ON 29
eH1_0                -1.822776e-01 1 1  ON 30
eH1_1                -1.035668e-01 1 1  ON 31
eH1_2                -6.295228e-02 1 1  ON 32
eH1_3                -2.610496e-02 1 1  ON 33
eH1_4                 1.877891e-02 1 1  ON 34
eH1_5                 3.305704e-02 1 1  ON 35
eH1_6                 7.795518e-02 1 1  ON 36
eH1_7                 1.099211e-01 1 1  ON 37
eH1_8                 9.421158e-02 1 1  ON 38
eH1_9                 2.541799e-02 1 1  ON 39
eH2_0                -1.842620e-01 1 1  ON 40
eH2_1                -1.051373e-01 1 1  ON 41
eH2_2                -6.439018e-02 1 1  ON 42
eH2_3                -2.753230e-02 1 1  ON 43
eH2_4                 1.808027e-02 1 1  ON 44
eH2_5                 3.243556e-02 1 1  ON 45
eH2_6                 7.948897e-02 1 1  ON 46
eH2_7                 1.141620e-01 1 1  ON 47
eH2_8                 9.715115e-02 1 1  ON 48
eH2_9                 2.754822e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2781
    reference variance = 0.239403
====================================================
  Execution time = 1.9880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2084e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320270758279
                                         uncertainty =       0.004361863076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320270758279
                                         uncertainty =       0.004361863076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400143843
  error estimate for blocks of size 2^( 2) =       0.000409771499
  error estimate for blocks of size 2^( 3) =       0.000418792347
  error estimate for blocks of size 2^( 4) =       0.000425516226
  error estimate for blocks of size 2^( 5) =       0.000430088835
  error estimate for blocks of size 2^( 6) =       0.000432174573
  error estimate for blocks of size 2^( 7) =       0.000434156588

      target function =                  N/A
              le_mean =     -17.216706505873
             les_mean =     296.735212939307
             stat err =       0.000430484056
             autocorr =       1.157395697618
              std dev =       0.565888849566
             le_variance =       0.320230190063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321553987478
                                         uncertainty =       0.004380697554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321553987478
                                         uncertainty =       0.004380697554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400944982
  error estimate for blocks of size 2^( 2) =       0.000410530219
  error estimate for blocks of size 2^( 3) =       0.000419496976
  error estimate for blocks of size 2^( 4) =       0.000426174794
  error estimate for blocks of size 2^( 5) =       0.000430731938
  error estimate for blocks of size 2^( 6) =       0.000432786552
  error estimate for blocks of size 2^( 7) =       0.000434727703

      target function =                  N/A
              le_mean =     -17.216705634795
             les_mean =     296.736466511969
             stat err =       0.000431105247
             autocorr =       1.156104393240
              std dev =       0.567021831619
             le_variance =       0.321513757533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321504019603
                                         uncertainty =       0.004381862919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321504019603
                                         uncertainty =       0.004381862919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400913926
  error estimate for blocks of size 2^( 2) =       0.000410501902
  error estimate for blocks of size 2^( 3) =       0.000419475622
  error estimate for blocks of size 2^( 4) =       0.000426160088
  error estimate for blocks of size 2^( 5) =       0.000430718770
  error estimate for blocks of size 2^( 6) =       0.000432768236
  error estimate for blocks of size 2^( 7) =       0.000434709981

      target function =                  N/A
              le_mean =     -17.216702158872
             les_mean =     296.736297018780
             stat err =       0.000431089269
             autocorr =       1.156197802454
              std dev =       0.566977911553
             le_variance =       0.321463952189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320456749442
                                         uncertainty =       0.004365469896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320456749442
                                         uncertainty =       0.004365469896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400260096
  error estimate for blocks of size 2^( 2) =       0.000409880572
  error estimate for blocks of size 2^( 3) =       0.000418893309
  error estimate for blocks of size 2^( 4) =       0.000425610800
  error estimate for blocks of size 2^( 5) =       0.000430181286
  error estimate for blocks of size 2^( 6) =       0.000432259912
  error estimate for blocks of size 2^( 7) =       0.000434234897

      target function =                  N/A
              le_mean =     -17.216704404783
             les_mean =     296.735326690974
             stat err =       0.000430571724
             autocorr =       1.157194658584
              std dev =       0.566053256791
             le_variance =       0.320416289523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216706505873        initial  <--
     3.7253e-02     3.7253e-01             9.5363e-03       -17.216705634795
     1.4901e-01     1.4901e+00             3.3863e-03       -17.216702158872
     5.9605e-01     5.9605e+00             1.0305e-03       -17.216704404783

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3188
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.101778e-01 1 1  ON 0
 uu_1                 4.870188e-02 1 1  ON 1
 uu_2                -4.521894e-02 1 1  ON 2
 uu_3                -9.920496e-02 1 1  ON 3
 uu_4                -1.322373e-01 1 1  ON 4
 uu_5                -1.391915e-01 1 1  ON 5
 uu_6                -1.160345e-01 1 1  ON 6
 uu_7                -4.281336e-02 1 1  ON 7
 uu_8                 9.750569e-02 1 1  ON 8
 uu_9                 1.233207e-01 1 1  ON 9
 ud_0                 3.505761e-01 1 1  ON 10
 ud_1                 9.339011e-02 1 1  ON 11
 ud_2                -1.454211e-02 1 1  ON 12
 ud_3                -7.420872e-02 1 1  ON 13
 ud_4                -1.212516e-01 1 1  ON 14
 ud_5                -1.533790e-01 1 1  ON 15
 ud_6                -1.562887e-01 1 1  ON 16
 ud_7                -1.119414e-01 1 1  ON 17
 ud_8                 7.490531e-04 1 1  ON 18
 ud_9                 9.248419e-02 1 1  ON 19
 eO_0                -7.643287e-01 1 1  ON 20
 eO_1                -4.474474e-01 1 1  ON 21
 eO_2                -4.405484e-02 1 1  ON 22
 eO_3                 2.073154e-01 1 1  ON 23
 eO_4                 3.009440e-01 1 1  ON 24
 eO_5                 3.159152e-01 1 1  ON 25
 eO_6                 2.556285e-01 1 1  ON 26
 eO_7                 1.178361e-01 1 1  ON 27
 eO_8                 2.881214e-02 1 1  ON 28
 eO_9                 1.863752e-02 1 1  ON 29
eH1_0                -1.821192e-01 1 1  ON 30
eH1_1                -1.034233e-01 1 1  ON 31
eH1_2                -6.309242e-02 1 1  ON 32
eH1_3                -2.630397e-02 1 1  ON 33
eH1_4                 1.888023e-02 1 1  ON 34
eH1_5                 3.344858e-02 1 1  ON 35
eH1_6                 7.799453e-02 1 1  ON 36
eH1_7                 1.099316e-01 1 1  ON 37
eH1_8                 9.385248e-02 1 1  ON 38
eH1_9                 2.530178e-02 1 1  ON 39
eH2_0                -1.844177e-01 1 1  ON 40
eH2_1                -1.050975e-01 1 1  ON 41
eH2_2                -6.451844e-02 1 1  ON 42
eH2_3                -2.749684e-02 1 1  ON 43
eH2_4                 1.811394e-02 1 1  ON 44
eH2_5                 3.294873e-02 1 1  ON 45
eH2_6                 7.976360e-02 1 1  ON 46
eH2_7                 1.142074e-01 1 1  ON 47
eH2_8                 9.665334e-02 1 1  ON 48
eH2_9                 2.741256e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2073
    reference variance = 0.251159
====================================================
  Execution time = 2.0143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2078e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320842359297
                                         uncertainty =       0.003897085263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320842359297
                                         uncertainty =       0.003897085263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400485235
  error estimate for blocks of size 2^( 2) =       0.000410301264
  error estimate for blocks of size 2^( 3) =       0.000418846041
  error estimate for blocks of size 2^( 4) =       0.000424953598
  error estimate for blocks of size 2^( 5) =       0.000428825301
  error estimate for blocks of size 2^( 6) =       0.000430914260
  error estimate for blocks of size 2^( 7) =       0.000429070225

      target function =                  N/A
              le_mean =     -17.216506940498
             les_mean =     296.728887918153
             stat err =       0.000428440846
             autocorr =       1.144481345162
              std dev =       0.566371650355
             le_variance =       0.320776846325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650694050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506940498       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506667644       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216507300285       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506412107       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216505769484       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506631511       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216506491955       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216507013156       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216506869293       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216506927252       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 1.499403e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506940498       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506851599       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216507097304       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506824556       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506731229       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506887561       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216506872456       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216506962722       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 4.075699e-04

solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216506940498       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216506916450       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216506986532       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216506920808       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216506905101       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216506934637       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216506931574       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216506948200       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 1.040252e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073487 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5737e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.102431e-01 1 1  ON 0
 uu_1                 4.876293e-02 1 1  ON 1
 uu_2                -4.517330e-02 1 1  ON 2
 uu_3                -9.921161e-02 1 1  ON 3
 uu_4                -1.322468e-01 1 1  ON 4
 uu_5                -1.392268e-01 1 1  ON 5
 uu_6                -1.161400e-01 1 1  ON 6
 uu_7                -4.291654e-02 1 1  ON 7
 uu_8                 9.745939e-02 1 1  ON 8
 uu_9                 1.233783e-01 1 1  ON 9
 ud_0                 3.507752e-01 1 1  ON 10
 ud_1                 9.341812e-02 1 1  ON 11
 ud_2                -1.455284e-02 1 1  ON 12
 ud_3                -7.427065e-02 1 1  ON 13
 ud_4                -1.213769e-01 1 1  ON 14
 ud_5                -1.533742e-01 1 1  ON 15
 ud_6                -1.562866e-01 1 1  ON 16
 ud_7                -1.119926e-01 1 1  ON 17
 ud_8                 6.817056e-04 1 1  ON 18
 ud_9                 9.250459e-02 1 1  ON 19
 eO_0                -7.647362e-01 1 1  ON 20
 eO_1                -4.476925e-01 1 1  ON 21
 eO_2                -4.405750e-02 1 1  ON 22
 eO_3                 2.075183e-01 1 1  ON 23
 eO_4                 3.011571e-01 1 1  ON 24
 eO_5                 3.159922e-01 1 1  ON 25
 eO_6                 2.556796e-01 1 1  ON 26
 eO_7                 1.179084e-01 1 1  ON 27
 eO_8                 2.883291e-02 1 1  ON 28
 eO_9                 1.864799e-02 1 1  ON 29
eH1_0                -1.822026e-01 1 1  ON 30
eH1_1                -1.034111e-01 1 1  ON 31
eH1_2                -6.306100e-02 1 1  ON 32
eH1_3                -2.634050e-02 1 1  ON 33
eH1_4                 1.890764e-02 1 1  ON 34
eH1_5                 3.343371e-02 1 1  ON 35
eH1_6                 7.796930e-02 1 1  ON 36
eH1_7                 1.099362e-01 1 1  ON 37
eH1_8                 9.391036e-02 1 1  ON 38
eH1_9                 2.532095e-02 1 1  ON 39
eH2_0                -1.843593e-01 1 1  ON 40
eH2_1                -1.051083e-01 1 1  ON 41
eH2_2                -6.448369e-02 1 1  ON 42
eH2_3                -2.755087e-02 1 1  ON 43
eH2_4                 1.806782e-02 1 1  ON 44
eH2_5                 3.299117e-02 1 1  ON 45
eH2_6                 7.972169e-02 1 1  ON 46
eH2_7                 1.141678e-01 1 1  ON 47
eH2_8                 9.668535e-02 1 1  ON 48
eH2_9                 2.742691e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.3034
    reference variance = 0.301622
====================================================
  Execution time = 1.9836e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1714e-01
  Total weights = 2.0000e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316842881643
                                         uncertainty =       0.003432391232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316842881643
                                         uncertainty =       0.003432391232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398104496
  error estimate for blocks of size 2^( 2) =       0.000408119341
  error estimate for blocks of size 2^( 3) =       0.000415894488
  error estimate for blocks of size 2^( 4) =       0.000422627840
  error estimate for blocks of size 2^( 5) =       0.000426255998
  error estimate for blocks of size 2^( 6) =       0.000428121583
  error estimate for blocks of size 2^( 7) =       0.000430050433

      target function =                  N/A
              le_mean =     -17.216527956410
             les_mean =     296.725809094603
             stat err =       0.000426763963
             autocorr =       1.149162155399
              std dev =       0.563004777273
             le_variance =       0.316974379232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317319029714
                                         uncertainty =       0.003436284611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317319029714
                                         uncertainty =       0.003436284611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398403603
  error estimate for blocks of size 2^( 2) =       0.000408403101
  error estimate for blocks of size 2^( 3) =       0.000416160781
  error estimate for blocks of size 2^( 4) =       0.000422884804
  error estimate for blocks of size 2^( 5) =       0.000426505614
  error estimate for blocks of size 2^( 6) =       0.000428367266
  error estimate for blocks of size 2^( 7) =       0.000430272955

      target function =                  N/A
              le_mean =     -17.216528949264
             les_mean =     296.726319764367
             stat err =       0.000427007660
             autocorr =       1.148748125632
              std dev =       0.563427779078
             le_variance =       0.317450862236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317184985294
                                         uncertainty =       0.003435310317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317184985294
                                         uncertainty =       0.003435310317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398319446
  error estimate for blocks of size 2^( 2) =       0.000408323516
  error estimate for blocks of size 2^( 3) =       0.000416087030
  error estimate for blocks of size 2^( 4) =       0.000422814868
  error estimate for blocks of size 2^( 5) =       0.000426438841
  error estimate for blocks of size 2^( 6) =       0.000428302878
  error estimate for blocks of size 2^( 7) =       0.000430216292

      target function =                  N/A
              le_mean =     -17.216528622777
             les_mean =     296.726174423114
             stat err =       0.000426943220
             autocorr =       1.148886754898
              std dev =       0.563308763347
             le_variance =       0.317316762864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316891867405
                                         uncertainty =       0.003432842453

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316891867405
                                         uncertainty =       0.003432842453

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398135283
  error estimate for blocks of size 2^( 2) =       0.000408148594
  error estimate for blocks of size 2^( 3) =       0.000415922095
  error estimate for blocks of size 2^( 4) =       0.000422654716
  error estimate for blocks of size 2^( 5) =       0.000426282313
  error estimate for blocks of size 2^( 6) =       0.000428147745
  error estimate for blocks of size 2^( 7) =       0.000430074426

      target function =                  N/A
              le_mean =     -17.216528034798
             les_mean =     296.725860821463
             stat err =       0.000426789800
             autocorr =       1.149123561856
              std dev =       0.563048316760
             le_variance =       0.317023407006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216527956410        initial
     3.7253e-01     3.7253e+00             1.4994e-03       -17.216528949264  <--
     1.4901e+00     1.4901e+01             4.0757e-04       -17.216528622777
     5.9605e+00     5.9605e+01             1.0403e-04       -17.216528034798

*****************************************************************************
Applying the update for shift_i =   3.7253e-01     and shift_s =   3.7253e+00
*****************************************************************************

  Execution time = 2.9230e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.104683e-01 1 1  ON 0
 uu_1                 4.891990e-02 1 1  ON 1
 uu_2                -4.507202e-02 1 1  ON 2
 uu_3                -9.921724e-02 1 1  ON 3
 uu_4                -1.323005e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321672e-02 1 1  ON 7
 uu_8                 9.731998e-02 1 1  ON 8
 uu_9                 1.235531e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355829e-02 1 1  ON 11
 ud_2                -1.454381e-02 1 1  ON 12
 ud_3                -7.438779e-02 1 1  ON 13
 ud_4                -1.216538e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.829050e-04 1 1  ON 18
 ud_9                 9.256694e-02 1 1  ON 19
 eO_0                -7.658281e-01 1 1  ON 20
 eO_1                -4.483867e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080075e-01 1 1  ON 23
 eO_4                 3.017981e-01 1 1  ON 24
 eO_5                 3.162546e-01 1 1  ON 25
 eO_6                 2.558443e-01 1 1  ON 26
 eO_7                 1.181293e-01 1 1  ON 27
 eO_8                 2.889609e-02 1 1  ON 28
 eO_9                 1.867977e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034055e-01 1 1  ON 31
eH1_2                -6.301840e-02 1 1  ON 32
eH1_3                -2.641638e-02 1 1  ON 33
eH1_4                 1.893976e-02 1 1  ON 34
eH1_5                 3.340001e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408678e-02 1 1  ON 38
eH1_9                 2.537924e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443400e-02 1 1  ON 42
eH2_3                -2.763391e-02 1 1  ON 43
eH2_4                 1.795684e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960940e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678345e-02 1 1  ON 48
eH2_9                 2.747056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2365
    reference variance = 0.268432
====================================================
  Execution time = 2.0397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4322e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343344087788
                                         uncertainty =       0.015374849906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343344087788
                                         uncertainty =       0.015374849906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414260539
  error estimate for blocks of size 2^( 2) =       0.000423587412
  error estimate for blocks of size 2^( 3) =       0.000431927414
  error estimate for blocks of size 2^( 4) =       0.000438066394
  error estimate for blocks of size 2^( 5) =       0.000442030264
  error estimate for blocks of size 2^( 6) =       0.000443912096
  error estimate for blocks of size 2^( 7) =       0.000445473816

      target function =                  N/A
              le_mean =     -17.217435071388
             les_mean =     296.783293854544
             stat err =       0.000442370643
             autocorr =       1.140316645054
              std dev =       0.585852872916
             le_variance =       0.343223588704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721743507139e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-02, overlap shift 9.3132e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217435071388       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217435036607       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217436300123       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217439830650       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217440821816       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217443531643       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217443520261       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217443804541       residual = 9.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217443822041       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217443747268       residual = 3.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217443166991       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-02 is 3.683424e-03

solving harmonic davidson linear method for identity shift 3.7253e-01, overlap shift 3.7253e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217435071388       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217435054315       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217435816130       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217437361987       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217437596917       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217438314988       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217438148974       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217438136778       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217438136342       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e-01 is 1.087421e-03

solving harmonic davidson linear method for identity shift 1.4901e+00, overlap shift 1.4901e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217435071388       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217435065765       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217435355213       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217435832042       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217435880782       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217436051015       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217436003843       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217436009097       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+00 is 2.761825e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076982 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6018e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.108451e-01 1 1  ON 0
 uu_1                 4.900014e-02 1 1  ON 1
 uu_2                -4.495282e-02 1 1  ON 2
 uu_3                -9.922455e-02 1 1  ON 3
 uu_4                -1.325424e-01 1 1  ON 4
 uu_5                -1.395024e-01 1 1  ON 5
 uu_6                -1.165736e-01 1 1  ON 6
 uu_7                -4.337651e-02 1 1  ON 7
 uu_8                 9.716846e-02 1 1  ON 8
 uu_9                 1.236948e-01 1 1  ON 9
 ud_0                 3.514128e-01 1 1  ON 10
 ud_1                 9.368499e-02 1 1  ON 11
 ud_2                -1.449391e-02 1 1  ON 12
 ud_3                -7.453533e-02 1 1  ON 13
 ud_4                -1.217653e-01 1 1  ON 14
 ud_5                -1.536254e-01 1 1  ON 15
 ud_6                -1.561242e-01 1 1  ON 16
 ud_7                -1.121013e-01 1 1  ON 17
 ud_8                 2.094500e-04 1 1  ON 18
 ud_9                 9.254830e-02 1 1  ON 19
 eO_0                -7.669155e-01 1 1  ON 20
 eO_1                -4.492330e-01 1 1  ON 21
 eO_2                -4.446707e-02 1 1  ON 22
 eO_3                 2.083983e-01 1 1  ON 23
 eO_4                 3.024461e-01 1 1  ON 24
 eO_5                 3.167057e-01 1 1  ON 25
 eO_6                 2.561935e-01 1 1  ON 26
 eO_7                 1.184582e-01 1 1  ON 27
 eO_8                 2.893549e-02 1 1  ON 28
 eO_9                 1.869307e-02 1 1  ON 29
eH1_0                -1.825325e-01 1 1  ON 30
eH1_1                -1.036036e-01 1 1  ON 31
eH1_2                -6.292078e-02 1 1  ON 32
eH1_3                -2.636378e-02 1 1  ON 33
eH1_4                 1.896076e-02 1 1  ON 34
eH1_5                 3.330989e-02 1 1  ON 35
eH1_6                 7.789021e-02 1 1  ON 36
eH1_7                 1.099564e-01 1 1  ON 37
eH1_8                 9.429485e-02 1 1  ON 38
eH1_9                 2.543521e-02 1 1  ON 39
eH2_0                -1.842238e-01 1 1  ON 40
eH2_1                -1.052341e-01 1 1  ON 41
eH2_2                -6.435874e-02 1 1  ON 42
eH2_3                -2.762491e-02 1 1  ON 43
eH2_4                 1.793707e-02 1 1  ON 44
eH2_5                 3.299794e-02 1 1  ON 45
eH2_6                 7.957360e-02 1 1  ON 46
eH2_7                 1.139952e-01 1 1  ON 47
eH2_8                 9.694707e-02 1 1  ON 48
eH2_9                 2.750484e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.261
    reference variance = 0.169546
====================================================
  Execution time = 2.1996e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1808e-01
  Total weights = 2.0000e+06
  Execution time = 1.8611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317870009838
                                         uncertainty =       0.003357969716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317870009838
                                         uncertainty =       0.003357969716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398664202
  error estimate for blocks of size 2^( 2) =       0.000408240980
  error estimate for blocks of size 2^( 3) =       0.000416979509
  error estimate for blocks of size 2^( 4) =       0.000423730696
  error estimate for blocks of size 2^( 5) =       0.000427881325
  error estimate for blocks of size 2^( 6) =       0.000429399070
  error estimate for blocks of size 2^( 7) =       0.000428369181

      target function =                  N/A
              le_mean =     -17.216431267433
             les_mean =     296.723371718863
             stat err =       0.000427345068
             autocorr =       1.149060546107
              std dev =       0.563796320973
             le_variance =       0.317866291542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318415275949
                                         uncertainty =       0.003367129918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318415275949
                                         uncertainty =       0.003367129918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399005995
  error estimate for blocks of size 2^( 2) =       0.000408563624
  error estimate for blocks of size 2^( 3) =       0.000417280775
  error estimate for blocks of size 2^( 4) =       0.000424011653
  error estimate for blocks of size 2^( 5) =       0.000428155418
  error estimate for blocks of size 2^( 6) =       0.000429668983
  error estimate for blocks of size 2^( 7) =       0.000428626141

      target function =                  N/A
              le_mean =     -17.216431004657
             les_mean =     296.723907947744
             stat err =       0.000427615549
             autocorr =       1.148545313214
              std dev =       0.564279690270
             le_variance =       0.318411568852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318310035618
                                         uncertainty =       0.003366079425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318310035618
                                         uncertainty =       0.003366079425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398940050
  error estimate for blocks of size 2^( 2) =       0.000408502831
  error estimate for blocks of size 2^( 3) =       0.000417227205
  error estimate for blocks of size 2^( 4) =       0.000423964865
  error estimate for blocks of size 2^( 5) =       0.000428110913
  error estimate for blocks of size 2^( 6) =       0.000429623952
  error estimate for blocks of size 2^( 7) =       0.000428590690

      target function =                  N/A
              le_mean =     -17.216431122550
             les_mean =     296.723806765885
             stat err =       0.000427572605
             autocorr =       1.148694304012
              std dev =       0.564186429768
             le_variance =       0.318306327534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317939511519
                                         uncertainty =       0.003359339370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317939511519
                                         uncertainty =       0.003359339370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398707786
  error estimate for blocks of size 2^( 2) =       0.000408282413
  error estimate for blocks of size 2^( 3) =       0.000417018906
  error estimate for blocks of size 2^( 4) =       0.000423768101
  error estimate for blocks of size 2^( 5) =       0.000427917810
  error estimate for blocks of size 2^( 6) =       0.000429434409
  error estimate for blocks of size 2^( 7) =       0.000428404620

      target function =                  N/A
              le_mean =     -17.216431157693
             les_mean =     296.723437445647
             stat err =       0.000427381235
             autocorr =       1.149003803003
              std dev =       0.563857958201
             le_variance =       0.317935797026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216431267433        initial  <--
     9.3132e-02     9.3132e-01             3.6834e-03       -17.216431004657
     3.7253e-01     3.7253e+00             1.0874e-03       -17.216431122550
     1.4901e+00     1.4901e+01             2.7618e-04       -17.216431157693

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3903
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.104683e-01 1 1  ON 0
 uu_1                 4.891990e-02 1 1  ON 1
 uu_2                -4.507202e-02 1 1  ON 2
 uu_3                -9.921724e-02 1 1  ON 3
 uu_4                -1.323005e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321672e-02 1 1  ON 7
 uu_8                 9.731998e-02 1 1  ON 8
 uu_9                 1.235531e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355829e-02 1 1  ON 11
 ud_2                -1.454381e-02 1 1  ON 12
 ud_3                -7.438779e-02 1 1  ON 13
 ud_4                -1.216538e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.829050e-04 1 1  ON 18
 ud_9                 9.256694e-02 1 1  ON 19
 eO_0                -7.658281e-01 1 1  ON 20
 eO_1                -4.483867e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080075e-01 1 1  ON 23
 eO_4                 3.017981e-01 1 1  ON 24
 eO_5                 3.162546e-01 1 1  ON 25
 eO_6                 2.558443e-01 1 1  ON 26
 eO_7                 1.181293e-01 1 1  ON 27
 eO_8                 2.889609e-02 1 1  ON 28
 eO_9                 1.867977e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034055e-01 1 1  ON 31
eH1_2                -6.301840e-02 1 1  ON 32
eH1_3                -2.641638e-02 1 1  ON 33
eH1_4                 1.893976e-02 1 1  ON 34
eH1_5                 3.340001e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408678e-02 1 1  ON 38
eH1_9                 2.537924e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443400e-02 1 1  ON 42
eH2_3                -2.763391e-02 1 1  ON 43
eH2_4                 1.795684e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960940e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678345e-02 1 1  ON 48
eH2_9                 2.747056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7415e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2559
    reference variance = 0.501888
====================================================
  Execution time = 2.0147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322497597065
                                         uncertainty =       0.004723198443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322497597065
                                         uncertainty =       0.004723198443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401486457
  error estimate for blocks of size 2^( 2) =       0.000411545319
  error estimate for blocks of size 2^( 3) =       0.000420381461
  error estimate for blocks of size 2^( 4) =       0.000426833286
  error estimate for blocks of size 2^( 5) =       0.000431554518
  error estimate for blocks of size 2^( 6) =       0.000434146612
  error estimate for blocks of size 2^( 7) =       0.000436096921

      target function =                  N/A
              le_mean =     -17.216153502405
             les_mean =     296.718324007082
             stat err =       0.000432157834
             autocorr =       1.158625228559
              std dev =       0.567787592239
             le_variance =       0.322382749901


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615350241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-01, overlap shift 9.3132e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216153502405       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216153413429       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216153079463       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216153941965       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216154260816       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216154267099       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216154473368       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216154496926       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e-01 is 5.615669e-04

solving harmonic davidson linear method for identity shift 3.7253e+00, overlap shift 3.7253e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216153502405       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216153476174       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216153368439       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216153585222       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216153683664       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216153696766       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216153730399       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+00 is 1.412600e-04

solving harmonic davidson linear method for identity shift 1.4901e+01, overlap shift 1.4901e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216153502405       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216153495540       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216153466608       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216153520457       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216153545932       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216153550716       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216153558028       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+01 is 3.547509e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5685e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.105003e-01 1 1  ON 0
 uu_1                 4.893976e-02 1 1  ON 1
 uu_2                -4.505968e-02 1 1  ON 2
 uu_3                -9.924039e-02 1 1  ON 3
 uu_4                -1.323289e-01 1 1  ON 4
 uu_5                -1.393441e-01 1 1  ON 5
 uu_6                -1.164414e-01 1 1  ON 6
 uu_7                -4.323157e-02 1 1  ON 7
 uu_8                 9.730970e-02 1 1  ON 8
 uu_9                 1.235681e-01 1 1  ON 9
 ud_0                 3.511844e-01 1 1  ON 10
 ud_1                 9.357185e-02 1 1  ON 11
 ud_2                -1.456598e-02 1 1  ON 12
 ud_3                -7.441416e-02 1 1  ON 13
 ud_4                -1.216878e-01 1 1  ON 14
 ud_5                -1.534536e-01 1 1  ON 15
 ud_6                -1.562449e-01 1 1  ON 16
 ud_7                -1.121090e-01 1 1  ON 17
 ud_8                 4.642726e-04 1 1  ON 18
 ud_9                 9.257196e-02 1 1  ON 19
 eO_0                -7.659693e-01 1 1  ON 20
 eO_1                -4.484997e-01 1 1  ON 21
 eO_2                -4.418150e-02 1 1  ON 22
 eO_3                 2.080666e-01 1 1  ON 23
 eO_4                 3.018718e-01 1 1  ON 24
 eO_5                 3.163004e-01 1 1  ON 25
 eO_6                 2.558834e-01 1 1  ON 26
 eO_7                 1.181680e-01 1 1  ON 27
 eO_8                 2.890216e-02 1 1  ON 28
 eO_9                 1.868199e-02 1 1  ON 29
eH1_0                -1.824167e-01 1 1  ON 30
eH1_1                -1.033999e-01 1 1  ON 31
eH1_2                -6.302626e-02 1 1  ON 32
eH1_3                -2.642032e-02 1 1  ON 33
eH1_4                 1.894133e-02 1 1  ON 34
eH1_5                 3.338143e-02 1 1  ON 35
eH1_6                 7.791785e-02 1 1  ON 36
eH1_7                 1.099622e-01 1 1  ON 37
eH1_8                 9.411076e-02 1 1  ON 38
eH1_9                 2.538786e-02 1 1  ON 39
eH2_0                -1.842412e-01 1 1  ON 40
eH2_1                -1.051079e-01 1 1  ON 41
eH2_2                -6.444181e-02 1 1  ON 42
eH2_3                -2.762868e-02 1 1  ON 43
eH2_4                 1.796359e-02 1 1  ON 44
eH2_5                 3.304467e-02 1 1  ON 45
eH2_6                 7.959342e-02 1 1  ON 46
eH2_7                 1.140588e-01 1 1  ON 47
eH2_8                 9.680572e-02 1 1  ON 48
eH2_9                 2.747726e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.8557
    reference variance = 54.9576
====================================================
  Execution time = 1.9861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1813e-01
  Total weights = 2.0000e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314584716479
                                         uncertainty =       0.003688930922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314584716479
                                         uncertainty =       0.003688930922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398787765
  error estimate for blocks of size 2^( 2) =       0.000406049440
  error estimate for blocks of size 2^( 3) =       0.000415187176
  error estimate for blocks of size 2^( 4) =       0.000421382561
  error estimate for blocks of size 2^( 5) =       0.000424966821
  error estimate for blocks of size 2^( 6) =       0.000427942366
  error estimate for blocks of size 2^( 7) =       0.000428884213

      target function =                  N/A
              le_mean =     -17.216939481886
             les_mean =     296.741068326882
             stat err =       0.000425793990
             autocorr =       1.140027701439
              std dev =       0.563971065739
             le_variance =       0.318063362991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314787576325
                                         uncertainty =       0.003691463978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314787576325
                                         uncertainty =       0.003691463978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398916627
  error estimate for blocks of size 2^( 2) =       0.000406171615
  error estimate for blocks of size 2^( 3) =       0.000415301598
  error estimate for blocks of size 2^( 4) =       0.000421491124
  error estimate for blocks of size 2^( 5) =       0.000425073268
  error estimate for blocks of size 2^( 6) =       0.000428047297
  error estimate for blocks of size 2^( 7) =       0.000428985376

      target function =                  N/A
              le_mean =     -17.216938489192
             les_mean =     296.741239732665
             stat err =       0.000425899266
             autocorr =       1.139854732929
              std dev =       0.564153304671
             le_variance =       0.318268951172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314709973392
                                         uncertainty =       0.003690480292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314709973392
                                         uncertainty =       0.003690480292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398867203
  error estimate for blocks of size 2^( 2) =       0.000406124842
  error estimate for blocks of size 2^( 3) =       0.000415257847
  error estimate for blocks of size 2^( 4) =       0.000421449742
  error estimate for blocks of size 2^( 5) =       0.000425032805
  error estimate for blocks of size 2^( 6) =       0.000428007504
  error estimate for blocks of size 2^( 7) =       0.000428946894

      target function =                  N/A
              le_mean =     -17.216938893985
             les_mean =     296.741174810762
             stat err =       0.000425859236
             autocorr =       1.139922921780
              std dev =       0.564083407527
             le_variance =       0.318190090647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314601007333
                                         uncertainty =       0.003689132633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314601007333
                                         uncertainty =       0.003689132633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398798093
  error estimate for blocks of size 2^( 2) =       0.000406059242
  error estimate for blocks of size 2^( 3) =       0.000415196355
  error estimate for blocks of size 2^( 4) =       0.000421391282
  error estimate for blocks of size 2^( 5) =       0.000424975388
  error estimate for blocks of size 2^( 6) =       0.000427950827
  error estimate for blocks of size 2^( 7) =       0.000428892344

      target function =                  N/A
              le_mean =     -17.216939398750
             les_mean =     296.741081939726
             stat err =       0.000425802460
             autocorr =       1.140014002719
              std dev =       0.563985672273
             le_variance =       0.318079838530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216939481886        initial  <--
     9.3132e-01     9.3132e+00             5.6157e-04       -17.216938489192
     3.7253e+00     3.7253e+01             1.4126e-04       -17.216938893985
     1.4901e+01     1.4901e+02             3.5475e-05       -17.216939398750

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2681
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.104683e-01 1 1  ON 0
 uu_1                 4.891990e-02 1 1  ON 1
 uu_2                -4.507202e-02 1 1  ON 2
 uu_3                -9.921724e-02 1 1  ON 3
 uu_4                -1.323005e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321672e-02 1 1  ON 7
 uu_8                 9.731998e-02 1 1  ON 8
 uu_9                 1.235531e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355829e-02 1 1  ON 11
 ud_2                -1.454381e-02 1 1  ON 12
 ud_3                -7.438779e-02 1 1  ON 13
 ud_4                -1.216538e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.829050e-04 1 1  ON 18
 ud_9                 9.256694e-02 1 1  ON 19
 eO_0                -7.658281e-01 1 1  ON 20
 eO_1                -4.483867e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080075e-01 1 1  ON 23
 eO_4                 3.017981e-01 1 1  ON 24
 eO_5                 3.162546e-01 1 1  ON 25
 eO_6                 2.558443e-01 1 1  ON 26
 eO_7                 1.181293e-01 1 1  ON 27
 eO_8                 2.889609e-02 1 1  ON 28
 eO_9                 1.867977e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034055e-01 1 1  ON 31
eH1_2                -6.301840e-02 1 1  ON 32
eH1_3                -2.641638e-02 1 1  ON 33
eH1_4                 1.893976e-02 1 1  ON 34
eH1_5                 3.340001e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408678e-02 1 1  ON 38
eH1_9                 2.537924e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443400e-02 1 1  ON 42
eH2_3                -2.763391e-02 1 1  ON 43
eH2_4                 1.795684e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960940e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678345e-02 1 1  ON 48
eH2_9                 2.747056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2705
    reference variance = 0.212291
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2244e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322538588564
                                         uncertainty =       0.004960287467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322538588564
                                         uncertainty =       0.004960287467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401521570
  error estimate for blocks of size 2^( 2) =       0.000411171924
  error estimate for blocks of size 2^( 3) =       0.000419474343
  error estimate for blocks of size 2^( 4) =       0.000426122228
  error estimate for blocks of size 2^( 5) =       0.000430509212
  error estimate for blocks of size 2^( 6) =       0.000433574759
  error estimate for blocks of size 2^( 7) =       0.000432973405

      target function =                  N/A
              le_mean =     -17.217161373258
             les_mean =     296.753084733723
             stat err =       0.000430794901
             autocorr =       1.151127283623
              std dev =       0.567837249680
             le_variance =       0.322439142124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716137326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161373258       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217161422207       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161489460       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217161557123       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217161557025       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217161541765       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217161547897       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217161542677       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 5.194742e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161373258       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217161385717       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161402892       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217161420670       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217161421233       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217161417049       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217161418494       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 1.272806e-05

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217161373258       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217161376387       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217161380704       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217161385206       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217161385386       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217161384316       residual = 5.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217161384672       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 3.183326e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5721e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.104688e-01 1 1  ON 0
 uu_1                 4.892190e-02 1 1  ON 1
 uu_2                -4.506744e-02 1 1  ON 2
 uu_3                -9.922028e-02 1 1  ON 3
 uu_4                -1.323036e-01 1 1  ON 4
 uu_5                -1.393369e-01 1 1  ON 5
 uu_6                -1.164214e-01 1 1  ON 6
 uu_7                -4.321988e-02 1 1  ON 7
 uu_8                 9.731777e-02 1 1  ON 8
 uu_9                 1.235542e-01 1 1  ON 9
 ud_0                 3.511330e-01 1 1  ON 10
 ud_1                 9.356070e-02 1 1  ON 11
 ud_2                -1.454328e-02 1 1  ON 12
 ud_3                -7.439045e-02 1 1  ON 13
 ud_4                -1.216545e-01 1 1  ON 14
 ud_5                -1.534339e-01 1 1  ON 15
 ud_6                -1.562573e-01 1 1  ON 16
 ud_7                -1.121254e-01 1 1  ON 17
 ud_8                 4.798528e-04 1 1  ON 18
 ud_9                 9.256678e-02 1 1  ON 19
 eO_0                -7.658408e-01 1 1  ON 20
 eO_1                -4.483970e-01 1 1  ON 21
 eO_2                -4.417052e-02 1 1  ON 22
 eO_3                 2.080120e-01 1 1  ON 23
 eO_4                 3.018065e-01 1 1  ON 24
 eO_5                 3.162605e-01 1 1  ON 25
 eO_6                 2.558474e-01 1 1  ON 26
 eO_7                 1.181322e-01 1 1  ON 27
 eO_8                 2.889647e-02 1 1  ON 28
 eO_9                 1.867989e-02 1 1  ON 29
eH1_0                -1.823892e-01 1 1  ON 30
eH1_1                -1.034106e-01 1 1  ON 31
eH1_2                -6.301628e-02 1 1  ON 32
eH1_3                -2.641725e-02 1 1  ON 33
eH1_4                 1.894011e-02 1 1  ON 34
eH1_5                 3.340087e-02 1 1  ON 35
eH1_6                 7.790916e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408813e-02 1 1  ON 38
eH1_9                 2.537978e-02 1 1  ON 39
eH2_0                -1.842309e-01 1 1  ON 40
eH2_1                -1.051391e-01 1 1  ON 41
eH2_2                -6.443528e-02 1 1  ON 42
eH2_3                -2.763239e-02 1 1  ON 43
eH2_4                 1.795749e-02 1 1  ON 44
eH2_5                 3.308873e-02 1 1  ON 45
eH2_6                 7.960796e-02 1 1  ON 46
eH2_7                 1.140537e-01 1 1  ON 47
eH2_8                 9.678513e-02 1 1  ON 48
eH2_9                 2.747099e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.938595
====================================================
  Execution time = 2.2185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3132e-01
  Total weights = 2.0000e+06
  Execution time = 1.8536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331316717570
                                         uncertainty =       0.009030362164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331316717570
                                         uncertainty =       0.009030362164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407013512
  error estimate for blocks of size 2^( 2) =       0.000416591627
  error estimate for blocks of size 2^( 3) =       0.000424984868
  error estimate for blocks of size 2^( 4) =       0.000430557012
  error estimate for blocks of size 2^( 5) =       0.000434165638
  error estimate for blocks of size 2^( 6) =       0.000435433305
  error estimate for blocks of size 2^( 7) =       0.000434866182

      target function =                  N/A
              le_mean =     -17.217184350466
             les_mean =     296.762756789455
             stat err =       0.000433755534
             autocorr =       1.135722957124
              std dev =       0.575604028119
             le_variance =       0.331319997187

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331313833679
                                         uncertainty =       0.009030098617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331313833679
                                         uncertainty =       0.009030098617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407011749
  error estimate for blocks of size 2^( 2) =       0.000416589869
  error estimate for blocks of size 2^( 3) =       0.000424982946
  error estimate for blocks of size 2^( 4) =       0.000430555055
  error estimate for blocks of size 2^( 5) =       0.000434163640
  error estimate for blocks of size 2^( 6) =       0.000435431210
  error estimate for blocks of size 2^( 7) =       0.000434863849

      target function =                  N/A
              le_mean =     -17.217184182418
             les_mean =     296.762748132667
             stat err =       0.000433753438
             autocorr =       1.135721820647
              std dev =       0.575601534924
             le_variance =       0.331317127007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331314720514
                                         uncertainty =       0.009030211231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331314720514
                                         uncertainty =       0.009030211231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407012289
  error estimate for blocks of size 2^( 2) =       0.000416590420
  error estimate for blocks of size 2^( 3) =       0.000424983589
  error estimate for blocks of size 2^( 4) =       0.000430555722
  error estimate for blocks of size 2^( 5) =       0.000434164346
  error estimate for blocks of size 2^( 6) =       0.000435431964
  error estimate for blocks of size 2^( 7) =       0.000434864737

      target function =                  N/A
              le_mean =     -17.217184265395
             les_mean =     296.762751870216
             stat err =       0.000433754192
             autocorr =       1.135722751537
              std dev =       0.575602299611
             le_variance =       0.331318007317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331316459240
                                         uncertainty =       0.009030343020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331316459240
                                         uncertainty =       0.009030343020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407013353
  error estimate for blocks of size 2^( 2) =       0.000416591471
  error estimate for blocks of size 2^( 3) =       0.000424984703
  error estimate for blocks of size 2^( 4) =       0.000430556846
  error estimate for blocks of size 2^( 5) =       0.000434165472
  error estimate for blocks of size 2^( 6) =       0.000435433132
  error estimate for blocks of size 2^( 7) =       0.000434865997

      target function =                  N/A
              le_mean =     -17.217184339712
             les_mean =     296.762756161744
             stat err =       0.000433755362
             autocorr =       1.135722935967
              std dev =       0.575603804506
             le_variance =       0.331319739762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217184350466        initial  <--
     9.3132e+00     9.3132e+01             5.1947e-05       -17.217184182418
     3.7253e+01     3.7253e+02             1.2728e-05       -17.217184265395
     1.4901e+02     1.4901e+03             3.1833e-06       -17.217184339712

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5311
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.104683e-01 1 1  ON 0
 uu_1                 4.891990e-02 1 1  ON 1
 uu_2                -4.507202e-02 1 1  ON 2
 uu_3                -9.921724e-02 1 1  ON 3
 uu_4                -1.323005e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321672e-02 1 1  ON 7
 uu_8                 9.731998e-02 1 1  ON 8
 uu_9                 1.235531e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355829e-02 1 1  ON 11
 ud_2                -1.454381e-02 1 1  ON 12
 ud_3                -7.438779e-02 1 1  ON 13
 ud_4                -1.216538e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.829050e-04 1 1  ON 18
 ud_9                 9.256694e-02 1 1  ON 19
 eO_0                -7.658281e-01 1 1  ON 20
 eO_1                -4.483867e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080075e-01 1 1  ON 23
 eO_4                 3.017981e-01 1 1  ON 24
 eO_5                 3.162546e-01 1 1  ON 25
 eO_6                 2.558443e-01 1 1  ON 26
 eO_7                 1.181293e-01 1 1  ON 27
 eO_8                 2.889609e-02 1 1  ON 28
 eO_9                 1.867977e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034055e-01 1 1  ON 31
eH1_2                -6.301840e-02 1 1  ON 32
eH1_3                -2.641638e-02 1 1  ON 33
eH1_4                 1.893976e-02 1 1  ON 34
eH1_5                 3.340001e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408678e-02 1 1  ON 38
eH1_9                 2.537924e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443400e-02 1 1  ON 42
eH2_3                -2.763391e-02 1 1  ON 43
eH2_4                 1.795684e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960940e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678345e-02 1 1  ON 48
eH2_9                 2.747056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1297
    reference variance = 0.633678
====================================================
  Execution time = 2.0230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1295e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312944448677
                                         uncertainty =       0.002610711527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312944448677
                                         uncertainty =       0.002610711527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395569087
  error estimate for blocks of size 2^( 2) =       0.000405405210
  error estimate for blocks of size 2^( 3) =       0.000413636990
  error estimate for blocks of size 2^( 4) =       0.000419801040
  error estimate for blocks of size 2^( 5) =       0.000423248570
  error estimate for blocks of size 2^( 6) =       0.000424547624
  error estimate for blocks of size 2^( 7) =       0.000424653969

      target function =                  N/A
              le_mean =     -17.216449531979
             les_mean =     296.719084135932
             stat err =       0.000423062801
             autocorr =       1.143839238222
              std dev =       0.559419167737
             le_variance =       0.312949805232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644953198e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449531979       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216449532414       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449545867       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449546651       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449549631       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216449550459       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216449548936       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+01 is 5.327803e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449531979       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216449532088       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449535455       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449535656       residual = 9.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449536403       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216449536608       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216449536226       residual = 5.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 1.331996e-06

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216449531979       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216449532006       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216449532848       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216449532899       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216449533085       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216449533137       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216449533041       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 3.330016e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5804e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.104685e-01 1 1  ON 0
 uu_1                 4.892014e-02 1 1  ON 1
 uu_2                -4.507182e-02 1 1  ON 2
 uu_3                -9.921745e-02 1 1  ON 3
 uu_4                -1.323008e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321698e-02 1 1  ON 7
 uu_8                 9.731980e-02 1 1  ON 8
 uu_9                 1.235533e-01 1 1  ON 9
 ud_0                 3.511325e-01 1 1  ON 10
 ud_1                 9.355842e-02 1 1  ON 11
 ud_2                -1.454383e-02 1 1  ON 12
 ud_3                -7.438795e-02 1 1  ON 13
 ud_4                -1.216542e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562588e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.826032e-04 1 1  ON 18
 ud_9                 9.256697e-02 1 1  ON 19
 eO_0                -7.658294e-01 1 1  ON 20
 eO_1                -4.483879e-01 1 1  ON 21
 eO_2                -4.416855e-02 1 1  ON 22
 eO_3                 2.080083e-01 1 1  ON 23
 eO_4                 3.017990e-01 1 1  ON 24
 eO_5                 3.162551e-01 1 1  ON 25
 eO_6                 2.558447e-01 1 1  ON 26
 eO_7                 1.181296e-01 1 1  ON 27
 eO_8                 2.889615e-02 1 1  ON 28
 eO_9                 1.867980e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034055e-01 1 1  ON 31
eH1_2                -6.301837e-02 1 1  ON 32
eH1_3                -2.641614e-02 1 1  ON 33
eH1_4                 1.893956e-02 1 1  ON 34
eH1_5                 3.339981e-02 1 1  ON 35
eH1_6                 7.790901e-02 1 1  ON 36
eH1_7                 1.099550e-01 1 1  ON 37
eH1_8                 9.408695e-02 1 1  ON 38
eH1_9                 2.537928e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443395e-02 1 1  ON 42
eH2_3                -2.763409e-02 1 1  ON 43
eH2_4                 1.795681e-02 1 1  ON 44
eH2_5                 3.308758e-02 1 1  ON 45
eH2_6                 7.960941e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678366e-02 1 1  ON 48
eH2_9                 2.747064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1819
    reference variance = 0.222042
====================================================
  Execution time = 1.9747e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2173e-01
  Total weights = 2.0000e+06
  Execution time = 1.8584e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321749575003
                                         uncertainty =       0.004840597490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321749575003
                                         uncertainty =       0.004840597490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401078148
  error estimate for blocks of size 2^( 2) =       0.000410590529
  error estimate for blocks of size 2^( 3) =       0.000418894068
  error estimate for blocks of size 2^( 4) =       0.000425015528
  error estimate for blocks of size 2^( 5) =       0.000429906208
  error estimate for blocks of size 2^( 6) =       0.000431577578
  error estimate for blocks of size 2^( 7) =       0.000433053251

      target function =                  N/A
              le_mean =     -17.215942490588
             les_mean =     296.710403040469
             stat err =       0.000429888141
             autocorr =       1.148822486204
              std dev =       0.567210156900
             le_variance =       0.321727362091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750275695
                                         uncertainty =       0.004840561244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321750275695
                                         uncertainty =       0.004840561244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401078585
  error estimate for blocks of size 2^( 2) =       0.000410590935
  error estimate for blocks of size 2^( 3) =       0.000418894437
  error estimate for blocks of size 2^( 4) =       0.000425015863
  error estimate for blocks of size 2^( 5) =       0.000429906522
  error estimate for blocks of size 2^( 6) =       0.000431577874
  error estimate for blocks of size 2^( 7) =       0.000433053530

      target function =                  N/A
              le_mean =     -17.215942482131
             les_mean =     296.710403449932
             stat err =       0.000429888447
             autocorr =       1.148821620283
              std dev =       0.567210774550
             le_variance =       0.321728062765

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321749925407
                                         uncertainty =       0.004840579313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321749925407
                                         uncertainty =       0.004840579313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401078367
  error estimate for blocks of size 2^( 2) =       0.000410590732
  error estimate for blocks of size 2^( 3) =       0.000418894253
  error estimate for blocks of size 2^( 4) =       0.000425015696
  error estimate for blocks of size 2^( 5) =       0.000429906365
  error estimate for blocks of size 2^( 6) =       0.000431577726
  error estimate for blocks of size 2^( 7) =       0.000433053390

      target function =                  N/A
              le_mean =     -17.215942486340
             les_mean =     296.710403244580
             stat err =       0.000429888294
             autocorr =       1.148822053011
              std dev =       0.567210465777
             le_variance =       0.321727712487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321749618804
                                         uncertainty =       0.004840595216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321749618804
                                         uncertainty =       0.004840595216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401078176
  error estimate for blocks of size 2^( 2) =       0.000410590554
  error estimate for blocks of size 2^( 3) =       0.000418894091
  error estimate for blocks of size 2^( 4) =       0.000425015549
  error estimate for blocks of size 2^( 5) =       0.000429906228
  error estimate for blocks of size 2^( 6) =       0.000431577597
  error estimate for blocks of size 2^( 7) =       0.000433053268

      target function =                  N/A
              le_mean =     -17.215942490056
             les_mean =     296.710403065954
             stat err =       0.000429888160
             autocorr =       1.148822432049
              std dev =       0.567210195510
             le_variance =       0.321727405891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215942490588        initial  <--
     9.3132e+01     9.3132e+02             5.3278e-06       -17.215942482131
     3.7253e+02     3.7253e+03             1.3320e-06       -17.215942486340
     1.4901e+03     1.4901e+04             3.3300e-07       -17.215942490056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1274
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.104683e-01 1 1  ON 0
 uu_1                 4.891990e-02 1 1  ON 1
 uu_2                -4.507202e-02 1 1  ON 2
 uu_3                -9.921724e-02 1 1  ON 3
 uu_4                -1.323005e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321672e-02 1 1  ON 7
 uu_8                 9.731998e-02 1 1  ON 8
 uu_9                 1.235531e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355829e-02 1 1  ON 11
 ud_2                -1.454381e-02 1 1  ON 12
 ud_3                -7.438779e-02 1 1  ON 13
 ud_4                -1.216538e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.829050e-04 1 1  ON 18
 ud_9                 9.256694e-02 1 1  ON 19
 eO_0                -7.658281e-01 1 1  ON 20
 eO_1                -4.483867e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080075e-01 1 1  ON 23
 eO_4                 3.017981e-01 1 1  ON 24
 eO_5                 3.162546e-01 1 1  ON 25
 eO_6                 2.558443e-01 1 1  ON 26
 eO_7                 1.181293e-01 1 1  ON 27
 eO_8                 2.889609e-02 1 1  ON 28
 eO_9                 1.867977e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034055e-01 1 1  ON 31
eH1_2                -6.301840e-02 1 1  ON 32
eH1_3                -2.641638e-02 1 1  ON 33
eH1_4                 1.893976e-02 1 1  ON 34
eH1_5                 3.340001e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408678e-02 1 1  ON 38
eH1_9                 2.537924e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443400e-02 1 1  ON 42
eH2_3                -2.763391e-02 1 1  ON 43
eH2_4                 1.795684e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960940e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678345e-02 1 1  ON 48
eH2_9                 2.747056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1293
    reference variance = 0.503849
====================================================
  Execution time = 2.0399e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2301e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077083009
                                         uncertainty =       0.005643444118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077083009
                                         uncertainty =       0.005643444118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401877229
  error estimate for blocks of size 2^( 2) =       0.000411659419
  error estimate for blocks of size 2^( 3) =       0.000420111671
  error estimate for blocks of size 2^( 4) =       0.000426504744
  error estimate for blocks of size 2^( 5) =       0.000430783655
  error estimate for blocks of size 2^( 6) =       0.000432951608
  error estimate for blocks of size 2^( 7) =       0.000433128929

      target function =                  N/A
              le_mean =     -17.217633625593
             les_mean =     296.769918118432
             stat err =       0.000430842234
             autocorr =       1.149343223617
              std dev =       0.568340228007
             le_variance =       0.323010614771


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721763362559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217633625593       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217633626668       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217633627285       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217633629776       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217633628679       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217633628941       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217633629096       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 6.087634e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217633625593       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217633625862       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217633626016       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217633626639       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217633626365       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217633626431       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217633626469       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 1.521925e-07

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217633625593       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217633625661       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217633625699       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217633625854       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217633625786       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217633625802       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217633625810       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 3.804822e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5968e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.104683e-01 1 1  ON 0
 uu_1                 4.891992e-02 1 1  ON 1
 uu_2                -4.507199e-02 1 1  ON 2
 uu_3                -9.921726e-02 1 1  ON 3
 uu_4                -1.323005e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321675e-02 1 1  ON 7
 uu_8                 9.731997e-02 1 1  ON 8
 uu_9                 1.235531e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355832e-02 1 1  ON 11
 ud_2                -1.454380e-02 1 1  ON 12
 ud_3                -7.438781e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.828814e-04 1 1  ON 18
 ud_9                 9.256694e-02 1 1  ON 19
 eO_0                -7.658282e-01 1 1  ON 20
 eO_1                -4.483868e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080076e-01 1 1  ON 23
 eO_4                 3.017982e-01 1 1  ON 24
 eO_5                 3.162546e-01 1 1  ON 25
 eO_6                 2.558443e-01 1 1  ON 26
 eO_7                 1.181293e-01 1 1  ON 27
 eO_8                 2.889609e-02 1 1  ON 28
 eO_9                 1.867977e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034055e-01 1 1  ON 31
eH1_2                -6.301839e-02 1 1  ON 32
eH1_3                -2.641638e-02 1 1  ON 33
eH1_4                 1.893977e-02 1 1  ON 34
eH1_5                 3.340001e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408681e-02 1 1  ON 38
eH1_9                 2.537925e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443401e-02 1 1  ON 42
eH2_3                -2.763388e-02 1 1  ON 43
eH2_4                 1.795682e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960939e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678347e-02 1 1  ON 48
eH2_9                 2.747056e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1885
    reference variance = 0.221502
====================================================
  Execution time = 2.0112e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1491e-01
  Total weights = 2.0000e+06
  Execution time = 1.8559e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907330652
                                         uncertainty =       0.002931573521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907330652
                                         uncertainty =       0.002931573521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396805590
  error estimate for blocks of size 2^( 2) =       0.000406728242
  error estimate for blocks of size 2^( 3) =       0.000416223865
  error estimate for blocks of size 2^( 4) =       0.000423095312
  error estimate for blocks of size 2^( 5) =       0.000427888492
  error estimate for blocks of size 2^( 6) =       0.000430296580
  error estimate for blocks of size 2^( 7) =       0.000433188998

      target function =                  N/A
              le_mean =     -17.216583562695
             les_mean =     296.725658766493
             stat err =       0.000428617345
             autocorr =       1.166766417534
              std dev =       0.561167847155
             le_variance =       0.314909352680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907305881
                                         uncertainty =       0.002931572876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907305881
                                         uncertainty =       0.002931572876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396805575
  error estimate for blocks of size 2^( 2) =       0.000406728226
  error estimate for blocks of size 2^( 3) =       0.000416223848
  error estimate for blocks of size 2^( 4) =       0.000423095292
  error estimate for blocks of size 2^( 5) =       0.000427888472
  error estimate for blocks of size 2^( 6) =       0.000430296559
  error estimate for blocks of size 2^( 7) =       0.000433188983

      target function =                  N/A
              le_mean =     -17.216583563552
             les_mean =     296.725658771235
             stat err =       0.000428617327
             autocorr =       1.166766407689
              std dev =       0.561167825089
             le_variance =       0.314909327916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907318238
                                         uncertainty =       0.002931573198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907318238
                                         uncertainty =       0.002931573198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396805582
  error estimate for blocks of size 2^( 2) =       0.000406728234
  error estimate for blocks of size 2^( 3) =       0.000416223856
  error estimate for blocks of size 2^( 4) =       0.000423095302
  error estimate for blocks of size 2^( 5) =       0.000427888482
  error estimate for blocks of size 2^( 6) =       0.000430296570
  error estimate for blocks of size 2^( 7) =       0.000433188990

      target function =                  N/A
              le_mean =     -17.216583563124
             les_mean =     296.725658768843
             stat err =       0.000428617336
             autocorr =       1.166766412639
              std dev =       0.561167836096
             le_variance =       0.314909340269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907329100
                                         uncertainty =       0.002931573481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314907329100
                                         uncertainty =       0.002931573481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396805589
  error estimate for blocks of size 2^( 2) =       0.000406728241
  error estimate for blocks of size 2^( 3) =       0.000416223864
  error estimate for blocks of size 2^( 4) =       0.000423095311
  error estimate for blocks of size 2^( 5) =       0.000427888490
  error estimate for blocks of size 2^( 6) =       0.000430296578
  error estimate for blocks of size 2^( 7) =       0.000433188997

      target function =                  N/A
              le_mean =     -17.216583562749
             les_mean =     296.725658766786
             stat err =       0.000428617344
             autocorr =       1.166766416919
              std dev =       0.561167845772
             le_variance =       0.314909351128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216583562695        initial
     9.3132e+02     9.3132e+03             6.0876e-07       -17.216583563552  <--
     3.7253e+03     3.7253e+04             1.5219e-07       -17.216583563124
     1.4901e+04     1.4901e+05             3.8048e-08       -17.216583562749

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 2.9518e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.104684e-01 1 1  ON 0
 uu_1                 4.891996e-02 1 1  ON 1
 uu_2                -4.507188e-02 1 1  ON 2
 uu_3                -9.921733e-02 1 1  ON 3
 uu_4                -1.323006e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321683e-02 1 1  ON 7
 uu_8                 9.731993e-02 1 1  ON 8
 uu_9                 1.235532e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355840e-02 1 1  ON 11
 ud_2                -1.454379e-02 1 1  ON 12
 ud_3                -7.438790e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.828107e-04 1 1  ON 18
 ud_9                 9.256695e-02 1 1  ON 19
 eO_0                -7.658287e-01 1 1  ON 20
 eO_1                -4.483872e-01 1 1  ON 21
 eO_2                -4.416818e-02 1 1  ON 22
 eO_3                 2.080079e-01 1 1  ON 23
 eO_4                 3.017984e-01 1 1  ON 24
 eO_5                 3.162547e-01 1 1  ON 25
 eO_6                 2.558444e-01 1 1  ON 26
 eO_7                 1.181294e-01 1 1  ON 27
 eO_8                 2.889611e-02 1 1  ON 28
 eO_9                 1.867978e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034056e-01 1 1  ON 31
eH1_2                -6.301835e-02 1 1  ON 32
eH1_3                -2.641639e-02 1 1  ON 33
eH1_4                 1.893980e-02 1 1  ON 34
eH1_5                 3.340000e-02 1 1  ON 35
eH1_6                 7.790888e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408687e-02 1 1  ON 38
eH1_9                 2.537926e-02 1 1  ON 39
eH2_0                -1.842266e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443403e-02 1 1  ON 42
eH2_3                -2.763380e-02 1 1  ON 43
eH2_4                 1.795678e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960936e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678353e-02 1 1  ON 48
eH2_9                 2.747058e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2678
    reference variance = 0.351511
====================================================
  Execution time = 2.0290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1898e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319019299015
                                         uncertainty =       0.003185608102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319019299015
                                         uncertainty =       0.003185608102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399364545
  error estimate for blocks of size 2^( 2) =       0.000408711781
  error estimate for blocks of size 2^( 3) =       0.000417482658
  error estimate for blocks of size 2^( 4) =       0.000424187934
  error estimate for blocks of size 2^( 5) =       0.000428749808
  error estimate for blocks of size 2^( 6) =       0.000431373399
  error estimate for blocks of size 2^( 7) =       0.000434485540

      target function =                  N/A
              le_mean =     -17.216998294991
             les_mean =     296.744014209570
             stat err =       0.000429699170
             autocorr =       1.157683966293
              std dev =       0.564786755643
             le_variance =       0.318984079350


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699829499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216998294991       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216998296380       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216998300386       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216998302545       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216998300677       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216998300555       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216998300912       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 2.177727e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216998294991       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216998295338       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216998296340       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216998296881       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216998296413       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216998296381       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216998296471       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 5.444326e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216998294991       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216998295078       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216998295328       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216998295463       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216998295348       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216998295341       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216998295359       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 1.361082e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088592 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5914e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.104686e-01 1 1  ON 0
 uu_1                 4.892001e-02 1 1  ON 1
 uu_2                -4.507175e-02 1 1  ON 2
 uu_3                -9.921744e-02 1 1  ON 3
 uu_4                -1.323008e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164214e-01 1 1  ON 6
 uu_7                -4.321691e-02 1 1  ON 7
 uu_8                 9.731988e-02 1 1  ON 8
 uu_9                 1.235533e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355854e-02 1 1  ON 11
 ud_2                -1.454384e-02 1 1  ON 12
 ud_3                -7.438799e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562590e-01 1 1  ON 16
 ud_7                -1.121234e-01 1 1  ON 17
 ud_8                 4.827144e-04 1 1  ON 18
 ud_9                 9.256696e-02 1 1  ON 19
 eO_0                -7.658292e-01 1 1  ON 20
 eO_1                -4.483876e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080082e-01 1 1  ON 23
 eO_4                 3.017987e-01 1 1  ON 24
 eO_5                 3.162549e-01 1 1  ON 25
 eO_6                 2.558445e-01 1 1  ON 26
 eO_7                 1.181295e-01 1 1  ON 27
 eO_8                 2.889613e-02 1 1  ON 28
 eO_9                 1.867979e-02 1 1  ON 29
eH1_0                -1.823895e-01 1 1  ON 30
eH1_1                -1.034056e-01 1 1  ON 31
eH1_2                -6.301837e-02 1 1  ON 32
eH1_3                -2.641638e-02 1 1  ON 33
eH1_4                 1.893976e-02 1 1  ON 34
eH1_5                 3.340000e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408697e-02 1 1  ON 38
eH1_9                 2.537928e-02 1 1  ON 39
eH2_0                -1.842266e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443399e-02 1 1  ON 42
eH2_3                -2.763391e-02 1 1  ON 43
eH2_4                 1.795683e-02 1 1  ON 44
eH2_5                 3.308775e-02 1 1  ON 45
eH2_6                 7.960928e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678360e-02 1 1  ON 48
eH2_9                 2.747061e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.214
    reference variance = 0.25189
====================================================
  Execution time = 1.9723e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1687e-01
  Total weights = 2.0000e+06
  Execution time = 1.8212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906181101
                                         uncertainty =       0.002892053715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906181101
                                         uncertainty =       0.002892053715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398038456
  error estimate for blocks of size 2^( 2) =       0.000407504982
  error estimate for blocks of size 2^( 3) =       0.000416237237
  error estimate for blocks of size 2^( 4) =       0.000422671693
  error estimate for blocks of size 2^( 5) =       0.000426788559
  error estimate for blocks of size 2^( 6) =       0.000428873822
  error estimate for blocks of size 2^( 7) =       0.000429870371

      target function =                  N/A
              le_mean =     -17.217107021780
             les_mean =     296.745643265255
             stat err =       0.000427051111
             autocorr =       1.151090970851
              std dev =       0.562911382262
             le_variance =       0.316869224280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906119025
                                         uncertainty =       0.002892057492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906119025
                                         uncertainty =       0.002892057492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398038417
  error estimate for blocks of size 2^( 2) =       0.000407504939
  error estimate for blocks of size 2^( 3) =       0.000416237186
  error estimate for blocks of size 2^( 4) =       0.000422671639
  error estimate for blocks of size 2^( 5) =       0.000426788508
  error estimate for blocks of size 2^( 6) =       0.000428873762
  error estimate for blocks of size 2^( 7) =       0.000429870319

      target function =                  N/A
              le_mean =     -17.217107014779
             les_mean =     296.745642962236
             stat err =       0.000427051057
             autocorr =       1.151090905305
              std dev =       0.562911327212
             le_variance =       0.316869162303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906149597
                                         uncertainty =       0.002892055602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906149597
                                         uncertainty =       0.002892055602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398038436
  error estimate for blocks of size 2^( 2) =       0.000407504960
  error estimate for blocks of size 2^( 3) =       0.000416237211
  error estimate for blocks of size 2^( 4) =       0.000422671666
  error estimate for blocks of size 2^( 5) =       0.000426788533
  error estimate for blocks of size 2^( 6) =       0.000428873792
  error estimate for blocks of size 2^( 7) =       0.000429870345

      target function =                  N/A
              le_mean =     -17.217107018273
             les_mean =     296.745643113072
             stat err =       0.000427051084
             autocorr =       1.151090938316
              std dev =       0.562911354323
             le_variance =       0.316869192826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906177148
                                         uncertainty =       0.002892053951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316906177148
                                         uncertainty =       0.002892053951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398038453
  error estimate for blocks of size 2^( 2) =       0.000407504979
  error estimate for blocks of size 2^( 3) =       0.000416237234
  error estimate for blocks of size 2^( 4) =       0.000422671690
  error estimate for blocks of size 2^( 5) =       0.000426788556
  error estimate for blocks of size 2^( 6) =       0.000428873818
  error estimate for blocks of size 2^( 7) =       0.000429870368

      target function =                  N/A
              le_mean =     -17.217107021341
             les_mean =     296.745643246208
             stat err =       0.000427051108
             autocorr =       1.151090966796
              std dev =       0.562911378756
             le_variance =       0.316869220333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217107021780        initial  <--
     2.3283e+02     2.3283e+03             2.1777e-06       -17.217107014779
     9.3132e+02     9.3132e+03             5.4443e-07       -17.217107018273
     3.7253e+03     3.7253e+04             1.3611e-07       -17.217107021341

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.4249
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.104684e-01 1 1  ON 0
 uu_1                 4.891996e-02 1 1  ON 1
 uu_2                -4.507188e-02 1 1  ON 2
 uu_3                -9.921733e-02 1 1  ON 3
 uu_4                -1.323006e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321683e-02 1 1  ON 7
 uu_8                 9.731993e-02 1 1  ON 8
 uu_9                 1.235532e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355840e-02 1 1  ON 11
 ud_2                -1.454379e-02 1 1  ON 12
 ud_3                -7.438790e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562592e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.828107e-04 1 1  ON 18
 ud_9                 9.256695e-02 1 1  ON 19
 eO_0                -7.658287e-01 1 1  ON 20
 eO_1                -4.483872e-01 1 1  ON 21
 eO_2                -4.416818e-02 1 1  ON 22
 eO_3                 2.080079e-01 1 1  ON 23
 eO_4                 3.017984e-01 1 1  ON 24
 eO_5                 3.162547e-01 1 1  ON 25
 eO_6                 2.558444e-01 1 1  ON 26
 eO_7                 1.181294e-01 1 1  ON 27
 eO_8                 2.889611e-02 1 1  ON 28
 eO_9                 1.867978e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034056e-01 1 1  ON 31
eH1_2                -6.301835e-02 1 1  ON 32
eH1_3                -2.641639e-02 1 1  ON 33
eH1_4                 1.893980e-02 1 1  ON 34
eH1_5                 3.340000e-02 1 1  ON 35
eH1_6                 7.790888e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408687e-02 1 1  ON 38
eH1_9                 2.537926e-02 1 1  ON 39
eH2_0                -1.842266e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443403e-02 1 1  ON 42
eH2_3                -2.763380e-02 1 1  ON 43
eH2_4                 1.795678e-02 1 1  ON 44
eH2_5                 3.308774e-02 1 1  ON 45
eH2_6                 7.960936e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678353e-02 1 1  ON 48
eH2_9                 2.747058e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.164
    reference variance = 0.3567
====================================================
  Execution time = 2.0098e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2617e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326190188517
                                         uncertainty =       0.006664761790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326190188517
                                         uncertainty =       0.006664761790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403840391
  error estimate for blocks of size 2^( 2) =       0.000413685729
  error estimate for blocks of size 2^( 3) =       0.000421755319
  error estimate for blocks of size 2^( 4) =       0.000427833237
  error estimate for blocks of size 2^( 5) =       0.000431591879
  error estimate for blocks of size 2^( 6) =       0.000435206250
  error estimate for blocks of size 2^( 7) =       0.000436307892

      target function =                  N/A
              le_mean =     -17.216566636014
             les_mean =     296.736340691997
             stat err =       0.000432734815
             autocorr =       1.148217512314
              std dev =       0.571116557963
             le_variance =       0.326174122779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656663601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566636014       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566635901       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566635641       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566635571       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566635969       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566635759       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566635805       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216566635843       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 2.071926e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566636014       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566635986       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566635921       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566635903       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566636002       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566635948       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566635958       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216566635972       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 5.180087e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566636014       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566636007       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566635991       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566635986       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566636009       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566636000       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566636023       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216566635961       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.295039e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.091280 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5731e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.104684e-01 1 1  ON 0
 uu_1                 4.891996e-02 1 1  ON 1
 uu_2                -4.507188e-02 1 1  ON 2
 uu_3                -9.921734e-02 1 1  ON 3
 uu_4                -1.323006e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321684e-02 1 1  ON 7
 uu_8                 9.731993e-02 1 1  ON 8
 uu_9                 1.235532e-01 1 1  ON 9
 ud_0                 3.511323e-01 1 1  ON 10
 ud_1                 9.355841e-02 1 1  ON 11
 ud_2                -1.454378e-02 1 1  ON 12
 ud_3                -7.438791e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534351e-01 1 1  ON 15
 ud_6                -1.562591e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.828003e-04 1 1  ON 18
 ud_9                 9.256695e-02 1 1  ON 19
 eO_0                -7.658287e-01 1 1  ON 20
 eO_1                -4.483872e-01 1 1  ON 21
 eO_2                -4.416819e-02 1 1  ON 22
 eO_3                 2.080079e-01 1 1  ON 23
 eO_4                 3.017984e-01 1 1  ON 24
 eO_5                 3.162547e-01 1 1  ON 25
 eO_6                 2.558444e-01 1 1  ON 26
 eO_7                 1.181294e-01 1 1  ON 27
 eO_8                 2.889611e-02 1 1  ON 28
 eO_9                 1.867978e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034056e-01 1 1  ON 31
eH1_2                -6.301835e-02 1 1  ON 32
eH1_3                -2.641639e-02 1 1  ON 33
eH1_4                 1.893981e-02 1 1  ON 34
eH1_5                 3.340000e-02 1 1  ON 35
eH1_6                 7.790887e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408688e-02 1 1  ON 38
eH1_9                 2.537927e-02 1 1  ON 39
eH2_0                -1.842266e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443402e-02 1 1  ON 42
eH2_3                -2.763382e-02 1 1  ON 43
eH2_4                 1.795678e-02 1 1  ON 44
eH2_5                 3.308773e-02 1 1  ON 45
eH2_6                 7.960936e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678354e-02 1 1  ON 48
eH2_9                 2.747059e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1727
    reference variance = 0.144385
====================================================
  Execution time = 1.9473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2189e-01
  Total weights = 2.0000e+06
  Execution time = 1.8251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996438839
                                         uncertainty =       0.005158140843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996438839
                                         uncertainty =       0.005158140843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401181762
  error estimate for blocks of size 2^( 2) =       0.000411061548
  error estimate for blocks of size 2^( 3) =       0.000420003685
  error estimate for blocks of size 2^( 4) =       0.000425280811
  error estimate for blocks of size 2^( 5) =       0.000429035798
  error estimate for blocks of size 2^( 6) =       0.000430353574
  error estimate for blocks of size 2^( 7) =       0.000430924735

      target function =                  N/A
              le_mean =     -17.217460593169
             les_mean =     296.762842728998
             stat err =       0.000428898729
             autocorr =       1.142949800479
              std dev =       0.567356689067
             le_variance =       0.321893612629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996482546
                                         uncertainty =       0.005158141294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996482546
                                         uncertainty =       0.005158141294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401181789
  error estimate for blocks of size 2^( 2) =       0.000411061576
  error estimate for blocks of size 2^( 3) =       0.000420003711
  error estimate for blocks of size 2^( 4) =       0.000425280834
  error estimate for blocks of size 2^( 5) =       0.000429035821
  error estimate for blocks of size 2^( 6) =       0.000430353598
  error estimate for blocks of size 2^( 7) =       0.000430924756

      target function =                  N/A
              le_mean =     -17.217460593451
             les_mean =     296.762842782405
             stat err =       0.000428898752
             autocorr =       1.142949766462
              std dev =       0.567356727559
             le_variance =       0.321893656306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996460692
                                         uncertainty =       0.005158141068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996460692
                                         uncertainty =       0.005158141068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401181776
  error estimate for blocks of size 2^( 2) =       0.000411061562
  error estimate for blocks of size 2^( 3) =       0.000420003698
  error estimate for blocks of size 2^( 4) =       0.000425280822
  error estimate for blocks of size 2^( 5) =       0.000429035810
  error estimate for blocks of size 2^( 6) =       0.000430353586
  error estimate for blocks of size 2^( 7) =       0.000430924746

      target function =                  N/A
              le_mean =     -17.217460593310
             les_mean =     296.762842755700
             stat err =       0.000428898741
             autocorr =       1.142949783472
              std dev =       0.567356708312
             le_variance =       0.321893634466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996441570
                                         uncertainty =       0.005158140871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321996441570
                                         uncertainty =       0.005158140871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401181764
  error estimate for blocks of size 2^( 2) =       0.000411061550
  error estimate for blocks of size 2^( 3) =       0.000420003687
  error estimate for blocks of size 2^( 4) =       0.000425280812
  error estimate for blocks of size 2^( 5) =       0.000429035800
  error estimate for blocks of size 2^( 6) =       0.000430353575
  error estimate for blocks of size 2^( 7) =       0.000430924737

      target function =                  N/A
              le_mean =     -17.217460593186
             les_mean =     296.762842732335
             stat err =       0.000428898731
             autocorr =       1.142949798354
              std dev =       0.567356691472
             le_variance =       0.321893615358


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217460593169        initial
     2.3283e+03     2.3283e+04             2.0719e-07       -17.217460593451  <--
     9.3132e+03     9.3132e+04             5.1801e-08       -17.217460593310
     3.7253e+04     3.7253e+05             1.2950e-08       -17.217460593186

*****************************************************************************
Applying the update for shift_i =   2.3283e+03     and shift_s =   2.3283e+04
*****************************************************************************

  Execution time = 2.8654e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.104685e-01 1 1  ON 0
 uu_1                 4.891995e-02 1 1  ON 1
 uu_2                -4.507190e-02 1 1  ON 2
 uu_3                -9.921738e-02 1 1  ON 3
 uu_4                -1.323007e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321687e-02 1 1  ON 7
 uu_8                 9.731991e-02 1 1  ON 8
 uu_9                 1.235532e-01 1 1  ON 9
 ud_0                 3.511324e-01 1 1  ON 10
 ud_1                 9.355845e-02 1 1  ON 11
 ud_2                -1.454376e-02 1 1  ON 12
 ud_3                -7.438794e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534352e-01 1 1  ON 15
 ud_6                -1.562591e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.827693e-04 1 1  ON 18
 ud_9                 9.256696e-02 1 1  ON 19
 eO_0                -7.658289e-01 1 1  ON 20
 eO_1                -4.483874e-01 1 1  ON 21
 eO_2                -4.416822e-02 1 1  ON 22
 eO_3                 2.080080e-01 1 1  ON 23
 eO_4                 3.017986e-01 1 1  ON 24
 eO_5                 3.162548e-01 1 1  ON 25
 eO_6                 2.558445e-01 1 1  ON 26
 eO_7                 1.181294e-01 1 1  ON 27
 eO_8                 2.889612e-02 1 1  ON 28
 eO_9                 1.867978e-02 1 1  ON 29
eH1_0                -1.823894e-01 1 1  ON 30
eH1_1                -1.034056e-01 1 1  ON 31
eH1_2                -6.301837e-02 1 1  ON 32
eH1_3                -2.641639e-02 1 1  ON 33
eH1_4                 1.893983e-02 1 1  ON 34
eH1_5                 3.339997e-02 1 1  ON 35
eH1_6                 7.790887e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408691e-02 1 1  ON 38
eH1_9                 2.537927e-02 1 1  ON 39
eH2_0                -1.842265e-01 1 1  ON 40
eH2_1                -1.051415e-01 1 1  ON 41
eH2_2                -6.443400e-02 1 1  ON 42
eH2_3                -2.763386e-02 1 1  ON 43
eH2_4                 1.795676e-02 1 1  ON 44
eH2_5                 3.308773e-02 1 1  ON 45
eH2_6                 7.960936e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678356e-02 1 1  ON 48
eH2_9                 2.747060e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4391e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.22179
====================================================
  Execution time = 1.9969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1668e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316719497563
                                         uncertainty =       0.003624206720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316719497563
                                         uncertainty =       0.003624206720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397919523
  error estimate for blocks of size 2^( 2) =       0.000407539774
  error estimate for blocks of size 2^( 3) =       0.000415721335
  error estimate for blocks of size 2^( 4) =       0.000422225674
  error estimate for blocks of size 2^( 5) =       0.000426299512
  error estimate for blocks of size 2^( 6) =       0.000428057817
  error estimate for blocks of size 2^( 7) =       0.000430031648

      target function =                  N/A
              le_mean =     -17.216142257993
             les_mean =     296.712233981994
             stat err =       0.000426653663
             autocorr =       1.149636286978
              std dev =       0.562743185550
             le_variance =       0.316679892883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614225799e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216142257993       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216142257516       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216142256926       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216142257349       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216142257339       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216142257796       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216142257353       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216142257352       residual = 9.73e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 9.449335e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216142257993       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216142257874       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216142257726       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216142257832       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216142257829       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216142257943       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216142257833       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216142257833       residual = 9.71e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 2.362872e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216142257993       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216142257963       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216142257926       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216142257953       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216142257952       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216142257976       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216142257955       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216142257953       residual = 9.70e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 5.907516e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5464e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.104686e-01 1 1  ON 0
 uu_1                 4.891998e-02 1 1  ON 1
 uu_2                -4.507187e-02 1 1  ON 2
 uu_3                -9.921743e-02 1 1  ON 3
 uu_4                -1.323007e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164213e-01 1 1  ON 6
 uu_7                -4.321691e-02 1 1  ON 7
 uu_8                 9.731989e-02 1 1  ON 8
 uu_9                 1.235533e-01 1 1  ON 9
 ud_0                 3.511325e-01 1 1  ON 10
 ud_1                 9.355846e-02 1 1  ON 11
 ud_2                -1.454375e-02 1 1  ON 12
 ud_3                -7.438802e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534352e-01 1 1  ON 15
 ud_6                -1.562591e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.827292e-04 1 1  ON 18
 ud_9                 9.256697e-02 1 1  ON 19
 eO_0                -7.658290e-01 1 1  ON 20
 eO_1                -4.483876e-01 1 1  ON 21
 eO_2                -4.416823e-02 1 1  ON 22
 eO_3                 2.080081e-01 1 1  ON 23
 eO_4                 3.017987e-01 1 1  ON 24
 eO_5                 3.162549e-01 1 1  ON 25
 eO_6                 2.558445e-01 1 1  ON 26
 eO_7                 1.181295e-01 1 1  ON 27
 eO_8                 2.889613e-02 1 1  ON 28
 eO_9                 1.867978e-02 1 1  ON 29
eH1_0                -1.823895e-01 1 1  ON 30
eH1_1                -1.034057e-01 1 1  ON 31
eH1_2                -6.301835e-02 1 1  ON 32
eH1_3                -2.641640e-02 1 1  ON 33
eH1_4                 1.893981e-02 1 1  ON 34
eH1_5                 3.339998e-02 1 1  ON 35
eH1_6                 7.790889e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408694e-02 1 1  ON 38
eH1_9                 2.537929e-02 1 1  ON 39
eH2_0                -1.842266e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443396e-02 1 1  ON 42
eH2_3                -2.763386e-02 1 1  ON 43
eH2_4                 1.795676e-02 1 1  ON 44
eH2_5                 3.308770e-02 1 1  ON 45
eH2_6                 7.960936e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678360e-02 1 1  ON 48
eH2_9                 2.747061e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1763
    reference variance = 0.201666
====================================================
  Execution time = 2.0108e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1659e-01
  Total weights = 2.0000e+06
  Execution time = 1.8276e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544595519
                                         uncertainty =       0.002714404186

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544595519
                                         uncertainty =       0.002714404186

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397861438
  error estimate for blocks of size 2^( 2) =       0.000407828386
  error estimate for blocks of size 2^( 3) =       0.000416373126
  error estimate for blocks of size 2^( 4) =       0.000422518258
  error estimate for blocks of size 2^( 5) =       0.000425967843
  error estimate for blocks of size 2^( 6) =       0.000427658768
  error estimate for blocks of size 2^( 7) =       0.000429886103

      target function =                  N/A
              le_mean =     -17.216424432691
             les_mean =     296.721857535787
             stat err =       0.000426507743
             autocorr =       1.149185517882
              std dev =       0.562661041403
             le_variance =       0.316587447513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544873741
                                         uncertainty =       0.002714406983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544873741
                                         uncertainty =       0.002714406983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397861613
  error estimate for blocks of size 2^( 2) =       0.000407828553
  error estimate for blocks of size 2^( 3) =       0.000416373284
  error estimate for blocks of size 2^( 4) =       0.000422518408
  error estimate for blocks of size 2^( 5) =       0.000425967988
  error estimate for blocks of size 2^( 6) =       0.000427658920
  error estimate for blocks of size 2^( 7) =       0.000429886258

      target function =                  N/A
              le_mean =     -17.216424433685
             les_mean =     296.721857848364
             stat err =       0.000426507893
             autocorr =       1.149185317539
              std dev =       0.562661288753
             le_variance =       0.316587725861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544734672
                                         uncertainty =       0.002714405585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544734672
                                         uncertainty =       0.002714405585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397861525
  error estimate for blocks of size 2^( 2) =       0.000407828469
  error estimate for blocks of size 2^( 3) =       0.000416373205
  error estimate for blocks of size 2^( 4) =       0.000422518333
  error estimate for blocks of size 2^( 5) =       0.000425967915
  error estimate for blocks of size 2^( 6) =       0.000427658844
  error estimate for blocks of size 2^( 7) =       0.000429886180

      target function =                  N/A
              le_mean =     -17.216424433188
             les_mean =     296.721857692119
             stat err =       0.000426507818
             autocorr =       1.149185417700
              std dev =       0.562661165116
             le_variance =       0.316587586729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544612915
                                         uncertainty =       0.002714404361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316544612915
                                         uncertainty =       0.002714404361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397861449
  error estimate for blocks of size 2^( 2) =       0.000407828396
  error estimate for blocks of size 2^( 3) =       0.000416373135
  error estimate for blocks of size 2^( 4) =       0.000422518268
  error estimate for blocks of size 2^( 5) =       0.000425967852
  error estimate for blocks of size 2^( 6) =       0.000427658778
  error estimate for blocks of size 2^( 7) =       0.000429886112

      target function =                  N/A
              le_mean =     -17.216424432753
             les_mean =     296.721857555329
             stat err =       0.000426507752
             autocorr =       1.149185505356
              std dev =       0.562661056868
             le_variance =       0.316587464916


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216424432691        initial
     5.8208e+02     5.8208e+03             9.4493e-07       -17.216424433685  <--
     2.3283e+03     2.3283e+04             2.3629e-07       -17.216424433188
     9.3132e+03     9.3132e+04             5.9075e-08       -17.216424432753

*****************************************************************************
Applying the update for shift_i =   5.8208e+02     and shift_s =   5.8208e+03
*****************************************************************************

  Execution time = 2.9323e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.104687e-01 1 1  ON 0
 uu_1                 4.892007e-02 1 1  ON 1
 uu_2                -4.507177e-02 1 1  ON 2
 uu_3                -9.921759e-02 1 1  ON 3
 uu_4                -1.323008e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164214e-01 1 1  ON 6
 uu_7                -4.321702e-02 1 1  ON 7
 uu_8                 9.731982e-02 1 1  ON 8
 uu_9                 1.235533e-01 1 1  ON 9
 ud_0                 3.511327e-01 1 1  ON 10
 ud_1                 9.355850e-02 1 1  ON 11
 ud_2                -1.454373e-02 1 1  ON 12
 ud_3                -7.438824e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562590e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.826089e-04 1 1  ON 18
 ud_9                 9.256700e-02 1 1  ON 19
 eO_0                -7.658296e-01 1 1  ON 20
 eO_1                -4.483883e-01 1 1  ON 21
 eO_2                -4.416828e-02 1 1  ON 22
 eO_3                 2.080083e-01 1 1  ON 23
 eO_4                 3.017991e-01 1 1  ON 24
 eO_5                 3.162552e-01 1 1  ON 25
 eO_6                 2.558447e-01 1 1  ON 26
 eO_7                 1.181297e-01 1 1  ON 27
 eO_8                 2.889616e-02 1 1  ON 28
 eO_9                 1.867980e-02 1 1  ON 29
eH1_0                -1.823895e-01 1 1  ON 30
eH1_1                -1.034059e-01 1 1  ON 31
eH1_2                -6.301828e-02 1 1  ON 32
eH1_3                -2.641643e-02 1 1  ON 33
eH1_4                 1.893973e-02 1 1  ON 34
eH1_5                 3.339999e-02 1 1  ON 35
eH1_6                 7.790896e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408705e-02 1 1  ON 38
eH1_9                 2.537933e-02 1 1  ON 39
eH2_0                -1.842267e-01 1 1  ON 40
eH2_1                -1.051417e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763387e-02 1 1  ON 43
eH2_4                 1.795677e-02 1 1  ON 44
eH2_5                 3.308762e-02 1 1  ON 45
eH2_6                 7.960937e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678369e-02 1 1  ON 48
eH2_9                 2.747064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.189219
====================================================
  Execution time = 2.2087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1699e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317001159595
                                         uncertainty =       0.002438695028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317001159595
                                         uncertainty =       0.002438695028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398112016
  error estimate for blocks of size 2^( 2) =       0.000407689749
  error estimate for blocks of size 2^( 3) =       0.000416719069
  error estimate for blocks of size 2^( 4) =       0.000422826817
  error estimate for blocks of size 2^( 5) =       0.000427415227
  error estimate for blocks of size 2^( 6) =       0.000429154456
  error estimate for blocks of size 2^( 7) =       0.000429210198

      target function =                  N/A
              le_mean =     -17.216373884021
             les_mean =     296.720515910608
             stat err =       0.000427151674
             autocorr =       1.151207616183
              std dev =       0.563015412481
             le_variance =       0.316986354691


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721637388402e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216373884021       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216373891519       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216373898059       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216373903367       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216373901648       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216373903775       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216373903632       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 3.683896e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216373884021       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216373885898       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216373887536       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216373888864       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216373888437       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216373888967       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216373888931       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 9.211633e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216373884021       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216373884491       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216373884900       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216373885235       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216373885126       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216373885259       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216373885249       residual = 5.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+03 is 2.303026e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096172 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7660e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.104691e-01 1 1  ON 0
 uu_1                 4.892024e-02 1 1  ON 1
 uu_2                -4.507151e-02 1 1  ON 2
 uu_3                -9.921777e-02 1 1  ON 3
 uu_4                -1.323008e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321735e-02 1 1  ON 7
 uu_8                 9.731962e-02 1 1  ON 8
 uu_9                 1.235534e-01 1 1  ON 9
 ud_0                 3.511329e-01 1 1  ON 10
 ud_1                 9.355876e-02 1 1  ON 11
 ud_2                -1.454369e-02 1 1  ON 12
 ud_3                -7.438825e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534356e-01 1 1  ON 15
 ud_6                -1.562591e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.823979e-04 1 1  ON 18
 ud_9                 9.256700e-02 1 1  ON 19
 eO_0                -7.658305e-01 1 1  ON 20
 eO_1                -4.483890e-01 1 1  ON 21
 eO_2                -4.416838e-02 1 1  ON 22
 eO_3                 2.080088e-01 1 1  ON 23
 eO_4                 3.017997e-01 1 1  ON 24
 eO_5                 3.162554e-01 1 1  ON 25
 eO_6                 2.558448e-01 1 1  ON 26
 eO_7                 1.181298e-01 1 1  ON 27
 eO_8                 2.889618e-02 1 1  ON 28
 eO_9                 1.867982e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034059e-01 1 1  ON 31
eH1_2                -6.301828e-02 1 1  ON 32
eH1_3                -2.641630e-02 1 1  ON 33
eH1_4                 1.893971e-02 1 1  ON 34
eH1_5                 3.339998e-02 1 1  ON 35
eH1_6                 7.790895e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408713e-02 1 1  ON 38
eH1_9                 2.537935e-02 1 1  ON 39
eH2_0                -1.842268e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763404e-02 1 1  ON 43
eH2_4                 1.795671e-02 1 1  ON 44
eH2_5                 3.308789e-02 1 1  ON 45
eH2_6                 7.960932e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678378e-02 1 1  ON 48
eH2_9                 2.747068e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2584
    reference variance = 0.214007
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1663e-01
  Total weights = 2.0000e+06
  Execution time = 1.8233e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641044587
                                         uncertainty =       0.003561449373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641044587
                                         uncertainty =       0.003561449373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397888978
  error estimate for blocks of size 2^( 2) =       0.000407765796
  error estimate for blocks of size 2^( 3) =       0.000416285221
  error estimate for blocks of size 2^( 4) =       0.000422316625
  error estimate for blocks of size 2^( 5) =       0.000427548113
  error estimate for blocks of size 2^( 6) =       0.000429518271
  error estimate for blocks of size 2^( 7) =       0.000430633994

      target function =                  N/A
              le_mean =     -17.216396991874
             les_mean =     296.720956500823
             stat err =       0.000427504251
             autocorr =       1.154401964947
              std dev =       0.562699988751
             le_variance =       0.316631277341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641285488
                                         uncertainty =       0.003561460887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641285488
                                         uncertainty =       0.003561460887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397889129
  error estimate for blocks of size 2^( 2) =       0.000407765934
  error estimate for blocks of size 2^( 3) =       0.000416285331
  error estimate for blocks of size 2^( 4) =       0.000422316724
  error estimate for blocks of size 2^( 5) =       0.000427548232
  error estimate for blocks of size 2^( 6) =       0.000429518392
  error estimate for blocks of size 2^( 7) =       0.000430634106

      target function =                  N/A
              le_mean =     -17.216396991177
             les_mean =     296.720956716804
             stat err =       0.000427504363
             autocorr =       1.154401697506
              std dev =       0.562700201978
             le_variance =       0.316631517306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641164172
                                         uncertainty =       0.003561455124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641164172
                                         uncertainty =       0.003561455124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397889053
  error estimate for blocks of size 2^( 2) =       0.000407765865
  error estimate for blocks of size 2^( 3) =       0.000416285275
  error estimate for blocks of size 2^( 4) =       0.000422316674
  error estimate for blocks of size 2^( 5) =       0.000427548172
  error estimate for blocks of size 2^( 6) =       0.000429518331
  error estimate for blocks of size 2^( 7) =       0.000430634049

      target function =                  N/A
              le_mean =     -17.216396991521
             les_mean =     296.720956607801
             stat err =       0.000427504306
             autocorr =       1.154401831817
              std dev =       0.562700094595
             le_variance =       0.316631396457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641059507
                                         uncertainty =       0.003561450091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316641059507
                                         uncertainty =       0.003561450091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397888987
  error estimate for blocks of size 2^( 2) =       0.000407765805
  error estimate for blocks of size 2^( 3) =       0.000416285227
  error estimate for blocks of size 2^( 4) =       0.000422316631
  error estimate for blocks of size 2^( 5) =       0.000427548120
  error estimate for blocks of size 2^( 6) =       0.000429518279
  error estimate for blocks of size 2^( 7) =       0.000430634001

      target function =                  N/A
              le_mean =     -17.216396991829
             les_mean =     296.720956514157
             stat err =       0.000427504258
             autocorr =       1.154401948318
              std dev =       0.562700001957
             le_variance =       0.316631292202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216396991874        initial  <--
     1.4552e+02     1.4552e+03             3.6839e-06       -17.216396991177
     5.8208e+02     5.8208e+03             9.2116e-07       -17.216396991521
     2.3283e+03     2.3283e+04             2.3030e-07       -17.216396991829

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1699
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.104687e-01 1 1  ON 0
 uu_1                 4.892007e-02 1 1  ON 1
 uu_2                -4.507177e-02 1 1  ON 2
 uu_3                -9.921759e-02 1 1  ON 3
 uu_4                -1.323008e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164214e-01 1 1  ON 6
 uu_7                -4.321702e-02 1 1  ON 7
 uu_8                 9.731982e-02 1 1  ON 8
 uu_9                 1.235533e-01 1 1  ON 9
 ud_0                 3.511327e-01 1 1  ON 10
 ud_1                 9.355850e-02 1 1  ON 11
 ud_2                -1.454373e-02 1 1  ON 12
 ud_3                -7.438824e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562590e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.826089e-04 1 1  ON 18
 ud_9                 9.256700e-02 1 1  ON 19
 eO_0                -7.658296e-01 1 1  ON 20
 eO_1                -4.483883e-01 1 1  ON 21
 eO_2                -4.416828e-02 1 1  ON 22
 eO_3                 2.080083e-01 1 1  ON 23
 eO_4                 3.017991e-01 1 1  ON 24
 eO_5                 3.162552e-01 1 1  ON 25
 eO_6                 2.558447e-01 1 1  ON 26
 eO_7                 1.181297e-01 1 1  ON 27
 eO_8                 2.889616e-02 1 1  ON 28
 eO_9                 1.867980e-02 1 1  ON 29
eH1_0                -1.823895e-01 1 1  ON 30
eH1_1                -1.034059e-01 1 1  ON 31
eH1_2                -6.301828e-02 1 1  ON 32
eH1_3                -2.641643e-02 1 1  ON 33
eH1_4                 1.893973e-02 1 1  ON 34
eH1_5                 3.339999e-02 1 1  ON 35
eH1_6                 7.790896e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408705e-02 1 1  ON 38
eH1_9                 2.537933e-02 1 1  ON 39
eH2_0                -1.842267e-01 1 1  ON 40
eH2_1                -1.051417e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763387e-02 1 1  ON 43
eH2_4                 1.795677e-02 1 1  ON 44
eH2_5                 3.308762e-02 1 1  ON 45
eH2_6                 7.960937e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678369e-02 1 1  ON 48
eH2_9                 2.747064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2573
    reference variance = 0.187518
====================================================
  Execution time = 2.0161e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2401e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324064353294
                                         uncertainty =       0.004706059275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324064353294
                                         uncertainty =       0.004706059275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402497032
  error estimate for blocks of size 2^( 2) =       0.000411940390
  error estimate for blocks of size 2^( 3) =       0.000420477691
  error estimate for blocks of size 2^( 4) =       0.000427310853
  error estimate for blocks of size 2^( 5) =       0.000431748242
  error estimate for blocks of size 2^( 6) =       0.000434081849
  error estimate for blocks of size 2^( 7) =       0.000434697742

      target function =                  N/A
              le_mean =     -17.216336598187
             les_mean =     296.726253421931
             stat err =       0.000431959671
             autocorr =       1.151757474524
              std dev =       0.569216761762
             le_variance =       0.324007721871


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721633659819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216336598187       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216336597977       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216336597881       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216336598269       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216336598196       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216336598117       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216336598408       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216336598356       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 4.108720e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216336598187       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216336598134       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216336598110       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216336598206       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216336598190       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216336598170       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216336598248       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216336598234       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 1.027186e-07

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216336598187       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216336598174       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216336598168       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216336598191       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216336598187       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216336598170       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216336598095       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216336598180       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 2.567970e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.098829 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5639e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.104687e-01 1 1  ON 0
 uu_1                 4.892007e-02 1 1  ON 1
 uu_2                -4.507176e-02 1 1  ON 2
 uu_3                -9.921761e-02 1 1  ON 3
 uu_4                -1.323008e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164214e-01 1 1  ON 6
 uu_7                -4.321705e-02 1 1  ON 7
 uu_8                 9.731980e-02 1 1  ON 8
 uu_9                 1.235533e-01 1 1  ON 9
 ud_0                 3.511328e-01 1 1  ON 10
 ud_1                 9.355852e-02 1 1  ON 11
 ud_2                -1.454373e-02 1 1  ON 12
 ud_3                -7.438826e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562590e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.825855e-04 1 1  ON 18
 ud_9                 9.256700e-02 1 1  ON 19
 eO_0                -7.658297e-01 1 1  ON 20
 eO_1                -4.483884e-01 1 1  ON 21
 eO_2                -4.416828e-02 1 1  ON 22
 eO_3                 2.080084e-01 1 1  ON 23
 eO_4                 3.017991e-01 1 1  ON 24
 eO_5                 3.162552e-01 1 1  ON 25
 eO_6                 2.558447e-01 1 1  ON 26
 eO_7                 1.181297e-01 1 1  ON 27
 eO_8                 2.889617e-02 1 1  ON 28
 eO_9                 1.867980e-02 1 1  ON 29
eH1_0                -1.823895e-01 1 1  ON 30
eH1_1                -1.034059e-01 1 1  ON 31
eH1_2                -6.301826e-02 1 1  ON 32
eH1_3                -2.641643e-02 1 1  ON 33
eH1_4                 1.893973e-02 1 1  ON 34
eH1_5                 3.339997e-02 1 1  ON 35
eH1_6                 7.790897e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408706e-02 1 1  ON 38
eH1_9                 2.537933e-02 1 1  ON 39
eH2_0                -1.842267e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443385e-02 1 1  ON 42
eH2_3                -2.763388e-02 1 1  ON 43
eH2_4                 1.795677e-02 1 1  ON 44
eH2_5                 3.308763e-02 1 1  ON 45
eH2_6                 7.960937e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678370e-02 1 1  ON 48
eH2_9                 2.747065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1382
    reference variance = 0.36087
====================================================
  Execution time = 1.9900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2456e-01
  Total weights = 2.0000e+06
  Execution time = 1.8251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123811590
                                         uncertainty =       0.004326528152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123811590
                                         uncertainty =       0.004326528152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840531
  error estimate for blocks of size 2^( 2) =       0.000412354411
  error estimate for blocks of size 2^( 3) =       0.000421203995
  error estimate for blocks of size 2^( 4) =       0.000427307255
  error estimate for blocks of size 2^( 5) =       0.000431767260
  error estimate for blocks of size 2^( 6) =       0.000434154590
  error estimate for blocks of size 2^( 7) =       0.000435628655

      target function =                  N/A
              le_mean =     -17.216790599470
             les_mean =     296.742439370545
             stat err =       0.000432214440
             autocorr =       1.151150815683
              std dev =       0.569702542422
             le_variance =       0.324560986843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123971017
                                         uncertainty =       0.004326530755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123971017
                                         uncertainty =       0.004326530755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840630
  error estimate for blocks of size 2^( 2) =       0.000412354506
  error estimate for blocks of size 2^( 3) =       0.000421204085
  error estimate for blocks of size 2^( 4) =       0.000427307342
  error estimate for blocks of size 2^( 5) =       0.000431767343
  error estimate for blocks of size 2^( 6) =       0.000434154672
  error estimate for blocks of size 2^( 7) =       0.000435628736

      target function =                  N/A
              le_mean =     -17.216790600143
             les_mean =     296.742439553278
             stat err =       0.000432214523
             autocorr =       1.151150692666
              std dev =       0.569702682440
             le_variance =       0.324561146380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123891310
                                         uncertainty =       0.004326529454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123891310
                                         uncertainty =       0.004326529454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840581
  error estimate for blocks of size 2^( 2) =       0.000412354458
  error estimate for blocks of size 2^( 3) =       0.000421204040
  error estimate for blocks of size 2^( 4) =       0.000427307299
  error estimate for blocks of size 2^( 5) =       0.000431767302
  error estimate for blocks of size 2^( 6) =       0.000434154631
  error estimate for blocks of size 2^( 7) =       0.000435628696

      target function =                  N/A
              le_mean =     -17.216790599806
             les_mean =     296.742439461918
             stat err =       0.000432214482
             autocorr =       1.151150754163
              std dev =       0.569702612437
             le_variance =       0.324561066617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123821555
                                         uncertainty =       0.004326528315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324123821555
                                         uncertainty =       0.004326528315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840537
  error estimate for blocks of size 2^( 2) =       0.000412354417
  error estimate for blocks of size 2^( 3) =       0.000421204000
  error estimate for blocks of size 2^( 4) =       0.000427307261
  error estimate for blocks of size 2^( 5) =       0.000431767265
  error estimate for blocks of size 2^( 6) =       0.000434154595
  error estimate for blocks of size 2^( 7) =       0.000435628660

      target function =                  N/A
              le_mean =     -17.216790599512
             les_mean =     296.742439381966
             stat err =       0.000432214445
             autocorr =       1.151150807991
              std dev =       0.569702551175
             le_variance =       0.324560996815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216790599470        initial
     1.4552e+03     1.4552e+04             4.1087e-07       -17.216790600143  <--
     5.8208e+03     5.8208e+04             1.0272e-07       -17.216790599806
     2.3283e+04     2.3283e+05             2.5680e-08       -17.216790599512

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 2.9098e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.104688e-01 1 1  ON 0
 uu_1                 4.892007e-02 1 1  ON 1
 uu_2                -4.507175e-02 1 1  ON 2
 uu_3                -9.921765e-02 1 1  ON 3
 uu_4                -1.323008e-01 1 1  ON 4
 uu_5                -1.393385e-01 1 1  ON 5
 uu_6                -1.164215e-01 1 1  ON 6
 uu_7                -4.321711e-02 1 1  ON 7
 uu_8                 9.731977e-02 1 1  ON 8
 uu_9                 1.235534e-01 1 1  ON 9
 ud_0                 3.511329e-01 1 1  ON 10
 ud_1                 9.355860e-02 1 1  ON 11
 ud_2                -1.454373e-02 1 1  ON 12
 ud_3                -7.438833e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562590e-01 1 1  ON 16
 ud_7                -1.121235e-01 1 1  ON 17
 ud_8                 4.825154e-04 1 1  ON 18
 ud_9                 9.256700e-02 1 1  ON 19
 eO_0                -7.658300e-01 1 1  ON 20
 eO_1                -4.483886e-01 1 1  ON 21
 eO_2                -4.416830e-02 1 1  ON 22
 eO_3                 2.080085e-01 1 1  ON 23
 eO_4                 3.017993e-01 1 1  ON 24
 eO_5                 3.162553e-01 1 1  ON 25
 eO_6                 2.558448e-01 1 1  ON 26
 eO_7                 1.181297e-01 1 1  ON 27
 eO_8                 2.889618e-02 1 1  ON 28
 eO_9                 1.867980e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034059e-01 1 1  ON 31
eH1_2                -6.301820e-02 1 1  ON 32
eH1_3                -2.641642e-02 1 1  ON 33
eH1_4                 1.893973e-02 1 1  ON 34
eH1_5                 3.339991e-02 1 1  ON 35
eH1_6                 7.790899e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408708e-02 1 1  ON 38
eH1_9                 2.537933e-02 1 1  ON 39
eH2_0                -1.842268e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443384e-02 1 1  ON 42
eH2_3                -2.763392e-02 1 1  ON 43
eH2_4                 1.795678e-02 1 1  ON 44
eH2_5                 3.308764e-02 1 1  ON 45
eH2_6                 7.960935e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678374e-02 1 1  ON 48
eH2_9                 2.747066e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2308
    reference variance = 0.128958
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2311e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5665e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323116638332
                                         uncertainty =       0.003928492259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323116638332
                                         uncertainty =       0.003928492259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401941406
  error estimate for blocks of size 2^( 2) =       0.000411241283
  error estimate for blocks of size 2^( 3) =       0.000420361773
  error estimate for blocks of size 2^( 4) =       0.000426607200
  error estimate for blocks of size 2^( 5) =       0.000430289094
  error estimate for blocks of size 2^( 6) =       0.000431652397
  error estimate for blocks of size 2^( 7) =       0.000434025374

      target function =                  N/A
              le_mean =     -17.217263770981
             les_mean =     296.757285385329
             stat err =       0.000430643516
             autocorr =       1.147916587949
              std dev =       0.568430987336
             le_variance =       0.323113787363


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721726377098e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217263770981       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217263772446       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217263771877       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217263772231       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217263773228       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217263772719       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217263772782       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 1.442033e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217263770981       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217263771347       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217263771205       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217263771293       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217263771543       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217263771415       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217263771432       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 3.605537e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217263770981       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217263771072       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217263771037       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217263771059       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217263771121       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217263771089       residual = 4.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217263771093       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 9.014127e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101214 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5664e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.104689e-01 1 1  ON 0
 uu_1                 4.892017e-02 1 1  ON 1
 uu_2                -4.507168e-02 1 1  ON 2
 uu_3                -9.921767e-02 1 1  ON 3
 uu_4                -1.323009e-01 1 1  ON 4
 uu_5                -1.393384e-01 1 1  ON 5
 uu_6                -1.164215e-01 1 1  ON 6
 uu_7                -4.321719e-02 1 1  ON 7
 uu_8                 9.731971e-02 1 1  ON 8
 uu_9                 1.235534e-01 1 1  ON 9
 ud_0                 3.511330e-01 1 1  ON 10
 ud_1                 9.355862e-02 1 1  ON 11
 ud_2                -1.454370e-02 1 1  ON 12
 ud_3                -7.438842e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562590e-01 1 1  ON 16
 ud_7                -1.121236e-01 1 1  ON 17
 ud_8                 4.824350e-04 1 1  ON 18
 ud_9                 9.256700e-02 1 1  ON 19
 eO_0                -7.658304e-01 1 1  ON 20
 eO_1                -4.483888e-01 1 1  ON 21
 eO_2                -4.416835e-02 1 1  ON 22
 eO_3                 2.080087e-01 1 1  ON 23
 eO_4                 3.017994e-01 1 1  ON 24
 eO_5                 3.162555e-01 1 1  ON 25
 eO_6                 2.558448e-01 1 1  ON 26
 eO_7                 1.181298e-01 1 1  ON 27
 eO_8                 2.889619e-02 1 1  ON 28
 eO_9                 1.867981e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034060e-01 1 1  ON 31
eH1_2                -6.301823e-02 1 1  ON 32
eH1_3                -2.641642e-02 1 1  ON 33
eH1_4                 1.893974e-02 1 1  ON 34
eH1_5                 3.339997e-02 1 1  ON 35
eH1_6                 7.790899e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408713e-02 1 1  ON 38
eH1_9                 2.537935e-02 1 1  ON 39
eH2_0                -1.842269e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443384e-02 1 1  ON 42
eH2_3                -2.763389e-02 1 1  ON 43
eH2_4                 1.795680e-02 1 1  ON 44
eH2_5                 3.308765e-02 1 1  ON 45
eH2_6                 7.960934e-02 1 1  ON 46
eH2_7                 1.140544e-01 1 1  ON 47
eH2_8                 9.678378e-02 1 1  ON 48
eH2_9                 2.747068e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1628
    reference variance = 0.183108
====================================================
  Execution time = 1.9641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1797e-01
  Total weights = 2.0000e+06
  Execution time = 1.8256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012602219
                                         uncertainty =       0.003738512197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012602219
                                         uncertainty =       0.003738512197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398732318
  error estimate for blocks of size 2^( 2) =       0.000408516330
  error estimate for blocks of size 2^( 3) =       0.000417838365
  error estimate for blocks of size 2^( 4) =       0.000423725759
  error estimate for blocks of size 2^( 5) =       0.000427650313
  error estimate for blocks of size 2^( 6) =       0.000429436933
  error estimate for blocks of size 2^( 7) =       0.000431609479

      target function =                  N/A
              le_mean =     -17.217066385219
             les_mean =     296.745349677347
             stat err =       0.000428105621
             autocorr =       1.152760230256
              std dev =       0.563892652271
             le_variance =       0.317974923285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012677651
                                         uncertainty =       0.003738514215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012677651
                                         uncertainty =       0.003738514215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398732366
  error estimate for blocks of size 2^( 2) =       0.000408516374
  error estimate for blocks of size 2^( 3) =       0.000417838404
  error estimate for blocks of size 2^( 4) =       0.000423725794
  error estimate for blocks of size 2^( 5) =       0.000427650343
  error estimate for blocks of size 2^( 6) =       0.000429436963
  error estimate for blocks of size 2^( 7) =       0.000431609519

      target function =                  N/A
              le_mean =     -17.217066385775
             les_mean =     296.745349771827
             stat err =       0.000428105655
             autocorr =       1.152760137633
              std dev =       0.563892719081
             le_variance =       0.317974998633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012639857
                                         uncertainty =       0.003738513206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012639857
                                         uncertainty =       0.003738513206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398732342
  error estimate for blocks of size 2^( 2) =       0.000408516352
  error estimate for blocks of size 2^( 3) =       0.000417838384
  error estimate for blocks of size 2^( 4) =       0.000423725776
  error estimate for blocks of size 2^( 5) =       0.000427650328
  error estimate for blocks of size 2^( 6) =       0.000429436948
  error estimate for blocks of size 2^( 7) =       0.000431609499

      target function =                  N/A
              le_mean =     -17.217066385496
             les_mean =     296.745349724481
             stat err =       0.000428105638
             autocorr =       1.152760183993
              std dev =       0.563892685607
             le_variance =       0.317974960881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012606921
                                         uncertainty =       0.003738512323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318012606921
                                         uncertainty =       0.003738512323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398732321
  error estimate for blocks of size 2^( 2) =       0.000408516332
  error estimate for blocks of size 2^( 3) =       0.000417838367
  error estimate for blocks of size 2^( 4) =       0.000423725761
  error estimate for blocks of size 2^( 5) =       0.000427650315
  error estimate for blocks of size 2^( 6) =       0.000429436935
  error estimate for blocks of size 2^( 7) =       0.000431609481

      target function =                  N/A
              le_mean =     -17.217066385254
             les_mean =     296.745349683235
             stat err =       0.000428105623
             autocorr =       1.152760224480
              std dev =       0.563892656436
             le_variance =       0.317974927982


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217066385219        initial
     3.6380e+02     3.6380e+03             1.4420e-06       -17.217066385775  <--
     1.4552e+03     1.4552e+04             3.6055e-07       -17.217066385496
     5.8208e+03     5.8208e+04             9.0141e-08       -17.217066385254

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.8843e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.104690e-01 1 1  ON 0
 uu_1                 4.892046e-02 1 1  ON 1
 uu_2                -4.507146e-02 1 1  ON 2
 uu_3                -9.921772e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321743e-02 1 1  ON 7
 uu_8                 9.731954e-02 1 1  ON 8
 uu_9                 1.235535e-01 1 1  ON 9
 ud_0                 3.511331e-01 1 1  ON 10
 ud_1                 9.355869e-02 1 1  ON 11
 ud_2                -1.454360e-02 1 1  ON 12
 ud_3                -7.438868e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562589e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821938e-04 1 1  ON 18
 ud_9                 9.256703e-02 1 1  ON 19
 eO_0                -7.658315e-01 1 1  ON 20
 eO_1                -4.483894e-01 1 1  ON 21
 eO_2                -4.416849e-02 1 1  ON 22
 eO_3                 2.080091e-01 1 1  ON 23
 eO_4                 3.018000e-01 1 1  ON 24
 eO_5                 3.162559e-01 1 1  ON 25
 eO_6                 2.558450e-01 1 1  ON 26
 eO_7                 1.181300e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301833e-02 1 1  ON 32
eH1_3                -2.641643e-02 1 1  ON 33
eH1_4                 1.893977e-02 1 1  ON 34
eH1_5                 3.340016e-02 1 1  ON 35
eH1_6                 7.790899e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408729e-02 1 1  ON 38
eH1_9                 2.537940e-02 1 1  ON 39
eH2_0                -1.842271e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763379e-02 1 1  ON 43
eH2_4                 1.795687e-02 1 1  ON 44
eH2_5                 3.308769e-02 1 1  ON 45
eH2_6                 7.960932e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678388e-02 1 1  ON 48
eH2_9                 2.747072e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4513e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1874
    reference variance = 0.264975
====================================================
  Execution time = 2.2158e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2590e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325928478689
                                         uncertainty =       0.004449712496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325928478689
                                         uncertainty =       0.004449712496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403667953
  error estimate for blocks of size 2^( 2) =       0.000413243905
  error estimate for blocks of size 2^( 3) =       0.000421906499
  error estimate for blocks of size 2^( 4) =       0.000427742164
  error estimate for blocks of size 2^( 5) =       0.000432606948
  error estimate for blocks of size 2^( 6) =       0.000435316234
  error estimate for blocks of size 2^( 7) =       0.000437983265

      target function =                  N/A
              le_mean =     -17.217777540875
             les_mean =     296.777758916786
             stat err =       0.000433412153
             autocorr =       1.152799088219
              std dev =       0.570872693930
             le_variance =       0.325895632675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721777754087e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217777540875       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217777537946       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217777534305       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217777540384       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217777544253       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217777541902       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217777543113       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 6.570474e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217777540875       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217777540142       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217777539227       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217777540750       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217777541722       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217777541134       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217777541434       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 1.643994e-06

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217777540875       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217777540692       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217777540463       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217777540844       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217777541087       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217777540940       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217777541014       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 4.110847e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.103464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7703e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.104690e-01 1 1  ON 0
 uu_1                 4.892050e-02 1 1  ON 1
 uu_2                -4.507133e-02 1 1  ON 2
 uu_3                -9.921776e-02 1 1  ON 3
 uu_4                -1.323015e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321772e-02 1 1  ON 7
 uu_8                 9.731938e-02 1 1  ON 8
 uu_9                 1.235537e-01 1 1  ON 9
 ud_0                 3.511330e-01 1 1  ON 10
 ud_1                 9.355898e-02 1 1  ON 11
 ud_2                -1.454349e-02 1 1  ON 12
 ud_3                -7.438895e-02 1 1  ON 13
 ud_4                -1.216538e-01 1 1  ON 14
 ud_5                -1.534359e-01 1 1  ON 15
 ud_6                -1.562588e-01 1 1  ON 16
 ud_7                -1.121236e-01 1 1  ON 17
 ud_8                 4.819377e-04 1 1  ON 18
 ud_9                 9.256707e-02 1 1  ON 19
 eO_0                -7.658331e-01 1 1  ON 20
 eO_1                -4.483902e-01 1 1  ON 21
 eO_2                -4.416888e-02 1 1  ON 22
 eO_3                 2.080098e-01 1 1  ON 23
 eO_4                 3.018008e-01 1 1  ON 24
 eO_5                 3.162563e-01 1 1  ON 25
 eO_6                 2.558454e-01 1 1  ON 26
 eO_7                 1.181304e-01 1 1  ON 27
 eO_8                 2.889630e-02 1 1  ON 28
 eO_9                 1.867987e-02 1 1  ON 29
eH1_0                -1.823898e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301847e-02 1 1  ON 32
eH1_3                -2.641620e-02 1 1  ON 33
eH1_4                 1.893957e-02 1 1  ON 34
eH1_5                 3.340021e-02 1 1  ON 35
eH1_6                 7.790894e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408748e-02 1 1  ON 38
eH1_9                 2.537945e-02 1 1  ON 39
eH2_0                -1.842271e-01 1 1  ON 40
eH2_1                -1.051417e-01 1 1  ON 41
eH2_2                -6.443389e-02 1 1  ON 42
eH2_3                -2.763396e-02 1 1  ON 43
eH2_4                 1.795709e-02 1 1  ON 44
eH2_5                 3.308759e-02 1 1  ON 45
eH2_6                 7.960924e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678403e-02 1 1  ON 48
eH2_9                 2.747078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2234
    reference variance = 0.303949
====================================================
  Execution time = 2.0139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2119e-01
  Total weights = 2.0000e+06
  Execution time = 1.8301e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225924533
                                         uncertainty =       0.004011068113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225924533
                                         uncertainty =       0.004011068113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400740625
  error estimate for blocks of size 2^( 2) =       0.000410352304
  error estimate for blocks of size 2^( 3) =       0.000419117113
  error estimate for blocks of size 2^( 4) =       0.000425128940
  error estimate for blocks of size 2^( 5) =       0.000429333896
  error estimate for blocks of size 2^( 6) =       0.000431825025
  error estimate for blocks of size 2^( 7) =       0.000432940938

      target function =                  N/A
              le_mean =     -17.216692227351
             les_mean =     296.735677187488
             stat err =       0.000429807200
             autocorr =       1.150325189534
              std dev =       0.566732826614
             le_variance =       0.321186096762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225466982
                                         uncertainty =       0.004011058729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225466982
                                         uncertainty =       0.004011058729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400740340
  error estimate for blocks of size 2^( 2) =       0.000410352024
  error estimate for blocks of size 2^( 3) =       0.000419116829
  error estimate for blocks of size 2^( 4) =       0.000425128644
  error estimate for blocks of size 2^( 5) =       0.000429333606
  error estimate for blocks of size 2^( 6) =       0.000431824709
  error estimate for blocks of size 2^( 7) =       0.000432940595

      target function =                  N/A
              le_mean =     -17.216692222068
             les_mean =     296.735676548611
             stat err =       0.000429806889
             autocorr =       1.150325162402
              std dev =       0.566732423441
             le_variance =       0.321185639779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225692749
                                         uncertainty =       0.004011063385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225692749
                                         uncertainty =       0.004011063385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400740480
  error estimate for blocks of size 2^( 2) =       0.000410352162
  error estimate for blocks of size 2^( 3) =       0.000419116969
  error estimate for blocks of size 2^( 4) =       0.000425128790
  error estimate for blocks of size 2^( 5) =       0.000429333749
  error estimate for blocks of size 2^( 6) =       0.000431824865
  error estimate for blocks of size 2^( 7) =       0.000432940765

      target function =                  N/A
              le_mean =     -17.216692224687
             les_mean =     296.735676864280
             stat err =       0.000429807042
             autocorr =       1.150325177707
              std dev =       0.566732622374
             le_variance =       0.321185865263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225895462
                                         uncertainty =       0.004011067521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321225895462
                                         uncertainty =       0.004011067521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400740607
  error estimate for blocks of size 2^( 2) =       0.000410352286
  error estimate for blocks of size 2^( 3) =       0.000419117095
  error estimate for blocks of size 2^( 4) =       0.000425128921
  error estimate for blocks of size 2^( 5) =       0.000429333877
  error estimate for blocks of size 2^( 6) =       0.000431825005
  error estimate for blocks of size 2^( 7) =       0.000432940917

      target function =                  N/A
              le_mean =     -17.216692227017
             les_mean =     296.735677146951
             stat err =       0.000429807180
             autocorr =       1.150325188112
              std dev =       0.566732800998
             le_variance =       0.321186067727


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216692227351        initial  <--
     9.0949e+01     9.0949e+02             6.5705e-06       -17.216692222068
     3.6380e+02     3.6380e+03             1.6440e-06       -17.216692224687
     1.4552e+03     1.4552e+04             4.1108e-07       -17.216692227017

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3667
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.104690e-01 1 1  ON 0
 uu_1                 4.892046e-02 1 1  ON 1
 uu_2                -4.507146e-02 1 1  ON 2
 uu_3                -9.921772e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321743e-02 1 1  ON 7
 uu_8                 9.731954e-02 1 1  ON 8
 uu_9                 1.235535e-01 1 1  ON 9
 ud_0                 3.511331e-01 1 1  ON 10
 ud_1                 9.355869e-02 1 1  ON 11
 ud_2                -1.454360e-02 1 1  ON 12
 ud_3                -7.438868e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562589e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821938e-04 1 1  ON 18
 ud_9                 9.256703e-02 1 1  ON 19
 eO_0                -7.658315e-01 1 1  ON 20
 eO_1                -4.483894e-01 1 1  ON 21
 eO_2                -4.416849e-02 1 1  ON 22
 eO_3                 2.080091e-01 1 1  ON 23
 eO_4                 3.018000e-01 1 1  ON 24
 eO_5                 3.162559e-01 1 1  ON 25
 eO_6                 2.558450e-01 1 1  ON 26
 eO_7                 1.181300e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301833e-02 1 1  ON 32
eH1_3                -2.641643e-02 1 1  ON 33
eH1_4                 1.893977e-02 1 1  ON 34
eH1_5                 3.340016e-02 1 1  ON 35
eH1_6                 7.790899e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408729e-02 1 1  ON 38
eH1_9                 2.537940e-02 1 1  ON 39
eH2_0                -1.842271e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763379e-02 1 1  ON 43
eH2_4                 1.795687e-02 1 1  ON 44
eH2_5                 3.308769e-02 1 1  ON 45
eH2_6                 7.960932e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678388e-02 1 1  ON 48
eH2_9                 2.747072e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7075e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.158863
====================================================
  Execution time = 2.0066e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317051078276
                                         uncertainty =       0.003222239434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317051078276
                                         uncertainty =       0.003222239434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398167627
  error estimate for blocks of size 2^( 2) =       0.000408315088
  error estimate for blocks of size 2^( 3) =       0.000416878846
  error estimate for blocks of size 2^( 4) =       0.000423242570
  error estimate for blocks of size 2^( 5) =       0.000428289281
  error estimate for blocks of size 2^( 6) =       0.000430164580
  error estimate for blocks of size 2^( 7) =       0.000431966865

      target function =                  N/A
              le_mean =     -17.216235158530
             les_mean =     296.715827793350
             stat err =       0.000428415824
             autocorr =       1.157708212895
              std dev =       0.563094057930
             le_variance =       0.317074918076


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721623515853e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216235158530       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216235158457       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216235158595       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216235159315       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216235159564       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216235159513       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216235159408       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+02 is 6.486777e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216235158530       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216235158512       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216235158547       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216235158727       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216235158787       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216235158780       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216235158749       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+03 is 1.621763e-07

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216235158530       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216235158526       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216235158534       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216235158583       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216235158598       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216235158579       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216235158586       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 4.054451e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.105746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5563e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.104691e-01 1 1  ON 0
 uu_1                 4.892049e-02 1 1  ON 1
 uu_2                -4.507144e-02 1 1  ON 2
 uu_3                -9.921777e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321744e-02 1 1  ON 7
 uu_8                 9.731952e-02 1 1  ON 8
 uu_9                 1.235536e-01 1 1  ON 9
 ud_0                 3.511331e-01 1 1  ON 10
 ud_1                 9.355873e-02 1 1  ON 11
 ud_2                -1.454362e-02 1 1  ON 12
 ud_3                -7.438870e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534353e-01 1 1  ON 15
 ud_6                -1.562589e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821601e-04 1 1  ON 18
 ud_9                 9.256703e-02 1 1  ON 19
 eO_0                -7.658316e-01 1 1  ON 20
 eO_1                -4.483895e-01 1 1  ON 21
 eO_2                -4.416850e-02 1 1  ON 22
 eO_3                 2.080092e-01 1 1  ON 23
 eO_4                 3.018000e-01 1 1  ON 24
 eO_5                 3.162559e-01 1 1  ON 25
 eO_6                 2.558451e-01 1 1  ON 26
 eO_7                 1.181301e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301834e-02 1 1  ON 32
eH1_3                -2.641644e-02 1 1  ON 33
eH1_4                 1.893978e-02 1 1  ON 34
eH1_5                 3.340016e-02 1 1  ON 35
eH1_6                 7.790901e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408731e-02 1 1  ON 38
eH1_9                 2.537940e-02 1 1  ON 39
eH2_0                -1.842272e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763378e-02 1 1  ON 43
eH2_4                 1.795689e-02 1 1  ON 44
eH2_5                 3.308768e-02 1 1  ON 45
eH2_6                 7.960931e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678390e-02 1 1  ON 48
eH2_9                 2.747073e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1612
    reference variance = 0.594698
====================================================
  Execution time = 1.9855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1889e-01
  Total weights = 2.0000e+06
  Execution time = 1.8246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568455843
                                         uncertainty =       0.005689062047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568455843
                                         uncertainty =       0.005689062047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399306134
  error estimate for blocks of size 2^( 2) =       0.000409081991
  error estimate for blocks of size 2^( 3) =       0.000417276901
  error estimate for blocks of size 2^( 4) =       0.000423907819
  error estimate for blocks of size 2^( 5) =       0.000427420698
  error estimate for blocks of size 2^( 6) =       0.000429489525
  error estimate for blocks of size 2^( 7) =       0.000430966521

      target function =                  N/A
              le_mean =     -17.216180729531
             les_mean =     296.715769528995
             stat err =       0.000427946141
             autocorr =       1.148593267437
              std dev =       0.564704149578
             le_variance =       0.318890776550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568574279
                                         uncertainty =       0.005689066613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568574279
                                         uncertainty =       0.005689066613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399306208
  error estimate for blocks of size 2^( 2) =       0.000409082061
  error estimate for blocks of size 2^( 3) =       0.000417276965
  error estimate for blocks of size 2^( 4) =       0.000423907878
  error estimate for blocks of size 2^( 5) =       0.000427420756
  error estimate for blocks of size 2^( 6) =       0.000429489578
  error estimate for blocks of size 2^( 7) =       0.000430966576

      target function =                  N/A
              le_mean =     -17.216180729103
             les_mean =     296.715769632803
             stat err =       0.000427946197
             autocorr =       1.148593140079
              std dev =       0.564704254549
             le_variance =       0.318890895106

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568515054
                                         uncertainty =       0.005689064330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568515054
                                         uncertainty =       0.005689064330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399306171
  error estimate for blocks of size 2^( 2) =       0.000409082026
  error estimate for blocks of size 2^( 3) =       0.000417276933
  error estimate for blocks of size 2^( 4) =       0.000423907848
  error estimate for blocks of size 2^( 5) =       0.000427420727
  error estimate for blocks of size 2^( 6) =       0.000429489552
  error estimate for blocks of size 2^( 7) =       0.000430966548

      target function =                  N/A
              le_mean =     -17.216180729317
             les_mean =     296.715769580886
             stat err =       0.000427946169
             autocorr =       1.148593203749
              std dev =       0.564704202057
             le_variance =       0.318890835821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568463244
                                         uncertainty =       0.005689062332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318568463244
                                         uncertainty =       0.005689062332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399306138
  error estimate for blocks of size 2^( 2) =       0.000409081995
  error estimate for blocks of size 2^( 3) =       0.000417276905
  error estimate for blocks of size 2^( 4) =       0.000423907823
  error estimate for blocks of size 2^( 5) =       0.000427420701
  error estimate for blocks of size 2^( 6) =       0.000429489529
  error estimate for blocks of size 2^( 7) =       0.000430966525

      target function =                  N/A
              le_mean =     -17.216180729505
             les_mean =     296.715769535480
             stat err =       0.000427946144
             autocorr =       1.148593259469
              std dev =       0.564704156137
             le_variance =       0.318890783959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216180729531        initial  <--
     9.0949e+02     9.0949e+03             6.4868e-07       -17.216180729103
     3.6380e+03     3.6380e+04             1.6218e-07       -17.216180729317
     1.4552e+04     1.4552e+05             4.0545e-08       -17.216180729505

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0544
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.104690e-01 1 1  ON 0
 uu_1                 4.892046e-02 1 1  ON 1
 uu_2                -4.507146e-02 1 1  ON 2
 uu_3                -9.921772e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321743e-02 1 1  ON 7
 uu_8                 9.731954e-02 1 1  ON 8
 uu_9                 1.235535e-01 1 1  ON 9
 ud_0                 3.511331e-01 1 1  ON 10
 ud_1                 9.355869e-02 1 1  ON 11
 ud_2                -1.454360e-02 1 1  ON 12
 ud_3                -7.438868e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562589e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821938e-04 1 1  ON 18
 ud_9                 9.256703e-02 1 1  ON 19
 eO_0                -7.658315e-01 1 1  ON 20
 eO_1                -4.483894e-01 1 1  ON 21
 eO_2                -4.416849e-02 1 1  ON 22
 eO_3                 2.080091e-01 1 1  ON 23
 eO_4                 3.018000e-01 1 1  ON 24
 eO_5                 3.162559e-01 1 1  ON 25
 eO_6                 2.558450e-01 1 1  ON 26
 eO_7                 1.181300e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301833e-02 1 1  ON 32
eH1_3                -2.641643e-02 1 1  ON 33
eH1_4                 1.893977e-02 1 1  ON 34
eH1_5                 3.340016e-02 1 1  ON 35
eH1_6                 7.790899e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408729e-02 1 1  ON 38
eH1_9                 2.537940e-02 1 1  ON 39
eH2_0                -1.842271e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763379e-02 1 1  ON 43
eH2_4                 1.795687e-02 1 1  ON 44
eH2_5                 3.308769e-02 1 1  ON 45
eH2_6                 7.960932e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678388e-02 1 1  ON 48
eH2_9                 2.747072e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.3035
    reference variance = 0.165614
====================================================
  Execution time = 2.0287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1524e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315247203842
                                         uncertainty =       0.002775849668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315247203842
                                         uncertainty =       0.002775849668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397013425
  error estimate for blocks of size 2^( 2) =       0.000406719361
  error estimate for blocks of size 2^( 3) =       0.000414826821
  error estimate for blocks of size 2^( 4) =       0.000421574621
  error estimate for blocks of size 2^( 5) =       0.000425866870
  error estimate for blocks of size 2^( 6) =       0.000426654045
  error estimate for blocks of size 2^( 7) =       0.000428761514

      target function =                  N/A
              le_mean =     -17.216755600898
             les_mean =     296.731912582979
             stat err =       0.000425714262
             autocorr =       1.149809823837
              std dev =       0.561461770319
             le_variance =       0.315239319530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675560090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755600898       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755600971       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755601020       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755601045       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216755601094       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216755601115       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216755601104       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 5.389003e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755600898       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755600917       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755600929       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755600934       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216755600943       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216755600940       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216755600948       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.347256e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755600898       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755600903       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755600906       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755600908       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216755600913       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216755600887       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216755600881       residual = 9.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 3.368144e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107988 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5959e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.104690e-01 1 1  ON 0
 uu_1                 4.892046e-02 1 1  ON 1
 uu_2                -4.507145e-02 1 1  ON 2
 uu_3                -9.921773e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321743e-02 1 1  ON 7
 uu_8                 9.731954e-02 1 1  ON 8
 uu_9                 1.235535e-01 1 1  ON 9
 ud_0                 3.511331e-01 1 1  ON 10
 ud_1                 9.355869e-02 1 1  ON 11
 ud_2                -1.454361e-02 1 1  ON 12
 ud_3                -7.438868e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562589e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821906e-04 1 1  ON 18
 ud_9                 9.256703e-02 1 1  ON 19
 eO_0                -7.658315e-01 1 1  ON 20
 eO_1                -4.483895e-01 1 1  ON 21
 eO_2                -4.416849e-02 1 1  ON 22
 eO_3                 2.080091e-01 1 1  ON 23
 eO_4                 3.018000e-01 1 1  ON 24
 eO_5                 3.162559e-01 1 1  ON 25
 eO_6                 2.558450e-01 1 1  ON 26
 eO_7                 1.181300e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301833e-02 1 1  ON 32
eH1_3                -2.641643e-02 1 1  ON 33
eH1_4                 1.893977e-02 1 1  ON 34
eH1_5                 3.340016e-02 1 1  ON 35
eH1_6                 7.790899e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408729e-02 1 1  ON 38
eH1_9                 2.537940e-02 1 1  ON 39
eH2_0                -1.842271e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763379e-02 1 1  ON 43
eH2_4                 1.795687e-02 1 1  ON 44
eH2_5                 3.308769e-02 1 1  ON 45
eH2_6                 7.960932e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678388e-02 1 1  ON 48
eH2_9                 2.747072e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1719
    reference variance = 0.314804
====================================================
  Execution time = 2.1772e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1150e-01
  Total weights = 2.0000e+06
  Execution time = 1.8210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411908707
                                         uncertainty =       0.002555596666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411908707
                                         uncertainty =       0.002555596666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394654885
  error estimate for blocks of size 2^( 2) =       0.000404804117
  error estimate for blocks of size 2^( 3) =       0.000414127843
  error estimate for blocks of size 2^( 4) =       0.000420913996
  error estimate for blocks of size 2^( 5) =       0.000424178627
  error estimate for blocks of size 2^( 6) =       0.000426784384
  error estimate for blocks of size 2^( 7) =       0.000428752587

      target function =                  N/A
              le_mean =     -17.216384970535
             les_mean =     296.715416254560
             stat err =       0.000425157398
             autocorr =       1.160551763705
              std dev =       0.558126290940
             le_variance =       0.311504956639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411928746
                                         uncertainty =       0.002555596785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411928746
                                         uncertainty =       0.002555596785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394654898
  error estimate for blocks of size 2^( 2) =       0.000404804129
  error estimate for blocks of size 2^( 3) =       0.000414127854
  error estimate for blocks of size 2^( 4) =       0.000420914007
  error estimate for blocks of size 2^( 5) =       0.000424178637
  error estimate for blocks of size 2^( 6) =       0.000426784394
  error estimate for blocks of size 2^( 7) =       0.000428752597

      target function =                  N/A
              le_mean =     -17.216384970590
             les_mean =     296.715416276499
             stat err =       0.000425157409
             autocorr =       1.160551746000
              std dev =       0.558126308892
             le_variance =       0.311504976677

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411918726
                                         uncertainty =       0.002555596726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411918726
                                         uncertainty =       0.002555596726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394654891
  error estimate for blocks of size 2^( 2) =       0.000404804123
  error estimate for blocks of size 2^( 3) =       0.000414127848
  error estimate for blocks of size 2^( 4) =       0.000420914001
  error estimate for blocks of size 2^( 5) =       0.000424178632
  error estimate for blocks of size 2^( 6) =       0.000426784389
  error estimate for blocks of size 2^( 7) =       0.000428752592

      target function =                  N/A
              le_mean =     -17.216384970563
             les_mean =     296.715416265529
             stat err =       0.000425157404
             autocorr =       1.160551754854
              std dev =       0.558126299916
             le_variance =       0.311504966658

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411909959
                                         uncertainty =       0.002555596674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311411909959
                                         uncertainty =       0.002555596674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394654886
  error estimate for blocks of size 2^( 2) =       0.000404804118
  error estimate for blocks of size 2^( 3) =       0.000414127843
  error estimate for blocks of size 2^( 4) =       0.000420913997
  error estimate for blocks of size 2^( 5) =       0.000424178628
  error estimate for blocks of size 2^( 6) =       0.000426784384
  error estimate for blocks of size 2^( 7) =       0.000428752587

      target function =                  N/A
              le_mean =     -17.216384970539
             les_mean =     296.715416255931
             stat err =       0.000425157399
             autocorr =       1.160551762604
              std dev =       0.558126292062
             le_variance =       0.311504957891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216384970535        initial
     9.0949e+03     9.0949e+04             5.3890e-08       -17.216384970590  <--
     3.6380e+04     3.6380e+05             1.3473e-08       -17.216384970563
     1.4552e+05     1.4552e+06             3.3681e-09       -17.216384970539

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 3.1143e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.104690e-01 1 1  ON 0
 uu_1                 4.892047e-02 1 1  ON 1
 uu_2                -4.507144e-02 1 1  ON 2
 uu_3                -9.921773e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321744e-02 1 1  ON 7
 uu_8                 9.731953e-02 1 1  ON 8
 uu_9                 1.235535e-01 1 1  ON 9
 ud_0                 3.511331e-01 1 1  ON 10
 ud_1                 9.355870e-02 1 1  ON 11
 ud_2                -1.454362e-02 1 1  ON 12
 ud_3                -7.438869e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562589e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821812e-04 1 1  ON 18
 ud_9                 9.256703e-02 1 1  ON 19
 eO_0                -7.658315e-01 1 1  ON 20
 eO_1                -4.483895e-01 1 1  ON 21
 eO_2                -4.416850e-02 1 1  ON 22
 eO_3                 2.080091e-01 1 1  ON 23
 eO_4                 3.018000e-01 1 1  ON 24
 eO_5                 3.162559e-01 1 1  ON 25
 eO_6                 2.558450e-01 1 1  ON 26
 eO_7                 1.181301e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301833e-02 1 1  ON 32
eH1_3                -2.641642e-02 1 1  ON 33
eH1_4                 1.893977e-02 1 1  ON 34
eH1_5                 3.340015e-02 1 1  ON 35
eH1_6                 7.790898e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408730e-02 1 1  ON 38
eH1_9                 2.537940e-02 1 1  ON 39
eH2_0                -1.842271e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763379e-02 1 1  ON 43
eH2_4                 1.795688e-02 1 1  ON 44
eH2_5                 3.308769e-02 1 1  ON 45
eH2_6                 7.960931e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678389e-02 1 1  ON 48
eH2_9                 2.747073e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7107e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2653
    reference variance = 0.238797
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1615e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316206038646
                                         uncertainty =       0.003047385132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316206038646
                                         uncertainty =       0.003047385132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397584111
  error estimate for blocks of size 2^( 2) =       0.000407457415
  error estimate for blocks of size 2^( 3) =       0.000416255577
  error estimate for blocks of size 2^( 4) =       0.000423042862
  error estimate for blocks of size 2^( 5) =       0.000427649308
  error estimate for blocks of size 2^( 6) =       0.000428975289
  error estimate for blocks of size 2^( 7) =       0.000430208508

      target function =                  N/A
              le_mean =     -17.216396346837
             les_mean =     296.720449264704
             stat err =       0.000427468992
             autocorr =       1.155982322966
              std dev =       0.562268842624
             le_variance =       0.316146251386


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639634684e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396346837       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396346812       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396347124       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396347527       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396347706       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396347574       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396347550       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.936957e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396346837       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396346831       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396346909       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396347009       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396347054       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396347010       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396347007       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 4.842657e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396346837       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396346836       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396346855       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396346886       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396346883       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396346886       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396346883       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.210681e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110239 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5816e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.104691e-01 1 1  ON 0
 uu_1                 4.892047e-02 1 1  ON 1
 uu_2                -4.507144e-02 1 1  ON 2
 uu_3                -9.921774e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164217e-01 1 1  ON 6
 uu_7                -4.321745e-02 1 1  ON 7
 uu_8                 9.731952e-02 1 1  ON 8
 uu_9                 1.235535e-01 1 1  ON 9
 ud_0                 3.511331e-01 1 1  ON 10
 ud_1                 9.355871e-02 1 1  ON 11
 ud_2                -1.454362e-02 1 1  ON 12
 ud_3                -7.438869e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562589e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821670e-04 1 1  ON 18
 ud_9                 9.256702e-02 1 1  ON 19
 eO_0                -7.658316e-01 1 1  ON 20
 eO_1                -4.483895e-01 1 1  ON 21
 eO_2                -4.416851e-02 1 1  ON 22
 eO_3                 2.080091e-01 1 1  ON 23
 eO_4                 3.018000e-01 1 1  ON 24
 eO_5                 3.162559e-01 1 1  ON 25
 eO_6                 2.558451e-01 1 1  ON 26
 eO_7                 1.181301e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301833e-02 1 1  ON 32
eH1_3                -2.641642e-02 1 1  ON 33
eH1_4                 1.893977e-02 1 1  ON 34
eH1_5                 3.340015e-02 1 1  ON 35
eH1_6                 7.790898e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408730e-02 1 1  ON 38
eH1_9                 2.537940e-02 1 1  ON 39
eH2_0                -1.842272e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763379e-02 1 1  ON 43
eH2_4                 1.795688e-02 1 1  ON 44
eH2_5                 3.308769e-02 1 1  ON 45
eH2_6                 7.960931e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678389e-02 1 1  ON 48
eH2_9                 2.747073e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2173
    reference variance = 0.226806
====================================================
  Execution time = 1.9770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1307e-01
  Total weights = 2.0000e+06
  Execution time = 1.8610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123430292
                                         uncertainty =       0.002863062899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123430292
                                         uncertainty =       0.002863062899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395645259
  error estimate for blocks of size 2^( 2) =       0.000405186715
  error estimate for blocks of size 2^( 3) =       0.000413781515
  error estimate for blocks of size 2^( 4) =       0.000420371261
  error estimate for blocks of size 2^( 5) =       0.000424203254
  error estimate for blocks of size 2^( 6) =       0.000426791633
  error estimate for blocks of size 2^( 7) =       0.000428254465

      target function =                  N/A
              le_mean =     -17.216465139439
             les_mean =     296.719742083463
             stat err =       0.000424905153
             autocorr =       1.153379064463
              std dev =       0.559526891664
             le_variance =       0.313070342496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123527422
                                         uncertainty =       0.002863063969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123527422
                                         uncertainty =       0.002863063969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395645321
  error estimate for blocks of size 2^( 2) =       0.000405186772
  error estimate for blocks of size 2^( 3) =       0.000413781570
  error estimate for blocks of size 2^( 4) =       0.000420371313
  error estimate for blocks of size 2^( 5) =       0.000424203305
  error estimate for blocks of size 2^( 6) =       0.000426791685
  error estimate for blocks of size 2^( 7) =       0.000428254517

      target function =                  N/A
              le_mean =     -17.216465139918
             les_mean =     296.719742197107
             stat err =       0.000424905205
             autocorr =       1.153378986317
              std dev =       0.559526978464
             le_variance =       0.313070439629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123478861
                                         uncertainty =       0.002863063434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123478861
                                         uncertainty =       0.002863063434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395645290
  error estimate for blocks of size 2^( 2) =       0.000405186743
  error estimate for blocks of size 2^( 3) =       0.000413781543
  error estimate for blocks of size 2^( 4) =       0.000420371287
  error estimate for blocks of size 2^( 5) =       0.000424203279
  error estimate for blocks of size 2^( 6) =       0.000426791659
  error estimate for blocks of size 2^( 7) =       0.000428254491

      target function =                  N/A
              le_mean =     -17.216465139678
             les_mean =     296.719742140290
             stat err =       0.000424905179
             autocorr =       1.153379025384
              std dev =       0.559526935068
             le_variance =       0.313070391067

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123436363
                                         uncertainty =       0.002863062966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313123436363
                                         uncertainty =       0.002863062966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395645263
  error estimate for blocks of size 2^( 2) =       0.000405186718
  error estimate for blocks of size 2^( 3) =       0.000413781519
  error estimate for blocks of size 2^( 4) =       0.000420371265
  error estimate for blocks of size 2^( 5) =       0.000424203257
  error estimate for blocks of size 2^( 6) =       0.000426791636
  error estimate for blocks of size 2^( 7) =       0.000428254468

      target function =                  N/A
              le_mean =     -17.216465139469
             les_mean =     296.719742090566
             stat err =       0.000424905157
             autocorr =       1.153379059573
              std dev =       0.559526897090
             le_variance =       0.313070348567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216465139439        initial
     2.2737e+03     2.2737e+04             1.9370e-07       -17.216465139918  <--
     9.0949e+03     9.0949e+04             4.8427e-08       -17.216465139678
     3.6380e+04     3.6380e+05             1.2107e-08       -17.216465139469

*****************************************************************************
Applying the update for shift_i =   2.2737e+03     and shift_s =   2.2737e+04
*****************************************************************************

  Execution time = 2.9187e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.104692e-01 1 1  ON 0
 uu_1                 4.892050e-02 1 1  ON 1
 uu_2                -4.507142e-02 1 1  ON 2
 uu_3                -9.921776e-02 1 1  ON 3
 uu_4                -1.323013e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164218e-01 1 1  ON 6
 uu_7                -4.321749e-02 1 1  ON 7
 uu_8                 9.731949e-02 1 1  ON 8
 uu_9                 1.235536e-01 1 1  ON 9
 ud_0                 3.511332e-01 1 1  ON 10
 ud_1                 9.355873e-02 1 1  ON 11
 ud_2                -1.454365e-02 1 1  ON 12
 ud_3                -7.438870e-02 1 1  ON 13
 ud_4                -1.216539e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562588e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.821244e-04 1 1  ON 18
 ud_9                 9.256702e-02 1 1  ON 19
 eO_0                -7.658317e-01 1 1  ON 20
 eO_1                -4.483897e-01 1 1  ON 21
 eO_2                -4.416853e-02 1 1  ON 22
 eO_3                 2.080092e-01 1 1  ON 23
 eO_4                 3.018001e-01 1 1  ON 24
 eO_5                 3.162560e-01 1 1  ON 25
 eO_6                 2.558451e-01 1 1  ON 26
 eO_7                 1.181301e-01 1 1  ON 27
 eO_8                 2.889623e-02 1 1  ON 28
 eO_9                 1.867983e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034063e-01 1 1  ON 31
eH1_2                -6.301832e-02 1 1  ON 32
eH1_3                -2.641642e-02 1 1  ON 33
eH1_4                 1.893976e-02 1 1  ON 34
eH1_5                 3.340013e-02 1 1  ON 35
eH1_6                 7.790897e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408733e-02 1 1  ON 38
eH1_9                 2.537941e-02 1 1  ON 39
eH2_0                -1.842272e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443384e-02 1 1  ON 42
eH2_3                -2.763378e-02 1 1  ON 43
eH2_4                 1.795690e-02 1 1  ON 44
eH2_5                 3.308770e-02 1 1  ON 45
eH2_6                 7.960929e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678391e-02 1 1  ON 48
eH2_9                 2.747073e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5008e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2657
    reference variance = 0.246972
====================================================
  Execution time = 2.0041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329618422372
                                         uncertainty =       0.016554595962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329618422372
                                         uncertainty =       0.016554595962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405933874
  error estimate for blocks of size 2^( 2) =       0.000415200632
  error estimate for blocks of size 2^( 3) =       0.000423495107
  error estimate for blocks of size 2^( 4) =       0.000429667245
  error estimate for blocks of size 2^( 5) =       0.000433710553
  error estimate for blocks of size 2^( 6) =       0.000435932654
  error estimate for blocks of size 2^( 7) =       0.000437557171

      target function =                  N/A
              le_mean =     -17.217584010917
             les_mean =     296.774763628307
             stat err =       0.000434216906
             autocorr =       1.144202439440
              std dev =       0.574077190014
             le_variance =       0.329564620094


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721758401092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217584010917       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217584012454       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217584012024       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217584013366       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217584013925       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217584013831       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217584013679       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 9.030916e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217584010917       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217584011302       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217584011194       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217584011529       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217584011669       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217584011648       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217584011608       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 2.257882e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217584010917       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217584011013       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217584010986       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217584011070       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217584011107       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217584011090       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217584011092       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 5.644800e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112512 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5882e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.104692e-01 1 1  ON 0
 uu_1                 4.892051e-02 1 1  ON 1
 uu_2                -4.507139e-02 1 1  ON 2
 uu_3                -9.921777e-02 1 1  ON 3
 uu_4                -1.323014e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164218e-01 1 1  ON 6
 uu_7                -4.321752e-02 1 1  ON 7
 uu_8                 9.731946e-02 1 1  ON 8
 uu_9                 1.235536e-01 1 1  ON 9
 ud_0                 3.511332e-01 1 1  ON 10
 ud_1                 9.355878e-02 1 1  ON 11
 ud_2                -1.454366e-02 1 1  ON 12
 ud_3                -7.438872e-02 1 1  ON 13
 ud_4                -1.216540e-01 1 1  ON 14
 ud_5                -1.534354e-01 1 1  ON 15
 ud_6                -1.562588e-01 1 1  ON 16
 ud_7                -1.121237e-01 1 1  ON 17
 ud_8                 4.820719e-04 1 1  ON 18
 ud_9                 9.256701e-02 1 1  ON 19
 eO_0                -7.658319e-01 1 1  ON 20
 eO_1                -4.483898e-01 1 1  ON 21
 eO_2                -4.416856e-02 1 1  ON 22
 eO_3                 2.080093e-01 1 1  ON 23
 eO_4                 3.018002e-01 1 1  ON 24
 eO_5                 3.162560e-01 1 1  ON 25
 eO_6                 2.558452e-01 1 1  ON 26
 eO_7                 1.181302e-01 1 1  ON 27
 eO_8                 2.889624e-02 1 1  ON 28
 eO_9                 1.867984e-02 1 1  ON 29
eH1_0                -1.823896e-01 1 1  ON 30
eH1_1                -1.034064e-01 1 1  ON 31
eH1_2                -6.301834e-02 1 1  ON 32
eH1_3                -2.641641e-02 1 1  ON 33
eH1_4                 1.893981e-02 1 1  ON 34
eH1_5                 3.340011e-02 1 1  ON 35
eH1_6                 7.790897e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408736e-02 1 1  ON 38
eH1_9                 2.537942e-02 1 1  ON 39
eH2_0                -1.842272e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443386e-02 1 1  ON 42
eH2_3                -2.763380e-02 1 1  ON 43
eH2_4                 1.795693e-02 1 1  ON 44
eH2_5                 3.308772e-02 1 1  ON 45
eH2_6                 7.960928e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678394e-02 1 1  ON 48
eH2_9                 2.747074e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2489
    reference variance = 0.25728
====================================================
  Execution time = 1.9750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2433e-01
  Total weights = 2.0000e+06
  Execution time = 1.8479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291464776
                                         uncertainty =       0.005237054958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291464776
                                         uncertainty =       0.005237054958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402700135
  error estimate for blocks of size 2^( 2) =       0.000412424478
  error estimate for blocks of size 2^( 3) =       0.000420838063
  error estimate for blocks of size 2^( 4) =       0.000427853184
  error estimate for blocks of size 2^( 5) =       0.000431656432
  error estimate for blocks of size 2^( 6) =       0.000433895969
  error estimate for blocks of size 2^( 7) =       0.000436319105

      target function =                  N/A
              le_mean =     -17.216480099844
             les_mean =     296.731521663378
             stat err =       0.000432431172
             autocorr =       1.153109197814
              std dev =       0.569503992264
             le_variance =       0.324334797204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291757703
                                         uncertainty =       0.005237060073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291757703
                                         uncertainty =       0.005237060073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402700317
  error estimate for blocks of size 2^( 2) =       0.000412424649
  error estimate for blocks of size 2^( 3) =       0.000420838222
  error estimate for blocks of size 2^( 4) =       0.000427853336
  error estimate for blocks of size 2^( 5) =       0.000431656585
  error estimate for blocks of size 2^( 6) =       0.000433896115
  error estimate for blocks of size 2^( 7) =       0.000436319252

      target function =                  N/A
              le_mean =     -17.216480100583
             les_mean =     296.731521981847
             stat err =       0.000432431322
             autocorr =       1.153108953987
              std dev =       0.569504249530
             le_variance =       0.324335090233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291611258
                                         uncertainty =       0.005237057516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291611258
                                         uncertainty =       0.005237057516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402700226
  error estimate for blocks of size 2^( 2) =       0.000412424564
  error estimate for blocks of size 2^( 3) =       0.000420838142
  error estimate for blocks of size 2^( 4) =       0.000427853260
  error estimate for blocks of size 2^( 5) =       0.000431656508
  error estimate for blocks of size 2^( 6) =       0.000433896042
  error estimate for blocks of size 2^( 7) =       0.000436319179

      target function =                  N/A
              le_mean =     -17.216480100214
             les_mean =     296.731521822636
             stat err =       0.000432431247
             autocorr =       1.153109075879
              std dev =       0.569504120913
             le_variance =       0.324334943737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291483087
                                         uncertainty =       0.005237055278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324291483087
                                         uncertainty =       0.005237055278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402700146
  error estimate for blocks of size 2^( 2) =       0.000412424489
  error estimate for blocks of size 2^( 3) =       0.000420838073
  error estimate for blocks of size 2^( 4) =       0.000427853193
  error estimate for blocks of size 2^( 5) =       0.000431656441
  error estimate for blocks of size 2^( 6) =       0.000433895978
  error estimate for blocks of size 2^( 7) =       0.000436319114

      target function =                  N/A
              le_mean =     -17.216480099891
             les_mean =     296.731521683286
             stat err =       0.000432431182
             autocorr =       1.153109182572
              std dev =       0.569504008345
             le_variance =       0.324334815521


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216480099844        initial
     5.6843e+02     5.6843e+03             9.0309e-07       -17.216480100583  <--
     2.2737e+03     2.2737e+04             2.2579e-07       -17.216480100214
     9.0949e+03     9.0949e+04             5.6448e-08       -17.216480099891

*****************************************************************************
Applying the update for shift_i =   5.6843e+02     and shift_s =   5.6843e+03
*****************************************************************************

  Execution time = 2.9098e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.104695e-01 1 1  ON 0
 uu_1                 4.892056e-02 1 1  ON 1
 uu_2                -4.507129e-02 1 1  ON 2
 uu_3                -9.921782e-02 1 1  ON 3
 uu_4                -1.323017e-01 1 1  ON 4
 uu_5                -1.393382e-01 1 1  ON 5
 uu_6                -1.164219e-01 1 1  ON 6
 uu_7                -4.321761e-02 1 1  ON 7
 uu_8                 9.731937e-02 1 1  ON 8
 uu_9                 1.235537e-01 1 1  ON 9
 ud_0                 3.511334e-01 1 1  ON 10
 ud_1                 9.355893e-02 1 1  ON 11
 ud_2                -1.454371e-02 1 1  ON 12
 ud_3                -7.438879e-02 1 1  ON 13
 ud_4                -1.216541e-01 1 1  ON 14
 ud_5                -1.534355e-01 1 1  ON 15
 ud_6                -1.562587e-01 1 1  ON 16
 ud_7                -1.121238e-01 1 1  ON 17
 ud_8                 4.819145e-04 1 1  ON 18
 ud_9                 9.256699e-02 1 1  ON 19
 eO_0                -7.658326e-01 1 1  ON 20
 eO_1                -4.483902e-01 1 1  ON 21
 eO_2                -4.416865e-02 1 1  ON 22
 eO_3                 2.080095e-01 1 1  ON 23
 eO_4                 3.018005e-01 1 1  ON 24
 eO_5                 3.162563e-01 1 1  ON 25
 eO_6                 2.558453e-01 1 1  ON 26
 eO_7                 1.181303e-01 1 1  ON 27
 eO_8                 2.889626e-02 1 1  ON 28
 eO_9                 1.867985e-02 1 1  ON 29
eH1_0                -1.823897e-01 1 1  ON 30
eH1_1                -1.034064e-01 1 1  ON 31
eH1_2                -6.301839e-02 1 1  ON 32
eH1_3                -2.641639e-02 1 1  ON 33
eH1_4                 1.893997e-02 1 1  ON 34
eH1_5                 3.340005e-02 1 1  ON 35
eH1_6                 7.790898e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408745e-02 1 1  ON 38
eH1_9                 2.537944e-02 1 1  ON 39
eH2_0                -1.842273e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443389e-02 1 1  ON 42
eH2_3                -2.763385e-02 1 1  ON 43
eH2_4                 1.795701e-02 1 1  ON 44
eH2_5                 3.308777e-02 1 1  ON 45
eH2_6                 7.960926e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678402e-02 1 1  ON 48
eH2_9                 2.747077e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4986e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1673
    reference variance = 0.192303
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849243653
                                         uncertainty =       0.004560253747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849243653
                                         uncertainty =       0.004560253747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398599939
  error estimate for blocks of size 2^( 2) =       0.000408351505
  error estimate for blocks of size 2^( 3) =       0.000417023265
  error estimate for blocks of size 2^( 4) =       0.000423877951
  error estimate for blocks of size 2^( 5) =       0.000428200837
  error estimate for blocks of size 2^( 6) =       0.000431035079
  error estimate for blocks of size 2^( 7) =       0.000432578994

      target function =                  N/A
              le_mean =     -17.216396239560
             les_mean =     296.722063141689
             stat err =       0.000428923215
             autocorr =       1.157936249551
              std dev =       0.563705439962
             le_variance =       0.317763823043


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639623956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396239560       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396239934       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396240433       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396246290       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396247670       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396248610       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396247983       residual = 6.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+02 is 3.751131e-06

solving harmonic davidson linear method for identity shift 5.6843e+02, overlap shift 5.6843e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396239560       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396239653       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396239778       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396241242       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396241584       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396241820       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396241665       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+02 is 9.379203e-07

solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396239560       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396239583       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396239614       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396239980       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396240066       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396240128       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396240087       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 2.344887e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114779 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5650e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.104698e-01 1 1  ON 0
 uu_1                 4.892081e-02 1 1  ON 1
 uu_2                -4.507110e-02 1 1  ON 2
 uu_3                -9.921802e-02 1 1  ON 3
 uu_4                -1.323018e-01 1 1  ON 4
 uu_5                -1.393383e-01 1 1  ON 5
 uu_6                -1.164221e-01 1 1  ON 6
 uu_7                -4.321789e-02 1 1  ON 7
 uu_8                 9.731920e-02 1 1  ON 8
 uu_9                 1.235537e-01 1 1  ON 9
 ud_0                 3.511337e-01 1 1  ON 10
 ud_1                 9.355910e-02 1 1  ON 11
 ud_2                -1.454385e-02 1 1  ON 12
 ud_3                -7.438891e-02 1 1  ON 13
 ud_4                -1.216542e-01 1 1  ON 14
 ud_5                -1.534355e-01 1 1  ON 15
 ud_6                -1.562586e-01 1 1  ON 16
 ud_7                -1.121238e-01 1 1  ON 17
 ud_8                 4.817043e-04 1 1  ON 18
 ud_9                 9.256698e-02 1 1  ON 19
 eO_0                -7.658335e-01 1 1  ON 20
 eO_1                -4.483909e-01 1 1  ON 21
 eO_2                -4.416869e-02 1 1  ON 22
 eO_3                 2.080101e-01 1 1  ON 23
 eO_4                 3.018010e-01 1 1  ON 24
 eO_5                 3.162565e-01 1 1  ON 25
 eO_6                 2.558455e-01 1 1  ON 26
 eO_7                 1.181305e-01 1 1  ON 27
 eO_8                 2.889629e-02 1 1  ON 28
 eO_9                 1.867986e-02 1 1  ON 29
eH1_0                -1.823897e-01 1 1  ON 30
eH1_1                -1.034065e-01 1 1  ON 31
eH1_2                -6.301835e-02 1 1  ON 32
eH1_3                -2.641634e-02 1 1  ON 33
eH1_4                 1.893996e-02 1 1  ON 34
eH1_5                 3.339993e-02 1 1  ON 35
eH1_6                 7.790897e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408757e-02 1 1  ON 38
eH1_9                 2.537949e-02 1 1  ON 39
eH2_0                -1.842274e-01 1 1  ON 40
eH2_1                -1.051417e-01 1 1  ON 41
eH2_2                -6.443377e-02 1 1  ON 42
eH2_3                -2.763382e-02 1 1  ON 43
eH2_4                 1.795701e-02 1 1  ON 44
eH2_5                 3.308773e-02 1 1  ON 45
eH2_6                 7.960915e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678414e-02 1 1  ON 48
eH2_9                 2.747082e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2591
    reference variance = 0.355351
====================================================
  Execution time = 2.1964e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1812e-01
  Total weights = 2.0000e+06
  Execution time = 1.8204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318186148173
                                         uncertainty =       0.004739407846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318186148173
                                         uncertainty =       0.004739407846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398820467
  error estimate for blocks of size 2^( 2) =       0.000408673349
  error estimate for blocks of size 2^( 3) =       0.000417632219
  error estimate for blocks of size 2^( 4) =       0.000423202776
  error estimate for blocks of size 2^( 5) =       0.000427270443
  error estimate for blocks of size 2^( 6) =       0.000428718112
  error estimate for blocks of size 2^( 7) =       0.000429635316

      target function =                  N/A
              le_mean =     -17.216541526397
             les_mean =     296.727417501100
             stat err =       0.000427206662
             autocorr =       1.147416675464
              std dev =       0.564017313562
             le_variance =       0.318115529998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318187354006
                                         uncertainty =       0.004739437105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318187354006
                                         uncertainty =       0.004739437105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398821223
  error estimate for blocks of size 2^( 2) =       0.000408674056
  error estimate for blocks of size 2^( 3) =       0.000417632872
  error estimate for blocks of size 2^( 4) =       0.000423203405
  error estimate for blocks of size 2^( 5) =       0.000427271058
  error estimate for blocks of size 2^( 6) =       0.000428718724
  error estimate for blocks of size 2^( 7) =       0.000429635953

      target function =                  N/A
              le_mean =     -17.216541522753
             les_mean =     296.727418580784
             stat err =       0.000427207285
             autocorr =       1.147415676187
              std dev =       0.564018381937
             le_variance =       0.318116735162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318186751290
                                         uncertainty =       0.004739422486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318186751290
                                         uncertainty =       0.004739422486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398820845
  error estimate for blocks of size 2^( 2) =       0.000408673703
  error estimate for blocks of size 2^( 3) =       0.000417632545
  error estimate for blocks of size 2^( 4) =       0.000423203090
  error estimate for blocks of size 2^( 5) =       0.000427270751
  error estimate for blocks of size 2^( 6) =       0.000428718418
  error estimate for blocks of size 2^( 7) =       0.000429635635

      target function =                  N/A
              le_mean =     -17.216541524567
             les_mean =     296.727418040880
             stat err =       0.000427206974
             autocorr =       1.147416175453
              std dev =       0.564017847927
             le_variance =       0.318116132781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318186223567
                                         uncertainty =       0.004739409676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318186223567
                                         uncertainty =       0.004739409676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398820514
  error estimate for blocks of size 2^( 2) =       0.000408673393
  error estimate for blocks of size 2^( 3) =       0.000417632259
  error estimate for blocks of size 2^( 4) =       0.000423202815
  error estimate for blocks of size 2^( 5) =       0.000427270482
  error estimate for blocks of size 2^( 6) =       0.000428718151
  error estimate for blocks of size 2^( 7) =       0.000429635356

      target function =                  N/A
              le_mean =     -17.216541526168
             les_mean =     296.727417568563
             stat err =       0.000427206701
             autocorr =       1.147416612958
              std dev =       0.564017380363
             le_variance =       0.318115605351


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216541526397        initial  <--
     1.4211e+02     1.4211e+03             3.7511e-06       -17.216541522753
     5.6843e+02     5.6843e+03             9.3792e-07       -17.216541524567
     2.2737e+03     2.2737e+04             2.3449e-07       -17.216541526168

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1760
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.104695e-01 1 1  ON 0
 uu_1                 4.892056e-02 1 1  ON 1
 uu_2                -4.507129e-02 1 1  ON 2
 uu_3                -9.921782e-02 1 1  ON 3
 uu_4                -1.323017e-01 1 1  ON 4
 uu_5                -1.393382e-01 1 1  ON 5
 uu_6                -1.164219e-01 1 1  ON 6
 uu_7                -4.321761e-02 1 1  ON 7
 uu_8                 9.731937e-02 1 1  ON 8
 uu_9                 1.235537e-01 1 1  ON 9
 ud_0                 3.511334e-01 1 1  ON 10
 ud_1                 9.355893e-02 1 1  ON 11
 ud_2                -1.454371e-02 1 1  ON 12
 ud_3                -7.438879e-02 1 1  ON 13
 ud_4                -1.216541e-01 1 1  ON 14
 ud_5                -1.534355e-01 1 1  ON 15
 ud_6                -1.562587e-01 1 1  ON 16
 ud_7                -1.121238e-01 1 1  ON 17
 ud_8                 4.819145e-04 1 1  ON 18
 ud_9                 9.256699e-02 1 1  ON 19
 eO_0                -7.658326e-01 1 1  ON 20
 eO_1                -4.483902e-01 1 1  ON 21
 eO_2                -4.416865e-02 1 1  ON 22
 eO_3                 2.080095e-01 1 1  ON 23
 eO_4                 3.018005e-01 1 1  ON 24
 eO_5                 3.162563e-01 1 1  ON 25
 eO_6                 2.558453e-01 1 1  ON 26
 eO_7                 1.181303e-01 1 1  ON 27
 eO_8                 2.889626e-02 1 1  ON 28
 eO_9                 1.867985e-02 1 1  ON 29
eH1_0                -1.823897e-01 1 1  ON 30
eH1_1                -1.034064e-01 1 1  ON 31
eH1_2                -6.301839e-02 1 1  ON 32
eH1_3                -2.641639e-02 1 1  ON 33
eH1_4                 1.893997e-02 1 1  ON 34
eH1_5                 3.340005e-02 1 1  ON 35
eH1_6                 7.790898e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408745e-02 1 1  ON 38
eH1_9                 2.537944e-02 1 1  ON 39
eH2_0                -1.842273e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443389e-02 1 1  ON 42
eH2_3                -2.763385e-02 1 1  ON 43
eH2_4                 1.795701e-02 1 1  ON 44
eH2_5                 3.308777e-02 1 1  ON 45
eH2_6                 7.960926e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678402e-02 1 1  ON 48
eH2_9                 2.747077e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6832e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2195
    reference variance = 0.209761
====================================================
  Execution time = 2.0093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907437558
                                         uncertainty =       0.010503262543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907437558
                                         uncertainty =       0.010503262543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406690634
  error estimate for blocks of size 2^( 2) =       0.000415981828
  error estimate for blocks of size 2^( 3) =       0.000425079980
  error estimate for blocks of size 2^( 4) =       0.000431092166
  error estimate for blocks of size 2^( 5) =       0.000436137716
  error estimate for blocks of size 2^( 6) =       0.000438287127
  error estimate for blocks of size 2^( 7) =       0.000439975435

      target function =                  N/A
              le_mean =     -17.216391280637
             les_mean =     296.734923105470
             stat err =       0.000436373111
             autocorr =       1.151297663560
              std dev =       0.575147409689
             le_variance =       0.330794542872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639128064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+03, overlap shift 1.4211e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391280637       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391280967       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391281132       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216391282040       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216391281660       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216391281697       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216391281746       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4211e+03 is 3.652421e-07

solving harmonic davidson linear method for identity shift 5.6843e+03, overlap shift 5.6843e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391280637       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391280719       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391280761       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216391280988       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216391280902       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216391280902       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216391280911       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+03 is 9.130882e-08

solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216391280637       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216391280658       residual = 5.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216391280668       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216391280722       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216391280697       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216391280707       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216391280712       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 2.282710e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5723e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.104695e-01 1 1  ON 0
 uu_1                 4.892059e-02 1 1  ON 1
 uu_2                -4.507127e-02 1 1  ON 2
 uu_3                -9.921782e-02 1 1  ON 3
 uu_4                -1.323018e-01 1 1  ON 4
 uu_5                -1.393382e-01 1 1  ON 5
 uu_6                -1.164219e-01 1 1  ON 6
 uu_7                -4.321763e-02 1 1  ON 7
 uu_8                 9.731935e-02 1 1  ON 8
 uu_9                 1.235537e-01 1 1  ON 9
 ud_0                 3.511334e-01 1 1  ON 10
 ud_1                 9.355895e-02 1 1  ON 11
 ud_2                -1.454370e-02 1 1  ON 12
 ud_3                -7.438879e-02 1 1  ON 13
 ud_4                -1.216541e-01 1 1  ON 14
 ud_5                -1.534355e-01 1 1  ON 15
 ud_6                -1.562587e-01 1 1  ON 16
 ud_7                -1.121238e-01 1 1  ON 17
 ud_8                 4.818978e-04 1 1  ON 18
 ud_9                 9.256699e-02 1 1  ON 19
 eO_0                -7.658327e-01 1 1  ON 20
 eO_1                -4.483903e-01 1 1  ON 21
 eO_2                -4.416867e-02 1 1  ON 22
 eO_3                 2.080096e-01 1 1  ON 23
 eO_4                 3.018006e-01 1 1  ON 24
 eO_5                 3.162563e-01 1 1  ON 25
 eO_6                 2.558453e-01 1 1  ON 26
 eO_7                 1.181303e-01 1 1  ON 27
 eO_8                 2.889626e-02 1 1  ON 28
 eO_9                 1.867985e-02 1 1  ON 29
eH1_0                -1.823897e-01 1 1  ON 30
eH1_1                -1.034065e-01 1 1  ON 31
eH1_2                -6.301836e-02 1 1  ON 32
eH1_3                -2.641640e-02 1 1  ON 33
eH1_4                 1.893997e-02 1 1  ON 34
eH1_5                 3.340005e-02 1 1  ON 35
eH1_6                 7.790898e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408746e-02 1 1  ON 38
eH1_9                 2.537944e-02 1 1  ON 39
eH2_0                -1.842273e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443389e-02 1 1  ON 42
eH2_3                -2.763386e-02 1 1  ON 43
eH2_4                 1.795701e-02 1 1  ON 44
eH2_5                 3.308775e-02 1 1  ON 45
eH2_6                 7.960926e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678403e-02 1 1  ON 48
eH2_9                 2.747077e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1713
    reference variance = 0.298397
====================================================
  Execution time = 1.9785e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2206e-01
  Total weights = 2.0000e+06
  Execution time = 1.8290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153157641
                                         uncertainty =       0.004861160777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153157641
                                         uncertainty =       0.004861160777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401288522
  error estimate for blocks of size 2^( 2) =       0.000410901514
  error estimate for blocks of size 2^( 3) =       0.000419288239
  error estimate for blocks of size 2^( 4) =       0.000425541199
  error estimate for blocks of size 2^( 5) =       0.000429763414
  error estimate for blocks of size 2^( 6) =       0.000431758545
  error estimate for blocks of size 2^( 7) =       0.000431678290

      target function =                  N/A
              le_mean =     -17.216756022332
             les_mean =     296.738752728001
             stat err =       0.000429685362
             autocorr =       1.146535855756
              std dev =       0.567507670901
             le_variance =       0.322064956532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153136770
                                         uncertainty =       0.004861160322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153136770
                                         uncertainty =       0.004861160322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401288509
  error estimate for blocks of size 2^( 2) =       0.000410901501
  error estimate for blocks of size 2^( 3) =       0.000419288226
  error estimate for blocks of size 2^( 4) =       0.000425541185
  error estimate for blocks of size 2^( 5) =       0.000429763402
  error estimate for blocks of size 2^( 6) =       0.000431758532
  error estimate for blocks of size 2^( 7) =       0.000431678280

      target function =                  N/A
              le_mean =     -17.216756022805
             les_mean =     296.738752723466
             stat err =       0.000429685350
             autocorr =       1.146535864921
              std dev =       0.567507652547
             le_variance =       0.322064935699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153147194
                                         uncertainty =       0.004861160550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153147194
                                         uncertainty =       0.004861160550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401288516
  error estimate for blocks of size 2^( 2) =       0.000410901508
  error estimate for blocks of size 2^( 3) =       0.000419288233
  error estimate for blocks of size 2^( 4) =       0.000425541192
  error estimate for blocks of size 2^( 5) =       0.000429763408
  error estimate for blocks of size 2^( 6) =       0.000431758539
  error estimate for blocks of size 2^( 7) =       0.000431678285

      target function =                  N/A
              le_mean =     -17.216756022569
             les_mean =     296.738752725725
             stat err =       0.000429685356
             autocorr =       1.146535860343
              std dev =       0.567507661714
             le_variance =       0.322064946104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153156335
                                         uncertainty =       0.004861160749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322153156335
                                         uncertainty =       0.004861160749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401288522
  error estimate for blocks of size 2^( 2) =       0.000410901513
  error estimate for blocks of size 2^( 3) =       0.000419288239
  error estimate for blocks of size 2^( 4) =       0.000425541198
  error estimate for blocks of size 2^( 5) =       0.000429763414
  error estimate for blocks of size 2^( 6) =       0.000431758544
  error estimate for blocks of size 2^( 7) =       0.000431678289

      target function =                  N/A
              le_mean =     -17.216756022362
             les_mean =     296.738752727716
             stat err =       0.000429685361
             autocorr =       1.146535856324
              std dev =       0.567507669752
             le_variance =       0.322064955228


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216756022332        initial
     1.4211e+03     1.4211e+04             3.6524e-07       -17.216756022805  <--
     5.6843e+03     5.6843e+04             9.1309e-08       -17.216756022569
     2.2737e+04     2.2737e+05             2.2827e-08       -17.216756022362

*****************************************************************************
Applying the update for shift_i =   1.4211e+03     and shift_s =   1.4211e+04
*****************************************************************************

  Execution time = 2.9097e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.104696e-01 1 1  ON 0
 uu_1                 4.892067e-02 1 1  ON 1
 uu_2                -4.507123e-02 1 1  ON 2
 uu_3                -9.921785e-02 1 1  ON 3
 uu_4                -1.323018e-01 1 1  ON 4
 uu_5                -1.393382e-01 1 1  ON 5
 uu_6                -1.164220e-01 1 1  ON 6
 uu_7                -4.321770e-02 1 1  ON 7
 uu_8                 9.731932e-02 1 1  ON 8
 uu_9                 1.235537e-01 1 1  ON 9
 ud_0                 3.511334e-01 1 1  ON 10
 ud_1                 9.355902e-02 1 1  ON 11
 ud_2                -1.454367e-02 1 1  ON 12
 ud_3                -7.438882e-02 1 1  ON 13
 ud_4                -1.216541e-01 1 1  ON 14
 ud_5                -1.534355e-01 1 1  ON 15
 ud_6                -1.562587e-01 1 1  ON 16
 ud_7                -1.121238e-01 1 1  ON 17
 ud_8                 4.818477e-04 1 1  ON 18
 ud_9                 9.256698e-02 1 1  ON 19
 eO_0                -7.658330e-01 1 1  ON 20
 eO_1                -4.483905e-01 1 1  ON 21
 eO_2                -4.416870e-02 1 1  ON 22
 eO_3                 2.080098e-01 1 1  ON 23
 eO_4                 3.018007e-01 1 1  ON 24
 eO_5                 3.162564e-01 1 1  ON 25
 eO_6                 2.558454e-01 1 1  ON 26
 eO_7                 1.181304e-01 1 1  ON 27
 eO_8                 2.889626e-02 1 1  ON 28
 eO_9                 1.867985e-02 1 1  ON 29
eH1_0                -1.823898e-01 1 1  ON 30
eH1_1                -1.034065e-01 1 1  ON 31
eH1_2                -6.301830e-02 1 1  ON 32
eH1_3                -2.641644e-02 1 1  ON 33
eH1_4                 1.893996e-02 1 1  ON 34
eH1_5                 3.340007e-02 1 1  ON 35
eH1_6                 7.790898e-02 1 1  ON 36
eH1_7                 1.099551e-01 1 1  ON 37
eH1_8                 9.408750e-02 1 1  ON 38
eH1_9                 2.537945e-02 1 1  ON 39
eH2_0                -1.842273e-01 1 1  ON 40
eH2_1                -1.051416e-01 1 1  ON 41
eH2_2                -6.443389e-02 1 1  ON 42
eH2_3                -2.763389e-02 1 1  ON 43
eH2_4                 1.795701e-02 1 1  ON 44
eH2_5                 3.308771e-02 1 1  ON 45
eH2_6                 7.960926e-02 1 1  ON 46
eH2_7                 1.140543e-01 1 1  ON 47
eH2_8                 9.678406e-02 1 1  ON 48
eH2_9                 2.747078e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4825e+01 secs
  Total Execution time = 2.2258e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
