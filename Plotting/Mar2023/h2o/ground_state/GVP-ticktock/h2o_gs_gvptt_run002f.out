Rank =    0  Free Memory = 82759 MB
Rank =    1  Free Memory = 82759 MB
Rank =    2  Free Memory = 82759 MB
Rank =    3  Free Memory = 82759 MB
Rank =    4  Free Memory = 82759 MB
Rank =    5  Free Memory = 82759 MB
Rank =    6  Free Memory = 82759 MB
Rank =    7  Free Memory = 82759 MB
Rank =    8  Free Memory = 82759 MB
Rank =    9  Free Memory = 82759 MB
Rank =   10  Free Memory = 82759 MB
Rank =   11  Free Memory = 82759 MB
Rank =   12  Free Memory = 82759 MB
Rank =   13  Free Memory = 82759 MB
Rank =   14  Free Memory = 82758 MB
Rank =   15  Free Memory = 82745 MB
Rank =   16  Free Memory = 82745 MB
Rank =   17  Free Memory = 82745 MB
Rank =   18  Free Memory = 82744 MB
Rank =   19  Free Memory = 82744 MB
Rank =   20  Free Memory = 82744 MB
Rank =   21  Free Memory = 82744 MB
Rank =   22  Free Memory = 82744 MB
Rank =   23  Free Memory = 82744 MB
Rank =   24  Free Memory = 82744 MB
Rank =   25  Free Memory = 82744 MB
Rank =   26  Free Memory = 82744 MB
Rank =   27  Free Memory = 82744 MB
Rank =   28  Free Memory = 82744 MB
Rank =   29  Free Memory = 82744 MB
Rank =   30  Free Memory = 82744 MB
Rank =   31  Free Memory = 82744 MB
Rank =   32  Free Memory = 89278 MB
Rank =   33  Free Memory = 89278 MB
Rank =   34  Free Memory = 89278 MB
Rank =   35  Free Memory = 89278 MB
Rank =   36  Free Memory = 89278 MB
Rank =   37  Free Memory = 89278 MB
Rank =   38  Free Memory = 89278 MB
Rank =   39  Free Memory = 89278 MB
Rank =   40  Free Memory = 89278 MB
Rank =   41  Free Memory = 89278 MB
Rank =   42  Free Memory = 89278 MB
Rank =   43  Free Memory = 89278 MB
Rank =   44  Free Memory = 89278 MB
Rank =   45  Free Memory = 89278 MB
Rank =   46  Free Memory = 89278 MB
Rank =   47  Free Memory = 89278 MB
Rank =   48  Free Memory = 89278 MB
Rank =   49  Free Memory = 89278 MB
Rank =   50  Free Memory = 89278 MB
Rank =   51  Free Memory = 89278 MB
Rank =   52  Free Memory = 89278 MB
Rank =   53  Free Memory = 89278 MB
Rank =   54  Free Memory = 89278 MB
Rank =   55  Free Memory = 89278 MB
Rank =   56  Free Memory = 89278 MB
Rank =   57  Free Memory = 89278 MB
Rank =   58  Free Memory = 89278 MB
Rank =   59  Free Memory = 89278 MB
Rank =   60  Free Memory = 89278 MB
Rank =   61  Free Memory = 89278 MB
Rank =   62  Free Memory = 89278 MB
Rank =   63  Free Memory = 89278 MB
Rank =   64  Free Memory = 86454 MB
Rank =   65  Free Memory = 86454 MB
Rank =   66  Free Memory = 86454 MB
Rank =   67  Free Memory = 86454 MB
Rank =   68  Free Memory = 86454 MB
Rank =   69  Free Memory = 86454 MB
Rank =   70  Free Memory = 86454 MB
Rank =   71  Free Memory = 86454 MB
Rank =   72  Free Memory = 86454 MB
Rank =   73  Free Memory = 86454 MB
Rank =   74  Free Memory = 86454 MB
Rank =   75  Free Memory = 86454 MB
Rank =   76  Free Memory = 86454 MB
Rank =   77  Free Memory = 86454 MB
Rank =   78  Free Memory = 86454 MB
Rank =   79  Free Memory = 86454 MB
Rank =   80  Free Memory = 86454 MB
Rank =   81  Free Memory = 86454 MB
Rank =   82  Free Memory = 86454 MB
Rank =   83  Free Memory = 86454 MB
Rank =   84  Free Memory = 86454 MB
Rank =   85  Free Memory = 86454 MB
Rank =   86  Free Memory = 86454 MB
Rank =   87  Free Memory = 86454 MB
Rank =   88  Free Memory = 86454 MB
Rank =   89  Free Memory = 86454 MB
Rank =   90  Free Memory = 86454 MB
Rank =   91  Free Memory = 86454 MB
Rank =   92  Free Memory = 86454 MB
Rank =   93  Free Memory = 86454 MB
Rank =   94  Free Memory = 86454 MB
Rank =   95  Free Memory = 86454 MB
Rank =   96  Free Memory = 87403 MB
Rank =   97  Free Memory = 87402 MB
Rank =   98  Free Memory = 87402 MB
Rank =   99  Free Memory = 87402 MB
Rank =  100  Free Memory = 87402 MB
Rank =  101  Free Memory = 87402 MB
Rank =  102  Free Memory = 87402 MB
Rank =  103  Free Memory = 87402 MB
Rank =  104  Free Memory = 87402 MB
Rank =  105  Free Memory = 87402 MB
Rank =  106  Free Memory = 87402 MB
Rank =  107  Free Memory = 87402 MB
Rank =  108  Free Memory = 87402 MB
Rank =  109  Free Memory = 87402 MB
Rank =  110  Free Memory = 87402 MB
Rank =  111  Free Memory = 87402 MB
Rank =  112  Free Memory = 87402 MB
Rank =  113  Free Memory = 87402 MB
Rank =  114  Free Memory = 87402 MB
Rank =  115  Free Memory = 87402 MB
Rank =  116  Free Memory = 87402 MB
Rank =  117  Free Memory = 87402 MB
Rank =  118  Free Memory = 87402 MB
Rank =  119  Free Memory = 87402 MB
Rank =  120  Free Memory = 87402 MB
Rank =  121  Free Memory = 87402 MB
Rank =  122  Free Memory = 87402 MB
Rank =  123  Free Memory = 87402 MB
Rank =  124  Free Memory = 87402 MB
Rank =  125  Free Memory = 87402 MB
Rank =  126  Free Memory = 87402 MB
Rank =  127  Free Memory = 87402 MB
  Input file(s): opt_h2o_gs_gvptt_run002f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run002f.xml

  Project = H2O
  date    = 2023-03-15 14:16:11 PDT
  host    = n0102.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 411

  Range of prime numbers to use as seeds over processors and threads = 2843-3911


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.909151e-01    1         1  ON     0
     uu_1                 2.817580e-02    1         1  ON     1
     uu_2                -6.767552e-02    1         1  ON     2
     uu_3                -1.244133e-01    1         1  ON     3
     uu_4                -1.604521e-01    1         1  ON     4
     uu_5                -1.723904e-01    1         1  ON     5
     uu_6                -1.595263e-01    1         1  ON     6
     uu_7                -1.136033e-01    1         1  ON     7
     uu_8                -3.691504e-02    1         1  ON     8
     uu_9                 1.618748e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.492203e-01    1         1  ON     0
     ud_1                 9.073460e-02    1         1  ON     1
     ud_2                -1.902353e-02    1         1  ON     2
     ud_3                -8.085691e-02    1         1  ON     3
     ud_4                -1.307829e-01    1         1  ON     4
     ud_5                -1.677763e-01    1         1  ON     5
     ud_6                -1.808553e-01    1         1  ON     6
     ud_7                -1.595734e-01    1         1  ON     7
     ud_8                -9.930879e-02    1         1  ON     8
     ud_9                -8.478907e-03    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.252088e-01    1         1  ON     0
     eO_1                -6.029806e-01    1         1  ON     1
     eO_2                -1.886417e-01    1         1  ON     2
     eO_3                 8.046727e-02    1         1  ON     3
     eO_4                 2.053372e-01    1         1  ON     4
     eO_5                 2.935714e-01    1         1  ON     5
     eO_6                 3.341505e-01    1         1  ON     6
     eO_7                 5.023067e-01    1         1  ON     7
     eO_8                 1.940450e-01    1         1  ON     8
     eO_9                 6.116837e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.116539e-01    1         1  ON     0
     eH1_1                -1.328908e-01    1         1  ON     1
     eH1_2                -9.154479e-02    1         1  ON     2
     eH1_3                -5.390916e-02    1         1  ON     3
     eH1_4                -7.389424e-03    1         1  ON     4
     eH1_5                 4.702552e-03    1         1  ON     5
     eH1_6                 4.144525e-02    1         1  ON     6
     eH1_7                 6.405825e-02    1         1  ON     7
     eH1_8                 1.798836e-01    1         1  ON     8
     eH1_9                 1.210010e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.068517e-01    1         1  ON     0
     eH2_1                -1.280764e-01    1         1  ON     1
     eH2_2                -8.656021e-02    1         1  ON     2
     eH2_3                -4.908482e-02    1         1  ON     3
     eH2_4                -2.846185e-03    1         1  ON     4
     eH2_5                 9.104849e-03    1         1  ON     5
     eH2_6                 4.679973e-02    1         1  ON     6
     eH2_7                 4.636012e-02    1         1  ON     7
     eH2_8                 1.982546e-01    1         1  ON     8
     eH2_9                 1.201541e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.697294e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 6.8439e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1686
    reference variance = 0.25616
====================================================
  Execution time = 2.1523e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2161e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321738928531
                                         uncertainty =       0.003336199535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321738928531
                                         uncertainty =       0.003336199535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401004111
  error estimate for blocks of size 2^( 2) =       0.000410646101
  error estimate for blocks of size 2^( 3) =       0.000419274755
  error estimate for blocks of size 2^( 4) =       0.000425409374
  error estimate for blocks of size 2^( 5) =       0.000429039384
  error estimate for blocks of size 2^( 6) =       0.000431252752
  error estimate for blocks of size 2^( 7) =       0.000433671039

      target function =                  N/A
              le_mean =     -17.216332255938
             les_mean =     296.723704780161
             stat err =       0.000429843137
             autocorr =       1.149006128424
              std dev =       0.567105452362
             le_variance =       0.321608594098


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721633225594e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216332255938       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216333327469       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216335365948       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216335971694       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216334861123       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216335536077       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216336795105       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216335891292       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216336012862       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216336376197       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.844161e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216332255938       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216332649472       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216333727082       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216334100233       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216333781564       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216333908686       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216334181486       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216333978537       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.919974e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216332255938       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216332367391       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216332725894       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216332855731       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216332805364       residual = 4.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216332848046       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216332895766       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216332838459       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.625913e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7220e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.910203e-01                 1 1 ON  0
uu_1  2.818753e-02                 1 1 ON  1
uu_2  -6.777404e-02                1 1 ON  2
uu_3  -1.243651e-01                1 1 ON  3
uu_4  -1.605005e-01                1 1 ON  4
uu_5  -1.723701e-01                1 1 ON  5
uu_6  -1.595307e-01                1 1 ON  6
uu_7  -1.136326e-01                1 1 ON  7
uu_8  -3.693856e-02                1 1 ON  8
uu_9  1.618559e-01                 1 1 ON  9
ud_0  3.495213e-01                 1 1 ON  10
ud_1  9.089087e-02                 1 1 ON  11
ud_2  -1.918416e-02                1 1 ON  12
ud_3  -8.104049e-02                1 1 ON  13
ud_4  -1.309511e-01                1 1 ON  14
ud_5  -1.677391e-01                1 1 ON  15
ud_6  -1.808209e-01                1 1 ON  16
ud_7  -1.595881e-01                1 1 ON  17
ud_8  -9.933445e-02                1 1 ON  18
ud_9  -8.473771e-03                1 1 ON  19
eO_0  -9.258008e-01                1 1 ON  20
eO_1  -6.031461e-01                1 1 ON  21
eO_2  -1.883842e-01                1 1 ON  22
eO_3  8.084703e-02                 1 1 ON  23
eO_4  2.054656e-01                 1 1 ON  24
eO_5  2.935766e-01                 1 1 ON  25
eO_6  3.341428e-01                 1 1 ON  26
eO_7  5.022857e-01                 1 1 ON  27
eO_8  1.940516e-01                 1 1 ON  28
eO_9  6.117324e-02                 1 1 ON  29
eH1_0 -2.117725e-01                1 1 ON  30
eH1_1 -1.329810e-01                1 1 ON  31
eH1_2 -9.148539e-02                1 1 ON  32
eH1_3 -5.382941e-02                1 1 ON  33
eH1_4 -7.393588e-03                1 1 ON  34
eH1_5 4.761669e-03                 1 1 ON  35
eH1_6 4.145604e-02                 1 1 ON  36
eH1_7 6.405518e-02                 1 1 ON  37
eH1_8 1.798886e-01                 1 1 ON  38
eH1_9 1.210030e-01                 1 1 ON  39
eH2_0 -2.068497e-01                1 1 ON  40
eH2_1 -1.281288e-01                1 1 ON  41
eH2_2 -8.661674e-02                1 1 ON  42
eH2_3 -4.904799e-02                1 1 ON  43
eH2_4 -2.831546e-03                1 1 ON  44
eH2_5 9.145201e-03                 1 1 ON  45
eH2_6 4.681634e-02                 1 1 ON  46
eH2_7 4.634942e-02                 1 1 ON  47
eH2_8 1.982489e-01                 1 1 ON  48
eH2_9 1.201609e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2428
    reference variance = 0.424433
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2491e-01
  Total weights = 2.0000e+06
  Execution time = 1.8447e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324624675721
                                         uncertainty =       0.004295496782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324624675721
                                         uncertainty =       0.004295496782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402840404
  error estimate for blocks of size 2^( 2) =       0.000412850374
  error estimate for blocks of size 2^( 3) =       0.000420835554
  error estimate for blocks of size 2^( 4) =       0.000426744186
  error estimate for blocks of size 2^( 5) =       0.000430228311
  error estimate for blocks of size 2^( 6) =       0.000432185539
  error estimate for blocks of size 2^( 7) =       0.000433205226

      target function =                  N/A
              le_mean =     -17.217660579570
             les_mean =     296.772396452765
             stat err =       0.000430590815
             autocorr =       1.142519126082
              std dev =       0.569702362441
             le_variance =       0.324560781771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325526901858
                                         uncertainty =       0.004301080100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325526901858
                                         uncertainty =       0.004301080100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403399582
  error estimate for blocks of size 2^( 2) =       0.000413376783
  error estimate for blocks of size 2^( 3) =       0.000421331402
  error estimate for blocks of size 2^( 4) =       0.000427224083
  error estimate for blocks of size 2^( 5) =       0.000430693429
  error estimate for blocks of size 2^( 6) =       0.000432659924
  error estimate for blocks of size 2^( 7) =       0.000433659556

      target function =                  N/A
              le_mean =     -17.217658828295
             les_mean =     296.773237809528
             stat err =       0.000431059248
             autocorr =       1.141834200634
              std dev =       0.570493159215
             le_variance =       0.325462444711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324827284
                                         uncertainty =       0.004299406771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325324827284
                                         uncertainty =       0.004299406771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403274377
  error estimate for blocks of size 2^( 2) =       0.000413257673
  error estimate for blocks of size 2^( 3) =       0.000421219135
  error estimate for blocks of size 2^( 4) =       0.000427114801
  error estimate for blocks of size 2^( 5) =       0.000430585309
  error estimate for blocks of size 2^( 6) =       0.000432549673
  error estimate for blocks of size 2^( 7) =       0.000433554101

      target function =                  N/A
              le_mean =     -17.217658065247
             les_mean =     296.773009535081
             stat err =       0.000430950971
             autocorr =       1.141969407344
              std dev =       0.570316093016
             le_variance =       0.325260445953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324726501680
                                         uncertainty =       0.004296006254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324726501680
                                         uncertainty =       0.004296006254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402903544
  error estimate for blocks of size 2^( 2) =       0.000412909442
  error estimate for blocks of size 2^( 3) =       0.000420891009
  error estimate for blocks of size 2^( 4) =       0.000426797604
  error estimate for blocks of size 2^( 5) =       0.000430279528
  error estimate for blocks of size 2^( 6) =       0.000432237766
  error estimate for blocks of size 2^( 7) =       0.000433255096

      target function =                  N/A
              le_mean =     -17.217659941098
             les_mean =     296.772476216465
             stat err =       0.000430642499
             autocorr =       1.142435258633
              std dev =       0.569791656217
             le_variance =       0.324662531495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217660579570        initial  <--
     2.5000e-01     2.5000e+00             1.8442e-03       -17.217658828295
     1.0000e+00     1.0000e+01             5.9200e-04       -17.217658065247
     4.0000e+00     4.0000e+01             1.6259e-04       -17.217659941098

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9518
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.909151e-01 1 1  ON 0
 uu_1                 2.817580e-02 1 1  ON 1
 uu_2                -6.767552e-02 1 1  ON 2
 uu_3                -1.244133e-01 1 1  ON 3
 uu_4                -1.604521e-01 1 1  ON 4
 uu_5                -1.723904e-01 1 1  ON 5
 uu_6                -1.595263e-01 1 1  ON 6
 uu_7                -1.136033e-01 1 1  ON 7
 uu_8                -3.691504e-02 1 1  ON 8
 uu_9                 1.618748e-01 1 1  ON 9
 ud_0                 3.492203e-01 1 1  ON 10
 ud_1                 9.073460e-02 1 1  ON 11
 ud_2                -1.902353e-02 1 1  ON 12
 ud_3                -8.085691e-02 1 1  ON 13
 ud_4                -1.307829e-01 1 1  ON 14
 ud_5                -1.677763e-01 1 1  ON 15
 ud_6                -1.808553e-01 1 1  ON 16
 ud_7                -1.595734e-01 1 1  ON 17
 ud_8                -9.930879e-02 1 1  ON 18
 ud_9                -8.478907e-03 1 1  ON 19
 eO_0                -9.252088e-01 1 1  ON 20
 eO_1                -6.029806e-01 1 1  ON 21
 eO_2                -1.886417e-01 1 1  ON 22
 eO_3                 8.046727e-02 1 1  ON 23
 eO_4                 2.053372e-01 1 1  ON 24
 eO_5                 2.935714e-01 1 1  ON 25
 eO_6                 3.341505e-01 1 1  ON 26
 eO_7                 5.023067e-01 1 1  ON 27
 eO_8                 1.940450e-01 1 1  ON 28
 eO_9                 6.116837e-02 1 1  ON 29
eH1_0                -2.116539e-01 1 1  ON 30
eH1_1                -1.328908e-01 1 1  ON 31
eH1_2                -9.154479e-02 1 1  ON 32
eH1_3                -5.390916e-02 1 1  ON 33
eH1_4                -7.389424e-03 1 1  ON 34
eH1_5                 4.702552e-03 1 1  ON 35
eH1_6                 4.144525e-02 1 1  ON 36
eH1_7                 6.405825e-02 1 1  ON 37
eH1_8                 1.798836e-01 1 1  ON 38
eH1_9                 1.210010e-01 1 1  ON 39
eH2_0                -2.068517e-01 1 1  ON 40
eH2_1                -1.280764e-01 1 1  ON 41
eH2_2                -8.656021e-02 1 1  ON 42
eH2_3                -4.908482e-02 1 1  ON 43
eH2_4                -2.846185e-03 1 1  ON 44
eH2_5                 9.104849e-03 1 1  ON 45
eH2_6                 4.679973e-02 1 1  ON 46
eH2_7                 4.636012e-02 1 1  ON 47
eH2_8                 1.982546e-01 1 1  ON 48
eH2_9                 1.201541e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2354
    reference variance = 0.221058
====================================================
  Execution time = 2.1125e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318788586943
                                         uncertainty =       0.004570682495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318788586943
                                         uncertainty =       0.004570682495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399211668
  error estimate for blocks of size 2^( 2) =       0.000408800770
  error estimate for blocks of size 2^( 3) =       0.000417201182
  error estimate for blocks of size 2^( 4) =       0.000424042736
  error estimate for blocks of size 2^( 5) =       0.000427352748
  error estimate for blocks of size 2^( 6) =       0.000429294646
  error estimate for blocks of size 2^( 7) =       0.000428129514

      target function =                  N/A
              le_mean =     -17.217261158206
             les_mean =     296.752821542525
             stat err =       0.000427204911
             autocorr =       1.145159607071
              std dev =       0.564570555396
             le_variance =       0.318739912020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721726115821e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217261158206       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217261202317       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217261482929       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217261432415       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217261181883       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217261301823       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217261310999       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217261286938       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.189098e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217261158206       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217261170139       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217261247244       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217261237589       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217261179493       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217261191476       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217261208514       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217261201408       residual = 2.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.667655e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217261158206       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217261161252       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217261181024       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217261178867       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217261165008       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217261167114       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217261171709       residual = 9.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.411260e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037166 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6741e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.909195e-01 1 1  ON 0
 uu_1                 2.817702e-02 1 1  ON 1
 uu_2                -6.767816e-02 1 1  ON 2
 uu_3                -1.244110e-01 1 1  ON 3
 uu_4                -1.604587e-01 1 1  ON 4
 uu_5                -1.723820e-01 1 1  ON 5
 uu_6                -1.595345e-01 1 1  ON 6
 uu_7                -1.136057e-01 1 1  ON 7
 uu_8                -3.691391e-02 1 1  ON 8
 uu_9                 1.618741e-01 1 1  ON 9
 ud_0                 3.492554e-01 1 1  ON 10
 ud_1                 9.075158e-02 1 1  ON 11
 ud_2                -1.904171e-02 1 1  ON 12
 ud_3                -8.087525e-02 1 1  ON 13
 ud_4                -1.308046e-01 1 1  ON 14
 ud_5                -1.677788e-01 1 1  ON 15
 ud_6                -1.808492e-01 1 1  ON 16
 ud_7                -1.595722e-01 1 1  ON 17
 ud_8                -9.931058e-02 1 1  ON 18
 ud_9                -8.477842e-03 1 1  ON 19
 eO_0                -9.252655e-01 1 1  ON 20
 eO_1                -6.030036e-01 1 1  ON 21
 eO_2                -1.886135e-01 1 1  ON 22
 eO_3                 8.051147e-02 1 1  ON 23
 eO_4                 2.053528e-01 1 1  ON 24
 eO_5                 2.935653e-01 1 1  ON 25
 eO_6                 3.341461e-01 1 1  ON 26
 eO_7                 5.023056e-01 1 1  ON 27
 eO_8                 1.940473e-01 1 1  ON 28
 eO_9                 6.116906e-02 1 1  ON 29
eH1_0                -2.116614e-01 1 1  ON 30
eH1_1                -1.328866e-01 1 1  ON 31
eH1_2                -9.153722e-02 1 1  ON 32
eH1_3                -5.390535e-02 1 1  ON 33
eH1_4                -7.392501e-03 1 1  ON 34
eH1_5                 4.704267e-03 1 1  ON 35
eH1_6                 4.144057e-02 1 1  ON 36
eH1_7                 6.405518e-02 1 1  ON 37
eH1_8                 1.798833e-01 1 1  ON 38
eH1_9                 1.210018e-01 1 1  ON 39
eH2_0                -2.068575e-01 1 1  ON 40
eH2_1                -1.280720e-01 1 1  ON 41
eH2_2                -8.656677e-02 1 1  ON 42
eH2_3                -4.907640e-02 1 1  ON 43
eH2_4                -2.849527e-03 1 1  ON 44
eH2_5                 9.105689e-03 1 1  ON 45
eH2_6                 4.679916e-02 1 1  ON 46
eH2_7                 4.636141e-02 1 1  ON 47
eH2_8                 1.982544e-01 1 1  ON 48
eH2_9                 1.201549e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2086
    reference variance = 0.293971
====================================================
  Execution time = 1.9868e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2192e-01
  Total weights = 2.0000e+06
  Execution time = 1.8421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321956726149
                                         uncertainty =       0.004409981174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321956726149
                                         uncertainty =       0.004409981174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401173157
  error estimate for blocks of size 2^( 2) =       0.000410828851
  error estimate for blocks of size 2^( 3) =       0.000419244714
  error estimate for blocks of size 2^( 4) =       0.000425145460
  error estimate for blocks of size 2^( 5) =       0.000429091054
  error estimate for blocks of size 2^( 6) =       0.000431472673
  error estimate for blocks of size 2^( 7) =       0.000432859729

      target function =                  N/A
              le_mean =     -17.216639946743
             les_mean =     296.734570698408
             stat err =       0.000429642229
             autocorr =       1.146965064211
              std dev =       0.567344519289
             le_variance =       0.321879803567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322094222657
                                         uncertainty =       0.004411047566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322094222657
                                         uncertainty =       0.004411047566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401258839
  error estimate for blocks of size 2^( 2) =       0.000410909804
  error estimate for blocks of size 2^( 3) =       0.000419320220
  error estimate for blocks of size 2^( 4) =       0.000425217266
  error estimate for blocks of size 2^( 5) =       0.000429159237
  error estimate for blocks of size 2^( 6) =       0.000431538995
  error estimate for blocks of size 2^( 7) =       0.000432920627

      target function =                  N/A
              le_mean =     -17.216640410158
             les_mean =     296.734724163072
             stat err =       0.000429709031
             autocorr =       1.146831832401
              std dev =       0.567465691814
             le_variance =       0.322017311386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322030333773
                                         uncertainty =       0.004410531943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322030333773
                                         uncertainty =       0.004410531943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219029
  error estimate for blocks of size 2^( 2) =       0.000410872156
  error estimate for blocks of size 2^( 3) =       0.000419285038
  error estimate for blocks of size 2^( 4) =       0.000425183752
  error estimate for blocks of size 2^( 5) =       0.000429127331
  error estimate for blocks of size 2^( 6) =       0.000431508008
  error estimate for blocks of size 2^( 7) =       0.000432892194

      target function =                  N/A
              le_mean =     -17.216640193116
             les_mean =     296.734652797381
             stat err =       0.000429677821
             autocorr =       1.146892806113
              std dev =       0.567409392904
             le_variance =       0.321953419156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321965976358
                                         uncertainty =       0.004410047989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321965976358
                                         uncertainty =       0.004410047989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401178922
  error estimate for blocks of size 2^( 2) =       0.000410834292
  error estimate for blocks of size 2^( 3) =       0.000419249779
  error estimate for blocks of size 2^( 4) =       0.000425150270
  error estimate for blocks of size 2^( 5) =       0.000429095609
  error estimate for blocks of size 2^( 6) =       0.000431477113
  error estimate for blocks of size 2^( 7) =       0.000432863802

      target function =                  N/A
              le_mean =     -17.216639976034
             les_mean =     296.734580958215
             stat err =       0.000429646698
             autocorr =       1.146955962770
              std dev =       0.567352672317
             le_variance =       0.321889054785


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216639946743        initial
     2.5000e+00     2.5000e+01             2.1891e-04       -17.216640410158  <--
     1.0000e+01     1.0000e+02             5.6677e-05       -17.216640193116
     4.0000e+01     4.0000e+02             1.4113e-05       -17.216639976034

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9227e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.909321e-01 1 1  ON 0
 uu_1                 2.818175e-02 1 1  ON 1
 uu_2                -6.768472e-02 1 1  ON 2
 uu_3                -1.244061e-01 1 1  ON 3
 uu_4                -1.604768e-01 1 1  ON 4
 uu_5                -1.723590e-01 1 1  ON 5
 uu_6                -1.595582e-01 1 1  ON 6
 uu_7                -1.136126e-01 1 1  ON 7
 uu_8                -3.691059e-02 1 1  ON 8
 uu_9                 1.618720e-01 1 1  ON 9
 ud_0                 3.493530e-01 1 1  ON 10
 ud_1                 9.079594e-02 1 1  ON 11
 ud_2                -1.908694e-02 1 1  ON 12
 ud_3                -8.092928e-02 1 1  ON 13
 ud_4                -1.308646e-01 1 1  ON 14
 ud_5                -1.677880e-01 1 1  ON 15
 ud_6                -1.808310e-01 1 1  ON 16
 ud_7                -1.595679e-01 1 1  ON 17
 ud_8                -9.931566e-02 1 1  ON 18
 ud_9                -8.474694e-03 1 1  ON 19
 eO_0                -9.254277e-01 1 1  ON 20
 eO_1                -6.030707e-01 1 1  ON 21
 eO_2                -1.885364e-01 1 1  ON 22
 eO_3                 8.064183e-02 1 1  ON 23
 eO_4                 2.053990e-01 1 1  ON 24
 eO_5                 2.935472e-01 1 1  ON 25
 eO_6                 3.341336e-01 1 1  ON 26
 eO_7                 5.023025e-01 1 1  ON 27
 eO_8                 1.940542e-01 1 1  ON 28
 eO_9                 6.117108e-02 1 1  ON 29
eH1_0                -2.116829e-01 1 1  ON 30
eH1_1                -1.328743e-01 1 1  ON 31
eH1_2                -9.151499e-02 1 1  ON 32
eH1_3                -5.389417e-02 1 1  ON 33
eH1_4                -7.402017e-03 1 1  ON 34
eH1_5                 4.709142e-03 1 1  ON 35
eH1_6                 4.142691e-02 1 1  ON 36
eH1_7                 6.404623e-02 1 1  ON 37
eH1_8                 1.798824e-01 1 1  ON 38
eH1_9                 1.210041e-01 1 1  ON 39
eH2_0                -2.068742e-01 1 1  ON 40
eH2_1                -1.280610e-01 1 1  ON 41
eH2_2                -8.658323e-02 1 1  ON 42
eH2_3                -4.905293e-02 1 1  ON 43
eH2_4                -2.859138e-03 1 1  ON 44
eH2_5                 9.108242e-03 1 1  ON 45
eH2_6                 4.679759e-02 1 1  ON 46
eH2_7                 4.636526e-02 1 1  ON 47
eH2_8                 1.982541e-01 1 1  ON 48
eH2_9                 1.201570e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5974e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2411
    reference variance = 0.27019
====================================================
  Execution time = 2.0441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1403e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5595e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313991988947
                                         uncertainty =       0.002485407539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313991988947
                                         uncertainty =       0.002485407539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396253838
  error estimate for blocks of size 2^( 2) =       0.000405437879
  error estimate for blocks of size 2^( 3) =       0.000414151958
  error estimate for blocks of size 2^( 4) =       0.000419718949
  error estimate for blocks of size 2^( 5) =       0.000423109253
  error estimate for blocks of size 2^( 6) =       0.000425880895
  error estimate for blocks of size 2^( 7) =       0.000427853299

      target function =                  N/A
              le_mean =     -17.216626964754
             les_mean =     296.726278095451
             stat err =       0.000424140599
             autocorr =       1.145704782430
              std dev =       0.560387552493
             le_variance =       0.314034208989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662696475e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216626964754       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216628357984       residual = 8.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216628123853       residual = 5.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216628233613       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216628079956       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216628741399       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216629396143       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216629266055       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216629282856       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 8.931017e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216626964754       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216627405492       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216627353178       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216627323181       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216627200194       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216627405009       residual = 8.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216627541728       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216627514335       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.543946e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216626964754       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216627082767       residual = 9.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216627070872       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216627057119       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216627015609       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216627069091       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216627099813       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216627094849       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 6.631428e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.039998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6007e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.909187e-01 1 1  ON 0
 uu_1                 2.824141e-02 1 1  ON 1
 uu_2                -6.769073e-02 1 1  ON 2
 uu_3                -1.244443e-01 1 1  ON 3
 uu_4                -1.604583e-01 1 1  ON 4
 uu_5                -1.723759e-01 1 1  ON 5
 uu_6                -1.595724e-01 1 1  ON 6
 uu_7                -1.136156e-01 1 1  ON 7
 uu_8                -3.691049e-02 1 1  ON 8
 uu_9                 1.618651e-01 1 1  ON 9
 ud_0                 3.494692e-01 1 1  ON 10
 ud_1                 9.086098e-02 1 1  ON 11
 ud_2                -1.914329e-02 1 1  ON 12
 ud_3                -8.102626e-02 1 1  ON 13
 ud_4                -1.309163e-01 1 1  ON 14
 ud_5                -1.678114e-01 1 1  ON 15
 ud_6                -1.807827e-01 1 1  ON 16
 ud_7                -1.595593e-01 1 1  ON 17
 ud_8                -9.933144e-02 1 1  ON 18
 ud_9                -8.477747e-03 1 1  ON 19
 eO_0                -9.256821e-01 1 1  ON 20
 eO_1                -6.031411e-01 1 1  ON 21
 eO_2                -1.884233e-01 1 1  ON 22
 eO_3                 8.081939e-02 1 1  ON 23
 eO_4                 2.054580e-01 1 1  ON 24
 eO_5                 2.935232e-01 1 1  ON 25
 eO_6                 3.341282e-01 1 1  ON 26
 eO_7                 5.022975e-01 1 1  ON 27
 eO_8                 1.940600e-01 1 1  ON 28
 eO_9                 6.117248e-02 1 1  ON 29
eH1_0                -2.117408e-01 1 1  ON 30
eH1_1                -1.329003e-01 1 1  ON 31
eH1_2                -9.151181e-02 1 1  ON 32
eH1_3                -5.388863e-02 1 1  ON 33
eH1_4                -7.398713e-03 1 1  ON 34
eH1_5                 4.758060e-03 1 1  ON 35
eH1_6                 4.145801e-02 1 1  ON 36
eH1_7                 6.403420e-02 1 1  ON 37
eH1_8                 1.798808e-01 1 1  ON 38
eH1_9                 1.210058e-01 1 1  ON 39
eH2_0                -2.069139e-01 1 1  ON 40
eH2_1                -1.280936e-01 1 1  ON 41
eH2_2                -8.659318e-02 1 1  ON 42
eH2_3                -4.900036e-02 1 1  ON 43
eH2_4                -2.845743e-03 1 1  ON 44
eH2_5                 9.108891e-03 1 1  ON 45
eH2_6                 4.680545e-02 1 1  ON 46
eH2_7                 4.637448e-02 1 1  ON 47
eH2_8                 1.982500e-01 1 1  ON 48
eH2_9                 1.201576e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2172
    reference variance = 0.51133
====================================================
  Execution time = 2.0388e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2209e-01
  Total weights = 2.0000e+06
  Execution time = 1.8421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321978382262
                                         uncertainty =       0.004671989082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321978382262
                                         uncertainty =       0.004671989082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401220626
  error estimate for blocks of size 2^( 2) =       0.000410844973
  error estimate for blocks of size 2^( 3) =       0.000419151513
  error estimate for blocks of size 2^( 4) =       0.000426046052
  error estimate for blocks of size 2^( 5) =       0.000429253905
  error estimate for blocks of size 2^( 6) =       0.000430974788
  error estimate for blocks of size 2^( 7) =       0.000431880824

      target function =                  N/A
              le_mean =     -17.216069453976
             les_mean =     296.715003264754
             stat err =       0.000429538892
             autocorr =       1.146142146557
              std dev =       0.567411650931
             le_variance =       0.321955981612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322404833595
                                         uncertainty =       0.004681662981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322404833595
                                         uncertainty =       0.004681662981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401486306
  error estimate for blocks of size 2^( 2) =       0.000411095472
  error estimate for blocks of size 2^( 3) =       0.000419385149
  error estimate for blocks of size 2^( 4) =       0.000426270825
  error estimate for blocks of size 2^( 5) =       0.000429467455
  error estimate for blocks of size 2^( 6) =       0.000431189555
  error estimate for blocks of size 2^( 7) =       0.000432081898

      target function =                  N/A
              le_mean =     -17.216067549549
             les_mean =     296.715364217354
             stat err =       0.000429752433
             autocorr =       1.145764112150
              std dev =       0.567787379133
             le_variance =       0.322382507902

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322240869602
                                         uncertainty =       0.004678213445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322240869602
                                         uncertainty =       0.004678213445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401384189
  error estimate for blocks of size 2^( 2) =       0.000410998739
  error estimate for blocks of size 2^( 3) =       0.000419294693
  error estimate for blocks of size 2^( 4) =       0.000426183715
  error estimate for blocks of size 2^( 5) =       0.000429384432
  error estimate for blocks of size 2^( 6) =       0.000431106168
  error estimate for blocks of size 2^( 7) =       0.000432003111

      target function =                  N/A
              le_mean =     -17.216068073934
             les_mean =     296.715218299064
             stat err =       0.000429669357
             autocorr =       1.145904016039
              std dev =       0.567642963352
             le_variance =       0.322218533843

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322012764817
                                         uncertainty =       0.004672817992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322012764817
                                         uncertainty =       0.004672817992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401242055
  error estimate for blocks of size 2^( 2) =       0.000410865075
  error estimate for blocks of size 2^( 3) =       0.000419170193
  error estimate for blocks of size 2^( 4) =       0.000426063981
  error estimate for blocks of size 2^( 5) =       0.000429270850
  error estimate for blocks of size 2^( 6) =       0.000430991892
  error estimate for blocks of size 2^( 7) =       0.000431896700

      target function =                  N/A
              le_mean =     -17.216069238128
             les_mean =     296.715030225054
             stat err =       0.000429555856
             autocorr =       1.146110244431
              std dev =       0.567441956538
             le_variance =       0.321990374040


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216069453976        initial  <--
     6.2500e-01     6.2500e+00             8.9310e-04       -17.216067549549
     2.5000e+00     2.5000e+01             2.5439e-04       -17.216068073934
     1.0000e+01     1.0000e+02             6.6314e-05       -17.216069238128

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6883
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.909321e-01 1 1  ON 0
 uu_1                 2.818175e-02 1 1  ON 1
 uu_2                -6.768472e-02 1 1  ON 2
 uu_3                -1.244061e-01 1 1  ON 3
 uu_4                -1.604768e-01 1 1  ON 4
 uu_5                -1.723590e-01 1 1  ON 5
 uu_6                -1.595582e-01 1 1  ON 6
 uu_7                -1.136126e-01 1 1  ON 7
 uu_8                -3.691059e-02 1 1  ON 8
 uu_9                 1.618720e-01 1 1  ON 9
 ud_0                 3.493530e-01 1 1  ON 10
 ud_1                 9.079594e-02 1 1  ON 11
 ud_2                -1.908694e-02 1 1  ON 12
 ud_3                -8.092928e-02 1 1  ON 13
 ud_4                -1.308646e-01 1 1  ON 14
 ud_5                -1.677880e-01 1 1  ON 15
 ud_6                -1.808310e-01 1 1  ON 16
 ud_7                -1.595679e-01 1 1  ON 17
 ud_8                -9.931566e-02 1 1  ON 18
 ud_9                -8.474694e-03 1 1  ON 19
 eO_0                -9.254277e-01 1 1  ON 20
 eO_1                -6.030707e-01 1 1  ON 21
 eO_2                -1.885364e-01 1 1  ON 22
 eO_3                 8.064183e-02 1 1  ON 23
 eO_4                 2.053990e-01 1 1  ON 24
 eO_5                 2.935472e-01 1 1  ON 25
 eO_6                 3.341336e-01 1 1  ON 26
 eO_7                 5.023025e-01 1 1  ON 27
 eO_8                 1.940542e-01 1 1  ON 28
 eO_9                 6.117108e-02 1 1  ON 29
eH1_0                -2.116829e-01 1 1  ON 30
eH1_1                -1.328743e-01 1 1  ON 31
eH1_2                -9.151499e-02 1 1  ON 32
eH1_3                -5.389417e-02 1 1  ON 33
eH1_4                -7.402017e-03 1 1  ON 34
eH1_5                 4.709142e-03 1 1  ON 35
eH1_6                 4.142691e-02 1 1  ON 36
eH1_7                 6.404623e-02 1 1  ON 37
eH1_8                 1.798824e-01 1 1  ON 38
eH1_9                 1.210041e-01 1 1  ON 39
eH2_0                -2.068742e-01 1 1  ON 40
eH2_1                -1.280610e-01 1 1  ON 41
eH2_2                -8.658323e-02 1 1  ON 42
eH2_3                -4.905293e-02 1 1  ON 43
eH2_4                -2.859138e-03 1 1  ON 44
eH2_5                 9.108242e-03 1 1  ON 45
eH2_6                 4.679759e-02 1 1  ON 46
eH2_7                 4.636526e-02 1 1  ON 47
eH2_8                 1.982541e-01 1 1  ON 48
eH2_9                 1.201570e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5701e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.3156
    reference variance = 0.32488
====================================================
  Execution time = 2.0926e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1769e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317786163400
                                         uncertainty =       0.003548075210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317786163400
                                         uncertainty =       0.003548075210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398551639
  error estimate for blocks of size 2^( 2) =       0.000408651709
  error estimate for blocks of size 2^( 3) =       0.000416993938
  error estimate for blocks of size 2^( 4) =       0.000423919436
  error estimate for blocks of size 2^( 5) =       0.000427812468
  error estimate for blocks of size 2^( 6) =       0.000430783419
  error estimate for blocks of size 2^( 7) =       0.000432522553

      target function =                  N/A
              le_mean =     -17.217010934910
             les_mean =     296.743152191143
             stat err =       0.000428759469
             autocorr =       1.157332771302
              std dev =       0.563637132528
             le_variance =       0.317686817164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721701093491e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217010934910       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217010924745       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217010785255       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217010772885       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217010960417       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217010977867       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217010959601       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217010946794       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.797029e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217010934910       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217010932282       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217010896128       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217010892274       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217010939945       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217010944284       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217010940271       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217010937118       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.977748e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217010934910       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217010934247       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217010925125       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217010924110       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217010936076       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217010937158       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217010936192       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217010935407       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 4.962743e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6617e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.909325e-01 1 1  ON 0
 uu_1                 2.818434e-02 1 1  ON 1
 uu_2                -6.768728e-02 1 1  ON 2
 uu_3                -1.244059e-01 1 1  ON 3
 uu_4                -1.604724e-01 1 1  ON 4
 uu_5                -1.723626e-01 1 1  ON 5
 uu_6                -1.595590e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691103e-02 1 1  ON 8
 uu_9                 1.618707e-01 1 1  ON 9
 ud_0                 3.493652e-01 1 1  ON 10
 ud_1                 9.080612e-02 1 1  ON 11
 ud_2                -1.909693e-02 1 1  ON 12
 ud_3                -8.093888e-02 1 1  ON 13
 ud_4                -1.308713e-01 1 1  ON 14
 ud_5                -1.677885e-01 1 1  ON 15
 ud_6                -1.808282e-01 1 1  ON 16
 ud_7                -1.595656e-01 1 1  ON 17
 ud_8                -9.931631e-02 1 1  ON 18
 ud_9                -8.475051e-03 1 1  ON 19
 eO_0                -9.254475e-01 1 1  ON 20
 eO_1                -6.030811e-01 1 1  ON 21
 eO_2                -1.885211e-01 1 1  ON 22
 eO_3                 8.065654e-02 1 1  ON 23
 eO_4                 2.053998e-01 1 1  ON 24
 eO_5                 2.935459e-01 1 1  ON 25
 eO_6                 3.341340e-01 1 1  ON 26
 eO_7                 5.023020e-01 1 1  ON 27
 eO_8                 1.940548e-01 1 1  ON 28
 eO_9                 6.117127e-02 1 1  ON 29
eH1_0                -2.116837e-01 1 1  ON 30
eH1_1                -1.328729e-01 1 1  ON 31
eH1_2                -9.151433e-02 1 1  ON 32
eH1_3                -5.389501e-02 1 1  ON 33
eH1_4                -7.403393e-03 1 1  ON 34
eH1_5                 4.708461e-03 1 1  ON 35
eH1_6                 4.142793e-02 1 1  ON 36
eH1_7                 6.404672e-02 1 1  ON 37
eH1_8                 1.798822e-01 1 1  ON 38
eH1_9                 1.210042e-01 1 1  ON 39
eH2_0                -2.068751e-01 1 1  ON 40
eH2_1                -1.280612e-01 1 1  ON 41
eH2_2                -8.658131e-02 1 1  ON 42
eH2_3                -4.905039e-02 1 1  ON 43
eH2_4                -2.859362e-03 1 1  ON 44
eH2_5                 9.106502e-03 1 1  ON 45
eH2_6                 4.679576e-02 1 1  ON 46
eH2_7                 4.636588e-02 1 1  ON 47
eH2_8                 1.982537e-01 1 1  ON 48
eH2_9                 1.201571e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2525
    reference variance = 0.332498
====================================================
  Execution time = 2.0484e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2270e-01
  Total weights = 2.0000e+06
  Execution time = 1.8486e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322657867155
                                         uncertainty =       0.007648343129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322657867155
                                         uncertainty =       0.007648343129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401677173
  error estimate for blocks of size 2^( 2) =       0.000411277298
  error estimate for blocks of size 2^( 3) =       0.000419473701
  error estimate for blocks of size 2^( 4) =       0.000425455912
  error estimate for blocks of size 2^( 5) =       0.000427902473
  error estimate for blocks of size 2^( 6) =       0.000430331644
  error estimate for blocks of size 2^( 7) =       0.000433309156

      target function =                  N/A
              le_mean =     -17.216934975599
             les_mean =     296.745538894697
             stat err =       0.000429249796
             autocorr =       1.141999443107
              std dev =       0.568057305244
             le_variance =       0.322689102042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713417473
                                         uncertainty =       0.007651168107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322713417473
                                         uncertainty =       0.007651168107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401711730
  error estimate for blocks of size 2^( 2) =       0.000411309625
  error estimate for blocks of size 2^( 3) =       0.000419503970
  error estimate for blocks of size 2^( 4) =       0.000425484448
  error estimate for blocks of size 2^( 5) =       0.000427930354
  error estimate for blocks of size 2^( 6) =       0.000430358658
  error estimate for blocks of size 2^( 7) =       0.000433335429

      target function =                  N/A
              le_mean =     -17.216935198198
             les_mean =     296.745602085516
             stat err =       0.000429277222
             autocorr =       1.141948882306
              std dev =       0.568106176639
             le_variance =       0.322744627936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322686231586
                                         uncertainty =       0.007649809765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322686231586
                                         uncertainty =       0.007649809765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401694818
  error estimate for blocks of size 2^( 2) =       0.000411293791
  error estimate for blocks of size 2^( 3) =       0.000419489133
  error estimate for blocks of size 2^( 4) =       0.000425470453
  error estimate for blocks of size 2^( 5) =       0.000427916678
  error estimate for blocks of size 2^( 6) =       0.000430345406
  error estimate for blocks of size 2^( 7) =       0.000433322546

      target function =                  N/A
              le_mean =     -17.216935088192
             les_mean =     296.745571123327
             stat err =       0.000429263771
             autocorr =       1.141973467393
              std dev =       0.568082259596
             le_variance =       0.322717453667

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322661428693
                                         uncertainty =       0.007648528257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322661428693
                                         uncertainty =       0.007648528257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401679388
  error estimate for blocks of size 2^( 2) =       0.000411279368
  error estimate for blocks of size 2^( 3) =       0.000419475638
  error estimate for blocks of size 2^( 4) =       0.000425457736
  error estimate for blocks of size 2^( 5) =       0.000427904255
  error estimate for blocks of size 2^( 6) =       0.000430333370
  error estimate for blocks of size 2^( 7) =       0.000433310835

      target function =                  N/A
              le_mean =     -17.216934989384
             les_mean =     296.745542929302
             stat err =       0.000429251549
             autocorr =       1.141996172545
              std dev =       0.568060438650
             le_variance =       0.322692661959


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216934975599        initial
     6.2500e+00     6.2500e+01             7.7970e-05       -17.216935198198  <--
     2.5000e+01     2.5000e+02             1.9777e-05       -17.216935088192
     1.0000e+02     1.0000e+03             4.9627e-06       -17.216934989384

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9814e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819172e-02 1 1  ON 1
 uu_2                -6.769427e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691234e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494014e-01 1 1  ON 10
 ud_1                 9.083422e-02 1 1  ON 11
 ud_2                -1.912472e-02 1 1  ON 12
 ud_3                -8.096745e-02 1 1  ON 13
 ud_4                -1.308911e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808198e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931821e-02 1 1  ON 18
 ud_9                -8.476106e-03 1 1  ON 19
 eO_0                -9.255057e-01 1 1  ON 20
 eO_1                -6.031114e-01 1 1  ON 21
 eO_2                -1.884772e-01 1 1  ON 22
 eO_3                 8.070035e-02 1 1  ON 23
 eO_4                 2.054023e-01 1 1  ON 24
 eO_5                 2.935421e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023006e-01 1 1  ON 27
 eO_8                 1.940565e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.116862e-01 1 1  ON 30
eH1_1                -1.328688e-01 1 1  ON 31
eH1_2                -9.151214e-02 1 1  ON 32
eH1_3                -5.389746e-02 1 1  ON 33
eH1_4                -7.407680e-03 1 1  ON 34
eH1_5                 4.706549e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404818e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068778e-01 1 1  ON 40
eH2_1                -1.280618e-01 1 1  ON 41
eH2_2                -8.657545e-02 1 1  ON 42
eH2_3                -4.904292e-02 1 1  ON 43
eH2_4                -2.860087e-03 1 1  ON 44
eH2_5                 9.101391e-03 1 1  ON 45
eH2_6                 4.679034e-02 1 1  ON 46
eH2_7                 4.636770e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1619
    reference variance = 0.369244
====================================================
  Execution time = 2.0366e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1493e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314942632945
                                         uncertainty =       0.004038548594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314942632945
                                         uncertainty =       0.004038548594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396816830
  error estimate for blocks of size 2^( 2) =       0.000406531158
  error estimate for blocks of size 2^( 3) =       0.000415203045
  error estimate for blocks of size 2^( 4) =       0.000421454578
  error estimate for blocks of size 2^( 5) =       0.000425320003
  error estimate for blocks of size 2^( 6) =       0.000426766652
  error estimate for blocks of size 2^( 7) =       0.000425610733

      target function =                  N/A
              le_mean =     -17.216557989130
             les_mean =     296.724796028096
             stat err =       0.000424787991
             autocorr =       1.145946376222
              std dev =       0.561183742187
             le_variance =       0.314927192495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655798913e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216557989130       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216558452159       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216559255641       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216559689382       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216559895554       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216560056841       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216560023836       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216559991600       residual = 9.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.017737e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216557989130       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216558115836       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216558346218       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216558452367       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216558475054       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216558530679       residual = 8.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216558537513       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216558533984       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 7.764277e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216557989130       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216558021573       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216558081438       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216558107771       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216558110650       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216558125488       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216558128455       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216558127941       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.954365e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045377 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6489e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.909696e-01 1 1  ON 0
 uu_1                 2.821321e-02 1 1  ON 1
 uu_2                -6.769635e-02 1 1  ON 2
 uu_3                -1.243976e-01 1 1  ON 3
 uu_4                -1.604655e-01 1 1  ON 4
 uu_5                -1.723862e-01 1 1  ON 5
 uu_6                -1.595876e-01 1 1  ON 6
 uu_7                -1.136304e-01 1 1  ON 7
 uu_8                -3.691945e-02 1 1  ON 8
 uu_9                 1.618647e-01 1 1  ON 9
 ud_0                 3.494701e-01 1 1  ON 10
 ud_1                 9.085899e-02 1 1  ON 11
 ud_2                -1.915028e-02 1 1  ON 12
 ud_3                -8.100519e-02 1 1  ON 13
 ud_4                -1.309081e-01 1 1  ON 14
 ud_5                -1.677755e-01 1 1  ON 15
 ud_6                -1.808297e-01 1 1  ON 16
 ud_7                -1.595757e-01 1 1  ON 17
 ud_8                -9.932492e-02 1 1  ON 18
 ud_9                -8.474669e-03 1 1  ON 19
 eO_0                -9.255833e-01 1 1  ON 20
 eO_1                -6.031559e-01 1 1  ON 21
 eO_2                -1.884278e-01 1 1  ON 22
 eO_3                 8.076914e-02 1 1  ON 23
 eO_4                 2.054179e-01 1 1  ON 24
 eO_5                 2.935422e-01 1 1  ON 25
 eO_6                 3.341253e-01 1 1  ON 26
 eO_7                 5.022928e-01 1 1  ON 27
 eO_8                 1.940596e-01 1 1  ON 28
 eO_9                 6.117349e-02 1 1  ON 29
eH1_0                -2.116907e-01 1 1  ON 30
eH1_1                -1.328659e-01 1 1  ON 31
eH1_2                -9.150485e-02 1 1  ON 32
eH1_3                -5.389350e-02 1 1  ON 33
eH1_4                -7.401066e-03 1 1  ON 34
eH1_5                 4.704783e-03 1 1  ON 35
eH1_6                 4.142077e-02 1 1  ON 36
eH1_7                 6.404036e-02 1 1  ON 37
eH1_8                 1.798812e-01 1 1  ON 38
eH1_9                 1.210061e-01 1 1  ON 39
eH2_0                -2.068705e-01 1 1  ON 40
eH2_1                -1.280615e-01 1 1  ON 41
eH2_2                -8.656025e-02 1 1  ON 42
eH2_3                -4.905650e-02 1 1  ON 43
eH2_4                -2.851093e-03 1 1  ON 44
eH2_5                 9.082676e-03 1 1  ON 45
eH2_6                 4.678875e-02 1 1  ON 46
eH2_7                 4.636977e-02 1 1  ON 47
eH2_8                 1.982501e-01 1 1  ON 48
eH2_9                 1.201580e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1668
    reference variance = 0.246017
====================================================
  Execution time = 2.0009e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3821e-01
  Total weights = 2.0000e+06
  Execution time = 1.8370e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338195125909
                                         uncertainty =       0.013304346089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338195125909
                                         uncertainty =       0.013304346089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411172978
  error estimate for blocks of size 2^( 2) =       0.000420406534
  error estimate for blocks of size 2^( 3) =       0.000428575606
  error estimate for blocks of size 2^( 4) =       0.000434749695
  error estimate for blocks of size 2^( 5) =       0.000438319055
  error estimate for blocks of size 2^( 6) =       0.000440033660
  error estimate for blocks of size 2^( 7) =       0.000441316689

      target function =                  N/A
              le_mean =     -17.217022963040
             les_mean =     296.764005976586
             stat err =       0.000438604775
             autocorr =       1.137882923677
              std dev =       0.581486402071
             le_variance =       0.338126435793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338497264956
                                         uncertainty =       0.013342646549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338497264956
                                         uncertainty =       0.013342646549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411356562
  error estimate for blocks of size 2^( 2) =       0.000420581611
  error estimate for blocks of size 2^( 3) =       0.000428743700
  error estimate for blocks of size 2^( 4) =       0.000434911703
  error estimate for blocks of size 2^( 5) =       0.000438475730
  error estimate for blocks of size 2^( 6) =       0.000440191900
  error estimate for blocks of size 2^( 7) =       0.000441472420

      target function =                  N/A
              le_mean =     -17.217022953743
             les_mean =     296.764307663378
             stat err =       0.000438762938
             autocorr =       1.137687568320
              std dev =       0.581746029525
             le_variance =       0.338428442868

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338365269739
                                         uncertainty =       0.013326155539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338365269739
                                         uncertainty =       0.013326155539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411276368
  error estimate for blocks of size 2^( 2) =       0.000420505090
  error estimate for blocks of size 2^( 3) =       0.000428670218
  error estimate for blocks of size 2^( 4) =       0.000434840889
  error estimate for blocks of size 2^( 5) =       0.000438407158
  error estimate for blocks of size 2^( 6) =       0.000440122546
  error estimate for blocks of size 2^( 7) =       0.000441404310

      target function =                  N/A
              le_mean =     -17.217022917349
             les_mean =     296.764174469852
             stat err =       0.000438693726
             autocorr =       1.137772240961
              std dev =       0.581632618130
             le_variance =       0.338296502473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338217072406
                                         uncertainty =       0.013307169413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338217072406
                                         uncertainty =       0.013307169413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411186316
  error estimate for blocks of size 2^( 2) =       0.000420419243
  error estimate for blocks of size 2^( 3) =       0.000428587803
  error estimate for blocks of size 2^( 4) =       0.000434761450
  error estimate for blocks of size 2^( 5) =       0.000438330407
  error estimate for blocks of size 2^( 6) =       0.000440045108
  error estimate for blocks of size 2^( 7) =       0.000441327979

      target function =                  N/A
              le_mean =     -17.217022950719
             les_mean =     296.764027488724
             stat err =       0.000438616236
             autocorr =       1.137868570706
              std dev =       0.581505264123
             le_variance =       0.338148372203


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217022963040        initial  <--
     1.5625e+00     1.5625e+01             3.0177e-04       -17.217022953743
     6.2500e+00     6.2500e+01             7.7643e-05       -17.217022917349
     2.5000e+01     2.5000e+02             1.9544e-05       -17.217022950719

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.9566
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819172e-02 1 1  ON 1
 uu_2                -6.769427e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691234e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494014e-01 1 1  ON 10
 ud_1                 9.083422e-02 1 1  ON 11
 ud_2                -1.912472e-02 1 1  ON 12
 ud_3                -8.096745e-02 1 1  ON 13
 ud_4                -1.308911e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808198e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931821e-02 1 1  ON 18
 ud_9                -8.476106e-03 1 1  ON 19
 eO_0                -9.255057e-01 1 1  ON 20
 eO_1                -6.031114e-01 1 1  ON 21
 eO_2                -1.884772e-01 1 1  ON 22
 eO_3                 8.070035e-02 1 1  ON 23
 eO_4                 2.054023e-01 1 1  ON 24
 eO_5                 2.935421e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023006e-01 1 1  ON 27
 eO_8                 1.940565e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.116862e-01 1 1  ON 30
eH1_1                -1.328688e-01 1 1  ON 31
eH1_2                -9.151214e-02 1 1  ON 32
eH1_3                -5.389746e-02 1 1  ON 33
eH1_4                -7.407680e-03 1 1  ON 34
eH1_5                 4.706549e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404818e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068778e-01 1 1  ON 40
eH2_1                -1.280618e-01 1 1  ON 41
eH2_2                -8.657545e-02 1 1  ON 42
eH2_3                -4.904292e-02 1 1  ON 43
eH2_4                -2.860087e-03 1 1  ON 44
eH2_5                 9.101391e-03 1 1  ON 45
eH2_6                 4.679034e-02 1 1  ON 46
eH2_7                 4.636770e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8461e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1603
    reference variance = 0.303341
====================================================
  Execution time = 2.0968e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2347e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323492183184
                                         uncertainty =       0.005816486853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323492183184
                                         uncertainty =       0.005816486853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402165437
  error estimate for blocks of size 2^( 2) =       0.000411931468
  error estimate for blocks of size 2^( 3) =       0.000420449986
  error estimate for blocks of size 2^( 4) =       0.000426888526
  error estimate for blocks of size 2^( 5) =       0.000430809275
  error estimate for blocks of size 2^( 6) =       0.000433434411
  error estimate for blocks of size 2^( 7) =       0.000434799815

      target function =                  N/A
              le_mean =     -17.217465756079
             les_mean =     296.764600976985
             stat err =       0.000431483007
             autocorr =       1.151112860495
              std dev =       0.568747814903
             le_variance =       0.323474076957


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721746575608e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217465756079       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217465690964       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217465671761       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217465712989       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217465838816       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217465871428       residual = 9.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217465865287       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217465865052       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 4.193685e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217465756079       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217465739626       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217465734677       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217465744953       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217465776865       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217465785027       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217465783492       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217465783479       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.055916e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217465756079       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217465751955       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217465750708       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217465753275       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217465761282       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217465763323       residual = 8.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217465762939       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217465762939       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.644553e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6466e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.909325e-01 1 1  ON 0
 uu_1                 2.819286e-02 1 1  ON 1
 uu_2                -6.769495e-02 1 1  ON 2
 uu_3                -1.244048e-01 1 1  ON 3
 uu_4                -1.604589e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595629e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691191e-02 1 1  ON 8
 uu_9                 1.618668e-01 1 1  ON 9
 ud_0                 3.494083e-01 1 1  ON 10
 ud_1                 9.083770e-02 1 1  ON 11
 ud_2                -1.912769e-02 1 1  ON 12
 ud_3                -8.097135e-02 1 1  ON 13
 ud_4                -1.308949e-01 1 1  ON 14
 ud_5                -1.677897e-01 1 1  ON 15
 ud_6                -1.808192e-01 1 1  ON 16
 ud_7                -1.595588e-01 1 1  ON 17
 ud_8                -9.931884e-02 1 1  ON 18
 ud_9                -8.476177e-03 1 1  ON 19
 eO_0                -9.255162e-01 1 1  ON 20
 eO_1                -6.031139e-01 1 1  ON 21
 eO_2                -1.884718e-01 1 1  ON 22
 eO_3                 8.070670e-02 1 1  ON 23
 eO_4                 2.054050e-01 1 1  ON 24
 eO_5                 2.935412e-01 1 1  ON 25
 eO_6                 3.341343e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940569e-01 1 1  ON 28
 eO_9                 6.117190e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328713e-01 1 1  ON 31
eH1_2                -9.151085e-02 1 1  ON 32
eH1_3                -5.389629e-02 1 1  ON 33
eH1_4                -7.407355e-03 1 1  ON 34
eH1_5                 4.708452e-03 1 1  ON 35
eH1_6                 4.143024e-02 1 1  ON 36
eH1_7                 6.404717e-02 1 1  ON 37
eH1_8                 1.798813e-01 1 1  ON 38
eH1_9                 1.210048e-01 1 1  ON 39
eH2_0                -2.068785e-01 1 1  ON 40
eH2_1                -1.280634e-01 1 1  ON 41
eH2_2                -8.657486e-02 1 1  ON 42
eH2_3                -4.904301e-02 1 1  ON 43
eH2_4                -2.859885e-03 1 1  ON 44
eH2_5                 9.102948e-03 1 1  ON 45
eH2_6                 4.678975e-02 1 1  ON 46
eH2_7                 4.636805e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201574e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2129
    reference variance = 0.130139
====================================================
  Execution time = 2.0557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3833e-01
  Total weights = 2.0000e+06
  Execution time = 1.8467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338465637331
                                         uncertainty =       0.012954414366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338465637331
                                         uncertainty =       0.012954414366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411293690
  error estimate for blocks of size 2^( 2) =       0.000420267252
  error estimate for blocks of size 2^( 3) =       0.000428941382
  error estimate for blocks of size 2^( 4) =       0.000435162691
  error estimate for blocks of size 2^( 5) =       0.000438529481
  error estimate for blocks of size 2^( 6) =       0.000440430542
  error estimate for blocks of size 2^( 7) =       0.000440255755

      target function =                  N/A
              le_mean =     -17.216869018052
             les_mean =     296.758903614669
             stat err =       0.000438594617
             autocorr =       1.137162426173
              std dev =       0.581657114703
             le_variance =       0.338324999085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338490339782
                                         uncertainty =       0.012954142560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338490339782
                                         uncertainty =       0.012954142560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411308702
  error estimate for blocks of size 2^( 2) =       0.000420281290
  error estimate for blocks of size 2^( 3) =       0.000428954436
  error estimate for blocks of size 2^( 4) =       0.000435175161
  error estimate for blocks of size 2^( 5) =       0.000438541519
  error estimate for blocks of size 2^( 6) =       0.000440442289
  error estimate for blocks of size 2^( 7) =       0.000440267206

      target function =                  N/A
              le_mean =     -17.216869015105
             les_mean =     296.758928210799
             stat err =       0.000438606544
             autocorr =       1.137141259276
              std dev =       0.581678344710
             le_variance =       0.338349696704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338478119363
                                         uncertainty =       0.012954273701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338478119363
                                         uncertainty =       0.012954273701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411301276
  error estimate for blocks of size 2^( 2) =       0.000420274343
  error estimate for blocks of size 2^( 3) =       0.000428947975
  error estimate for blocks of size 2^( 4) =       0.000435168989
  error estimate for blocks of size 2^( 5) =       0.000438535562
  error estimate for blocks of size 2^( 6) =       0.000440436478
  error estimate for blocks of size 2^( 7) =       0.000440261543

      target function =                  N/A
              le_mean =     -17.216869016738
             les_mean =     296.758916049069
             stat err =       0.000438600643
             autocorr =       1.137151726116
              std dev =       0.581667842252
             le_variance =       0.338337478711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338467201413
                                         uncertainty =       0.012954396627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338467201413
                                         uncertainty =       0.012954396627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411294641
  error estimate for blocks of size 2^( 2) =       0.000420268141
  error estimate for blocks of size 2^( 3) =       0.000428942208
  error estimate for blocks of size 2^( 4) =       0.000435163480
  error estimate for blocks of size 2^( 5) =       0.000438530243
  error estimate for blocks of size 2^( 6) =       0.000440431286
  error estimate for blocks of size 2^( 7) =       0.000440256480

      target function =                  N/A
              le_mean =     -17.216869017849
             les_mean =     296.758905171468
             stat err =       0.000438595372
             autocorr =       1.137161084755
              std dev =       0.581658458948
             le_variance =       0.338326562866


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216869018052        initial  <--
     1.5625e+01     1.5625e+02             4.1937e-05       -17.216869015105
     6.2500e+01     6.2500e+02             1.0559e-05       -17.216869016738
     2.5000e+02     2.5000e+03             2.6446e-06       -17.216869017849

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8710
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819172e-02 1 1  ON 1
 uu_2                -6.769427e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691234e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494014e-01 1 1  ON 10
 ud_1                 9.083422e-02 1 1  ON 11
 ud_2                -1.912472e-02 1 1  ON 12
 ud_3                -8.096745e-02 1 1  ON 13
 ud_4                -1.308911e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808198e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931821e-02 1 1  ON 18
 ud_9                -8.476106e-03 1 1  ON 19
 eO_0                -9.255057e-01 1 1  ON 20
 eO_1                -6.031114e-01 1 1  ON 21
 eO_2                -1.884772e-01 1 1  ON 22
 eO_3                 8.070035e-02 1 1  ON 23
 eO_4                 2.054023e-01 1 1  ON 24
 eO_5                 2.935421e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023006e-01 1 1  ON 27
 eO_8                 1.940565e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.116862e-01 1 1  ON 30
eH1_1                -1.328688e-01 1 1  ON 31
eH1_2                -9.151214e-02 1 1  ON 32
eH1_3                -5.389746e-02 1 1  ON 33
eH1_4                -7.407680e-03 1 1  ON 34
eH1_5                 4.706549e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404818e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068778e-01 1 1  ON 40
eH2_1                -1.280618e-01 1 1  ON 41
eH2_2                -8.657545e-02 1 1  ON 42
eH2_3                -4.904292e-02 1 1  ON 43
eH2_4                -2.860087e-03 1 1  ON 44
eH2_5                 9.101391e-03 1 1  ON 45
eH2_6                 4.679034e-02 1 1  ON 46
eH2_7                 4.636770e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6343e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1872
    reference variance = 0.188432
====================================================
  Execution time = 2.1316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1838e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318411701812
                                         uncertainty =       0.003096168804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318411701812
                                         uncertainty =       0.003096168804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398984712
  error estimate for blocks of size 2^( 2) =       0.000408592695
  error estimate for blocks of size 2^( 3) =       0.000416840789
  error estimate for blocks of size 2^( 4) =       0.000423179715
  error estimate for blocks of size 2^( 5) =       0.000427182923
  error estimate for blocks of size 2^( 6) =       0.000430133820
  error estimate for blocks of size 2^( 7) =       0.000431188422

      target function =                  N/A
              le_mean =     -17.217327968450
             les_mean =     296.754759814320
             stat err =       0.000427921220
             autocorr =       1.150310639301
              std dev =       0.564249590465
             le_variance =       0.318377600339


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721732796845e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217327968450       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217327979197       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217327991130       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217327993829       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217328000182       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217328002379       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217328001326       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217328001799       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.710210e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217327968450       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217327971140       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217327974128       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217327974806       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217327976400       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217327976948       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217327976685       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217327976803       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 9.284251e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217327968450       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217327969123       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217327969870       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217327970040       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217327970438       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217327970577       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217327970510       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217327970540       residual = 1.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.321609e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050571 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6859e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.909337e-01 1 1  ON 0
 uu_1                 2.819180e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244054e-01 1 1  ON 3
 uu_4                -1.604596e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595618e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691227e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494017e-01 1 1  ON 10
 ud_1                 9.083456e-02 1 1  ON 11
 ud_2                -1.912499e-02 1 1  ON 12
 ud_3                -8.096779e-02 1 1  ON 13
 ud_4                -1.308914e-01 1 1  ON 14
 ud_5                -1.677898e-01 1 1  ON 15
 ud_6                -1.808197e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931820e-02 1 1  ON 18
 ud_9                -8.476091e-03 1 1  ON 19
 eO_0                -9.255066e-01 1 1  ON 20
 eO_1                -6.031115e-01 1 1  ON 21
 eO_2                -1.884768e-01 1 1  ON 22
 eO_3                 8.070087e-02 1 1  ON 23
 eO_4                 2.054025e-01 1 1  ON 24
 eO_5                 2.935420e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023006e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117183e-02 1 1  ON 29
eH1_0                -2.116862e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151219e-02 1 1  ON 32
eH1_3                -5.389730e-02 1 1  ON 33
eH1_4                -7.407925e-03 1 1  ON 34
eH1_5                 4.706624e-03 1 1  ON 35
eH1_6                 4.143106e-02 1 1  ON 36
eH1_7                 6.404812e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280619e-01 1 1  ON 41
eH2_2                -8.657547e-02 1 1  ON 42
eH2_3                -4.904277e-02 1 1  ON 43
eH2_4                -2.860093e-03 1 1  ON 44
eH2_5                 9.101447e-03 1 1  ON 45
eH2_6                 4.679038e-02 1 1  ON 46
eH2_7                 4.636776e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.3085
    reference variance = 0.336374
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2863e-01
  Total weights = 2.0000e+06
  Execution time = 1.8478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315915939778
                                         uncertainty =       0.003567183533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315915939778
                                         uncertainty =       0.003567183533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405357382
  error estimate for blocks of size 2^( 2) =       0.000414404788
  error estimate for blocks of size 2^( 3) =       0.000422883980
  error estimate for blocks of size 2^( 4) =       0.000428814120
  error estimate for blocks of size 2^( 5) =       0.000433830164
  error estimate for blocks of size 2^( 6) =       0.000435871100
  error estimate for blocks of size 2^( 7) =       0.000435734992

      target function =                  N/A
              le_mean =     -17.217194894437
             les_mean =     296.760429082891
             stat err =       0.000433562594
             autocorr =       1.144003727177
              std dev =       0.573261907127
             le_variance =       0.328629214163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315917385616
                                         uncertainty =       0.003567189845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315917385616
                                         uncertainty =       0.003567189845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405358441
  error estimate for blocks of size 2^( 2) =       0.000414405780
  error estimate for blocks of size 2^( 3) =       0.000422884897
  error estimate for blocks of size 2^( 4) =       0.000428815010
  error estimate for blocks of size 2^( 5) =       0.000433831057
  error estimate for blocks of size 2^( 6) =       0.000435872016
  error estimate for blocks of size 2^( 7) =       0.000435735919

      target function =                  N/A
              le_mean =     -17.217194894266
             les_mean =     296.760430793707
             stat err =       0.000433563501
             autocorr =       1.144002534891
              std dev =       0.573263404461
             le_variance =       0.328630930894

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315916662982
                                         uncertainty =       0.003567186688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315916662982
                                         uncertainty =       0.003567186688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405357912
  error estimate for blocks of size 2^( 2) =       0.000414405284
  error estimate for blocks of size 2^( 3) =       0.000422884439
  error estimate for blocks of size 2^( 4) =       0.000428814565
  error estimate for blocks of size 2^( 5) =       0.000433830611
  error estimate for blocks of size 2^( 6) =       0.000435871558
  error estimate for blocks of size 2^( 7) =       0.000435735456

      target function =                  N/A
              le_mean =     -17.217194894354
             les_mean =     296.760429938880
             stat err =       0.000433563047
             autocorr =       1.144003130497
              std dev =       0.573262656217
             le_variance =       0.328630073013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315916030184
                                         uncertainty =       0.003567183928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315916030184
                                         uncertainty =       0.003567183928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405357448
  error estimate for blocks of size 2^( 2) =       0.000414404850
  error estimate for blocks of size 2^( 3) =       0.000422884037
  error estimate for blocks of size 2^( 4) =       0.000428814176
  error estimate for blocks of size 2^( 5) =       0.000433830220
  error estimate for blocks of size 2^( 6) =       0.000435871157
  error estimate for blocks of size 2^( 7) =       0.000435735050

      target function =                  N/A
              le_mean =     -17.217194894427
             les_mean =     296.760429189893
             stat err =       0.000433562651
             autocorr =       1.144003652571
              std dev =       0.573262000774
             le_variance =       0.328629321532


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217194894437        initial  <--
     1.5625e+02     1.5625e+03             3.7102e-06       -17.217194894266
     6.2500e+02     6.2500e+03             9.2843e-07       -17.217194894354
     2.5000e+03     2.5000e+04             2.3216e-07       -17.217194894427

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7014
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819172e-02 1 1  ON 1
 uu_2                -6.769427e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691234e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494014e-01 1 1  ON 10
 ud_1                 9.083422e-02 1 1  ON 11
 ud_2                -1.912472e-02 1 1  ON 12
 ud_3                -8.096745e-02 1 1  ON 13
 ud_4                -1.308911e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808198e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931821e-02 1 1  ON 18
 ud_9                -8.476106e-03 1 1  ON 19
 eO_0                -9.255057e-01 1 1  ON 20
 eO_1                -6.031114e-01 1 1  ON 21
 eO_2                -1.884772e-01 1 1  ON 22
 eO_3                 8.070035e-02 1 1  ON 23
 eO_4                 2.054023e-01 1 1  ON 24
 eO_5                 2.935421e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023006e-01 1 1  ON 27
 eO_8                 1.940565e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.116862e-01 1 1  ON 30
eH1_1                -1.328688e-01 1 1  ON 31
eH1_2                -9.151214e-02 1 1  ON 32
eH1_3                -5.389746e-02 1 1  ON 33
eH1_4                -7.407680e-03 1 1  ON 34
eH1_5                 4.706549e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404818e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068778e-01 1 1  ON 40
eH2_1                -1.280618e-01 1 1  ON 41
eH2_2                -8.657545e-02 1 1  ON 42
eH2_3                -4.904292e-02 1 1  ON 43
eH2_4                -2.860087e-03 1 1  ON 44
eH2_5                 9.101391e-03 1 1  ON 45
eH2_6                 4.679034e-02 1 1  ON 46
eH2_7                 4.636770e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6566e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2474
    reference variance = 0.220611
====================================================
  Execution time = 2.0787e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2352e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323511751157
                                         uncertainty =       0.003620437533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323511751157
                                         uncertainty =       0.003620437533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402195716
  error estimate for blocks of size 2^( 2) =       0.000411900808
  error estimate for blocks of size 2^( 3) =       0.000420945822
  error estimate for blocks of size 2^( 4) =       0.000427221278
  error estimate for blocks of size 2^( 5) =       0.000431358274
  error estimate for blocks of size 2^( 6) =       0.000433269241
  error estimate for blocks of size 2^( 7) =       0.000434771910

      target function =                  N/A
              le_mean =     -17.216383707713
             les_mean =     296.727390597867
             stat err =       0.000431655176
             autocorr =       1.151858214189
              std dev =       0.568790636720
             le_variance =       0.323522788420


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638370771e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383707713       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383707683       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383708349       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383708573       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383707906       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383707997       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383708241       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216383708251       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.204415e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383707713       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383707706       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383707872       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383707929       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383707768       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383707783       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383707845       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216383707845       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 8.011216e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216383707713       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216383707711       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216383707753       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216383707767       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216383707737       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216383707724       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216383707791       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216383707752       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.002815e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.053177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6317e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819174e-02 1 1  ON 1
 uu_2                -6.769427e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691233e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494014e-01 1 1  ON 10
 ud_1                 9.083426e-02 1 1  ON 11
 ud_2                -1.912476e-02 1 1  ON 12
 ud_3                -8.096749e-02 1 1  ON 13
 ud_4                -1.308911e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808197e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931822e-02 1 1  ON 18
 ud_9                -8.476106e-03 1 1  ON 19
 eO_0                -9.255058e-01 1 1  ON 20
 eO_1                -6.031115e-01 1 1  ON 21
 eO_2                -1.884771e-01 1 1  ON 22
 eO_3                 8.070042e-02 1 1  ON 23
 eO_4                 2.054023e-01 1 1  ON 24
 eO_5                 2.935421e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023006e-01 1 1  ON 27
 eO_8                 1.940565e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.116863e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151214e-02 1 1  ON 32
eH1_3                -5.389748e-02 1 1  ON 33
eH1_4                -7.407663e-03 1 1  ON 34
eH1_5                 4.706563e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404817e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068778e-01 1 1  ON 40
eH2_1                -1.280618e-01 1 1  ON 41
eH2_2                -8.657546e-02 1 1  ON 42
eH2_3                -4.904292e-02 1 1  ON 43
eH2_4                -2.860084e-03 1 1  ON 44
eH2_5                 9.101377e-03 1 1  ON 45
eH2_6                 4.679034e-02 1 1  ON 46
eH2_7                 4.636771e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.315
    reference variance = 0.248562
====================================================
  Execution time = 1.9948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.0000e+06
  Execution time = 1.8433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528652773
                                         uncertainty =       0.003769021702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528652773
                                         uncertainty =       0.003769021702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397125749
  error estimate for blocks of size 2^( 2) =       0.000406803015
  error estimate for blocks of size 2^( 3) =       0.000415813493
  error estimate for blocks of size 2^( 4) =       0.000421897351
  error estimate for blocks of size 2^( 5) =       0.000425244730
  error estimate for blocks of size 2^( 6) =       0.000427029869
  error estimate for blocks of size 2^( 7) =       0.000426764620

      target function =                  N/A
              le_mean =     -17.217205229576
             les_mean =     296.747573480665
             stat err =       0.000425234142
             autocorr =       1.146568907415
              std dev =       0.561620620199
             le_variance =       0.315417721033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528897921
                                         uncertainty =       0.003769023826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528897921
                                         uncertainty =       0.003769023826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397125903
  error estimate for blocks of size 2^( 2) =       0.000406803162
  error estimate for blocks of size 2^( 3) =       0.000415813628
  error estimate for blocks of size 2^( 4) =       0.000421897475
  error estimate for blocks of size 2^( 5) =       0.000425244848
  error estimate for blocks of size 2^( 6) =       0.000427029989
  error estimate for blocks of size 2^( 7) =       0.000426764740

      target function =                  N/A
              le_mean =     -17.217205229616
             les_mean =     296.747573727156
             stat err =       0.000425234263
             autocorr =       1.146568666326
              std dev =       0.561620838414
             le_variance =       0.315417966141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528775358
                                         uncertainty =       0.003769022764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528775358
                                         uncertainty =       0.003769022764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397125826
  error estimate for blocks of size 2^( 2) =       0.000406803088
  error estimate for blocks of size 2^( 3) =       0.000415813560
  error estimate for blocks of size 2^( 4) =       0.000421897413
  error estimate for blocks of size 2^( 5) =       0.000425244789
  error estimate for blocks of size 2^( 6) =       0.000427029929
  error estimate for blocks of size 2^( 7) =       0.000426764680

      target function =                  N/A
              le_mean =     -17.217205229596
             les_mean =     296.747573603919
             stat err =       0.000425234203
             autocorr =       1.146568786851
              std dev =       0.561620729316
             le_variance =       0.315417843598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528668096
                                         uncertainty =       0.003769021835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315528668096
                                         uncertainty =       0.003769021835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397125759
  error estimate for blocks of size 2^( 2) =       0.000406803024
  error estimate for blocks of size 2^( 3) =       0.000415813501
  error estimate for blocks of size 2^( 4) =       0.000421897359
  error estimate for blocks of size 2^( 5) =       0.000425244737
  error estimate for blocks of size 2^( 6) =       0.000427029876
  error estimate for blocks of size 2^( 7) =       0.000426764628

      target function =                  N/A
              le_mean =     -17.217205229579
             les_mean =     296.747573496072
             stat err =       0.000425234150
             autocorr =       1.146568892337
              std dev =       0.561620633839
             le_variance =       0.315417736354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217205229576        initial
     1.5625e+03     1.5625e+04             3.2044e-07       -17.217205229616  <--
     6.2500e+03     6.2500e+04             8.0112e-08       -17.217205229596
     2.5000e+04     2.5000e+05             2.0028e-08       -17.217205229579

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.9238e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819180e-02 1 1  ON 1
 uu_2                -6.769425e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723730e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691232e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494016e-01 1 1  ON 10
 ud_1                 9.083436e-02 1 1  ON 11
 ud_2                -1.912487e-02 1 1  ON 12
 ud_3                -8.096761e-02 1 1  ON 13
 ud_4                -1.308912e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808197e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931823e-02 1 1  ON 18
 ud_9                -8.476106e-03 1 1  ON 19
 eO_0                -9.255060e-01 1 1  ON 20
 eO_1                -6.031116e-01 1 1  ON 21
 eO_2                -1.884770e-01 1 1  ON 22
 eO_3                 8.070063e-02 1 1  ON 23
 eO_4                 2.054024e-01 1 1  ON 24
 eO_5                 2.935420e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023006e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.116863e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151212e-02 1 1  ON 32
eH1_3                -5.389751e-02 1 1  ON 33
eH1_4                -7.407610e-03 1 1  ON 34
eH1_5                 4.706606e-03 1 1  ON 35
eH1_6                 4.143098e-02 1 1  ON 36
eH1_7                 6.404816e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068778e-01 1 1  ON 40
eH2_1                -1.280618e-01 1 1  ON 41
eH2_2                -8.657549e-02 1 1  ON 42
eH2_3                -4.904292e-02 1 1  ON 43
eH2_4                -2.860075e-03 1 1  ON 44
eH2_5                 9.101336e-03 1 1  ON 45
eH2_6                 4.679033e-02 1 1  ON 46
eH2_7                 4.636773e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1971
    reference variance = 0.387743
====================================================
  Execution time = 2.0385e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3265e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5511e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332638085019
                                         uncertainty =       0.013526470146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332638085019
                                         uncertainty =       0.013526470146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407831538
  error estimate for blocks of size 2^( 2) =       0.000417140637
  error estimate for blocks of size 2^( 3) =       0.000425512843
  error estimate for blocks of size 2^( 4) =       0.000430768956
  error estimate for blocks of size 2^( 5) =       0.000435706059
  error estimate for blocks of size 2^( 6) =       0.000438541301
  error estimate for blocks of size 2^( 7) =       0.000439643914

      target function =                  N/A
              le_mean =     -17.216978803747
             les_mean =     296.757012089296
             stat err =       0.000436165057
             autocorr =       1.143773750649
              std dev =       0.576760892368
             le_variance =       0.332653126966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721697880375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216978803747       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216978806087       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216978807132       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216978807769       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216978807981       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216978809233       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216978809420       residual = 8.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.582594e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216978803747       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216978804332       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216978804593       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216978804753       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216978804807       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216978805119       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216978805169       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.957688e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216978803747       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216978803893       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216978803958       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216978803998       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216978804008       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216978804098       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216978804093       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 9.894971e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055398 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5941e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819181e-02 1 1  ON 1
 uu_2                -6.769424e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604597e-01 1 1  ON 4
 uu_5                -1.723730e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136124e-01 1 1  ON 7
 uu_8                -3.691233e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494018e-01 1 1  ON 10
 ud_1                 9.083441e-02 1 1  ON 11
 ud_2                -1.912496e-02 1 1  ON 12
 ud_3                -8.096775e-02 1 1  ON 13
 ud_4                -1.308913e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808197e-01 1 1  ON 16
 ud_7                -1.595588e-01 1 1  ON 17
 ud_8                -9.931827e-02 1 1  ON 18
 ud_9                -8.476114e-03 1 1  ON 19
 eO_0                -9.255064e-01 1 1  ON 20
 eO_1                -6.031118e-01 1 1  ON 21
 eO_2                -1.884768e-01 1 1  ON 22
 eO_3                 8.070091e-02 1 1  ON 23
 eO_4                 2.054025e-01 1 1  ON 24
 eO_5                 2.935420e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117182e-02 1 1  ON 29
eH1_0                -2.116863e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151208e-02 1 1  ON 32
eH1_3                -5.389745e-02 1 1  ON 33
eH1_4                -7.407663e-03 1 1  ON 34
eH1_5                 4.706632e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404815e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068779e-01 1 1  ON 40
eH2_1                -1.280617e-01 1 1  ON 41
eH2_2                -8.657550e-02 1 1  ON 42
eH2_3                -4.904290e-02 1 1  ON 43
eH2_4                -2.860083e-03 1 1  ON 44
eH2_5                 9.101310e-03 1 1  ON 45
eH2_6                 4.679033e-02 1 1  ON 46
eH2_7                 4.636774e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3074
    reference variance = 0.701593
====================================================
  Execution time = 1.9959e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1794e-01
  Total weights = 2.0000e+06
  Execution time = 1.8418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317713036845
                                         uncertainty =       0.003784577039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317713036845
                                         uncertainty =       0.003784577039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398710083
  error estimate for blocks of size 2^( 2) =       0.000408525682
  error estimate for blocks of size 2^( 3) =       0.000417168747
  error estimate for blocks of size 2^( 4) =       0.000423148889
  error estimate for blocks of size 2^( 5) =       0.000426662484
  error estimate for blocks of size 2^( 6) =       0.000428090522
  error estimate for blocks of size 2^( 7) =       0.000428872999

      target function =                  N/A
              le_mean =     -17.217245555643
             les_mean =     296.751483825579
             stat err =       0.000426693724
             autocorr =       1.145296863582
              std dev =       0.563861207418
             le_variance =       0.317939461231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317714045176
                                         uncertainty =       0.003784602391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317714045176
                                         uncertainty =       0.003784602391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398710716
  error estimate for blocks of size 2^( 2) =       0.000408526279
  error estimate for blocks of size 2^( 3) =       0.000417169309
  error estimate for blocks of size 2^( 4) =       0.000423149426
  error estimate for blocks of size 2^( 5) =       0.000426663003
  error estimate for blocks of size 2^( 6) =       0.000428091014
  error estimate for blocks of size 2^( 7) =       0.000428873488

      target function =                  N/A
              le_mean =     -17.217245557482
             les_mean =     296.751484897928
             stat err =       0.000426694233
             autocorr =       1.145295961844
              std dev =       0.563862102155
             le_variance =       0.317940470247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317713541290
                                         uncertainty =       0.003784589723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317713541290
                                         uncertainty =       0.003784589723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398710400
  error estimate for blocks of size 2^( 2) =       0.000408525981
  error estimate for blocks of size 2^( 3) =       0.000417169028
  error estimate for blocks of size 2^( 4) =       0.000423149158
  error estimate for blocks of size 2^( 5) =       0.000426662744
  error estimate for blocks of size 2^( 6) =       0.000428090768
  error estimate for blocks of size 2^( 7) =       0.000428873244

      target function =                  N/A
              le_mean =     -17.217245556563
             les_mean =     296.751484362035
             stat err =       0.000426693978
             autocorr =       1.145296412432
              std dev =       0.563861655035
             le_variance =       0.317939966019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317713099909
                                         uncertainty =       0.003784578625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317713099909
                                         uncertainty =       0.003784578625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398710123
  error estimate for blocks of size 2^( 2) =       0.000408525720
  error estimate for blocks of size 2^( 3) =       0.000417168782
  error estimate for blocks of size 2^( 4) =       0.000423148923
  error estimate for blocks of size 2^( 5) =       0.000426662517
  error estimate for blocks of size 2^( 6) =       0.000428090553
  error estimate for blocks of size 2^( 7) =       0.000428873030

      target function =                  N/A
              le_mean =     -17.217245555758
             les_mean =     296.751483892643
             stat err =       0.000426693756
             autocorr =       1.145296807180
              std dev =       0.563861263378
             le_variance =       0.317939524338


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217245555643        initial
     3.9062e+02     3.9062e+03             1.5826e-06       -17.217245557482  <--
     1.5625e+03     1.5625e+04             3.9577e-07       -17.217245556563
     6.2500e+03     6.2500e+04             9.8950e-08       -17.217245555758

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9268e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819184e-02 1 1  ON 1
 uu_2                -6.769421e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604597e-01 1 1  ON 4
 uu_5                -1.723730e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691236e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494026e-01 1 1  ON 10
 ud_1                 9.083458e-02 1 1  ON 11
 ud_2                -1.912524e-02 1 1  ON 12
 ud_3                -8.096814e-02 1 1  ON 13
 ud_4                -1.308916e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595588e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476138e-03 1 1  ON 19
 eO_0                -9.255076e-01 1 1  ON 20
 eO_1                -6.031121e-01 1 1  ON 21
 eO_2                -1.884763e-01 1 1  ON 22
 eO_3                 8.070176e-02 1 1  ON 23
 eO_4                 2.054027e-01 1 1  ON 24
 eO_5                 2.935419e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117183e-02 1 1  ON 29
eH1_0                -2.116865e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151197e-02 1 1  ON 32
eH1_3                -5.389725e-02 1 1  ON 33
eH1_4                -7.407821e-03 1 1  ON 34
eH1_5                 4.706712e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404809e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657553e-02 1 1  ON 42
eH2_3                -4.904285e-02 1 1  ON 43
eH2_4                -2.860106e-03 1 1  ON 44
eH2_5                 9.101230e-03 1 1  ON 45
eH2_6                 4.679032e-02 1 1  ON 46
eH2_7                 4.636776e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1377
    reference variance = 0.251693
====================================================
  Execution time = 2.1197e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1220e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312230832344
                                         uncertainty =       0.002796656993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312230832344
                                         uncertainty =       0.002796656993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395094403
  error estimate for blocks of size 2^( 2) =       0.000404582413
  error estimate for blocks of size 2^( 3) =       0.000413351490
  error estimate for blocks of size 2^( 4) =       0.000419959288
  error estimate for blocks of size 2^( 5) =       0.000423486458
  error estimate for blocks of size 2^( 6) =       0.000425288260
  error estimate for blocks of size 2^( 7) =       0.000426369953

      target function =                  N/A
              le_mean =     -17.216776207264
             les_mean =     296.729581989455
             stat err =       0.000423775990
             autocorr =       1.150458451159
              std dev =       0.558747863121
             le_variance =       0.312199174543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677620726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776207264       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776213177       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776223751       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776227113       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776225939       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776228007       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776231130       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216776230314       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 6.343562e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776207264       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776208745       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776211393       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776212235       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776211938       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776212458       residual = 8.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776213238       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216776213034       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.587368e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776207264       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776207635       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776208297       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776208508       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776208433       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776208566       residual = 8.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776208754       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216776208708       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.969345e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6727e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.909344e-01 1 1  ON 0
 uu_1                 2.819200e-02 1 1  ON 1
 uu_2                -6.769466e-02 1 1  ON 2
 uu_3                -1.244059e-01 1 1  ON 3
 uu_4                -1.604599e-01 1 1  ON 4
 uu_5                -1.723729e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691228e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494033e-01 1 1  ON 10
 ud_1                 9.083523e-02 1 1  ON 11
 ud_2                -1.912576e-02 1 1  ON 12
 ud_3                -8.096878e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677898e-01 1 1  ON 15
 ud_6                -1.808193e-01 1 1  ON 16
 ud_7                -1.595588e-01 1 1  ON 17
 ud_8                -9.931850e-02 1 1  ON 18
 ud_9                -8.476167e-03 1 1  ON 19
 eO_0                -9.255092e-01 1 1  ON 20
 eO_1                -6.031127e-01 1 1  ON 21
 eO_2                -1.884750e-01 1 1  ON 22
 eO_3                 8.070265e-02 1 1  ON 23
 eO_4                 2.054030e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341351e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151188e-02 1 1  ON 32
eH1_3                -5.389710e-02 1 1  ON 33
eH1_4                -7.407844e-03 1 1  ON 34
eH1_5                 4.706682e-03 1 1  ON 35
eH1_6                 4.143092e-02 1 1  ON 36
eH1_7                 6.404804e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657578e-02 1 1  ON 42
eH2_3                -4.904277e-02 1 1  ON 43
eH2_4                -2.860081e-03 1 1  ON 44
eH2_5                 9.101263e-03 1 1  ON 45
eH2_6                 4.679045e-02 1 1  ON 46
eH2_7                 4.636782e-02 1 1  ON 47
eH2_8                 1.982523e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.218
    reference variance = 0.304852
====================================================
  Execution time = 2.1975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1353e-01
  Total weights = 2.0000e+06
  Execution time = 1.8403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313611279500
                                         uncertainty =       0.002756230029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313611279500
                                         uncertainty =       0.002756230029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395932103
  error estimate for blocks of size 2^( 2) =       0.000405620239
  error estimate for blocks of size 2^( 3) =       0.000414141367
  error estimate for blocks of size 2^( 4) =       0.000420583927
  error estimate for blocks of size 2^( 5) =       0.000425111954
  error estimate for blocks of size 2^( 6) =       0.000429435212
  error estimate for blocks of size 2^( 7) =       0.000429321456

      target function =                  N/A
              le_mean =     -17.217219781976
             les_mean =     296.746181323969
             stat err =       0.000426113137
             autocorr =       1.158266285003
              std dev =       0.559932549393
             le_variance =       0.313524459870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313615558441
                                         uncertainty =       0.002756256070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313615558441
                                         uncertainty =       0.002756256070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395934803
  error estimate for blocks of size 2^( 2) =       0.000405622778
  error estimate for blocks of size 2^( 3) =       0.000414143741
  error estimate for blocks of size 2^( 4) =       0.000420586186
  error estimate for blocks of size 2^( 5) =       0.000425114131
  error estimate for blocks of size 2^( 6) =       0.000429437285
  error estimate for blocks of size 2^( 7) =       0.000429323558

      target function =                  N/A
              le_mean =     -17.217219769088
             les_mean =     296.746185157340
             stat err =       0.000426115290
             autocorr =       1.158262187162
              std dev =       0.559936368722
             le_variance =       0.313528737018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313613421562
                                         uncertainty =       0.002756243045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313613421562
                                         uncertainty =       0.002756243045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395933455
  error estimate for blocks of size 2^( 2) =       0.000405621510
  error estimate for blocks of size 2^( 3) =       0.000414142555
  error estimate for blocks of size 2^( 4) =       0.000420585058
  error estimate for blocks of size 2^( 5) =       0.000425113043
  error estimate for blocks of size 2^( 6) =       0.000429436249
  error estimate for blocks of size 2^( 7) =       0.000429322508

      target function =                  N/A
              le_mean =     -17.217219775513
             les_mean =     296.746183242573
             stat err =       0.000426114215
             autocorr =       1.158264232355
              std dev =       0.559934461374
             le_variance =       0.313526601034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313611547329
                                         uncertainty =       0.002756231656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313611547329
                                         uncertainty =       0.002756231656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395932272
  error estimate for blocks of size 2^( 2) =       0.000405620398
  error estimate for blocks of size 2^( 3) =       0.000414141516
  error estimate for blocks of size 2^( 4) =       0.000420584068
  error estimate for blocks of size 2^( 5) =       0.000425112090
  error estimate for blocks of size 2^( 6) =       0.000429435342
  error estimate for blocks of size 2^( 7) =       0.000429321588

      target function =                  N/A
              le_mean =     -17.217219781166
             les_mean =     296.746181563799
             stat err =       0.000426113272
             autocorr =       1.158266028300
              std dev =       0.559932788455
             le_variance =       0.313524727587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217219781976        initial  <--
     9.7656e+01     9.7656e+02             6.3436e-06       -17.217219769088
     3.9062e+02     3.9062e+03             1.5874e-06       -17.217219775513
     1.5625e+03     1.5625e+04             3.9693e-07       -17.217219781166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2765
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819184e-02 1 1  ON 1
 uu_2                -6.769421e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604597e-01 1 1  ON 4
 uu_5                -1.723730e-01 1 1  ON 5
 uu_6                -1.595616e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691236e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494026e-01 1 1  ON 10
 ud_1                 9.083458e-02 1 1  ON 11
 ud_2                -1.912524e-02 1 1  ON 12
 ud_3                -8.096814e-02 1 1  ON 13
 ud_4                -1.308916e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595588e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476138e-03 1 1  ON 19
 eO_0                -9.255076e-01 1 1  ON 20
 eO_1                -6.031121e-01 1 1  ON 21
 eO_2                -1.884763e-01 1 1  ON 22
 eO_3                 8.070176e-02 1 1  ON 23
 eO_4                 2.054027e-01 1 1  ON 24
 eO_5                 2.935419e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117183e-02 1 1  ON 29
eH1_0                -2.116865e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151197e-02 1 1  ON 32
eH1_3                -5.389725e-02 1 1  ON 33
eH1_4                -7.407821e-03 1 1  ON 34
eH1_5                 4.706712e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404809e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657553e-02 1 1  ON 42
eH2_3                -4.904285e-02 1 1  ON 43
eH2_4                -2.860106e-03 1 1  ON 44
eH2_5                 9.101230e-03 1 1  ON 45
eH2_6                 4.679032e-02 1 1  ON 46
eH2_7                 4.636776e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1676
    reference variance = 0.195427
====================================================
  Execution time = 2.3804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2027e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320255473639
                                         uncertainty =       0.004186850579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320255473639
                                         uncertainty =       0.004186850579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170657
  error estimate for blocks of size 2^( 2) =       0.000409919803
  error estimate for blocks of size 2^( 3) =       0.000418455794
  error estimate for blocks of size 2^( 4) =       0.000424882923
  error estimate for blocks of size 2^( 5) =       0.000427188856
  error estimate for blocks of size 2^( 6) =       0.000427791427
  error estimate for blocks of size 2^( 7) =       0.000429221201

      target function =                  N/A
              le_mean =     -17.216033704494
             les_mean =     296.712089463509
             stat err =       0.000427271102
             autocorr =       1.140030736035
              std dev =       0.565926770329
             le_variance =       0.320273109375


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721603370449e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216033704494       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216033705241       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216033706943       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216033707920       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216033708448       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216033708896       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216033708984       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216033708899       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.421701e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216033704494       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216033704681       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216033705106       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216033705351       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216033705483       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216033705595       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216033705616       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216033705596       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.355498e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216033704494       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216033704541       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216033704647       residual = 6.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216033704708       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216033704741       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216033704768       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216033704774       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216033704773       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.388789e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9387e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.909338e-01 1 1  ON 0
 uu_1                 2.819185e-02 1 1  ON 1
 uu_2                -6.769425e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604597e-01 1 1  ON 4
 uu_5                -1.723730e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691235e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494027e-01 1 1  ON 10
 ud_1                 9.083463e-02 1 1  ON 11
 ud_2                -1.912530e-02 1 1  ON 12
 ud_3                -8.096821e-02 1 1  ON 13
 ud_4                -1.308917e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595588e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476138e-03 1 1  ON 19
 eO_0                -9.255077e-01 1 1  ON 20
 eO_1                -6.031122e-01 1 1  ON 21
 eO_2                -1.884762e-01 1 1  ON 22
 eO_3                 8.070187e-02 1 1  ON 23
 eO_4                 2.054027e-01 1 1  ON 24
 eO_5                 2.935419e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117184e-02 1 1  ON 29
eH1_0                -2.116866e-01 1 1  ON 30
eH1_1                -1.328689e-01 1 1  ON 31
eH1_2                -9.151196e-02 1 1  ON 32
eH1_3                -5.389724e-02 1 1  ON 33
eH1_4                -7.407796e-03 1 1  ON 34
eH1_5                 4.706725e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404809e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657554e-02 1 1  ON 42
eH2_3                -4.904284e-02 1 1  ON 43
eH2_4                -2.860098e-03 1 1  ON 44
eH2_5                 9.101233e-03 1 1  ON 45
eH2_6                 4.679032e-02 1 1  ON 46
eH2_7                 4.636776e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1628
    reference variance = 0.182502
====================================================
  Execution time = 2.0197e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2050e-01
  Total weights = 2.0000e+06
  Execution time = 1.8395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320591871214
                                         uncertainty =       0.004300298875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320591871214
                                         uncertainty =       0.004300298875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400315484
  error estimate for blocks of size 2^( 2) =       0.000409786997
  error estimate for blocks of size 2^( 3) =       0.000418566034
  error estimate for blocks of size 2^( 4) =       0.000424911849
  error estimate for blocks of size 2^( 5) =       0.000430398243
  error estimate for blocks of size 2^( 6) =       0.000433040628
  error estimate for blocks of size 2^( 7) =       0.000431449003

      target function =                  N/A
              le_mean =     -17.217533639547
             les_mean =     296.763969441741
             stat err =       0.000429949931
             autocorr =       1.153535566815
              std dev =       0.566131586343
             le_variance =       0.320504973055

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320592428660
                                         uncertainty =       0.004300305181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320592428660
                                         uncertainty =       0.004300305181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400315832
  error estimate for blocks of size 2^( 2) =       0.000409787326
  error estimate for blocks of size 2^( 3) =       0.000418566344
  error estimate for blocks of size 2^( 4) =       0.000424912150
  error estimate for blocks of size 2^( 5) =       0.000430398535
  error estimate for blocks of size 2^( 6) =       0.000433040928
  error estimate for blocks of size 2^( 7) =       0.000431449306

      target function =                  N/A
              le_mean =     -17.217533641472
             les_mean =     296.763970065391
             stat err =       0.000429950230
             autocorr =       1.153535165692
              std dev =       0.566132078611
             le_variance =       0.320505530432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320592149995
                                         uncertainty =       0.004300302028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320592149995
                                         uncertainty =       0.004300302028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400315658
  error estimate for blocks of size 2^( 2) =       0.000409787162
  error estimate for blocks of size 2^( 3) =       0.000418566189
  error estimate for blocks of size 2^( 4) =       0.000424911999
  error estimate for blocks of size 2^( 5) =       0.000430398389
  error estimate for blocks of size 2^( 6) =       0.000433040778
  error estimate for blocks of size 2^( 7) =       0.000431449154

      target function =                  N/A
              le_mean =     -17.217533640509
             les_mean =     296.763969753615
             stat err =       0.000429950080
             autocorr =       1.153535366209
              std dev =       0.566131832529
             le_variance =       0.320505251802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320591906063
                                         uncertainty =       0.004300299269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320591906063
                                         uncertainty =       0.004300299269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400315506
  error estimate for blocks of size 2^( 2) =       0.000409787018
  error estimate for blocks of size 2^( 3) =       0.000418566054
  error estimate for blocks of size 2^( 4) =       0.000424911868
  error estimate for blocks of size 2^( 5) =       0.000430398261
  error estimate for blocks of size 2^( 6) =       0.000433040647
  error estimate for blocks of size 2^( 7) =       0.000431449022

      target function =                  N/A
              le_mean =     -17.217533639667
             les_mean =     296.763969480726
             stat err =       0.000429949949
             autocorr =       1.153535541740
              std dev =       0.566131617118
             le_variance =       0.320505007900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217533639547        initial
     9.7656e+02     9.7656e+03             5.4217e-07       -17.217533641472  <--
     3.9062e+03     3.9062e+04             1.3555e-07       -17.217533640509
     1.5625e+04     1.5625e+05             3.3888e-08       -17.217533639667

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 2.9492e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819190e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244056e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691232e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494031e-01 1 1  ON 10
 ud_1                 9.083478e-02 1 1  ON 11
 ud_2                -1.912547e-02 1 1  ON 12
 ud_3                -8.096841e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931837e-02 1 1  ON 18
 ud_9                -8.476139e-03 1 1  ON 19
 eO_0                -9.255081e-01 1 1  ON 20
 eO_1                -6.031124e-01 1 1  ON 21
 eO_2                -1.884758e-01 1 1  ON 22
 eO_3                 8.070221e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935419e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117184e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328690e-01 1 1  ON 31
eH1_2                -9.151193e-02 1 1  ON 32
eH1_3                -5.389719e-02 1 1  ON 33
eH1_4                -7.407722e-03 1 1  ON 34
eH1_5                 4.706765e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280615e-01 1 1  ON 41
eH2_2                -8.657558e-02 1 1  ON 42
eH2_3                -4.904283e-02 1 1  ON 43
eH2_4                -2.860076e-03 1 1  ON 44
eH2_5                 9.101244e-03 1 1  ON 45
eH2_6                 4.679033e-02 1 1  ON 46
eH2_7                 4.636777e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.275
    reference variance = 0.31427
====================================================
  Execution time = 2.0534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1886e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318897294529
                                         uncertainty =       0.004085889385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318897294529
                                         uncertainty =       0.004085889385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399290048
  error estimate for blocks of size 2^( 2) =       0.000408517324
  error estimate for blocks of size 2^( 3) =       0.000417553626
  error estimate for blocks of size 2^( 4) =       0.000424168453
  error estimate for blocks of size 2^( 5) =       0.000427179363
  error estimate for blocks of size 2^( 6) =       0.000429135766
  error estimate for blocks of size 2^( 7) =       0.000430587279

      target function =                  N/A
              le_mean =     -17.216565305096
             les_mean =     296.728985829767
             stat err =       0.000427767715
             autocorr =       1.147728159297
              std dev =       0.564681400933
             le_variance =       0.318865084560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656530510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216565305096       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216565312380       residual = 6.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216565314442       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216565318073       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216565318357       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216565316488       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216565316358       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216565315828       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.089777e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216565305096       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216565306919       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216565307435       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216565308345       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216565308418       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216565307950       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216565307917       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216565307784       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.226214e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216565305096       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216565305552       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216565305681       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216565305908       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216565305929       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216565305810       residual = 5.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216565305801       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216565305768       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.306664e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6100e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.909342e-01 1 1  ON 0
 uu_1                 2.819190e-02 1 1  ON 1
 uu_2                -6.769445e-02 1 1  ON 2
 uu_3                -1.244056e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595618e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494034e-01 1 1  ON 10
 ud_1                 9.083494e-02 1 1  ON 11
 ud_2                -1.912572e-02 1 1  ON 12
 ud_3                -8.096867e-02 1 1  ON 13
 ud_4                -1.308920e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808194e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931840e-02 1 1  ON 18
 ud_9                -8.476137e-03 1 1  ON 19
 eO_0                -9.255086e-01 1 1  ON 20
 eO_1                -6.031126e-01 1 1  ON 21
 eO_2                -1.884755e-01 1 1  ON 22
 eO_3                 8.070263e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116868e-01 1 1  ON 30
eH1_1                -1.328692e-01 1 1  ON 31
eH1_2                -9.151182e-02 1 1  ON 32
eH1_3                -5.389718e-02 1 1  ON 33
eH1_4                -7.407685e-03 1 1  ON 34
eH1_5                 4.706809e-03 1 1  ON 35
eH1_6                 4.143100e-02 1 1  ON 36
eH1_7                 6.404807e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657568e-02 1 1  ON 42
eH2_3                -4.904273e-02 1 1  ON 43
eH2_4                -2.860008e-03 1 1  ON 44
eH2_5                 9.101294e-03 1 1  ON 45
eH2_6                 4.679031e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2704
    reference variance = 0.404099
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1534e-01
  Total weights = 2.0000e+06
  Execution time = 1.8387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315284643561
                                         uncertainty =       0.003009499267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315284643561
                                         uncertainty =       0.003009499267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397074028
  error estimate for blocks of size 2^( 2) =       0.000406553206
  error estimate for blocks of size 2^( 3) =       0.000415278963
  error estimate for blocks of size 2^( 4) =       0.000421094933
  error estimate for blocks of size 2^( 5) =       0.000425197960
  error estimate for blocks of size 2^( 6) =       0.000427537544
  error estimate for blocks of size 2^( 7) =       0.000428765861

      target function =                  N/A
              le_mean =     -17.217139153454
             les_mean =     296.745216039011
             stat err =       0.000425649074
             autocorr =       1.149106877784
              std dev =       0.561547475537
             le_variance =       0.315335567282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315286491439
                                         uncertainty =       0.003009524992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315286491439
                                         uncertainty =       0.003009524992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397075192
  error estimate for blocks of size 2^( 2) =       0.000406554302
  error estimate for blocks of size 2^( 3) =       0.000415279997
  error estimate for blocks of size 2^( 4) =       0.000421095926
  error estimate for blocks of size 2^( 5) =       0.000425198913
  error estimate for blocks of size 2^( 6) =       0.000427538496
  error estimate for blocks of size 2^( 7) =       0.000428766820

      target function =                  N/A
              le_mean =     -17.217139145028
             les_mean =     296.745217597761
             stat err =       0.000425650039
             autocorr =       1.149105347481
              std dev =       0.561549121767
             le_variance =       0.315337416157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315285568228
                                         uncertainty =       0.003009512140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315285568228
                                         uncertainty =       0.003009512140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397074610
  error estimate for blocks of size 2^( 2) =       0.000406553754
  error estimate for blocks of size 2^( 3) =       0.000415279480
  error estimate for blocks of size 2^( 4) =       0.000421095430
  error estimate for blocks of size 2^( 5) =       0.000425198437
  error estimate for blocks of size 2^( 6) =       0.000427538020
  error estimate for blocks of size 2^( 7) =       0.000428766341

      target function =                  N/A
              le_mean =     -17.217139149233
             les_mean =     296.745216818819
             stat err =       0.000425649557
             autocorr =       1.149106111924
              std dev =       0.561548299301
             le_variance =       0.315336492448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315284759166
                                         uncertainty =       0.003009500876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315284759166
                                         uncertainty =       0.003009500876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397074101
  error estimate for blocks of size 2^( 2) =       0.000406553274
  error estimate for blocks of size 2^( 3) =       0.000415279027
  error estimate for blocks of size 2^( 4) =       0.000421094995
  error estimate for blocks of size 2^( 5) =       0.000425198020
  error estimate for blocks of size 2^( 6) =       0.000427537604
  error estimate for blocks of size 2^( 7) =       0.000428765921

      target function =                  N/A
              le_mean =     -17.217139152926
             les_mean =     296.745216136493
             stat err =       0.000425649135
             autocorr =       1.149106782026
              std dev =       0.561547578527
             le_variance =       0.315335682949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217139153454        initial  <--
     2.4414e+02     2.4414e+03             2.0898e-06       -17.217139145028
     9.7656e+02     9.7656e+03             5.2262e-07       -17.217139149233
     3.9062e+03     3.9062e+04             1.3067e-07       -17.217139152926

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2515
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819190e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244056e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691232e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494031e-01 1 1  ON 10
 ud_1                 9.083478e-02 1 1  ON 11
 ud_2                -1.912547e-02 1 1  ON 12
 ud_3                -8.096841e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931837e-02 1 1  ON 18
 ud_9                -8.476139e-03 1 1  ON 19
 eO_0                -9.255081e-01 1 1  ON 20
 eO_1                -6.031124e-01 1 1  ON 21
 eO_2                -1.884758e-01 1 1  ON 22
 eO_3                 8.070221e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935419e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117184e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328690e-01 1 1  ON 31
eH1_2                -9.151193e-02 1 1  ON 32
eH1_3                -5.389719e-02 1 1  ON 33
eH1_4                -7.407722e-03 1 1  ON 34
eH1_5                 4.706765e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280615e-01 1 1  ON 41
eH2_2                -8.657558e-02 1 1  ON 42
eH2_3                -4.904283e-02 1 1  ON 43
eH2_4                -2.860076e-03 1 1  ON 44
eH2_5                 9.101244e-03 1 1  ON 45
eH2_6                 4.679033e-02 1 1  ON 46
eH2_7                 4.636777e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5357e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.207
    reference variance = 0.25348
====================================================
  Execution time = 2.0302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1713e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169912954
                                         uncertainty =       0.003254418676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317169912954
                                         uncertainty =       0.003254418676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398203213
  error estimate for blocks of size 2^( 2) =       0.000407318325
  error estimate for blocks of size 2^( 3) =       0.000415685351
  error estimate for blocks of size 2^( 4) =       0.000421884479
  error estimate for blocks of size 2^( 5) =       0.000426766611
  error estimate for blocks of size 2^( 6) =       0.000429378488
  error estimate for blocks of size 2^( 7) =       0.000431192289

      target function =                  N/A
              le_mean =     -17.216932142489
             les_mean =     296.739883838452
             stat err =       0.000427305467
             autocorr =       1.151509108645
              std dev =       0.563144384641
             le_variance =       0.317131597952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693214249e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216932142489       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216932143250       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216932143282       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216932143339       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216932143392       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216932143436       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216932143428       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216932143402       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.176788e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216932142489       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216932142679       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216932142687       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216932142701       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216932142720       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216932142713       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216932142727       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216932142731       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 5.442166e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216932142489       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216932142536       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216932142538       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216932142542       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216932142542       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216932142556       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216932142541       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216932142530       residual = 1.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.360554e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.065880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5788e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819191e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691232e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494031e-01 1 1  ON 10
 ud_1                 9.083480e-02 1 1  ON 11
 ud_2                -1.912550e-02 1 1  ON 12
 ud_3                -8.096844e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931837e-02 1 1  ON 18
 ud_9                -8.476138e-03 1 1  ON 19
 eO_0                -9.255082e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884758e-01 1 1  ON 22
 eO_3                 8.070225e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117184e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328690e-01 1 1  ON 31
eH1_2                -9.151192e-02 1 1  ON 32
eH1_3                -5.389718e-02 1 1  ON 33
eH1_4                -7.407721e-03 1 1  ON 34
eH1_5                 4.706761e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068780e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657558e-02 1 1  ON 42
eH2_3                -4.904282e-02 1 1  ON 43
eH2_4                -2.860070e-03 1 1  ON 44
eH2_5                 9.101244e-03 1 1  ON 45
eH2_6                 4.679033e-02 1 1  ON 46
eH2_7                 4.636777e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2312
    reference variance = 0.194445
====================================================
  Execution time = 1.9850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1325e-01
  Total weights = 2.0000e+06
  Execution time = 1.8398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212079549
                                         uncertainty =       0.003291527123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212079549
                                         uncertainty =       0.003291527123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395759723
  error estimate for blocks of size 2^( 2) =       0.000405509857
  error estimate for blocks of size 2^( 3) =       0.000414161921
  error estimate for blocks of size 2^( 4) =       0.000420895733
  error estimate for blocks of size 2^( 5) =       0.000425473997
  error estimate for blocks of size 2^( 6) =       0.000428057826
  error estimate for blocks of size 2^( 7) =       0.000429347094

      target function =                  N/A
              le_mean =     -17.216435487195
             les_mean =     296.718902245359
             stat err =       0.000425943662
             autocorr =       1.158353550329
              std dev =       0.559688768176
             le_variance =       0.313251517222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212228934
                                         uncertainty =       0.003291529584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212228934
                                         uncertainty =       0.003291529584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395759818
  error estimate for blocks of size 2^( 2) =       0.000405509945
  error estimate for blocks of size 2^( 3) =       0.000414162002
  error estimate for blocks of size 2^( 4) =       0.000420895811
  error estimate for blocks of size 2^( 5) =       0.000425474075
  error estimate for blocks of size 2^( 6) =       0.000428057903
  error estimate for blocks of size 2^( 7) =       0.000429347173

      target function =                  N/A
              le_mean =     -17.216435487500
             les_mean =     296.718902405184
             stat err =       0.000425943740
             autocorr =       1.158353422409
              std dev =       0.559688901595
             le_variance =       0.313251666568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212154246
                                         uncertainty =       0.003291528353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212154246
                                         uncertainty =       0.003291528353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395759771
  error estimate for blocks of size 2^( 2) =       0.000405509901
  error estimate for blocks of size 2^( 3) =       0.000414161962
  error estimate for blocks of size 2^( 4) =       0.000420895772
  error estimate for blocks of size 2^( 5) =       0.000425474036
  error estimate for blocks of size 2^( 6) =       0.000428057865
  error estimate for blocks of size 2^( 7) =       0.000429347133

      target function =                  N/A
              le_mean =     -17.216435487348
             les_mean =     296.718902325274
             stat err =       0.000425943701
             autocorr =       1.158353486365
              std dev =       0.559688834889
             le_variance =       0.313251591900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212088886
                                         uncertainty =       0.003291527276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313212088886
                                         uncertainty =       0.003291527276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395759729
  error estimate for blocks of size 2^( 2) =       0.000405509863
  error estimate for blocks of size 2^( 3) =       0.000414161926
  error estimate for blocks of size 2^( 4) =       0.000420895737
  error estimate for blocks of size 2^( 5) =       0.000425474002
  error estimate for blocks of size 2^( 6) =       0.000428057831
  error estimate for blocks of size 2^( 7) =       0.000429347099

      target function =                  N/A
              le_mean =     -17.216435487214
             les_mean =     296.718902255348
             stat err =       0.000425943667
             autocorr =       1.158353542329
              std dev =       0.559688776515
             le_variance =       0.313251526557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216435487195        initial
     2.4414e+03     2.4414e+04             2.1768e-07       -17.216435487500  <--
     9.7656e+03     9.7656e+04             5.4422e-08       -17.216435487348
     3.9062e+04     3.9062e+05             1.3606e-08       -17.216435487214

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.9142e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4939e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.201
    reference variance = 0.239641
====================================================
  Execution time = 2.0562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1328e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313193848785
                                         uncertainty =       0.003727336741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313193848785
                                         uncertainty =       0.003727336741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395778858
  error estimate for blocks of size 2^( 2) =       0.000405956176
  error estimate for blocks of size 2^( 3) =       0.000414743527
  error estimate for blocks of size 2^( 4) =       0.000420620022
  error estimate for blocks of size 2^( 5) =       0.000424468301
  error estimate for blocks of size 2^( 6) =       0.000425934113
  error estimate for blocks of size 2^( 7) =       0.000427271745

      target function =                  N/A
              le_mean =     -17.216263840104
             les_mean =     296.713022263689
             stat err =       0.000424573545
             autocorr =       1.150802187636
              std dev =       0.559715828137
             le_variance =       0.313281808267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626384010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216263840104       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216263841575       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216263844766       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216263846226       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216263846416       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216263846691       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216263846829       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216263846934       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 1.030932e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216263840104       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216263840472       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216263841270       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216263841635       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216263841682       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216263841753       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216263841786       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216263841816       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.577758e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216263840104       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216263840196       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216263840395       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216263840487       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216263840498       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216263840526       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216263840525       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216263840521       residual = 2.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 6.444662e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068729 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6235e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.909341e-01 1 1  ON 0
 uu_1                 2.819196e-02 1 1  ON 1
 uu_2                -6.769440e-02 1 1  ON 2
 uu_3                -1.244056e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595618e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494034e-01 1 1  ON 10
 ud_1                 9.083494e-02 1 1  ON 11
 ud_2                -1.912567e-02 1 1  ON 12
 ud_3                -8.096863e-02 1 1  ON 13
 ud_4                -1.308920e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931839e-02 1 1  ON 18
 ud_9                -8.476130e-03 1 1  ON 19
 eO_0                -9.255086e-01 1 1  ON 20
 eO_1                -6.031126e-01 1 1  ON 21
 eO_2                -1.884756e-01 1 1  ON 22
 eO_3                 8.070254e-02 1 1  ON 23
 eO_4                 2.054029e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341351e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940567e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151192e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407741e-03 1 1  ON 34
eH1_5                 4.706759e-03 1 1  ON 35
eH1_6                 4.143102e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657558e-02 1 1  ON 42
eH2_3                -4.904278e-02 1 1  ON 43
eH2_4                -2.860083e-03 1 1  ON 44
eH2_5                 9.101222e-03 1 1  ON 45
eH2_6                 4.679034e-02 1 1  ON 46
eH2_7                 4.636779e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1332
    reference variance = 0.201603
====================================================
  Execution time = 1.9826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1705e-01
  Total weights = 2.0000e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317105309920
                                         uncertainty =       0.003287316278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317105309920
                                         uncertainty =       0.003287316278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154098
  error estimate for blocks of size 2^( 2) =       0.000407798756
  error estimate for blocks of size 2^( 3) =       0.000415812506
  error estimate for blocks of size 2^( 4) =       0.000422355728
  error estimate for blocks of size 2^( 5) =       0.000426113844
  error estimate for blocks of size 2^( 6) =       0.000429940367
  error estimate for blocks of size 2^( 7) =       0.000429812889

      target function =                  N/A
              le_mean =     -17.217121380275
             les_mean =     296.746321836007
             stat err =       0.000427055707
             autocorr =       1.150447170389
              std dev =       0.563074925212
             le_variance =       0.317053371402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317106117410
                                         uncertainty =       0.003287325057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317106117410
                                         uncertainty =       0.003287325057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154605
  error estimate for blocks of size 2^( 2) =       0.000407799234
  error estimate for blocks of size 2^( 3) =       0.000415812953
  error estimate for blocks of size 2^( 4) =       0.000422356154
  error estimate for blocks of size 2^( 5) =       0.000426114251
  error estimate for blocks of size 2^( 6) =       0.000429940761
  error estimate for blocks of size 2^( 7) =       0.000429813288

      target function =                  N/A
              le_mean =     -17.217121379065
             les_mean =     296.746322601642
             stat err =       0.000427056113
             autocorr =       1.150446428738
              std dev =       0.563075642100
             le_variance =       0.317054178727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317105713784
                                         uncertainty =       0.003287320669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317105713784
                                         uncertainty =       0.003287320669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154351
  error estimate for blocks of size 2^( 2) =       0.000407798995
  error estimate for blocks of size 2^( 3) =       0.000415812729
  error estimate for blocks of size 2^( 4) =       0.000422355941
  error estimate for blocks of size 2^( 5) =       0.000426114047
  error estimate for blocks of size 2^( 6) =       0.000429940564
  error estimate for blocks of size 2^( 7) =       0.000429813089

      target function =                  N/A
              le_mean =     -17.217121379669
             les_mean =     296.746322218923
             stat err =       0.000427055910
             autocorr =       1.150446799435
              std dev =       0.563075283761
             le_variance =       0.317053775183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317105360407
                                         uncertainty =       0.003287316827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317105360407
                                         uncertainty =       0.003287316827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398154130
  error estimate for blocks of size 2^( 2) =       0.000407798786
  error estimate for blocks of size 2^( 3) =       0.000415812534
  error estimate for blocks of size 2^( 4) =       0.000422355755
  error estimate for blocks of size 2^( 5) =       0.000426113869
  error estimate for blocks of size 2^( 6) =       0.000429940392
  error estimate for blocks of size 2^( 7) =       0.000429812914

      target function =                  N/A
              le_mean =     -17.217121380199
             les_mean =     296.746321883873
             stat err =       0.000427055733
             autocorr =       1.150447124026
              std dev =       0.563074970034
             le_variance =       0.317053421878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217121380275        initial  <--
     6.1035e+02     6.1035e+03             1.0309e-06       -17.217121379065
     2.4414e+03     2.4414e+04             2.5778e-07       -17.217121379669
     9.7656e+03     9.7656e+04             6.4447e-08       -17.217121380199

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0984
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2604
    reference variance = 0.184557
====================================================
  Execution time = 2.0339e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1798e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317916491248
                                         uncertainty =       0.004483494738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317916491248
                                         uncertainty =       0.004483494738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398734253
  error estimate for blocks of size 2^( 2) =       0.000408083469
  error estimate for blocks of size 2^( 3) =       0.000416305081
  error estimate for blocks of size 2^( 4) =       0.000422838354
  error estimate for blocks of size 2^( 5) =       0.000427252166
  error estimate for blocks of size 2^( 6) =       0.000428904214
  error estimate for blocks of size 2^( 7) =       0.000428808838

      target function =                  N/A
              le_mean =     -17.216887607420
             les_mean =     296.739196736382
             stat err =       0.000426950893
             autocorr =       1.146538817201
              std dev =       0.563895388200
             le_variance =       0.317978008833


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688760742e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887607420       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887607725       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216887608114       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216887608163       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887608194       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216887608118       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216887608078       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 9.328692e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887607420       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887607496       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216887607594       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216887607608       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887607613       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216887607594       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216887607568       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 2.332215e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216887607420       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216887607439       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216887607464       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216887607481       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216887607469       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216887607460       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216887607466       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 5.830562e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.070995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5861e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819193e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083487e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096854e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255084e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070241e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407718e-03 1 1  ON 34
eH1_5                 4.706752e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101243e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1477
    reference variance = 0.517124
====================================================
  Execution time = 2.0012e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1848e-01
  Total weights = 2.0000e+06
  Execution time = 1.8358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491529264
                                         uncertainty =       0.003095218550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491529264
                                         uncertainty =       0.003095218550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399052030
  error estimate for blocks of size 2^( 2) =       0.000408909560
  error estimate for blocks of size 2^( 3) =       0.000417582815
  error estimate for blocks of size 2^( 4) =       0.000423695263
  error estimate for blocks of size 2^( 5) =       0.000427332348
  error estimate for blocks of size 2^( 6) =       0.000428456681
  error estimate for blocks of size 2^( 7) =       0.000430929204

      target function =                  N/A
              le_mean =     -17.216388089396
             les_mean =     296.722503730714
             stat err =       0.000427603374
             autocorr =       1.148214950631
              std dev =       0.564344792883
             le_variance =       0.318485045254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491593679
                                         uncertainty =       0.003095219015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491593679
                                         uncertainty =       0.003095219015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399052070
  error estimate for blocks of size 2^( 2) =       0.000408909598
  error estimate for blocks of size 2^( 3) =       0.000417582851
  error estimate for blocks of size 2^( 4) =       0.000423695296
  error estimate for blocks of size 2^( 5) =       0.000427332380
  error estimate for blocks of size 2^( 6) =       0.000428456714
  error estimate for blocks of size 2^( 7) =       0.000430929236

      target function =                  N/A
              le_mean =     -17.216388088898
             les_mean =     296.722503777973
             stat err =       0.000427603407
             autocorr =       1.148214895456
              std dev =       0.564344849946
             le_variance =       0.318485109660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491561472
                                         uncertainty =       0.003095218782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491561472
                                         uncertainty =       0.003095218782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399052050
  error estimate for blocks of size 2^( 2) =       0.000408909579
  error estimate for blocks of size 2^( 3) =       0.000417582833
  error estimate for blocks of size 2^( 4) =       0.000423695279
  error estimate for blocks of size 2^( 5) =       0.000427332364
  error estimate for blocks of size 2^( 6) =       0.000428456698
  error estimate for blocks of size 2^( 7) =       0.000430929220

      target function =                  N/A
              le_mean =     -17.216388089147
             les_mean =     296.722503754344
             stat err =       0.000427603390
             autocorr =       1.148214923041
              std dev =       0.564344821415
             le_variance =       0.318485077458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491533290
                                         uncertainty =       0.003095218579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318491533290
                                         uncertainty =       0.003095218579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399052032
  error estimate for blocks of size 2^( 2) =       0.000408909563
  error estimate for blocks of size 2^( 3) =       0.000417582817
  error estimate for blocks of size 2^( 4) =       0.000423695265
  error estimate for blocks of size 2^( 5) =       0.000427332350
  error estimate for blocks of size 2^( 6) =       0.000428456683
  error estimate for blocks of size 2^( 7) =       0.000430929206

      target function =                  N/A
              le_mean =     -17.216388089365
             les_mean =     296.722503733668
             stat err =       0.000427603376
             autocorr =       1.148214947181
              std dev =       0.564344796450
             le_variance =       0.318485049280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216388089396        initial  <--
     6.1035e+03     6.1035e+04             9.3287e-08       -17.216388088898
     2.4414e+04     2.4414e+05             2.3322e-08       -17.216388089147
     9.7656e+04     9.7656e+05             5.8306e-09       -17.216388089365

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2835
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5162e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.186927
====================================================
  Execution time = 2.2607e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1911e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319102569157
                                         uncertainty =       0.004407295603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319102569157
                                         uncertainty =       0.004407295603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399441875
  error estimate for blocks of size 2^( 2) =       0.000408843292
  error estimate for blocks of size 2^( 3) =       0.000417792855
  error estimate for blocks of size 2^( 4) =       0.000423064221
  error estimate for blocks of size 2^( 5) =       0.000425727057
  error estimate for blocks of size 2^( 6) =       0.000427752361
  error estimate for blocks of size 2^( 7) =       0.000427812375

      target function =                  N/A
              le_mean =     -17.217134942402
             les_mean =     296.748843088013
             stat err =       0.000426089004
             autocorr =       1.137872153866
              std dev =       0.564896116717
             le_variance =       0.319107622682


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721713494240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217134942402       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217134942404       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217134942423       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217134942436       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217134942385       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217134942461       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217134942444       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217134942470       residual = 5.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 8.746771e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217134942402       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217134942403       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217134942407       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217134942410       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217134942410       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217134942412       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217134940780       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217134942414       residual = 5.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 2.186699e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217134942402       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217134942402       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217134942403       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217134942404       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217134942481       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217134942282       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217134942097       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217134941952       residual = 5.38e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 5.466742e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073591 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8119e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096854e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070240e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.213796
====================================================
  Execution time = 2.2131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2598e-01
  Total weights = 2.0000e+06
  Execution time = 1.8244e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326098999428
                                         uncertainty =       0.009908192690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326098999428
                                         uncertainty =       0.009908192690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403718043
  error estimate for blocks of size 2^( 2) =       0.000413242626
  error estimate for blocks of size 2^( 3) =       0.000422061114
  error estimate for blocks of size 2^( 4) =       0.000428311051
  error estimate for blocks of size 2^( 5) =       0.000431544930
  error estimate for blocks of size 2^( 6) =       0.000433751130
  error estimate for blocks of size 2^( 7) =       0.000435134041

      target function =                  N/A
              le_mean =     -17.216124806950
             les_mean =     296.720929721310
             stat err =       0.000432185288
             autocorr =       1.145997420975
              std dev =       0.570943531211
             le_variance =       0.325976515832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326099002742
                                         uncertainty =       0.009908192612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326099002742
                                         uncertainty =       0.009908192612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403718045
  error estimate for blocks of size 2^( 2) =       0.000413242628
  error estimate for blocks of size 2^( 3) =       0.000422061116
  error estimate for blocks of size 2^( 4) =       0.000428311053
  error estimate for blocks of size 2^( 5) =       0.000431544932
  error estimate for blocks of size 2^( 6) =       0.000433751131
  error estimate for blocks of size 2^( 7) =       0.000435134043

      target function =                  N/A
              le_mean =     -17.216124806941
             les_mean =     296.720929724329
             stat err =       0.000432185290
             autocorr =       1.145997418043
              std dev =       0.570943534112
             le_variance =       0.325976519144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326099001085
                                         uncertainty =       0.009908192651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326099001085
                                         uncertainty =       0.009908192651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403718044
  error estimate for blocks of size 2^( 2) =       0.000413242627
  error estimate for blocks of size 2^( 3) =       0.000422061115
  error estimate for blocks of size 2^( 4) =       0.000428311052
  error estimate for blocks of size 2^( 5) =       0.000431544931
  error estimate for blocks of size 2^( 6) =       0.000433751130
  error estimate for blocks of size 2^( 7) =       0.000435134042

      target function =                  N/A
              le_mean =     -17.216124806945
             les_mean =     296.720929722820
             stat err =       0.000432185289
             autocorr =       1.145997419505
              std dev =       0.570943532662
             le_variance =       0.325976517488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326098999635
                                         uncertainty =       0.009908192685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326098999635
                                         uncertainty =       0.009908192685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403718043
  error estimate for blocks of size 2^( 2) =       0.000413242626
  error estimate for blocks of size 2^( 3) =       0.000422061114
  error estimate for blocks of size 2^( 4) =       0.000428311051
  error estimate for blocks of size 2^( 5) =       0.000431544930
  error estimate for blocks of size 2^( 6) =       0.000433751130
  error estimate for blocks of size 2^( 7) =       0.000435134042

      target function =                  N/A
              le_mean =     -17.216124806949
             les_mean =     296.720929721499
             stat err =       0.000432185288
             autocorr =       1.145997420784
              std dev =       0.570943531392
             le_variance =       0.325976516039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216124806950        initial  <--
     6.1035e+04     6.1035e+05             8.7468e-09       -17.216124806941
     2.4414e+05     2.4414e+06             2.1867e-09       -17.216124806945
     9.7656e+05     9.7656e+06             5.4667e-10       -17.216124806949

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3508
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2069
    reference variance = 0.18934
====================================================
  Execution time = 2.0693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2522e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6465e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325210423509
                                         uncertainty =       0.007201133989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325210423509
                                         uncertainty =       0.007201133989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403247461
  error estimate for blocks of size 2^( 2) =       0.000413284123
  error estimate for blocks of size 2^( 3) =       0.000421853030
  error estimate for blocks of size 2^( 4) =       0.000428621290
  error estimate for blocks of size 2^( 5) =       0.000432252762
  error estimate for blocks of size 2^( 6) =       0.000435795780
  error estimate for blocks of size 2^( 7) =       0.000437932889

      target function =                  N/A
              le_mean =     -17.216396773059
             les_mean =     296.729534714020
             stat err =       0.000433650680
             autocorr =       1.156476417725
              std dev =       0.570278028002
             le_variance =       0.325217029222


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639677306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396773059       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396773061       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396773061       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396773061       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396773058       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396774149       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396772498       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216396775006       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 8.482196e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396773059       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396773060       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396773060       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396773060       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396773059       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396773509       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396772240       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216396773782       residual = 2.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 2.120550e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216396773059       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216396773059       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216396773059       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216396772679       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216396774187       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216396786331       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216396773656       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216396775581       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 5.301366e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076174 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6346e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1952
    reference variance = 0.196818
====================================================
  Execution time = 2.0989e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1968e-01
  Total weights = 2.0000e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958066
                                         uncertainty =       0.003186062674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958066
                                         uncertainty =       0.003186062674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399797698
  error estimate for blocks of size 2^( 2) =       0.000409341767
  error estimate for blocks of size 2^( 3) =       0.000417648970
  error estimate for blocks of size 2^( 4) =       0.000423567143
  error estimate for blocks of size 2^( 5) =       0.000427033155
  error estimate for blocks of size 2^( 6) =       0.000429879513
  error estimate for blocks of size 2^( 7) =       0.000429405085

      target function =                  N/A
              le_mean =     -17.216967282333
             les_mean =     296.743638640296
             stat err =       0.000427471224
             autocorr =       1.143228889252
              std dev =       0.565399327209
             le_variance =       0.319676399208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958739
                                         uncertainty =       0.003186062679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958739
                                         uncertainty =       0.003186062679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399797699
  error estimate for blocks of size 2^( 2) =       0.000409341767
  error estimate for blocks of size 2^( 3) =       0.000417648970
  error estimate for blocks of size 2^( 4) =       0.000423567144
  error estimate for blocks of size 2^( 5) =       0.000427033155
  error estimate for blocks of size 2^( 6) =       0.000429879513
  error estimate for blocks of size 2^( 7) =       0.000429405085

      target function =                  N/A
              le_mean =     -17.216967282333
             les_mean =     296.743638640962
             stat err =       0.000427471224
             autocorr =       1.143228888656
              std dev =       0.565399327804
             le_variance =       0.319676399881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958402
                                         uncertainty =       0.003186062677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958402
                                         uncertainty =       0.003186062677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399797699
  error estimate for blocks of size 2^( 2) =       0.000409341767
  error estimate for blocks of size 2^( 3) =       0.000417648970
  error estimate for blocks of size 2^( 4) =       0.000423567143
  error estimate for blocks of size 2^( 5) =       0.000427033155
  error estimate for blocks of size 2^( 6) =       0.000429879513
  error estimate for blocks of size 2^( 7) =       0.000429405085

      target function =                  N/A
              le_mean =     -17.216967282333
             les_mean =     296.743638640629
             stat err =       0.000427471224
             autocorr =       1.143228888958
              std dev =       0.565399327506
             le_variance =       0.319676399545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958108
                                         uncertainty =       0.003186062674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319780958108
                                         uncertainty =       0.003186062674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399797698
  error estimate for blocks of size 2^( 2) =       0.000409341767
  error estimate for blocks of size 2^( 3) =       0.000417648970
  error estimate for blocks of size 2^( 4) =       0.000423567143
  error estimate for blocks of size 2^( 5) =       0.000427033155
  error estimate for blocks of size 2^( 6) =       0.000429879513
  error estimate for blocks of size 2^( 7) =       0.000429405085

      target function =                  N/A
              le_mean =     -17.216967282333
             les_mean =     296.743638640337
             stat err =       0.000427471224
             autocorr =       1.143228889215
              std dev =       0.565399327246
             le_variance =       0.319676399250


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216967282333        initial  <--
     6.1035e+05     6.1035e+06             8.4822e-10       -17.216967282333
     2.4414e+06     2.4414e+07             2.1205e-10       -17.216967282333
     9.7656e+06     9.7656e+07             5.3014e-11       -17.216967282333

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1721
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1759
    reference variance = 0.220855
====================================================
  Execution time = 2.0496e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319589265435
                                         uncertainty =       0.003163328168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319589265435
                                         uncertainty =       0.003163328168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399677030
  error estimate for blocks of size 2^( 2) =       0.000409463812
  error estimate for blocks of size 2^( 3) =       0.000418050813
  error estimate for blocks of size 2^( 4) =       0.000425272274
  error estimate for blocks of size 2^( 5) =       0.000430347462
  error estimate for blocks of size 2^( 6) =       0.000433404118
  error estimate for blocks of size 2^( 7) =       0.000435950898

      target function =                  N/A
              le_mean =     -17.215972939871
             les_mean =     296.709207564017
             stat err =       0.000431243688
             autocorr =       1.164198735366
              std dev =       0.565228677085
             le_variance =       0.319483457400


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721597293987e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215972939871       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215972939871       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215972939871       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215972939871       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215972940042       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215972940249       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215972939096       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215972940472       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 8.124613e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215972939871       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215972939871       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215972939871       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215972940349       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215972946549       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215972945903       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215972941838       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215972941489       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.031143e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215972939871       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215972939871       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215972939871       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215972925799       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215972947681       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215972937248       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215972934804       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215972906930       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 5.077901e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078748 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5984e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.126
    reference variance = 0.164397
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1166e-01
  Total weights = 2.0000e+06
  Execution time = 1.8221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277492
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277492
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394754754
  error estimate for blocks of size 2^( 2) =       0.000404736143
  error estimate for blocks of size 2^( 3) =       0.000413419302
  error estimate for blocks of size 2^( 4) =       0.000420123933
  error estimate for blocks of size 2^( 5) =       0.000424051628
  error estimate for blocks of size 2^( 6) =       0.000426258873
  error estimate for blocks of size 2^( 7) =       0.000427482110

      target function =                  N/A
              le_mean =     -17.215569766330
             les_mean =     296.687504854459
             stat err =       0.000424479136
             autocorr =       1.156266545577
              std dev =       0.558267526295
             le_variance =       0.311662630915

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277558
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277558
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394754754
  error estimate for blocks of size 2^( 2) =       0.000404736143
  error estimate for blocks of size 2^( 3) =       0.000413419302
  error estimate for blocks of size 2^( 4) =       0.000420123933
  error estimate for blocks of size 2^( 5) =       0.000424051628
  error estimate for blocks of size 2^( 6) =       0.000426258873
  error estimate for blocks of size 2^( 7) =       0.000427482110

      target function =                  N/A
              le_mean =     -17.215569766329
             les_mean =     296.687504854506
             stat err =       0.000424479136
             autocorr =       1.156266545514
              std dev =       0.558267526354
             le_variance =       0.311662630982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277525
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277525
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394754754
  error estimate for blocks of size 2^( 2) =       0.000404736143
  error estimate for blocks of size 2^( 3) =       0.000413419302
  error estimate for blocks of size 2^( 4) =       0.000420123933
  error estimate for blocks of size 2^( 5) =       0.000424051628
  error estimate for blocks of size 2^( 6) =       0.000426258873
  error estimate for blocks of size 2^( 7) =       0.000427482110

      target function =                  N/A
              le_mean =     -17.215569766330
             les_mean =     296.687504854483
             stat err =       0.000424479136
             autocorr =       1.156266545547
              std dev =       0.558267526325
             le_variance =       0.311662630949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277496
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311764277496
                                         uncertainty =       0.002431656255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394754754
  error estimate for blocks of size 2^( 2) =       0.000404736143
  error estimate for blocks of size 2^( 3) =       0.000413419302
  error estimate for blocks of size 2^( 4) =       0.000420123933
  error estimate for blocks of size 2^( 5) =       0.000424051628
  error estimate for blocks of size 2^( 6) =       0.000426258873
  error estimate for blocks of size 2^( 7) =       0.000427482110

      target function =                  N/A
              le_mean =     -17.215569766330
             les_mean =     296.687504854462
             stat err =       0.000424479136
             autocorr =       1.156266545571
              std dev =       0.558267526299
             le_variance =       0.311662630920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215569766330        initial  <--
     6.1035e+06     6.1035e+07             8.1246e-11       -17.215569766329
     2.4414e+07     2.4414e+08             2.0311e-11       -17.215569766330
     9.7656e+07     9.7656e+08             5.0779e-12       -17.215569766330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2998
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.360098
====================================================
  Execution time = 2.0430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1881e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5596e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318852153849
                                         uncertainty =       0.005211910452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318852153849
                                         uncertainty =       0.005211910452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399258297
  error estimate for blocks of size 2^( 2) =       0.000408762010
  error estimate for blocks of size 2^( 3) =       0.000417217490
  error estimate for blocks of size 2^( 4) =       0.000423475138
  error estimate for blocks of size 2^( 5) =       0.000428076828
  error estimate for blocks of size 2^( 6) =       0.000429614535
  error estimate for blocks of size 2^( 7) =       0.000430347131

      target function =                  N/A
              le_mean =     -17.216566062713
             les_mean =     296.728961207666
             stat err =       0.000427878408
             autocorr =       1.148504876196
              std dev =       0.564636498386
             le_variance =       0.318814375310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721656606271e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566062713       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566062713       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566062713       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566062713       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566083936       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566064176       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566015368       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 9.545931e-12

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566062713       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566062713       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566062713       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566062713       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566062713       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566062713       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566027607       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 2.386488e-12

solving harmonic davidson linear method for identity shift 9.7656e+08, overlap shift 9.7656e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216566062713       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216566062713       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216566062713       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216566049096       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216566062713       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216566193565       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216566772212       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+08 is 5.965462e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5995e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1539
    reference variance = 0.207147
====================================================
  Execution time = 2.0451e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2401e-01
  Total weights = 2.0000e+06
  Execution time = 1.8404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254220
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254220
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501422
  error estimate for blocks of size 2^( 2) =       0.000412100932
  error estimate for blocks of size 2^( 3) =       0.000420338632
  error estimate for blocks of size 2^( 4) =       0.000426398763
  error estimate for blocks of size 2^( 5) =       0.000430210746
  error estimate for blocks of size 2^( 6) =       0.000430453633
  error estimate for blocks of size 2^( 7) =       0.000430405815

      target function =                  N/A
              le_mean =     -17.218398000239
             les_mean =     296.797244322380
             stat err =       0.000429367239
             autocorr =       1.137949452115
              std dev =       0.569222970167
             le_variance =       0.324014789766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254225
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254225
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501422
  error estimate for blocks of size 2^( 2) =       0.000412100932
  error estimate for blocks of size 2^( 3) =       0.000420338632
  error estimate for blocks of size 2^( 4) =       0.000426398763
  error estimate for blocks of size 2^( 5) =       0.000430210746
  error estimate for blocks of size 2^( 6) =       0.000430453633
  error estimate for blocks of size 2^( 7) =       0.000430405815

      target function =                  N/A
              le_mean =     -17.218398000239
             les_mean =     296.797244322385
             stat err =       0.000429367239
             autocorr =       1.137949452110
              std dev =       0.569222970172
             le_variance =       0.324014789772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254222
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254222
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501422
  error estimate for blocks of size 2^( 2) =       0.000412100932
  error estimate for blocks of size 2^( 3) =       0.000420338632
  error estimate for blocks of size 2^( 4) =       0.000426398763
  error estimate for blocks of size 2^( 5) =       0.000430210746
  error estimate for blocks of size 2^( 6) =       0.000430453633
  error estimate for blocks of size 2^( 7) =       0.000430405815

      target function =                  N/A
              le_mean =     -17.218398000239
             les_mean =     296.797244322382
             stat err =       0.000429367239
             autocorr =       1.137949452109
              std dev =       0.569222970170
             le_variance =       0.324014789769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254220
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324011254220
                                         uncertainty =       0.006602972759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402501422
  error estimate for blocks of size 2^( 2) =       0.000412100932
  error estimate for blocks of size 2^( 3) =       0.000420338632
  error estimate for blocks of size 2^( 4) =       0.000426398763
  error estimate for blocks of size 2^( 5) =       0.000430210746
  error estimate for blocks of size 2^( 6) =       0.000430453633
  error estimate for blocks of size 2^( 7) =       0.000430405815

      target function =                  N/A
              le_mean =     -17.218398000239
             les_mean =     296.797244322380
             stat err =       0.000429367239
             autocorr =       1.137949452114
              std dev =       0.569222970168
             le_variance =       0.324014789766


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.218398000239        initial  <--
     6.1035e+07     6.1035e+08             9.5459e-12       -17.218398000239
     2.4414e+08     2.4414e+09             2.3865e-12       -17.218398000239
     9.7656e+08     9.7656e+09             5.9655e-13       -17.218398000239

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7578
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5759e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1997
    reference variance = 0.365487
====================================================
  Execution time = 2.0373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316030093450
                                         uncertainty =       0.003164605418

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316030093450
                                         uncertainty =       0.003164605418

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397487516
  error estimate for blocks of size 2^( 2) =       0.000407100922
  error estimate for blocks of size 2^( 3) =       0.000415465214
  error estimate for blocks of size 2^( 4) =       0.000421543398
  error estimate for blocks of size 2^( 5) =       0.000425254043
  error estimate for blocks of size 2^( 6) =       0.000427087054
  error estimate for blocks of size 2^( 7) =       0.000425793951

      target function =                  N/A
              le_mean =     -17.217365580604
             les_mean =     296.753670029443
             stat err =       0.000424919612
             autocorr =       1.142790349847
              std dev =       0.562132236459
             le_variance =       0.315992651267


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721736558060e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217365580604       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217365580604       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217365580604       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217365580604       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217365580604       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217366183409       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217365154780       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217366022351       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 1.021599e-12

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217365580604       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217365580604       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217365580604       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217366643864       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217364978382       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217365357860       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217366130567       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217364551471       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 2.553362e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217365580604       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217365580604       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217365580604       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217365580604       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217365362564       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217376069578       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217366687965       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217365445321       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 6.353220e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5938e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1924
    reference variance = 0.157918
====================================================
  Execution time = 2.0036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2475e-01
  Total weights = 2.0000e+06
  Execution time = 1.8411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747046
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747046
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955762
  error estimate for blocks of size 2^( 2) =       0.000412192664
  error estimate for blocks of size 2^( 3) =       0.000420687182
  error estimate for blocks of size 2^( 4) =       0.000427021885
  error estimate for blocks of size 2^( 5) =       0.000431143941
  error estimate for blocks of size 2^( 6) =       0.000432488817
  error estimate for blocks of size 2^( 7) =       0.000434532698

      target function =                  N/A
              le_mean =     -17.216765127207
             les_mean =     296.741747974645
             stat err =       0.000431296835
             autocorr =       1.145612656316
              std dev =       0.569865503088
             le_variance =       0.324746691609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747047
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747047
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955762
  error estimate for blocks of size 2^( 2) =       0.000412192664
  error estimate for blocks of size 2^( 3) =       0.000420687182
  error estimate for blocks of size 2^( 4) =       0.000427021885
  error estimate for blocks of size 2^( 5) =       0.000431143941
  error estimate for blocks of size 2^( 6) =       0.000432488817
  error estimate for blocks of size 2^( 7) =       0.000434532698

      target function =                  N/A
              le_mean =     -17.216765127207
             les_mean =     296.741747974646
             stat err =       0.000431296835
             autocorr =       1.145612656313
              std dev =       0.569865503088
             le_variance =       0.324746691610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747046
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747046
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955762
  error estimate for blocks of size 2^( 2) =       0.000412192664
  error estimate for blocks of size 2^( 3) =       0.000420687182
  error estimate for blocks of size 2^( 4) =       0.000427021885
  error estimate for blocks of size 2^( 5) =       0.000431143941
  error estimate for blocks of size 2^( 6) =       0.000432488817
  error estimate for blocks of size 2^( 7) =       0.000434532698

      target function =                  N/A
              le_mean =     -17.216765127207
             les_mean =     296.741747974645
             stat err =       0.000431296835
             autocorr =       1.145612656308
              std dev =       0.569865503088
             le_variance =       0.324746691610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747046
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324786747046
                                         uncertainty =       0.006271609534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402955762
  error estimate for blocks of size 2^( 2) =       0.000412192664
  error estimate for blocks of size 2^( 3) =       0.000420687182
  error estimate for blocks of size 2^( 4) =       0.000427021885
  error estimate for blocks of size 2^( 5) =       0.000431143941
  error estimate for blocks of size 2^( 6) =       0.000432488817
  error estimate for blocks of size 2^( 7) =       0.000434532698

      target function =                  N/A
              le_mean =     -17.216765127207
             les_mean =     296.741747974645
             stat err =       0.000431296835
             autocorr =       1.145612656322
              std dev =       0.569865503088
             le_variance =       0.324746691609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216765127207        initial
     6.1035e+08     6.1035e+09             1.0216e-12       -17.216765127207
     2.4414e+09     2.4414e+10             2.5534e-13       -17.216765127207
     9.7656e+09     9.7656e+10             6.3532e-14       -17.216765127207  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+09     and shift_s =   9.7656e+10
*****************************************************************************

  Execution time = 2.9355e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5301e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1792
    reference variance = 0.199061
====================================================
  Execution time = 2.2009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312723252624
                                         uncertainty =       0.003331458050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312723252624
                                         uncertainty =       0.003331458050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395359469
  error estimate for blocks of size 2^( 2) =       0.000404871158
  error estimate for blocks of size 2^( 3) =       0.000413617775
  error estimate for blocks of size 2^( 4) =       0.000420152275
  error estimate for blocks of size 2^( 5) =       0.000424310072
  error estimate for blocks of size 2^( 6) =       0.000427457057
  error estimate for blocks of size 2^( 7) =       0.000428150411

      target function =                  N/A
              le_mean =     -17.216609634861
             les_mean =     296.724265382328
             stat err =       0.000425017454
             autocorr =       1.155657762436
              std dev =       0.559122723056
             le_variance =       0.312618219437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660963486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216609634861       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216609634861       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609634861       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216609156630       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216610820684       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216608850580       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216611649020       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216610167023       residual = 1.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 2.284594e-13

solving harmonic davidson linear method for identity shift 9.7656e+09, overlap shift 9.7656e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216609634861       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216609634861       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609634861       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216609634861       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216611794956       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216601908782       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216614363262       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216608409132       residual = 2.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+09 is 5.726071e-14

solving harmonic davidson linear method for identity shift 3.9062e+10, overlap shift 3.9062e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216609634861       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216609634861       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216609634861       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216609634861       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216614813053       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216604732596       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216675904158       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216397002441       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216431177831       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217044564347       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216989198667       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215704781956       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216015357604       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216547825543       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216841157616       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215479062200       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217192869259       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.215238668885       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217635777497       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217428165609       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.212132078650       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.212255850696       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.214310875291       residual = 8.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.204433324871       residual = 2.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.225676761319       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.220729408323       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.231381619407       residual = 3.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.193181131880       residual = 8.61e-02           smallest_sin_value = 9.98e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+10 is 1.348491e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096977 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7507e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1591
    reference variance = 0.34363
====================================================
  Execution time = 1.9903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2363e-01
  Total weights = 2.0000e+06
  Execution time = 1.8472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402265236
  error estimate for blocks of size 2^( 2) =       0.000411464252
  error estimate for blocks of size 2^( 3) =       0.000419503066
  error estimate for blocks of size 2^( 4) =       0.000425651487
  error estimate for blocks of size 2^( 5) =       0.000429058420
  error estimate for blocks of size 2^( 6) =       0.000431100307
  error estimate for blocks of size 2^( 7) =       0.000433157076

      target function =                  N/A
              le_mean =     -17.216725081881
             les_mean =     296.739257023707
             stat err =       0.000429741823
             autocorr =       1.141274827067
              std dev =       0.568888952655
             le_variance =       0.323634640453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402265236
  error estimate for blocks of size 2^( 2) =       0.000411464252
  error estimate for blocks of size 2^( 3) =       0.000419503066
  error estimate for blocks of size 2^( 4) =       0.000425651487
  error estimate for blocks of size 2^( 5) =       0.000429058420
  error estimate for blocks of size 2^( 6) =       0.000431100307
  error estimate for blocks of size 2^( 7) =       0.000433157076

      target function =                  N/A
              le_mean =     -17.216725081881
             les_mean =     296.739257023708
             stat err =       0.000429741823
             autocorr =       1.141274827067
              std dev =       0.568888952655
             le_variance =       0.323634640453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402265236
  error estimate for blocks of size 2^( 2) =       0.000411464252
  error estimate for blocks of size 2^( 3) =       0.000419503066
  error estimate for blocks of size 2^( 4) =       0.000425651487
  error estimate for blocks of size 2^( 5) =       0.000429058420
  error estimate for blocks of size 2^( 6) =       0.000431100307
  error estimate for blocks of size 2^( 7) =       0.000433157076

      target function =                  N/A
              le_mean =     -17.216725081881
             les_mean =     296.739257023708
             stat err =       0.000429741823
             autocorr =       1.141274827065
              std dev =       0.568888952655
             le_variance =       0.323634640453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323674365050
                                         uncertainty =       0.005888753274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402265236
  error estimate for blocks of size 2^( 2) =       0.000411464252
  error estimate for blocks of size 2^( 3) =       0.000419503066
  error estimate for blocks of size 2^( 4) =       0.000425651487
  error estimate for blocks of size 2^( 5) =       0.000429058420
  error estimate for blocks of size 2^( 6) =       0.000431100307
  error estimate for blocks of size 2^( 7) =       0.000433157076

      target function =                  N/A
              le_mean =     -17.216725081881
             les_mean =     296.739257023708
             stat err =       0.000429741823
             autocorr =       1.141274827067
              std dev =       0.568888952655
             le_variance =       0.323634640453


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216725081881        initial  <--
     2.4414e+09     2.4414e+10             2.2846e-13       -17.216725081881
     9.7656e+09     9.7656e+10             5.7261e-14       -17.216725081881
     3.9062e+10     3.9062e+11             1.3485e-14       -17.216725081881

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0346
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0547e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1871
    reference variance = 0.374777
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1442e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314435897812
                                         uncertainty =       0.003343754278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314435897812
                                         uncertainty =       0.003343754278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396499613
  error estimate for blocks of size 2^( 2) =       0.000406196305
  error estimate for blocks of size 2^( 3) =       0.000415190727
  error estimate for blocks of size 2^( 4) =       0.000421146201
  error estimate for blocks of size 2^( 5) =       0.000425794983
  error estimate for blocks of size 2^( 6) =       0.000427274323
  error estimate for blocks of size 2^( 7) =       0.000427411987

      target function =                  N/A
              le_mean =     -17.216637976037
             les_mean =     296.727046927333
             stat err =       0.000425406874
             autocorr =       1.151127607848
              std dev =       0.560735130534
             le_variance =       0.314423886615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663797604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+10, overlap shift 2.4414e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637976037       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637976037       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216637976037       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216636608813       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216634421646       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216639155308       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216637962608       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216633142344       residual = 8.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+10 is 2.369817e-14

solving harmonic davidson linear method for identity shift 9.7656e+10, overlap shift 9.7656e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637976037       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637976037       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216637976037       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216711147000       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216637976037       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216687817791       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216635243995       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216661991159       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216653545814       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216732050829       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216501689649       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216851008019       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215733232506       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217922983541       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216322313945       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.218638625608       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.212494062213       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217778008166       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.215386874651       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.219869675656       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.214236192418       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.196610476907       residual = 6.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.224412267206       residual = 9.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.210939698693       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.230083054011       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.235281237065       residual = 5.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.170919725412       residual = 3.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.259924321026       residual = 3.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.235727203648       residual = 6.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.211605196989       residual = 4.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.198824805543       residual = 6.29e-02           smallest_sin_value = 9.98e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+10 is 5.793870e-15

solving harmonic davidson linear method for identity shift 3.9062e+11, overlap shift 3.9062e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216637976037       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216637976037       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216637976037       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216715510983       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216469432041       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217287537032       residual = 6.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217164095462       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216258823739       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215256456705       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216661679789       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.218514117486       residual = 5.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217485499680       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216427501727       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213693466960       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.213869356279       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.207087786636       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.220997233687       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.228126296665       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.232382230706       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.176319738780       residual = 2.57e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.213335945051       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.215334032227       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.278120387446       residual = 5.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.211503828739       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.186131402799       residual = 1.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.241778102379       residual = 1.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.176051556521       residual = 2.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.236514431365       residual = 9.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.133956164621       residual = 1.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -17.162202405211       residual = 4.51e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -17.314681119296       residual = 1.34e+00           smallest_sin_value = 9.98e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.046119420087       residual = 5.65e+00           smallest_sin_value = 9.91e-01
davidson iteration   32 stopping due to small subspace S singular value of 8.60e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+11 is 6.728242e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5696e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2428
    reference variance = 0.472108
====================================================
  Execution time = 2.0097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1474e-01
  Total weights = 2.0000e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396697022
  error estimate for blocks of size 2^( 2) =       0.000406472487
  error estimate for blocks of size 2^( 3) =       0.000414824834
  error estimate for blocks of size 2^( 4) =       0.000420109455
  error estimate for blocks of size 2^( 5) =       0.000423867589
  error estimate for blocks of size 2^( 6) =       0.000425084119
  error estimate for blocks of size 2^( 7) =       0.000424171028

      target function =                  N/A
              le_mean =     -17.216952462825
             les_mean =     296.738189004448
             stat err =       0.000423308048
             autocorr =       1.138662898132
              std dev =       0.561014308769
             le_variance =       0.314737054643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396697022
  error estimate for blocks of size 2^( 2) =       0.000406472487
  error estimate for blocks of size 2^( 3) =       0.000414824834
  error estimate for blocks of size 2^( 4) =       0.000420109455
  error estimate for blocks of size 2^( 5) =       0.000423867589
  error estimate for blocks of size 2^( 6) =       0.000425084119
  error estimate for blocks of size 2^( 7) =       0.000424171028

      target function =                  N/A
              le_mean =     -17.216952462825
             les_mean =     296.738189004448
             stat err =       0.000423308048
             autocorr =       1.138662898133
              std dev =       0.561014308769
             le_variance =       0.314737054644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396697022
  error estimate for blocks of size 2^( 2) =       0.000406472487
  error estimate for blocks of size 2^( 3) =       0.000414824834
  error estimate for blocks of size 2^( 4) =       0.000420109455
  error estimate for blocks of size 2^( 5) =       0.000423867589
  error estimate for blocks of size 2^( 6) =       0.000425084119
  error estimate for blocks of size 2^( 7) =       0.000424171028

      target function =                  N/A
              le_mean =     -17.216952462825
             les_mean =     296.738189004448
             stat err =       0.000423308048
             autocorr =       1.138662898130
              std dev =       0.561014308769
             le_variance =       0.314737054644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314782373098
                                         uncertainty =       0.002918485036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396697022
  error estimate for blocks of size 2^( 2) =       0.000406472487
  error estimate for blocks of size 2^( 3) =       0.000414824834
  error estimate for blocks of size 2^( 4) =       0.000420109455
  error estimate for blocks of size 2^( 5) =       0.000423867589
  error estimate for blocks of size 2^( 6) =       0.000425084119
  error estimate for blocks of size 2^( 7) =       0.000424171028

      target function =                  N/A
              le_mean =     -17.216952462825
             les_mean =     296.738189004448
             stat err =       0.000423308048
             autocorr =       1.138662898131
              std dev =       0.561014308769
             le_variance =       0.314737054643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216952462825        initial  <--
     2.4414e+10     2.4414e+11             2.3698e-14       -17.216952462825
     9.7656e+10     9.7656e+11             5.7939e-15       -17.216952462825
     3.9062e+11     3.9062e+12             6.7282e-16       -17.216952462825

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3748
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5077e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1544
    reference variance = 0.187994
====================================================
  Execution time = 2.0372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2018e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320110381963
                                         uncertainty =       0.005203102667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320110381963
                                         uncertainty =       0.005203102667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400115400
  error estimate for blocks of size 2^( 2) =       0.000409653896
  error estimate for blocks of size 2^( 3) =       0.000417955241
  error estimate for blocks of size 2^( 4) =       0.000424183946
  error estimate for blocks of size 2^( 5) =       0.000428300435
  error estimate for blocks of size 2^( 6) =       0.000431693462
  error estimate for blocks of size 2^( 7) =       0.000430519635

      target function =                  N/A
              le_mean =     -17.216816828235
             les_mean =     296.738966203214
             stat err =       0.000428674369
             autocorr =       1.147848315728
              std dev =       0.565848624920
             le_variance =       0.320184666323


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721681682823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816828235       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216816828235       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216816828235       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216816828235       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216786914543       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216820316014       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216808906060       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216820630004       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216335578957       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216247349983       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213700212790       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.218776252031       residual = 5.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217442616713       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.222210475977       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.211821203122       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216584270008       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217570341916       residual = 9.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.212999169027       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.220992751132       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.213609617761       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.236479063295       residual = 5.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.223258098220       residual = 7.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.235641725988       residual = 5.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.167211011034       residual = 3.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.184707067317       residual = 1.68e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.054887002906       residual = 4.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.335325014205       residual = 2.24e+00           smallest_sin_value = 9.98e-01
davidson iteration   27 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 2.257023e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816828235       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216816828235       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216816828235       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216816828235       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216355511438       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217116342248       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217189070750       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216749574652       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.225815852828       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214715910815       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216471456373       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.182489497806       residual = 1.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.229532612042       residual = 2.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.212735076551       residual = 3.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.205460775720       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.205472594724       residual = 2.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.210483258848       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.208735439685       residual = 1.06e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.202707422353       residual = 5.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.132187782993       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.204638174252       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.313597977768       residual = 1.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.075741319866       residual = 3.50e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.189364906516       residual = 1.25e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.384564829334       residual = 4.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.238072415613       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -18.760157248861       residual = 3.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.638389395872       residual = 5.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.175372724719       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.657177848688       residual = 4.99e+01           smallest_sin_value = 9.98e-01
davidson iteration   30 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 2.484973e-16

solving harmonic davidson linear method for identity shift 3.9062e+12, overlap shift 3.9062e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216816828235       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216816828235       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216816828235       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213850282697       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215476869467       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.210812450866       residual = 6.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.199846274347       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.244770447467       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.212813985369       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.179738449919       residual = 2.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.234925495887       residual = 4.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.156420830299       residual = 5.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.054250041624       residual = 4.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.255318693517       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.320018724252       residual = 1.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.232830397163       residual = 5.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.175679301536       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.297885091413       residual = 9.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.970647633624       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.837863279330       residual = 2.39e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.062592827006       residual = 3.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.525700248903       residual = 1.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.015631906802       residual = 8.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.503045367166       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.170105016136       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.383161776562       residual = 4.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.916124272477       residual = 2.35e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.089812913375       residual = 1.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.467654862435       residual = 8.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -15.822863788778       residual = 2.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -12.231665059876       residual = 4.46e+03           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.293452055094       residual = 6.79e+01           smallest_sin_value = 9.95e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.28e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+12 is 3.751936e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160016 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5934e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2036
    reference variance = 0.143322
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4242e-01
  Total weights = 2.0000e+06
  Execution time = 1.8320e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413773995
  error estimate for blocks of size 2^( 2) =       0.000423379438
  error estimate for blocks of size 2^( 3) =       0.000431354999
  error estimate for blocks of size 2^( 4) =       0.000437331876
  error estimate for blocks of size 2^( 5) =       0.000441644275
  error estimate for blocks of size 2^( 6) =       0.000443732378
  error estimate for blocks of size 2^( 7) =       0.000443829354

      target function =                  N/A
              le_mean =     -17.216911108717
             les_mean =     296.764445791591
             stat err =       0.000441634471
             autocorr =       1.139198865090
              std dev =       0.585164795028
             le_variance =       0.342417837340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413773995
  error estimate for blocks of size 2^( 2) =       0.000423379438
  error estimate for blocks of size 2^( 3) =       0.000431354999
  error estimate for blocks of size 2^( 4) =       0.000437331876
  error estimate for blocks of size 2^( 5) =       0.000441644275
  error estimate for blocks of size 2^( 6) =       0.000443732378
  error estimate for blocks of size 2^( 7) =       0.000443829354

      target function =                  N/A
              le_mean =     -17.216911108717
             les_mean =     296.764445791591
             stat err =       0.000441634471
             autocorr =       1.139198865091
              std dev =       0.585164795028
             le_variance =       0.342417837340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413773995
  error estimate for blocks of size 2^( 2) =       0.000423379438
  error estimate for blocks of size 2^( 3) =       0.000431354999
  error estimate for blocks of size 2^( 4) =       0.000437331876
  error estimate for blocks of size 2^( 5) =       0.000441644275
  error estimate for blocks of size 2^( 6) =       0.000443732378
  error estimate for blocks of size 2^( 7) =       0.000443829354

      target function =                  N/A
              le_mean =     -17.216911108717
             les_mean =     296.764445791591
             stat err =       0.000441634471
             autocorr =       1.139198865090
              std dev =       0.585164795028
             le_variance =       0.342417837340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342453570852
                                         uncertainty =       0.021059449445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413773995
  error estimate for blocks of size 2^( 2) =       0.000423379438
  error estimate for blocks of size 2^( 3) =       0.000431354999
  error estimate for blocks of size 2^( 4) =       0.000437331876
  error estimate for blocks of size 2^( 5) =       0.000441644275
  error estimate for blocks of size 2^( 6) =       0.000443732378
  error estimate for blocks of size 2^( 7) =       0.000443829354

      target function =                  N/A
              le_mean =     -17.216911108717
             les_mean =     296.764445791591
             stat err =       0.000441634471
             autocorr =       1.139198865090
              std dev =       0.585164795028
             le_variance =       0.342417837340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216911108717        initial
     2.4414e+11     2.4414e+12             2.2570e-15       -17.216911108717  <--
     9.7656e+11     9.7656e+12             2.4850e-16       -17.216911108717
     3.9062e+12     3.9062e+13             3.7519e-17       -17.216911108717

*****************************************************************************
Applying the update for shift_i =   2.4414e+11     and shift_s =   2.4414e+12
*****************************************************************************

  Execution time = 2.9444e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5384e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1719
    reference variance = 0.77492
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1925e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319272648207
                                         uncertainty =       0.004440292981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319272648207
                                         uncertainty =       0.004440292981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399531444
  error estimate for blocks of size 2^( 2) =       0.000409257925
  error estimate for blocks of size 2^( 3) =       0.000417405639
  error estimate for blocks of size 2^( 4) =       0.000423811737
  error estimate for blocks of size 2^( 5) =       0.000426917679
  error estimate for blocks of size 2^( 6) =       0.000427121523
  error estimate for blocks of size 2^( 7) =       0.000429030719

      target function =                  N/A
              le_mean =     -17.216951506748
             les_mean =     296.742669775634
             stat err =       0.000426720414
             autocorr =       1.140735376961
              std dev =       0.565022786744
             le_variance =       0.319250749540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721695150675e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+10, overlap shift 6.1035e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216951506748       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216951506748       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216951506748       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217014293536       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216949782502       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216951072853       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216482076916       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217015385904       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216870704321       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217214668580       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217058257758       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216863816186       residual = 7.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217177271073       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215601720089       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.214337673305       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215415779666       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214652425088       residual = 7.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.195526590465       residual = 7.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.219400405564       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.218940113845       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.219464423788       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.219372405553       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.210975473062       residual = 5.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.204652626677       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.194557215790       residual = 7.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.232963357730       residual = 3.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.211389982247       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.231704777117       residual = 3.37e-02           smallest_sin_value = 9.99e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.66e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+10 is 6.658625e-15

solving harmonic davidson linear method for identity shift 2.4414e+11, overlap shift 2.4414e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216951506748       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216951506748       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216951506748       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216951506748       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216954782423       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217181633698       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216917249634       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217065011874       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216007800093       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.218660919306       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217191156405       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.211727272940       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.219846416898       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217406949466       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.224009173871       residual = 7.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216326422535       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.214965139895       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.224482552077       residual = 8.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.212367277050       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.194927143111       residual = 7.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.202289577169       residual = 3.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.220167722682       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.197387615109       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.194477944272       residual = 8.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.276646933607       residual = 5.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.221022033045       residual = 3.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.138385994846       residual = 9.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.141337443953       residual = 8.78e-01           smallest_sin_value = 9.98e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+11 is 1.784009e-15

solving harmonic davidson linear method for identity shift 9.7656e+11, overlap shift 9.7656e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216951506748       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216951506748       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216951506748       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216837353131       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215944447838       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.219642353906       residual = 9.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.219224855757       residual = 7.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217742903433       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214084922170       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217853091473       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.211511294683       residual = 4.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.228852439884       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.198063742415       residual = 4.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.224460276431       residual = 7.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.195476094447       residual = 7.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.252313671822       residual = 1.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.175773478944       residual = 2.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.189303929564       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.158314542631       residual = 5.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.219514862397       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.280201850737       residual = 6.05e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.111153690860       residual = 1.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.192346173285       residual = 8.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.256958650947       residual = 2.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.311967187629       residual = 1.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.108065178933       residual = 1.77e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.311845420657       residual = 1.31e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.508485908557       residual = 1.29e+01           smallest_sin_value = 9.95e-01
davidson iteration   28 stopping due to small subspace S singular value of 8.98e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+11 is 2.499946e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5882e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2179
    reference variance = 0.233237
====================================================
  Execution time = 1.9963e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2050e-01
  Total weights = 2.0000e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400313393
  error estimate for blocks of size 2^( 2) =       0.000409703045
  error estimate for blocks of size 2^( 3) =       0.000418169104
  error estimate for blocks of size 2^( 4) =       0.000423958534
  error estimate for blocks of size 2^( 5) =       0.000427447496
  error estimate for blocks of size 2^( 6) =       0.000427349398
  error estimate for blocks of size 2^( 7) =       0.000427925635

      target function =                  N/A
              le_mean =     -17.217022607948
             les_mean =     296.746368948214
             stat err =       0.000426670266
             autocorr =       1.136016176244
              std dev =       0.566128630132
             le_variance =       0.320501625855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400313393
  error estimate for blocks of size 2^( 2) =       0.000409703045
  error estimate for blocks of size 2^( 3) =       0.000418169104
  error estimate for blocks of size 2^( 4) =       0.000423958534
  error estimate for blocks of size 2^( 5) =       0.000427447496
  error estimate for blocks of size 2^( 6) =       0.000427349398
  error estimate for blocks of size 2^( 7) =       0.000427925635

      target function =                  N/A
              le_mean =     -17.217022607948
             les_mean =     296.746368948214
             stat err =       0.000426670266
             autocorr =       1.136016176239
              std dev =       0.566128630132
             le_variance =       0.320501625855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400313393
  error estimate for blocks of size 2^( 2) =       0.000409703045
  error estimate for blocks of size 2^( 3) =       0.000418169104
  error estimate for blocks of size 2^( 4) =       0.000423958534
  error estimate for blocks of size 2^( 5) =       0.000427447496
  error estimate for blocks of size 2^( 6) =       0.000427349398
  error estimate for blocks of size 2^( 7) =       0.000427925635

      target function =                  N/A
              le_mean =     -17.217022607948
             les_mean =     296.746368948214
             stat err =       0.000426670266
             autocorr =       1.136016176248
              std dev =       0.566128630132
             le_variance =       0.320501625855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319994514752
                                         uncertainty =       0.006270998330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400313393
  error estimate for blocks of size 2^( 2) =       0.000409703045
  error estimate for blocks of size 2^( 3) =       0.000418169104
  error estimate for blocks of size 2^( 4) =       0.000423958534
  error estimate for blocks of size 2^( 5) =       0.000427447496
  error estimate for blocks of size 2^( 6) =       0.000427349398
  error estimate for blocks of size 2^( 7) =       0.000427925635

      target function =                  N/A
              le_mean =     -17.217022607948
             les_mean =     296.746368948214
             stat err =       0.000426670266
             autocorr =       1.136016176246
              std dev =       0.566128630132
             le_variance =       0.320501625855


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217022607948        initial  <--
     6.1035e+10     6.1035e+11             6.6586e-15       -17.217022607948
     2.4414e+11     2.4414e+12             1.7840e-15       -17.217022607948
     9.7656e+11     9.7656e+12             2.4999e-16       -17.217022607948

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3095
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5197e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.205494
====================================================
  Execution time = 2.0614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1370e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6440e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313660503415
                                         uncertainty =       0.002904099758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313660503415
                                         uncertainty =       0.002904099758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396040974
  error estimate for blocks of size 2^( 2) =       0.000405536353
  error estimate for blocks of size 2^( 3) =       0.000414395736
  error estimate for blocks of size 2^( 4) =       0.000421168851
  error estimate for blocks of size 2^( 5) =       0.000424793265
  error estimate for blocks of size 2^( 6) =       0.000426352908
  error estimate for blocks of size 2^( 7) =       0.000428028190

      target function =                  N/A
              le_mean =     -17.217240862297
             les_mean =     296.747079658946
             stat err =       0.000425085803
             autocorr =       1.152054337696
              std dev =       0.560086516033
             le_variance =       0.313696905442


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721724086230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+11, overlap shift 6.1035e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217240862297       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217240862297       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217240862297       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217070318109       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.219730149731       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.218219520252       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.218276437427       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.211612727823       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213922978555       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212475421596       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213443841951       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216477210900       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214742841018       residual = 9.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.213100663382       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.242030504989       residual = 9.54e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.248709277342       residual = 1.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.241180562811       residual = 8.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.169849144641       residual = 3.55e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.269596747782       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.087095239222       residual = 2.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.239624552713       residual = 8.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.239416142328       residual = 7.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.407090337440       residual = 5.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.332753571493       residual = 2.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.237876157295       residual = 8.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.176220071934       residual = 2.51e-01           smallest_sin_value = 9.99e-01
davidson iteration   26 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+11 is 3.826763e-16

solving harmonic davidson linear method for identity shift 2.4414e+12, overlap shift 2.4414e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217240862297       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217240862297       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+12, overlap shift 9.7656e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217240862297       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217240862297       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.27e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6271e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2517
    reference variance = 0.371246
====================================================
  Execution time = 2.0942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1495e-01
  Total weights = 2.0000e+06
  Execution time = 1.8433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396833642
  error estimate for blocks of size 2^( 2) =       0.000406127048
  error estimate for blocks of size 2^( 3) =       0.000415005858
  error estimate for blocks of size 2^( 4) =       0.000421501893
  error estimate for blocks of size 2^( 5) =       0.000425417203
  error estimate for blocks of size 2^( 6) =       0.000428178318
  error estimate for blocks of size 2^( 7) =       0.000429566913

      target function =                  N/A
              le_mean =     -17.217019935621
             les_mean =     296.740729185125
             stat err =       0.000426166082
             autocorr =       1.153296030364
              std dev =       0.561207518700
             le_variance =       0.314953879045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396833642
  error estimate for blocks of size 2^( 2) =       0.000406127048
  error estimate for blocks of size 2^( 3) =       0.000415005858
  error estimate for blocks of size 2^( 4) =       0.000421501893
  error estimate for blocks of size 2^( 5) =       0.000425417203
  error estimate for blocks of size 2^( 6) =       0.000428178318
  error estimate for blocks of size 2^( 7) =       0.000429566913

      target function =                  N/A
              le_mean =     -17.217019935621
             les_mean =     296.740729185125
             stat err =       0.000426166082
             autocorr =       1.153296030367
              std dev =       0.561207518700
             le_variance =       0.314953879045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396833642
  error estimate for blocks of size 2^( 2) =       0.000406127048
  error estimate for blocks of size 2^( 3) =       0.000415005858
  error estimate for blocks of size 2^( 4) =       0.000421501893
  error estimate for blocks of size 2^( 5) =       0.000425417203
  error estimate for blocks of size 2^( 6) =       0.000428178318
  error estimate for blocks of size 2^( 7) =       0.000429566913

      target function =                  N/A
              le_mean =     -17.217019935621
             les_mean =     296.740729185125
             stat err =       0.000426166082
             autocorr =       1.153296030364
              std dev =       0.561207518700
             le_variance =       0.314953879045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315072292587
                                         uncertainty =       0.003690223387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396833642
  error estimate for blocks of size 2^( 2) =       0.000406127048
  error estimate for blocks of size 2^( 3) =       0.000415005858
  error estimate for blocks of size 2^( 4) =       0.000421501893
  error estimate for blocks of size 2^( 5) =       0.000425417203
  error estimate for blocks of size 2^( 6) =       0.000428178318
  error estimate for blocks of size 2^( 7) =       0.000429566913

      target function =                  N/A
              le_mean =     -17.217019935621
             les_mean =     296.740729185125
             stat err =       0.000426166082
             autocorr =       1.153296030364
              std dev =       0.561207518700
             le_variance =       0.314953879045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217019935621        initial  <--
     6.1035e+11     6.1035e+12             3.8268e-16       -17.217019935621
     2.4414e+12     2.4414e+13             0.0000e+00       -17.217019935621
     9.7656e+12     9.7656e+13             0.0000e+00       -17.217019935621

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2454
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6522e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2373
    reference variance = 0.254559
====================================================
  Execution time = 2.0510e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2025e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320295405620
                                         uncertainty =       0.004426072807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320295405620
                                         uncertainty =       0.004426072807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400156466
  error estimate for blocks of size 2^( 2) =       0.000409840744
  error estimate for blocks of size 2^( 3) =       0.000418772788
  error estimate for blocks of size 2^( 4) =       0.000425263921
  error estimate for blocks of size 2^( 5) =       0.000429920910
  error estimate for blocks of size 2^( 6) =       0.000431927144
  error estimate for blocks of size 2^( 7) =       0.000431872203

      target function =                  N/A
              le_mean =     -17.216784821272
             les_mean =     296.737929816156
             stat err =       0.000429746044
             autocorr =       1.153357908819
              std dev =       0.565906701043
             le_variance =       0.320250394285


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721678482127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+12, overlap shift 6.1035e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216784821272       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216784821272       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216784821272       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217088013409       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216922975539       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217171251458       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.206368290019       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.223736978350       residual = 7.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.209427765699       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.212098175202       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.159923443438       residual = 4.91e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.103640784551       residual = 1.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.149216128214       residual = 7.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.258485588399       residual = 2.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.131974853489       residual = 1.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.334896571798       residual = 2.92e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.439854646519       residual = 7.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.571739308566       residual = 2.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.377995160749       residual = 4.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.473206839527       residual = 9.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.947906871973       residual = 1.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.942953988753       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -18.238063030394       residual = 1.52e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.534891384879       residual = 9.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.567248489189       residual = 2.44e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.059880599298       residual = 1.93e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.419914307010       residual = 1.24e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.017091806383       residual = 2.88e+02           smallest_sin_value = 9.98e-01
davidson iteration   28 stopping due to small subspace S singular value of 9.75e-01
davidson solver did not converge after         28 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+12 is 2.423126e-17

solving harmonic davidson linear method for identity shift 2.4414e+13, overlap shift 2.4414e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216784821272       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216784821272       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216784821272       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216784821272       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.203234550228       residual = 3.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.429274456891       residual = 6.95e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.159575399637       residual = 6.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.227057617968       residual = 3.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.365061114712       residual = 3.23e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.046922525005       residual = 4.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.015235986789       residual = 6.18e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -18.094959007769       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.567897507787       residual = 1.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.689531073597       residual = 3.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.449259428070       residual = 9.27e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.023293070138       residual = 5.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.578897774182       residual = 6.22e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.170704783137       residual = 2.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -13.553242923907       residual = 2.08e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -14.488075879190       residual = 1.20e+03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -20.355338995466       residual = 1.55e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.021748795604       residual = 2.01e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -19.847357108841       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -24.920831861136       residual = 9.24e+03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -15.757362061832       residual = 3.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -19.776851261277       residual = 1.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -11.698736879390       residual = 5.21e+03           smallest_sin_value = 1.00e+00
davidson iteration   27 stopping due to too large eigenvalue change
davidson solver did not converge after         27 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+13 is 6.057814e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+13, overlap shift 9.7656e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216784821272       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216784821272       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216784821272       residual = 6.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216144731410       residual = 5.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -15.659379506783       residual = 3.82e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.518020189033       residual = 1.35e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.239568815151       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905878196666       residual = 1.43e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.538124025545       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.124281442967       residual = 2.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.099416661941       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.237788823106       residual = 9.34e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.161001882407       residual = 2.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.795709457658       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.866495291943       residual = 6.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -18.102966321246       residual = 1.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -15.950617397395       residual = 2.98e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -19.990397929511       residual = 1.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -13.504158243950       residual = 2.04e+03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.370682428395       residual = 1.26e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -19.675731433782       residual = 9.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -21.882915300058       residual = 3.61e+03           smallest_sin_value = 1.00e+00
davidson iteration   22 stopping due to too large eigenvalue change
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+13 is 1.514454e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.225298 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6033e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.306
    reference variance = 0.299135
====================================================
  Execution time = 2.1914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1810e-01
  Total weights = 2.0000e+06
  Execution time = 1.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398812738
  error estimate for blocks of size 2^( 2) =       0.000408478703
  error estimate for blocks of size 2^( 3) =       0.000417592337
  error estimate for blocks of size 2^( 4) =       0.000423622934
  error estimate for blocks of size 2^( 5) =       0.000427880629
  error estimate for blocks of size 2^( 6) =       0.000430503197
  error estimate for blocks of size 2^( 7) =       0.000431228260

      target function =                  N/A
              le_mean =     -17.216673245147
             les_mean =     296.731940670792
             stat err =       0.000428308755
             autocorr =       1.153389149436
              std dev =       0.564006382653
             le_variance =       0.318103199673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398812738
  error estimate for blocks of size 2^( 2) =       0.000408478703
  error estimate for blocks of size 2^( 3) =       0.000417592337
  error estimate for blocks of size 2^( 4) =       0.000423622934
  error estimate for blocks of size 2^( 5) =       0.000427880629
  error estimate for blocks of size 2^( 6) =       0.000430503197
  error estimate for blocks of size 2^( 7) =       0.000431228260

      target function =                  N/A
              le_mean =     -17.216673245147
             les_mean =     296.731940670792
             stat err =       0.000428308755
             autocorr =       1.153389149436
              std dev =       0.564006382653
             le_variance =       0.318103199673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398812738
  error estimate for blocks of size 2^( 2) =       0.000408478703
  error estimate for blocks of size 2^( 3) =       0.000417592337
  error estimate for blocks of size 2^( 4) =       0.000423622934
  error estimate for blocks of size 2^( 5) =       0.000427880629
  error estimate for blocks of size 2^( 6) =       0.000430503197
  error estimate for blocks of size 2^( 7) =       0.000431228260

      target function =                  N/A
              le_mean =     -17.216673245147
             les_mean =     296.731940670792
             stat err =       0.000428308755
             autocorr =       1.153389149436
              std dev =       0.564006382653
             le_variance =       0.318103199673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318177170707
                                         uncertainty =       0.004795133483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398812738
  error estimate for blocks of size 2^( 2) =       0.000408478703
  error estimate for blocks of size 2^( 3) =       0.000417592337
  error estimate for blocks of size 2^( 4) =       0.000423622934
  error estimate for blocks of size 2^( 5) =       0.000427880629
  error estimate for blocks of size 2^( 6) =       0.000430503197
  error estimate for blocks of size 2^( 7) =       0.000431228260

      target function =                  N/A
              le_mean =     -17.216673245147
             les_mean =     296.731940670792
             stat err =       0.000428308755
             autocorr =       1.153389149436
              std dev =       0.564006382653
             le_variance =       0.318103199673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216673245147        initial  <--
     6.1035e+12     6.1035e+13             2.4231e-17       -17.216673245147
     2.4414e+13     2.4414e+14             6.0578e-18       -17.216673245147
     9.7656e+13     9.7656e+14             1.5145e-18       -17.216673245147

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3068
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7346e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2468
    reference variance = 0.297375
====================================================
  Execution time = 2.2494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1764e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4741e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317671176768
                                         uncertainty =       0.004046853681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317671176768
                                         uncertainty =       0.004046853681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398524416
  error estimate for blocks of size 2^( 2) =       0.000408297390
  error estimate for blocks of size 2^( 3) =       0.000416817926
  error estimate for blocks of size 2^( 4) =       0.000423683785
  error estimate for blocks of size 2^( 5) =       0.000426896840
  error estimate for blocks of size 2^( 6) =       0.000427376499
  error estimate for blocks of size 2^( 7) =       0.000428399205

      target function =                  N/A
              le_mean =     -17.217559786653
             les_mean =     296.762008268646
             stat err =       0.000426589082
             autocorr =       1.145802074778
              std dev =       0.563598634215
             le_variance =       0.317643420489


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721755978665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+13, overlap shift 6.1035e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217559786653       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217559786653       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+14, overlap shift 2.4414e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217559786653       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217559786653       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+14, overlap shift 9.7656e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217559786653       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217559786653       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.25e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226385 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7974e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2361
    reference variance = 0.298644
====================================================
  Execution time = 2.0109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1580e-01
  Total weights = 2.0000e+06
  Execution time = 1.8406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397364742
  error estimate for blocks of size 2^( 2) =       0.000407136863
  error estimate for blocks of size 2^( 3) =       0.000415500717
  error estimate for blocks of size 2^( 4) =       0.000421360280
  error estimate for blocks of size 2^( 5) =       0.000426136841
  error estimate for blocks of size 2^( 6) =       0.000428104016
  error estimate for blocks of size 2^( 7) =       0.000428590907

      target function =                  N/A
              le_mean =     -17.216180058005
             les_mean =     296.712653108350
             stat err =       0.000426048011
             autocorr =       1.149577948007
              std dev =       0.561958607543
             le_variance =       0.315797476591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397364742
  error estimate for blocks of size 2^( 2) =       0.000407136863
  error estimate for blocks of size 2^( 3) =       0.000415500717
  error estimate for blocks of size 2^( 4) =       0.000421360280
  error estimate for blocks of size 2^( 5) =       0.000426136841
  error estimate for blocks of size 2^( 6) =       0.000428104016
  error estimate for blocks of size 2^( 7) =       0.000428590907

      target function =                  N/A
              le_mean =     -17.216180058005
             les_mean =     296.712653108350
             stat err =       0.000426048011
             autocorr =       1.149577948007
              std dev =       0.561958607543
             le_variance =       0.315797476591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397364742
  error estimate for blocks of size 2^( 2) =       0.000407136863
  error estimate for blocks of size 2^( 3) =       0.000415500717
  error estimate for blocks of size 2^( 4) =       0.000421360280
  error estimate for blocks of size 2^( 5) =       0.000426136841
  error estimate for blocks of size 2^( 6) =       0.000428104016
  error estimate for blocks of size 2^( 7) =       0.000428590907

      target function =                  N/A
              le_mean =     -17.216180058005
             les_mean =     296.712653108350
             stat err =       0.000426048011
             autocorr =       1.149577948007
              std dev =       0.561958607543
             le_variance =       0.315797476591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315817228287
                                         uncertainty =       0.003040996104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397364742
  error estimate for blocks of size 2^( 2) =       0.000407136863
  error estimate for blocks of size 2^( 3) =       0.000415500717
  error estimate for blocks of size 2^( 4) =       0.000421360280
  error estimate for blocks of size 2^( 5) =       0.000426136841
  error estimate for blocks of size 2^( 6) =       0.000428104016
  error estimate for blocks of size 2^( 7) =       0.000428590907

      target function =                  N/A
              le_mean =     -17.216180058005
             les_mean =     296.712653108350
             stat err =       0.000426048011
             autocorr =       1.149577948007
              std dev =       0.561958607543
             le_variance =       0.315797476591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216180058005        initial  <--
     6.1035e+13     6.1035e+14             0.0000e+00       -17.216180058005
     2.4414e+14     2.4414e+15             0.0000e+00       -17.216180058005
     9.7656e+14     9.7656e+15             0.0000e+00       -17.216180058005

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4024
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7468e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2476
    reference variance = 0.237322
====================================================
  Execution time = 2.0699e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2659e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326501985686
                                         uncertainty =       0.006497275881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326501985686
                                         uncertainty =       0.006497275881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404095449
  error estimate for blocks of size 2^( 2) =       0.000413313517
  error estimate for blocks of size 2^( 3) =       0.000422168949
  error estimate for blocks of size 2^( 4) =       0.000428320767
  error estimate for blocks of size 2^( 5) =       0.000433055231
  error estimate for blocks of size 2^( 6) =       0.000435328630
  error estimate for blocks of size 2^( 7) =       0.000436416630

      target function =                  N/A
              le_mean =     -17.217501932391
             les_mean =     296.768958891600
             stat err =       0.000433280315
             autocorr =       1.149661528211
              std dev =       0.571477263765
             le_variance =       0.326586263000


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721750193239e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+14, overlap shift 6.1035e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217501932391       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217501932391       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.21e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.4414e+15, overlap shift 2.4414e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217501932391       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217501932391       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.7656e+15, overlap shift 9.7656e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217501932391       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217501932391       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.28e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+15 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6233e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.132294
====================================================
  Execution time = 2.0203e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2207e-01
  Total weights = 2.0000e+06
  Execution time = 1.8364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401293103
  error estimate for blocks of size 2^( 2) =       0.000411038793
  error estimate for blocks of size 2^( 3) =       0.000419988074
  error estimate for blocks of size 2^( 4) =       0.000426269831
  error estimate for blocks of size 2^( 5) =       0.000430038035
  error estimate for blocks of size 2^( 6) =       0.000434477502
  error estimate for blocks of size 2^( 7) =       0.000434534306

      target function =                  N/A
              le_mean =     -17.216975996382
             les_mean =     296.746334608766
             stat err =       0.000431329918
             autocorr =       1.155302662729
              std dev =       0.567514149441
             le_variance =       0.322072309816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401293103
  error estimate for blocks of size 2^( 2) =       0.000411038793
  error estimate for blocks of size 2^( 3) =       0.000419988074
  error estimate for blocks of size 2^( 4) =       0.000426269831
  error estimate for blocks of size 2^( 5) =       0.000430038035
  error estimate for blocks of size 2^( 6) =       0.000434477502
  error estimate for blocks of size 2^( 7) =       0.000434534306

      target function =                  N/A
              le_mean =     -17.216975996382
             les_mean =     296.746334608766
             stat err =       0.000431329918
             autocorr =       1.155302662729
              std dev =       0.567514149441
             le_variance =       0.322072309816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401293103
  error estimate for blocks of size 2^( 2) =       0.000411038793
  error estimate for blocks of size 2^( 3) =       0.000419988074
  error estimate for blocks of size 2^( 4) =       0.000426269831
  error estimate for blocks of size 2^( 5) =       0.000430038035
  error estimate for blocks of size 2^( 6) =       0.000434477502
  error estimate for blocks of size 2^( 7) =       0.000434534306

      target function =                  N/A
              le_mean =     -17.216975996382
             les_mean =     296.746334608766
             stat err =       0.000431329918
             autocorr =       1.155302662729
              std dev =       0.567514149441
             le_variance =       0.322072309816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322113694998
                                         uncertainty =       0.005873831210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401293103
  error estimate for blocks of size 2^( 2) =       0.000411038793
  error estimate for blocks of size 2^( 3) =       0.000419988074
  error estimate for blocks of size 2^( 4) =       0.000426269831
  error estimate for blocks of size 2^( 5) =       0.000430038035
  error estimate for blocks of size 2^( 6) =       0.000434477502
  error estimate for blocks of size 2^( 7) =       0.000434534306

      target function =                  N/A
              le_mean =     -17.216975996382
             les_mean =     296.746334608766
             stat err =       0.000431329918
             autocorr =       1.155302662729
              std dev =       0.567514149441
             le_variance =       0.322072309816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216975996382        initial  <--
     6.1035e+14     6.1035e+15             0.0000e+00       -17.216975996382
     2.4414e+15     2.4414e+16             0.0000e+00       -17.216975996382
     9.7656e+15     9.7656e+16             0.0000e+00       -17.216975996382

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4804
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2463
    reference variance = 0.318462
====================================================
  Execution time = 2.0788e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2081e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867524480
                                         uncertainty =       0.004901339844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320867524480
                                         uncertainty =       0.004901339844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400507459
  error estimate for blocks of size 2^( 2) =       0.000410220075
  error estimate for blocks of size 2^( 3) =       0.000418992161
  error estimate for blocks of size 2^( 4) =       0.000424854293
  error estimate for blocks of size 2^( 5) =       0.000429330717
  error estimate for blocks of size 2^( 6) =       0.000432107761
  error estimate for blocks of size 2^( 7) =       0.000434672578

      target function =                  N/A
              le_mean =     -17.216820684206
             les_mean =     296.739726760590
             stat err =       0.000430241337
             autocorr =       1.153992676917
              std dev =       0.566403079879
             le_variance =       0.320812448896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682068421e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+15, overlap shift 6.1035e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216820684206       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216820684206       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216820684206       residual = 5.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.205428142382       residual = 5.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.737562626439       residual = 8.38e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+15 is 1.227979e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+16, overlap shift 2.4414e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216820684206       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216820684206       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216820684206       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+16 is 3.069946e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+16, overlap shift 9.7656e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216820684206       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216820684206       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216820684206       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+16 is 7.674866e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229018 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6296e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2589
    reference variance = 0.222123
====================================================
  Execution time = 2.0233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1714e-01
  Total weights = 2.0000e+06
  Execution time = 1.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398205611
  error estimate for blocks of size 2^( 2) =       0.000407590435
  error estimate for blocks of size 2^( 3) =       0.000416540041
  error estimate for blocks of size 2^( 4) =       0.000422320106
  error estimate for blocks of size 2^( 5) =       0.000426523958
  error estimate for blocks of size 2^( 6) =       0.000427539985
  error estimate for blocks of size 2^( 7) =       0.000429056002

      target function =                  N/A
              le_mean =     -17.216485483632
             les_mean =     296.724507666734
             stat err =       0.000426360013
             autocorr =       1.146405293091
              std dev =       0.563147775637
             le_variance =       0.317135417205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398205611
  error estimate for blocks of size 2^( 2) =       0.000407590435
  error estimate for blocks of size 2^( 3) =       0.000416540041
  error estimate for blocks of size 2^( 4) =       0.000422320106
  error estimate for blocks of size 2^( 5) =       0.000426523958
  error estimate for blocks of size 2^( 6) =       0.000427539985
  error estimate for blocks of size 2^( 7) =       0.000429056002

      target function =                  N/A
              le_mean =     -17.216485483632
             les_mean =     296.724507666734
             stat err =       0.000426360013
             autocorr =       1.146405293091
              std dev =       0.563147775637
             le_variance =       0.317135417205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398205611
  error estimate for blocks of size 2^( 2) =       0.000407590435
  error estimate for blocks of size 2^( 3) =       0.000416540041
  error estimate for blocks of size 2^( 4) =       0.000422320106
  error estimate for blocks of size 2^( 5) =       0.000426523958
  error estimate for blocks of size 2^( 6) =       0.000427539985
  error estimate for blocks of size 2^( 7) =       0.000429056002

      target function =                  N/A
              le_mean =     -17.216485483632
             les_mean =     296.724507666734
             stat err =       0.000426360013
             autocorr =       1.146405293091
              std dev =       0.563147775637
             le_variance =       0.317135417205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317194079215
                                         uncertainty =       0.003279428627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398205611
  error estimate for blocks of size 2^( 2) =       0.000407590435
  error estimate for blocks of size 2^( 3) =       0.000416540041
  error estimate for blocks of size 2^( 4) =       0.000422320106
  error estimate for blocks of size 2^( 5) =       0.000426523958
  error estimate for blocks of size 2^( 6) =       0.000427539985
  error estimate for blocks of size 2^( 7) =       0.000429056002

      target function =                  N/A
              le_mean =     -17.216485483632
             les_mean =     296.724507666734
             stat err =       0.000426360013
             autocorr =       1.146405293091
              std dev =       0.563147775637
             le_variance =       0.317135417205


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216485483632        initial  <--
     6.1035e+15     6.1035e+16             1.2280e-20       -17.216485483632
     2.4414e+16     2.4414e+17             3.0699e-21       -17.216485483632
     9.7656e+16     9.7656e+17             7.6749e-22       -17.216485483632

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4965
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1862
    reference variance = 0.432763
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1239e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312455022191
                                         uncertainty =       0.002627791323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312455022191
                                         uncertainty =       0.002627791323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395217864
  error estimate for blocks of size 2^( 2) =       0.000404746216
  error estimate for blocks of size 2^( 3) =       0.000412758311
  error estimate for blocks of size 2^( 4) =       0.000418595326
  error estimate for blocks of size 2^( 5) =       0.000422505120
  error estimate for blocks of size 2^( 6) =       0.000426281903
  error estimate for blocks of size 2^( 7) =       0.000423880543

      target function =                  N/A
              le_mean =     -17.216737837911
             les_mean =     296.728455943181
             stat err =       0.000422815723
             autocorr =       1.144535123910
              std dev =       0.558922463350
             le_variance =       0.312394320038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673783791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+16, overlap shift 6.1035e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216737837911       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216737837911       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+17, overlap shift 2.4414e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216737837911       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216737837911       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+17, overlap shift 9.7656e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216737837911       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216737837911       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230145 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5865e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1228
    reference variance = 0.257971
====================================================
  Execution time = 2.0320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2786e-01
  Total weights = 2.0000e+06
  Execution time = 1.8295e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404883665
  error estimate for blocks of size 2^( 2) =       0.000414400995
  error estimate for blocks of size 2^( 3) =       0.000422523905
  error estimate for blocks of size 2^( 4) =       0.000429180076
  error estimate for blocks of size 2^( 5) =       0.000432286649
  error estimate for blocks of size 2^( 6) =       0.000433114928
  error estimate for blocks of size 2^( 7) =       0.000437067922

      target function =                  N/A
              le_mean =     -17.216873893663
             les_mean =     296.748608071135
             stat err =       0.000432912394
             autocorr =       1.143245569875
              std dev =       0.572591970566
             le_variance =       0.327861564756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404883665
  error estimate for blocks of size 2^( 2) =       0.000414400995
  error estimate for blocks of size 2^( 3) =       0.000422523905
  error estimate for blocks of size 2^( 4) =       0.000429180076
  error estimate for blocks of size 2^( 5) =       0.000432286649
  error estimate for blocks of size 2^( 6) =       0.000433114928
  error estimate for blocks of size 2^( 7) =       0.000437067922

      target function =                  N/A
              le_mean =     -17.216873893663
             les_mean =     296.748608071135
             stat err =       0.000432912394
             autocorr =       1.143245569875
              std dev =       0.572591970566
             le_variance =       0.327861564756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404883665
  error estimate for blocks of size 2^( 2) =       0.000414400995
  error estimate for blocks of size 2^( 3) =       0.000422523905
  error estimate for blocks of size 2^( 4) =       0.000429180076
  error estimate for blocks of size 2^( 5) =       0.000432286649
  error estimate for blocks of size 2^( 6) =       0.000433114928
  error estimate for blocks of size 2^( 7) =       0.000437067922

      target function =                  N/A
              le_mean =     -17.216873893663
             les_mean =     296.748608071135
             stat err =       0.000432912394
             autocorr =       1.143245569875
              std dev =       0.572591970566
             le_variance =       0.327861564756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327926856937
                                         uncertainty =       0.009923939268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404883665
  error estimate for blocks of size 2^( 2) =       0.000414400995
  error estimate for blocks of size 2^( 3) =       0.000422523905
  error estimate for blocks of size 2^( 4) =       0.000429180076
  error estimate for blocks of size 2^( 5) =       0.000432286649
  error estimate for blocks of size 2^( 6) =       0.000433114928
  error estimate for blocks of size 2^( 7) =       0.000437067922

      target function =                  N/A
              le_mean =     -17.216873893663
             les_mean =     296.748608071135
             stat err =       0.000432912394
             autocorr =       1.143245569875
              std dev =       0.572591970566
             le_variance =       0.327861564756


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216873893663        initial  <--
     6.1035e+16     6.1035e+17             0.0000e+00       -17.216873893663
     2.4414e+17     2.4414e+18             0.0000e+00       -17.216873893663
     9.7656e+17     9.7656e+18             0.0000e+00       -17.216873893663

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5606
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5552e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2856
    reference variance = 0.193735
====================================================
  Execution time = 2.0858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1336e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313046120738
                                         uncertainty =       0.002452017775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313046120738
                                         uncertainty =       0.002452017775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395831424
  error estimate for blocks of size 2^( 2) =       0.000405344212
  error estimate for blocks of size 2^( 3) =       0.000413593390
  error estimate for blocks of size 2^( 4) =       0.000419791090
  error estimate for blocks of size 2^( 5) =       0.000423592700
  error estimate for blocks of size 2^( 6) =       0.000425291923
  error estimate for blocks of size 2^( 7) =       0.000425199103

      target function =                  N/A
              le_mean =     -17.216303698995
             les_mean =     296.714477932356
             stat err =       0.000423468704
             autocorr =       1.144516613573
              std dev =       0.559790168730
             le_variance =       0.313365033007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630369900e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+17, overlap shift 6.1035e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216303698995       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216303698995       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+18, overlap shift 2.4414e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216303698995       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216303698995       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+18, overlap shift 9.7656e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216303698995       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216303698995       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231299 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6406e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2857
    reference variance = 0.276547
====================================================
  Execution time = 1.9986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2014e-01
  Total weights = 2.0000e+06
  Execution time = 1.8259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400084542
  error estimate for blocks of size 2^( 2) =       0.000409734423
  error estimate for blocks of size 2^( 3) =       0.000418266064
  error estimate for blocks of size 2^( 4) =       0.000423876135
  error estimate for blocks of size 2^( 5) =       0.000428338408
  error estimate for blocks of size 2^( 6) =       0.000431998350
  error estimate for blocks of size 2^( 7) =       0.000432617125

      target function =                  N/A
              le_mean =     -17.217134887595
             les_mean =     296.749868858961
             stat err =       0.000429207504
             autocorr =       1.150882719722
              std dev =       0.565804985307
             le_variance =       0.320135281398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400084542
  error estimate for blocks of size 2^( 2) =       0.000409734423
  error estimate for blocks of size 2^( 3) =       0.000418266064
  error estimate for blocks of size 2^( 4) =       0.000423876135
  error estimate for blocks of size 2^( 5) =       0.000428338408
  error estimate for blocks of size 2^( 6) =       0.000431998350
  error estimate for blocks of size 2^( 7) =       0.000432617125

      target function =                  N/A
              le_mean =     -17.217134887595
             les_mean =     296.749868858961
             stat err =       0.000429207504
             autocorr =       1.150882719722
              std dev =       0.565804985307
             le_variance =       0.320135281398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400084542
  error estimate for blocks of size 2^( 2) =       0.000409734423
  error estimate for blocks of size 2^( 3) =       0.000418266064
  error estimate for blocks of size 2^( 4) =       0.000423876135
  error estimate for blocks of size 2^( 5) =       0.000428338408
  error estimate for blocks of size 2^( 6) =       0.000431998350
  error estimate for blocks of size 2^( 7) =       0.000432617125

      target function =                  N/A
              le_mean =     -17.217134887595
             les_mean =     296.749868858961
             stat err =       0.000429207504
             autocorr =       1.150882719722
              std dev =       0.565804985307
             le_variance =       0.320135281398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320265986449
                                         uncertainty =       0.006867349168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400084542
  error estimate for blocks of size 2^( 2) =       0.000409734423
  error estimate for blocks of size 2^( 3) =       0.000418266064
  error estimate for blocks of size 2^( 4) =       0.000423876135
  error estimate for blocks of size 2^( 5) =       0.000428338408
  error estimate for blocks of size 2^( 6) =       0.000431998350
  error estimate for blocks of size 2^( 7) =       0.000432617125

      target function =                  N/A
              le_mean =     -17.217134887595
             les_mean =     296.749868858961
             stat err =       0.000429207504
             autocorr =       1.150882719722
              std dev =       0.565804985307
             le_variance =       0.320135281398


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217134887595        initial  <--
     6.1035e+17     6.1035e+18             0.0000e+00       -17.217134887595
     2.4414e+18     2.4414e+19             0.0000e+00       -17.217134887595
     9.7656e+18     9.7656e+19             0.0000e+00       -17.217134887595

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0098
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.285515
====================================================
  Execution time = 2.0275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324168874409
                                         uncertainty =       0.007037849441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324168874409
                                         uncertainty =       0.007037849441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402642612
  error estimate for blocks of size 2^( 2) =       0.000412322009
  error estimate for blocks of size 2^( 3) =       0.000420869727
  error estimate for blocks of size 2^( 4) =       0.000427141807
  error estimate for blocks of size 2^( 5) =       0.000430363298
  error estimate for blocks of size 2^( 6) =       0.000432878813
  error estimate for blocks of size 2^( 7) =       0.000432352934

      target function =                  N/A
              le_mean =     -17.217163704085
             les_mean =     296.754967997528
             stat err =       0.000430684213
             autocorr =       1.144138067667
              std dev =       0.569422643027
             le_variance =       0.324242146392


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721716370408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+18, overlap shift 6.1035e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163704085       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163704085       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+19, overlap shift 2.4414e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163704085       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163704085       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+19, overlap shift 9.7656e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217163704085       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217163704085       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232502 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9213e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1245
    reference variance = 0.227613
====================================================
  Execution time = 2.0514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3329e-01
  Total weights = 2.0000e+06
  Execution time = 1.8342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408220209
  error estimate for blocks of size 2^( 2) =       0.000417336326
  error estimate for blocks of size 2^( 3) =       0.000425717398
  error estimate for blocks of size 2^( 4) =       0.000431832499
  error estimate for blocks of size 2^( 5) =       0.000435342008
  error estimate for blocks of size 2^( 6) =       0.000436495083
  error estimate for blocks of size 2^( 7) =       0.000438064169

      target function =                  N/A
              le_mean =     -17.216710144094
             les_mean =     296.748395497930
             stat err =       0.000435433440
             autocorr =       1.137770197806
              std dev =       0.577310556651
             le_variance =       0.333287478821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408220209
  error estimate for blocks of size 2^( 2) =       0.000417336326
  error estimate for blocks of size 2^( 3) =       0.000425717398
  error estimate for blocks of size 2^( 4) =       0.000431832499
  error estimate for blocks of size 2^( 5) =       0.000435342008
  error estimate for blocks of size 2^( 6) =       0.000436495083
  error estimate for blocks of size 2^( 7) =       0.000438064169

      target function =                  N/A
              le_mean =     -17.216710144094
             les_mean =     296.748395497930
             stat err =       0.000435433440
             autocorr =       1.137770197806
              std dev =       0.577310556651
             le_variance =       0.333287478821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408220209
  error estimate for blocks of size 2^( 2) =       0.000417336326
  error estimate for blocks of size 2^( 3) =       0.000425717398
  error estimate for blocks of size 2^( 4) =       0.000431832499
  error estimate for blocks of size 2^( 5) =       0.000435342008
  error estimate for blocks of size 2^( 6) =       0.000436495083
  error estimate for blocks of size 2^( 7) =       0.000438064169

      target function =                  N/A
              le_mean =     -17.216710144094
             les_mean =     296.748395497930
             stat err =       0.000435433440
             autocorr =       1.137770197806
              std dev =       0.577310556651
             le_variance =       0.333287478821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333170567426
                                         uncertainty =       0.012592655459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408220209
  error estimate for blocks of size 2^( 2) =       0.000417336326
  error estimate for blocks of size 2^( 3) =       0.000425717398
  error estimate for blocks of size 2^( 4) =       0.000431832499
  error estimate for blocks of size 2^( 5) =       0.000435342008
  error estimate for blocks of size 2^( 6) =       0.000436495083
  error estimate for blocks of size 2^( 7) =       0.000438064169

      target function =                  N/A
              le_mean =     -17.216710144094
             les_mean =     296.748395497930
             stat err =       0.000435433440
             autocorr =       1.137770197806
              std dev =       0.577310556651
             le_variance =       0.333287478821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216710144094        initial  <--
     6.1035e+18     6.1035e+19             0.0000e+00       -17.216710144094
     2.4414e+19     2.4414e+20             0.0000e+00       -17.216710144094
     9.7656e+19     9.7656e+20             0.0000e+00       -17.216710144094

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7791
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9149e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2761
    reference variance = 0.239913
====================================================
  Execution time = 2.0476e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1407e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4782e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314125068580
                                         uncertainty =       0.003567600450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314125068580
                                         uncertainty =       0.003567600450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396276571
  error estimate for blocks of size 2^( 2) =       0.000406132075
  error estimate for blocks of size 2^( 3) =       0.000414416465
  error estimate for blocks of size 2^( 4) =       0.000421071620
  error estimate for blocks of size 2^( 5) =       0.000424665840
  error estimate for blocks of size 2^( 6) =       0.000424851891
  error estimate for blocks of size 2^( 7) =       0.000425286919

      target function =                  N/A
              le_mean =     -17.216587274260
             les_mean =     296.724947456126
             stat err =       0.000423969068
             autocorr =       1.144646940608
              std dev =       0.560419700730
             le_variance =       0.314070240967


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721658727426e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+19, overlap shift 6.1035e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587274260       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587274260       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587274260       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+19 is 3.299620e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+20, overlap shift 2.4414e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587274260       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587274260       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587274260       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+20 is 8.249049e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+20, overlap shift 9.7656e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216587274260       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216587274260       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216587274259       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+20 is 2.062262e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5959e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2215
    reference variance = 0.288647
====================================================
  Execution time = 2.0131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2840e-01
  Total weights = 2.0000e+06
  Execution time = 1.8400e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405218626
  error estimate for blocks of size 2^( 2) =       0.000414782737
  error estimate for blocks of size 2^( 3) =       0.000423099418
  error estimate for blocks of size 2^( 4) =       0.000429259803
  error estimate for blocks of size 2^( 5) =       0.000432545942
  error estimate for blocks of size 2^( 6) =       0.000434404459
  error estimate for blocks of size 2^( 7) =       0.000436336387

      target function =                  N/A
              le_mean =     -17.216393084461
             les_mean =     296.732594943525
             stat err =       0.000433136648
             autocorr =       1.142539079287
              std dev =       0.573065676043
             le_variance =       0.328404269059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405218626
  error estimate for blocks of size 2^( 2) =       0.000414782737
  error estimate for blocks of size 2^( 3) =       0.000423099418
  error estimate for blocks of size 2^( 4) =       0.000429259803
  error estimate for blocks of size 2^( 5) =       0.000432545942
  error estimate for blocks of size 2^( 6) =       0.000434404459
  error estimate for blocks of size 2^( 7) =       0.000436336387

      target function =                  N/A
              le_mean =     -17.216393084461
             les_mean =     296.732594943525
             stat err =       0.000433136648
             autocorr =       1.142539079287
              std dev =       0.573065676043
             le_variance =       0.328404269059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405218626
  error estimate for blocks of size 2^( 2) =       0.000414782737
  error estimate for blocks of size 2^( 3) =       0.000423099418
  error estimate for blocks of size 2^( 4) =       0.000429259803
  error estimate for blocks of size 2^( 5) =       0.000432545942
  error estimate for blocks of size 2^( 6) =       0.000434404459
  error estimate for blocks of size 2^( 7) =       0.000436336387

      target function =                  N/A
              le_mean =     -17.216393084461
             les_mean =     296.732594943525
             stat err =       0.000433136648
             autocorr =       1.142539079287
              std dev =       0.573065676043
             le_variance =       0.328404269059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328478946584
                                         uncertainty =       0.006806716019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405218626
  error estimate for blocks of size 2^( 2) =       0.000414782737
  error estimate for blocks of size 2^( 3) =       0.000423099418
  error estimate for blocks of size 2^( 4) =       0.000429259803
  error estimate for blocks of size 2^( 5) =       0.000432545942
  error estimate for blocks of size 2^( 6) =       0.000434404459
  error estimate for blocks of size 2^( 7) =       0.000436336387

      target function =                  N/A
              le_mean =     -17.216393084461
             les_mean =     296.732594943525
             stat err =       0.000433136648
             autocorr =       1.142539079287
              std dev =       0.573065676043
             le_variance =       0.328404269059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216393084461        initial  <--
     6.1035e+19     6.1035e+20             3.2996e-24       -17.216393084461
     2.4414e+20     2.4414e+21             8.2490e-25       -17.216393084461
     9.7656e+20     9.7656e+21             2.0623e-25       -17.216393084461

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4235
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5424e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1369
    reference variance = 0.228198
====================================================
  Execution time = 2.0622e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1552e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315502082549
                                         uncertainty =       0.002564768432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315502082549
                                         uncertainty =       0.002564768432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397190123
  error estimate for blocks of size 2^( 2) =       0.000406960666
  error estimate for blocks of size 2^( 3) =       0.000415807467
  error estimate for blocks of size 2^( 4) =       0.000421431735
  error estimate for blocks of size 2^( 5) =       0.000426011131
  error estimate for blocks of size 2^( 6) =       0.000428992153
  error estimate for blocks of size 2^( 7) =       0.000429691347

      target function =                  N/A
              le_mean =     -17.216823547983
             les_mean =     296.734532912637
             stat err =       0.000426531592
             autocorr =       1.153202368333
              std dev =       0.561711659152
             le_variance =       0.315519988027


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682354798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+20, overlap shift 6.1035e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823547983       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823547983       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+21, overlap shift 2.4414e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823547983       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823547983       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+21, overlap shift 9.7656e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216823547983       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216823547983       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6088e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1826
    reference variance = 0.913202
====================================================
  Execution time = 2.0094e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1367e-01
  Total weights = 2.0000e+06
  Execution time = 1.8368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396026421
  error estimate for blocks of size 2^( 2) =       0.000405638726
  error estimate for blocks of size 2^( 3) =       0.000414287954
  error estimate for blocks of size 2^( 4) =       0.000420911378
  error estimate for blocks of size 2^( 5) =       0.000425009578
  error estimate for blocks of size 2^( 6) =       0.000425947837
  error estimate for blocks of size 2^( 7) =       0.000429106093

      target function =                  N/A
              le_mean =     -17.216924919148
             les_mean =     296.736177366259
             stat err =       0.000425243722
             autocorr =       1.152995201187
              std dev =       0.560065934982
             le_variance =       0.313673851527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396026421
  error estimate for blocks of size 2^( 2) =       0.000405638726
  error estimate for blocks of size 2^( 3) =       0.000414287954
  error estimate for blocks of size 2^( 4) =       0.000420911378
  error estimate for blocks of size 2^( 5) =       0.000425009578
  error estimate for blocks of size 2^( 6) =       0.000425947837
  error estimate for blocks of size 2^( 7) =       0.000429106093

      target function =                  N/A
              le_mean =     -17.216924919148
             les_mean =     296.736177366259
             stat err =       0.000425243722
             autocorr =       1.152995201187
              std dev =       0.560065934982
             le_variance =       0.313673851527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396026421
  error estimate for blocks of size 2^( 2) =       0.000405638726
  error estimate for blocks of size 2^( 3) =       0.000414287954
  error estimate for blocks of size 2^( 4) =       0.000420911378
  error estimate for blocks of size 2^( 5) =       0.000425009578
  error estimate for blocks of size 2^( 6) =       0.000425947837
  error estimate for blocks of size 2^( 7) =       0.000429106093

      target function =                  N/A
              le_mean =     -17.216924919148
             les_mean =     296.736177366259
             stat err =       0.000425243722
             autocorr =       1.152995201187
              std dev =       0.560065934982
             le_variance =       0.313673851527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313719969466
                                         uncertainty =       0.002608963485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396026421
  error estimate for blocks of size 2^( 2) =       0.000405638726
  error estimate for blocks of size 2^( 3) =       0.000414287954
  error estimate for blocks of size 2^( 4) =       0.000420911378
  error estimate for blocks of size 2^( 5) =       0.000425009578
  error estimate for blocks of size 2^( 6) =       0.000425947837
  error estimate for blocks of size 2^( 7) =       0.000429106093

      target function =                  N/A
              le_mean =     -17.216924919148
             les_mean =     296.736177366259
             stat err =       0.000425243722
             autocorr =       1.152995201187
              std dev =       0.560065934982
             le_variance =       0.313673851527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216924919148        initial  <--
     6.1035e+20     6.1035e+21             0.0000e+00       -17.216924919148
     2.4414e+21     2.4414e+22             0.0000e+00       -17.216924919148
     9.7656e+21     9.7656e+22             0.0000e+00       -17.216924919148

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3723
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5610e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.255
    reference variance = 0.255741
====================================================
  Execution time = 2.0208e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1768e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7048e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317669089689
                                         uncertainty =       0.003996473091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317669089689
                                         uncertainty =       0.003996473091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398548016
  error estimate for blocks of size 2^( 2) =       0.000408188417
  error estimate for blocks of size 2^( 3) =       0.000417073017
  error estimate for blocks of size 2^( 4) =       0.000422412647
  error estimate for blocks of size 2^( 5) =       0.000426287888
  error estimate for blocks of size 2^( 6) =       0.000428182852
  error estimate for blocks of size 2^( 7) =       0.000426434006

      target function =                  N/A
              le_mean =     -17.216959123501
             les_mean =     296.741362343674
             stat err =       0.000425829348
             autocorr =       1.141589266113
              std dev =       0.563632009559
             le_variance =       0.317681042200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721695912350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+21, overlap shift 6.1035e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216959123501       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216959123501       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+22, overlap shift 2.4414e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216959123501       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216959123501       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216959123501       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+22, overlap shift 9.7656e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216959123501       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216959123501       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216959123501       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236255 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5918e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2044
    reference variance = 0.338542
====================================================
  Execution time = 2.0950e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2135e-01
  Total weights = 2.0000e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400840081
  error estimate for blocks of size 2^( 2) =       0.000410579552
  error estimate for blocks of size 2^( 3) =       0.000419117387
  error estimate for blocks of size 2^( 4) =       0.000425343808
  error estimate for blocks of size 2^( 5) =       0.000430773124
  error estimate for blocks of size 2^( 6) =       0.000433028163
  error estimate for blocks of size 2^( 7) =       0.000434672506

      target function =                  N/A
              le_mean =     -17.216754900224
             les_mean =     296.737994674367
             stat err =       0.000430954400
             autocorr =       1.155900247782
              std dev =       0.566873478515
             le_variance =       0.321345540644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400840081
  error estimate for blocks of size 2^( 2) =       0.000410579552
  error estimate for blocks of size 2^( 3) =       0.000419117387
  error estimate for blocks of size 2^( 4) =       0.000425343808
  error estimate for blocks of size 2^( 5) =       0.000430773124
  error estimate for blocks of size 2^( 6) =       0.000433028163
  error estimate for blocks of size 2^( 7) =       0.000434672506

      target function =                  N/A
              le_mean =     -17.216754900224
             les_mean =     296.737994674367
             stat err =       0.000430954400
             autocorr =       1.155900247782
              std dev =       0.566873478515
             le_variance =       0.321345540644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400840081
  error estimate for blocks of size 2^( 2) =       0.000410579552
  error estimate for blocks of size 2^( 3) =       0.000419117387
  error estimate for blocks of size 2^( 4) =       0.000425343808
  error estimate for blocks of size 2^( 5) =       0.000430773124
  error estimate for blocks of size 2^( 6) =       0.000433028163
  error estimate for blocks of size 2^( 7) =       0.000434672506

      target function =                  N/A
              le_mean =     -17.216754900224
             les_mean =     296.737994674367
             stat err =       0.000430954400
             autocorr =       1.155900247782
              std dev =       0.566873478515
             le_variance =       0.321345540644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321244312456
                                         uncertainty =       0.003967441292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400840081
  error estimate for blocks of size 2^( 2) =       0.000410579552
  error estimate for blocks of size 2^( 3) =       0.000419117387
  error estimate for blocks of size 2^( 4) =       0.000425343808
  error estimate for blocks of size 2^( 5) =       0.000430773124
  error estimate for blocks of size 2^( 6) =       0.000433028163
  error estimate for blocks of size 2^( 7) =       0.000434672506

      target function =                  N/A
              le_mean =     -17.216754900224
             les_mean =     296.737994674367
             stat err =       0.000430954400
             autocorr =       1.155900247782
              std dev =       0.566873478515
             le_variance =       0.321345540644


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216754900224        initial  <--
     6.1035e+21     6.1035e+22             0.0000e+00       -17.216754900224
     2.4414e+22     2.4414e+23             0.0000e+00       -17.216754900224
     9.7656e+22     9.7656e+23             0.0000e+00       -17.216754900224

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2080
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6131e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.552466
====================================================
  Execution time = 2.0446e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1683e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316925060095
                                         uncertainty =       0.004020583495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316925060095
                                         uncertainty =       0.004020583495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398016114
  error estimate for blocks of size 2^( 2) =       0.000407554515
  error estimate for blocks of size 2^( 3) =       0.000416214084
  error estimate for blocks of size 2^( 4) =       0.000423061875
  error estimate for blocks of size 2^( 5) =       0.000426157390
  error estimate for blocks of size 2^( 6) =       0.000428485017
  error estimate for blocks of size 2^( 7) =       0.000431729752

      target function =                  N/A
              le_mean =     -17.216914971879
             les_mean =     296.738994644428
             stat err =       0.000427358509
             autocorr =       1.152878127803
              std dev =       0.562879786392
             le_variance =       0.316833653928


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721691497188e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+22, overlap shift 6.1035e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216914971879       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216914971879       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216914971879       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+23, overlap shift 2.4414e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216914971879       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216914971879       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216914971879       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+23, overlap shift 9.7656e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216914971879       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216914971879       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216914971879       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+23 is 2.577099e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5960e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2325
    reference variance = 0.261231
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0815e-01
  Total weights = 2.0000e+06
  Execution time = 1.8350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392524363
  error estimate for blocks of size 2^( 2) =       0.000402390026
  error estimate for blocks of size 2^( 3) =       0.000410449511
  error estimate for blocks of size 2^( 4) =       0.000416248985
  error estimate for blocks of size 2^( 5) =       0.000419340896
  error estimate for blocks of size 2^( 6) =       0.000421578502
  error estimate for blocks of size 2^( 7) =       0.000422795977

      target function =                  N/A
              le_mean =     -17.216093403727
             les_mean =     296.702022682548
             stat err =       0.000419991090
             autocorr =       1.144845602101
              std dev =       0.555113277413
             le_variance =       0.308150750760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392524363
  error estimate for blocks of size 2^( 2) =       0.000402390026
  error estimate for blocks of size 2^( 3) =       0.000410449511
  error estimate for blocks of size 2^( 4) =       0.000416248985
  error estimate for blocks of size 2^( 5) =       0.000419340896
  error estimate for blocks of size 2^( 6) =       0.000421578502
  error estimate for blocks of size 2^( 7) =       0.000422795977

      target function =                  N/A
              le_mean =     -17.216093403727
             les_mean =     296.702022682548
             stat err =       0.000419991090
             autocorr =       1.144845602101
              std dev =       0.555113277413
             le_variance =       0.308150750760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392524363
  error estimate for blocks of size 2^( 2) =       0.000402390026
  error estimate for blocks of size 2^( 3) =       0.000410449511
  error estimate for blocks of size 2^( 4) =       0.000416248985
  error estimate for blocks of size 2^( 5) =       0.000419340896
  error estimate for blocks of size 2^( 6) =       0.000421578502
  error estimate for blocks of size 2^( 7) =       0.000422795977

      target function =                  N/A
              le_mean =     -17.216093403727
             les_mean =     296.702022682548
             stat err =       0.000419991090
             autocorr =       1.144845602101
              std dev =       0.555113277413
             le_variance =       0.308150750760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308142546049
                                         uncertainty =       0.002305505745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392524363
  error estimate for blocks of size 2^( 2) =       0.000402390026
  error estimate for blocks of size 2^( 3) =       0.000410449511
  error estimate for blocks of size 2^( 4) =       0.000416248985
  error estimate for blocks of size 2^( 5) =       0.000419340896
  error estimate for blocks of size 2^( 6) =       0.000421578502
  error estimate for blocks of size 2^( 7) =       0.000422795977

      target function =                  N/A
              le_mean =     -17.216093403727
             les_mean =     296.702022682548
             stat err =       0.000419991090
             autocorr =       1.144845602101
              std dev =       0.555113277413
             le_variance =       0.308150750760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216093403727        initial  <--
     6.1035e+22     6.1035e+23             0.0000e+00       -17.216093403727
     2.4414e+23     2.4414e+24             0.0000e+00       -17.216093403727
     9.7656e+23     9.7656e+24             2.5771e-28       -17.216093403727

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7707
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1182
    reference variance = 0.478894
====================================================
  Execution time = 2.2171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1047e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310314258024
                                         uncertainty =       0.002197579339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310314258024
                                         uncertainty =       0.002197579339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394000071
  error estimate for blocks of size 2^( 2) =       0.000404002481
  error estimate for blocks of size 2^( 3) =       0.000412329894
  error estimate for blocks of size 2^( 4) =       0.000418524817
  error estimate for blocks of size 2^( 5) =       0.000421856742
  error estimate for blocks of size 2^( 6) =       0.000422835766
  error estimate for blocks of size 2^( 7) =       0.000423040856

      target function =                  N/A
              le_mean =     -17.217073415707
             les_mean =     296.738088958629
             stat err =       0.000421564545
             autocorr =       1.144815646199
              std dev =       0.557200244083
             le_variance =       0.310472112007


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721707341571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+23, overlap shift 6.1035e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217073415707       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217073415707       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217073415708       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+23 is 2.508580e-28

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+24, overlap shift 2.4414e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217073415707       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217073415707       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+24, overlap shift 9.7656e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217073415707       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217073415707       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217073415704       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+24 is 1.567863e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7717e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1611
    reference variance = 0.234401
====================================================
  Execution time = 2.2196e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2948e-01
  Total weights = 2.0000e+06
  Execution time = 1.8478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405883862
  error estimate for blocks of size 2^( 2) =       0.000415712428
  error estimate for blocks of size 2^( 3) =       0.000424285234
  error estimate for blocks of size 2^( 4) =       0.000429973849
  error estimate for blocks of size 2^( 5) =       0.000433923560
  error estimate for blocks of size 2^( 6) =       0.000436682762
  error estimate for blocks of size 2^( 7) =       0.000437911858

      target function =                  N/A
              le_mean =     -17.216936851756
             les_mean =     296.752397811039
             stat err =       0.000434623007
             autocorr =       1.146626191336
              std dev =       0.574006461996
             le_variance =       0.329483418413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405883862
  error estimate for blocks of size 2^( 2) =       0.000415712428
  error estimate for blocks of size 2^( 3) =       0.000424285234
  error estimate for blocks of size 2^( 4) =       0.000429973849
  error estimate for blocks of size 2^( 5) =       0.000433923560
  error estimate for blocks of size 2^( 6) =       0.000436682762
  error estimate for blocks of size 2^( 7) =       0.000437911858

      target function =                  N/A
              le_mean =     -17.216936851756
             les_mean =     296.752397811039
             stat err =       0.000434623007
             autocorr =       1.146626191336
              std dev =       0.574006461996
             le_variance =       0.329483418413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405883862
  error estimate for blocks of size 2^( 2) =       0.000415712428
  error estimate for blocks of size 2^( 3) =       0.000424285234
  error estimate for blocks of size 2^( 4) =       0.000429973849
  error estimate for blocks of size 2^( 5) =       0.000433923560
  error estimate for blocks of size 2^( 6) =       0.000436682762
  error estimate for blocks of size 2^( 7) =       0.000437911858

      target function =                  N/A
              le_mean =     -17.216936851756
             les_mean =     296.752397811039
             stat err =       0.000434623007
             autocorr =       1.146626191336
              std dev =       0.574006461996
             le_variance =       0.329483418413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329563542158
                                         uncertainty =       0.009279529524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405883862
  error estimate for blocks of size 2^( 2) =       0.000415712428
  error estimate for blocks of size 2^( 3) =       0.000424285234
  error estimate for blocks of size 2^( 4) =       0.000429973849
  error estimate for blocks of size 2^( 5) =       0.000433923560
  error estimate for blocks of size 2^( 6) =       0.000436682762
  error estimate for blocks of size 2^( 7) =       0.000437911858

      target function =                  N/A
              le_mean =     -17.216936851756
             les_mean =     296.752397811039
             stat err =       0.000434623007
             autocorr =       1.146626191336
              std dev =       0.574006461996
             le_variance =       0.329483418413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216936851756        initial  <--
     6.1035e+23     6.1035e+24             2.5086e-28       -17.216936851756
     2.4414e+24     2.4414e+25             0.0000e+00       -17.216936851756
     9.7656e+24     9.7656e+25             1.5679e-29       -17.216936851756

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5710
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9295e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.162336
====================================================
  Execution time = 2.0417e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1294e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313002668020
                                         uncertainty =       0.002510031157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313002668020
                                         uncertainty =       0.002510031157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395566135
  error estimate for blocks of size 2^( 2) =       0.000405246844
  error estimate for blocks of size 2^( 3) =       0.000413733054
  error estimate for blocks of size 2^( 4) =       0.000419445078
  error estimate for blocks of size 2^( 5) =       0.000423127618
  error estimate for blocks of size 2^( 6) =       0.000425762091
  error estimate for blocks of size 2^( 7) =       0.000427099909

      target function =                  N/A
              le_mean =     -17.216692429078
             les_mean =     296.727443175363
             stat err =       0.000423858674
             autocorr =       1.148164043258
              std dev =       0.559414992980
             le_variance =       0.312945134371


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669242908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+24, overlap shift 6.1035e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216692429078       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216692429078       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216692429080       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+24 is 1.378815e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+25, overlap shift 2.4414e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216692429078       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216692429078       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216692429078       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+25 is 3.447037e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+25, overlap shift 9.7656e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216692429078       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216692429078       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216692429078       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+25 is 8.617593e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240228 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5970e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2166
    reference variance = 0.188845
====================================================
  Execution time = 2.0510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1175e-01
  Total weights = 2.0000e+06
  Execution time = 1.8385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394810058
  error estimate for blocks of size 2^( 2) =       0.000404486508
  error estimate for blocks of size 2^( 3) =       0.000413850684
  error estimate for blocks of size 2^( 4) =       0.000420973946
  error estimate for blocks of size 2^( 5) =       0.000425463370
  error estimate for blocks of size 2^( 6) =       0.000426283036
  error estimate for blocks of size 2^( 7) =       0.000426753817

      target function =                  N/A
              le_mean =     -17.216716731588
             les_mean =     296.727084824264
             stat err =       0.000424868542
             autocorr =       1.158064467739
              std dev =       0.558345739112
             le_variance =       0.311749964384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394810058
  error estimate for blocks of size 2^( 2) =       0.000404486508
  error estimate for blocks of size 2^( 3) =       0.000413850684
  error estimate for blocks of size 2^( 4) =       0.000420973946
  error estimate for blocks of size 2^( 5) =       0.000425463370
  error estimate for blocks of size 2^( 6) =       0.000426283036
  error estimate for blocks of size 2^( 7) =       0.000426753817

      target function =                  N/A
              le_mean =     -17.216716731588
             les_mean =     296.727084824264
             stat err =       0.000424868542
             autocorr =       1.158064467739
              std dev =       0.558345739112
             le_variance =       0.311749964384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394810058
  error estimate for blocks of size 2^( 2) =       0.000404486508
  error estimate for blocks of size 2^( 3) =       0.000413850684
  error estimate for blocks of size 2^( 4) =       0.000420973946
  error estimate for blocks of size 2^( 5) =       0.000425463370
  error estimate for blocks of size 2^( 6) =       0.000426283036
  error estimate for blocks of size 2^( 7) =       0.000426753817

      target function =                  N/A
              le_mean =     -17.216716731588
             les_mean =     296.727084824264
             stat err =       0.000424868542
             autocorr =       1.158064467739
              std dev =       0.558345739112
             le_variance =       0.311749964384

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311790483445
                                         uncertainty =       0.002825007316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394810058
  error estimate for blocks of size 2^( 2) =       0.000404486508
  error estimate for blocks of size 2^( 3) =       0.000413850684
  error estimate for blocks of size 2^( 4) =       0.000420973946
  error estimate for blocks of size 2^( 5) =       0.000425463370
  error estimate for blocks of size 2^( 6) =       0.000426283036
  error estimate for blocks of size 2^( 7) =       0.000426753817

      target function =                  N/A
              le_mean =     -17.216716731588
             les_mean =     296.727084824264
             stat err =       0.000424868542
             autocorr =       1.158064467739
              std dev =       0.558345739112
             le_variance =       0.311749964384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216716731588        initial  <--
     6.1035e+24     6.1035e+25             1.3788e-29       -17.216716731588
     2.4414e+25     2.4414e+26             3.4470e-30       -17.216716731588
     9.7656e+25     9.7656e+26             8.6176e-31       -17.216716731588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7995
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5776e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2259
    reference variance = 0.23887
====================================================
  Execution time = 2.0300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1425e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314194275868
                                         uncertainty =       0.003200431116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314194275868
                                         uncertainty =       0.003200431116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396391469
  error estimate for blocks of size 2^( 2) =       0.000405970457
  error estimate for blocks of size 2^( 3) =       0.000414408524
  error estimate for blocks of size 2^( 4) =       0.000420570227
  error estimate for blocks of size 2^( 5) =       0.000424422692
  error estimate for blocks of size 2^( 6) =       0.000426604430
  error estimate for blocks of size 2^( 7) =       0.000428726634

      target function =                  N/A
              le_mean =     -17.217180623730
             les_mean =     296.745560866180
             stat err =       0.000425080996
             autocorr =       1.149991896971
              std dev =       0.560582191250
             le_variance =       0.314252393147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718062373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+25, overlap shift 6.1035e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217180623730       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217180623730       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217180623731       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+25 is 1.319056e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+26, overlap shift 2.4414e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217180623730       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217180623730       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217180623730       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217180623731       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+26 is 1.020717e-30

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+26, overlap shift 9.7656e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217180623730       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217180623730       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217180623730       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217180623731       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+26 is 2.551793e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241771 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5768e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2402
    reference variance = 0.28023
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1503e-01
  Total weights = 2.0000e+06
  Execution time = 1.8358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396880324
  error estimate for blocks of size 2^( 2) =       0.000406021524
  error estimate for blocks of size 2^( 3) =       0.000415182498
  error estimate for blocks of size 2^( 4) =       0.000421417479
  error estimate for blocks of size 2^( 5) =       0.000425578591
  error estimate for blocks of size 2^( 6) =       0.000427361000
  error estimate for blocks of size 2^( 7) =       0.000427568411

      target function =                  N/A
              le_mean =     -17.216823223730
             les_mean =     296.734029742698
             stat err =       0.000425481370
             autocorr =       1.149322640020
              std dev =       0.561273536731
             le_variance =       0.315027983034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396880324
  error estimate for blocks of size 2^( 2) =       0.000406021524
  error estimate for blocks of size 2^( 3) =       0.000415182498
  error estimate for blocks of size 2^( 4) =       0.000421417479
  error estimate for blocks of size 2^( 5) =       0.000425578591
  error estimate for blocks of size 2^( 6) =       0.000427361000
  error estimate for blocks of size 2^( 7) =       0.000427568411

      target function =                  N/A
              le_mean =     -17.216823223730
             les_mean =     296.734029742698
             stat err =       0.000425481370
             autocorr =       1.149322640020
              std dev =       0.561273536731
             le_variance =       0.315027983034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396880324
  error estimate for blocks of size 2^( 2) =       0.000406021524
  error estimate for blocks of size 2^( 3) =       0.000415182498
  error estimate for blocks of size 2^( 4) =       0.000421417479
  error estimate for blocks of size 2^( 5) =       0.000425578591
  error estimate for blocks of size 2^( 6) =       0.000427361000
  error estimate for blocks of size 2^( 7) =       0.000427568411

      target function =                  N/A
              le_mean =     -17.216823223730
             les_mean =     296.734029742698
             stat err =       0.000425481370
             autocorr =       1.149322640020
              std dev =       0.561273536731
             le_variance =       0.315027983034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315040059232
                                         uncertainty =       0.003038646330

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396880324
  error estimate for blocks of size 2^( 2) =       0.000406021524
  error estimate for blocks of size 2^( 3) =       0.000415182498
  error estimate for blocks of size 2^( 4) =       0.000421417479
  error estimate for blocks of size 2^( 5) =       0.000425578591
  error estimate for blocks of size 2^( 6) =       0.000427361000
  error estimate for blocks of size 2^( 7) =       0.000427568411

      target function =                  N/A
              le_mean =     -17.216823223730
             les_mean =     296.734029742698
             stat err =       0.000425481370
             autocorr =       1.149322640020
              std dev =       0.561273536731
             le_variance =       0.315027983034


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216823223730        initial  <--
     6.1035e+25     6.1035e+26             1.3191e-30       -17.216823223730
     2.4414e+26     2.4414e+27             1.0207e-30       -17.216823223730
     9.7656e+26     9.7656e+27             2.5518e-31       -17.216823223730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1727
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5947e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1892
    reference variance = 0.220076
====================================================
  Execution time = 2.0923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1913e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319168244750
                                         uncertainty =       0.005129026289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319168244750
                                         uncertainty =       0.005129026289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399453507
  error estimate for blocks of size 2^( 2) =       0.000409378065
  error estimate for blocks of size 2^( 3) =       0.000418074000
  error estimate for blocks of size 2^( 4) =       0.000424080002
  error estimate for blocks of size 2^( 5) =       0.000427727395
  error estimate for blocks of size 2^( 6) =       0.000430701733
  error estimate for blocks of size 2^( 7) =       0.000431214750

      target function =                  N/A
              le_mean =     -17.217062761858
             les_mean =     296.746376195372
             stat err =       0.000428430970
             autocorr =       1.150347985385
              std dev =       0.564912567740
             le_variance =       0.319126209190


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721706276186e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+26, overlap shift 6.1035e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217062761858       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217062761858       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217062761858       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.4414e+27, overlap shift 2.4414e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217062761858       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217062761858       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217062761858       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.7656e+27, overlap shift 9.7656e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217062761858       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217062761858       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217062761858       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6441e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2524
    reference variance = 0.335439
====================================================
  Execution time = 2.0237e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1402e-01
  Total weights = 2.0000e+06
  Execution time = 1.8310e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396242659
  error estimate for blocks of size 2^( 2) =       0.000406344360
  error estimate for blocks of size 2^( 3) =       0.000415008761
  error estimate for blocks of size 2^( 4) =       0.000421271075
  error estimate for blocks of size 2^( 5) =       0.000424708248
  error estimate for blocks of size 2^( 6) =       0.000427664164
  error estimate for blocks of size 2^( 7) =       0.000428452344

      target function =                  N/A
              le_mean =     -17.217156658636
             les_mean =     296.744499740721
             stat err =       0.000425523958
             autocorr =       1.153255607353
              std dev =       0.560371742436
             le_variance =       0.314016489721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396242659
  error estimate for blocks of size 2^( 2) =       0.000406344360
  error estimate for blocks of size 2^( 3) =       0.000415008761
  error estimate for blocks of size 2^( 4) =       0.000421271075
  error estimate for blocks of size 2^( 5) =       0.000424708248
  error estimate for blocks of size 2^( 6) =       0.000427664164
  error estimate for blocks of size 2^( 7) =       0.000428452344

      target function =                  N/A
              le_mean =     -17.217156658636
             les_mean =     296.744499740721
             stat err =       0.000425523958
             autocorr =       1.153255607353
              std dev =       0.560371742436
             le_variance =       0.314016489721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396242659
  error estimate for blocks of size 2^( 2) =       0.000406344360
  error estimate for blocks of size 2^( 3) =       0.000415008761
  error estimate for blocks of size 2^( 4) =       0.000421271075
  error estimate for blocks of size 2^( 5) =       0.000424708248
  error estimate for blocks of size 2^( 6) =       0.000427664164
  error estimate for blocks of size 2^( 7) =       0.000428452344

      target function =                  N/A
              le_mean =     -17.217156658636
             les_mean =     296.744499740721
             stat err =       0.000425523958
             autocorr =       1.153255607353
              std dev =       0.560371742436
             le_variance =       0.314016489721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314080716075
                                         uncertainty =       0.002324620484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396242659
  error estimate for blocks of size 2^( 2) =       0.000406344360
  error estimate for blocks of size 2^( 3) =       0.000415008761
  error estimate for blocks of size 2^( 4) =       0.000421271075
  error estimate for blocks of size 2^( 5) =       0.000424708248
  error estimate for blocks of size 2^( 6) =       0.000427664164
  error estimate for blocks of size 2^( 7) =       0.000428452344

      target function =                  N/A
              le_mean =     -17.217156658636
             les_mean =     296.744499740721
             stat err =       0.000425523958
             autocorr =       1.153255607353
              std dev =       0.560371742436
             le_variance =       0.314016489721


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217156658636        initial  <--
     6.1035e+26     6.1035e+27             0.0000e+00       -17.217156658636
     2.4414e+27     2.4414e+28             0.0000e+00       -17.217156658636
     9.7656e+27     9.7656e+28             0.0000e+00       -17.217156658636

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4872
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.909340e-01 1 1  ON 0
 uu_1                 2.819192e-02 1 1  ON 1
 uu_2                -6.769436e-02 1 1  ON 2
 uu_3                -1.244055e-01 1 1  ON 3
 uu_4                -1.604598e-01 1 1  ON 4
 uu_5                -1.723731e-01 1 1  ON 5
 uu_6                -1.595617e-01 1 1  ON 6
 uu_7                -1.136125e-01 1 1  ON 7
 uu_8                -3.691230e-02 1 1  ON 8
 uu_9                 1.618670e-01 1 1  ON 9
 ud_0                 3.494032e-01 1 1  ON 10
 ud_1                 9.083486e-02 1 1  ON 11
 ud_2                -1.912559e-02 1 1  ON 12
 ud_3                -8.096853e-02 1 1  ON 13
 ud_4                -1.308919e-01 1 1  ON 14
 ud_5                -1.677899e-01 1 1  ON 15
 ud_6                -1.808195e-01 1 1  ON 16
 ud_7                -1.595587e-01 1 1  ON 17
 ud_8                -9.931838e-02 1 1  ON 18
 ud_9                -8.476133e-03 1 1  ON 19
 eO_0                -9.255083e-01 1 1  ON 20
 eO_1                -6.031125e-01 1 1  ON 21
 eO_2                -1.884757e-01 1 1  ON 22
 eO_3                 8.070239e-02 1 1  ON 23
 eO_4                 2.054028e-01 1 1  ON 24
 eO_5                 2.935418e-01 1 1  ON 25
 eO_6                 3.341352e-01 1 1  ON 26
 eO_7                 5.023005e-01 1 1  ON 27
 eO_8                 1.940566e-01 1 1  ON 28
 eO_9                 6.117185e-02 1 1  ON 29
eH1_0                -2.116867e-01 1 1  ON 30
eH1_1                -1.328691e-01 1 1  ON 31
eH1_2                -9.151189e-02 1 1  ON 32
eH1_3                -5.389715e-02 1 1  ON 33
eH1_4                -7.407719e-03 1 1  ON 34
eH1_5                 4.706751e-03 1 1  ON 35
eH1_6                 4.143099e-02 1 1  ON 36
eH1_7                 6.404808e-02 1 1  ON 37
eH1_8                 1.798815e-01 1 1  ON 38
eH1_9                 1.210047e-01 1 1  ON 39
eH2_0                -2.068781e-01 1 1  ON 40
eH2_1                -1.280616e-01 1 1  ON 41
eH2_2                -8.657559e-02 1 1  ON 42
eH2_3                -4.904279e-02 1 1  ON 43
eH2_4                -2.860052e-03 1 1  ON 44
eH2_5                 9.101246e-03 1 1  ON 45
eH2_6                 4.679036e-02 1 1  ON 46
eH2_7                 4.636778e-02 1 1  ON 47
eH2_8                 1.982524e-01 1 1  ON 48
eH2_9                 1.201573e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6000e+01 secs
  Total Execution time = 2.2643e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
