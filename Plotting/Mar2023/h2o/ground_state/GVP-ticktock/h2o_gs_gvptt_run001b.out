Rank =    0  Free Memory = 75970 MB
Rank =    1  Free Memory = 75970 MB
Rank =    2  Free Memory = 75970 MB
Rank =    3  Free Memory = 75969 MB
Rank =    4  Free Memory = 75969 MB
Rank =    5  Free Memory = 75969 MB
Rank =    6  Free Memory = 75969 MB
Rank =    7  Free Memory = 75969 MB
Rank =    8  Free Memory = 75969 MB
Rank =    9  Free Memory = 75968 MB
Rank =   10  Free Memory = 75967 MB
Rank =   11  Free Memory = 75967 MB
Rank =   12  Free Memory = 75967 MB
Rank =   13  Free Memory = 75967 MB
Rank =   14  Free Memory = 75966 MB
Rank =   15  Free Memory = 75953 MB
Rank =   16  Free Memory = 75953 MB
Rank =   17  Free Memory = 75952 MB
Rank =   18  Free Memory = 75952 MB
Rank =   19  Free Memory = 75952 MB
Rank =   20  Free Memory = 75952 MB
Rank =   21  Free Memory = 75952 MB
Rank =   22  Free Memory = 75952 MB
Rank =   23  Free Memory = 75952 MB
Rank =   24  Free Memory = 75952 MB
Rank =   25  Free Memory = 75952 MB
Rank =   26  Free Memory = 75952 MB
Rank =   27  Free Memory = 75952 MB
Rank =   28  Free Memory = 75952 MB
Rank =   29  Free Memory = 75952 MB
Rank =   30  Free Memory = 75952 MB
Rank =   31  Free Memory = 75952 MB
Rank =   32  Free Memory = 67999 MB
Rank =   33  Free Memory = 67999 MB
Rank =   34  Free Memory = 67999 MB
Rank =   35  Free Memory = 67999 MB
Rank =   36  Free Memory = 67999 MB
Rank =   37  Free Memory = 67999 MB
Rank =   38  Free Memory = 67999 MB
Rank =   39  Free Memory = 67999 MB
Rank =   40  Free Memory = 67999 MB
Rank =   41  Free Memory = 67999 MB
Rank =   42  Free Memory = 67999 MB
Rank =   43  Free Memory = 67999 MB
Rank =   44  Free Memory = 67999 MB
Rank =   45  Free Memory = 67999 MB
Rank =   46  Free Memory = 67999 MB
Rank =   47  Free Memory = 67999 MB
Rank =   48  Free Memory = 67999 MB
Rank =   49  Free Memory = 67999 MB
Rank =   50  Free Memory = 67999 MB
Rank =   51  Free Memory = 67999 MB
Rank =   52  Free Memory = 67999 MB
Rank =   53  Free Memory = 67999 MB
Rank =   54  Free Memory = 67999 MB
Rank =   55  Free Memory = 67999 MB
Rank =   56  Free Memory = 67999 MB
Rank =   57  Free Memory = 67999 MB
Rank =   58  Free Memory = 67999 MB
Rank =   59  Free Memory = 67999 MB
Rank =   60  Free Memory = 67999 MB
Rank =   61  Free Memory = 67999 MB
Rank =   62  Free Memory = 67999 MB
Rank =   63  Free Memory = 67999 MB
Rank =   64  Free Memory = 49096 MB
Rank =   65  Free Memory = 49096 MB
Rank =   66  Free Memory = 49096 MB
Rank =   67  Free Memory = 49096 MB
Rank =   68  Free Memory = 49096 MB
Rank =   69  Free Memory = 49096 MB
Rank =   70  Free Memory = 49096 MB
Rank =   71  Free Memory = 49096 MB
Rank =   72  Free Memory = 49096 MB
Rank =   73  Free Memory = 49096 MB
Rank =   74  Free Memory = 49096 MB
Rank =   75  Free Memory = 49096 MB
Rank =   76  Free Memory = 49096 MB
Rank =   77  Free Memory = 49096 MB
Rank =   78  Free Memory = 49096 MB
Rank =   79  Free Memory = 49096 MB
Rank =   80  Free Memory = 49096 MB
Rank =   81  Free Memory = 49096 MB
Rank =   82  Free Memory = 49096 MB
Rank =   83  Free Memory = 49096 MB
Rank =   84  Free Memory = 49096 MB
Rank =   85  Free Memory = 49096 MB
Rank =   86  Free Memory = 49096 MB
Rank =   87  Free Memory = 49096 MB
Rank =   88  Free Memory = 49096 MB
Rank =   89  Free Memory = 49096 MB
Rank =   90  Free Memory = 49096 MB
Rank =   91  Free Memory = 49096 MB
Rank =   92  Free Memory = 49096 MB
Rank =   93  Free Memory = 49096 MB
Rank =   94  Free Memory = 49096 MB
Rank =   95  Free Memory = 49096 MB
Rank =   96  Free Memory = 71797 MB
Rank =   97  Free Memory = 71797 MB
Rank =   98  Free Memory = 71797 MB
Rank =   99  Free Memory = 71797 MB
Rank =  100  Free Memory = 71797 MB
Rank =  101  Free Memory = 71797 MB
Rank =  102  Free Memory = 71797 MB
Rank =  103  Free Memory = 71797 MB
Rank =  104  Free Memory = 71797 MB
Rank =  105  Free Memory = 71797 MB
Rank =  106  Free Memory = 71797 MB
Rank =  107  Free Memory = 71797 MB
Rank =  108  Free Memory = 71797 MB
Rank =  109  Free Memory = 71797 MB
Rank =  110  Free Memory = 71797 MB
Rank =  111  Free Memory = 71797 MB
Rank =  112  Free Memory = 71797 MB
Rank =  113  Free Memory = 71797 MB
Rank =  114  Free Memory = 71797 MB
Rank =  115  Free Memory = 71797 MB
Rank =  116  Free Memory = 71797 MB
Rank =  117  Free Memory = 71797 MB
Rank =  118  Free Memory = 71797 MB
Rank =  119  Free Memory = 71797 MB
Rank =  120  Free Memory = 71797 MB
Rank =  121  Free Memory = 71797 MB
Rank =  122  Free Memory = 71797 MB
Rank =  123  Free Memory = 71797 MB
Rank =  124  Free Memory = 71797 MB
Rank =  125  Free Memory = 71797 MB
Rank =  126  Free Memory = 71797 MB
Rank =  127  Free Memory = 71797 MB
  Input file(s): opt_h2o_gs_gvptt_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run001b.xml

  Project = H2O
  date    = 2023-03-02 15:45:14 PST
  host    = n0015.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 266

  Range of prime numbers to use as seeds over processors and threads = 1721-2713


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.730650e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.7241e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2179
    reference variance = 0.258696
====================================================
  Execution time = 3.5193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 3.1001e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2380e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310080843461
                                         uncertainty =       0.004487020772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310080843461
                                         uncertainty =       0.004487020772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393709220
  error estimate for blocks of size 2^( 2) =       0.000405102419
  error estimate for blocks of size 2^( 3) =       0.000415698814
  error estimate for blocks of size 2^( 4) =       0.000423064089
  error estimate for blocks of size 2^( 5) =       0.000428367001
  error estimate for blocks of size 2^( 6) =       0.000431165337
  error estimate for blocks of size 2^( 7) =       0.000429777446

      target function =                  N/A
              le_mean =     -17.213889296344
             les_mean =     296.627998450924
             stat err =       0.000428093468
             autocorr =       1.182295490248
              std dev =       0.556788917935
             le_variance =       0.310013899135


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721388929634e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213889296344       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214202892928       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214357157204       residual = 9.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214555747422       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214635984307       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214685841879       residual = 5.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214698733432       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214730689520       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214730659460       residual = 8.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214730792709       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214729666305       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.214730658706       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.214730530632       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.753976e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213889296344       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214026253394       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214090654123       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214177957008       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214215132691       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214227545462       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214227476347       residual = 6.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214232671385       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214233336313       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.214233266772       residual = 4.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.214233253035       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.650768e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.213889296344       residual = 2.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.213931396523       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.213951340502       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.213979233378       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.213990828882       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.213993380936       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.213993283614       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.213993971970       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.213994029939       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.213994111896       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.213994133003       residual = 1.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.551463e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4761e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.927870e-01                 1 1 ON  0
uu_1  3.729652e-02                 1 1 ON  1
uu_2  -4.649712e-02                1 1 ON  2
uu_3  -9.442217e-02                1 1 ON  3
uu_4  -1.252893e-01                1 1 ON  4
uu_5  -1.327709e-01                1 1 ON  5
uu_6  -1.095071e-01                1 1 ON  6
uu_7  -3.352873e-02                1 1 ON  7
uu_8  1.029758e-01                 1 1 ON  8
uu_9  1.188685e-01                 1 1 ON  9
ud_0  3.198598e-01                 1 1 ON  10
ud_1  7.787770e-02                 1 1 ON  11
ud_2  -1.013640e-02                1 1 ON  12
ud_3  -5.818577e-02                1 1 ON  13
ud_4  -1.072768e-01                1 1 ON  14
ud_5  -1.487403e-01                1 1 ON  15
ud_6  -1.576350e-01                1 1 ON  16
ud_7  -1.081325e-01                1 1 ON  17
ud_8  9.553643e-03                 1 1 ON  18
ud_9  9.248653e-02                 1 1 ON  19
eO_0  -6.868202e-01                1 1 ON  20
eO_1  -4.051920e-01                1 1 ON  21
eO_2  -5.629989e-02                1 1 ON  22
eO_3  1.652142e-01                 1 1 ON  23
eO_4  2.643297e-01                 1 1 ON  24
eO_5  3.065505e-01                 1 1 ON  25
eO_6  2.481851e-01                 1 1 ON  26
eO_7  1.082380e-01                 1 1 ON  27
eO_8  2.728867e-02                 1 1 ON  28
eO_9  1.813866e-02                 1 1 ON  29
eH1_0 -1.760672e-01                1 1 ON  30
eH1_1 -9.850418e-02                1 1 ON  31
eH1_2 -6.259041e-02                1 1 ON  32
eH1_3 -2.842500e-02                1 1 ON  33
eH1_4 1.802217e-02                 1 1 ON  34
eH1_5 3.118125e-02                 1 1 ON  35
eH1_6 7.770066e-02                 1 1 ON  36
eH1_7 1.114439e-01                 1 1 ON  37
eH1_8 8.859916e-02                 1 1 ON  38
eH1_9 2.360157e-02                 1 1 ON  39
eH2_0 -1.777600e-01                1 1 ON  40
eH2_1 -1.002573e-01                1 1 ON  41
eH2_2 -6.448819e-02                1 1 ON  42
eH2_3 -2.985090e-02                1 1 ON  43
eH2_4 1.652977e-02                 1 1 ON  44
eH2_5 3.147759e-02                 1 1 ON  45
eH2_6 8.002522e-02                 1 1 ON  46
eH2_7 1.151671e-01                 1 1 ON  47
eH2_8 9.164624e-02                 1 1 ON  48
eH2_9 2.563611e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2404
    reference variance = 0.159398
====================================================
  Execution time = 3.4485e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0919e-01
  Total weights = 2.0000e+06
  Execution time = 3.0929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307967950402
                                         uncertainty =       0.005318508819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307967950402
                                         uncertainty =       0.005318508819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392344626
  error estimate for blocks of size 2^( 2) =       0.000404005845
  error estimate for blocks of size 2^( 3) =       0.000413768827
  error estimate for blocks of size 2^( 4) =       0.000421095955
  error estimate for blocks of size 2^( 5) =       0.000425671304
  error estimate for blocks of size 2^( 6) =       0.000429337278
  error estimate for blocks of size 2^( 7) =       0.000430768409

      target function =                  N/A
              le_mean =     -17.215062139296
             les_mean =     296.666232916678
             stat err =       0.000426718237
             autocorr =       1.182897164820
              std dev =       0.554859090916
             le_variance =       0.307868610773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313292171660
                                         uncertainty =       0.005346880226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313292171660
                                         uncertainty =       0.005346880226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395718061
  error estimate for blocks of size 2^( 2) =       0.000406279087
  error estimate for blocks of size 2^( 3) =       0.000415120601
  error estimate for blocks of size 2^( 4) =       0.000421913937
  error estimate for blocks of size 2^( 5) =       0.000426271276
  error estimate for blocks of size 2^( 6) =       0.000429627454
  error estimate for blocks of size 2^( 7) =       0.000430996512

      target function =                  N/A
              le_mean =     -17.215110666544
             les_mean =     296.673220672559
             stat err =       0.000427202295
             autocorr =       1.165454728727
              std dev =       0.559629848912
             le_variance =       0.313185567793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311791742257
                                         uncertainty =       0.005335549336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311791742257
                                         uncertainty =       0.005335549336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394769770
  error estimate for blocks of size 2^( 2) =       0.000405534233
  error estimate for blocks of size 2^( 3) =       0.000414566159
  error estimate for blocks of size 2^( 4) =       0.000421475573
  error estimate for blocks of size 2^( 5) =       0.000425882411
  error estimate for blocks of size 2^( 6) =       0.000429327396
  error estimate for blocks of size 2^( 7) =       0.000430717533

      target function =                  N/A
              le_mean =     -17.215050379564
             les_mean =     296.669645757804
             stat err =       0.000426850728
             autocorr =       1.169133960097
              std dev =       0.558288762832
             le_variance =       0.311686342704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308206207948
                                         uncertainty =       0.005319785790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308206207948
                                         uncertainty =       0.005319785790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392495837
  error estimate for blocks of size 2^( 2) =       0.000404006294
  error estimate for blocks of size 2^( 3) =       0.000413650607
  error estimate for blocks of size 2^( 4) =       0.000420911769
  error estimate for blocks of size 2^( 5) =       0.000425459955
  error estimate for blocks of size 2^( 6) =       0.000429095225
  error estimate for blocks of size 2^( 7) =       0.000430520896

      target function =                  N/A
              le_mean =     -17.215017095455
             les_mean =     296.664919406372
             stat err =       0.000426496961
             autocorr =       1.180760384006
              std dev =       0.555072935409
             le_variance =       0.308105963623


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215062139296        initial
     2.5000e-01     2.5000e+00             1.7540e-02       -17.215110666544  <--
     1.0000e+00     1.0000e+01             5.6508e-03       -17.215050379564
     4.0000e+00     4.0000e+01             1.5515e-03       -17.215017095455

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 5.0087e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.951951e-01 1 1  ON 0
 uu_1                 3.929662e-02 1 1  ON 1
 uu_2                -4.744919e-02 1 1  ON 2
 uu_3                -9.596703e-02 1 1  ON 3
 uu_4                -1.258329e-01 1 1  ON 4
 uu_5                -1.329190e-01 1 1  ON 5
 uu_6                -1.100934e-01 1 1  ON 6
 uu_7                -3.431284e-02 1 1  ON 7
 uu_8                 1.026493e-01 1 1  ON 8
 uu_9                 1.190472e-01 1 1  ON 9
 ud_0                 3.273960e-01 1 1  ON 10
 ud_1                 8.066020e-02 1 1  ON 11
 ud_2                -1.324803e-02 1 1  ON 12
 ud_3                -6.305345e-02 1 1  ON 13
 ud_4                -1.096206e-01 1 1  ON 14
 ud_5                -1.481330e-01 1 1  ON 15
 ud_6                -1.573012e-01 1 1  ON 16
 ud_7                -1.087407e-01 1 1  ON 17
 ud_8                 8.991695e-03 1 1  ON 18
 ud_9                 9.248074e-02 1 1  ON 19
 eO_0                -6.987092e-01 1 1  ON 20
 eO_1                -4.095196e-01 1 1  ON 21
 eO_2                -4.859501e-02 1 1  ON 22
 eO_3                 1.729122e-01 1 1  ON 23
 eO_4                 2.656195e-01 1 1  ON 24
 eO_5                 3.056035e-01 1 1  ON 25
 eO_6                 2.481970e-01 1 1  ON 26
 eO_7                 1.085749e-01 1 1  ON 27
 eO_8                 2.734156e-02 1 1  ON 28
 eO_9                 1.816695e-02 1 1  ON 29
eH1_0                -1.768967e-01 1 1  ON 30
eH1_1                -9.908014e-02 1 1  ON 31
eH1_2                -6.300535e-02 1 1  ON 32
eH1_3                -2.783652e-02 1 1  ON 33
eH1_4                 1.863067e-02 1 1  ON 34
eH1_5                 3.198314e-02 1 1  ON 35
eH1_6                 7.734153e-02 1 1  ON 36
eH1_7                 1.112914e-01 1 1  ON 37
eH1_8                 8.881861e-02 1 1  ON 38
eH1_9                 2.365758e-02 1 1  ON 39
eH2_0                -1.785282e-01 1 1  ON 40
eH2_1                -1.007936e-01 1 1  ON 41
eH2_2                -6.451793e-02 1 1  ON 42
eH2_3                -2.910508e-02 1 1  ON 43
eH2_4                 1.707662e-02 1 1  ON 44
eH2_5                 3.196727e-02 1 1  ON 45
eH2_6                 7.950727e-02 1 1  ON 46
eH2_7                 1.149561e-01 1 1  ON 47
eH2_8                 9.184630e-02 1 1  ON 48
eH2_9                 2.570391e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4855e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2706
    reference variance = 0.356949
====================================================
  Execution time = 3.6306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.0542e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305464384652
                                         uncertainty =       0.003530552446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305464384652
                                         uncertainty =       0.003530552446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390780915
  error estimate for blocks of size 2^( 2) =       0.000401348766
  error estimate for blocks of size 2^( 3) =       0.000410547182
  error estimate for blocks of size 2^( 4) =       0.000417301960
  error estimate for blocks of size 2^( 5) =       0.000421219083
  error estimate for blocks of size 2^( 6) =       0.000423952532
  error estimate for blocks of size 2^( 7) =       0.000426765270

      target function =                  N/A
              le_mean =     -17.215203119620
             les_mean =     296.668637743871
             stat err =       0.000422309711
             autocorr =       1.167872538374
              std dev =       0.552647669680
             le_variance =       0.305419446803


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721520311962e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215203119620       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215298031600       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215404928248       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215489636491       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215547449410       residual = 5.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215606391111       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215639908094       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215674752456       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215681629426       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215688926263       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215690579332       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215690219551       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.215689755852       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.215690370037       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.215690403731       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.215690814855       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.215691059032       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.951360e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215203119620       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215263515431       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215326653648       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215378897714       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215415974864       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215439830951       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215447543838       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215458459874       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215458441468       residual = 8.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215459021340       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215458690627       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.215458468551       residual = 8.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.201287e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215203119620       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215227723983       residual = 5.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215252944328       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215274111468       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215289083137       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215294997317       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215295731108       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215297878435       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215297727401       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.215297749635       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.215297638431       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 3.757179e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5327e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.982026e-01 1 1  ON 0
 uu_1                 4.092305e-02 1 1  ON 1
 uu_2                -4.819119e-02 1 1  ON 2
 uu_3                -9.763009e-02 1 1  ON 3
 uu_4                -1.268142e-01 1 1  ON 4
 uu_5                -1.330540e-01 1 1  ON 5
 uu_6                -1.106858e-01 1 1  ON 6
 uu_7                -3.496381e-02 1 1  ON 7
 uu_8                 1.022950e-01 1 1  ON 8
 uu_9                 1.192521e-01 1 1  ON 9
 ud_0                 3.337982e-01 1 1  ON 10
 ud_1                 8.312159e-02 1 1  ON 11
 ud_2                -1.515293e-02 1 1  ON 12
 ud_3                -6.727568e-02 1 1  ON 13
 ud_4                -1.123201e-01 1 1  ON 14
 ud_5                -1.479537e-01 1 1  ON 15
 ud_6                -1.567009e-01 1 1  ON 16
 ud_7                -1.091974e-01 1 1  ON 17
 ud_8                 8.422049e-03 1 1  ON 18
 ud_9                 9.248521e-02 1 1  ON 19
 eO_0                -7.107220e-01 1 1  ON 20
 eO_1                -4.143479e-01 1 1  ON 21
 eO_2                -4.251382e-02 1 1  ON 22
 eO_3                 1.810286e-01 1 1  ON 23
 eO_4                 2.681882e-01 1 1  ON 24
 eO_5                 3.049229e-01 1 1  ON 25
 eO_6                 2.483426e-01 1 1  ON 26
 eO_7                 1.090339e-01 1 1  ON 27
 eO_8                 2.743684e-02 1 1  ON 28
 eO_9                 1.819775e-02 1 1  ON 29
eH1_0                -1.779973e-01 1 1  ON 30
eH1_1                -9.978012e-02 1 1  ON 31
eH1_2                -6.278335e-02 1 1  ON 32
eH1_3                -2.726961e-02 1 1  ON 33
eH1_4                 1.925104e-02 1 1  ON 34
eH1_5                 3.248725e-02 1 1  ON 35
eH1_6                 7.713328e-02 1 1  ON 36
eH1_7                 1.110552e-01 1 1  ON 37
eH1_8                 8.903602e-02 1 1  ON 38
eH1_9                 2.373338e-02 1 1  ON 39
eH2_0                -1.795088e-01 1 1  ON 40
eH2_1                -1.014453e-01 1 1  ON 41
eH2_2                -6.448234e-02 1 1  ON 42
eH2_3                -2.857366e-02 1 1  ON 43
eH2_4                 1.783630e-02 1 1  ON 44
eH2_5                 3.250052e-02 1 1  ON 45
eH2_6                 7.923332e-02 1 1  ON 46
eH2_7                 1.147045e-01 1 1  ON 47
eH2_8                 9.204617e-02 1 1  ON 48
eH2_9                 2.577551e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2805
    reference variance = 0.473005
====================================================
  Execution time = 3.4047e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1295e-01
  Total weights = 2.0000e+06
  Execution time = 3.1164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308473749911
                                         uncertainty =       0.004290298534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308473749911
                                         uncertainty =       0.004290298534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392694404
  error estimate for blocks of size 2^( 2) =       0.000403295488
  error estimate for blocks of size 2^( 3) =       0.000412387628
  error estimate for blocks of size 2^( 4) =       0.000419992688
  error estimate for blocks of size 2^( 5) =       0.000424009417
  error estimate for blocks of size 2^( 6) =       0.000426089017
  error estimate for blocks of size 2^( 7) =       0.000428847806

      target function =                  N/A
              le_mean =     -17.215496201291
             les_mean =     296.681727092994
             stat err =       0.000424734732
             autocorr =       1.169839083312
              std dev =       0.555353752615
             le_variance =       0.308417790543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317504705624
                                         uncertainty =       0.004304061363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317504705624
                                         uncertainty =       0.004304061363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398402003
  error estimate for blocks of size 2^( 2) =       0.000408315679
  error estimate for blocks of size 2^( 3) =       0.000416795553
  error estimate for blocks of size 2^( 4) =       0.000424004946
  error estimate for blocks of size 2^( 5) =       0.000427770970
  error estimate for blocks of size 2^( 6) =       0.000429873944
  error estimate for blocks of size 2^( 7) =       0.000432714251

      target function =                  N/A
              le_mean =     -17.215496694808
             les_mean =     296.690774602282
             stat err =       0.000428591028
             autocorr =       1.157292459739
              std dev =       0.563425515976
             le_variance =       0.317448312053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318808200555
                                         uncertainty =       0.004325061164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318808200555
                                         uncertainty =       0.004325061164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399219155
  error estimate for blocks of size 2^( 2) =       0.000409120952
  error estimate for blocks of size 2^( 3) =       0.000417595264
  error estimate for blocks of size 2^( 4) =       0.000424805822
  error estimate for blocks of size 2^( 5) =       0.000428596074
  error estimate for blocks of size 2^( 6) =       0.000430731116
  error estimate for blocks of size 2^( 7) =       0.000433613186

      target function =                  N/A
              le_mean =     -17.215525732421
             les_mean =     296.693077951281
             stat err =       0.000429436550
             autocorr =       1.157111654349
              std dev =       0.564581142975
             le_variance =       0.318751867003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310108191767
                                         uncertainty =       0.004298090261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310108191767
                                         uncertainty =       0.004298090261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393733558
  error estimate for blocks of size 2^( 2) =       0.000404173600
  error estimate for blocks of size 2^( 3) =       0.000413129066
  error estimate for blocks of size 2^( 4) =       0.000420651745
  error estimate for blocks of size 2^( 5) =       0.000424625147
  error estimate for blocks of size 2^( 6) =       0.000426713881
  error estimate for blocks of size 2^( 7) =       0.000429498284

      target function =                  N/A
              le_mean =     -17.215437396036
             les_mean =     296.681336811838
             stat err =       0.000425372264
             autocorr =       1.167168275315
              std dev =       0.556823338262
             le_variance =       0.310052230033


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215496201291        initial
     6.2500e-02     6.2500e-01             2.9514e-02       -17.215496694808
     2.5000e-01     2.5000e+00             1.2013e-02       -17.215525732421  <--
     1.0000e+00     1.0000e+01             3.7572e-03       -17.215437396036

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 4.9778e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.982026e-01 1 1  ON 0
 uu_1                 4.092305e-02 1 1  ON 1
 uu_2                -4.819119e-02 1 1  ON 2
 uu_3                -9.763009e-02 1 1  ON 3
 uu_4                -1.268142e-01 1 1  ON 4
 uu_5                -1.330540e-01 1 1  ON 5
 uu_6                -1.106858e-01 1 1  ON 6
 uu_7                -3.496381e-02 1 1  ON 7
 uu_8                 1.022950e-01 1 1  ON 8
 uu_9                 1.192521e-01 1 1  ON 9
 ud_0                 3.337982e-01 1 1  ON 10
 ud_1                 8.312159e-02 1 1  ON 11
 ud_2                -1.515293e-02 1 1  ON 12
 ud_3                -6.727568e-02 1 1  ON 13
 ud_4                -1.123201e-01 1 1  ON 14
 ud_5                -1.479537e-01 1 1  ON 15
 ud_6                -1.567009e-01 1 1  ON 16
 ud_7                -1.091974e-01 1 1  ON 17
 ud_8                 8.422049e-03 1 1  ON 18
 ud_9                 9.248521e-02 1 1  ON 19
 eO_0                -7.107220e-01 1 1  ON 20
 eO_1                -4.143479e-01 1 1  ON 21
 eO_2                -4.251382e-02 1 1  ON 22
 eO_3                 1.810286e-01 1 1  ON 23
 eO_4                 2.681882e-01 1 1  ON 24
 eO_5                 3.049229e-01 1 1  ON 25
 eO_6                 2.483426e-01 1 1  ON 26
 eO_7                 1.090339e-01 1 1  ON 27
 eO_8                 2.743684e-02 1 1  ON 28
 eO_9                 1.819775e-02 1 1  ON 29
eH1_0                -1.779973e-01 1 1  ON 30
eH1_1                -9.978012e-02 1 1  ON 31
eH1_2                -6.278335e-02 1 1  ON 32
eH1_3                -2.726961e-02 1 1  ON 33
eH1_4                 1.925104e-02 1 1  ON 34
eH1_5                 3.248725e-02 1 1  ON 35
eH1_6                 7.713328e-02 1 1  ON 36
eH1_7                 1.110552e-01 1 1  ON 37
eH1_8                 8.903602e-02 1 1  ON 38
eH1_9                 2.373338e-02 1 1  ON 39
eH2_0                -1.795088e-01 1 1  ON 40
eH2_1                -1.014453e-01 1 1  ON 41
eH2_2                -6.448234e-02 1 1  ON 42
eH2_3                -2.857366e-02 1 1  ON 43
eH2_4                 1.783630e-02 1 1  ON 44
eH2_5                 3.250052e-02 1 1  ON 45
eH2_6                 7.923332e-02 1 1  ON 46
eH2_7                 1.147045e-01 1 1  ON 47
eH2_8                 9.204617e-02 1 1  ON 48
eH2_9                 2.577551e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5112e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7252e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1816
    reference variance = 0.164236
====================================================
  Execution time = 3.5278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1500e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315075421012
                                         uncertainty =       0.004974816469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315075421012
                                         uncertainty =       0.004974816469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396865022
  error estimate for blocks of size 2^( 2) =       0.000406863124
  error estimate for blocks of size 2^( 3) =       0.000415650159
  error estimate for blocks of size 2^( 4) =       0.000422383544
  error estimate for blocks of size 2^( 5) =       0.000426279501
  error estimate for blocks of size 2^( 6) =       0.000428596743
  error estimate for blocks of size 2^( 7) =       0.000427671230

      target function =                  N/A
              le_mean =     -17.216457090155
             les_mean =     296.721398271717
             stat err =       0.000426232754
             autocorr =       1.153474486573
              std dev =       0.561251897179
             le_variance =       0.315003692088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645709015e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457090154       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216478949122       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216498201534       residual = 8.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216534728269       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216559583493       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216581648145       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216610510019       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216615758586       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216618433533       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216622826214       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216626818130       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216625542119       residual = 9.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216626210947       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216626423227       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216626313016       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216626365937       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.166838e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457090154       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216470643497       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216482993038       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216497310719       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216514012053       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216521204235       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216528396021       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216528887021       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216529437778       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216529819662       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216530074424       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216529986892       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.437559e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216457090154       residual = 9.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216462468761       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216467721648       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216471254114       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216478050303       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216479623672       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216480475930       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216480306247       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216480473368       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216480523334       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216480548714       residual = 1.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.579338e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334283 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4407e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.005416e-01 1 1  ON 0
 uu_1                 4.211599e-02 1 1  ON 1
 uu_2                -4.806138e-02 1 1  ON 2
 uu_3                -9.854562e-02 1 1  ON 3
 uu_4                -1.278585e-01 1 1  ON 4
 uu_5                -1.333910e-01 1 1  ON 5
 uu_6                -1.111479e-01 1 1  ON 6
 uu_7                -3.563245e-02 1 1  ON 7
 uu_8                 1.017968e-01 1 1  ON 8
 uu_9                 1.193426e-01 1 1  ON 9
 ud_0                 3.371138e-01 1 1  ON 10
 ud_1                 8.466004e-02 1 1  ON 11
 ud_2                -1.577865e-02 1 1  ON 12
 ud_3                -6.926975e-02 1 1  ON 13
 ud_4                -1.142039e-01 1 1  ON 14
 ud_5                -1.478597e-01 1 1  ON 15
 ud_6                -1.559947e-01 1 1  ON 16
 ud_7                -1.096682e-01 1 1  ON 17
 ud_8                 7.631116e-03 1 1  ON 18
 ud_9                 9.242217e-02 1 1  ON 19
 eO_0                -7.191596e-01 1 1  ON 20
 eO_1                -4.182184e-01 1 1  ON 21
 eO_2                -3.992371e-02 1 1  ON 22
 eO_3                 1.873326e-01 1 1  ON 23
 eO_4                 2.714200e-01 1 1  ON 24
 eO_5                 3.045988e-01 1 1  ON 25
 eO_6                 2.484186e-01 1 1  ON 26
 eO_7                 1.094269e-01 1 1  ON 27
 eO_8                 2.745814e-02 1 1  ON 28
 eO_9                 1.820810e-02 1 1  ON 29
eH1_0                -1.784879e-01 1 1  ON 30
eH1_1                -1.004794e-01 1 1  ON 31
eH1_2                -6.263746e-02 1 1  ON 32
eH1_3                -2.684170e-02 1 1  ON 33
eH1_4                 1.919784e-02 1 1  ON 34
eH1_5                 3.318230e-02 1 1  ON 35
eH1_6                 7.699256e-02 1 1  ON 36
eH1_7                 1.108583e-01 1 1  ON 37
eH1_8                 8.930062e-02 1 1  ON 38
eH1_9                 2.378745e-02 1 1  ON 39
eH2_0                -1.799622e-01 1 1  ON 40
eH2_1                -1.019946e-01 1 1  ON 41
eH2_2                -6.411875e-02 1 1  ON 42
eH2_3                -2.817813e-02 1 1  ON 43
eH2_4                 1.811089e-02 1 1  ON 44
eH2_5                 3.305938e-02 1 1  ON 45
eH2_6                 7.879270e-02 1 1  ON 46
eH2_7                 1.143592e-01 1 1  ON 47
eH2_8                 9.218525e-02 1 1  ON 48
eH2_9                 2.582479e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1451
    reference variance = 0.180706
====================================================
  Execution time = 3.4108e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0986e-01
  Total weights = 2.0000e+06
  Execution time = 3.0980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307234677492
                                         uncertainty =       0.002544942024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307234677492
                                         uncertainty =       0.002544942024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391913710
  error estimate for blocks of size 2^( 2) =       0.000401857132
  error estimate for blocks of size 2^( 3) =       0.000411545158
  error estimate for blocks of size 2^( 4) =       0.000418805663
  error estimate for blocks of size 2^( 5) =       0.000422817391
  error estimate for blocks of size 2^( 6) =       0.000425159817
  error estimate for blocks of size 2^( 7) =       0.000423482824

      target function =                  N/A
              le_mean =     -17.216155808502
             les_mean =     296.703213380914
             stat err =       0.000422566424
             autocorr =       1.162543091712
              std dev =       0.554249683699
             le_variance =       0.307192711881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312669659257
                                         uncertainty =       0.002617871522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312669659257
                                         uncertainty =       0.002617871522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395364500
  error estimate for blocks of size 2^( 2) =       0.000404963383
  error estimate for blocks of size 2^( 3) =       0.000414322307
  error estimate for blocks of size 2^( 4) =       0.000421367574
  error estimate for blocks of size 2^( 5) =       0.000425243923
  error estimate for blocks of size 2^( 6) =       0.000427397629
  error estimate for blocks of size 2^( 7) =       0.000425706018

      target function =                  N/A
              le_mean =     -17.216167990438
             les_mean =     296.709066294392
             stat err =       0.000424928786
             autocorr =       1.155146224201
              std dev =       0.559129837997
             le_variance =       0.312626175738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312892228935
                                         uncertainty =       0.002614788839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312892228935
                                         uncertainty =       0.002614788839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395504936
  error estimate for blocks of size 2^( 2) =       0.000405115936
  error estimate for blocks of size 2^( 3) =       0.000414493760
  error estimate for blocks of size 2^( 4) =       0.000421561425
  error estimate for blocks of size 2^( 5) =       0.000425438245
  error estimate for blocks of size 2^( 6) =       0.000427603082
  error estimate for blocks of size 2^( 7) =       0.000425895217

      target function =                  N/A
              le_mean =     -17.216164823546
             les_mean =     296.709179384368
             stat err =       0.000425124492
             autocorr =       1.155389552962
              std dev =       0.559328444918
             le_variance =       0.312848309295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308191187523
                                         uncertainty =       0.002557066146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308191187523
                                         uncertainty =       0.002557066146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392523122
  error estimate for blocks of size 2^( 2) =       0.000402400138
  error estimate for blocks of size 2^( 3) =       0.000412028123
  error estimate for blocks of size 2^( 4) =       0.000419253590
  error estimate for blocks of size 2^( 5) =       0.000423238555
  error estimate for blocks of size 2^( 6) =       0.000425550243
  error estimate for blocks of size 2^( 7) =       0.000423863606

      target function =                  N/A
              le_mean =     -17.216141812940
             les_mean =     296.703687571222
             stat err =       0.000422976499
             autocorr =       1.161186524995
              std dev =       0.555111522174
             le_variance =       0.308148802050


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216155808502        initial
     6.2500e-02     6.2500e-01             2.1668e-02       -17.216167990438  <--
     2.5000e-01     2.5000e+00             8.4376e-03       -17.216164823546
     1.0000e+00     1.0000e+01             2.5793e-03       -17.216141812940

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 4.9733e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.043864e-01 1 1  ON 0
 uu_1                 4.444509e-02 1 1  ON 1
 uu_2                -4.708465e-02 1 1  ON 2
 uu_3                -9.917069e-02 1 1  ON 3
 uu_4                -1.295850e-01 1 1  ON 4
 uu_5                -1.348804e-01 1 1  ON 5
 uu_6                -1.122144e-01 1 1  ON 6
 uu_7                -3.727017e-02 1 1  ON 7
 uu_8                 1.003708e-01 1 1  ON 8
 uu_9                 1.196282e-01 1 1  ON 9
 ud_0                 3.407468e-01 1 1  ON 10
 ud_1                 8.689310e-02 1 1  ON 11
 ud_2                -1.541507e-02 1 1  ON 12
 ud_3                -7.075634e-02 1 1  ON 13
 ud_4                -1.165548e-01 1 1  ON 14
 ud_5                -1.489418e-01 1 1  ON 15
 ud_6                -1.550106e-01 1 1  ON 16
 ud_7                -1.102542e-01 1 1  ON 17
 ud_8                 5.546620e-03 1 1  ON 18
 ud_9                 9.226104e-02 1 1  ON 19
 eO_0                -7.323904e-01 1 1  ON 20
 eO_1                -4.259798e-01 1 1  ON 21
 eO_2                -3.966465e-02 1 1  ON 22
 eO_3                 1.957833e-01 1 1  ON 23
 eO_4                 2.803817e-01 1 1  ON 24
 eO_5                 3.059142e-01 1 1  ON 25
 eO_6                 2.490495e-01 1 1  ON 26
 eO_7                 1.106730e-01 1 1  ON 27
 eO_8                 2.753606e-02 1 1  ON 28
 eO_9                 1.824134e-02 1 1  ON 29
eH1_0                -1.794893e-01 1 1  ON 30
eH1_1                -1.015129e-01 1 1  ON 31
eH1_2                -6.244736e-02 1 1  ON 32
eH1_3                -2.642238e-02 1 1  ON 33
eH1_4                 1.900511e-02 1 1  ON 34
eH1_5                 3.376710e-02 1 1  ON 35
eH1_6                 7.730584e-02 1 1  ON 36
eH1_7                 1.105860e-01 1 1  ON 37
eH1_8                 9.014030e-02 1 1  ON 38
eH1_9                 2.395899e-02 1 1  ON 39
eH2_0                -1.806936e-01 1 1  ON 40
eH2_1                -1.026443e-01 1 1  ON 41
eH2_2                -6.357154e-02 1 1  ON 42
eH2_3                -2.755693e-02 1 1  ON 43
eH2_4                 1.833709e-02 1 1  ON 44
eH2_5                 3.356718e-02 1 1  ON 45
eH2_6                 7.836030e-02 1 1  ON 46
eH2_7                 1.136354e-01 1 1  ON 47
eH2_8                 9.263945e-02 1 1  ON 48
eH2_9                 2.598080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4156e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1948
    reference variance = 0.216126
====================================================
  Execution time = 3.4889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1553e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315543059937
                                         uncertainty =       0.003105649366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315543059937
                                         uncertainty =       0.003105649366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397193610
  error estimate for blocks of size 2^( 2) =       0.000406995319
  error estimate for blocks of size 2^( 3) =       0.000415312218
  error estimate for blocks of size 2^( 4) =       0.000421003926
  error estimate for blocks of size 2^( 5) =       0.000425572558
  error estimate for blocks of size 2^( 6) =       0.000428628052
  error estimate for blocks of size 2^( 7) =       0.000428776704

      target function =                  N/A
              le_mean =     -17.216397026422
             les_mean =     296.719851941183
             stat err =       0.000425995310
             autocorr =       1.150284133553
              std dev =       0.561716590055
             le_variance =       0.315525527543


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639702642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216397026422       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216397732132       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404892244       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216405043458       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216448456958       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216470344945       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216478996462       residual = 5.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216483844036       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216497622492       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216504775191       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216503349774       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216495463145       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216497163276       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216497281297       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216496966102       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.216497675368       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216498801081       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.216498904947       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.216499907862       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.216500175644       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.216500408859       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         20 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.984578e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216397026422       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216397579889       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216404064710       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216404882688       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216436074380       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216446875109       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216449198598       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216450443442       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216456102498       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216455917043       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216454966406       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216452529154       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216452279640       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216452845016       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216452732031       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.270449e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216397026422       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216397323518       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216401890233       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216402774812       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216416250776       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216418210564       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216418683987       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216418315233       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216419621081       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216419018760       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216418927697       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.454402e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.343979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4126e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.076191e-01 1 1  ON 0
 uu_1                 4.634278e-02 1 1  ON 1
 uu_2                -4.624367e-02 1 1  ON 2
 uu_3                -9.939867e-02 1 1  ON 3
 uu_4                -1.314706e-01 1 1  ON 4
 uu_5                -1.374080e-01 1 1  ON 5
 uu_6                -1.136429e-01 1 1  ON 6
 uu_7                -3.867069e-02 1 1  ON 7
 uu_8                 9.964404e-02 1 1  ON 8
 uu_9                 1.208136e-01 1 1  ON 9
 ud_0                 3.437671e-01 1 1  ON 10
 ud_1                 8.890583e-02 1 1  ON 11
 ud_2                -1.477566e-02 1 1  ON 12
 ud_3                -7.195681e-02 1 1  ON 13
 ud_4                -1.188803e-01 1 1  ON 14
 ud_5                -1.512121e-01 1 1  ON 15
 ud_6                -1.550945e-01 1 1  ON 16
 ud_7                -1.095666e-01 1 1  ON 17
 ud_8                 4.298978e-03 1 1  ON 18
 ud_9                 9.229920e-02 1 1  ON 19
 eO_0                -7.450949e-01 1 1  ON 20
 eO_1                -4.339832e-01 1 1  ON 21
 eO_2                -4.134940e-02 1 1  ON 22
 eO_3                 2.020175e-01 1 1  ON 23
 eO_4                 2.896387e-01 1 1  ON 24
 eO_5                 3.082259e-01 1 1  ON 25
 eO_6                 2.508229e-01 1 1  ON 26
 eO_7                 1.129367e-01 1 1  ON 27
 eO_8                 2.792917e-02 1 1  ON 28
 eO_9                 1.836471e-02 1 1  ON 29
eH1_0                -1.803702e-01 1 1  ON 30
eH1_1                -1.025202e-01 1 1  ON 31
eH1_2                -6.302975e-02 1 1  ON 32
eH1_3                -2.699962e-02 1 1  ON 33
eH1_4                 1.874249e-02 1 1  ON 34
eH1_5                 3.460098e-02 1 1  ON 35
eH1_6                 7.766624e-02 1 1  ON 36
eH1_7                 1.109453e-01 1 1  ON 37
eH1_8                 9.160688e-02 1 1  ON 38
eH1_9                 2.426854e-02 1 1  ON 39
eH2_0                -1.826715e-01 1 1  ON 40
eH2_1                -1.032253e-01 1 1  ON 41
eH2_2                -6.311979e-02 1 1  ON 42
eH2_3                -2.732001e-02 1 1  ON 43
eH2_4                 1.855675e-02 1 1  ON 44
eH2_5                 3.338488e-02 1 1  ON 45
eH2_6                 7.913161e-02 1 1  ON 46
eH2_7                 1.133539e-01 1 1  ON 47
eH2_8                 9.354188e-02 1 1  ON 48
eH2_9                 2.632766e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.29246
====================================================
  Execution time = 3.4081e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2197e-01
  Total weights = 2.0000e+06
  Execution time = 3.0963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319697357879
                                         uncertainty =       0.003762548757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319697357879
                                         uncertainty =       0.003762548757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399780416
  error estimate for blocks of size 2^( 2) =       0.000409225789
  error estimate for blocks of size 2^( 3) =       0.000417863911
  error estimate for blocks of size 2^( 4) =       0.000424495260
  error estimate for blocks of size 2^( 5) =       0.000429062980
  error estimate for blocks of size 2^( 6) =       0.000430392771
  error estimate for blocks of size 2^( 7) =       0.000431773996

      target function =                  N/A
              le_mean =     -17.216867447581
             les_mean =     296.740173310409
             stat err =       0.000428931252
             autocorr =       1.151151141083
              std dev =       0.565374886816
             le_variance =       0.319648762643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323875350541
                                         uncertainty =       0.003813019222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323875350541
                                         uncertainty =       0.003813019222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402383983
  error estimate for blocks of size 2^( 2) =       0.000411666693
  error estimate for blocks of size 2^( 3) =       0.000420089497
  error estimate for blocks of size 2^( 4) =       0.000426549949
  error estimate for blocks of size 2^( 5) =       0.000431034969
  error estimate for blocks of size 2^( 6) =       0.000432389537
  error estimate for blocks of size 2^( 7) =       0.000433837041

      target function =                  N/A
              le_mean =     -17.216842540495
             les_mean =     296.743492642437
             stat err =       0.000430952874
             autocorr =       1.147039019457
              std dev =       0.569056886557
             le_variance =       0.323825740138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324563943267
                                         uncertainty =       0.003822805905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324563943267
                                         uncertainty =       0.003822805905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402811412
  error estimate for blocks of size 2^( 2) =       0.000412086702
  error estimate for blocks of size 2^( 3) =       0.000420508742
  error estimate for blocks of size 2^( 4) =       0.000426965163
  error estimate for blocks of size 2^( 5) =       0.000431455607
  error estimate for blocks of size 2^( 6) =       0.000432816289
  error estimate for blocks of size 2^( 7) =       0.000434270702

      target function =                  N/A
              le_mean =     -17.216846942492
             les_mean =     296.744332546703
             stat err =       0.000431376940
             autocorr =       1.146859770970
              std dev =       0.569661362371
             le_variance =       0.324514067779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320680016554
                                         uncertainty =       0.003775741473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320680016554
                                         uncertainty =       0.003775741473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400394263
  error estimate for blocks of size 2^( 2) =       0.000409797265
  error estimate for blocks of size 2^( 3) =       0.000418386316
  error estimate for blocks of size 2^( 4) =       0.000424977940
  error estimate for blocks of size 2^( 5) =       0.000429529049
  error estimate for blocks of size 2^( 6) =       0.000430863924
  error estimate for blocks of size 2^( 7) =       0.000432264908

      target function =                  N/A
              le_mean =     -17.216848409805
             les_mean =     296.740500137390
             stat err =       0.000429408955
             autocorr =       1.150181830748
              std dev =       0.566242996868
             le_variance =       0.320631131502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216867447581        initial  <--
     1.5625e-02     1.5625e-01             2.9846e-02       -17.216842540495
     6.2500e-02     6.2500e-01             1.2704e-02       -17.216846942492
     2.5000e-01     2.5000e+00             4.4544e-03       -17.216848409805

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.6992
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.043864e-01 1 1  ON 0
 uu_1                 4.444509e-02 1 1  ON 1
 uu_2                -4.708465e-02 1 1  ON 2
 uu_3                -9.917069e-02 1 1  ON 3
 uu_4                -1.295850e-01 1 1  ON 4
 uu_5                -1.348804e-01 1 1  ON 5
 uu_6                -1.122144e-01 1 1  ON 6
 uu_7                -3.727017e-02 1 1  ON 7
 uu_8                 1.003708e-01 1 1  ON 8
 uu_9                 1.196282e-01 1 1  ON 9
 ud_0                 3.407468e-01 1 1  ON 10
 ud_1                 8.689310e-02 1 1  ON 11
 ud_2                -1.541507e-02 1 1  ON 12
 ud_3                -7.075634e-02 1 1  ON 13
 ud_4                -1.165548e-01 1 1  ON 14
 ud_5                -1.489418e-01 1 1  ON 15
 ud_6                -1.550106e-01 1 1  ON 16
 ud_7                -1.102542e-01 1 1  ON 17
 ud_8                 5.546620e-03 1 1  ON 18
 ud_9                 9.226104e-02 1 1  ON 19
 eO_0                -7.323904e-01 1 1  ON 20
 eO_1                -4.259798e-01 1 1  ON 21
 eO_2                -3.966465e-02 1 1  ON 22
 eO_3                 1.957833e-01 1 1  ON 23
 eO_4                 2.803817e-01 1 1  ON 24
 eO_5                 3.059142e-01 1 1  ON 25
 eO_6                 2.490495e-01 1 1  ON 26
 eO_7                 1.106730e-01 1 1  ON 27
 eO_8                 2.753606e-02 1 1  ON 28
 eO_9                 1.824134e-02 1 1  ON 29
eH1_0                -1.794893e-01 1 1  ON 30
eH1_1                -1.015129e-01 1 1  ON 31
eH1_2                -6.244736e-02 1 1  ON 32
eH1_3                -2.642238e-02 1 1  ON 33
eH1_4                 1.900511e-02 1 1  ON 34
eH1_5                 3.376710e-02 1 1  ON 35
eH1_6                 7.730584e-02 1 1  ON 36
eH1_7                 1.105860e-01 1 1  ON 37
eH1_8                 9.014030e-02 1 1  ON 38
eH1_9                 2.395899e-02 1 1  ON 39
eH2_0                -1.806936e-01 1 1  ON 40
eH2_1                -1.026443e-01 1 1  ON 41
eH2_2                -6.357154e-02 1 1  ON 42
eH2_3                -2.755693e-02 1 1  ON 43
eH2_4                 1.833709e-02 1 1  ON 44
eH2_5                 3.356718e-02 1 1  ON 45
eH2_6                 7.836030e-02 1 1  ON 46
eH2_7                 1.136354e-01 1 1  ON 47
eH2_8                 9.263945e-02 1 1  ON 48
eH2_9                 2.598080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3831e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1736
    reference variance = 0.224759
====================================================
  Execution time = 3.4717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1138e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311260280973
                                         uncertainty =       0.002453569133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311260280973
                                         uncertainty =       0.002453569133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394573629
  error estimate for blocks of size 2^( 2) =       0.000404302588
  error estimate for blocks of size 2^( 3) =       0.000413267441
  error estimate for blocks of size 2^( 4) =       0.000419571207
  error estimate for blocks of size 2^( 5) =       0.000423808568
  error estimate for blocks of size 2^( 6) =       0.000425068668
  error estimate for blocks of size 2^( 7) =       0.000426561232

      target function =                  N/A
              le_mean =     -17.216158605749
             les_mean =     296.707493680784
             stat err =       0.000423752419
             autocorr =       1.153368981185
              std dev =       0.558011378173
             le_variance =       0.311376698170


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721615860575e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216158605749       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216162851571       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216163947401       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216174201150       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216170094555       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216170932257       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216172776962       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216173449075       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216173940101       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216174477857       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216174329265       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216174210687       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 6.013728e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216158605749       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216160376782       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216161079740       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216162190569       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216163960297       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216162774596       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216162863732       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216163237778       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216163198812       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216163340087       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.837907e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216158605749       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216159137350       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216159413984       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216159453317       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216160049867       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216159852745       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216159698262       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216159785957       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216159796371       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 4.940902e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3924e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.049406e-01 1 1  ON 0
 uu_1                 4.471597e-02 1 1  ON 1
 uu_2                -4.713069e-02 1 1  ON 2
 uu_3                -9.926665e-02 1 1  ON 3
 uu_4                -1.299345e-01 1 1  ON 4
 uu_5                -1.350259e-01 1 1  ON 5
 uu_6                -1.122245e-01 1 1  ON 6
 uu_7                -3.748757e-02 1 1  ON 7
 uu_8                 1.002535e-01 1 1  ON 8
 uu_9                 1.196965e-01 1 1  ON 9
 ud_0                 3.413782e-01 1 1  ON 10
 ud_1                 8.725139e-02 1 1  ON 11
 ud_2                -1.535939e-02 1 1  ON 12
 ud_3                -7.106132e-02 1 1  ON 13
 ud_4                -1.169541e-01 1 1  ON 14
 ud_5                -1.492763e-01 1 1  ON 15
 ud_6                -1.548750e-01 1 1  ON 16
 ud_7                -1.102725e-01 1 1  ON 17
 ud_8                 5.342877e-03 1 1  ON 18
 ud_9                 9.225530e-02 1 1  ON 19
 eO_0                -7.342283e-01 1 1  ON 20
 eO_1                -4.269700e-01 1 1  ON 21
 eO_2                -3.959010e-02 1 1  ON 22
 eO_3                 1.969111e-01 1 1  ON 23
 eO_4                 2.814761e-01 1 1  ON 24
 eO_5                 3.060702e-01 1 1  ON 25
 eO_6                 2.491903e-01 1 1  ON 26
 eO_7                 1.108596e-01 1 1  ON 27
 eO_8                 2.756566e-02 1 1  ON 28
 eO_9                 1.825231e-02 1 1  ON 29
eH1_0                -1.796909e-01 1 1  ON 30
eH1_1                -1.017627e-01 1 1  ON 31
eH1_2                -6.248697e-02 1 1  ON 32
eH1_3                -2.639573e-02 1 1  ON 33
eH1_4                 1.907364e-02 1 1  ON 34
eH1_5                 3.402475e-02 1 1  ON 35
eH1_6                 7.734425e-02 1 1  ON 36
eH1_7                 1.105529e-01 1 1  ON 37
eH1_8                 9.023746e-02 1 1  ON 38
eH1_9                 2.398467e-02 1 1  ON 39
eH2_0                -1.809451e-01 1 1  ON 40
eH2_1                -1.028262e-01 1 1  ON 41
eH2_2                -6.355946e-02 1 1  ON 42
eH2_3                -2.754491e-02 1 1  ON 43
eH2_4                 1.831812e-02 1 1  ON 44
eH2_5                 3.369167e-02 1 1  ON 45
eH2_6                 7.847082e-02 1 1  ON 46
eH2_7                 1.136604e-01 1 1  ON 47
eH2_8                 9.276045e-02 1 1  ON 48
eH2_9                 2.601721e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1853
    reference variance = 0.20029
====================================================
  Execution time = 3.5572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2070e-01
  Total weights = 2.0000e+06
  Execution time = 3.1019e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320217750884
                                         uncertainty =       0.005145470885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320217750884
                                         uncertainty =       0.005145470885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400102173
  error estimate for blocks of size 2^( 2) =       0.000409789333
  error estimate for blocks of size 2^( 3) =       0.000418380218
  error estimate for blocks of size 2^( 4) =       0.000424936887
  error estimate for blocks of size 2^( 5) =       0.000428483513
  error estimate for blocks of size 2^( 6) =       0.000430047062
  error estimate for blocks of size 2^( 7) =       0.000432358986

      target function =                  N/A
              le_mean =     -17.215697940274
             les_mean =     296.700418909038
             stat err =       0.000428956612
             autocorr =       1.149436309895
              std dev =       0.565829920008
             le_variance =       0.320163498377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321650332330
                                         uncertainty =       0.005155323998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321650332330
                                         uncertainty =       0.005155323998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400996232
  error estimate for blocks of size 2^( 2) =       0.000410627285
  error estimate for blocks of size 2^( 3) =       0.000419154899
  error estimate for blocks of size 2^( 4) =       0.000425657974
  error estimate for blocks of size 2^( 5) =       0.000429167786
  error estimate for blocks of size 2^( 6) =       0.000430731670
  error estimate for blocks of size 2^( 7) =       0.000433034046

      target function =                  N/A
              le_mean =     -17.215684124146
             les_mean =     296.701375657615
             stat err =       0.000429647869
             autocorr =       1.148007541194
              std dev =       0.567094309661
             le_variance =       0.321595956050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321303831269
                                         uncertainty =       0.005156211115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321303831269
                                         uncertainty =       0.005156211115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400780184
  error estimate for blocks of size 2^( 2) =       0.000410426797
  error estimate for blocks of size 2^( 3) =       0.000418972732
  error estimate for blocks of size 2^( 4) =       0.000425492980
  error estimate for blocks of size 2^( 5) =       0.000429012220
  error estimate for blocks of size 2^( 6) =       0.000430574955
  error estimate for blocks of size 2^( 7) =       0.000432884241

      target function =                  N/A
              le_mean =     -17.215687598199
             les_mean =     296.701148830246
             stat err =       0.000429491099
             autocorr =       1.148407063874
              std dev =       0.566788772027
             le_variance =       0.321249512096

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320378793698
                                         uncertainty =       0.005147461419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320378793698
                                         uncertainty =       0.005147461419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400202780
  error estimate for blocks of size 2^( 2) =       0.000409883839
  error estimate for blocks of size 2^( 3) =       0.000418468016
  error estimate for blocks of size 2^( 4) =       0.000425019476
  error estimate for blocks of size 2^( 5) =       0.000428561985
  error estimate for blocks of size 2^( 6) =       0.000430125455
  error estimate for blocks of size 2^( 7) =       0.000432437444

      target function =                  N/A
              le_mean =     -17.215696170729
             les_mean =     296.700519013682
             stat err =       0.000429036090
             autocorr =       1.149284233557
              std dev =       0.565972199831
             le_variance =       0.320324530982


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215697940274        initial  <--
     1.5625e-01     1.5625e+00             6.0137e-03       -17.215684124146
     6.2500e-01     6.2500e+00             1.8379e-03       -17.215687598199
     2.5000e+00     2.5000e+01             4.9409e-04       -17.215696170729

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.2148
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.043864e-01 1 1  ON 0
 uu_1                 4.444509e-02 1 1  ON 1
 uu_2                -4.708465e-02 1 1  ON 2
 uu_3                -9.917069e-02 1 1  ON 3
 uu_4                -1.295850e-01 1 1  ON 4
 uu_5                -1.348804e-01 1 1  ON 5
 uu_6                -1.122144e-01 1 1  ON 6
 uu_7                -3.727017e-02 1 1  ON 7
 uu_8                 1.003708e-01 1 1  ON 8
 uu_9                 1.196282e-01 1 1  ON 9
 ud_0                 3.407468e-01 1 1  ON 10
 ud_1                 8.689310e-02 1 1  ON 11
 ud_2                -1.541507e-02 1 1  ON 12
 ud_3                -7.075634e-02 1 1  ON 13
 ud_4                -1.165548e-01 1 1  ON 14
 ud_5                -1.489418e-01 1 1  ON 15
 ud_6                -1.550106e-01 1 1  ON 16
 ud_7                -1.102542e-01 1 1  ON 17
 ud_8                 5.546620e-03 1 1  ON 18
 ud_9                 9.226104e-02 1 1  ON 19
 eO_0                -7.323904e-01 1 1  ON 20
 eO_1                -4.259798e-01 1 1  ON 21
 eO_2                -3.966465e-02 1 1  ON 22
 eO_3                 1.957833e-01 1 1  ON 23
 eO_4                 2.803817e-01 1 1  ON 24
 eO_5                 3.059142e-01 1 1  ON 25
 eO_6                 2.490495e-01 1 1  ON 26
 eO_7                 1.106730e-01 1 1  ON 27
 eO_8                 2.753606e-02 1 1  ON 28
 eO_9                 1.824134e-02 1 1  ON 29
eH1_0                -1.794893e-01 1 1  ON 30
eH1_1                -1.015129e-01 1 1  ON 31
eH1_2                -6.244736e-02 1 1  ON 32
eH1_3                -2.642238e-02 1 1  ON 33
eH1_4                 1.900511e-02 1 1  ON 34
eH1_5                 3.376710e-02 1 1  ON 35
eH1_6                 7.730584e-02 1 1  ON 36
eH1_7                 1.105860e-01 1 1  ON 37
eH1_8                 9.014030e-02 1 1  ON 38
eH1_9                 2.395899e-02 1 1  ON 39
eH2_0                -1.806936e-01 1 1  ON 40
eH2_1                -1.026443e-01 1 1  ON 41
eH2_2                -6.357154e-02 1 1  ON 42
eH2_3                -2.755693e-02 1 1  ON 43
eH2_4                 1.833709e-02 1 1  ON 44
eH2_5                 3.356718e-02 1 1  ON 45
eH2_6                 7.836030e-02 1 1  ON 46
eH2_7                 1.136354e-01 1 1  ON 47
eH2_8                 9.263945e-02 1 1  ON 48
eH2_9                 2.598080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.199819
====================================================
  Execution time = 3.4747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1352e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313554471937
                                         uncertainty =       0.004345785339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313554471937
                                         uncertainty =       0.004345785339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395926316
  error estimate for blocks of size 2^( 2) =       0.000405515072
  error estimate for blocks of size 2^( 3) =       0.000414228314
  error estimate for blocks of size 2^( 4) =       0.000420767670
  error estimate for blocks of size 2^( 5) =       0.000424869091
  error estimate for blocks of size 2^( 6) =       0.000425089597
  error estimate for blocks of size 2^( 7) =       0.000426953216

      target function =                  N/A
              le_mean =     -17.216357551542
             les_mean =     296.716482480979
             stat err =       0.000424419893
             autocorr =       1.149112969776
              std dev =       0.559924365612
             le_variance =       0.313515295206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721635755154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216357551542       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216358319011       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216359667312       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216361228393       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216361342411       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216361033382       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216361124131       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216360972928       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216361023396       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 7.971390e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216357551542       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216357757837       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216358146224       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216358565412       residual = 5.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216358615308       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216358519897       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216358536377       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216358506025       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.071784e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216357551542       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216357604104       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216357705078       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216357812045       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216357826535       residual = 4.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216357801767       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216357805225       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216357798203       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 5.235507e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350745 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4145e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.044216e-01 1 1  ON 0
 uu_1                 4.448434e-02 1 1  ON 1
 uu_2                -4.708582e-02 1 1  ON 2
 uu_3                -9.917312e-02 1 1  ON 3
 uu_4                -1.296231e-01 1 1  ON 4
 uu_5                -1.348953e-01 1 1  ON 5
 uu_6                -1.122122e-01 1 1  ON 6
 uu_7                -3.729226e-02 1 1  ON 7
 uu_8                 1.003576e-01 1 1  ON 8
 uu_9                 1.196353e-01 1 1  ON 9
 ud_0                 3.407862e-01 1 1  ON 10
 ud_1                 8.693773e-02 1 1  ON 11
 ud_2                -1.539826e-02 1 1  ON 12
 ud_3                -7.079438e-02 1 1  ON 13
 ud_4                -1.165728e-01 1 1  ON 14
 ud_5                -1.489706e-01 1 1  ON 15
 ud_6                -1.549938e-01 1 1  ON 16
 ud_7                -1.102706e-01 1 1  ON 17
 ud_8                 5.523711e-03 1 1  ON 18
 ud_9                 9.226078e-02 1 1  ON 19
 eO_0                -7.325976e-01 1 1  ON 20
 eO_1                -4.260722e-01 1 1  ON 21
 eO_2                -3.964689e-02 1 1  ON 22
 eO_3                 1.959203e-01 1 1  ON 23
 eO_4                 2.804798e-01 1 1  ON 24
 eO_5                 3.059273e-01 1 1  ON 25
 eO_6                 2.490639e-01 1 1  ON 26
 eO_7                 1.106900e-01 1 1  ON 27
 eO_8                 2.753759e-02 1 1  ON 28
 eO_9                 1.824176e-02 1 1  ON 29
eH1_0                -1.795081e-01 1 1  ON 30
eH1_1                -1.015213e-01 1 1  ON 31
eH1_2                -6.244496e-02 1 1  ON 32
eH1_3                -2.642920e-02 1 1  ON 33
eH1_4                 1.901341e-02 1 1  ON 34
eH1_5                 3.378645e-02 1 1  ON 35
eH1_6                 7.730127e-02 1 1  ON 36
eH1_7                 1.105790e-01 1 1  ON 37
eH1_8                 9.015128e-02 1 1  ON 38
eH1_9                 2.396255e-02 1 1  ON 39
eH2_0                -1.807201e-01 1 1  ON 40
eH2_1                -1.026568e-01 1 1  ON 41
eH2_2                -6.356033e-02 1 1  ON 42
eH2_3                -2.755461e-02 1 1  ON 43
eH2_4                 1.834349e-02 1 1  ON 44
eH2_5                 3.358383e-02 1 1  ON 45
eH2_6                 7.836054e-02 1 1  ON 46
eH2_7                 1.136282e-01 1 1  ON 47
eH2_8                 9.264672e-02 1 1  ON 48
eH2_9                 2.598283e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2613
    reference variance = 0.166822
====================================================
  Execution time = 3.4078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2493e-01
  Total weights = 2.0000e+06
  Execution time = 3.0954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324740541919
                                         uncertainty =       0.004763419190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324740541919
                                         uncertainty =       0.004763419190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403056891
  error estimate for blocks of size 2^( 2) =       0.000412805753
  error estimate for blocks of size 2^( 3) =       0.000421083325
  error estimate for blocks of size 2^( 4) =       0.000427798162
  error estimate for blocks of size 2^( 5) =       0.000432393141
  error estimate for blocks of size 2^( 6) =       0.000434274591
  error estimate for blocks of size 2^( 7) =       0.000435650658

      target function =                  N/A
              le_mean =     -17.216819273774
             les_mean =     296.743775458410
             stat err =       0.000432529138
             autocorr =       1.151590405864
              std dev =       0.570008521922
             le_variance =       0.324909715063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324838961111
                                         uncertainty =       0.004764868568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324838961111
                                         uncertainty =       0.004764868568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403118187
  error estimate for blocks of size 2^( 2) =       0.000412861301
  error estimate for blocks of size 2^( 3) =       0.000421131026
  error estimate for blocks of size 2^( 4) =       0.000427843104
  error estimate for blocks of size 2^( 5) =       0.000432434416
  error estimate for blocks of size 2^( 6) =       0.000434316099
  error estimate for blocks of size 2^( 7) =       0.000435699293

      target function =                  N/A
              le_mean =     -17.216818862213
             les_mean =     296.743860117501
             stat err =       0.000432573228
             autocorr =       1.151474937384
              std dev =       0.570095207631
             le_variance =       0.325008545764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324785364450
                                         uncertainty =       0.004764043807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324785364450
                                         uncertainty =       0.004764043807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403084835
  error estimate for blocks of size 2^( 2) =       0.000412830822
  error estimate for blocks of size 2^( 3) =       0.000421104357
  error estimate for blocks of size 2^( 4) =       0.000427818006
  error estimate for blocks of size 2^( 5) =       0.000432411138
  error estimate for blocks of size 2^( 6) =       0.000434292867
  error estimate for blocks of size 2^( 7) =       0.000435673001

      target function =                  N/A
              le_mean =     -17.216819033017
             les_mean =     296.743812221017
             stat err =       0.000432548753
             autocorr =       1.151535181566
              std dev =       0.570048039951
             le_variance =       0.324954767851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324745847511
                                         uncertainty =       0.004763491315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324745847511
                                         uncertainty =       0.004763491315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403060200
  error estimate for blocks of size 2^( 2) =       0.000412808706
  error estimate for blocks of size 2^( 3) =       0.000421085769
  error estimate for blocks of size 2^( 4) =       0.000427800468
  error estimate for blocks of size 2^( 5) =       0.000432395216
  error estimate for blocks of size 2^( 6) =       0.000434276709
  error estimate for blocks of size 2^( 7) =       0.000435653308

      target function =                  N/A
              le_mean =     -17.216819239301
             les_mean =     296.743779606603
             stat err =       0.000432531425
             autocorr =       1.151583673755
              std dev =       0.570013201851
             le_variance =       0.324915050285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216819273774        initial  <--
     1.5625e+00     1.5625e+01             7.9714e-04       -17.216818862213
     6.2500e+00     6.2500e+01             2.0718e-04       -17.216819033017
     2.5000e+01     2.5000e+02             5.2355e-05       -17.216819239301

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.6935
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.043864e-01 1 1  ON 0
 uu_1                 4.444509e-02 1 1  ON 1
 uu_2                -4.708465e-02 1 1  ON 2
 uu_3                -9.917069e-02 1 1  ON 3
 uu_4                -1.295850e-01 1 1  ON 4
 uu_5                -1.348804e-01 1 1  ON 5
 uu_6                -1.122144e-01 1 1  ON 6
 uu_7                -3.727017e-02 1 1  ON 7
 uu_8                 1.003708e-01 1 1  ON 8
 uu_9                 1.196282e-01 1 1  ON 9
 ud_0                 3.407468e-01 1 1  ON 10
 ud_1                 8.689310e-02 1 1  ON 11
 ud_2                -1.541507e-02 1 1  ON 12
 ud_3                -7.075634e-02 1 1  ON 13
 ud_4                -1.165548e-01 1 1  ON 14
 ud_5                -1.489418e-01 1 1  ON 15
 ud_6                -1.550106e-01 1 1  ON 16
 ud_7                -1.102542e-01 1 1  ON 17
 ud_8                 5.546620e-03 1 1  ON 18
 ud_9                 9.226104e-02 1 1  ON 19
 eO_0                -7.323904e-01 1 1  ON 20
 eO_1                -4.259798e-01 1 1  ON 21
 eO_2                -3.966465e-02 1 1  ON 22
 eO_3                 1.957833e-01 1 1  ON 23
 eO_4                 2.803817e-01 1 1  ON 24
 eO_5                 3.059142e-01 1 1  ON 25
 eO_6                 2.490495e-01 1 1  ON 26
 eO_7                 1.106730e-01 1 1  ON 27
 eO_8                 2.753606e-02 1 1  ON 28
 eO_9                 1.824134e-02 1 1  ON 29
eH1_0                -1.794893e-01 1 1  ON 30
eH1_1                -1.015129e-01 1 1  ON 31
eH1_2                -6.244736e-02 1 1  ON 32
eH1_3                -2.642238e-02 1 1  ON 33
eH1_4                 1.900511e-02 1 1  ON 34
eH1_5                 3.376710e-02 1 1  ON 35
eH1_6                 7.730584e-02 1 1  ON 36
eH1_7                 1.105860e-01 1 1  ON 37
eH1_8                 9.014030e-02 1 1  ON 38
eH1_9                 2.395899e-02 1 1  ON 39
eH2_0                -1.806936e-01 1 1  ON 40
eH2_1                -1.026443e-01 1 1  ON 41
eH2_2                -6.357154e-02 1 1  ON 42
eH2_3                -2.755693e-02 1 1  ON 43
eH2_4                 1.833709e-02 1 1  ON 44
eH2_5                 3.356718e-02 1 1  ON 45
eH2_6                 7.836030e-02 1 1  ON 46
eH2_7                 1.136354e-01 1 1  ON 47
eH2_8                 9.263945e-02 1 1  ON 48
eH2_9                 2.598080e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3844e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1442
    reference variance = 0.200469
====================================================
  Execution time = 3.4715e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1454e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314503269603
                                         uncertainty =       0.003020615565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314503269603
                                         uncertainty =       0.003020615565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396575144
  error estimate for blocks of size 2^( 2) =       0.000406257527
  error estimate for blocks of size 2^( 3) =       0.000415003686
  error estimate for blocks of size 2^( 4) =       0.000421530914
  error estimate for blocks of size 2^( 5) =       0.000426280298
  error estimate for blocks of size 2^( 6) =       0.000428059245
  error estimate for blocks of size 2^( 7) =       0.000428950528

      target function =                  N/A
              le_mean =     -17.216035247941
             les_mean =     296.706413190150
             stat err =       0.000426205246
             autocorr =       1.155012280792
              std dev =       0.560841946615
             le_variance =       0.314543689083


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721603524794e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216035247941       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216035304738       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216035512148       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216035490301       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216035519222       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216035609471       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216035590966       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216035596577       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 8.339109e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216035247941       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216035262245       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216035314634       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216035308921       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216035315864       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216035338345       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216035333729       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216035335069       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 2.092220e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216035247941       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216035251524       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216035264655       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216035263210       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216035264928       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216035270543       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216035269389       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216035269720       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 5.235232e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4007e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.043917e-01 1 1  ON 0
 uu_1                 4.444911e-02 1 1  ON 1
 uu_2                -4.708497e-02 1 1  ON 2
 uu_3                -9.917066e-02 1 1  ON 3
 uu_4                -1.295898e-01 1 1  ON 4
 uu_5                -1.348817e-01 1 1  ON 5
 uu_6                -1.122164e-01 1 1  ON 6
 uu_7                -3.727211e-02 1 1  ON 7
 uu_8                 1.003698e-01 1 1  ON 8
 uu_9                 1.196292e-01 1 1  ON 9
 ud_0                 3.407541e-01 1 1  ON 10
 ud_1                 8.689566e-02 1 1  ON 11
 ud_2                -1.541447e-02 1 1  ON 12
 ud_3                -7.076046e-02 1 1  ON 13
 ud_4                -1.165579e-01 1 1  ON 14
 ud_5                -1.489450e-01 1 1  ON 15
 ud_6                -1.550088e-01 1 1  ON 16
 ud_7                -1.102546e-01 1 1  ON 17
 ud_8                 5.544462e-03 1 1  ON 18
 ud_9                 9.226100e-02 1 1  ON 19
 eO_0                -7.324113e-01 1 1  ON 20
 eO_1                -4.259894e-01 1 1  ON 21
 eO_2                -3.966221e-02 1 1  ON 22
 eO_3                 1.957967e-01 1 1  ON 23
 eO_4                 2.803926e-01 1 1  ON 24
 eO_5                 3.059150e-01 1 1  ON 25
 eO_6                 2.490503e-01 1 1  ON 26
 eO_7                 1.106748e-01 1 1  ON 27
 eO_8                 2.753629e-02 1 1  ON 28
 eO_9                 1.824144e-02 1 1  ON 29
eH1_0                -1.794925e-01 1 1  ON 30
eH1_1                -1.015146e-01 1 1  ON 31
eH1_2                -6.244670e-02 1 1  ON 32
eH1_3                -2.642377e-02 1 1  ON 33
eH1_4                 1.900659e-02 1 1  ON 34
eH1_5                 3.376940e-02 1 1  ON 35
eH1_6                 7.730604e-02 1 1  ON 36
eH1_7                 1.105860e-01 1 1  ON 37
eH1_8                 9.014148e-02 1 1  ON 38
eH1_9                 2.395936e-02 1 1  ON 39
eH2_0                -1.806967e-01 1 1  ON 40
eH2_1                -1.026436e-01 1 1  ON 41
eH2_2                -6.357054e-02 1 1  ON 42
eH2_3                -2.755754e-02 1 1  ON 43
eH2_4                 1.833643e-02 1 1  ON 44
eH2_5                 3.356883e-02 1 1  ON 45
eH2_6                 7.836040e-02 1 1  ON 46
eH2_7                 1.136351e-01 1 1  ON 47
eH2_8                 9.264041e-02 1 1  ON 48
eH2_9                 2.598103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.142063
====================================================
  Execution time = 3.4503e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1346e-01
  Total weights = 2.0000e+06
  Execution time = 3.0843e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313508452955
                                         uncertainty =       0.002650237261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313508452955
                                         uncertainty =       0.002650237261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395887888
  error estimate for blocks of size 2^( 2) =       0.000405972998
  error estimate for blocks of size 2^( 3) =       0.000414647952
  error estimate for blocks of size 2^( 4) =       0.000422172532
  error estimate for blocks of size 2^( 5) =       0.000425926953
  error estimate for blocks of size 2^( 6) =       0.000427934950
  error estimate for blocks of size 2^( 7) =       0.000431315339

      target function =                  N/A
              le_mean =     -17.216224006894
             les_mean =     296.711823339022
             stat err =       0.000426837443
             autocorr =       1.162466882307
              std dev =       0.559870020798
             le_variance =       0.313454440189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313533055539
                                         uncertainty =       0.002650490113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313533055539
                                         uncertainty =       0.002650490113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395903420
  error estimate for blocks of size 2^( 2) =       0.000405987437
  error estimate for blocks of size 2^( 3) =       0.000414661298
  error estimate for blocks of size 2^( 4) =       0.000422185158
  error estimate for blocks of size 2^( 5) =       0.000425939536
  error estimate for blocks of size 2^( 6) =       0.000427947387
  error estimate for blocks of size 2^( 7) =       0.000431327023

      target function =                  N/A
              le_mean =     -17.216224018254
             les_mean =     296.711848325845
             stat err =       0.000426849776
             autocorr =       1.162442845709
              std dev =       0.559891985897
             le_variance =       0.313479035872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313520880080
                                         uncertainty =       0.002650364987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313520880080
                                         uncertainty =       0.002650364987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395895734
  error estimate for blocks of size 2^( 2) =       0.000405980293
  error estimate for blocks of size 2^( 3) =       0.000414654695
  error estimate for blocks of size 2^( 4) =       0.000422178913
  error estimate for blocks of size 2^( 5) =       0.000425933315
  error estimate for blocks of size 2^( 6) =       0.000427941236
  error estimate for blocks of size 2^( 7) =       0.000431321244

      target function =                  N/A
              le_mean =     -17.216224011884
             les_mean =     296.711835934464
             stat err =       0.000426843677
             autocorr =       1.162454764008
              std dev =       0.559881115801
             le_variance =       0.313466863830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313510010074
                                         uncertainty =       0.002650253267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313510010074
                                         uncertainty =       0.002650253267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395888871
  error estimate for blocks of size 2^( 2) =       0.000405973912
  error estimate for blocks of size 2^( 3) =       0.000414648797
  error estimate for blocks of size 2^( 4) =       0.000422173331
  error estimate for blocks of size 2^( 5) =       0.000425927750
  error estimate for blocks of size 2^( 6) =       0.000427935737
  error estimate for blocks of size 2^( 7) =       0.000431316079

      target function =                  N/A
              le_mean =     -17.216224007456
             les_mean =     296.711824915052
             stat err =       0.000426838224
             autocorr =       1.162465364152
              std dev =       0.559871411014
             le_variance =       0.313455996871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216224006894        initial
     1.5625e+01     1.5625e+02             8.3391e-05       -17.216224018254  <--
     6.2500e+01     6.2500e+02             2.0922e-05       -17.216224011884
     2.5000e+02     2.5000e+03             5.2352e-06       -17.216224007456

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 5.0043e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.044077e-01 1 1  ON 0
 uu_1                 4.446102e-02 1 1  ON 1
 uu_2                -4.708576e-02 1 1  ON 2
 uu_3                -9.917070e-02 1 1  ON 3
 uu_4                -1.296041e-01 1 1  ON 4
 uu_5                -1.348857e-01 1 1  ON 5
 uu_6                -1.122223e-01 1 1  ON 6
 uu_7                -3.727789e-02 1 1  ON 7
 uu_8                 1.003666e-01 1 1  ON 8
 uu_9                 1.196322e-01 1 1  ON 9
 ud_0                 3.407759e-01 1 1  ON 10
 ud_1                 8.690342e-02 1 1  ON 11
 ud_2                -1.541272e-02 1 1  ON 12
 ud_3                -7.077258e-02 1 1  ON 13
 ud_4                -1.165673e-01 1 1  ON 14
 ud_5                -1.489548e-01 1 1  ON 15
 ud_6                -1.550034e-01 1 1  ON 16
 ud_7                -1.102557e-01 1 1  ON 17
 ud_8                 5.538001e-03 1 1  ON 18
 ud_9                 9.226089e-02 1 1  ON 19
 eO_0                -7.324738e-01 1 1  ON 20
 eO_1                -4.260182e-01 1 1  ON 21
 eO_2                -3.965504e-02 1 1  ON 22
 eO_3                 1.958365e-01 1 1  ON 23
 eO_4                 2.804253e-01 1 1  ON 24
 eO_5                 3.059174e-01 1 1  ON 25
 eO_6                 2.490529e-01 1 1  ON 26
 eO_7                 1.106802e-01 1 1  ON 27
 eO_8                 2.753698e-02 1 1  ON 28
 eO_9                 1.824174e-02 1 1  ON 29
eH1_0                -1.795021e-01 1 1  ON 30
eH1_1                -1.015196e-01 1 1  ON 31
eH1_2                -6.244475e-02 1 1  ON 32
eH1_3                -2.642781e-02 1 1  ON 33
eH1_4                 1.901095e-02 1 1  ON 34
eH1_5                 3.377632e-02 1 1  ON 35
eH1_6                 7.730668e-02 1 1  ON 36
eH1_7                 1.105859e-01 1 1  ON 37
eH1_8                 9.014501e-02 1 1  ON 38
eH1_9                 2.396049e-02 1 1  ON 39
eH2_0                -1.807061e-01 1 1  ON 40
eH2_1                -1.026417e-01 1 1  ON 41
eH2_2                -6.356754e-02 1 1  ON 42
eH2_3                -2.755933e-02 1 1  ON 43
eH2_4                 1.833442e-02 1 1  ON 44
eH2_5                 3.357376e-02 1 1  ON 45
eH2_6                 7.836069e-02 1 1  ON 46
eH2_7                 1.136341e-01 1 1  ON 47
eH2_8                 9.264327e-02 1 1  ON 48
eH2_9                 2.598171e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4056e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2639
    reference variance = 0.340064
====================================================
  Execution time = 3.5310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1413e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314179871208
                                         uncertainty =       0.003788443789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314179871208
                                         uncertainty =       0.003788443789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396312616
  error estimate for blocks of size 2^( 2) =       0.000406202278
  error estimate for blocks of size 2^( 3) =       0.000414425157
  error estimate for blocks of size 2^( 4) =       0.000420884346
  error estimate for blocks of size 2^( 5) =       0.000423959036
  error estimate for blocks of size 2^( 6) =       0.000427082961
  error estimate for blocks of size 2^( 7) =       0.000428401923

      target function =                  N/A
              le_mean =     -17.216902199941
             les_mean =     296.735848584047
             stat err =       0.000425082066
             autocorr =       1.150455359288
              std dev =       0.560470676117
             le_variance =       0.314127378787


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721690219994e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216902199941       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216902336333       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216902878773       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216902785407       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216903073724       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216903220358       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216903167314       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216903157227       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.489426e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216902199941       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216902235008       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216902375533       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216902341217       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216902414454       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216902453668       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216902441211       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216902437299       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 8.893547e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216902199941       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216902208770       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216902244228       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216902234909       residual = 4.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216902253242       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216902263206       residual = 9.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216902260170       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216902259122       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 2.234586e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4661e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.044250e-01 1 1  ON 0
 uu_1                 4.447456e-02 1 1  ON 1
 uu_2                -4.708915e-02 1 1  ON 2
 uu_3                -9.917024e-02 1 1  ON 3
 uu_4                -1.296249e-01 1 1  ON 4
 uu_5                -1.348875e-01 1 1  ON 5
 uu_6                -1.122272e-01 1 1  ON 6
 uu_7                -3.728742e-02 1 1  ON 7
 uu_8                 1.003646e-01 1 1  ON 8
 uu_9                 1.196372e-01 1 1  ON 9
 ud_0                 3.407986e-01 1 1  ON 10
 ud_1                 8.691751e-02 1 1  ON 11
 ud_2                -1.540651e-02 1 1  ON 12
 ud_3                -7.078766e-02 1 1  ON 13
 ud_4                -1.165805e-01 1 1  ON 14
 ud_5                -1.489716e-01 1 1  ON 15
 ud_6                -1.549982e-01 1 1  ON 16
 ud_7                -1.102589e-01 1 1  ON 17
 ud_8                 5.530682e-03 1 1  ON 18
 ud_9                 9.226253e-02 1 1  ON 19
 eO_0                -7.325627e-01 1 1  ON 20
 eO_1                -4.260492e-01 1 1  ON 21
 eO_2                -3.965086e-02 1 1  ON 22
 eO_3                 1.958883e-01 1 1  ON 23
 eO_4                 2.804686e-01 1 1  ON 24
 eO_5                 3.059214e-01 1 1  ON 25
 eO_6                 2.490579e-01 1 1  ON 26
 eO_7                 1.106882e-01 1 1  ON 27
 eO_8                 2.753881e-02 1 1  ON 28
 eO_9                 1.824261e-02 1 1  ON 29
eH1_0                -1.795120e-01 1 1  ON 30
eH1_1                -1.015245e-01 1 1  ON 31
eH1_2                -6.244681e-02 1 1  ON 32
eH1_3                -2.642808e-02 1 1  ON 33
eH1_4                 1.901916e-02 1 1  ON 34
eH1_5                 3.377886e-02 1 1  ON 35
eH1_6                 7.730550e-02 1 1  ON 36
eH1_7                 1.105855e-01 1 1  ON 37
eH1_8                 9.015031e-02 1 1  ON 38
eH1_9                 2.396205e-02 1 1  ON 39
eH2_0                -1.807161e-01 1 1  ON 40
eH2_1                -1.026506e-01 1 1  ON 41
eH2_2                -6.356772e-02 1 1  ON 42
eH2_3                -2.755809e-02 1 1  ON 43
eH2_4                 1.833652e-02 1 1  ON 44
eH2_5                 3.358457e-02 1 1  ON 45
eH2_6                 7.835998e-02 1 1  ON 46
eH2_7                 1.136320e-01 1 1  ON 47
eH2_8                 9.264875e-02 1 1  ON 48
eH2_9                 2.598356e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2194
    reference variance = 0.25903
====================================================
  Execution time = 3.5679e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2676e-01
  Total weights = 2.0000e+06
  Execution time = 3.0979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326866958652
                                         uncertainty =       0.011475488176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326866958652
                                         uncertainty =       0.011475488176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404194033
  error estimate for blocks of size 2^( 2) =       0.000413519269
  error estimate for blocks of size 2^( 3) =       0.000421945869
  error estimate for blocks of size 2^( 4) =       0.000427879043
  error estimate for blocks of size 2^( 5) =       0.000432053700
  error estimate for blocks of size 2^( 6) =       0.000434568335
  error estimate for blocks of size 2^( 7) =       0.000438835723

      target function =                  N/A
              le_mean =     -17.215794610148
             les_mean =     296.710329527915
             stat err =       0.000433334200
             autocorr =       1.149386619082
              std dev =       0.571616683192
             le_variance =       0.326745632503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326939566938
                                         uncertainty =       0.011476239882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326939566938
                                         uncertainty =       0.011476239882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404238928
  error estimate for blocks of size 2^( 2) =       0.000413561504
  error estimate for blocks of size 2^( 3) =       0.000421984236
  error estimate for blocks of size 2^( 4) =       0.000427915995
  error estimate for blocks of size 2^( 5) =       0.000432088721
  error estimate for blocks of size 2^( 6) =       0.000434603975
  error estimate for blocks of size 2^( 7) =       0.000438870573

      target function =                  N/A
              le_mean =     -17.215794477734
             les_mean =     296.710397557632
             stat err =       0.000433369816
             autocorr =       1.149320233194
              std dev =       0.571680174103
             le_variance =       0.326818221463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326903792271
                                         uncertainty =       0.011475863304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326903792271
                                         uncertainty =       0.011475863304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404216809
  error estimate for blocks of size 2^( 2) =       0.000413540712
  error estimate for blocks of size 2^( 3) =       0.000421965344
  error estimate for blocks of size 2^( 4) =       0.000427897830
  error estimate for blocks of size 2^( 5) =       0.000432071497
  error estimate for blocks of size 2^( 6) =       0.000434586496
  error estimate for blocks of size 2^( 7) =       0.000438853564

      target function =                  N/A
              le_mean =     -17.215794527890
             les_mean =     296.710363519781
             stat err =       0.000433352347
             autocorr =       1.149353356066
              std dev =       0.571648892797
             le_variance =       0.326782456637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326871573844
                                         uncertainty =       0.011475535036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326871573844
                                         uncertainty =       0.011475535036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404196887
  error estimate for blocks of size 2^( 2) =       0.000413521956
  error estimate for blocks of size 2^( 3) =       0.000421948308
  error estimate for blocks of size 2^( 4) =       0.000427881397
  error estimate for blocks of size 2^( 5) =       0.000432055929
  error estimate for blocks of size 2^( 6) =       0.000434570612
  error estimate for blocks of size 2^( 7) =       0.000438837963

      target function =                  N/A
              le_mean =     -17.215794598634
             les_mean =     296.710333745503
             stat err =       0.000433336475
             autocorr =       1.149382458971
              std dev =       0.571620719111
             le_variance =       0.326750246517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215794610148        initial  <--
     3.9062e+00     3.9062e+01             3.4894e-04       -17.215794477734
     1.5625e+01     1.5625e+02             8.8935e-05       -17.215794527890
     6.2500e+01     6.2500e+02             2.2346e-05       -17.215794598634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.3029
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.044077e-01 1 1  ON 0
 uu_1                 4.446102e-02 1 1  ON 1
 uu_2                -4.708576e-02 1 1  ON 2
 uu_3                -9.917070e-02 1 1  ON 3
 uu_4                -1.296041e-01 1 1  ON 4
 uu_5                -1.348857e-01 1 1  ON 5
 uu_6                -1.122223e-01 1 1  ON 6
 uu_7                -3.727789e-02 1 1  ON 7
 uu_8                 1.003666e-01 1 1  ON 8
 uu_9                 1.196322e-01 1 1  ON 9
 ud_0                 3.407759e-01 1 1  ON 10
 ud_1                 8.690342e-02 1 1  ON 11
 ud_2                -1.541272e-02 1 1  ON 12
 ud_3                -7.077258e-02 1 1  ON 13
 ud_4                -1.165673e-01 1 1  ON 14
 ud_5                -1.489548e-01 1 1  ON 15
 ud_6                -1.550034e-01 1 1  ON 16
 ud_7                -1.102557e-01 1 1  ON 17
 ud_8                 5.538001e-03 1 1  ON 18
 ud_9                 9.226089e-02 1 1  ON 19
 eO_0                -7.324738e-01 1 1  ON 20
 eO_1                -4.260182e-01 1 1  ON 21
 eO_2                -3.965504e-02 1 1  ON 22
 eO_3                 1.958365e-01 1 1  ON 23
 eO_4                 2.804253e-01 1 1  ON 24
 eO_5                 3.059174e-01 1 1  ON 25
 eO_6                 2.490529e-01 1 1  ON 26
 eO_7                 1.106802e-01 1 1  ON 27
 eO_8                 2.753698e-02 1 1  ON 28
 eO_9                 1.824174e-02 1 1  ON 29
eH1_0                -1.795021e-01 1 1  ON 30
eH1_1                -1.015196e-01 1 1  ON 31
eH1_2                -6.244475e-02 1 1  ON 32
eH1_3                -2.642781e-02 1 1  ON 33
eH1_4                 1.901095e-02 1 1  ON 34
eH1_5                 3.377632e-02 1 1  ON 35
eH1_6                 7.730668e-02 1 1  ON 36
eH1_7                 1.105859e-01 1 1  ON 37
eH1_8                 9.014501e-02 1 1  ON 38
eH1_9                 2.396049e-02 1 1  ON 39
eH2_0                -1.807061e-01 1 1  ON 40
eH2_1                -1.026417e-01 1 1  ON 41
eH2_2                -6.356754e-02 1 1  ON 42
eH2_3                -2.755933e-02 1 1  ON 43
eH2_4                 1.833442e-02 1 1  ON 44
eH2_5                 3.357376e-02 1 1  ON 45
eH2_6                 7.836069e-02 1 1  ON 46
eH2_7                 1.136341e-01 1 1  ON 47
eH2_8                 9.264327e-02 1 1  ON 48
eH2_9                 2.598171e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1541
    reference variance = 0.386614
====================================================
  Execution time = 3.4969e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2664e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326483795350
                                         uncertainty =       0.011430122855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326483795350
                                         uncertainty =       0.011430122855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404130666
  error estimate for blocks of size 2^( 2) =       0.000413623611
  error estimate for blocks of size 2^( 3) =       0.000422111160
  error estimate for blocks of size 2^( 4) =       0.000428591996
  error estimate for blocks of size 2^( 5) =       0.000432373437
  error estimate for blocks of size 2^( 6) =       0.000434943012
  error estimate for blocks of size 2^( 7) =       0.000436045959

      target function =                  N/A
              le_mean =     -17.216388685092
             les_mean =     296.730682383005
             stat err =       0.000432988601
             autocorr =       1.147913896225
              std dev =       0.571527068610
             le_variance =       0.326643190154


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638868509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216388685092       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216388690924       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216388804922       residual = 9.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216388862781       residual = 7.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216388860779       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216388847253       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216388851609       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216388846888       residual = 4.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.434547e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216388685092       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216388686555       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216388715250       residual = 9.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216388729773       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216388729341       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216388725934       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216388726993       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216388725812       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 8.600956e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216388685092       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216388685458       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216388692644       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216388696279       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216388696175       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216388695322       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216388695585       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216388695289       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.151155e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4182e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.044101e-01 1 1  ON 0
 uu_1                 4.446250e-02 1 1  ON 1
 uu_2                -4.708650e-02 1 1  ON 2
 uu_3                -9.917045e-02 1 1  ON 3
 uu_4                -1.296064e-01 1 1  ON 4
 uu_5                -1.348864e-01 1 1  ON 5
 uu_6                -1.122224e-01 1 1  ON 6
 uu_7                -3.727879e-02 1 1  ON 7
 uu_8                 1.003661e-01 1 1  ON 8
 uu_9                 1.196325e-01 1 1  ON 9
 ud_0                 3.407788e-01 1 1  ON 10
 ud_1                 8.690418e-02 1 1  ON 11
 ud_2                -1.541250e-02 1 1  ON 12
 ud_3                -7.077450e-02 1 1  ON 13
 ud_4                -1.165687e-01 1 1  ON 14
 ud_5                -1.489558e-01 1 1  ON 15
 ud_6                -1.550025e-01 1 1  ON 16
 ud_7                -1.102558e-01 1 1  ON 17
 ud_8                 5.537054e-03 1 1  ON 18
 ud_9                 9.226093e-02 1 1  ON 19
 eO_0                -7.324824e-01 1 1  ON 20
 eO_1                -4.260217e-01 1 1  ON 21
 eO_2                -3.965431e-02 1 1  ON 22
 eO_3                 1.958415e-01 1 1  ON 23
 eO_4                 2.804293e-01 1 1  ON 24
 eO_5                 3.059181e-01 1 1  ON 25
 eO_6                 2.490535e-01 1 1  ON 26
 eO_7                 1.106809e-01 1 1  ON 27
 eO_8                 2.753712e-02 1 1  ON 28
 eO_9                 1.824181e-02 1 1  ON 29
eH1_0                -1.795032e-01 1 1  ON 30
eH1_1                -1.015197e-01 1 1  ON 31
eH1_2                -6.244431e-02 1 1  ON 32
eH1_3                -2.642787e-02 1 1  ON 33
eH1_4                 1.901123e-02 1 1  ON 34
eH1_5                 3.377680e-02 1 1  ON 35
eH1_6                 7.730657e-02 1 1  ON 36
eH1_7                 1.105857e-01 1 1  ON 37
eH1_8                 9.014530e-02 1 1  ON 38
eH1_9                 2.396058e-02 1 1  ON 39
eH2_0                -1.807072e-01 1 1  ON 40
eH2_1                -1.026419e-01 1 1  ON 41
eH2_2                -6.356723e-02 1 1  ON 42
eH2_3                -2.755914e-02 1 1  ON 43
eH2_4                 1.833460e-02 1 1  ON 44
eH2_5                 3.357411e-02 1 1  ON 45
eH2_6                 7.836032e-02 1 1  ON 46
eH2_7                 1.136339e-01 1 1  ON 47
eH2_8                 9.264377e-02 1 1  ON 48
eH2_9                 2.598191e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1613
    reference variance = 0.23595
====================================================
  Execution time = 3.3871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1766e-01
  Total weights = 2.0000e+06
  Execution time = 3.0871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317720717937
                                         uncertainty =       0.003476955509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317720717937
                                         uncertainty =       0.003476955509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398532703
  error estimate for blocks of size 2^( 2) =       0.000408079263
  error estimate for blocks of size 2^( 3) =       0.000416531198
  error estimate for blocks of size 2^( 4) =       0.000422505205
  error estimate for blocks of size 2^( 5) =       0.000427632254
  error estimate for blocks of size 2^( 6) =       0.000429018482
  error estimate for blocks of size 2^( 7) =       0.000429962131

      target function =                  N/A
              le_mean =     -17.216568944238
             les_mean =     296.727902683067
             stat err =       0.000427279518
             autocorr =       1.149466242410
              std dev =       0.563610353153
             le_variance =       0.317656630182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317731885808
                                         uncertainty =       0.003477084088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317731885808
                                         uncertainty =       0.003477084088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398539709
  error estimate for blocks of size 2^( 2) =       0.000408085829
  error estimate for blocks of size 2^( 3) =       0.000416537389
  error estimate for blocks of size 2^( 4) =       0.000422511088
  error estimate for blocks of size 2^( 5) =       0.000427638039
  error estimate for blocks of size 2^( 6) =       0.000429024324
  error estimate for blocks of size 2^( 7) =       0.000429968197

      target function =                  N/A
              le_mean =     -17.216569028521
             les_mean =     296.727916754122
             stat err =       0.000427285412
             autocorr =       1.149457537977
              std dev =       0.563620261471
             le_variance =       0.317667799141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317726329474
                                         uncertainty =       0.003477020229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317726329474
                                         uncertainty =       0.003477020229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398536223
  error estimate for blocks of size 2^( 2) =       0.000408082562
  error estimate for blocks of size 2^( 3) =       0.000416534309
  error estimate for blocks of size 2^( 4) =       0.000422508161
  error estimate for blocks of size 2^( 5) =       0.000427635162
  error estimate for blocks of size 2^( 6) =       0.000429021418
  error estimate for blocks of size 2^( 7) =       0.000429965180

      target function =                  N/A
              le_mean =     -17.216568986716
             les_mean =     296.727909757801
             stat err =       0.000427282480
             autocorr =       1.149461872105
              std dev =       0.563615331848
             le_variance =       0.317662242294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317721420183
                                         uncertainty =       0.003476963612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317721420183
                                         uncertainty =       0.003476963612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398533143
  error estimate for blocks of size 2^( 2) =       0.000408079676
  error estimate for blocks of size 2^( 3) =       0.000416531587
  error estimate for blocks of size 2^( 4) =       0.000422505575
  error estimate for blocks of size 2^( 5) =       0.000427632618
  error estimate for blocks of size 2^( 6) =       0.000429018849
  error estimate for blocks of size 2^( 7) =       0.000429962513

      target function =                  N/A
              le_mean =     -17.216568949551
             les_mean =     296.727903568314
             stat err =       0.000427279889
             autocorr =       1.149465695543
              std dev =       0.563610976206
             le_variance =       0.317657332500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216568944238        initial
     3.9062e+01     3.9062e+02             3.4345e-05       -17.216569028521  <--
     1.5625e+02     1.5625e+03             8.6010e-06       -17.216568986716
     6.2500e+02     6.2500e+03             2.1512e-06       -17.216568949551

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 4.9438e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.044173e-01 1 1  ON 0
 uu_1                 4.446692e-02 1 1  ON 1
 uu_2                -4.708869e-02 1 1  ON 2
 uu_3                -9.916974e-02 1 1  ON 3
 uu_4                -1.296130e-01 1 1  ON 4
 uu_5                -1.348883e-01 1 1  ON 5
 uu_6                -1.122228e-01 1 1  ON 6
 uu_7                -3.728148e-02 1 1  ON 7
 uu_8                 1.003646e-01 1 1  ON 8
 uu_9                 1.196335e-01 1 1  ON 9
 ud_0                 3.407873e-01 1 1  ON 10
 ud_1                 8.690647e-02 1 1  ON 11
 ud_2                -1.541187e-02 1 1  ON 12
 ud_3                -7.078020e-02 1 1  ON 13
 ud_4                -1.165728e-01 1 1  ON 14
 ud_5                -1.489588e-01 1 1  ON 15
 ud_6                -1.549996e-01 1 1  ON 16
 ud_7                -1.102564e-01 1 1  ON 17
 ud_8                 5.534213e-03 1 1  ON 18
 ud_9                 9.226108e-02 1 1  ON 19
 eO_0                -7.325081e-01 1 1  ON 20
 eO_1                -4.260321e-01 1 1  ON 21
 eO_2                -3.965214e-02 1 1  ON 22
 eO_3                 1.958565e-01 1 1  ON 23
 eO_4                 2.804416e-01 1 1  ON 24
 eO_5                 3.059202e-01 1 1  ON 25
 eO_6                 2.490554e-01 1 1  ON 26
 eO_7                 1.106830e-01 1 1  ON 27
 eO_8                 2.753752e-02 1 1  ON 28
 eO_9                 1.824202e-02 1 1  ON 29
eH1_0                -1.795066e-01 1 1  ON 30
eH1_1                -1.015202e-01 1 1  ON 31
eH1_2                -6.244302e-02 1 1  ON 32
eH1_3                -2.642803e-02 1 1  ON 33
eH1_4                 1.901206e-02 1 1  ON 34
eH1_5                 3.377826e-02 1 1  ON 35
eH1_6                 7.730624e-02 1 1  ON 36
eH1_7                 1.105852e-01 1 1  ON 37
eH1_8                 9.014615e-02 1 1  ON 38
eH1_9                 2.396084e-02 1 1  ON 39
eH2_0                -1.807106e-01 1 1  ON 40
eH2_1                -1.026423e-01 1 1  ON 41
eH2_2                -6.356628e-02 1 1  ON 42
eH2_3                -2.755857e-02 1 1  ON 43
eH2_4                 1.833514e-02 1 1  ON 44
eH2_5                 3.357514e-02 1 1  ON 45
eH2_6                 7.835920e-02 1 1  ON 46
eH2_7                 1.136335e-01 1 1  ON 47
eH2_8                 9.264524e-02 1 1  ON 48
eH2_9                 2.598254e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1858
    reference variance = 0.387512
====================================================
  Execution time = 3.5448e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1084e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310855390224
                                         uncertainty =       0.002783353013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310855390224
                                         uncertainty =       0.002783353013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394231028
  error estimate for blocks of size 2^( 2) =       0.000403803522
  error estimate for blocks of size 2^( 3) =       0.000412747827
  error estimate for blocks of size 2^( 4) =       0.000418596489
  error estimate for blocks of size 2^( 5) =       0.000422987805
  error estimate for blocks of size 2^( 6) =       0.000424342739
  error estimate for blocks of size 2^( 7) =       0.000425622046

      target function =                  N/A
              le_mean =     -17.216702979204
             les_mean =     296.725697524982
             stat err =       0.000422887270
             autocorr =       1.150661597338
              std dev =       0.557526865954
             le_variance =       0.310836206260


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670297920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216702979204       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703176506       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216703469715       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216703458828       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216703617556       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216703642349       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216703613519       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216703623238       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.324955e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216702979204       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216703029124       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216703104009       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216703101092       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216703140240       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216703146529       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216703139952       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216703143050       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.331635e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216702979204       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216702991722       residual = 9.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216703010545       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216703009803       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216703019556       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216703021134       residual = 4.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216703019541       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216703020356       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 8.341390e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361447 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4731e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.044294e-01 1 1  ON 0
 uu_1                 4.447226e-02 1 1  ON 1
 uu_2                -4.709159e-02 1 1  ON 2
 uu_3                -9.917124e-02 1 1  ON 3
 uu_4                -1.296225e-01 1 1  ON 4
 uu_5                -1.348910e-01 1 1  ON 5
 uu_6                -1.122226e-01 1 1  ON 6
 uu_7                -3.728428e-02 1 1  ON 7
 uu_8                 1.003624e-01 1 1  ON 8
 uu_9                 1.196350e-01 1 1  ON 9
 ud_0                 3.408000e-01 1 1  ON 10
 ud_1                 8.690916e-02 1 1  ON 11
 ud_2                -1.541034e-02 1 1  ON 12
 ud_3                -7.078653e-02 1 1  ON 13
 ud_4                -1.165797e-01 1 1  ON 14
 ud_5                -1.489635e-01 1 1  ON 15
 ud_6                -1.549966e-01 1 1  ON 16
 ud_7                -1.102566e-01 1 1  ON 17
 ud_8                 5.530523e-03 1 1  ON 18
 ud_9                 9.226102e-02 1 1  ON 19
 eO_0                -7.325415e-01 1 1  ON 20
 eO_1                -4.260461e-01 1 1  ON 21
 eO_2                -3.964940e-02 1 1  ON 22
 eO_3                 1.958768e-01 1 1  ON 23
 eO_4                 2.804573e-01 1 1  ON 24
 eO_5                 3.059222e-01 1 1  ON 25
 eO_6                 2.490580e-01 1 1  ON 26
 eO_7                 1.106860e-01 1 1  ON 27
 eO_8                 2.753780e-02 1 1  ON 28
 eO_9                 1.824226e-02 1 1  ON 29
eH1_0                -1.795129e-01 1 1  ON 30
eH1_1                -1.015220e-01 1 1  ON 31
eH1_2                -6.244089e-02 1 1  ON 32
eH1_3                -2.642799e-02 1 1  ON 33
eH1_4                 1.901345e-02 1 1  ON 34
eH1_5                 3.378049e-02 1 1  ON 35
eH1_6                 7.730615e-02 1 1  ON 36
eH1_7                 1.105849e-01 1 1  ON 37
eH1_8                 9.014806e-02 1 1  ON 38
eH1_9                 2.396137e-02 1 1  ON 39
eH2_0                -1.807129e-01 1 1  ON 40
eH2_1                -1.026431e-01 1 1  ON 41
eH2_2                -6.356578e-02 1 1  ON 42
eH2_3                -2.755852e-02 1 1  ON 43
eH2_4                 1.833696e-02 1 1  ON 44
eH2_5                 3.357587e-02 1 1  ON 45
eH2_6                 7.835767e-02 1 1  ON 46
eH2_7                 1.136322e-01 1 1  ON 47
eH2_8                 9.264711e-02 1 1  ON 48
eH2_9                 2.598307e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2665
    reference variance = 0.443839
====================================================
  Execution time = 3.3874e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1911e-01
  Total weights = 2.0000e+06
  Execution time = 3.1078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318956613893
                                         uncertainty =       0.002877660347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318956613893
                                         uncertainty =       0.002877660347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399434016
  error estimate for blocks of size 2^( 2) =       0.000409361624
  error estimate for blocks of size 2^( 3) =       0.000418163466
  error estimate for blocks of size 2^( 4) =       0.000424734509
  error estimate for blocks of size 2^( 5) =       0.000429493820
  error estimate for blocks of size 2^( 6) =       0.000431099512
  error estimate for blocks of size 2^( 7) =       0.000433301830

      target function =                  N/A
              le_mean =     -17.216750211951
             les_mean =     296.735582767739
             stat err =       0.000429657418
             autocorr =       1.157056413728
              std dev =       0.564885002954
             le_variance =       0.319095066563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319006587200
                                         uncertainty =       0.002878157151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319006587200
                                         uncertainty =       0.002878157151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399465314
  error estimate for blocks of size 2^( 2) =       0.000409391255
  error estimate for blocks of size 2^( 3) =       0.000418191565
  error estimate for blocks of size 2^( 4) =       0.000424761268
  error estimate for blocks of size 2^( 5) =       0.000429520377
  error estimate for blocks of size 2^( 6) =       0.000431124986
  error estimate for blocks of size 2^( 7) =       0.000433327566

      target function =                  N/A
              le_mean =     -17.216750336198
             les_mean =     296.735637054314
             stat err =       0.000429683549
             autocorr =       1.157015832756
              std dev =       0.564929265409
             le_variance =       0.319145074916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318982103432
                                         uncertainty =       0.002877912980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318982103432
                                         uncertainty =       0.002877912980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399449981
  error estimate for blocks of size 2^( 2) =       0.000409376745
  error estimate for blocks of size 2^( 3) =       0.000418177812
  error estimate for blocks of size 2^( 4) =       0.000424748179
  error estimate for blocks of size 2^( 5) =       0.000429507387
  error estimate for blocks of size 2^( 6) =       0.000431112523
  error estimate for blocks of size 2^( 7) =       0.000433314971

      target function =                  N/A
              le_mean =     -17.216750273015
             les_mean =     296.735610377755
             stat err =       0.000429670765
             autocorr =       1.157035812772
              std dev =       0.564907579997
             le_variance =       0.319120573938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318959815201
                                         uncertainty =       0.002877692055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318959815201
                                         uncertainty =       0.002877692055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399436021
  error estimate for blocks of size 2^( 2) =       0.000409363523
  error estimate for blocks of size 2^( 3) =       0.000418165268
  error estimate for blocks of size 2^( 4) =       0.000424736226
  error estimate for blocks of size 2^( 5) =       0.000429495525
  error estimate for blocks of size 2^( 6) =       0.000431101146
  error estimate for blocks of size 2^( 7) =       0.000433303481

      target function =                  N/A
              le_mean =     -17.216750219425
             les_mean =     296.735586228637
             stat err =       0.000429659095
             autocorr =       1.157053828172
              std dev =       0.564887838522
             le_variance =       0.319098270111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216750211951        initial
     9.7656e+00     9.7656e+01             1.3250e-04       -17.216750336198  <--
     3.9062e+01     3.9062e+02             3.3316e-05       -17.216750273015
     1.5625e+02     1.5625e+03             8.3414e-06       -17.216750219425

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 4.9537e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.044650e-01 1 1  ON 0
 uu_1                 4.448792e-02 1 1  ON 1
 uu_2                -4.709965e-02 1 1  ON 2
 uu_3                -9.917609e-02 1 1  ON 3
 uu_4                -1.296501e-01 1 1  ON 4
 uu_5                -1.348992e-01 1 1  ON 5
 uu_6                -1.122218e-01 1 1  ON 6
 uu_7                -3.729264e-02 1 1  ON 7
 uu_8                 1.003559e-01 1 1  ON 8
 uu_9                 1.196392e-01 1 1  ON 9
 ud_0                 3.408371e-01 1 1  ON 10
 ud_1                 8.691766e-02 1 1  ON 11
 ud_2                -1.540598e-02 1 1  ON 12
 ud_3                -7.080484e-02 1 1  ON 13
 ud_4                -1.166002e-01 1 1  ON 14
 ud_5                -1.489779e-01 1 1  ON 15
 ud_6                -1.549877e-01 1 1  ON 16
 ud_7                -1.102570e-01 1 1  ON 17
 ud_8                 5.519519e-03 1 1  ON 18
 ud_9                 9.226084e-02 1 1  ON 19
 eO_0                -7.326406e-01 1 1  ON 20
 eO_1                -4.260878e-01 1 1  ON 21
 eO_2                -3.964147e-02 1 1  ON 22
 eO_3                 1.959375e-01 1 1  ON 23
 eO_4                 2.805042e-01 1 1  ON 24
 eO_5                 3.059285e-01 1 1  ON 25
 eO_6                 2.490656e-01 1 1  ON 26
 eO_7                 1.106951e-01 1 1  ON 27
 eO_8                 2.753865e-02 1 1  ON 28
 eO_9                 1.824294e-02 1 1  ON 29
eH1_0                -1.795316e-01 1 1  ON 30
eH1_1                -1.015274e-01 1 1  ON 31
eH1_2                -6.243448e-02 1 1  ON 32
eH1_3                -2.642767e-02 1 1  ON 33
eH1_4                 1.901748e-02 1 1  ON 34
eH1_5                 3.378716e-02 1 1  ON 35
eH1_6                 7.730588e-02 1 1  ON 36
eH1_7                 1.105842e-01 1 1  ON 37
eH1_8                 9.015376e-02 1 1  ON 38
eH1_9                 2.396297e-02 1 1  ON 39
eH2_0                -1.807199e-01 1 1  ON 40
eH2_1                -1.026455e-01 1 1  ON 41
eH2_2                -6.356418e-02 1 1  ON 42
eH2_3                -2.755835e-02 1 1  ON 43
eH2_4                 1.834235e-02 1 1  ON 44
eH2_5                 3.357807e-02 1 1  ON 45
eH2_6                 7.835312e-02 1 1  ON 46
eH2_7                 1.136285e-01 1 1  ON 47
eH2_8                 9.265271e-02 1 1  ON 48
eH2_9                 2.598466e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4296e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2365
    reference variance = 0.213415
====================================================
  Execution time = 3.4920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314368032860
                                         uncertainty =       0.002680204526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314368032860
                                         uncertainty =       0.002680204526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396420807
  error estimate for blocks of size 2^( 2) =       0.000406258197
  error estimate for blocks of size 2^( 3) =       0.000415086980
  error estimate for blocks of size 2^( 4) =       0.000421371689
  error estimate for blocks of size 2^( 5) =       0.000425894272
  error estimate for blocks of size 2^( 6) =       0.000427774800
  error estimate for blocks of size 2^( 7) =       0.000428015025

      target function =                  N/A
              le_mean =     -17.214981163691
             les_mean =     296.669875220819
             stat err =       0.000425763947
             autocorr =       1.153519349840
              std dev =       0.560623681042
             le_variance =       0.314298911745


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721498116369e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214981163691       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214981251855       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214982697973       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214982794221       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214982872122       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214982684996       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214982777310       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214982762381       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.214982784801       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.262508e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214981163691       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214981186875       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214981576502       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214981587739       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214981608225       residual = 9.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214981560358       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214981584344       residual = 4.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214981580345       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.340787e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.214981163691       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.214981169563       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.214981268887       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.214981271014       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.214981276057       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.214981264012       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.214981270054       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.214981269033       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.369238e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364296 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4214e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.044952e-01 1 1  ON 0
 uu_1                 4.451562e-02 1 1  ON 1
 uu_2                -4.710282e-02 1 1  ON 2
 uu_3                -9.918261e-02 1 1  ON 3
 uu_4                -1.296698e-01 1 1  ON 4
 uu_5                -1.349085e-01 1 1  ON 5
 uu_6                -1.122305e-01 1 1  ON 6
 uu_7                -3.730803e-02 1 1  ON 7
 uu_8                 1.003472e-01 1 1  ON 8
 uu_9                 1.196449e-01 1 1  ON 9
 ud_0                 3.408734e-01 1 1  ON 10
 ud_1                 8.694767e-02 1 1  ON 11
 ud_2                -1.540496e-02 1 1  ON 12
 ud_3                -7.082828e-02 1 1  ON 13
 ud_4                -1.166167e-01 1 1  ON 14
 ud_5                -1.490034e-01 1 1  ON 15
 ud_6                -1.549762e-01 1 1  ON 16
 ud_7                -1.102607e-01 1 1  ON 17
 ud_8                 5.504215e-03 1 1  ON 18
 ud_9                 9.226006e-02 1 1  ON 19
 eO_0                -7.327747e-01 1 1  ON 20
 eO_1                -4.261583e-01 1 1  ON 21
 eO_2                -3.961923e-02 1 1  ON 22
 eO_3                 1.960190e-01 1 1  ON 23
 eO_4                 2.805736e-01 1 1  ON 24
 eO_5                 3.059371e-01 1 1  ON 25
 eO_6                 2.490740e-01 1 1  ON 26
 eO_7                 1.107070e-01 1 1  ON 27
 eO_8                 2.753983e-02 1 1  ON 28
 eO_9                 1.824348e-02 1 1  ON 29
eH1_0                -1.795418e-01 1 1  ON 30
eH1_1                -1.015301e-01 1 1  ON 31
eH1_2                -6.243469e-02 1 1  ON 32
eH1_3                -2.643956e-02 1 1  ON 33
eH1_4                 1.902344e-02 1 1  ON 34
eH1_5                 3.380270e-02 1 1  ON 35
eH1_6                 7.730638e-02 1 1  ON 36
eH1_7                 1.105783e-01 1 1  ON 37
eH1_8                 9.015993e-02 1 1  ON 38
eH1_9                 2.396470e-02 1 1  ON 39
eH2_0                -1.807278e-01 1 1  ON 40
eH2_1                -1.026497e-01 1 1  ON 41
eH2_2                -6.354573e-02 1 1  ON 42
eH2_3                -2.756537e-02 1 1  ON 43
eH2_4                 1.833730e-02 1 1  ON 44
eH2_5                 3.358470e-02 1 1  ON 45
eH2_6                 7.834758e-02 1 1  ON 46
eH2_7                 1.136256e-01 1 1  ON 47
eH2_8                 9.265795e-02 1 1  ON 48
eH2_9                 2.598642e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1576
    reference variance = 0.720583
====================================================
  Execution time = 3.4043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1935e-01
  Total weights = 2.0000e+06
  Execution time = 3.0894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319298550327
                                         uncertainty =       0.007964828066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319298550327
                                         uncertainty =       0.007964828066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399576915
  error estimate for blocks of size 2^( 2) =       0.000408937508
  error estimate for blocks of size 2^( 3) =       0.000417335660
  error estimate for blocks of size 2^( 4) =       0.000423373967
  error estimate for blocks of size 2^( 5) =       0.000427476480
  error estimate for blocks of size 2^( 6) =       0.000429752887
  error estimate for blocks of size 2^( 7) =       0.000431345781

      target function =                  N/A
              le_mean =     -17.216299137932
             les_mean =     296.720279269189
             stat err =       0.000427987279
             autocorr =       1.147257596558
              std dev =       0.565087092473
             le_variance =       0.319323422079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319415990498
                                         uncertainty =       0.007968483397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319415990498
                                         uncertainty =       0.007968483397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399650324
  error estimate for blocks of size 2^( 2) =       0.000409005635
  error estimate for blocks of size 2^( 3) =       0.000417397070
  error estimate for blocks of size 2^( 4) =       0.000423431455
  error estimate for blocks of size 2^( 5) =       0.000427531727
  error estimate for blocks of size 2^( 6) =       0.000429807571
  error estimate for blocks of size 2^( 7) =       0.000431403033

      target function =                  N/A
              le_mean =     -17.216298655727
             les_mean =     296.720380006397
             stat err =       0.000428043446
             autocorr =       1.147137205472
              std dev =       0.565190908389
             le_variance =       0.319440762926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359686174
                                         uncertainty =       0.007966891143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319359686174
                                         uncertainty =       0.007966891143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399615130
  error estimate for blocks of size 2^( 2) =       0.000408972913
  error estimate for blocks of size 2^( 3) =       0.000417367565
  error estimate for blocks of size 2^( 4) =       0.000423403890
  error estimate for blocks of size 2^( 5) =       0.000427505206
  error estimate for blocks of size 2^( 6) =       0.000429781303
  error estimate for blocks of size 2^( 7) =       0.000431375480

      target function =                  N/A
              le_mean =     -17.216298832927
             les_mean =     296.720329849584
             stat err =       0.000428016470
             autocorr =       1.147194656534
              std dev =       0.565141136915
             le_variance =       0.319384504634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319306197694
                                         uncertainty =       0.007965089488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319306197694
                                         uncertainty =       0.007965089488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399581695
  error estimate for blocks of size 2^( 2) =       0.000408941934
  error estimate for blocks of size 2^( 3) =       0.000417339646
  error estimate for blocks of size 2^( 4) =       0.000423377703
  error estimate for blocks of size 2^( 5) =       0.000427480065
  error estimate for blocks of size 2^( 6) =       0.000429756433
  error estimate for blocks of size 2^( 7) =       0.000431349488

      target function =                  N/A
              le_mean =     -17.216299096355
             les_mean =     296.720285478170
             stat err =       0.000427990922
             autocorr =       1.147249678827
              std dev =       0.565093852990
             le_variance =       0.319331062687


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216299137932        initial  <--
     2.4414e+00     2.4414e+01             5.2625e-04       -17.216298655727
     9.7656e+00     9.7656e+01             1.3408e-04       -17.216298832927
     3.9062e+01     3.9062e+02             3.3692e-05       -17.216299096355

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.8449
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.044650e-01 1 1  ON 0
 uu_1                 4.448792e-02 1 1  ON 1
 uu_2                -4.709965e-02 1 1  ON 2
 uu_3                -9.917609e-02 1 1  ON 3
 uu_4                -1.296501e-01 1 1  ON 4
 uu_5                -1.348992e-01 1 1  ON 5
 uu_6                -1.122218e-01 1 1  ON 6
 uu_7                -3.729264e-02 1 1  ON 7
 uu_8                 1.003559e-01 1 1  ON 8
 uu_9                 1.196392e-01 1 1  ON 9
 ud_0                 3.408371e-01 1 1  ON 10
 ud_1                 8.691766e-02 1 1  ON 11
 ud_2                -1.540598e-02 1 1  ON 12
 ud_3                -7.080484e-02 1 1  ON 13
 ud_4                -1.166002e-01 1 1  ON 14
 ud_5                -1.489779e-01 1 1  ON 15
 ud_6                -1.549877e-01 1 1  ON 16
 ud_7                -1.102570e-01 1 1  ON 17
 ud_8                 5.519519e-03 1 1  ON 18
 ud_9                 9.226084e-02 1 1  ON 19
 eO_0                -7.326406e-01 1 1  ON 20
 eO_1                -4.260878e-01 1 1  ON 21
 eO_2                -3.964147e-02 1 1  ON 22
 eO_3                 1.959375e-01 1 1  ON 23
 eO_4                 2.805042e-01 1 1  ON 24
 eO_5                 3.059285e-01 1 1  ON 25
 eO_6                 2.490656e-01 1 1  ON 26
 eO_7                 1.106951e-01 1 1  ON 27
 eO_8                 2.753865e-02 1 1  ON 28
 eO_9                 1.824294e-02 1 1  ON 29
eH1_0                -1.795316e-01 1 1  ON 30
eH1_1                -1.015274e-01 1 1  ON 31
eH1_2                -6.243448e-02 1 1  ON 32
eH1_3                -2.642767e-02 1 1  ON 33
eH1_4                 1.901748e-02 1 1  ON 34
eH1_5                 3.378716e-02 1 1  ON 35
eH1_6                 7.730588e-02 1 1  ON 36
eH1_7                 1.105842e-01 1 1  ON 37
eH1_8                 9.015376e-02 1 1  ON 38
eH1_9                 2.396297e-02 1 1  ON 39
eH2_0                -1.807199e-01 1 1  ON 40
eH2_1                -1.026455e-01 1 1  ON 41
eH2_2                -6.356418e-02 1 1  ON 42
eH2_3                -2.755835e-02 1 1  ON 43
eH2_4                 1.834235e-02 1 1  ON 44
eH2_5                 3.357807e-02 1 1  ON 45
eH2_6                 7.835312e-02 1 1  ON 46
eH2_7                 1.136285e-01 1 1  ON 47
eH2_8                 9.265271e-02 1 1  ON 48
eH2_9                 2.598466e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6065e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1779
    reference variance = 0.314018
====================================================
  Execution time = 3.4717e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1349e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2026e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313541003265
                                         uncertainty =       0.003365333544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313541003265
                                         uncertainty =       0.003365333544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395913344
  error estimate for blocks of size 2^( 2) =       0.000405607249
  error estimate for blocks of size 2^( 3) =       0.000414434742
  error estimate for blocks of size 2^( 4) =       0.000420683257
  error estimate for blocks of size 2^( 5) =       0.000424652327
  error estimate for blocks of size 2^( 6) =       0.000427541132
  error estimate for blocks of size 2^( 7) =       0.000429150547

      target function =                  N/A
              le_mean =     -17.215909622365
             les_mean =     296.701038721269
             stat err =       0.000425506816
             autocorr =       1.155081854364
              std dev =       0.559906021205
             le_variance =       0.313494752581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721590962236e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215909622365       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215909587496       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215909738236       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215909796456       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215909829110       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215909829369       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215909831551       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215909833398       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 5.658339e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215909622365       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215909613598       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215909651404       residual = 9.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215909665968       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215909674226       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215909674284       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215909674810       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215909675235       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.418826e-05

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215909622365       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215909620170       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215909629629       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215909633271       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215909635341       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215909635355       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215909635486       residual = 2.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215909635590       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 3.549736e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366957 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3931e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.044668e-01 1 1  ON 0
 uu_1                 4.449070e-02 1 1  ON 1
 uu_2                -4.709973e-02 1 1  ON 2
 uu_3                -9.917664e-02 1 1  ON 3
 uu_4                -1.296526e-01 1 1  ON 4
 uu_5                -1.348993e-01 1 1  ON 5
 uu_6                -1.122222e-01 1 1  ON 6
 uu_7                -3.729395e-02 1 1  ON 7
 uu_8                 1.003552e-01 1 1  ON 8
 uu_9                 1.196397e-01 1 1  ON 9
 ud_0                 3.408405e-01 1 1  ON 10
 ud_1                 8.692015e-02 1 1  ON 11
 ud_2                -1.540614e-02 1 1  ON 12
 ud_3                -7.080719e-02 1 1  ON 13
 ud_4                -1.166029e-01 1 1  ON 14
 ud_5                -1.489788e-01 1 1  ON 15
 ud_6                -1.549866e-01 1 1  ON 16
 ud_7                -1.102572e-01 1 1  ON 17
 ud_8                 5.518480e-03 1 1  ON 18
 ud_9                 9.226080e-02 1 1  ON 19
 eO_0                -7.326548e-01 1 1  ON 20
 eO_1                -4.260936e-01 1 1  ON 21
 eO_2                -3.964011e-02 1 1  ON 22
 eO_3                 1.959464e-01 1 1  ON 23
 eO_4                 2.805108e-01 1 1  ON 24
 eO_5                 3.059295e-01 1 1  ON 25
 eO_6                 2.490662e-01 1 1  ON 26
 eO_7                 1.106963e-01 1 1  ON 27
 eO_8                 2.753888e-02 1 1  ON 28
 eO_9                 1.824297e-02 1 1  ON 29
eH1_0                -1.795331e-01 1 1  ON 30
eH1_1                -1.015285e-01 1 1  ON 31
eH1_2                -6.243465e-02 1 1  ON 32
eH1_3                -2.642786e-02 1 1  ON 33
eH1_4                 1.901777e-02 1 1  ON 34
eH1_5                 3.378832e-02 1 1  ON 35
eH1_6                 7.730670e-02 1 1  ON 36
eH1_7                 1.105840e-01 1 1  ON 37
eH1_8                 9.015443e-02 1 1  ON 38
eH1_9                 2.396314e-02 1 1  ON 39
eH2_0                -1.807218e-01 1 1  ON 40
eH2_1                -1.026464e-01 1 1  ON 41
eH2_2                -6.356367e-02 1 1  ON 42
eH2_3                -2.755842e-02 1 1  ON 43
eH2_4                 1.834229e-02 1 1  ON 44
eH2_5                 3.357931e-02 1 1  ON 45
eH2_6                 7.835337e-02 1 1  ON 46
eH2_7                 1.136285e-01 1 1  ON 47
eH2_8                 9.265345e-02 1 1  ON 48
eH2_9                 2.598486e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2297
    reference variance = 0.226775
====================================================
  Execution time = 3.4320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1764e-01
  Total weights = 2.0000e+06
  Execution time = 3.1051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317629372179
                                         uncertainty =       0.004482216139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317629372179
                                         uncertainty =       0.004482216139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398522674
  error estimate for blocks of size 2^( 2) =       0.000408305108
  error estimate for blocks of size 2^( 3) =       0.000416911762
  error estimate for blocks of size 2^( 4) =       0.000423007982
  error estimate for blocks of size 2^( 5) =       0.000427254899
  error estimate for blocks of size 2^( 6) =       0.000430703923
  error estimate for blocks of size 2^( 7) =       0.000431182406

      target function =                  N/A
              le_mean =     -17.216266349133
             les_mean =     296.717467489266
             stat err =       0.000428037303
             autocorr =       1.153605094941
              std dev =       0.563596170857
             le_variance =       0.317640643804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317641435792
                                         uncertainty =       0.004482357724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317641435792
                                         uncertainty =       0.004482357724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398530239
  error estimate for blocks of size 2^( 2) =       0.000408312115
  error estimate for blocks of size 2^( 3) =       0.000416918112
  error estimate for blocks of size 2^( 4) =       0.000423013953
  error estimate for blocks of size 2^( 5) =       0.000427260580
  error estimate for blocks of size 2^( 6) =       0.000430709497
  error estimate for blocks of size 2^( 7) =       0.000431188068

      target function =                  N/A
              le_mean =     -17.216266377253
             les_mean =     296.717480515785
             stat err =       0.000428043025
             autocorr =       1.153592144456
              std dev =       0.563606868384
             le_variance =       0.317652702090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317635417038
                                         uncertainty =       0.004482287012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317635417038
                                         uncertainty =       0.004482287012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398526465
  error estimate for blocks of size 2^( 2) =       0.000408308619
  error estimate for blocks of size 2^( 3) =       0.000416914943
  error estimate for blocks of size 2^( 4) =       0.000423010973
  error estimate for blocks of size 2^( 5) =       0.000427257745
  error estimate for blocks of size 2^( 6) =       0.000430706716
  error estimate for blocks of size 2^( 7) =       0.000431185244

      target function =                  N/A
              le_mean =     -17.216266362647
             les_mean =     296.717473996774
             stat err =       0.000428040170
             autocorr =       1.153598603729
              std dev =       0.563601531218
             le_variance =       0.317646685991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317630128090
                                         uncertainty =       0.004482225001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317630128090
                                         uncertainty =       0.004482225001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398523148
  error estimate for blocks of size 2^( 2) =       0.000408305547
  error estimate for blocks of size 2^( 3) =       0.000416912159
  error estimate for blocks of size 2^( 4) =       0.000423008356
  error estimate for blocks of size 2^( 5) =       0.000427255255
  error estimate for blocks of size 2^( 6) =       0.000430704272
  error estimate for blocks of size 2^( 7) =       0.000431182761

      target function =                  N/A
              le_mean =     -17.216266350789
             les_mean =     296.717468301881
             stat err =       0.000428037661
             autocorr =       1.153604282959
              std dev =       0.563596841173
             le_variance =       0.317641399380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216266349133        initial
     2.4414e+01     2.4414e+02             5.6583e-05       -17.216266377253  <--
     9.7656e+01     9.7656e+02             1.4188e-05       -17.216266362647
     3.9062e+02     3.9062e+03             3.5497e-06       -17.216266350789

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 4.9969e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.044723e-01 1 1  ON 0
 uu_1                 4.449898e-02 1 1  ON 1
 uu_2                -4.709991e-02 1 1  ON 2
 uu_3                -9.917831e-02 1 1  ON 3
 uu_4                -1.296601e-01 1 1  ON 4
 uu_5                -1.348995e-01 1 1  ON 5
 uu_6                -1.122235e-01 1 1  ON 6
 uu_7                -3.729788e-02 1 1  ON 7
 uu_8                 1.003529e-01 1 1  ON 8
 uu_9                 1.196412e-01 1 1  ON 9
 ud_0                 3.408508e-01 1 1  ON 10
 ud_1                 8.692755e-02 1 1  ON 11
 ud_2                -1.540660e-02 1 1  ON 12
 ud_3                -7.081418e-02 1 1  ON 13
 ud_4                -1.166110e-01 1 1  ON 14
 ud_5                -1.489814e-01 1 1  ON 15
 ud_6                -1.549833e-01 1 1  ON 16
 ud_7                -1.102578e-01 1 1  ON 17
 ud_8                 5.515369e-03 1 1  ON 18
 ud_9                 9.226066e-02 1 1  ON 19
 eO_0                -7.326972e-01 1 1  ON 20
 eO_1                -4.261108e-01 1 1  ON 21
 eO_2                -3.963609e-02 1 1  ON 22
 eO_3                 1.959729e-01 1 1  ON 23
 eO_4                 2.805306e-01 1 1  ON 24
 eO_5                 3.059325e-01 1 1  ON 25
 eO_6                 2.490680e-01 1 1  ON 26
 eO_7                 1.107000e-01 1 1  ON 27
 eO_8                 2.753956e-02 1 1  ON 28
 eO_9                 1.824307e-02 1 1  ON 29
eH1_0                -1.795376e-01 1 1  ON 30
eH1_1                -1.015317e-01 1 1  ON 31
eH1_2                -6.243513e-02 1 1  ON 32
eH1_3                -2.642840e-02 1 1  ON 33
eH1_4                 1.901861e-02 1 1  ON 34
eH1_5                 3.379181e-02 1 1  ON 35
eH1_6                 7.730917e-02 1 1  ON 36
eH1_7                 1.105835e-01 1 1  ON 37
eH1_8                 9.015645e-02 1 1  ON 38
eH1_9                 2.396366e-02 1 1  ON 39
eH2_0                -1.807276e-01 1 1  ON 40
eH2_1                -1.026491e-01 1 1  ON 41
eH2_2                -6.356216e-02 1 1  ON 42
eH2_3                -2.755861e-02 1 1  ON 43
eH2_4                 1.834211e-02 1 1  ON 44
eH2_5                 3.358301e-02 1 1  ON 45
eH2_6                 7.835415e-02 1 1  ON 46
eH2_7                 1.136285e-01 1 1  ON 47
eH2_8                 9.265567e-02 1 1  ON 48
eH2_9                 2.598547e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3905e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2244
    reference variance = 0.169145
====================================================
  Execution time = 3.4554e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1978e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1258e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319692335632
                                         uncertainty =       0.004948089586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319692335632
                                         uncertainty =       0.004948089586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399861793
  error estimate for blocks of size 2^( 2) =       0.000409262969
  error estimate for blocks of size 2^( 3) =       0.000418225370
  error estimate for blocks of size 2^( 4) =       0.000424294826
  error estimate for blocks of size 2^( 5) =       0.000429637026
  error estimate for blocks of size 2^( 6) =       0.000432635656
  error estimate for blocks of size 2^( 7) =       0.000434781942

      target function =                  N/A
              le_mean =     -17.215879735889
             les_mean =     296.706293827746
             stat err =       0.000430337362
             autocorr =       1.158239279942
              std dev =       0.565489970783
             le_variance =       0.319778907056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721587973589e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215879735889       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215879865634       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215880174641       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215880236518       residual = 5.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215880408393       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215880401828       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215880363996       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215880378229       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.062263e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215879735889       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215879768954       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215879848595       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215879863054       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215879904769       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215879904545       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215879895258       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215879898744       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 5.198293e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215879735889       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215879744195       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215879764261       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215879767810       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215879778153       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215879778184       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215879775880       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215879776746       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.302280e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369615 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3691e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.044873e-01 1 1  ON 0
 uu_1                 4.450720e-02 1 1  ON 1
 uu_2                -4.710019e-02 1 1  ON 2
 uu_3                -9.918087e-02 1 1  ON 3
 uu_4                -1.296690e-01 1 1  ON 4
 uu_5                -1.349042e-01 1 1  ON 5
 uu_6                -1.122264e-01 1 1  ON 6
 uu_7                -3.730392e-02 1 1  ON 7
 uu_8                 1.003504e-01 1 1  ON 8
 uu_9                 1.196435e-01 1 1  ON 9
 ud_0                 3.408682e-01 1 1  ON 10
 ud_1                 8.693500e-02 1 1  ON 11
 ud_2                -1.540321e-02 1 1  ON 12
 ud_3                -7.082587e-02 1 1  ON 13
 ud_4                -1.166190e-01 1 1  ON 14
 ud_5                -1.489887e-01 1 1  ON 15
 ud_6                -1.549816e-01 1 1  ON 16
 ud_7                -1.102579e-01 1 1  ON 17
 ud_8                 5.511059e-03 1 1  ON 18
 ud_9                 9.226029e-02 1 1  ON 19
 eO_0                -7.327492e-01 1 1  ON 20
 eO_1                -4.261364e-01 1 1  ON 21
 eO_2                -3.963075e-02 1 1  ON 22
 eO_3                 1.960077e-01 1 1  ON 23
 eO_4                 2.805573e-01 1 1  ON 24
 eO_5                 3.059348e-01 1 1  ON 25
 eO_6                 2.490708e-01 1 1  ON 26
 eO_7                 1.107046e-01 1 1  ON 27
 eO_8                 2.754028e-02 1 1  ON 28
 eO_9                 1.824334e-02 1 1  ON 29
eH1_0                -1.795421e-01 1 1  ON 30
eH1_1                -1.015363e-01 1 1  ON 31
eH1_2                -6.243336e-02 1 1  ON 32
eH1_3                -2.643057e-02 1 1  ON 33
eH1_4                 1.901814e-02 1 1  ON 34
eH1_5                 3.379662e-02 1 1  ON 35
eH1_6                 7.731064e-02 1 1  ON 36
eH1_7                 1.105834e-01 1 1  ON 37
eH1_8                 9.015896e-02 1 1  ON 38
eH1_9                 2.396444e-02 1 1  ON 39
eH2_0                -1.807311e-01 1 1  ON 40
eH2_1                -1.026532e-01 1 1  ON 41
eH2_2                -6.356143e-02 1 1  ON 42
eH2_3                -2.755551e-02 1 1  ON 43
eH2_4                 1.834038e-02 1 1  ON 44
eH2_5                 3.358541e-02 1 1  ON 45
eH2_6                 7.835415e-02 1 1  ON 46
eH2_7                 1.136280e-01 1 1  ON 47
eH2_8                 9.265822e-02 1 1  ON 48
eH2_9                 2.598615e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1684
    reference variance = 0.196388
====================================================
  Execution time = 3.4330e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0707e-01
  Total weights = 2.0000e+06
  Execution time = 3.0851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307064632905
                                         uncertainty =       0.002369418597

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307064632905
                                         uncertainty =       0.002369418597

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391829320
  error estimate for blocks of size 2^( 2) =       0.000401826550
  error estimate for blocks of size 2^( 3) =       0.000410288747
  error estimate for blocks of size 2^( 4) =       0.000416333419
  error estimate for blocks of size 2^( 5) =       0.000419599954
  error estimate for blocks of size 2^( 6) =       0.000423113768
  error estimate for blocks of size 2^( 7) =       0.000427025687

      target function =                  N/A
              le_mean =     -17.216359418146
             les_mean =     296.710091893918
             stat err =       0.000421518207
             autocorr =       1.157280978148
              std dev =       0.554130339063
             le_variance =       0.307060432670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307119376199
                                         uncertainty =       0.002369875779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307119376199
                                         uncertainty =       0.002369875779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391864264
  error estimate for blocks of size 2^( 2) =       0.000401859095
  error estimate for blocks of size 2^( 3) =       0.000410318602
  error estimate for blocks of size 2^( 4) =       0.000416361629
  error estimate for blocks of size 2^( 5) =       0.000419627564
  error estimate for blocks of size 2^( 6) =       0.000423139827
  error estimate for blocks of size 2^( 7) =       0.000427052087

      target function =                  N/A
              le_mean =     -17.216359575056
             les_mean =     296.710152066465
             stat err =       0.000421545277
             autocorr =       1.157223211450
              std dev =       0.554179756392
             le_variance =       0.307115202395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307092529949
                                         uncertainty =       0.002369649483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307092529949
                                         uncertainty =       0.002369649483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391847128
  error estimate for blocks of size 2^( 2) =       0.000401843141
  error estimate for blocks of size 2^( 3) =       0.000410303976
  error estimate for blocks of size 2^( 4) =       0.000416347812
  error estimate for blocks of size 2^( 5) =       0.000419614037
  error estimate for blocks of size 2^( 6) =       0.000423127060
  error estimate for blocks of size 2^( 7) =       0.000427039143

      target function =                  N/A
              le_mean =     -17.216359497136
             les_mean =     296.710122524367
             stat err =       0.000421532013
             autocorr =       1.157251598488
              std dev =       0.554155522655
             le_variance =       0.307088343289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307068135339
                                         uncertainty =       0.002369447523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.307068135339
                                         uncertainty =       0.002369447523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000391831556
  error estimate for blocks of size 2^( 2) =       0.000401828633
  error estimate for blocks of size 2^( 3) =       0.000410290660
  error estimate for blocks of size 2^( 4) =       0.000416335226
  error estimate for blocks of size 2^( 5) =       0.000419601722
  error estimate for blocks of size 2^( 6) =       0.000423115437
  error estimate for blocks of size 2^( 7) =       0.000427027376

      target function =                  N/A
              le_mean =     -17.216359427804
             les_mean =     296.710095730607
             stat err =       0.000421519940
             autocorr =       1.157277288552
              std dev =       0.554133500894
             le_variance =       0.307063936813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216359418146        initial
     6.1035e+00     6.1035e+01             2.0623e-04       -17.216359575056  <--
     2.4414e+01     2.4414e+02             5.1983e-05       -17.216359497136
     9.7656e+01     9.7656e+02             1.3023e-05       -17.216359427804

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 4.9891e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.045317e-01 1 1  ON 0
 uu_1                 4.453134e-02 1 1  ON 1
 uu_2                -4.710036e-02 1 1  ON 2
 uu_3                -9.918874e-02 1 1  ON 3
 uu_4                -1.296951e-01 1 1  ON 4
 uu_5                -1.349182e-01 1 1  ON 5
 uu_6                -1.122350e-01 1 1  ON 6
 uu_7                -3.732195e-02 1 1  ON 7
 uu_8                 1.003427e-01 1 1  ON 8
 uu_9                 1.196502e-01 1 1  ON 9
 ud_0                 3.409191e-01 1 1  ON 10
 ud_1                 8.695766e-02 1 1  ON 11
 ud_2                -1.539374e-02 1 1  ON 12
 ud_3                -7.085908e-02 1 1  ON 13
 ud_4                -1.166434e-01 1 1  ON 14
 ud_5                -1.490102e-01 1 1  ON 15
 ud_6                -1.549762e-01 1 1  ON 16
 ud_7                -1.102581e-01 1 1  ON 17
 ud_8                 5.498212e-03 1 1  ON 18
 ud_9                 9.225918e-02 1 1  ON 19
 eO_0                -7.329034e-01 1 1  ON 20
 eO_1                -4.262124e-01 1 1  ON 21
 eO_2                -3.961573e-02 1 1  ON 22
 eO_3                 1.961109e-01 1 1  ON 23
 eO_4                 2.806370e-01 1 1  ON 24
 eO_5                 3.059416e-01 1 1  ON 25
 eO_6                 2.490789e-01 1 1  ON 26
 eO_7                 1.107183e-01 1 1  ON 27
 eO_8                 2.754241e-02 1 1  ON 28
 eO_9                 1.824417e-02 1 1  ON 29
eH1_0                -1.795554e-01 1 1  ON 30
eH1_1                -1.015498e-01 1 1  ON 31
eH1_2                -6.242822e-02 1 1  ON 32
eH1_3                -2.643670e-02 1 1  ON 33
eH1_4                 1.901644e-02 1 1  ON 34
eH1_5                 3.381099e-02 1 1  ON 35
eH1_6                 7.731513e-02 1 1  ON 36
eH1_7                 1.105833e-01 1 1  ON 37
eH1_8                 9.016646e-02 1 1  ON 38
eH1_9                 2.396678e-02 1 1  ON 39
eH2_0                -1.807413e-01 1 1  ON 40
eH2_1                -1.026655e-01 1 1  ON 41
eH2_2                -6.355917e-02 1 1  ON 42
eH2_3                -2.754634e-02 1 1  ON 43
eH2_4                 1.833531e-02 1 1  ON 44
eH2_5                 3.359258e-02 1 1  ON 45
eH2_6                 7.835417e-02 1 1  ON 46
eH2_7                 1.136267e-01 1 1  ON 47
eH2_8                 9.266582e-02 1 1  ON 48
eH2_9                 2.598819e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3588e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.226607
====================================================
  Execution time = 3.5151e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318882329500
                                         uncertainty =       0.003645812018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318882329500
                                         uncertainty =       0.003645812018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399372205
  error estimate for blocks of size 2^( 2) =       0.000408995792
  error estimate for blocks of size 2^( 3) =       0.000418168337
  error estimate for blocks of size 2^( 4) =       0.000424309490
  error estimate for blocks of size 2^( 5) =       0.000428259128
  error estimate for blocks of size 2^( 6) =       0.000430104687
  error estimate for blocks of size 2^( 7) =       0.000431824645

      target function =                  N/A
              le_mean =     -17.216463906651
             les_mean =     296.725625605083
             stat err =       0.000428624487
             autocorr =       1.151856258313
              std dev =       0.564797588130
             le_variance =       0.318996315557


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646390665e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463906651       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216463802662       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216464126973       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216464585829       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216466507813       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216466757684       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216466907749       residual = 4.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216466897372       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216466828247       residual = 3.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 8.071378e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463906651       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216463878898       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216463962626       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216464064813       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216464544009       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216464599956       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216464640249       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216464632023       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.086725e-04

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216463906651       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216463899594       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216463920674       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216463945199       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216464064426       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216464077961       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216464088156       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216464085811       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 5.261178e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.372462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4451e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.045727e-01 1 1  ON 0
 uu_1                 4.457772e-02 1 1  ON 1
 uu_2                -4.710248e-02 1 1  ON 2
 uu_3                -9.918901e-02 1 1  ON 3
 uu_4                -1.297503e-01 1 1  ON 4
 uu_5                -1.349313e-01 1 1  ON 5
 uu_6                -1.122400e-01 1 1  ON 6
 uu_7                -3.734335e-02 1 1  ON 7
 uu_8                 1.003290e-01 1 1  ON 8
 uu_9                 1.196598e-01 1 1  ON 9
 ud_0                 3.409816e-01 1 1  ON 10
 ud_1                 8.698897e-02 1 1  ON 11
 ud_2                -1.539553e-02 1 1  ON 12
 ud_3                -7.088899e-02 1 1  ON 13
 ud_4                -1.166779e-01 1 1  ON 14
 ud_5                -1.490471e-01 1 1  ON 15
 ud_6                -1.549515e-01 1 1  ON 16
 ud_7                -1.102647e-01 1 1  ON 17
 ud_8                 5.475136e-03 1 1  ON 18
 ud_9                 9.225999e-02 1 1  ON 19
 eO_0                -7.331121e-01 1 1  ON 20
 eO_1                -4.263231e-01 1 1  ON 21
 eO_2                -3.959193e-02 1 1  ON 22
 eO_3                 1.962432e-01 1 1  ON 23
 eO_4                 2.807456e-01 1 1  ON 24
 eO_5                 3.059534e-01 1 1  ON 25
 eO_6                 2.490966e-01 1 1  ON 26
 eO_7                 1.107364e-01 1 1  ON 27
 eO_8                 2.754600e-02 1 1  ON 28
 eO_9                 1.824593e-02 1 1  ON 29
eH1_0                -1.795775e-01 1 1  ON 30
eH1_1                -1.015517e-01 1 1  ON 31
eH1_2                -6.242319e-02 1 1  ON 32
eH1_3                -2.645647e-02 1 1  ON 33
eH1_4                 1.902594e-02 1 1  ON 34
eH1_5                 3.382924e-02 1 1  ON 35
eH1_6                 7.732233e-02 1 1  ON 36
eH1_7                 1.105758e-01 1 1  ON 37
eH1_8                 9.017335e-02 1 1  ON 38
eH1_9                 2.396930e-02 1 1  ON 39
eH2_0                -1.807683e-01 1 1  ON 40
eH2_1                -1.026832e-01 1 1  ON 41
eH2_2                -6.355506e-02 1 1  ON 42
eH2_3                -2.753566e-02 1 1  ON 43
eH2_4                 1.832811e-02 1 1  ON 44
eH2_5                 3.361764e-02 1 1  ON 45
eH2_6                 7.835167e-02 1 1  ON 46
eH2_7                 1.136255e-01 1 1  ON 47
eH2_8                 9.267693e-02 1 1  ON 48
eH2_9                 2.599089e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1585
    reference variance = 0.175048
====================================================
  Execution time = 3.4146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1546e-01
  Total weights = 2.0000e+06
  Execution time = 3.1003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315481788394
                                         uncertainty =       0.004639149983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315481788394
                                         uncertainty =       0.004639149983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397117950
  error estimate for blocks of size 2^( 2) =       0.000407429905
  error estimate for blocks of size 2^( 3) =       0.000416134074
  error estimate for blocks of size 2^( 4) =       0.000422689920
  error estimate for blocks of size 2^( 5) =       0.000426798486
  error estimate for blocks of size 2^( 6) =       0.000429431905
  error estimate for blocks of size 2^( 7) =       0.000431571937

      target function =                  N/A
              le_mean =     -17.216019266855
             les_mean =     296.706724570973
             stat err =       0.000427623062
             autocorr =       1.159533239342
              std dev =       0.561609590338
             le_variance =       0.315405331959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315690229317
                                         uncertainty =       0.004643038598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315690229317
                                         uncertainty =       0.004643038598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397249062
  error estimate for blocks of size 2^( 2) =       0.000407551853
  error estimate for blocks of size 2^( 3) =       0.000416247269
  error estimate for blocks of size 2^( 4) =       0.000422798823
  error estimate for blocks of size 2^( 5) =       0.000426904115
  error estimate for blocks of size 2^( 6) =       0.000429535702
  error estimate for blocks of size 2^( 7) =       0.000431682519

      target function =                  N/A
              le_mean =     -17.216020372350
             les_mean =     296.706970937682
             stat err =       0.000427730290
             autocorr =       1.159349158746
              std dev =       0.561795010942
             le_variance =       0.315613634319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315595683571
                                         uncertainty =       0.004641205460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315595683571
                                         uncertainty =       0.004641205460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397189597
  error estimate for blocks of size 2^( 2) =       0.000407496545
  error estimate for blocks of size 2^( 3) =       0.000416195940
  error estimate for blocks of size 2^( 4) =       0.000422749523
  error estimate for blocks of size 2^( 5) =       0.000426856538
  error estimate for blocks of size 2^( 6) =       0.000429488935
  error estimate for blocks of size 2^( 7) =       0.000431632610

      target function =                  N/A
              le_mean =     -17.216019865302
             les_mean =     296.706858996662
             stat err =       0.000427681901
             autocorr =       1.159433952767
              std dev =       0.561710914922
             le_variance =       0.315519151943

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315496335777
                                         uncertainty =       0.004639409724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315496335777
                                         uncertainty =       0.004639409724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397127102
  error estimate for blocks of size 2^( 2) =       0.000407438416
  error estimate for blocks of size 2^( 3) =       0.000416141972
  error estimate for blocks of size 2^( 4) =       0.000422697532
  error estimate for blocks of size 2^( 5) =       0.000426805909
  error estimate for blocks of size 2^( 6) =       0.000429439197
  error estimate for blocks of size 2^( 7) =       0.000431579683

      target function =                  N/A
              le_mean =     -17.216019339112
             les_mean =     296.706741596759
             stat err =       0.000427630580
             autocorr =       1.159520567978
              std dev =       0.561622533187
             le_variance =       0.315419869784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216019266855        initial
     1.5259e+00     1.5259e+01             8.0714e-04       -17.216020372350  <--
     6.1035e+00     6.1035e+01             2.0867e-04       -17.216019865302
     2.4414e+01     2.4414e+02             5.2612e-05       -17.216019339112

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 4.9788e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.047033e-01 1 1  ON 0
 uu_1                 4.470025e-02 1 1  ON 1
 uu_2                -4.709902e-02 1 1  ON 2
 uu_3                -9.919708e-02 1 1  ON 3
 uu_4                -1.298968e-01 1 1  ON 4
 uu_5                -1.349828e-01 1 1  ON 5
 uu_6                -1.122567e-01 1 1  ON 6
 uu_7                -3.740710e-02 1 1  ON 7
 uu_8                 1.002878e-01 1 1  ON 8
 uu_9                 1.196892e-01 1 1  ON 9
 ud_0                 3.411519e-01 1 1  ON 10
 ud_1                 8.708067e-02 1 1  ON 11
 ud_2                -1.539107e-02 1 1  ON 12
 ud_3                -7.097045e-02 1 1  ON 13
 ud_4                -1.167803e-01 1 1  ON 14
 ud_5                -1.491536e-01 1 1  ON 15
 ud_6                -1.548823e-01 1 1  ON 16
 ud_7                -1.102844e-01 1 1  ON 17
 ud_8                 5.405655e-03 1 1  ON 18
 ud_9                 9.226256e-02 1 1  ON 19
 eO_0                -7.337106e-01 1 1  ON 20
 eO_1                -4.266521e-01 1 1  ON 21
 eO_2                -3.954358e-02 1 1  ON 22
 eO_3                 1.966203e-01 1 1  ON 23
 eO_4                 2.810754e-01 1 1  ON 24
 eO_5                 3.059939e-01 1 1  ON 25
 eO_6                 2.491514e-01 1 1  ON 26
 eO_7                 1.107917e-01 1 1  ON 27
 eO_8                 2.755696e-02 1 1  ON 28
 eO_9                 1.825129e-02 1 1  ON 29
eH1_0                -1.796390e-01 1 1  ON 30
eH1_1                -1.015618e-01 1 1  ON 31
eH1_2                -6.241370e-02 1 1  ON 32
eH1_3                -2.650646e-02 1 1  ON 33
eH1_4                 1.904830e-02 1 1  ON 34
eH1_5                 3.388260e-02 1 1  ON 35
eH1_6                 7.734617e-02 1 1  ON 36
eH1_7                 1.105539e-01 1 1  ON 37
eH1_8                 9.019441e-02 1 1  ON 38
eH1_9                 2.397698e-02 1 1  ON 39
eH2_0                -1.808447e-01 1 1  ON 40
eH2_1                -1.027306e-01 1 1  ON 41
eH2_2                -6.354614e-02 1 1  ON 42
eH2_3                -2.751187e-02 1 1  ON 43
eH2_4                 1.830925e-02 1 1  ON 44
eH2_5                 3.368899e-02 1 1  ON 45
eH2_6                 7.834528e-02 1 1  ON 46
eH2_7                 1.136225e-01 1 1  ON 47
eH2_8                 9.271085e-02 1 1  ON 48
eH2_9                 2.599915e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4245e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2237
    reference variance = 0.229603
====================================================
  Execution time = 3.6229e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2558e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325668014405
                                         uncertainty =       0.005887295838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325668014405
                                         uncertainty =       0.005887295838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403473609
  error estimate for blocks of size 2^( 2) =       0.000413094720
  error estimate for blocks of size 2^( 3) =       0.000422013306
  error estimate for blocks of size 2^( 4) =       0.000427865282
  error estimate for blocks of size 2^( 5) =       0.000432615846
  error estimate for blocks of size 2^( 6) =       0.000436297799
  error estimate for blocks of size 2^( 7) =       0.000436909208

      target function =                  N/A
              le_mean =     -17.216985868523
             les_mean =     296.750184141158
             stat err =       0.000433422034
             autocorr =       1.153962524033
              std dev =       0.570597850518
             le_variance =       0.325581907016


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721698586852e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216985868523       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216986969198       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216990901533       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216996045788       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216996367449       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216998097353       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216997866738       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216997627917       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216997640354       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216997646995       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216997748459       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 2.962651e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216985868523       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216986217833       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216987661169       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216989118160       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216989119232       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216989537163       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216989479721       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216989454485       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216989429103       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 8.484168e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216985868523       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216985962158       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216986369000       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216986740108       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216986737197       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216986840596       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216986830920       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216986827670       residual = 5.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.220114e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.375860 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5541e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.048543e-01 1 1  ON 0
 uu_1                 4.484353e-02 1 1  ON 1
 uu_2                -4.709785e-02 1 1  ON 2
 uu_3                -9.925722e-02 1 1  ON 3
 uu_4                -1.300071e-01 1 1  ON 4
 uu_5                -1.351343e-01 1 1  ON 5
 uu_6                -1.122518e-01 1 1  ON 6
 uu_7                -3.744238e-02 1 1  ON 7
 uu_8                 1.002606e-01 1 1  ON 8
 uu_9                 1.197342e-01 1 1  ON 9
 ud_0                 3.413447e-01 1 1  ON 10
 ud_1                 8.719504e-02 1 1  ON 11
 ud_2                -1.540566e-02 1 1  ON 12
 ud_3                -7.109386e-02 1 1  ON 13
 ud_4                -1.169180e-01 1 1  ON 14
 ud_5                -1.492819e-01 1 1  ON 15
 ud_6                -1.547742e-01 1 1  ON 16
 ud_7                -1.102589e-01 1 1  ON 17
 ud_8                 5.341643e-03 1 1  ON 18
 ud_9                 9.225923e-02 1 1  ON 19
 eO_0                -7.345590e-01 1 1  ON 20
 eO_1                -4.269726e-01 1 1  ON 21
 eO_2                -3.943898e-02 1 1  ON 22
 eO_3                 1.970614e-01 1 1  ON 23
 eO_4                 2.814826e-01 1 1  ON 24
 eO_5                 3.060248e-01 1 1  ON 25
 eO_6                 2.492259e-01 1 1  ON 26
 eO_7                 1.108838e-01 1 1  ON 27
 eO_8                 2.757049e-02 1 1  ON 28
 eO_9                 1.825417e-02 1 1  ON 29
eH1_0                -1.797790e-01 1 1  ON 30
eH1_1                -1.015754e-01 1 1  ON 31
eH1_2                -6.238956e-02 1 1  ON 32
eH1_3                -2.649613e-02 1 1  ON 33
eH1_4                 1.911315e-02 1 1  ON 34
eH1_5                 3.390680e-02 1 1  ON 35
eH1_6                 7.731038e-02 1 1  ON 36
eH1_7                 1.105399e-01 1 1  ON 37
eH1_8                 9.025314e-02 1 1  ON 38
eH1_9                 2.399483e-02 1 1  ON 39
eH2_0                -1.809392e-01 1 1  ON 40
eH2_1                -1.028315e-01 1 1  ON 41
eH2_2                -6.348947e-02 1 1  ON 42
eH2_3                -2.756706e-02 1 1  ON 43
eH2_4                 1.832045e-02 1 1  ON 44
eH2_5                 3.374545e-02 1 1  ON 45
eH2_6                 7.838313e-02 1 1  ON 46
eH2_7                 1.136407e-01 1 1  ON 47
eH2_8                 9.276537e-02 1 1  ON 48
eH2_9                 2.601186e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1992
    reference variance = 0.303039
====================================================
  Execution time = 3.4119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2051e-01
  Total weights = 2.0000e+06
  Execution time = 3.1127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320243763257
                                         uncertainty =       0.004654403184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320243763257
                                         uncertainty =       0.004654403184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400196931
  error estimate for blocks of size 2^( 2) =       0.000409929475
  error estimate for blocks of size 2^( 3) =       0.000418720192
  error estimate for blocks of size 2^( 4) =       0.000426126663
  error estimate for blocks of size 2^( 5) =       0.000429953355
  error estimate for blocks of size 2^( 6) =       0.000431347741
  error estimate for blocks of size 2^( 7) =       0.000429812657

      target function =                  N/A
              le_mean =     -17.216427210301
             les_mean =     296.725680895292
             stat err =       0.000429310104
             autocorr =       1.150786373896
              std dev =       0.565963928059
             le_variance =       0.320315167864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320886606960
                                         uncertainty =       0.004672582308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320886606960
                                         uncertainty =       0.004672582308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400598200
  error estimate for blocks of size 2^( 2) =       0.000410301117
  error estimate for blocks of size 2^( 3) =       0.000419065024
  error estimate for blocks of size 2^( 4) =       0.000426457264
  error estimate for blocks of size 2^( 5) =       0.000430276069
  error estimate for blocks of size 2^( 6) =       0.000431645374
  error estimate for blocks of size 2^( 7) =       0.000430112956

      target function =                  N/A
              le_mean =     -17.216428190552
             les_mean =     296.726357315237
             stat err =       0.000429622916
             autocorr =       1.150156372944
              std dev =       0.566531407133
             le_variance =       0.320957835268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628620574
                                         uncertainty =       0.004665291599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628620574
                                         uncertainty =       0.004665291599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400437208
  error estimate for blocks of size 2^( 2) =       0.000410151777
  error estimate for blocks of size 2^( 3) =       0.000418926737
  error estimate for blocks of size 2^( 4) =       0.000426324996
  error estimate for blocks of size 2^( 5) =       0.000430147220
  error estimate for blocks of size 2^( 6) =       0.000431526344
  error estimate for blocks of size 2^( 7) =       0.000429992954

      target function =                  N/A
              le_mean =     -17.216427487022
             les_mean =     296.726075170855
             stat err =       0.000429497879
             autocorr =       1.150411453072
              std dev =       0.566303730635
             le_variance =       0.320699915332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294682653
                                         uncertainty =       0.004655838662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320294682653
                                         uncertainty =       0.004655838662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400228730
  error estimate for blocks of size 2^( 2) =       0.000409958832
  error estimate for blocks of size 2^( 3) =       0.000418747434
  error estimate for blocks of size 2^( 4) =       0.000426152821
  error estimate for blocks of size 2^( 5) =       0.000429978959
  error estimate for blocks of size 2^( 6) =       0.000431371302
  error estimate for blocks of size 2^( 7) =       0.000429836433

      target function =                  N/A
              le_mean =     -17.216427194274
             les_mean =     296.725731248279
             stat err =       0.000429334879
             autocorr =       1.150736321900
              std dev =       0.566008898082
             le_variance =       0.320366072708


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216427210301        initial
     3.8147e-01     3.8147e+00             2.9627e-03       -17.216428190552  <--
     1.5259e+00     1.5259e+01             8.4842e-04       -17.216427487022
     6.1035e+00     6.1035e+01             2.2201e-04       -17.216427194274

*****************************************************************************
Applying the update for shift_i =   3.8147e-01     and shift_s =   3.8147e+00
*****************************************************************************

  Execution time = 4.9805e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.053231e-01 1 1  ON 0
 uu_1                 4.518549e-02 1 1  ON 1
 uu_2                -4.704339e-02 1 1  ON 2
 uu_3                -9.940517e-02 1 1  ON 3
 uu_4                -1.303135e-01 1 1  ON 4
 uu_5                -1.355575e-01 1 1  ON 5
 uu_6                -1.122937e-01 1 1  ON 6
 uu_7                -3.755952e-02 1 1  ON 7
 uu_8                 1.001783e-01 1 1  ON 8
 uu_9                 1.198701e-01 1 1  ON 9
 ud_0                 3.418168e-01 1 1  ON 10
 ud_1                 8.748049e-02 1 1  ON 11
 ud_2                -1.539794e-02 1 1  ON 12
 ud_3                -7.135071e-02 1 1  ON 13
 ud_4                -1.172767e-01 1 1  ON 14
 ud_5                -1.496276e-01 1 1  ON 15
 ud_6                -1.545394e-01 1 1  ON 16
 ud_7                -1.101913e-01 1 1  ON 17
 ud_8                 5.152429e-03 1 1  ON 18
 ud_9                 9.224935e-02 1 1  ON 19
 eO_0                -7.366732e-01 1 1  ON 20
 eO_1                -4.279736e-01 1 1  ON 21
 eO_2                -3.932359e-02 1 1  ON 22
 eO_3                 1.981407e-01 1 1  ON 23
 eO_4                 2.827112e-01 1 1  ON 24
 eO_5                 3.061592e-01 1 1  ON 25
 eO_6                 2.494496e-01 1 1  ON 26
 eO_7                 1.111619e-01 1 1  ON 27
 eO_8                 2.761160e-02 1 1  ON 28
 eO_9                 1.826291e-02 1 1  ON 29
eH1_0                -1.801153e-01 1 1  ON 30
eH1_1                -1.016556e-01 1 1  ON 31
eH1_2                -6.231513e-02 1 1  ON 32
eH1_3                -2.645368e-02 1 1  ON 33
eH1_4                 1.924136e-02 1 1  ON 34
eH1_5                 3.396914e-02 1 1  ON 35
eH1_6                 7.721919e-02 1 1  ON 36
eH1_7                 1.104991e-01 1 1  ON 37
eH1_8                 9.043021e-02 1 1  ON 38
eH1_9                 2.404882e-02 1 1  ON 39
eH2_0                -1.811955e-01 1 1  ON 40
eH2_1                -1.030722e-01 1 1  ON 41
eH2_2                -6.340340e-02 1 1  ON 42
eH2_3                -2.767977e-02 1 1  ON 43
eH2_4                 1.831757e-02 1 1  ON 44
eH2_5                 3.387819e-02 1 1  ON 45
eH2_6                 7.850737e-02 1 1  ON 46
eH2_7                 1.136981e-01 1 1  ON 47
eH2_8                 9.292999e-02 1 1  ON 48
eH2_9                 2.605034e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5351e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1329
    reference variance = 0.496784
====================================================
  Execution time = 3.5133e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1738e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2775e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317377158786
                                         uncertainty =       0.003193481216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317377158786
                                         uncertainty =       0.003193481216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398358271
  error estimate for blocks of size 2^( 2) =       0.000407772732
  error estimate for blocks of size 2^( 3) =       0.000416658290
  error estimate for blocks of size 2^( 4) =       0.000422479142
  error estimate for blocks of size 2^( 5) =       0.000425480375
  error estimate for blocks of size 2^( 6) =       0.000426797423
  error estimate for blocks of size 2^( 7) =       0.000427243195

      target function =                  N/A
              le_mean =     -17.216121187182
             les_mean =     296.712207196892
             stat err =       0.000425500033
             autocorr =       1.140910350568
              std dev =       0.563363669260
             le_variance =       0.317378623842


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721612118718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216121187182       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216124681574       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216123376862       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216128872158       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216136481887       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216132992836       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216136218536       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216138209737       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216138733578       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216139548816       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216140015041       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216140051088       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216140092039       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 7.072058e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216121187182       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216122836380       residual = 7.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216121458629       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216123228980       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216127016892       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216125822832       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216126410954       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216126511745       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216126515480       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216126632474       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 2.235865e-03

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216121187182       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216121717100       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216121077448       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216121504664       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216122714624       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216122511659       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216122447607       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216122488597       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 6.084805e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.380057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4423e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.061878e-01 1 1  ON 0
 uu_1                 4.553073e-02 1 1  ON 1
 uu_2                -4.688313e-02 1 1  ON 2
 uu_3                -9.945419e-02 1 1  ON 3
 uu_4                -1.307127e-01 1 1  ON 4
 uu_5                -1.357218e-01 1 1  ON 5
 uu_6                -1.125769e-01 1 1  ON 6
 uu_7                -3.800190e-02 1 1  ON 7
 uu_8                 9.989495e-02 1 1  ON 8
 uu_9                 1.199698e-01 1 1  ON 9
 ud_0                 3.424226e-01 1 1  ON 10
 ud_1                 8.799975e-02 1 1  ON 11
 ud_2                -1.519100e-02 1 1  ON 12
 ud_3                -7.160548e-02 1 1  ON 13
 ud_4                -1.177829e-01 1 1  ON 14
 ud_5                -1.498741e-01 1 1  ON 15
 ud_6                -1.543589e-01 1 1  ON 16
 ud_7                -1.104306e-01 1 1  ON 17
 ud_8                 4.764777e-03 1 1  ON 18
 ud_9                 9.222982e-02 1 1  ON 19
 eO_0                -7.389091e-01 1 1  ON 20
 eO_1                -4.294157e-01 1 1  ON 21
 eO_2                -3.942873e-02 1 1  ON 22
 eO_3                 1.994406e-01 1 1  ON 23
 eO_4                 2.842673e-01 1 1  ON 24
 eO_5                 3.066499e-01 1 1  ON 25
 eO_6                 2.496116e-01 1 1  ON 26
 eO_7                 1.113798e-01 1 1  ON 27
 eO_8                 2.763760e-02 1 1  ON 28
 eO_9                 1.827548e-02 1 1  ON 29
eH1_0                -1.804582e-01 1 1  ON 30
eH1_1                -1.018419e-01 1 1  ON 31
eH1_2                -6.238470e-02 1 1  ON 32
eH1_3                -2.658174e-02 1 1  ON 33
eH1_4                 1.930538e-02 1 1  ON 34
eH1_5                 3.426369e-02 1 1  ON 35
eH1_6                 7.731451e-02 1 1  ON 36
eH1_7                 1.105042e-01 1 1  ON 37
eH1_8                 9.061504e-02 1 1  ON 38
eH1_9                 2.410991e-02 1 1  ON 39
eH2_0                -1.813328e-01 1 1  ON 40
eH2_1                -1.029534e-01 1 1  ON 41
eH2_2                -6.351641e-02 1 1  ON 42
eH2_3                -2.757957e-02 1 1  ON 43
eH2_4                 1.829914e-02 1 1  ON 44
eH2_5                 3.387519e-02 1 1  ON 45
eH2_6                 7.848231e-02 1 1  ON 46
eH2_7                 1.135977e-01 1 1  ON 47
eH2_8                 9.305609e-02 1 1  ON 48
eH2_9                 2.608187e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1706
    reference variance = 0.874113
====================================================
  Execution time = 3.4065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3120e-01
  Total weights = 2.0000e+06
  Execution time = 3.0858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330698770017
                                         uncertainty =       0.015932758069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330698770017
                                         uncertainty =       0.015932758069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406753945
  error estimate for blocks of size 2^( 2) =       0.000416403214
  error estimate for blocks of size 2^( 3) =       0.000424532982
  error estimate for blocks of size 2^( 4) =       0.000430860463
  error estimate for blocks of size 2^( 5) =       0.000435052723
  error estimate for blocks of size 2^( 6) =       0.000437094424
  error estimate for blocks of size 2^( 7) =       0.000436477103

      target function =                  N/A
              le_mean =     -17.216375685770
             les_mean =     296.734489131803
             stat err =       0.000434871178
             autocorr =       1.143030193561
              std dev =       0.575236945679
             le_variance =       0.330897543674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331624535543
                                         uncertainty =       0.015623547603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331624535543
                                         uncertainty =       0.015623547603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407323430
  error estimate for blocks of size 2^( 2) =       0.000416929379
  error estimate for blocks of size 2^( 3) =       0.000424996611
  error estimate for blocks of size 2^( 4) =       0.000431272535
  error estimate for blocks of size 2^( 5) =       0.000435453706
  error estimate for blocks of size 2^( 6) =       0.000437492472
  error estimate for blocks of size 2^( 7) =       0.000436878902

      target function =                  N/A
              le_mean =     -17.216370212368
             les_mean =     296.735227876573
             stat err =       0.000435274404
             autocorr =       1.141951013626
              std dev =       0.576042318897
             le_variance =       0.331824753160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331324213535
                                         uncertainty =       0.015639725977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331324213535
                                         uncertainty =       0.015639725977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407138915
  error estimate for blocks of size 2^( 2) =       0.000416759737
  error estimate for blocks of size 2^( 3) =       0.000424845593
  error estimate for blocks of size 2^( 4) =       0.000431135751
  error estimate for blocks of size 2^( 5) =       0.000435320782
  error estimate for blocks of size 2^( 6) =       0.000437359546
  error estimate for blocks of size 2^( 7) =       0.000436738825

      target function =                  N/A
              le_mean =     -17.216370122748
             les_mean =     296.734924230130
             stat err =       0.000435138726
             autocorr =       1.142273867139
              std dev =       0.575781375573
             le_variance =       0.331524192456

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330769797046
                                         uncertainty =       0.015880354349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330769797046
                                         uncertainty =       0.015880354349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406797715
  error estimate for blocks of size 2^( 2) =       0.000416443144
  error estimate for blocks of size 2^( 3) =       0.000424566716
  error estimate for blocks of size 2^( 4) =       0.000430888831
  error estimate for blocks of size 2^( 5) =       0.000435080076
  error estimate for blocks of size 2^( 6) =       0.000437121162
  error estimate for blocks of size 2^( 7) =       0.000436502888

      target function =                  N/A
              le_mean =     -17.216374230961
             les_mean =     296.734510257281
             stat err =       0.000434898239
             autocorr =       1.142926464056
              std dev =       0.575298846047
             le_variance =       0.330968762263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216375685770        initial  <--
     9.5367e-02     9.5367e-01             7.0721e-03       -17.216370212368
     3.8147e-01     3.8147e+00             2.2359e-03       -17.216370122748
     1.5259e+00     1.5259e+01             6.0848e-04       -17.216374230961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.6293
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.053231e-01 1 1  ON 0
 uu_1                 4.518549e-02 1 1  ON 1
 uu_2                -4.704339e-02 1 1  ON 2
 uu_3                -9.940517e-02 1 1  ON 3
 uu_4                -1.303135e-01 1 1  ON 4
 uu_5                -1.355575e-01 1 1  ON 5
 uu_6                -1.122937e-01 1 1  ON 6
 uu_7                -3.755952e-02 1 1  ON 7
 uu_8                 1.001783e-01 1 1  ON 8
 uu_9                 1.198701e-01 1 1  ON 9
 ud_0                 3.418168e-01 1 1  ON 10
 ud_1                 8.748049e-02 1 1  ON 11
 ud_2                -1.539794e-02 1 1  ON 12
 ud_3                -7.135071e-02 1 1  ON 13
 ud_4                -1.172767e-01 1 1  ON 14
 ud_5                -1.496276e-01 1 1  ON 15
 ud_6                -1.545394e-01 1 1  ON 16
 ud_7                -1.101913e-01 1 1  ON 17
 ud_8                 5.152429e-03 1 1  ON 18
 ud_9                 9.224935e-02 1 1  ON 19
 eO_0                -7.366732e-01 1 1  ON 20
 eO_1                -4.279736e-01 1 1  ON 21
 eO_2                -3.932359e-02 1 1  ON 22
 eO_3                 1.981407e-01 1 1  ON 23
 eO_4                 2.827112e-01 1 1  ON 24
 eO_5                 3.061592e-01 1 1  ON 25
 eO_6                 2.494496e-01 1 1  ON 26
 eO_7                 1.111619e-01 1 1  ON 27
 eO_8                 2.761160e-02 1 1  ON 28
 eO_9                 1.826291e-02 1 1  ON 29
eH1_0                -1.801153e-01 1 1  ON 30
eH1_1                -1.016556e-01 1 1  ON 31
eH1_2                -6.231513e-02 1 1  ON 32
eH1_3                -2.645368e-02 1 1  ON 33
eH1_4                 1.924136e-02 1 1  ON 34
eH1_5                 3.396914e-02 1 1  ON 35
eH1_6                 7.721919e-02 1 1  ON 36
eH1_7                 1.104991e-01 1 1  ON 37
eH1_8                 9.043021e-02 1 1  ON 38
eH1_9                 2.404882e-02 1 1  ON 39
eH2_0                -1.811955e-01 1 1  ON 40
eH2_1                -1.030722e-01 1 1  ON 41
eH2_2                -6.340340e-02 1 1  ON 42
eH2_3                -2.767977e-02 1 1  ON 43
eH2_4                 1.831757e-02 1 1  ON 44
eH2_5                 3.387819e-02 1 1  ON 45
eH2_6                 7.850737e-02 1 1  ON 46
eH2_7                 1.136981e-01 1 1  ON 47
eH2_8                 9.292999e-02 1 1  ON 48
eH2_9                 2.605034e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4062e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2341
    reference variance = 0.254226
====================================================
  Execution time = 3.4997e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1945e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418136058
                                         uncertainty =       0.004607443204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319418136058
                                         uncertainty =       0.004607443204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399653652
  error estimate for blocks of size 2^( 2) =       0.000409456473
  error estimate for blocks of size 2^( 3) =       0.000418155439
  error estimate for blocks of size 2^( 4) =       0.000424471709
  error estimate for blocks of size 2^( 5) =       0.000427991193
  error estimate for blocks of size 2^( 6) =       0.000429633889
  error estimate for blocks of size 2^( 7) =       0.000433283227

      target function =                  N/A
              le_mean =     -17.215951717501
             les_mean =     296.708439462790
             stat err =       0.000428845004
             autocorr =       1.151418329603
              std dev =       0.565195614986
             le_variance =       0.319446083200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721595171750e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951717501       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215953064891       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215954768673       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215955962634       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215955928982       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215956122105       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215956501571       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215956429231       residual = 9.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 8.854704e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951717501       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215952096272       residual = 5.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215952634209       residual = 8.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215952893362       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215952886163       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215952960557       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215952995851       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 2.242953e-04

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215951717501       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215951815234       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215951959117       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215952020242       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215952017876       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215952040177       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215952042064       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 5.616741e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382505 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4226e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.054200e-01 1 1  ON 0
 uu_1                 4.520560e-02 1 1  ON 1
 uu_2                -4.703845e-02 1 1  ON 2
 uu_3                -9.944145e-02 1 1  ON 3
 uu_4                -1.303703e-01 1 1  ON 4
 uu_5                -1.355759e-01 1 1  ON 5
 uu_6                -1.123048e-01 1 1  ON 6
 uu_7                -3.758017e-02 1 1  ON 7
 uu_8                 1.001658e-01 1 1  ON 8
 uu_9                 1.198871e-01 1 1  ON 9
 ud_0                 3.418701e-01 1 1  ON 10
 ud_1                 8.754534e-02 1 1  ON 11
 ud_2                -1.536600e-02 1 1  ON 12
 ud_3                -7.139304e-02 1 1  ON 13
 ud_4                -1.173301e-01 1 1  ON 14
 ud_5                -1.496606e-01 1 1  ON 15
 ud_6                -1.545470e-01 1 1  ON 16
 ud_7                -1.102009e-01 1 1  ON 17
 ud_8                 5.128056e-03 1 1  ON 18
 ud_9                 9.225247e-02 1 1  ON 19
 eO_0                -7.368975e-01 1 1  ON 20
 eO_1                -4.281516e-01 1 1  ON 21
 eO_2                -3.932217e-02 1 1  ON 22
 eO_3                 1.982977e-01 1 1  ON 23
 eO_4                 2.828719e-01 1 1  ON 24
 eO_5                 3.061777e-01 1 1  ON 25
 eO_6                 2.494693e-01 1 1  ON 26
 eO_7                 1.111974e-01 1 1  ON 27
 eO_8                 2.761731e-02 1 1  ON 28
 eO_9                 1.826505e-02 1 1  ON 29
eH1_0                -1.801378e-01 1 1  ON 30
eH1_1                -1.016912e-01 1 1  ON 31
eH1_2                -6.231379e-02 1 1  ON 32
eH1_3                -2.645659e-02 1 1  ON 33
eH1_4                 1.924171e-02 1 1  ON 34
eH1_5                 3.399840e-02 1 1  ON 35
eH1_6                 7.722644e-02 1 1  ON 36
eH1_7                 1.104934e-01 1 1  ON 37
eH1_8                 9.045075e-02 1 1  ON 38
eH1_9                 2.405529e-02 1 1  ON 39
eH2_0                -1.812052e-01 1 1  ON 40
eH2_1                -1.031150e-01 1 1  ON 41
eH2_2                -6.340524e-02 1 1  ON 42
eH2_3                -2.765785e-02 1 1  ON 43
eH2_4                 1.832473e-02 1 1  ON 44
eH2_5                 3.388563e-02 1 1  ON 45
eH2_6                 7.851052e-02 1 1  ON 46
eH2_7                 1.136895e-01 1 1  ON 47
eH2_8                 9.294633e-02 1 1  ON 48
eH2_9                 2.605511e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1883
    reference variance = 0.340251
====================================================
  Execution time = 3.4043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.5278e-01
  Total weights = 2.0000e+06
  Execution time = 3.0922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352856072793
                                         uncertainty =       0.022362074896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352856072793
                                         uncertainty =       0.022362074896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419972820
  error estimate for blocks of size 2^( 2) =       0.000429378169
  error estimate for blocks of size 2^( 3) =       0.000438043108
  error estimate for blocks of size 2^( 4) =       0.000443675065
  error estimate for blocks of size 2^( 5) =       0.000447750272
  error estimate for blocks of size 2^( 6) =       0.000449134743
  error estimate for blocks of size 2^( 7) =       0.000449992357

      target function =                  N/A
              le_mean =     -17.215903767129
             les_mean =     296.740096681985
             stat err =       0.000447638110
             autocorr =       1.136087382888
              std dev =       0.593931258077
             le_variance =       0.352754339321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352993276720
                                         uncertainty =       0.022350059536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352993276720
                                         uncertainty =       0.022350059536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420054494
  error estimate for blocks of size 2^( 2) =       0.000429453769
  error estimate for blocks of size 2^( 3) =       0.000438111146
  error estimate for blocks of size 2^( 4) =       0.000443737240
  error estimate for blocks of size 2^( 5) =       0.000447808849
  error estimate for blocks of size 2^( 6) =       0.000449190813
  error estimate for blocks of size 2^( 7) =       0.000450043984

      target function =                  N/A
              le_mean =     -17.215904058797
             les_mean =     296.740243941604
             stat err =       0.000447695221
             autocorr =       1.135935432042
              std dev =       0.594046762758
             le_variance =       0.352891556343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352910419138
                                         uncertainty =       0.022353437604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352910419138
                                         uncertainty =       0.022353437604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420005178
  error estimate for blocks of size 2^( 2) =       0.000429407868
  error estimate for blocks of size 2^( 3) =       0.000438069086
  error estimate for blocks of size 2^( 4) =       0.000443698206
  error estimate for blocks of size 2^( 5) =       0.000447771666
  error estimate for blocks of size 2^( 6) =       0.000449154495
  error estimate for blocks of size 2^( 7) =       0.000450009989

      target function =                  N/A
              le_mean =     -17.215903712107
             les_mean =     296.740149147357
             stat err =       0.000447658589
             autocorr =       1.136016276109
              std dev =       0.593977019108
             le_variance =       0.352808699228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352862139424
                                         uncertainty =       0.022360869125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352862139424
                                         uncertainty =       0.022360869125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419976433
  error estimate for blocks of size 2^( 2) =       0.000429381469
  error estimate for blocks of size 2^( 3) =       0.000438045948
  error estimate for blocks of size 2^( 4) =       0.000443677554
  error estimate for blocks of size 2^( 5) =       0.000447752543
  error estimate for blocks of size 2^( 6) =       0.000449136789
  error estimate for blocks of size 2^( 7) =       0.000449994139

      target function =                  N/A
              le_mean =     -17.215903743637
             les_mean =     296.740101941826
             stat err =       0.000447640256
             autocorr =       1.136078734636
              std dev =       0.593936366991
             le_variance =       0.352760408035


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215903767129        initial
     9.5367e-01     9.5367e+00             8.8547e-04       -17.215904058797  <--
     3.8147e+00     3.8147e+01             2.2430e-04       -17.215903712107
     1.5259e+01     1.5259e+02             5.6167e-05       -17.215903743637

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 4.9640e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3872e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2725
    reference variance = 0.354312
====================================================
  Execution time = 3.6692e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1953e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319522009846
                                         uncertainty =       0.003469742668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319522009846
                                         uncertainty =       0.003469742668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399703331
  error estimate for blocks of size 2^( 2) =       0.000409581622
  error estimate for blocks of size 2^( 3) =       0.000417987461
  error estimate for blocks of size 2^( 4) =       0.000424534174
  error estimate for blocks of size 2^( 5) =       0.000428030526
  error estimate for blocks of size 2^( 6) =       0.000431410966
  error estimate for blocks of size 2^( 7) =       0.000430484814

      target function =                  N/A
              le_mean =     -17.216191367904
             les_mean =     296.716770561734
             stat err =       0.000428615120
             autocorr =       1.149898321761
              std dev =       0.565265871253
             le_variance =       0.319525505204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721619136790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216191367904       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216192359548       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216198048130       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216198104183       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216199323434       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216198842031       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216198269309       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216198632443       residual = 6.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216198880478       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216198928246       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 3.229689e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216191367904       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216191725389       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216193976356       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216193761796       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216194013033       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216193750292       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216193684244       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216193719025       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216193699500       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 9.125071e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216191367904       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216191468377       residual = 8.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216192130253       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216192054132       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216192112265       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216192030918       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216192045270       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216192027725       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 2.369821e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.385693 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5922e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.059582e-01 1 1  ON 0
 uu_1                 4.542703e-02 1 1  ON 1
 uu_2                -4.697952e-02 1 1  ON 2
 uu_3                -9.956366e-02 1 1  ON 3
 uu_4                -1.307471e-01 1 1  ON 4
 uu_5                -1.357567e-01 1 1  ON 5
 uu_6                -1.124021e-01 1 1  ON 6
 uu_7                -3.782193e-02 1 1  ON 7
 uu_8                 1.000423e-01 1 1  ON 8
 uu_9                 1.200196e-01 1 1  ON 9
 ud_0                 3.422919e-01 1 1  ON 10
 ud_1                 8.781772e-02 1 1  ON 11
 ud_2                -1.522733e-02 1 1  ON 12
 ud_3                -7.161486e-02 1 1  ON 13
 ud_4                -1.177173e-01 1 1  ON 14
 ud_5                -1.498992e-01 1 1  ON 15
 ud_6                -1.544796e-01 1 1  ON 16
 ud_7                -1.102296e-01 1 1  ON 17
 ud_8                 4.921158e-03 1 1  ON 18
 ud_9                 9.226412e-02 1 1  ON 19
 eO_0                -7.384712e-01 1 1  ON 20
 eO_1                -4.291869e-01 1 1  ON 21
 eO_2                -3.947775e-02 1 1  ON 22
 eO_3                 1.992861e-01 1 1  ON 23
 eO_4                 2.839653e-01 1 1  ON 24
 eO_5                 3.063995e-01 1 1  ON 25
 eO_6                 2.496186e-01 1 1  ON 26
 eO_7                 1.114249e-01 1 1  ON 27
 eO_8                 2.765337e-02 1 1  ON 28
 eO_9                 1.828801e-02 1 1  ON 29
eH1_0                -1.803112e-01 1 1  ON 30
eH1_1                -1.018809e-01 1 1  ON 31
eH1_2                -6.235779e-02 1 1  ON 32
eH1_3                -2.647482e-02 1 1  ON 33
eH1_4                 1.924226e-02 1 1  ON 34
eH1_5                 3.421721e-02 1 1  ON 35
eH1_6                 7.727923e-02 1 1  ON 36
eH1_7                 1.104543e-01 1 1  ON 37
eH1_8                 9.057491e-02 1 1  ON 38
eH1_9                 2.410601e-02 1 1  ON 39
eH2_0                -1.813420e-01 1 1  ON 40
eH2_1                -1.032624e-01 1 1  ON 41
eH2_2                -6.352222e-02 1 1  ON 42
eH2_3                -2.756958e-02 1 1  ON 43
eH2_4                 1.832139e-02 1 1  ON 44
eH2_5                 3.407328e-02 1 1  ON 45
eH2_6                 7.852925e-02 1 1  ON 46
eH2_7                 1.136306e-01 1 1  ON 47
eH2_8                 9.305173e-02 1 1  ON 48
eH2_9                 2.608810e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2716
    reference variance = 0.205321
====================================================
  Execution time = 3.3933e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2218e-01
  Total weights = 2.0000e+06
  Execution time = 3.1064e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321847534183
                                         uncertainty =       0.004316719610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321847534183
                                         uncertainty =       0.004316719610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401209055
  error estimate for blocks of size 2^( 2) =       0.000411285127
  error estimate for blocks of size 2^( 3) =       0.000419974316
  error estimate for blocks of size 2^( 4) =       0.000425836521
  error estimate for blocks of size 2^( 5) =       0.000429673619
  error estimate for blocks of size 2^( 6) =       0.000432772322
  error estimate for blocks of size 2^( 7) =       0.000434757996

      target function =                  N/A
              le_mean =     -17.217113595543
             les_mean =     296.750937813085
             stat err =       0.000430760115
             autocorr =       1.152735092296
              std dev =       0.567395287446
             le_variance =       0.321937412216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322570300707
                                         uncertainty =       0.004324903502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322570300707
                                         uncertainty =       0.004324903502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401659196
  error estimate for blocks of size 2^( 2) =       0.000411713633
  error estimate for blocks of size 2^( 3) =       0.000420375697
  error estimate for blocks of size 2^( 4) =       0.000426214731
  error estimate for blocks of size 2^( 5) =       0.000430041427
  error estimate for blocks of size 2^( 6) =       0.000433116937
  error estimate for blocks of size 2^( 7) =       0.000435090665

      target function =                  N/A
              le_mean =     -17.217109233964
             les_mean =     296.751510432989
             stat err =       0.000431115940
             autocorr =       1.152053722333
              std dev =       0.568031882980
             le_variance =       0.322660220082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322327024335
                                         uncertainty =       0.004321605509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322327024335
                                         uncertainty =       0.004321605509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401507736
  error estimate for blocks of size 2^( 2) =       0.000411570682
  error estimate for blocks of size 2^( 3) =       0.000420243061
  error estimate for blocks of size 2^( 4) =       0.000426091595
  error estimate for blocks of size 2^( 5) =       0.000429923388
  error estimate for blocks of size 2^( 6) =       0.000433005961
  error estimate for blocks of size 2^( 7) =       0.000434983679

      target function =                  N/A
              le_mean =     -17.217110116103
             les_mean =     296.751297512679
             stat err =       0.000431001156
             autocorr =       1.152309214664
              std dev =       0.567817685401
             le_variance =       0.322416923854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321914889041
                                         uncertainty =       0.004317376748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321914889041
                                         uncertainty =       0.004317376748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401251024
  error estimate for blocks of size 2^( 2) =       0.000411325296
  error estimate for blocks of size 2^( 3) =       0.000420012160
  error estimate for blocks of size 2^( 4) =       0.000425872604
  error estimate for blocks of size 2^( 5) =       0.000429709110
  error estimate for blocks of size 2^( 6) =       0.000432805478
  error estimate for blocks of size 2^( 7) =       0.000434790073

      target function =                  N/A
              le_mean =     -17.217113013097
             les_mean =     296.750985112642
             stat err =       0.000430794316
             autocorr =       1.152676988174
              std dev =       0.567454639498
             le_variance =       0.322004767888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217113595543        initial  <--
     2.3842e-01     2.3842e+00             3.2297e-03       -17.217109233964
     9.5367e-01     9.5367e+00             9.1251e-04       -17.217110116103
     3.8147e+00     3.8147e+01             2.3698e-04       -17.217113013097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.5935
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2214
    reference variance = 0.295943
====================================================
  Execution time = 3.5494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326557716677
                                         uncertainty =       0.011542952973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326557716677
                                         uncertainty =       0.011542952973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404112558
  error estimate for blocks of size 2^( 2) =       0.000414171714
  error estimate for blocks of size 2^( 3) =       0.000423286156
  error estimate for blocks of size 2^( 4) =       0.000429338618
  error estimate for blocks of size 2^( 5) =       0.000432838047
  error estimate for blocks of size 2^( 6) =       0.000434569866
  error estimate for blocks of size 2^( 7) =       0.000434745646

      target function =                  N/A
              le_mean =     -17.215619947629
             les_mean =     296.704183936221
             stat err =       0.000432873044
             autocorr =       1.147404086889
              std dev =       0.571501459605
             le_variance =       0.326613918331


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721561994763e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215619947629       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215619931889       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215620965888       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215621771629       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215621654802       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215621758627       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215621812682       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215621776569       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 3.841459e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215619947629       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215619943509       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215620238358       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215620437821       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215620395822       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215620417130       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215620432006       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215620421259       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 9.681019e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215619947629       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215619946587       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215620022902       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215620072619       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215620061308       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215620066242       residual = 9.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215620070044       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215620067248       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 2.424543e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388371 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4817e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.057237e-01 1 1  ON 0
 uu_1                 4.529477e-02 1 1  ON 1
 uu_2                -4.702606e-02 1 1  ON 2
 uu_3                -9.953757e-02 1 1  ON 3
 uu_4                -1.305515e-01 1 1  ON 4
 uu_5                -1.356547e-01 1 1  ON 5
 uu_6                -1.123459e-01 1 1  ON 6
 uu_7                -3.765530e-02 1 1  ON 7
 uu_8                 1.001208e-01 1 1  ON 8
 uu_9                 1.199418e-01 1 1  ON 9
 ud_0                 3.420752e-01 1 1  ON 10
 ud_1                 8.773282e-02 1 1  ON 11
 ud_2                -1.528647e-02 1 1  ON 12
 ud_3                -7.149947e-02 1 1  ON 13
 ud_4                -1.175073e-01 1 1  ON 14
 ud_5                -1.497876e-01 1 1  ON 15
 ud_6                -1.545567e-01 1 1  ON 16
 ud_7                -1.102299e-01 1 1  ON 17
 ud_8                 5.040723e-03 1 1  ON 18
 ud_9                 9.226070e-02 1 1  ON 19
 eO_0                -7.376555e-01 1 1  ON 20
 eO_1                -4.286991e-01 1 1  ON 21
 eO_2                -3.933097e-02 1 1  ON 22
 eO_3                 1.987968e-01 1 1  ON 23
 eO_4                 2.834047e-01 1 1  ON 24
 eO_5                 3.062445e-01 1 1  ON 25
 eO_6                 2.495389e-01 1 1  ON 26
 eO_7                 1.113133e-01 1 1  ON 27
 eO_8                 2.763542e-02 1 1  ON 28
 eO_9                 1.827206e-02 1 1  ON 29
eH1_0                -1.802116e-01 1 1  ON 30
eH1_1                -1.017873e-01 1 1  ON 31
eH1_2                -6.230935e-02 1 1  ON 32
eH1_3                -2.647081e-02 1 1  ON 33
eH1_4                 1.923404e-02 1 1  ON 34
eH1_5                 3.408845e-02 1 1  ON 35
eH1_6                 7.725042e-02 1 1  ON 36
eH1_7                 1.104741e-01 1 1  ON 37
eH1_8                 9.051758e-02 1 1  ON 38
eH1_9                 2.407602e-02 1 1  ON 39
eH2_0                -1.812523e-01 1 1  ON 40
eH2_1                -1.032257e-01 1 1  ON 41
eH2_2                -6.341268e-02 1 1  ON 42
eH2_3                -2.759652e-02 1 1  ON 43
eH2_4                 1.834383e-02 1 1  ON 44
eH2_5                 3.391140e-02 1 1  ON 45
eH2_6                 7.851601e-02 1 1  ON 46
eH2_7                 1.136646e-01 1 1  ON 47
eH2_8                 9.300196e-02 1 1  ON 48
eH2_9                 2.607114e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2785
    reference variance = 0.238726
====================================================
  Execution time = 3.4020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1362e-01
  Total weights = 2.0000e+06
  Execution time = 3.0784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313629149542
                                         uncertainty =       0.003994197029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313629149542
                                         uncertainty =       0.003994197029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395967550
  error estimate for blocks of size 2^( 2) =       0.000405619307
  error estimate for blocks of size 2^( 3) =       0.000413867290
  error estimate for blocks of size 2^( 4) =       0.000420342057
  error estimate for blocks of size 2^( 5) =       0.000423919986
  error estimate for blocks of size 2^( 6) =       0.000425505898
  error estimate for blocks of size 2^( 7) =       0.000427040788

      target function =                  N/A
              le_mean =     -17.216010742961
             les_mean =     296.704606346790
             stat err =       0.000424202182
             autocorr =       1.147695299693
              std dev =       0.559982679935
             le_variance =       0.313580601827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313760424410
                                         uncertainty =       0.003995545528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313760424410
                                         uncertainty =       0.003995545528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396050467
  error estimate for blocks of size 2^( 2) =       0.000405697113
  error estimate for blocks of size 2^( 3) =       0.000413939109
  error estimate for blocks of size 2^( 4) =       0.000420410272
  error estimate for blocks of size 2^( 5) =       0.000423987887
  error estimate for blocks of size 2^( 6) =       0.000425572159
  error estimate for blocks of size 2^( 7) =       0.000427110575

      target function =                  N/A
              le_mean =     -17.216010044724
             les_mean =     296.704713648172
             stat err =       0.000424270223
             autocorr =       1.147582838820
              std dev =       0.560099941979
             le_variance =       0.313711945005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313698911665
                                         uncertainty =       0.003994917697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313698911665
                                         uncertainty =       0.003994917697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396011617
  error estimate for blocks of size 2^( 2) =       0.000405660698
  error estimate for blocks of size 2^( 3) =       0.000413905489
  error estimate for blocks of size 2^( 4) =       0.000420378398
  error estimate for blocks of size 2^( 5) =       0.000423956231
  error estimate for blocks of size 2^( 6) =       0.000425541262
  error estimate for blocks of size 2^( 7) =       0.000427078085

      target function =                  N/A
              le_mean =     -17.216010330611
             les_mean =     296.704661948914
             stat err =       0.000424238494
             autocorr =       1.147636339491
              std dev =       0.560045000014
             le_variance =       0.313650402041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313638005170
                                         uncertainty =       0.003994288735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313638005170
                                         uncertainty =       0.003994288735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395973145
  error estimate for blocks of size 2^( 2) =       0.000405624562
  error estimate for blocks of size 2^( 3) =       0.000413872139
  error estimate for blocks of size 2^( 4) =       0.000420346671
  error estimate for blocks of size 2^( 5) =       0.000423924590
  error estimate for blocks of size 2^( 6) =       0.000425510391
  error estimate for blocks of size 2^( 7) =       0.000427045528

      target function =                  N/A
              le_mean =     -17.216010687771
             les_mean =     296.704613307013
             stat err =       0.000424206795
             autocorr =       1.147687831547
              std dev =       0.559990591319
             le_variance =       0.313589462366


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216010742961        initial  <--
     2.3842e+00     2.3842e+01             3.8415e-04       -17.216010044724
     9.5367e+00     9.5367e+01             9.6810e-05       -17.216010330611
     3.8147e+01     3.8147e+02             2.4245e-05       -17.216010687771

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.5587
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4381e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1958
    reference variance = 0.189374
====================================================
  Execution time = 3.4574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2170e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321786395989
                                         uncertainty =       0.004675658320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321786395989
                                         uncertainty =       0.004675658320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401063628
  error estimate for blocks of size 2^( 2) =       0.000410890904
  error estimate for blocks of size 2^( 3) =       0.000419697655
  error estimate for blocks of size 2^( 4) =       0.000426064935
  error estimate for blocks of size 2^( 5) =       0.000429613545
  error estimate for blocks of size 2^( 6) =       0.000432345256
  error estimate for blocks of size 2^( 7) =       0.000435458932

      target function =                  N/A
              le_mean =     -17.216486138578
             les_mean =     296.729098866133
             stat err =       0.000430870667
             autocorr =       1.154163411669
              std dev =       0.567189621841
             le_variance =       0.321704067124


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721648613858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216486138578       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486150837       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216486159845       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216486211406       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216486233066       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216486233134       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216486236493       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216486238411       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 4.231590e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216486138578       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486141659       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216486143933       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216486156797       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216486162203       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216486162241       residual = 6.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216486163079       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216486163556       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.059832e-05

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216486138578       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486139349       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216486139920       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216486143134       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216486144485       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216486144495       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216486144705       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216486144824       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 2.650792e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391028 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3918e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.056771e-01 1 1  ON 0
 uu_1                 4.528078e-02 1 1  ON 1
 uu_2                -4.702134e-02 1 1  ON 2
 uu_3                -9.953545e-02 1 1  ON 3
 uu_4                -1.305274e-01 1 1  ON 4
 uu_5                -1.356417e-01 1 1  ON 5
 uu_6                -1.123388e-01 1 1  ON 6
 uu_7                -3.764181e-02 1 1  ON 7
 uu_8                 1.001281e-01 1 1  ON 8
 uu_9                 1.199376e-01 1 1  ON 9
 ud_0                 3.420431e-01 1 1  ON 10
 ud_1                 8.771465e-02 1 1  ON 11
 ud_2                -1.528543e-02 1 1  ON 12
 ud_3                -7.148959e-02 1 1  ON 13
 ud_4                -1.174860e-01 1 1  ON 14
 ud_5                -1.497664e-01 1 1  ON 15
 ud_6                -1.545710e-01 1 1  ON 16
 ud_7                -1.102294e-01 1 1  ON 17
 ud_8                 5.055102e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375693e-01 1 1  ON 20
 eO_1                -4.286369e-01 1 1  ON 21
 eO_2                -3.933731e-02 1 1  ON 22
 eO_3                 1.987431e-01 1 1  ON 23
 eO_4                 2.833477e-01 1 1  ON 24
 eO_5                 3.062362e-01 1 1  ON 25
 eO_6                 2.495289e-01 1 1  ON 26
 eO_7                 1.113030e-01 1 1  ON 27
 eO_8                 2.763423e-02 1 1  ON 28
 eO_9                 1.827141e-02 1 1  ON 29
eH1_0                -1.802064e-01 1 1  ON 30
eH1_1                -1.017868e-01 1 1  ON 31
eH1_2                -6.231596e-02 1 1  ON 32
eH1_3                -2.646554e-02 1 1  ON 33
eH1_4                 1.923921e-02 1 1  ON 34
eH1_5                 3.408502e-02 1 1  ON 35
eH1_6                 7.724967e-02 1 1  ON 36
eH1_7                 1.104769e-01 1 1  ON 37
eH1_8                 9.051173e-02 1 1  ON 38
eH1_9                 2.407453e-02 1 1  ON 39
eH2_0                -1.812415e-01 1 1  ON 40
eH2_1                -1.032278e-01 1 1  ON 41
eH2_2                -6.340955e-02 1 1  ON 42
eH2_3                -2.759961e-02 1 1  ON 43
eH2_4                 1.834606e-02 1 1  ON 44
eH2_5                 3.390599e-02 1 1  ON 45
eH2_6                 7.851987e-02 1 1  ON 46
eH2_7                 1.136643e-01 1 1  ON 47
eH2_8                 9.299508e-02 1 1  ON 48
eH2_9                 2.606937e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2971
    reference variance = 0.805938
====================================================
  Execution time = 3.4419e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2834e-01
  Total weights = 2.0000e+06
  Execution time = 3.1161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328455300462
                                         uncertainty =       0.008814675026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328455300462
                                         uncertainty =       0.008814675026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405179493
  error estimate for blocks of size 2^( 2) =       0.000414701035
  error estimate for blocks of size 2^( 3) =       0.000423120053
  error estimate for blocks of size 2^( 4) =       0.000430084487
  error estimate for blocks of size 2^( 5) =       0.000435459777
  error estimate for blocks of size 2^( 6) =       0.000437244991
  error estimate for blocks of size 2^( 7) =       0.000438573308

      target function =                  N/A
              le_mean =     -17.216058438085
             les_mean =     296.721008823228
             stat err =       0.000435340641
             autocorr =       1.154419116816
              std dev =       0.573010334850
             le_variance =       0.328340843845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328462523161
                                         uncertainty =       0.008814856291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328462523161
                                         uncertainty =       0.008814856291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405183947
  error estimate for blocks of size 2^( 2) =       0.000414705174
  error estimate for blocks of size 2^( 3) =       0.000423123852
  error estimate for blocks of size 2^( 4) =       0.000430088095
  error estimate for blocks of size 2^( 5) =       0.000435463175
  error estimate for blocks of size 2^( 6) =       0.000437248419
  error estimate for blocks of size 2^( 7) =       0.000438576550

      target function =                  N/A
              le_mean =     -17.216058385382
             les_mean =     296.721014226794
             stat err =       0.000435344060
             autocorr =       1.154411872251
              std dev =       0.573016633337
             le_variance =       0.328348062081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328458904699
                                         uncertainty =       0.008814766102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328458904699
                                         uncertainty =       0.008814766102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405181716
  error estimate for blocks of size 2^( 2) =       0.000414703100
  error estimate for blocks of size 2^( 3) =       0.000423121948
  error estimate for blocks of size 2^( 4) =       0.000430086287
  error estimate for blocks of size 2^( 5) =       0.000435461471
  error estimate for blocks of size 2^( 6) =       0.000437246700
  error estimate for blocks of size 2^( 7) =       0.000438574924

      target function =                  N/A
              le_mean =     -17.216058411430
             les_mean =     296.721011507452
             stat err =       0.000435342346
             autocorr =       1.154415494151
              std dev =       0.573013477894
             le_variance =       0.328344445848

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328455750701
                                         uncertainty =       0.008814686424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328455750701
                                         uncertainty =       0.008814686424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405179771
  error estimate for blocks of size 2^( 2) =       0.000414701293
  error estimate for blocks of size 2^( 3) =       0.000423120290
  error estimate for blocks of size 2^( 4) =       0.000430084712
  error estimate for blocks of size 2^( 5) =       0.000435459989
  error estimate for blocks of size 2^( 6) =       0.000437245204
  error estimate for blocks of size 2^( 7) =       0.000438573510

      target function =                  N/A
              le_mean =     -17.216058434735
             les_mean =     296.721009157829
             stat err =       0.000435340854
             autocorr =       1.154418663936
              std dev =       0.573010727478
             le_variance =       0.328341293805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216058438085        initial  <--
     2.3842e+01     2.3842e+02             4.2316e-05       -17.216058385382
     9.5367e+01     9.5367e+02             1.0598e-05       -17.216058411430
     3.8147e+02     3.8147e+03             2.6508e-06       -17.216058434735

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.1421
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4066e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.236587
====================================================
  Execution time = 3.4846e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1246e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312441859990
                                         uncertainty =       0.003144180395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312441859990
                                         uncertainty =       0.003144180395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395259254
  error estimate for blocks of size 2^( 2) =       0.000404833789
  error estimate for blocks of size 2^( 3) =       0.000413674807
  error estimate for blocks of size 2^( 4) =       0.000420615434
  error estimate for blocks of size 2^( 5) =       0.000423821198
  error estimate for blocks of size 2^( 6) =       0.000425084405
  error estimate for blocks of size 2^( 7) =       0.000428117584

      target function =                  N/A
              le_mean =     -17.216243046866
             les_mean =     296.711484249073
             stat err =       0.000424409655
             autocorr =       1.152939230250
              std dev =       0.558980998359
             le_variance =       0.312459756527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721624304687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216243046866       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216243048361       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216243053064       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216243056630       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216243057436       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216243056725       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216243056867       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216243057101       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 3.574522e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216243046866       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216243047240       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216243048417       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216243049307       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216243049509       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216243049332       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216243049366       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216243049424       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 8.936263e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216243046866       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216243046960       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216243047254       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216243047475       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216243047526       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216243047478       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216243047494       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216243047507       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 2.234063e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4308e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.056747e-01 1 1  ON 0
 uu_1                 4.527914e-02 1 1  ON 1
 uu_2                -4.702250e-02 1 1  ON 2
 uu_3                -9.953495e-02 1 1  ON 3
 uu_4                -1.305260e-01 1 1  ON 4
 uu_5                -1.356413e-01 1 1  ON 5
 uu_6                -1.123373e-01 1 1  ON 6
 uu_7                -3.764006e-02 1 1  ON 7
 uu_8                 1.001290e-01 1 1  ON 8
 uu_9                 1.199372e-01 1 1  ON 9
 ud_0                 3.420405e-01 1 1  ON 10
 ud_1                 8.771284e-02 1 1  ON 11
 ud_2                -1.528637e-02 1 1  ON 12
 ud_3                -7.148786e-02 1 1  ON 13
 ud_4                -1.174852e-01 1 1  ON 14
 ud_5                -1.497656e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056745e-03 1 1  ON 18
 ud_9                 9.226173e-02 1 1  ON 19
 eO_0                -7.375596e-01 1 1  ON 20
 eO_1                -4.286316e-01 1 1  ON 21
 eO_2                -3.933751e-02 1 1  ON 22
 eO_3                 1.987373e-01 1 1  ON 23
 eO_4                 2.833414e-01 1 1  ON 24
 eO_5                 3.062354e-01 1 1  ON 25
 eO_6                 2.495282e-01 1 1  ON 26
 eO_7                 1.113021e-01 1 1  ON 27
 eO_8                 2.763414e-02 1 1  ON 28
 eO_9                 1.827132e-02 1 1  ON 29
eH1_0                -1.802061e-01 1 1  ON 30
eH1_1                -1.017848e-01 1 1  ON 31
eH1_2                -6.231606e-02 1 1  ON 32
eH1_3                -2.646568e-02 1 1  ON 33
eH1_4                 1.923951e-02 1 1  ON 34
eH1_5                 3.408312e-02 1 1  ON 35
eH1_6                 7.724961e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051124e-02 1 1  ON 38
eH1_9                 2.407435e-02 1 1  ON 39
eH2_0                -1.812400e-01 1 1  ON 40
eH2_1                -1.032274e-01 1 1  ON 41
eH2_2                -6.341026e-02 1 1  ON 42
eH2_3                -2.760042e-02 1 1  ON 43
eH2_4                 1.834566e-02 1 1  ON 44
eH2_5                 3.390592e-02 1 1  ON 45
eH2_6                 7.852037e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299449e-02 1 1  ON 48
eH2_9                 2.606916e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2706
    reference variance = 0.252414
====================================================
  Execution time = 3.4153e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1560e-01
  Total weights = 2.0000e+06
  Execution time = 3.0970e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315630984201
                                         uncertainty =       0.004046557722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315630984201
                                         uncertainty =       0.004046557722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397240277
  error estimate for blocks of size 2^( 2) =       0.000407162212
  error estimate for blocks of size 2^( 3) =       0.000416142159
  error estimate for blocks of size 2^( 4) =       0.000423082487
  error estimate for blocks of size 2^( 5) =       0.000427970638
  error estimate for blocks of size 2^( 6) =       0.000429916664
  error estimate for blocks of size 2^( 7) =       0.000430592224

      target function =                  N/A
              le_mean =     -17.216358757477
             les_mean =     296.718608384190
             stat err =       0.000427890504
             autocorr =       1.160269144868
              std dev =       0.561782587703
             le_variance =       0.315599675847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315631929072
                                         uncertainty =       0.004046568344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315631929072
                                         uncertainty =       0.004046568344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397240872
  error estimate for blocks of size 2^( 2) =       0.000407162778
  error estimate for blocks of size 2^( 3) =       0.000416142683
  error estimate for blocks of size 2^( 4) =       0.000423082968
  error estimate for blocks of size 2^( 5) =       0.000427971090
  error estimate for blocks of size 2^( 6) =       0.000429917102
  error estimate for blocks of size 2^( 7) =       0.000430592662

      target function =                  N/A
              le_mean =     -17.216358749574
             les_mean =     296.718609056349
             stat err =       0.000427890956
             autocorr =       1.160268124675
              std dev =       0.561783428135
             le_variance =       0.315600620127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315631456871
                                         uncertainty =       0.004046563034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315631456871
                                         uncertainty =       0.004046563034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397240575
  error estimate for blocks of size 2^( 2) =       0.000407162495
  error estimate for blocks of size 2^( 3) =       0.000416142421
  error estimate for blocks of size 2^( 4) =       0.000423082728
  error estimate for blocks of size 2^( 5) =       0.000427970864
  error estimate for blocks of size 2^( 6) =       0.000429916883
  error estimate for blocks of size 2^( 7) =       0.000430592444

      target function =                  N/A
              le_mean =     -17.216358753521
             les_mean =     296.718608720361
             stat err =       0.000427890730
             autocorr =       1.160268634591
              std dev =       0.561783008128
             le_variance =       0.315600148221

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315631043291
                                         uncertainty =       0.004046558386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315631043291
                                         uncertainty =       0.004046558386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397240314
  error estimate for blocks of size 2^( 2) =       0.000407162248
  error estimate for blocks of size 2^( 3) =       0.000416142192
  error estimate for blocks of size 2^( 4) =       0.000423082517
  error estimate for blocks of size 2^( 5) =       0.000427970666
  error estimate for blocks of size 2^( 6) =       0.000429916692
  error estimate for blocks of size 2^( 7) =       0.000430592252

      target function =                  N/A
              le_mean =     -17.216358756982
             les_mean =     296.718608426211
             stat err =       0.000427890532
             autocorr =       1.160269081084
              std dev =       0.561782640262
             le_variance =       0.315599734900


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216358757477        initial  <--
     2.3842e+02     2.3842e+03             3.5745e-06       -17.216358749574
     9.5367e+02     9.5367e+03             8.9363e-07       -17.216358753521
     3.8147e+03     3.8147e+04             2.2341e-07       -17.216358756982

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.7673
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4080e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1794
    reference variance = 0.267859
====================================================
  Execution time = 3.4678e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2297e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322874058033
                                         uncertainty =       0.006444215510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322874058033
                                         uncertainty =       0.006444215510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401853426
  error estimate for blocks of size 2^( 2) =       0.000411285893
  error estimate for blocks of size 2^( 3) =       0.000419899627
  error estimate for blocks of size 2^( 4) =       0.000426534446
  error estimate for blocks of size 2^( 5) =       0.000430672049
  error estimate for blocks of size 2^( 6) =       0.000432636789
  error estimate for blocks of size 2^( 7) =       0.000433524440

      target function =                  N/A
              le_mean =     -17.216529010467
             les_mean =     296.731843359313
             stat err =       0.000430841931
             autocorr =       1.149477766925
              std dev =       0.568306565638
             le_variance =       0.322972352547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652901047e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216529010467       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216529010571       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216529011630       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216529011988       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216529011936       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216529012033       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216529012054       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216529012048       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 4.107505e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216529010467       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216529010493       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216529010758       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216529010847       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216529010834       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216529010857       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216529010863       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216529010862       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.026894e-07

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216529010467       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216529010473       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216529010540       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216529010562       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216529010559       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216529010565       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216529010576       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216529010559       residual = 2.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 2.567245e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396415 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3895e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.056744e-01 1 1  ON 0
 uu_1                 4.527906e-02 1 1  ON 1
 uu_2                -4.702253e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763993e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771267e-02 1 1  ON 11
 ud_2                -1.528643e-02 1 1  ON 12
 ud_3                -7.148778e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497655e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056872e-03 1 1  ON 18
 ud_9                 9.226172e-02 1 1  ON 19
 eO_0                -7.375588e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987367e-01 1 1  ON 23
 eO_4                 2.833408e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646563e-02 1 1  ON 33
eH1_4                 1.923949e-02 1 1  ON 34
eH1_5                 3.408305e-02 1 1  ON 35
eH1_6                 7.724956e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051116e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834563e-02 1 1  ON 44
eH2_5                 3.390589e-02 1 1  ON 45
eH2_6                 7.852036e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299443e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1792
    reference variance = 0.190709
====================================================
  Execution time = 3.4331e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1348e-01
  Total weights = 2.0000e+06
  Execution time = 3.1030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469260754
                                         uncertainty =       0.002977753874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469260754
                                         uncertainty =       0.002977753874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395905538
  error estimate for blocks of size 2^( 2) =       0.000405802109
  error estimate for blocks of size 2^( 3) =       0.000414863417
  error estimate for blocks of size 2^( 4) =       0.000420519992
  error estimate for blocks of size 2^( 5) =       0.000424957109
  error estimate for blocks of size 2^( 6) =       0.000425500656
  error estimate for blocks of size 2^( 7) =       0.000426688217

      target function =                  N/A
              le_mean =     -17.216691011675
             les_mean =     296.727931624256
             stat err =       0.000424416494
             autocorr =       1.149215178051
              std dev =       0.559894980791
             le_variance =       0.313482389515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469343826
                                         uncertainty =       0.002977754744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469343826
                                         uncertainty =       0.002977754744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395905590
  error estimate for blocks of size 2^( 2) =       0.000405802158
  error estimate for blocks of size 2^( 3) =       0.000414863463
  error estimate for blocks of size 2^( 4) =       0.000420520036
  error estimate for blocks of size 2^( 5) =       0.000424957151
  error estimate for blocks of size 2^( 6) =       0.000425500696
  error estimate for blocks of size 2^( 7) =       0.000426688256

      target function =                  N/A
              le_mean =     -17.216691011666
             les_mean =     296.727931707034
             stat err =       0.000424416535
             autocorr =       1.149215096438
              std dev =       0.559895054994
             le_variance =       0.313482472607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469302292
                                         uncertainty =       0.002977754309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469302292
                                         uncertainty =       0.002977754309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395905564
  error estimate for blocks of size 2^( 2) =       0.000405802133
  error estimate for blocks of size 2^( 3) =       0.000414863440
  error estimate for blocks of size 2^( 4) =       0.000420520014
  error estimate for blocks of size 2^( 5) =       0.000424957130
  error estimate for blocks of size 2^( 6) =       0.000425500676
  error estimate for blocks of size 2^( 7) =       0.000426688236

      target function =                  N/A
              le_mean =     -17.216691011670
             les_mean =     296.727931665646
             stat err =       0.000424416514
             autocorr =       1.149215137239
              std dev =       0.559895017894
             le_variance =       0.313482431063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469265946
                                         uncertainty =       0.002977753928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313469265946
                                         uncertainty =       0.002977753928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395905541
  error estimate for blocks of size 2^( 2) =       0.000405802112
  error estimate for blocks of size 2^( 3) =       0.000414863420
  error estimate for blocks of size 2^( 4) =       0.000420519995
  error estimate for blocks of size 2^( 5) =       0.000424957112
  error estimate for blocks of size 2^( 6) =       0.000425500659
  error estimate for blocks of size 2^( 7) =       0.000426688219

      target function =                  N/A
              le_mean =     -17.216691011674
             les_mean =     296.727931629429
             stat err =       0.000424416496
             autocorr =       1.149215172955
              std dev =       0.559894985429
             le_variance =       0.313482394709


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216691011675        initial  <--
     2.3842e+03     2.3842e+04             4.1075e-07       -17.216691011666
     9.5367e+03     9.5367e+04             1.0269e-07       -17.216691011670
     3.8147e+04     3.8147e+05             2.5672e-08       -17.216691011674

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.0040
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3904e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1797
    reference variance = 0.20495
====================================================
  Execution time = 3.5265e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1372e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.5270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313760406414
                                         uncertainty =       0.003099872520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313760406414
                                         uncertainty =       0.003099872520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396058651
  error estimate for blocks of size 2^( 2) =       0.000406137304
  error estimate for blocks of size 2^( 3) =       0.000414865640
  error estimate for blocks of size 2^( 4) =       0.000421709371
  error estimate for blocks of size 2^( 5) =       0.000425564635
  error estimate for blocks of size 2^( 6) =       0.000428013943
  error estimate for blocks of size 2^( 7) =       0.000429035974

      target function =                  N/A
              le_mean =     -17.215691471282
             les_mean =     296.693757587444
             stat err =       0.000426080981
             autocorr =       1.157351528436
              std dev =       0.560111515611
             le_variance =       0.313724909920


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721569147128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215691471282       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215691471293       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215691471383       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215691471408       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215691471393       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215691471390       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215691471361       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215691471363       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 3.785598e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215691471282       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215691471285       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215691471308       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215691471314       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215691471308       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215691471334       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215691471300       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215691471314       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 9.464009e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215691471282       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215691471283       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215691471289       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215691471388       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215691471208       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215691471356       residual = 9.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215691471266       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215691471389       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 2.366003e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4803e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497655e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056882e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1776
    reference variance = 0.182759
====================================================
  Execution time = 3.3941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2137e-01
  Total weights = 2.0000e+06
  Execution time = 3.0942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437721819
                                         uncertainty =       0.003945118331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437721819
                                         uncertainty =       0.003945118331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400857653
  error estimate for blocks of size 2^( 2) =       0.000410623438
  error estimate for blocks of size 2^( 3) =       0.000419579043
  error estimate for blocks of size 2^( 4) =       0.000426211454
  error estimate for blocks of size 2^( 5) =       0.000429727286
  error estimate for blocks of size 2^( 6) =       0.000432904625
  error estimate for blocks of size 2^( 7) =       0.000435904992

      target function =                  N/A
              le_mean =     -17.216378188832
             les_mean =     296.725051495700
             stat err =       0.000431187089
             autocorr =       1.157047367854
              std dev =       0.566898329075
             le_variance =       0.321373715508

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437733616
                                         uncertainty =       0.003945118462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437733616
                                         uncertainty =       0.003945118462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400857660
  error estimate for blocks of size 2^( 2) =       0.000410623445
  error estimate for blocks of size 2^( 3) =       0.000419579049
  error estimate for blocks of size 2^( 4) =       0.000426211461
  error estimate for blocks of size 2^( 5) =       0.000429727292
  error estimate for blocks of size 2^( 6) =       0.000432904631
  error estimate for blocks of size 2^( 7) =       0.000435904998

      target function =                  N/A
              le_mean =     -17.216378188815
             les_mean =     296.725051506920
             stat err =       0.000431187095
             autocorr =       1.157047358398
              std dev =       0.566898339475
             le_variance =       0.321373727299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437727718
                                         uncertainty =       0.003945118396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437727718
                                         uncertainty =       0.003945118396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400857656
  error estimate for blocks of size 2^( 2) =       0.000410623442
  error estimate for blocks of size 2^( 3) =       0.000419579046
  error estimate for blocks of size 2^( 4) =       0.000426211458
  error estimate for blocks of size 2^( 5) =       0.000429727289
  error estimate for blocks of size 2^( 6) =       0.000432904628
  error estimate for blocks of size 2^( 7) =       0.000435904995

      target function =                  N/A
              le_mean =     -17.216378188823
             les_mean =     296.725051501310
             stat err =       0.000431187092
             autocorr =       1.157047363120
              std dev =       0.566898334275
             le_variance =       0.321373721404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437722556
                                         uncertainty =       0.003945118339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321437722556
                                         uncertainty =       0.003945118339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400857653
  error estimate for blocks of size 2^( 2) =       0.000410623438
  error estimate for blocks of size 2^( 3) =       0.000419579043
  error estimate for blocks of size 2^( 4) =       0.000426211455
  error estimate for blocks of size 2^( 5) =       0.000429727286
  error estimate for blocks of size 2^( 6) =       0.000432904625
  error estimate for blocks of size 2^( 7) =       0.000435904992

      target function =                  N/A
              le_mean =     -17.216378188831
             les_mean =     296.725051496401
             stat err =       0.000431187089
             autocorr =       1.157047367265
              std dev =       0.566898329725
             le_variance =       0.321373716245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216378188832        initial  <--
     2.3842e+04     2.3842e+05             3.7856e-08       -17.216378188815
     9.5367e+04     9.5367e+05             9.4640e-09       -17.216378188823
     3.8147e+05     3.8147e+06             2.3660e-09       -17.216378188831

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.5524
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4361e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.168
    reference variance = 0.209214
====================================================
  Execution time = 3.4982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.1764e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317686316308
                                         uncertainty =       0.003933504685

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317686316308
                                         uncertainty =       0.003933504685

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398523665
  error estimate for blocks of size 2^( 2) =       0.000408497884
  error estimate for blocks of size 2^( 3) =       0.000417157385
  error estimate for blocks of size 2^( 4) =       0.000424186194
  error estimate for blocks of size 2^( 5) =       0.000429366691
  error estimate for blocks of size 2^( 6) =       0.000432452208
  error estimate for blocks of size 2^( 7) =       0.000431281647

      target function =                  N/A
              le_mean =     -17.215354185422
             les_mean =     296.686061793400
             stat err =       0.000429321685
             autocorr =       1.160532800852
              std dev =       0.563597571593
             le_variance =       0.317642222705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721535418542e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215354185422       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215354185431       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215354185434       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215354185523       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215354185440       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215354185444       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215354185438       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215354185482       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 3.931650e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215354185422       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215354185424       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215354185425       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215354185626       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215354184773       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215354185363       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215354185006       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215354185119       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 9.829127e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215354185422       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215354185422       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215354185422       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215354185423       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215354186387       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215354185654       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215354185795       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215354186673       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 2.457281e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4357e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.212
    reference variance = 0.208749
====================================================
  Execution time = 3.5947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1077e-01
  Total weights = 2.0000e+06
  Execution time = 3.0862e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783577168
                                         uncertainty =       0.002801057657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783577168
                                         uncertainty =       0.002801057657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394189920
  error estimate for blocks of size 2^( 2) =       0.000404267840
  error estimate for blocks of size 2^( 3) =       0.000413031010
  error estimate for blocks of size 2^( 4) =       0.000419190559
  error estimate for blocks of size 2^( 5) =       0.000423973154
  error estimate for blocks of size 2^( 6) =       0.000426024261
  error estimate for blocks of size 2^( 7) =       0.000427214054

      target function =                  N/A
              le_mean =     -17.216569304140
             les_mean =     296.721029834800
             stat err =       0.000424100507
             autocorr =       1.157514804486
              std dev =       0.557468730898
             le_variance =       0.310771385930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783578716
                                         uncertainty =       0.002801057667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783578716
                                         uncertainty =       0.002801057667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394189921
  error estimate for blocks of size 2^( 2) =       0.000404267841
  error estimate for blocks of size 2^( 3) =       0.000413031011
  error estimate for blocks of size 2^( 4) =       0.000419190560
  error estimate for blocks of size 2^( 5) =       0.000423973155
  error estimate for blocks of size 2^( 6) =       0.000426024262
  error estimate for blocks of size 2^( 7) =       0.000427214055

      target function =                  N/A
              le_mean =     -17.216569304135
             les_mean =     296.721029836192
             stat err =       0.000424100508
             autocorr =       1.157514803103
              std dev =       0.557468732287
             le_variance =       0.310771387477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783577942
                                         uncertainty =       0.002801057662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783577942
                                         uncertainty =       0.002801057662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394189920
  error estimate for blocks of size 2^( 2) =       0.000404267841
  error estimate for blocks of size 2^( 3) =       0.000413031011
  error estimate for blocks of size 2^( 4) =       0.000419190559
  error estimate for blocks of size 2^( 5) =       0.000423973154
  error estimate for blocks of size 2^( 6) =       0.000426024262
  error estimate for blocks of size 2^( 7) =       0.000427214054

      target function =                  N/A
              le_mean =     -17.216569304138
             les_mean =     296.721029835496
             stat err =       0.000424100507
             autocorr =       1.157514803796
              std dev =       0.557468731593
             le_variance =       0.310771386704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783577264
                                         uncertainty =       0.002801057658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310783577264
                                         uncertainty =       0.002801057658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394189920
  error estimate for blocks of size 2^( 2) =       0.000404267840
  error estimate for blocks of size 2^( 3) =       0.000413031011
  error estimate for blocks of size 2^( 4) =       0.000419190559
  error estimate for blocks of size 2^( 5) =       0.000423973154
  error estimate for blocks of size 2^( 6) =       0.000426024261
  error estimate for blocks of size 2^( 7) =       0.000427214054

      target function =                  N/A
              le_mean =     -17.216569304140
             les_mean =     296.721029834887
             stat err =       0.000424100507
             autocorr =       1.157514804394
              std dev =       0.557468730985
             le_variance =       0.310771386026


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216569304140        initial  <--
     2.3842e+05     2.3842e+06             3.9316e-09       -17.216569304135
     9.5367e+05     9.5367e+06             9.8291e-10       -17.216569304138
     3.8147e+06     3.8147e+07             2.4573e-10       -17.216569304140

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 51.5615
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5923e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.186
    reference variance = 0.260778
====================================================
  Execution time = 3.5233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1885e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953743102
                                         uncertainty =       0.003209571771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318953743102
                                         uncertainty =       0.003209571771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399278698
  error estimate for blocks of size 2^( 2) =       0.000409504689
  error estimate for blocks of size 2^( 3) =       0.000418467509
  error estimate for blocks of size 2^( 4) =       0.000425129886
  error estimate for blocks of size 2^( 5) =       0.000429296307
  error estimate for blocks of size 2^( 6) =       0.000430911647
  error estimate for blocks of size 2^( 7) =       0.000432739093

      target function =                  N/A
              le_mean =     -17.215726628635
             les_mean =     296.700090149485
             stat err =       0.000429519233
             autocorr =       1.157212058970
              std dev =       0.564665349575
             le_variance =       0.318846957011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721572662864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215726628635       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215726628635       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215726628635       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215726628668       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215726628369       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215726628636       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215726628631       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 3.646265e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215726628635       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215726628635       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215726628635       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215726628635       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215726628708       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215726626511       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215726623130       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 9.115641e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215726628635       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215726628635       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215726628635       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215726633341       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215726621259       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215726604155       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215726601702       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 2.278932e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4585e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1367
    reference variance = 0.286345
====================================================
  Execution time = 3.4100e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1703e-01
  Total weights = 2.0000e+06
  Execution time = 3.1018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385418
                                         uncertainty =       0.002906201571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385418
                                         uncertainty =       0.002906201571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398140273
  error estimate for blocks of size 2^( 2) =       0.000407727738
  error estimate for blocks of size 2^( 3) =       0.000416343649
  error estimate for blocks of size 2^( 4) =       0.000422735954
  error estimate for blocks of size 2^( 5) =       0.000427115319
  error estimate for blocks of size 2^( 6) =       0.000429497230
  error estimate for blocks of size 2^( 7) =       0.000430757850

      target function =                  N/A
              le_mean =     -17.216766137660
             les_mean =     296.734067434424
             stat err =       0.000427526588
             autocorr =       1.153065659549
              std dev =       0.563055373893
             le_variance =       0.317031354070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385516
                                         uncertainty =       0.002906201572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385516
                                         uncertainty =       0.002906201572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398140273
  error estimate for blocks of size 2^( 2) =       0.000407727738
  error estimate for blocks of size 2^( 3) =       0.000416343649
  error estimate for blocks of size 2^( 4) =       0.000422735954
  error estimate for blocks of size 2^( 5) =       0.000427115319
  error estimate for blocks of size 2^( 6) =       0.000429497230
  error estimate for blocks of size 2^( 7) =       0.000430757850

      target function =                  N/A
              le_mean =     -17.216766137660
             les_mean =     296.734067434530
             stat err =       0.000427526588
             autocorr =       1.153065659485
              std dev =       0.563055373980
             le_variance =       0.317031354168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385467
                                         uncertainty =       0.002906201571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385467
                                         uncertainty =       0.002906201571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398140273
  error estimate for blocks of size 2^( 2) =       0.000407727738
  error estimate for blocks of size 2^( 3) =       0.000416343649
  error estimate for blocks of size 2^( 4) =       0.000422735954
  error estimate for blocks of size 2^( 5) =       0.000427115319
  error estimate for blocks of size 2^( 6) =       0.000429497230
  error estimate for blocks of size 2^( 7) =       0.000430757850

      target function =                  N/A
              le_mean =     -17.216766137660
             les_mean =     296.734067434477
             stat err =       0.000427526588
             autocorr =       1.153065659512
              std dev =       0.563055373936
             le_variance =       0.317031354119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385425
                                         uncertainty =       0.002906201571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317059385425
                                         uncertainty =       0.002906201571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398140273
  error estimate for blocks of size 2^( 2) =       0.000407727738
  error estimate for blocks of size 2^( 3) =       0.000416343649
  error estimate for blocks of size 2^( 4) =       0.000422735954
  error estimate for blocks of size 2^( 5) =       0.000427115319
  error estimate for blocks of size 2^( 6) =       0.000429497230
  error estimate for blocks of size 2^( 7) =       0.000430757850

      target function =                  N/A
              le_mean =     -17.216766137660
             les_mean =     296.734067434430
             stat err =       0.000427526588
             autocorr =       1.153065659555
              std dev =       0.563055373899
             le_variance =       0.317031354076


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216766137660        initial
     2.3842e+06     2.3842e+07             3.6463e-10       -17.216766137660  <--
     9.5367e+06     9.5367e+07             9.1156e-11       -17.216766137660
     3.8147e+07     3.8147e+08             2.2789e-11       -17.216766137660

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 4.9741e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4331e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1508
    reference variance = 0.24487
====================================================
  Execution time = 3.4958e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1677e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2513e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316707815335
                                         uncertainty =       0.003209341910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316707815335
                                         uncertainty =       0.003209341910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397973330
  error estimate for blocks of size 2^( 2) =       0.000407536975
  error estimate for blocks of size 2^( 3) =       0.000415898143
  error estimate for blocks of size 2^( 4) =       0.000421849269
  error estimate for blocks of size 2^( 5) =       0.000425763707
  error estimate for blocks of size 2^( 6) =       0.000427894518
  error estimate for blocks of size 2^( 7) =       0.000428323735

      target function =                  N/A
              le_mean =     -17.216368216866
             les_mean =     296.720099962463
             stat err =       0.000425957807
             autocorr =       1.145579485985
              std dev =       0.562819280170
             le_variance =       0.316765542131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721636821687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368216866       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368216867       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216368216868       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216368216874       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216368216855       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216368216900       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216368216818       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216368216544       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.441875e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368216866       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368216866       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216368216866       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216368216868       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216368217388       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216368216185       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216368216598       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216368217075       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 3.604689e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216368216866       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216368216866       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216368216866       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216368216318       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216368213512       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216368211290       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216368216705       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216368217665       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 9.011743e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406675 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4221e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.253257
====================================================
  Execution time = 3.4416e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2468e-01
  Total weights = 2.0000e+06
  Execution time = 3.1031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518938755
                                         uncertainty =       0.007978689917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518938755
                                         uncertainty =       0.007978689917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402913220
  error estimate for blocks of size 2^( 2) =       0.000412690340
  error estimate for blocks of size 2^( 3) =       0.000421432378
  error estimate for blocks of size 2^( 4) =       0.000428326129
  error estimate for blocks of size 2^( 5) =       0.000432483342
  error estimate for blocks of size 2^( 6) =       0.000435278053
  error estimate for blocks of size 2^( 7) =       0.000436803143

      target function =                  N/A
              le_mean =     -17.215985299128
             les_mean =     296.714827782432
             stat err =       0.000433222666
             autocorr =       1.156110401137
              std dev =       0.569805339559
             le_variance =       0.324678124990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518939145
                                         uncertainty =       0.007978689924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518939145
                                         uncertainty =       0.007978689924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402913220
  error estimate for blocks of size 2^( 2) =       0.000412690341
  error estimate for blocks of size 2^( 3) =       0.000421432378
  error estimate for blocks of size 2^( 4) =       0.000428326129
  error estimate for blocks of size 2^( 5) =       0.000432483342
  error estimate for blocks of size 2^( 6) =       0.000435278053
  error estimate for blocks of size 2^( 7) =       0.000436803143

      target function =                  N/A
              le_mean =     -17.215985299127
             les_mean =     296.714827782785
             stat err =       0.000433222667
             autocorr =       1.156110400731
              std dev =       0.569805339901
             le_variance =       0.324678125380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518938950
                                         uncertainty =       0.007978689920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518938950
                                         uncertainty =       0.007978689920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402913220
  error estimate for blocks of size 2^( 2) =       0.000412690340
  error estimate for blocks of size 2^( 3) =       0.000421432378
  error estimate for blocks of size 2^( 4) =       0.000428326129
  error estimate for blocks of size 2^( 5) =       0.000432483342
  error estimate for blocks of size 2^( 6) =       0.000435278053
  error estimate for blocks of size 2^( 7) =       0.000436803143

      target function =                  N/A
              le_mean =     -17.215985299127
             les_mean =     296.714827782608
             stat err =       0.000433222666
             autocorr =       1.156110400939
              std dev =       0.569805339730
             le_variance =       0.324678125185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518938779
                                         uncertainty =       0.007978689917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324518938779
                                         uncertainty =       0.007978689917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402913220
  error estimate for blocks of size 2^( 2) =       0.000412690340
  error estimate for blocks of size 2^( 3) =       0.000421432378
  error estimate for blocks of size 2^( 4) =       0.000428326129
  error estimate for blocks of size 2^( 5) =       0.000432483342
  error estimate for blocks of size 2^( 6) =       0.000435278053
  error estimate for blocks of size 2^( 7) =       0.000436803143

      target function =                  N/A
              le_mean =     -17.215985299128
             les_mean =     296.714827782454
             stat err =       0.000433222666
             autocorr =       1.156110401112
              std dev =       0.569805339580
             le_variance =       0.324678125014


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215985299128        initial  <--
     5.9605e+05     5.9605e+06             1.4419e-09       -17.215985299127
     2.3842e+06     2.3842e+07             3.6047e-10       -17.215985299127
     9.5367e+06     9.5367e+07             9.0117e-11       -17.215985299128

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.0687
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4294e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1898
    reference variance = 0.189761
====================================================
  Execution time = 3.4982e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1902e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319064587539
                                         uncertainty =       0.003920982215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319064587539
                                         uncertainty =       0.003920982215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399386552
  error estimate for blocks of size 2^( 2) =       0.000409225135
  error estimate for blocks of size 2^( 3) =       0.000417803700
  error estimate for blocks of size 2^( 4) =       0.000424203690
  error estimate for blocks of size 2^( 5) =       0.000428845606
  error estimate for blocks of size 2^( 6) =       0.000429496838
  error estimate for blocks of size 2^( 7) =       0.000431584800

      target function =                  N/A
              le_mean =     -17.216475694866
             les_mean =     296.726054428618
             stat err =       0.000428532733
             autocorr =       1.151280442219
              std dev =       0.564817878814
             le_variance =       0.319019236228


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647569487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475694866       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475694866       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475694866       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216475694866       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216475689961       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216475694931       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216475696298       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 1.538412e-10

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475694866       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475694866       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475694866       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216475695569       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216475694034       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216475694866       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216475690858       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 3.846034e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216475694866       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216475694866       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216475694866       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216475694866       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216475735539       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216475679131       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216475702179       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 9.615083e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408969 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4311e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2393
    reference variance = 0.23899
====================================================
  Execution time = 3.6079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1911e-01
  Total weights = 2.0000e+06
  Execution time = 3.0997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222724
                                         uncertainty =       0.006836497491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222724
                                         uncertainty =       0.006836497491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399442714
  error estimate for blocks of size 2^( 2) =       0.000408981892
  error estimate for blocks of size 2^( 3) =       0.000417688000
  error estimate for blocks of size 2^( 4) =       0.000424284378
  error estimate for blocks of size 2^( 5) =       0.000428159200
  error estimate for blocks of size 2^( 6) =       0.000429440535
  error estimate for blocks of size 2^( 7) =       0.000431447799

      target function =                  N/A
              le_mean =     -17.216413982154
             les_mean =     296.724019208253
             stat err =       0.000428332978
             autocorr =       1.149883967476
              std dev =       0.564897302956
             le_variance =       0.319108962887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222783
                                         uncertainty =       0.006836497492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222783
                                         uncertainty =       0.006836497492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399442714
  error estimate for blocks of size 2^( 2) =       0.000408981892
  error estimate for blocks of size 2^( 3) =       0.000417688000
  error estimate for blocks of size 2^( 4) =       0.000424284378
  error estimate for blocks of size 2^( 5) =       0.000428159200
  error estimate for blocks of size 2^( 6) =       0.000429440535
  error estimate for blocks of size 2^( 7) =       0.000431447799

      target function =                  N/A
              le_mean =     -17.216413982154
             les_mean =     296.724019208314
             stat err =       0.000428332978
             autocorr =       1.149883967433
              std dev =       0.564897303008
             le_variance =       0.319108962946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222754
                                         uncertainty =       0.006836497491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222754
                                         uncertainty =       0.006836497491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399442714
  error estimate for blocks of size 2^( 2) =       0.000408981892
  error estimate for blocks of size 2^( 3) =       0.000417688000
  error estimate for blocks of size 2^( 4) =       0.000424284378
  error estimate for blocks of size 2^( 5) =       0.000428159200
  error estimate for blocks of size 2^( 6) =       0.000429440535
  error estimate for blocks of size 2^( 7) =       0.000431447799

      target function =                  N/A
              le_mean =     -17.216413982154
             les_mean =     296.724019208283
             stat err =       0.000428332978
             autocorr =       1.149883967458
              std dev =       0.564897302982
             le_variance =       0.319108962917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222728
                                         uncertainty =       0.006836497491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319077222728
                                         uncertainty =       0.006836497491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399442714
  error estimate for blocks of size 2^( 2) =       0.000408981892
  error estimate for blocks of size 2^( 3) =       0.000417688000
  error estimate for blocks of size 2^( 4) =       0.000424284378
  error estimate for blocks of size 2^( 5) =       0.000428159200
  error estimate for blocks of size 2^( 6) =       0.000429440535
  error estimate for blocks of size 2^( 7) =       0.000431447799

      target function =                  N/A
              le_mean =     -17.216413982154
             les_mean =     296.724019208257
             stat err =       0.000428332978
             autocorr =       1.149883967470
              std dev =       0.564897302959
             le_variance =       0.319108962891


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216413982154        initial
     5.9605e+06     5.9605e+07             1.5384e-10       -17.216413982154  <--
     2.3842e+07     2.3842e+08             3.8460e-11       -17.216413982154
     9.5367e+07     9.5367e+08             9.6151e-12       -17.216413982154

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 5.1704e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286309e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6021e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2029
    reference variance = 0.400945
====================================================
  Execution time = 3.5220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2050e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320577732305
                                         uncertainty =       0.003323579188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320577732305
                                         uncertainty =       0.003323579188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400313337
  error estimate for blocks of size 2^( 2) =       0.000410035993
  error estimate for blocks of size 2^( 3) =       0.000418368288
  error estimate for blocks of size 2^( 4) =       0.000424988637
  error estimate for blocks of size 2^( 5) =       0.000428447736
  error estimate for blocks of size 2^( 6) =       0.000430611413
  error estimate for blocks of size 2^( 7) =       0.000431053421

      target function =                  N/A
              le_mean =     -17.216529730831
             les_mean =     296.729397348040
             stat err =       0.000428775302
             autocorr =       1.147253531206
              std dev =       0.566128550511
             le_variance =       0.320501535703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652973083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216529730831       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216529730831       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216529730832       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216529730827       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216529730432       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216529730174       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216529730913       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216529730643       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 6.722812e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216529730831       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216529730831       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216529730831       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216529730576       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216529730978       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216529726977       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216529729911       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216529725497       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 1.680704e-10

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216529730831       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216529730831       residual = 9.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216529730831       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216529737259       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216529717881       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216529730858       residual = 3.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216529742405       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216529770526       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 4.201748e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.411656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4497e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2063
    reference variance = 0.129926
====================================================
  Execution time = 3.4010e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2024e-01
  Total weights = 2.0000e+06
  Execution time = 3.0922e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303124
                                         uncertainty =       0.004176287726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303124
                                         uncertainty =       0.004176287726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400152334
  error estimate for blocks of size 2^( 2) =       0.000410101331
  error estimate for blocks of size 2^( 3) =       0.000418363921
  error estimate for blocks of size 2^( 4) =       0.000424354099
  error estimate for blocks of size 2^( 5) =       0.000428513685
  error estimate for blocks of size 2^( 6) =       0.000430046306
  error estimate for blocks of size 2^( 7) =       0.000430158265

      target function =                  N/A
              le_mean =     -17.217515971591
             les_mean =     296.763099852654
             stat err =       0.000428268089
             autocorr =       1.145462093374
              std dev =       0.565900857721
             le_variance =       0.320243780770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303206
                                         uncertainty =       0.004176287728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303206
                                         uncertainty =       0.004176287728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400152334
  error estimate for blocks of size 2^( 2) =       0.000410101331
  error estimate for blocks of size 2^( 3) =       0.000418363921
  error estimate for blocks of size 2^( 4) =       0.000424354099
  error estimate for blocks of size 2^( 5) =       0.000428513685
  error estimate for blocks of size 2^( 6) =       0.000430046306
  error estimate for blocks of size 2^( 7) =       0.000430158265

      target function =                  N/A
              le_mean =     -17.217515971592
             les_mean =     296.763099852755
             stat err =       0.000428268089
             autocorr =       1.145462093276
              std dev =       0.565900857794
             le_variance =       0.320243780852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303165
                                         uncertainty =       0.004176287727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303165
                                         uncertainty =       0.004176287727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400152334
  error estimate for blocks of size 2^( 2) =       0.000410101331
  error estimate for blocks of size 2^( 3) =       0.000418363921
  error estimate for blocks of size 2^( 4) =       0.000424354099
  error estimate for blocks of size 2^( 5) =       0.000428513685
  error estimate for blocks of size 2^( 6) =       0.000430046306
  error estimate for blocks of size 2^( 7) =       0.000430158265

      target function =                  N/A
              le_mean =     -17.217515971592
             les_mean =     296.763099852704
             stat err =       0.000428268089
             autocorr =       1.145462093332
              std dev =       0.565900857757
             le_variance =       0.320243780811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303129
                                         uncertainty =       0.004176287726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320249303129
                                         uncertainty =       0.004176287726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400152334
  error estimate for blocks of size 2^( 2) =       0.000410101331
  error estimate for blocks of size 2^( 3) =       0.000418363921
  error estimate for blocks of size 2^( 4) =       0.000424354099
  error estimate for blocks of size 2^( 5) =       0.000428513685
  error estimate for blocks of size 2^( 6) =       0.000430046306
  error estimate for blocks of size 2^( 7) =       0.000430158265

      target function =                  N/A
              le_mean =     -17.217515971591
             les_mean =     296.763099852660
             stat err =       0.000428268089
             autocorr =       1.145462093373
              std dev =       0.565900857726
             le_variance =       0.320243780775


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217515971591        initial
     1.4901e+06     1.4901e+07             6.7228e-10       -17.217515971592  <--
     5.9605e+06     5.9605e+07             1.6807e-10       -17.217515971592
     2.3842e+07     2.3842e+08             4.2017e-11       -17.217515971591

*****************************************************************************
Applying the update for shift_i =   1.4901e+06     and shift_s =   1.4901e+07
*****************************************************************************

  Execution time = 4.9616e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4118e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1046
    reference variance = 1.40357
====================================================
  Execution time = 3.4934e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3003e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330003294586
                                         uncertainty =       0.005319632700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330003294586
                                         uncertainty =       0.005319632700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406223246
  error estimate for blocks of size 2^( 2) =       0.000416080653
  error estimate for blocks of size 2^( 3) =       0.000424429500
  error estimate for blocks of size 2^( 4) =       0.000430565294
  error estimate for blocks of size 2^( 5) =       0.000435764954
  error estimate for blocks of size 2^( 6) =       0.000437556309
  error estimate for blocks of size 2^( 7) =       0.000438904113

      target function =                  N/A
              le_mean =     -17.216574803166
             les_mean =     296.740482439814
             stat err =       0.000435697667
             autocorr =       1.150378945598
              std dev =       0.574486424387
             le_variance =       0.330034651805


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657480317e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574803166       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216574803167       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574803171       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216574803176       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216574803188       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216574803642       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216574803639       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216574803180       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 2.489434e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574803166       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216574803166       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574803168       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216574803169       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216574803190       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216574803412       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216574802393       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216574801616       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 6.223588e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216574803166       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216574803166       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216574803167       residual = 8.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216574803032       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216574809632       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216574805989       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216574804326       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216574803617       residual = 1.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 1.555894e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.414300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4315e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1874
    reference variance = 0.583123
====================================================
  Execution time = 3.4069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1782e-01
  Total weights = 2.0000e+06
  Execution time = 3.0996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737651716
                                         uncertainty =       0.004105890679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737651716
                                         uncertainty =       0.004105890679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398636683
  error estimate for blocks of size 2^( 2) =       0.000408435565
  error estimate for blocks of size 2^( 3) =       0.000417144802
  error estimate for blocks of size 2^( 4) =       0.000423421043
  error estimate for blocks of size 2^( 5) =       0.000428261418
  error estimate for blocks of size 2^( 6) =       0.000431193905
  error estimate for blocks of size 2^( 7) =       0.000433006042

      target function =                  N/A
              le_mean =     -17.216470523306
             les_mean =     296.724679531705
             stat err =       0.000428970602
             autocorr =       1.157978614187
              std dev =       0.563757404165
             le_variance =       0.317822410751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737652244
                                         uncertainty =       0.004105890693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737652244
                                         uncertainty =       0.004105890693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398636684
  error estimate for blocks of size 2^( 2) =       0.000408435566
  error estimate for blocks of size 2^( 3) =       0.000417144802
  error estimate for blocks of size 2^( 4) =       0.000423421043
  error estimate for blocks of size 2^( 5) =       0.000428261419
  error estimate for blocks of size 2^( 6) =       0.000431193906
  error estimate for blocks of size 2^( 7) =       0.000433006042

      target function =                  N/A
              le_mean =     -17.216470523304
             les_mean =     296.724679532162
             stat err =       0.000428970602
             autocorr =       1.157978613680
              std dev =       0.563757404634
             le_variance =       0.317822411280

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737651980
                                         uncertainty =       0.004105890686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737651980
                                         uncertainty =       0.004105890686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398636684
  error estimate for blocks of size 2^( 2) =       0.000408435566
  error estimate for blocks of size 2^( 3) =       0.000417144802
  error estimate for blocks of size 2^( 4) =       0.000423421043
  error estimate for blocks of size 2^( 5) =       0.000428261418
  error estimate for blocks of size 2^( 6) =       0.000431193905
  error estimate for blocks of size 2^( 7) =       0.000433006042

      target function =                  N/A
              le_mean =     -17.216470523305
             les_mean =     296.724679531934
             stat err =       0.000428970602
             autocorr =       1.157978613935
              std dev =       0.563757404400
             le_variance =       0.317822411015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737651749
                                         uncertainty =       0.004105890680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737651749
                                         uncertainty =       0.004105890680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398636683
  error estimate for blocks of size 2^( 2) =       0.000408435565
  error estimate for blocks of size 2^( 3) =       0.000417144802
  error estimate for blocks of size 2^( 4) =       0.000423421043
  error estimate for blocks of size 2^( 5) =       0.000428261418
  error estimate for blocks of size 2^( 6) =       0.000431193905
  error estimate for blocks of size 2^( 7) =       0.000433006042

      target function =                  N/A
              le_mean =     -17.216470523306
             les_mean =     296.724679531734
             stat err =       0.000428970602
             autocorr =       1.157978614146
              std dev =       0.563757404194
             le_variance =       0.317822410784


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216470523306        initial  <--
     3.7253e+05     3.7253e+06             2.4894e-09       -17.216470523304
     1.4901e+06     1.4901e+07             6.2236e-10       -17.216470523305
     5.9605e+06     5.9605e+07             1.5559e-10       -17.216470523306

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.6886
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4008e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1837
    reference variance = 0.163124
====================================================
  Execution time = 3.5477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3004e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3114e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330015057229
                                         uncertainty =       0.006675750034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330015057229
                                         uncertainty =       0.006675750034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406229667
  error estimate for blocks of size 2^( 2) =       0.000416147813
  error estimate for blocks of size 2^( 3) =       0.000424691254
  error estimate for blocks of size 2^( 4) =       0.000431643606
  error estimate for blocks of size 2^( 5) =       0.000435721035
  error estimate for blocks of size 2^( 6) =       0.000438984322
  error estimate for blocks of size 2^( 7) =       0.000440049122

      target function =                  N/A
              le_mean =     -17.216717105997
             les_mean =     296.745392827456
             stat err =       0.000436599521
             autocorr =       1.155109716415
              std dev =       0.574495504367
             le_variance =       0.330045084538


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671710600e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717105997       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717105997       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717105998       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717105998       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717106626       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717105448       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717105701       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 2.518904e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717105997       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717105997       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717105997       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717105997       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717109533       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717116015       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717101280       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 6.297238e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717105997       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717105997       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717105997       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717105997       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717105997       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717130696       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717107543       residual = 8.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 1.574302e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.416533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4799e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2284
    reference variance = 0.189064
====================================================
  Execution time = 3.3969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2238e-01
  Total weights = 2.0000e+06
  Execution time = 3.1051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185074
                                         uncertainty =       0.005597063688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185074
                                         uncertainty =       0.005597063688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401483225
  error estimate for blocks of size 2^( 2) =       0.000411345122
  error estimate for blocks of size 2^( 3) =       0.000420382788
  error estimate for blocks of size 2^( 4) =       0.000427261057
  error estimate for blocks of size 2^( 5) =       0.000431936396
  error estimate for blocks of size 2^( 6) =       0.000434428492
  error estimate for blocks of size 2^( 7) =       0.000435010482

      target function =                  N/A
              le_mean =     -17.215333126648
             les_mean =     296.690072059592
             stat err =       0.000432159107
             autocorr =       1.158650706617
              std dev =       0.567783021347
             le_variance =       0.322377559330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185143
                                         uncertainty =       0.005597063689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185143
                                         uncertainty =       0.005597063689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401483225
  error estimate for blocks of size 2^( 2) =       0.000411345122
  error estimate for blocks of size 2^( 3) =       0.000420382788
  error estimate for blocks of size 2^( 4) =       0.000427261058
  error estimate for blocks of size 2^( 5) =       0.000431936396
  error estimate for blocks of size 2^( 6) =       0.000434428492
  error estimate for blocks of size 2^( 7) =       0.000435010482

      target function =                  N/A
              le_mean =     -17.215333126648
             les_mean =     296.690072059662
             stat err =       0.000432159107
             autocorr =       1.158650706563
              std dev =       0.567783021408
             le_variance =       0.322377559399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185108
                                         uncertainty =       0.005597063689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185108
                                         uncertainty =       0.005597063689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401483225
  error estimate for blocks of size 2^( 2) =       0.000411345122
  error estimate for blocks of size 2^( 3) =       0.000420382788
  error estimate for blocks of size 2^( 4) =       0.000427261057
  error estimate for blocks of size 2^( 5) =       0.000431936396
  error estimate for blocks of size 2^( 6) =       0.000434428492
  error estimate for blocks of size 2^( 7) =       0.000435010482

      target function =                  N/A
              le_mean =     -17.215333126648
             les_mean =     296.690072059627
             stat err =       0.000432159107
             autocorr =       1.158650706595
              std dev =       0.567783021377
             le_variance =       0.322377559364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185078
                                         uncertainty =       0.005597063688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322421185078
                                         uncertainty =       0.005597063688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401483225
  error estimate for blocks of size 2^( 2) =       0.000411345122
  error estimate for blocks of size 2^( 3) =       0.000420382788
  error estimate for blocks of size 2^( 4) =       0.000427261057
  error estimate for blocks of size 2^( 5) =       0.000431936396
  error estimate for blocks of size 2^( 6) =       0.000434428492
  error estimate for blocks of size 2^( 7) =       0.000435010482

      target function =                  N/A
              le_mean =     -17.215333126648
             les_mean =     296.690072059597
             stat err =       0.000432159107
             autocorr =       1.158650706626
              std dev =       0.567783021351
             le_variance =       0.322377559334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215333126648        initial
     3.7253e+06     3.7253e+07             2.5189e-10       -17.215333126648  <--
     1.4901e+07     1.4901e+08             6.2972e-11       -17.215333126648
     5.9605e+07     5.9605e+08             1.5743e-11       -17.215333126648

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 5.1550e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.6353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2228
    reference variance = 0.183368
====================================================
  Execution time = 3.5034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317086345219
                                         uncertainty =       0.003135476192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317086345219
                                         uncertainty =       0.003135476192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398162656
  error estimate for blocks of size 2^( 2) =       0.000407933563
  error estimate for blocks of size 2^( 3) =       0.000416320149
  error estimate for blocks of size 2^( 4) =       0.000422810287
  error estimate for blocks of size 2^( 5) =       0.000426615359
  error estimate for blocks of size 2^( 6) =       0.000428108508
  error estimate for blocks of size 2^( 7) =       0.000428868161

      target function =                  N/A
              le_mean =     -17.216294018845
             les_mean =     296.717846585694
             stat err =       0.000426600579
             autocorr =       1.147946984321
              std dev =       0.563087027822
             le_variance =       0.317067000902


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629401885e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216294018845       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216294018845       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216294018847       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216294018871       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216294016089       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216294019017       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216294019466       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 1.103252e-09

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216294018845       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216294018845       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216294018846       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216294018846       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216294018202       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216294019295       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216294019075       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 2.758130e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216294018845       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216294018845       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216294018845       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216294018604       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216294016675       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216294023783       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216294015901       residual = 9.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 6.895317e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.418825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4310e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056884e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2875
    reference variance = 0.417753
====================================================
  Execution time = 3.4505e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2133e-01
  Total weights = 2.0000e+06
  Execution time = 3.0983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719651
                                         uncertainty =       0.003827201568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719651
                                         uncertainty =       0.003827201568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400828928
  error estimate for blocks of size 2^( 2) =       0.000410928671
  error estimate for blocks of size 2^( 3) =       0.000419553038
  error estimate for blocks of size 2^( 4) =       0.000425906978
  error estimate for blocks of size 2^( 5) =       0.000429337603
  error estimate for blocks of size 2^( 6) =       0.000430691170
  error estimate for blocks of size 2^( 7) =       0.000433001961

      target function =                  N/A
              le_mean =     -17.216532188867
             les_mean =     296.730308108569
             stat err =       0.000429734428
             autocorr =       1.149429086822
              std dev =       0.566857706084
             le_variance =       0.321327658947

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719787
                                         uncertainty =       0.003827201569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719787
                                         uncertainty =       0.003827201569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400828928
  error estimate for blocks of size 2^( 2) =       0.000410928671
  error estimate for blocks of size 2^( 3) =       0.000419553038
  error estimate for blocks of size 2^( 4) =       0.000425906978
  error estimate for blocks of size 2^( 5) =       0.000429337603
  error estimate for blocks of size 2^( 6) =       0.000430691170
  error estimate for blocks of size 2^( 7) =       0.000433001961

      target function =                  N/A
              le_mean =     -17.216532188867
             les_mean =     296.730308108719
             stat err =       0.000429734428
             autocorr =       1.149429086656
              std dev =       0.566857706204
             le_variance =       0.321327659083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719719
                                         uncertainty =       0.003827201569

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719719
                                         uncertainty =       0.003827201569

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400828928
  error estimate for blocks of size 2^( 2) =       0.000410928671
  error estimate for blocks of size 2^( 3) =       0.000419553038
  error estimate for blocks of size 2^( 4) =       0.000425906978
  error estimate for blocks of size 2^( 5) =       0.000429337603
  error estimate for blocks of size 2^( 6) =       0.000430691170
  error estimate for blocks of size 2^( 7) =       0.000433001961

      target function =                  N/A
              le_mean =     -17.216532188867
             les_mean =     296.730308108644
             stat err =       0.000429734428
             autocorr =       1.149429086747
              std dev =       0.566857706144
             le_variance =       0.321327659015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719659
                                         uncertainty =       0.003827201568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321299719659
                                         uncertainty =       0.003827201568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400828928
  error estimate for blocks of size 2^( 2) =       0.000410928671
  error estimate for blocks of size 2^( 3) =       0.000419553038
  error estimate for blocks of size 2^( 4) =       0.000425906978
  error estimate for blocks of size 2^( 5) =       0.000429337603
  error estimate for blocks of size 2^( 6) =       0.000430691170
  error estimate for blocks of size 2^( 7) =       0.000433001961

      target function =                  N/A
              le_mean =     -17.216532188867
             les_mean =     296.730308108579
             stat err =       0.000429734428
             autocorr =       1.149429086813
              std dev =       0.566857706091
             le_variance =       0.321327658955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216532188867        initial
     9.3132e+05     9.3132e+06             1.1033e-09       -17.216532188867  <--
     3.7253e+06     3.7253e+07             2.7581e-10       -17.216532188867
     1.4901e+07     1.4901e+08             6.8953e-11       -17.216532188867

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 5.0126e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4441e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2516
    reference variance = 0.21014
====================================================
  Execution time = 3.4508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2910e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.0810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329049377111
                                         uncertainty =       0.007528112384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329049377111
                                         uncertainty =       0.007528112384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405647945
  error estimate for blocks of size 2^( 2) =       0.000414926029
  error estimate for blocks of size 2^( 3) =       0.000423665748
  error estimate for blocks of size 2^( 4) =       0.000429702596
  error estimate for blocks of size 2^( 5) =       0.000434388029
  error estimate for blocks of size 2^( 6) =       0.000436212208
  error estimate for blocks of size 2^( 7) =       0.000435795706

      target function =                  N/A
              le_mean =     -17.216546078580
             les_mean =     296.738559222583
             stat err =       0.000434024635
             autocorr =       1.144801526483
              std dev =       0.573672825969
             le_variance =       0.329100511255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721654607858e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546078580       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546078583       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546078588       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546078595       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546078593       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546078662       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546078609       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 4.439171e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546078580       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546078581       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546078582       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546078669       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546079201       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546078583       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546078541       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 1.109793e-09

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216546078580       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216546078580       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216546078581       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216546079410       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216546079086       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216546079595       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216546078537       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 2.774482e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.421022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3600e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2043
    reference variance = 0.425853
====================================================
  Execution time = 3.4194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1579e-01
  Total weights = 2.0000e+06
  Execution time = 3.1668e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831061823
                                         uncertainty =       0.003369343609

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831061823
                                         uncertainty =       0.003369343609

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397357909
  error estimate for blocks of size 2^( 2) =       0.000406944510
  error estimate for blocks of size 2^( 3) =       0.000415792664
  error estimate for blocks of size 2^( 4) =       0.000421749943
  error estimate for blocks of size 2^( 5) =       0.000426365719
  error estimate for blocks of size 2^( 6) =       0.000426724276
  error estimate for blocks of size 2^( 7) =       0.000428320085

      target function =                  N/A
              le_mean =     -17.215759730763
             les_mean =     296.698169565885
             stat err =       0.000425790006
             autocorr =       1.148225540001
              std dev =       0.561948944663
             le_variance =       0.315786616408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831062735
                                         uncertainty =       0.003369343619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831062735
                                         uncertainty =       0.003369343619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397357910
  error estimate for blocks of size 2^( 2) =       0.000406944511
  error estimate for blocks of size 2^( 3) =       0.000415792665
  error estimate for blocks of size 2^( 4) =       0.000421749944
  error estimate for blocks of size 2^( 5) =       0.000426365719
  error estimate for blocks of size 2^( 6) =       0.000426724277
  error estimate for blocks of size 2^( 7) =       0.000428320085

      target function =                  N/A
              le_mean =     -17.215759730763
             les_mean =     296.698169566791
             stat err =       0.000425790006
             autocorr =       1.148225539089
              std dev =       0.561948945475
             le_variance =       0.315786617320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831062279
                                         uncertainty =       0.003369343614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831062279
                                         uncertainty =       0.003369343614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397357910
  error estimate for blocks of size 2^( 2) =       0.000406944510
  error estimate for blocks of size 2^( 3) =       0.000415792664
  error estimate for blocks of size 2^( 4) =       0.000421749944
  error estimate for blocks of size 2^( 5) =       0.000426365719
  error estimate for blocks of size 2^( 6) =       0.000426724277
  error estimate for blocks of size 2^( 7) =       0.000428320085

      target function =                  N/A
              le_mean =     -17.215759730763
             les_mean =     296.698169566338
             stat err =       0.000425790006
             autocorr =       1.148225539539
              std dev =       0.561948945069
             le_variance =       0.315786616864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831061880
                                         uncertainty =       0.003369343610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315831061880
                                         uncertainty =       0.003369343610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397357909
  error estimate for blocks of size 2^( 2) =       0.000406944510
  error estimate for blocks of size 2^( 3) =       0.000415792664
  error estimate for blocks of size 2^( 4) =       0.000421749943
  error estimate for blocks of size 2^( 5) =       0.000426365719
  error estimate for blocks of size 2^( 6) =       0.000426724276
  error estimate for blocks of size 2^( 7) =       0.000428320085

      target function =                  N/A
              le_mean =     -17.215759730763
             les_mean =     296.698169565942
             stat err =       0.000425790006
             autocorr =       1.148225539946
              std dev =       0.561948944714
             le_variance =       0.315786616465


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215759730763        initial  <--
     2.3283e+05     2.3283e+06             4.4392e-09       -17.215759730763
     9.3132e+05     9.3132e+06             1.1098e-09       -17.215759730763
     3.7253e+06     3.7253e+07             2.7745e-10       -17.215759730763

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.9342
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3544e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1678
    reference variance = 0.229822
====================================================
  Execution time = 3.4533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1411e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 8.9964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314189957914
                                         uncertainty =       0.002514498253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314189957914
                                         uncertainty =       0.002514498253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396301650
  error estimate for blocks of size 2^( 2) =       0.000406285817
  error estimate for blocks of size 2^( 3) =       0.000414942106
  error estimate for blocks of size 2^( 4) =       0.000421297895
  error estimate for blocks of size 2^( 5) =       0.000425749215
  error estimate for blocks of size 2^( 6) =       0.000427290496
  error estimate for blocks of size 2^( 7) =       0.000428412496

      target function =                  N/A
              le_mean =     -17.216590695774
             les_mean =     296.725105025125
             stat err =       0.000425687525
             autocorr =       1.153798805595
              std dev =       0.560455168911
             le_variance =       0.314109996359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721659069577e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590695774       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590695775       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216590695775       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216590695776       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216590695529       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216590695933       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216590696163       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216590696388       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 3.937000e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590695774       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590695774       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216590695775       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216590695775       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216590700605       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216590695482       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216590690000       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216590696384       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 9.842498e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216590695774       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216590695774       residual = 9.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216590695774       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216590695774       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216590678897       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216590700616       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216590700520       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216590682808       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 2.460626e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.423653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3541e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.3182
    reference variance = 0.539891
====================================================
  Execution time = 3.3962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1778e-01
  Total weights = 2.0000e+06
  Execution time = 3.1188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099892
                                         uncertainty =       0.004073839411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099892
                                         uncertainty =       0.004073839411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398611569
  error estimate for blocks of size 2^( 2) =       0.000408264983
  error estimate for blocks of size 2^( 3) =       0.000416412437
  error estimate for blocks of size 2^( 4) =       0.000423045565
  error estimate for blocks of size 2^( 5) =       0.000427439321
  error estimate for blocks of size 2^( 6) =       0.000430415304
  error estimate for blocks of size 2^( 7) =       0.000430493588

      target function =                  N/A
              le_mean =     -17.216981982909
             les_mean =     296.742250806343
             stat err =       0.000427848445
             autocorr =       1.152073315576
              std dev =       0.563721886596
             le_variance =       0.317782365427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099964
                                         uncertainty =       0.004073839412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099964
                                         uncertainty =       0.004073839412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398611569
  error estimate for blocks of size 2^( 2) =       0.000408264983
  error estimate for blocks of size 2^( 3) =       0.000416412437
  error estimate for blocks of size 2^( 4) =       0.000423045565
  error estimate for blocks of size 2^( 5) =       0.000427439321
  error estimate for blocks of size 2^( 6) =       0.000430415304
  error estimate for blocks of size 2^( 7) =       0.000430493588

      target function =                  N/A
              le_mean =     -17.216981982909
             les_mean =     296.742250806423
             stat err =       0.000427848445
             autocorr =       1.152073315500
              std dev =       0.563721886659
             le_variance =       0.317782365499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099928
                                         uncertainty =       0.004073839411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099928
                                         uncertainty =       0.004073839411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398611569
  error estimate for blocks of size 2^( 2) =       0.000408264983
  error estimate for blocks of size 2^( 3) =       0.000416412437
  error estimate for blocks of size 2^( 4) =       0.000423045565
  error estimate for blocks of size 2^( 5) =       0.000427439321
  error estimate for blocks of size 2^( 6) =       0.000430415304
  error estimate for blocks of size 2^( 7) =       0.000430493588

      target function =                  N/A
              le_mean =     -17.216981982909
             les_mean =     296.742250806383
             stat err =       0.000427848445
             autocorr =       1.152073315532
              std dev =       0.563721886627
             le_variance =       0.317782365463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099897
                                         uncertainty =       0.004073839411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317838099897
                                         uncertainty =       0.004073839411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398611569
  error estimate for blocks of size 2^( 2) =       0.000408264983
  error estimate for blocks of size 2^( 3) =       0.000416412437
  error estimate for blocks of size 2^( 4) =       0.000423045565
  error estimate for blocks of size 2^( 5) =       0.000427439321
  error estimate for blocks of size 2^( 6) =       0.000430415304
  error estimate for blocks of size 2^( 7) =       0.000430493588

      target function =                  N/A
              le_mean =     -17.216981982909
             les_mean =     296.742250806348
             stat err =       0.000427848445
             autocorr =       1.152073315571
              std dev =       0.563721886600
             le_variance =       0.317782365431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216981982909        initial
     2.3283e+06     2.3283e+07             3.9370e-10       -17.216981982909  <--
     9.3132e+06     9.3132e+07             9.8425e-11       -17.216981982909
     3.7253e+07     3.7253e+08             2.4606e-11       -17.216981982909

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 4.9631e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1522
    reference variance = 0.373916
====================================================
  Execution time = 3.6234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1451e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.1460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314482575332
                                         uncertainty =       0.003813889045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314482575332
                                         uncertainty =       0.003813889045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396552983
  error estimate for blocks of size 2^( 2) =       0.000406242753
  error estimate for blocks of size 2^( 3) =       0.000415021528
  error estimate for blocks of size 2^( 4) =       0.000421252449
  error estimate for blocks of size 2^( 5) =       0.000426039095
  error estimate for blocks of size 2^( 6) =       0.000428033781
  error estimate for blocks of size 2^( 7) =       0.000428829628

      target function =                  N/A
              le_mean =     -17.215860192112
             les_mean =     296.700350533413
             stat err =       0.000426038738
             autocorr =       1.154238983332
              std dev =       0.560810606462
             le_variance =       0.314508536321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721586019211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215860192112       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215860192113       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215860192114       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215860192134       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215860192239       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215860191861       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215860192334       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215860192179       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 1.620726e-09

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215860192112       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215860192112       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215860192113       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215860192123       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215860192113       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215860193878       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215860193905       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215860196473       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 4.051822e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215860192112       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215860192112       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215860192112       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215860194067       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215860195736       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215860185496       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215860187072       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215860196007       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 1.012955e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.426391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5392e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1907
    reference variance = 0.181696
====================================================
  Execution time = 3.4109e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3002e-01
  Total weights = 2.0000e+06
  Execution time = 3.0980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059920564
                                         uncertainty =       0.013117880793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059920564
                                         uncertainty =       0.013117880793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406211955
  error estimate for blocks of size 2^( 2) =       0.000415494404
  error estimate for blocks of size 2^( 3) =       0.000423459659
  error estimate for blocks of size 2^( 4) =       0.000429489385
  error estimate for blocks of size 2^( 5) =       0.000433072830
  error estimate for blocks of size 2^( 6) =       0.000435857868
  error estimate for blocks of size 2^( 7) =       0.000438679056

      target function =                  N/A
              le_mean =     -17.216230899729
             les_mean =     296.728622532432
             stat err =       0.000434274785
             autocorr =       1.142941037593
              std dev =       0.574470455859
             le_variance =       0.330016304655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059921142
                                         uncertainty =       0.013117880807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059921142
                                         uncertainty =       0.013117880807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406211955
  error estimate for blocks of size 2^( 2) =       0.000415494405
  error estimate for blocks of size 2^( 3) =       0.000423459659
  error estimate for blocks of size 2^( 4) =       0.000429489386
  error estimate for blocks of size 2^( 5) =       0.000433072830
  error estimate for blocks of size 2^( 6) =       0.000435857869
  error estimate for blocks of size 2^( 7) =       0.000438679056

      target function =                  N/A
              le_mean =     -17.216230899728
             les_mean =     296.728622532983
             stat err =       0.000434274785
             autocorr =       1.142941037103
              std dev =       0.574470456362
             le_variance =       0.330016305233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059920853
                                         uncertainty =       0.013117880800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059920853
                                         uncertainty =       0.013117880800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406211955
  error estimate for blocks of size 2^( 2) =       0.000415494404
  error estimate for blocks of size 2^( 3) =       0.000423459659
  error estimate for blocks of size 2^( 4) =       0.000429489385
  error estimate for blocks of size 2^( 5) =       0.000433072830
  error estimate for blocks of size 2^( 6) =       0.000435857869
  error estimate for blocks of size 2^( 7) =       0.000438679056

      target function =                  N/A
              le_mean =     -17.216230899729
             les_mean =     296.728622532708
             stat err =       0.000434274785
             autocorr =       1.142941037346
              std dev =       0.574470456111
             le_variance =       0.330016304944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059920600
                                         uncertainty =       0.013117880794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330059920600
                                         uncertainty =       0.013117880794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406211955
  error estimate for blocks of size 2^( 2) =       0.000415494404
  error estimate for blocks of size 2^( 3) =       0.000423459659
  error estimate for blocks of size 2^( 4) =       0.000429489385
  error estimate for blocks of size 2^( 5) =       0.000433072830
  error estimate for blocks of size 2^( 6) =       0.000435857868
  error estimate for blocks of size 2^( 7) =       0.000438679056

      target function =                  N/A
              le_mean =     -17.216230899729
             les_mean =     296.728622532467
             stat err =       0.000434274785
             autocorr =       1.142941037562
              std dev =       0.574470455891
             le_variance =       0.330016304691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216230899729        initial  <--
     5.8208e+05     5.8208e+06             1.6207e-09       -17.216230899728
     2.3283e+06     2.3283e+07             4.0518e-10       -17.216230899729
     9.3132e+06     9.3132e+07             1.0130e-10       -17.216230899729

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.7309
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5128e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3322
    reference variance = 0.683748
====================================================
  Execution time = 3.4535e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1794e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317982942368
                                         uncertainty =       0.003141904510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317982942368
                                         uncertainty =       0.003141904510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398712640
  error estimate for blocks of size 2^( 2) =       0.000408482226
  error estimate for blocks of size 2^( 3) =       0.000417264392
  error estimate for blocks of size 2^( 4) =       0.000423312114
  error estimate for blocks of size 2^( 5) =       0.000428582161
  error estimate for blocks of size 2^( 6) =       0.000431152595
  error estimate for blocks of size 2^( 7) =       0.000433109877

      target function =                  N/A
              le_mean =     -17.216140209382
             les_mean =     296.713427089147
             stat err =       0.000429039187
             autocorr =       1.157907622189
              std dev =       0.563864823371
             le_variance =       0.317943539035


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721614020938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216140209382       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216140209382       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216140209382       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216140207356       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216140210753       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216140203592       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216140208206       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216140207049       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 1.695305e-10

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216140209382       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216140209382       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216140209382       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216140206600       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216140189462       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216140215051       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216140209781       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216140207339       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 4.238270e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216140209382       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216140209382       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216140209382       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216140210393       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216140156855       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216140178210       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216140211989       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216140219950       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 1.059574e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.429128 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3751e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.270225
====================================================
  Execution time = 3.4421e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2249e-01
  Total weights = 2.0000e+06
  Execution time = 3.1137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836770
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836770
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401556158
  error estimate for blocks of size 2^( 2) =       0.000411311516
  error estimate for blocks of size 2^( 3) =       0.000419202703
  error estimate for blocks of size 2^( 4) =       0.000425909757
  error estimate for blocks of size 2^( 5) =       0.000429112853
  error estimate for blocks of size 2^( 6) =       0.000431754048
  error estimate for blocks of size 2^( 7) =       0.000432710617

      target function =                  N/A
              le_mean =     -17.216115149360
             les_mean =     296.717115370225
             stat err =       0.000429871819
             autocorr =       1.146001984257
              std dev =       0.567886164150
             le_variance =       0.322494695433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836819
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836819
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401556158
  error estimate for blocks of size 2^( 2) =       0.000411311516
  error estimate for blocks of size 2^( 3) =       0.000419202703
  error estimate for blocks of size 2^( 4) =       0.000425909757
  error estimate for blocks of size 2^( 5) =       0.000429112853
  error estimate for blocks of size 2^( 6) =       0.000431754048
  error estimate for blocks of size 2^( 7) =       0.000432710617

      target function =                  N/A
              le_mean =     -17.216115149361
             les_mean =     296.717115370283
             stat err =       0.000429871819
             autocorr =       1.146001984226
              std dev =       0.567886164193
             le_variance =       0.322494695482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836794
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836794
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401556158
  error estimate for blocks of size 2^( 2) =       0.000411311516
  error estimate for blocks of size 2^( 3) =       0.000419202703
  error estimate for blocks of size 2^( 4) =       0.000425909757
  error estimate for blocks of size 2^( 5) =       0.000429112853
  error estimate for blocks of size 2^( 6) =       0.000431754048
  error estimate for blocks of size 2^( 7) =       0.000432710617

      target function =                  N/A
              le_mean =     -17.216115149361
             les_mean =     296.717115370254
             stat err =       0.000429871819
             autocorr =       1.146001984243
              std dev =       0.567886164171
             le_variance =       0.322494695457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836773
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322437836773
                                         uncertainty =       0.005680649581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401556158
  error estimate for blocks of size 2^( 2) =       0.000411311516
  error estimate for blocks of size 2^( 3) =       0.000419202703
  error estimate for blocks of size 2^( 4) =       0.000425909757
  error estimate for blocks of size 2^( 5) =       0.000429112853
  error estimate for blocks of size 2^( 6) =       0.000431754048
  error estimate for blocks of size 2^( 7) =       0.000432710617

      target function =                  N/A
              le_mean =     -17.216115149360
             les_mean =     296.717115370228
             stat err =       0.000429871819
             autocorr =       1.146001984250
              std dev =       0.567886164153
             le_variance =       0.322494695436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216115149360        initial
     5.8208e+06     5.8208e+07             1.6953e-10       -17.216115149361  <--
     2.3283e+07     2.3283e+08             4.2383e-11       -17.216115149361
     9.3132e+07     9.3132e+08             1.0596e-11       -17.216115149360

*****************************************************************************
Applying the update for shift_i =   5.8208e+06     and shift_s =   5.8208e+07
*****************************************************************************

  Execution time = 5.0122e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3880e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2349
    reference variance = 0.279277
====================================================
  Execution time = 3.4819e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2975e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329842300336
                                         uncertainty =       0.008755614890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329842300336
                                         uncertainty =       0.008755614890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406046358
  error estimate for blocks of size 2^( 2) =       0.000415546291
  error estimate for blocks of size 2^( 3) =       0.000423914667
  error estimate for blocks of size 2^( 4) =       0.000429639292
  error estimate for blocks of size 2^( 5) =       0.000432627188
  error estimate for blocks of size 2^( 6) =       0.000434984247
  error estimate for blocks of size 2^( 7) =       0.000434343691

      target function =                  N/A
              le_mean =     -17.216441042022
             les_mean =     296.735589277559
             stat err =       0.000432898605
             autocorr =       1.136635284282
              std dev =       0.574236265835
             le_variance =       0.329747289001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721644104202e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441042022       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216441042023       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216441042024       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216441042024       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216441041872       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216441042318       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216441042662       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216441041739       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 6.531075e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441042022       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216441042023       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216441042023       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216441042023       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216441042023       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216441040882       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216441041866       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216441042882       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 1.632769e-10

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216441042022       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216441042022       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216441042022       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216441041909       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216441049337       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216441032855       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216441050432       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216441053140       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 4.081915e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.431825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.4043e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2757
    reference variance = 0.509277
====================================================
  Execution time = 3.4434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1896e-01
  Total weights = 2.0000e+06
  Execution time = 3.1037e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117517
                                         uncertainty =       0.003606515396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117517
                                         uncertainty =       0.003606515396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399352544
  error estimate for blocks of size 2^( 2) =       0.000409013833
  error estimate for blocks of size 2^( 3) =       0.000417942958
  error estimate for blocks of size 2^( 4) =       0.000424263559
  error estimate for blocks of size 2^( 5) =       0.000428214209
  error estimate for blocks of size 2^( 6) =       0.000431060584
  error estimate for blocks of size 2^( 7) =       0.000433786400

      target function =                  N/A
              le_mean =     -17.216568112101
             les_mean =     296.729182308295
             stat err =       0.000429331188
             autocorr =       1.155771457598
              std dev =       0.564769784219
             le_variance =       0.318964909166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117616
                                         uncertainty =       0.003606515397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117616
                                         uncertainty =       0.003606515397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399352544
  error estimate for blocks of size 2^( 2) =       0.000409013833
  error estimate for blocks of size 2^( 3) =       0.000417942958
  error estimate for blocks of size 2^( 4) =       0.000424263559
  error estimate for blocks of size 2^( 5) =       0.000428214209
  error estimate for blocks of size 2^( 6) =       0.000431060584
  error estimate for blocks of size 2^( 7) =       0.000433786400

      target function =                  N/A
              le_mean =     -17.216568112101
             les_mean =     296.729182308381
             stat err =       0.000429331188
             autocorr =       1.155771457471
              std dev =       0.564769784306
             le_variance =       0.318964909266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117567
                                         uncertainty =       0.003606515396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117567
                                         uncertainty =       0.003606515396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399352544
  error estimate for blocks of size 2^( 2) =       0.000409013833
  error estimate for blocks of size 2^( 3) =       0.000417942958
  error estimate for blocks of size 2^( 4) =       0.000424263559
  error estimate for blocks of size 2^( 5) =       0.000428214209
  error estimate for blocks of size 2^( 6) =       0.000431060584
  error estimate for blocks of size 2^( 7) =       0.000433786400

      target function =                  N/A
              le_mean =     -17.216568112101
             les_mean =     296.729182308338
             stat err =       0.000429331188
             autocorr =       1.155771457541
              std dev =       0.564769784262
             le_variance =       0.318964909216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117523
                                         uncertainty =       0.003606515396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318946117523
                                         uncertainty =       0.003606515396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399352544
  error estimate for blocks of size 2^( 2) =       0.000409013833
  error estimate for blocks of size 2^( 3) =       0.000417942958
  error estimate for blocks of size 2^( 4) =       0.000424263559
  error estimate for blocks of size 2^( 5) =       0.000428214209
  error estimate for blocks of size 2^( 6) =       0.000431060584
  error estimate for blocks of size 2^( 7) =       0.000433786400

      target function =                  N/A
              le_mean =     -17.216568112101
             les_mean =     296.729182308300
             stat err =       0.000429331188
             autocorr =       1.155771457590
              std dev =       0.564769784224
             le_variance =       0.318964909172


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216568112101        initial  <--
     1.4552e+06     1.4552e+07             6.5311e-10       -17.216568112101
     5.8208e+06     5.8208e+07             1.6328e-10       -17.216568112101
     2.3283e+07     2.3283e+08             4.0819e-11       -17.216568112101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 50.0931
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.4142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1835
    reference variance = 0.265277
====================================================
  Execution time = 3.6193e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2096e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321021247778
                                         uncertainty =       0.005817323551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321021247778
                                         uncertainty =       0.005817323551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400597286
  error estimate for blocks of size 2^( 2) =       0.000409722349
  error estimate for blocks of size 2^( 3) =       0.000418158933
  error estimate for blocks of size 2^( 4) =       0.000424586780
  error estimate for blocks of size 2^( 5) =       0.000428602684
  error estimate for blocks of size 2^( 6) =       0.000431232438
  error estimate for blocks of size 2^( 7) =       0.000434204912

      target function =                  N/A
              le_mean =     -17.216461506349
             les_mean =     296.727503009702
             stat err =       0.000429656704
             autocorr =       1.150342538412
              std dev =       0.566530114440
             le_variance =       0.320956370567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646150635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461506349       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461506349       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461506350       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461503318       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461417024       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461511726       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461502432       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 6.141064e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461506349       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461506349       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461506349       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461505555       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461499147       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461476507       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461506673       residual = 9.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 1.535280e-11

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216461506349       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216461506349       residual = 8.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216461506349       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216461520637       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216461497346       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216461453999       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216461602141       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 3.838193e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.434095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.5426e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2027
    reference variance = 0.197157
====================================================
  Execution time = 3.4347e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3595e-01
  Total weights = 2.0000e+06
  Execution time = 3.0962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774395
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774395
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409848409
  error estimate for blocks of size 2^( 2) =       0.000418942602
  error estimate for blocks of size 2^( 3) =       0.000427494945
  error estimate for blocks of size 2^( 4) =       0.000433473857
  error estimate for blocks of size 2^( 5) =       0.000437003935
  error estimate for blocks of size 2^( 6) =       0.000439547158
  error estimate for blocks of size 2^( 7) =       0.000440902259

      target function =                  N/A
              le_mean =     -17.216465032825
             les_mean =     296.742619495269
             stat err =       0.000437731802
             autocorr =       1.140695409107
              std dev =       0.579613178548
             le_variance =       0.335951436746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774411
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774411
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409848409
  error estimate for blocks of size 2^( 2) =       0.000418942602
  error estimate for blocks of size 2^( 3) =       0.000427494945
  error estimate for blocks of size 2^( 4) =       0.000433473857
  error estimate for blocks of size 2^( 5) =       0.000437003935
  error estimate for blocks of size 2^( 6) =       0.000439547158
  error estimate for blocks of size 2^( 7) =       0.000440902259

      target function =                  N/A
              le_mean =     -17.216465032825
             les_mean =     296.742619495289
             stat err =       0.000437731802
             autocorr =       1.140695409077
              std dev =       0.579613178562
             le_variance =       0.335951436762

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774403
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774403
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409848409
  error estimate for blocks of size 2^( 2) =       0.000418942602
  error estimate for blocks of size 2^( 3) =       0.000427494945
  error estimate for blocks of size 2^( 4) =       0.000433473857
  error estimate for blocks of size 2^( 5) =       0.000437003935
  error estimate for blocks of size 2^( 6) =       0.000439547158
  error estimate for blocks of size 2^( 7) =       0.000440902259

      target function =                  N/A
              le_mean =     -17.216465032825
             les_mean =     296.742619495279
             stat err =       0.000437731802
             autocorr =       1.140695409086
              std dev =       0.579613178555
             le_variance =       0.335951436754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774396
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335931774396
                                         uncertainty =       0.014843927954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409848409
  error estimate for blocks of size 2^( 2) =       0.000418942602
  error estimate for blocks of size 2^( 3) =       0.000427494945
  error estimate for blocks of size 2^( 4) =       0.000433473857
  error estimate for blocks of size 2^( 5) =       0.000437003935
  error estimate for blocks of size 2^( 6) =       0.000439547158
  error estimate for blocks of size 2^( 7) =       0.000440902259

      target function =                  N/A
              le_mean =     -17.216465032825
             les_mean =     296.742619495270
             stat err =       0.000437731802
             autocorr =       1.140695409094
              std dev =       0.579613178549
             le_variance =       0.335951436747


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216465032825        initial
     1.4552e+07     1.4552e+08             6.1411e-11       -17.216465032825  <--
     5.8208e+07     5.8208e+08             1.5353e-11       -17.216465032825
     2.3283e+08     2.3283e+09             3.8382e-12       -17.216465032825

*****************************************************************************
Applying the update for shift_i =   1.4552e+07     and shift_s =   1.4552e+08
*****************************************************************************

  Execution time = 4.9964e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.5395e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1863
    reference variance = 0.3324
====================================================
  Execution time = 3.4747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1567e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315744413484
                                         uncertainty =       0.003572341064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315744413484
                                         uncertainty =       0.003572341064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397282249
  error estimate for blocks of size 2^( 2) =       0.000406919004
  error estimate for blocks of size 2^( 3) =       0.000415934551
  error estimate for blocks of size 2^( 4) =       0.000422245211
  error estimate for blocks of size 2^( 5) =       0.000426447829
  error estimate for blocks of size 2^( 6) =       0.000428125382
  error estimate for blocks of size 2^( 7) =       0.000430802278

      target function =                  N/A
              le_mean =     -17.216324664900
             les_mean =     296.717501180194
             stat err =       0.000426905175
             autocorr =       1.154687640916
              std dev =       0.561841944663
             le_variance =       0.315666370783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721632466490e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216324664900       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216324664900       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216324664901       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216324664901       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216324676390       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216324666429       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216324664436       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216324668877       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 2.475566e-10

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216324664900       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216324664900       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216324664900       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216324657766       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216324664900       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216324662014       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216324682402       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216324667750       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 6.188869e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216324664900       residual = 9.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216324664900       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216324664900       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216324664900       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216324650358       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216324679897       residual = 7.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216324631236       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216324641951       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 1.547254e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.436764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3976e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1827
    reference variance = 0.222504
====================================================
  Execution time = 3.4182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1793e-01
  Total weights = 2.0000e+06
  Execution time = 3.0952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458155
                                         uncertainty =       0.004378899456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458155
                                         uncertainty =       0.004378899456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398701364
  error estimate for blocks of size 2^( 2) =       0.000408461706
  error estimate for blocks of size 2^( 3) =       0.000416927865
  error estimate for blocks of size 2^( 4) =       0.000423379923
  error estimate for blocks of size 2^( 5) =       0.000426382298
  error estimate for blocks of size 2^( 6) =       0.000429180703
  error estimate for blocks of size 2^( 7) =       0.000430741566

      target function =                  N/A
              le_mean =     -17.216887369354
             les_mean =     296.739136085061
             stat err =       0.000427421122
             autocorr =       1.149255308577
              std dev =       0.563848876033
             le_variance =       0.317925555003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458230
                                         uncertainty =       0.004378899457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458230
                                         uncertainty =       0.004378899457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398701364
  error estimate for blocks of size 2^( 2) =       0.000408461706
  error estimate for blocks of size 2^( 3) =       0.000416927865
  error estimate for blocks of size 2^( 4) =       0.000423379923
  error estimate for blocks of size 2^( 5) =       0.000426382298
  error estimate for blocks of size 2^( 6) =       0.000429180703
  error estimate for blocks of size 2^( 7) =       0.000430741566

      target function =                  N/A
              le_mean =     -17.216887369354
             les_mean =     296.739136085135
             stat err =       0.000427421122
             autocorr =       1.149255308506
              std dev =       0.563848876099
             le_variance =       0.317925555078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458193
                                         uncertainty =       0.004378899457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458193
                                         uncertainty =       0.004378899457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398701364
  error estimate for blocks of size 2^( 2) =       0.000408461706
  error estimate for blocks of size 2^( 3) =       0.000416927865
  error estimate for blocks of size 2^( 4) =       0.000423379923
  error estimate for blocks of size 2^( 5) =       0.000426382298
  error estimate for blocks of size 2^( 6) =       0.000429180703
  error estimate for blocks of size 2^( 7) =       0.000430741566

      target function =                  N/A
              le_mean =     -17.216887369354
             les_mean =     296.739136085098
             stat err =       0.000427421122
             autocorr =       1.149255308545
              std dev =       0.563848876066
             le_variance =       0.317925555041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458160
                                         uncertainty =       0.004378899456

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317971458160
                                         uncertainty =       0.004378899456

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398701364
  error estimate for blocks of size 2^( 2) =       0.000408461706
  error estimate for blocks of size 2^( 3) =       0.000416927865
  error estimate for blocks of size 2^( 4) =       0.000423379923
  error estimate for blocks of size 2^( 5) =       0.000426382298
  error estimate for blocks of size 2^( 6) =       0.000429180703
  error estimate for blocks of size 2^( 7) =       0.000430741566

      target function =                  N/A
              le_mean =     -17.216887369354
             les_mean =     296.739136085066
             stat err =       0.000427421122
             autocorr =       1.149255308579
              std dev =       0.563848876037
             le_variance =       0.317925555008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216887369354        initial  <--
     3.6380e+06     3.6380e+07             2.4756e-10       -17.216887369354
     1.4552e+07     1.4552e+08             6.1889e-11       -17.216887369354
     5.8208e+07     5.8208e+08             1.5473e-11       -17.216887369354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.7961
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2706
    reference variance = 0.132411
====================================================
  Execution time = 3.4672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1720e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.2412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317262914079
                                         uncertainty =       0.003711265001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317262914079
                                         uncertainty =       0.003711265001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398244785
  error estimate for blocks of size 2^( 2) =       0.000407709667
  error estimate for blocks of size 2^( 3) =       0.000416200521
  error estimate for blocks of size 2^( 4) =       0.000423358612
  error estimate for blocks of size 2^( 5) =       0.000426727109
  error estimate for blocks of size 2^( 6) =       0.000428358032
  error estimate for blocks of size 2^( 7) =       0.000429963463

      target function =                  N/A
              le_mean =     -17.216863620654
             les_mean =     296.737590591204
             stat err =       0.000427101804
             autocorr =       1.150171538665
              std dev =       0.563203176122
             le_variance =       0.317197817594


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686362065e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863620654       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863620654       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863620654       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863611256       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216863643255       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216863616686       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216863580889       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216863625029       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 2.505901e-11

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863620654       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863620654       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863620654       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863620654       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216863620654       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216863581826       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216863619875       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216863490898       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 6.264611e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216863620654       residual = 8.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216863620654       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216863620654       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216863742619       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216863620654       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216863798654       residual = 9.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216864257727       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216863629880       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 1.565965e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.439404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.3924e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1603
    reference variance = 0.231309
====================================================
  Execution time = 3.4146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2927e-01
  Total weights = 2.0000e+06
  Execution time = 3.1100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276271
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276271
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405754630
  error estimate for blocks of size 2^( 2) =       0.000415418173
  error estimate for blocks of size 2^( 3) =       0.000423733187
  error estimate for blocks of size 2^( 4) =       0.000429933548
  error estimate for blocks of size 2^( 5) =       0.000434603175
  error estimate for blocks of size 2^( 6) =       0.000435515925
  error estimate for blocks of size 2^( 7) =       0.000436583549

      target function =                  N/A
              le_mean =     -17.216259885448
             les_mean =     296.728877917896
             stat err =       0.000434159049
             autocorr =       1.144908413710
              std dev =       0.573823700490
             le_variance =       0.329273639245

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276277
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276277
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405754630
  error estimate for blocks of size 2^( 2) =       0.000415418173
  error estimate for blocks of size 2^( 3) =       0.000423733187
  error estimate for blocks of size 2^( 4) =       0.000429933548
  error estimate for blocks of size 2^( 5) =       0.000434603175
  error estimate for blocks of size 2^( 6) =       0.000435515925
  error estimate for blocks of size 2^( 7) =       0.000436583549

      target function =                  N/A
              le_mean =     -17.216259885448
             les_mean =     296.728877917900
             stat err =       0.000434159049
             autocorr =       1.144908413692
              std dev =       0.573823700496
             le_variance =       0.329273639251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276274
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276274
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405754630
  error estimate for blocks of size 2^( 2) =       0.000415418173
  error estimate for blocks of size 2^( 3) =       0.000423733187
  error estimate for blocks of size 2^( 4) =       0.000429933548
  error estimate for blocks of size 2^( 5) =       0.000434603175
  error estimate for blocks of size 2^( 6) =       0.000435515925
  error estimate for blocks of size 2^( 7) =       0.000436583549

      target function =                  N/A
              le_mean =     -17.216259885448
             les_mean =     296.728877917898
             stat err =       0.000434159049
             autocorr =       1.144908413696
              std dev =       0.573823700493
             le_variance =       0.329273639248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276271
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329236276271
                                         uncertainty =       0.006176799975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405754630
  error estimate for blocks of size 2^( 2) =       0.000415418173
  error estimate for blocks of size 2^( 3) =       0.000423733187
  error estimate for blocks of size 2^( 4) =       0.000429933548
  error estimate for blocks of size 2^( 5) =       0.000434603175
  error estimate for blocks of size 2^( 6) =       0.000435515925
  error estimate for blocks of size 2^( 7) =       0.000436583549

      target function =                  N/A
              le_mean =     -17.216259885448
             les_mean =     296.728877917897
             stat err =       0.000434159049
             autocorr =       1.144908413704
              std dev =       0.573823700491
             le_variance =       0.329273639245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216259885448        initial  <--
     3.6380e+07     3.6380e+08             2.5059e-11       -17.216259885448
     1.4552e+08     1.4552e+09             6.2646e-12       -17.216259885448
     5.8208e+08     5.8208e+09             1.5660e-12       -17.216259885448

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 49.8131
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.3743e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2512
    reference variance = 0.203047
====================================================
  Execution time = 3.4465e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2023e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 9.3389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320326316937
                                         uncertainty =       0.003222977206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320326316937
                                         uncertainty =       0.003222977206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400141419
  error estimate for blocks of size 2^( 2) =       0.000409560473
  error estimate for blocks of size 2^( 3) =       0.000418308518
  error estimate for blocks of size 2^( 4) =       0.000424257196
  error estimate for blocks of size 2^( 5) =       0.000428237007
  error estimate for blocks of size 2^( 6) =       0.000431894995
  error estimate for blocks of size 2^( 7) =       0.000433133753

      target function =                  N/A
              le_mean =     -17.216267231844
             les_mean =     296.720083548978
             stat err =       0.000429380738
             autocorr =       1.151484508653
              std dev =       0.565885422007
             le_variance =       0.320226310840


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721626723184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+08, overlap shift 3.6380e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216267231844       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216267231844       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216267231844       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216267178225       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216267228121       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216267147027       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216267173310       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216267397548       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+08 is 2.749852e-12

solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216267231844       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216267231844       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216267231844       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216267231844       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216266102499       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216267249378       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216265612839       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216268452714       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 6.876775e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216267231844       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216267231844       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216267231844       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216267231844       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216266958923       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216267231844       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216264780135       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216267218607       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 1.719388e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.442106 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 4.7127e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2267
    reference variance = 0.467596
====================================================
  Execution time = 3.4756e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2375e-01
  Total weights = 2.0000e+06
  Execution time = 3.1101e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084064
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084064
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402337991
  error estimate for blocks of size 2^( 2) =       0.000411642561
  error estimate for blocks of size 2^( 3) =       0.000419759661
  error estimate for blocks of size 2^( 4) =       0.000426316450
  error estimate for blocks of size 2^( 5) =       0.000431331691
  error estimate for blocks of size 2^( 6) =       0.000432347508
  error estimate for blocks of size 2^( 7) =       0.000434403887

      target function =                  N/A
              le_mean =     -17.216687935113
             les_mean =     296.738095010429
             stat err =       0.000431099884
             autocorr =       1.148084165205
              std dev =       0.568991842860
             le_variance =       0.323751717241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084065
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084065
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402337991
  error estimate for blocks of size 2^( 2) =       0.000411642561
  error estimate for blocks of size 2^( 3) =       0.000419759661
  error estimate for blocks of size 2^( 4) =       0.000426316450
  error estimate for blocks of size 2^( 5) =       0.000431331691
  error estimate for blocks of size 2^( 6) =       0.000432347508
  error estimate for blocks of size 2^( 7) =       0.000434403887

      target function =                  N/A
              le_mean =     -17.216687935113
             les_mean =     296.738095010430
             stat err =       0.000431099884
             autocorr =       1.148084165207
              std dev =       0.568991842860
             le_variance =       0.323751717241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084064
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084064
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402337991
  error estimate for blocks of size 2^( 2) =       0.000411642561
  error estimate for blocks of size 2^( 3) =       0.000419759661
  error estimate for blocks of size 2^( 4) =       0.000426316450
  error estimate for blocks of size 2^( 5) =       0.000431331691
  error estimate for blocks of size 2^( 6) =       0.000432347508
  error estimate for blocks of size 2^( 7) =       0.000434403887

      target function =                  N/A
              le_mean =     -17.216687935113
             les_mean =     296.738095010430
             stat err =       0.000431099884
             autocorr =       1.148084165211
              std dev =       0.568991842860
             le_variance =       0.323751717241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084064
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323628084064
                                         uncertainty =       0.006133049645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402337991
  error estimate for blocks of size 2^( 2) =       0.000411642561
  error estimate for blocks of size 2^( 3) =       0.000419759661
  error estimate for blocks of size 2^( 4) =       0.000426316450
  error estimate for blocks of size 2^( 5) =       0.000431331691
  error estimate for blocks of size 2^( 6) =       0.000432347508
  error estimate for blocks of size 2^( 7) =       0.000434403887

      target function =                  N/A
              le_mean =     -17.216687935113
             les_mean =     296.738095010429
             stat err =       0.000431099884
             autocorr =       1.148084165206
              std dev =       0.568991842860
             le_variance =       0.323751717241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216687935113        initial
     3.6380e+08     3.6380e+09             2.7499e-12       -17.216687935113
     1.4552e+09     1.4552e+10             6.8768e-13       -17.216687935113
     5.8208e+09     5.8208e+10             1.7194e-13       -17.216687935113  <--

*****************************************************************************
Applying the update for shift_i =   5.8208e+09     and shift_s =   5.8208e+10
*****************************************************************************

  Execution time = 5.0433e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.056743e-01 1 1  ON 0
 uu_1                 4.527905e-02 1 1  ON 1
 uu_2                -4.702254e-02 1 1  ON 2
 uu_3                -9.953491e-02 1 1  ON 3
 uu_4                -1.305258e-01 1 1  ON 4
 uu_5                -1.356412e-01 1 1  ON 5
 uu_6                -1.123372e-01 1 1  ON 6
 uu_7                -3.763991e-02 1 1  ON 7
 uu_8                 1.001291e-01 1 1  ON 8
 uu_9                 1.199371e-01 1 1  ON 9
 ud_0                 3.420402e-01 1 1  ON 10
 ud_1                 8.771266e-02 1 1  ON 11
 ud_2                -1.528644e-02 1 1  ON 12
 ud_3                -7.148777e-02 1 1  ON 13
 ud_4                -1.174849e-01 1 1  ON 14
 ud_5                -1.497654e-01 1 1  ON 15
 ud_6                -1.545711e-01 1 1  ON 16
 ud_7                -1.102280e-01 1 1  ON 17
 ud_8                 5.056883e-03 1 1  ON 18
 ud_9                 9.226171e-02 1 1  ON 19
 eO_0                -7.375587e-01 1 1  ON 20
 eO_1                -4.286310e-01 1 1  ON 21
 eO_2                -3.933737e-02 1 1  ON 22
 eO_3                 1.987366e-01 1 1  ON 23
 eO_4                 2.833407e-01 1 1  ON 24
 eO_5                 3.062353e-01 1 1  ON 25
 eO_6                 2.495281e-01 1 1  ON 26
 eO_7                 1.113020e-01 1 1  ON 27
 eO_8                 2.763413e-02 1 1  ON 28
 eO_9                 1.827131e-02 1 1  ON 29
eH1_0                -1.802060e-01 1 1  ON 30
eH1_1                -1.017847e-01 1 1  ON 31
eH1_2                -6.231604e-02 1 1  ON 32
eH1_3                -2.646561e-02 1 1  ON 33
eH1_4                 1.923950e-02 1 1  ON 34
eH1_5                 3.408303e-02 1 1  ON 35
eH1_6                 7.724955e-02 1 1  ON 36
eH1_7                 1.104774e-01 1 1  ON 37
eH1_8                 9.051115e-02 1 1  ON 38
eH1_9                 2.407432e-02 1 1  ON 39
eH2_0                -1.812399e-01 1 1  ON 40
eH2_1                -1.032275e-01 1 1  ON 41
eH2_2                -6.341028e-02 1 1  ON 42
eH2_3                -2.760033e-02 1 1  ON 43
eH2_4                 1.834564e-02 1 1  ON 44
eH2_5                 3.390588e-02 1 1  ON 45
eH2_6                 7.852035e-02 1 1  ON 46
eH2_7                 1.136648e-01 1 1  ON 47
eH2_8                 9.299442e-02 1 1  ON 48
eH2_9                 2.606913e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 9.7565e+01 secs
  Total Execution time = 3.7825e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
