Rank =    0  Free Memory = 88191 MB
Rank =    1  Free Memory = 88190 MB
Rank =    2  Free Memory = 88190 MB
Rank =    3  Free Memory = 88190 MB
Rank =    4  Free Memory = 88190 MB
Rank =    5  Free Memory = 88189 MB
Rank =    6  Free Memory = 88189 MB
Rank =    7  Free Memory = 88189 MB
Rank =    8  Free Memory = 88189 MB
Rank =    9  Free Memory = 88189 MB
Rank =   10  Free Memory = 88188 MB
Rank =   11  Free Memory = 88188 MB
Rank =   12  Free Memory = 88188 MB
Rank =   13  Free Memory = 88188 MB
Rank =   14  Free Memory = 88188 MB
Rank =   15  Free Memory = 88173 MB
Rank =   16  Free Memory = 88173 MB
Rank =   17  Free Memory = 88173 MB
Rank =   18  Free Memory = 88172 MB
Rank =   19  Free Memory = 88172 MB
Rank =   20  Free Memory = 88172 MB
Rank =   21  Free Memory = 88172 MB
Rank =   22  Free Memory = 88172 MB
Rank =   23  Free Memory = 88172 MB
Rank =   24  Free Memory = 88172 MB
Rank =   25  Free Memory = 88171 MB
Rank =   26  Free Memory = 88171 MB
Rank =   27  Free Memory = 88171 MB
Rank =   28  Free Memory = 88171 MB
Rank =   29  Free Memory = 88171 MB
Rank =   30  Free Memory = 88171 MB
Rank =   31  Free Memory = 88171 MB
Rank =   32  Free Memory = 90397 MB
Rank =   33  Free Memory = 90397 MB
Rank =   34  Free Memory = 90397 MB
Rank =   35  Free Memory = 90397 MB
Rank =   36  Free Memory = 90397 MB
Rank =   37  Free Memory = 90397 MB
Rank =   38  Free Memory = 90397 MB
Rank =   39  Free Memory = 90397 MB
Rank =   40  Free Memory = 90397 MB
Rank =   41  Free Memory = 90397 MB
Rank =   42  Free Memory = 90397 MB
Rank =   43  Free Memory = 90397 MB
Rank =   44  Free Memory = 90397 MB
Rank =   45  Free Memory = 90397 MB
Rank =   46  Free Memory = 90397 MB
Rank =   47  Free Memory = 90397 MB
Rank =   48  Free Memory = 90397 MB
Rank =   49  Free Memory = 90397 MB
Rank =   50  Free Memory = 90397 MB
Rank =   51  Free Memory = 90397 MB
Rank =   52  Free Memory = 90397 MB
Rank =   53  Free Memory = 90397 MB
Rank =   54  Free Memory = 90397 MB
Rank =   55  Free Memory = 90397 MB
Rank =   56  Free Memory = 90397 MB
Rank =   57  Free Memory = 90397 MB
Rank =   58  Free Memory = 90397 MB
Rank =   59  Free Memory = 90397 MB
Rank =   60  Free Memory = 90397 MB
Rank =   61  Free Memory = 90397 MB
Rank =   62  Free Memory = 90397 MB
Rank =   63  Free Memory = 90397 MB
Rank =   64  Free Memory = 90149 MB
Rank =   65  Free Memory = 90149 MB
Rank =   66  Free Memory = 90149 MB
Rank =   67  Free Memory = 90149 MB
Rank =   68  Free Memory = 90149 MB
Rank =   69  Free Memory = 90149 MB
Rank =   70  Free Memory = 90149 MB
Rank =   71  Free Memory = 90149 MB
Rank =   72  Free Memory = 90149 MB
Rank =   73  Free Memory = 90149 MB
Rank =   74  Free Memory = 90149 MB
Rank =   75  Free Memory = 90149 MB
Rank =   76  Free Memory = 90149 MB
Rank =   77  Free Memory = 90149 MB
Rank =   78  Free Memory = 90149 MB
Rank =   79  Free Memory = 90149 MB
Rank =   80  Free Memory = 90149 MB
Rank =   81  Free Memory = 90149 MB
Rank =   82  Free Memory = 90149 MB
Rank =   83  Free Memory = 90149 MB
Rank =   84  Free Memory = 90148 MB
Rank =   85  Free Memory = 90148 MB
Rank =   86  Free Memory = 90148 MB
Rank =   87  Free Memory = 90148 MB
Rank =   88  Free Memory = 90148 MB
Rank =   89  Free Memory = 90148 MB
Rank =   90  Free Memory = 90148 MB
Rank =   91  Free Memory = 90148 MB
Rank =   92  Free Memory = 90148 MB
Rank =   93  Free Memory = 90148 MB
Rank =   94  Free Memory = 90148 MB
Rank =   95  Free Memory = 90148 MB
Rank =   96  Free Memory = 90105 MB
Rank =   97  Free Memory = 90105 MB
Rank =   98  Free Memory = 90105 MB
Rank =   99  Free Memory = 90105 MB
Rank =  100  Free Memory = 90105 MB
Rank =  101  Free Memory = 90105 MB
Rank =  102  Free Memory = 90105 MB
Rank =  103  Free Memory = 90105 MB
Rank =  104  Free Memory = 90105 MB
Rank =  105  Free Memory = 90105 MB
Rank =  106  Free Memory = 90105 MB
Rank =  107  Free Memory = 90105 MB
Rank =  108  Free Memory = 90105 MB
Rank =  109  Free Memory = 90105 MB
Rank =  110  Free Memory = 90105 MB
Rank =  111  Free Memory = 90105 MB
Rank =  112  Free Memory = 90105 MB
Rank =  113  Free Memory = 90105 MB
Rank =  114  Free Memory = 90105 MB
Rank =  115  Free Memory = 90105 MB
Rank =  116  Free Memory = 90105 MB
Rank =  117  Free Memory = 90105 MB
Rank =  118  Free Memory = 90105 MB
Rank =  119  Free Memory = 90105 MB
Rank =  120  Free Memory = 90105 MB
Rank =  121  Free Memory = 90105 MB
Rank =  122  Free Memory = 90104 MB
Rank =  123  Free Memory = 90104 MB
Rank =  124  Free Memory = 90104 MB
Rank =  125  Free Memory = 90104 MB
Rank =  126  Free Memory = 90104 MB
Rank =  127  Free Memory = 90104 MB
  Input file(s): opt_h2o_gs_gvptt_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:30:58 PST
  host    = n0012.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 850

  Range of prime numbers to use as seeds over processors and threads = 6581-7723


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.056743e-01    1         1  ON     0
     uu_1                 4.527905e-02    1         1  ON     1
     uu_2                -4.702254e-02    1         1  ON     2
     uu_3                -9.953491e-02    1         1  ON     3
     uu_4                -1.305258e-01    1         1  ON     4
     uu_5                -1.356412e-01    1         1  ON     5
     uu_6                -1.123372e-01    1         1  ON     6
     uu_7                -3.763991e-02    1         1  ON     7
     uu_8                 1.001291e-01    1         1  ON     8
     uu_9                 1.199371e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.420402e-01    1         1  ON     0
     ud_1                 8.771266e-02    1         1  ON     1
     ud_2                -1.528644e-02    1         1  ON     2
     ud_3                -7.148777e-02    1         1  ON     3
     ud_4                -1.174849e-01    1         1  ON     4
     ud_5                -1.497654e-01    1         1  ON     5
     ud_6                -1.545711e-01    1         1  ON     6
     ud_7                -1.102280e-01    1         1  ON     7
     ud_8                 5.056883e-03    1         1  ON     8
     ud_9                 9.226171e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.375587e-01    1         1  ON     0
     eO_1                -4.286310e-01    1         1  ON     1
     eO_2                -3.933737e-02    1         1  ON     2
     eO_3                 1.987366e-01    1         1  ON     3
     eO_4                 2.833407e-01    1         1  ON     4
     eO_5                 3.062353e-01    1         1  ON     5
     eO_6                 2.495281e-01    1         1  ON     6
     eO_7                 1.113020e-01    1         1  ON     7
     eO_8                 2.763413e-02    1         1  ON     8
     eO_9                 1.827131e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.802060e-01    1         1  ON     0
     eH1_1                -1.017847e-01    1         1  ON     1
     eH1_2                -6.231604e-02    1         1  ON     2
     eH1_3                -2.646561e-02    1         1  ON     3
     eH1_4                 1.923950e-02    1         1  ON     4
     eH1_5                 3.408303e-02    1         1  ON     5
     eH1_6                 7.724955e-02    1         1  ON     6
     eH1_7                 1.104774e-01    1         1  ON     7
     eH1_8                 9.051115e-02    1         1  ON     8
     eH1_9                 2.407432e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.812399e-01    1         1  ON     0
     eH2_1                -1.032275e-01    1         1  ON     1
     eH2_2                -6.341028e-02    1         1  ON     2
     eH2_3                -2.760033e-02    1         1  ON     3
     eH2_4                 1.834564e-02    1         1  ON     4
     eH2_5                 3.390588e-02    1         1  ON     5
     eH2_6                 7.852035e-02    1         1  ON     6
     eH2_7                 1.136648e-01    1         1  ON     7
     eH2_8                 9.299442e-02    1         1  ON     8
     eH2_9                 2.606913e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.705228e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.6341e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2892
    reference variance = 0.287265
====================================================
  Execution time = 2.0562e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2490e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4545e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325022933171
                                         uncertainty =       0.010126205065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325022933171
                                         uncertainty =       0.010126205065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403051848
  error estimate for blocks of size 2^( 2) =       0.000412937018
  error estimate for blocks of size 2^( 3) =       0.000422086750
  error estimate for blocks of size 2^( 4) =       0.000428360626
  error estimate for blocks of size 2^( 5) =       0.000432798246
  error estimate for blocks of size 2^( 6) =       0.000435529898
  error estimate for blocks of size 2^( 7) =       0.000436059681

      target function =                  N/A
              le_mean =     -17.216249731099
             les_mean =     296.724156225442
             stat err =       0.000433187113
             autocorr =       1.155125636171
              std dev =       0.570001389759
             le_variance =       0.324901584327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721624973110e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216249731099       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216270978536       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216277845452       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216287759415       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216306144661       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216311228702       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216313573067       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216311869795       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216311281991       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216311918820       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216312667821       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216312570733       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.660017e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216249731099       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216258942398       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216261828386       residual = 4.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216264788515       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216271894957       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216273611426       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216273832765       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216273301411       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216273094824       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216273181061       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.707613e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216249731099       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216252551544       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216253451160       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216254240146       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216256172848       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216256656969       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216256688856       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216256588559       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216256551121       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.544237e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006979 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6036e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.057974e-01                 1 1 ON  0
uu_1  4.530660e-02                 1 1 ON  1
uu_2  -4.702510e-02                1 1 ON  2
uu_3  -9.955648e-02                1 1 ON  3
uu_4  -1.305252e-01                1 1 ON  4
uu_5  -1.356683e-01                1 1 ON  5
uu_6  -1.124074e-01                1 1 ON  6
uu_7  -3.774916e-02                1 1 ON  7
uu_8  1.000772e-01                 1 1 ON  8
uu_9  1.200034e-01                 1 1 ON  9
ud_0  3.432815e-01                 1 1 ON  10
ud_1  8.833840e-02                 1 1 ON  11
ud_2  -1.577012e-02                1 1 ON  12
ud_3  -7.220917e-02                1 1 ON  13
ud_4  -1.178640e-01                1 1 ON  14
ud_5  -1.498622e-01                1 1 ON  15
ud_6  -1.546069e-01                1 1 ON  16
ud_7  -1.102874e-01                1 1 ON  17
ud_8  4.918110e-03                 1 1 ON  18
ud_9  9.225607e-02                 1 1 ON  19
eO_0  -7.392663e-01                1 1 ON  20
eO_1  -4.295504e-01                1 1 ON  21
eO_2  -3.857056e-02                1 1 ON  22
eO_3  1.997635e-01                 1 1 ON  23
eO_4  2.839309e-01                 1 1 ON  24
eO_5  3.062690e-01                 1 1 ON  25
eO_6  2.495850e-01                 1 1 ON  26
eO_7  1.114293e-01                 1 1 ON  27
eO_8  2.764882e-02                 1 1 ON  28
eO_9  1.827726e-02                 1 1 ON  29
eH1_0 -1.803128e-01                1 1 ON  30
eH1_1 -1.018851e-01                1 1 ON  31
eH1_2 -6.234494e-02                1 1 ON  32
eH1_3 -2.635021e-02                1 1 ON  33
eH1_4 1.930015e-02                 1 1 ON  34
eH1_5 3.419302e-02                 1 1 ON  35
eH1_6 7.720437e-02                 1 1 ON  36
eH1_7 1.104066e-01                 1 1 ON  37
eH1_8 9.055818e-02                 1 1 ON  38
eH1_9 2.409126e-02                 1 1 ON  39
eH2_0 -1.814165e-01                1 1 ON  40
eH2_1 -1.031252e-01                1 1 ON  41
eH2_2 -6.348745e-02                1 1 ON  42
eH2_3 -2.758833e-02                1 1 ON  43
eH2_4 1.835853e-02                 1 1 ON  44
eH2_5 3.395405e-02                 1 1 ON  45
eH2_6 7.850822e-02                 1 1 ON  46
eH2_7 1.136395e-01                 1 1 ON  47
eH2_8 9.307463e-02                 1 1 ON  48
eH2_9 2.609853e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.216
    reference variance = 0.324291
====================================================
  Execution time = 1.9980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1041e-01
  Total weights = 2.0000e+06
  Execution time = 1.8282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309520515014
                                         uncertainty =       0.003181574033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309520515014
                                         uncertainty =       0.003181574033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393353545
  error estimate for blocks of size 2^( 2) =       0.000403573907
  error estimate for blocks of size 2^( 3) =       0.000412210426
  error estimate for blocks of size 2^( 4) =       0.000418624835
  error estimate for blocks of size 2^( 5) =       0.000423167583
  error estimate for blocks of size 2^( 6) =       0.000425723424
  error estimate for blocks of size 2^( 7) =       0.000426949578

      target function =                  N/A
              le_mean =     -17.217031593112
             les_mean =     296.735630745514
             stat err =       0.000423616355
             autocorr =       1.159789845957
              std dev =       0.556285917499
             le_variance =       0.309454022008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312116555870
                                         uncertainty =       0.003207078921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312116555870
                                         uncertainty =       0.003207078921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394999405
  error estimate for blocks of size 2^( 2) =       0.000405075796
  error estimate for blocks of size 2^( 3) =       0.000413581356
  error estimate for blocks of size 2^( 4) =       0.000419885257
  error estimate for blocks of size 2^( 5) =       0.000424387807
  error estimate for blocks of size 2^( 6) =       0.000426973713
  error estimate for blocks of size 2^( 7) =       0.000428120934

      target function =                  N/A
              le_mean =     -17.217032372082
             les_mean =     296.738252605915
             stat err =       0.000424841927
             autocorr =       1.156809528640
              std dev =       0.558613516316
             le_variance =       0.312049060611

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311483270987
                                         uncertainty =       0.003200527297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311483270987
                                         uncertainty =       0.003200527297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394598573
  error estimate for blocks of size 2^( 2) =       0.000404705730
  error estimate for blocks of size 2^( 3) =       0.000413242072
  error estimate for blocks of size 2^( 4) =       0.000419571597
  error estimate for blocks of size 2^( 5) =       0.000424084876
  error estimate for blocks of size 2^( 6) =       0.000426670688
  error estimate for blocks of size 2^( 7) =       0.000427828437

      target function =                  N/A
              le_mean =     -17.217028845963
             les_mean =     296.737498194451
             stat err =       0.000424538900
             autocorr =       1.157507887685
              std dev =       0.558046653465
             le_variance =       0.311416067443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309796333882
                                         uncertainty =       0.003184306630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309796333882
                                         uncertainty =       0.003184306630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393528743
  error estimate for blocks of size 2^( 2) =       0.000403731166
  error estimate for blocks of size 2^( 3) =       0.000412352170
  error estimate for blocks of size 2^( 4) =       0.000418753567
  error estimate for blocks of size 2^( 5) =       0.000423291765
  error estimate for blocks of size 2^( 6) =       0.000425852230
  error estimate for blocks of size 2^( 7) =       0.000427067726

      target function =                  N/A
              le_mean =     -17.217029073285
             les_mean =     296.735819699352
             stat err =       0.000423741322
             autocorr =       1.159441167479
              std dev =       0.556533686186
             le_variance =       0.309729743860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217031593112        initial
     2.5000e-01     2.5000e+00             5.6600e-03       -17.217032372082  <--
     1.0000e+00     1.0000e+01             1.7076e-03       -17.217028845963
     4.0000e+00     4.0000e+01             4.5442e-04       -17.217029073285

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9244e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.062564e-01 1 1  ON 0
 uu_1                 4.555100e-02 1 1  ON 1
 uu_2                -4.696434e-02 1 1  ON 2
 uu_3                -9.966567e-02 1 1  ON 3
 uu_4                -1.307038e-01 1 1  ON 4
 uu_5                -1.359039e-01 1 1  ON 5
 uu_6                -1.125983e-01 1 1  ON 6
 uu_7                -3.804713e-02 1 1  ON 7
 uu_8                 9.992940e-02 1 1  ON 8
 uu_9                 1.202038e-01 1 1  ON 9
 ud_0                 3.454106e-01 1 1  ON 10
 ud_1                 8.935209e-02 1 1  ON 11
 ud_2                -1.618629e-02 1 1  ON 12
 ud_3                -7.342692e-02 1 1  ON 13
 ud_4                -1.187844e-01 1 1  ON 14
 ud_5                -1.501716e-01 1 1  ON 15
 ud_6                -1.545690e-01 1 1  ON 16
 ud_7                -1.103669e-01 1 1  ON 17
 ud_8                 4.531254e-03 1 1  ON 18
 ud_9                 9.224403e-02 1 1  ON 19
 eO_0                -7.432187e-01 1 1  ON 20
 eO_1                -4.317928e-01 1 1  ON 21
 eO_2                -3.766979e-02 1 1  ON 22
 eO_3                 2.021391e-01 1 1  ON 23
 eO_4                 2.858961e-01 1 1  ON 24
 eO_5                 3.065515e-01 1 1  ON 25
 eO_6                 2.497899e-01 1 1  ON 26
 eO_7                 1.118173e-01 1 1  ON 27
 eO_8                 2.769437e-02 1 1  ON 28
 eO_9                 1.829542e-02 1 1  ON 29
eH1_0                -1.806160e-01 1 1  ON 30
eH1_1                -1.021542e-01 1 1  ON 31
eH1_2                -6.234900e-02 1 1  ON 32
eH1_3                -2.613335e-02 1 1  ON 33
eH1_4                 1.939135e-02 1 1  ON 34
eH1_5                 3.450163e-02 1 1  ON 35
eH1_6                 7.714921e-02 1 1  ON 36
eH1_7                 1.102190e-01 1 1  ON 37
eH1_8                 9.070267e-02 1 1  ON 38
eH1_9                 2.414282e-02 1 1  ON 39
eH2_0                -1.818162e-01 1 1  ON 40
eH2_1                -1.031180e-01 1 1  ON 41
eH2_2                -6.358045e-02 1 1  ON 42
eH2_3                -2.755031e-02 1 1  ON 43
eH2_4                 1.830126e-02 1 1  ON 44
eH2_5                 3.411033e-02 1 1  ON 45
eH2_6                 7.855360e-02 1 1  ON 46
eH2_7                 1.135900e-01 1 1  ON 47
eH2_8                 9.331949e-02 1 1  ON 48
eH2_9                 2.618769e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7253e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1927
    reference variance = 0.185748
====================================================
  Execution time = 2.0023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319123094389
                                         uncertainty =       0.003752650411

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319123094389
                                         uncertainty =       0.003752650411

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399373949
  error estimate for blocks of size 2^( 2) =       0.000409232697
  error estimate for blocks of size 2^( 3) =       0.000418418628
  error estimate for blocks of size 2^( 4) =       0.000425262073
  error estimate for blocks of size 2^( 5) =       0.000429190458
  error estimate for blocks of size 2^( 6) =       0.000432294625
  error estimate for blocks of size 2^( 7) =       0.000434824817

      target function =                  N/A
              le_mean =     -17.217022191886
             les_mean =     296.744852098708
             stat err =       0.000430392993
             autocorr =       1.161370844983
              std dev =       0.564800055167
             le_variance =       0.318999102316


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721702219189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217022191886       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217025378804       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040792277       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217060744575       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217065813364       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217072394417       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217073371598       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217076042650       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217079666241       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217083394237       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217081071993       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217080223345       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217080414939       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217080782706       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217081607345       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217081226106       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.328693e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217022191886       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217024169158       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217033267959       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217043508591       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217044413868       residual = 6.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217047228322       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217047375261       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217047526463       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217047985670       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217048435560       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217048352540       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.820769e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217022191886       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217022977058       residual = 5.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217026543502       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217029625650       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217029749414       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217030518631       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217030592565       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217030644436       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217030639845       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.451911e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012981 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5527e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.067829e-01 1 1  ON 0
 uu_1                 4.604180e-02 1 1  ON 1
 uu_2                -4.692025e-02 1 1  ON 2
 uu_3                -9.988012e-02 1 1  ON 3
 uu_4                -1.311281e-01 1 1  ON 4
 uu_5                -1.362032e-01 1 1  ON 5
 uu_6                -1.126650e-01 1 1  ON 6
 uu_7                -3.847511e-02 1 1  ON 7
 uu_8                 9.958173e-02 1 1  ON 8
 uu_9                 1.204833e-01 1 1  ON 9
 ud_0                 3.472115e-01 1 1  ON 10
 ud_1                 9.041858e-02 1 1  ON 11
 ud_2                -1.640501e-02 1 1  ON 12
 ud_3                -7.456706e-02 1 1  ON 13
 ud_4                -1.199287e-01 1 1  ON 14
 ud_5                -1.510002e-01 1 1  ON 15
 ud_6                -1.543318e-01 1 1  ON 16
 ud_7                -1.101854e-01 1 1  ON 17
 ud_8                 4.093760e-03 1 1  ON 18
 ud_9                 9.231224e-02 1 1  ON 19
 eO_0                -7.480395e-01 1 1  ON 20
 eO_1                -4.343296e-01 1 1  ON 21
 eO_2                -3.708638e-02 1 1  ON 22
 eO_3                 2.051979e-01 1 1  ON 23
 eO_4                 2.881184e-01 1 1  ON 24
 eO_5                 3.068885e-01 1 1  ON 25
 eO_6                 2.502463e-01 1 1  ON 26
 eO_7                 1.123198e-01 1 1  ON 27
 eO_8                 2.777331e-02 1 1  ON 28
 eO_9                 1.834866e-02 1 1  ON 29
eH1_0                -1.812174e-01 1 1  ON 30
eH1_1                -1.025691e-01 1 1  ON 31
eH1_2                -6.246763e-02 1 1  ON 32
eH1_3                -2.597539e-02 1 1  ON 33
eH1_4                 1.976574e-02 1 1  ON 34
eH1_5                 3.486888e-02 1 1  ON 35
eH1_6                 7.719945e-02 1 1  ON 36
eH1_7                 1.100434e-01 1 1  ON 37
eH1_8                 9.090529e-02 1 1  ON 38
eH1_9                 2.422756e-02 1 1  ON 39
eH2_0                -1.819408e-01 1 1  ON 40
eH2_1                -1.037428e-01 1 1  ON 41
eH2_2                -6.353367e-02 1 1  ON 42
eH2_3                -2.744084e-02 1 1  ON 43
eH2_4                 1.829353e-02 1 1  ON 44
eH2_5                 3.437177e-02 1 1  ON 45
eH2_6                 7.859344e-02 1 1  ON 46
eH2_7                 1.134461e-01 1 1  ON 47
eH2_8                 9.359018e-02 1 1  ON 48
eH2_9                 2.630759e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1481
    reference variance = 0.220813
====================================================
  Execution time = 1.9635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2130e-01
  Total weights = 2.0000e+06
  Execution time = 1.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319898521518
                                         uncertainty =       0.005435695338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319898521518
                                         uncertainty =       0.005435695338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399875962
  error estimate for blocks of size 2^( 2) =       0.000409632508
  error estimate for blocks of size 2^( 3) =       0.000418800960
  error estimate for blocks of size 2^( 4) =       0.000425695766
  error estimate for blocks of size 2^( 5) =       0.000429610257
  error estimate for blocks of size 2^( 6) =       0.000431152859
  error estimate for blocks of size 2^( 7) =       0.000431490943

      target function =                  N/A
              le_mean =     -17.217127469755
             les_mean =     296.749279719990
             stat err =       0.000429487456
             autocorr =       1.153587050568
              std dev =       0.565510008835
             le_variance =       0.319801570092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323061071487
                                         uncertainty =       0.005490476946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323061071487
                                         uncertainty =       0.005490476946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401847740
  error estimate for blocks of size 2^( 2) =       0.000411461734
  error estimate for blocks of size 2^( 3) =       0.000420475151
  error estimate for blocks of size 2^( 4) =       0.000427254545
  error estimate for blocks of size 2^( 5) =       0.000431086744
  error estimate for blocks of size 2^( 6) =       0.000432524533
  error estimate for blocks of size 2^( 7) =       0.000432822838

      target function =                  N/A
              le_mean =     -17.217144741011
             les_mean =     296.753036084542
             stat err =       0.000430922165
             autocorr =       1.149938474290
              std dev =       0.568298524623
             le_variance =       0.322963213088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322982412536
                                         uncertainty =       0.005486564940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322982412536
                                         uncertainty =       0.005486564940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401798762
  error estimate for blocks of size 2^( 2) =       0.000411419618
  error estimate for blocks of size 2^( 3) =       0.000420448436
  error estimate for blocks of size 2^( 4) =       0.000427238973
  error estimate for blocks of size 2^( 5) =       0.000431083390
  error estimate for blocks of size 2^( 6) =       0.000432539446
  error estimate for blocks of size 2^( 7) =       0.000432844824

      target function =                  N/A
              le_mean =     -17.217141906848
             les_mean =     296.752859768605
             stat err =       0.000430926658
             autocorr =       1.150242831876
              std dev =       0.568229257882
             le_variance =       0.322884489513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320400331766
                                         uncertainty =       0.005444277465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320400331766
                                         uncertainty =       0.005444277465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400189453
  error estimate for blocks of size 2^( 2) =       0.000409920389
  error estimate for blocks of size 2^( 3) =       0.000419063792
  error estimate for blocks of size 2^( 4) =       0.000425939947
  error estimate for blocks of size 2^( 5) =       0.000429842247
  error estimate for blocks of size 2^( 6) =       0.000431371422
  error estimate for blocks of size 2^( 7) =       0.000431703716

      target function =                  N/A
              le_mean =     -17.217125137395
             les_mean =     296.749701033074
             stat err =       0.000429714333
             autocorr =       1.152997596987
              std dev =       0.565953351889
             le_variance =       0.320303196515


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217127469755        initial
     6.2500e-02     6.2500e-01             1.3287e-02       -17.217144741011  <--
     2.5000e-01     2.5000e+00             4.8208e-03       -17.217141906848
     1.0000e+00     1.0000e+01             1.4519e-03       -17.217125137395

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.8885e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.082413e-01 1 1  ON 0
 uu_1                 4.713680e-02 1 1  ON 1
 uu_2                -4.647038e-02 1 1  ON 2
 uu_3                -1.001253e-01 1 1  ON 3
 uu_4                -1.320474e-01 1 1  ON 4
 uu_5                -1.372685e-01 1 1  ON 5
 uu_6                -1.133233e-01 1 1  ON 6
 uu_7                -3.977044e-02 1 1  ON 7
 uu_8                 9.849232e-02 1 1  ON 8
 uu_9                 1.213572e-01 1 1  ON 9
 ud_0                 3.493331e-01 1 1  ON 10
 ud_1                 9.183777e-02 1 1  ON 11
 ud_2                -1.611007e-02 1 1  ON 12
 ud_3                -7.548348e-02 1 1  ON 13
 ud_4                -1.215778e-01 1 1  ON 14
 ud_5                -1.526992e-01 1 1  ON 15
 ud_6                -1.545881e-01 1 1  ON 16
 ud_7                -1.097708e-01 1 1  ON 17
 ud_8                 2.822394e-03 1 1  ON 18
 ud_9                 9.253933e-02 1 1  ON 19
 eO_0                -7.565057e-01 1 1  ON 20
 eO_1                -4.399748e-01 1 1  ON 21
 eO_2                -3.840252e-02 1 1  ON 22
 eO_3                 2.089362e-01 1 1  ON 23
 eO_4                 2.937452e-01 1 1  ON 24
 eO_5                 3.091103e-01 1 1  ON 25
 eO_6                 2.518678e-01 1 1  ON 26
 eO_7                 1.139119e-01 1 1  ON 27
 eO_8                 2.802583e-02 1 1  ON 28
 eO_9                 1.851733e-02 1 1  ON 29
eH1_0                -1.822660e-01 1 1  ON 30
eH1_1                -1.033236e-01 1 1  ON 31
eH1_2                -6.260374e-02 1 1  ON 32
eH1_3                -2.587493e-02 1 1  ON 33
eH1_4                 2.010520e-02 1 1  ON 34
eH1_5                 3.518094e-02 1 1  ON 35
eH1_6                 7.763709e-02 1 1  ON 36
eH1_7                 1.096433e-01 1 1  ON 37
eH1_8                 9.155389e-02 1 1  ON 38
eH1_9                 2.449636e-02 1 1  ON 39
eH2_0                -1.824028e-01 1 1  ON 40
eH2_1                -1.045916e-01 1 1  ON 41
eH2_2                -6.357059e-02 1 1  ON 42
eH2_3                -2.739879e-02 1 1  ON 43
eH2_4                 1.818647e-02 1 1  ON 44
eH2_5                 3.435058e-02 1 1  ON 45
eH2_6                 7.893331e-02 1 1  ON 46
eH2_7                 1.131312e-01 1 1  ON 47
eH2_8                 9.445148e-02 1 1  ON 48
eH2_9                 2.668711e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2573
    reference variance = 0.218377
====================================================
  Execution time = 2.0140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1975e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319852562434
                                         uncertainty =       0.004265858977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319852562434
                                         uncertainty =       0.004265858977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399842322
  error estimate for blocks of size 2^( 2) =       0.000410044488
  error estimate for blocks of size 2^( 3) =       0.000418905314
  error estimate for blocks of size 2^( 4) =       0.000426021576
  error estimate for blocks of size 2^( 5) =       0.000430125598
  error estimate for blocks of size 2^( 6) =       0.000432301497
  error estimate for blocks of size 2^( 7) =       0.000434599443

      target function =                  N/A
              le_mean =     -17.217009571002
             les_mean =     296.745166172794
             stat err =       0.000430762028
             autocorr =       1.160639388952
              std dev =       0.565462434383
             le_variance =       0.319747764698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721700957100e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009571002       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217014463561       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012688966       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217017269378       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217022432604       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217047134683       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217053747102       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217059082693       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217062580967       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217070140255       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217064798477       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217065213657       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217064427687       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217071468179       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.217071839404       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.217071611279       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.217071443682       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.217070762271       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.217071355197       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.217071260389       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.036532e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009571002       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217013788286       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217012290104       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217014956948       residual = 9.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217018735267       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217031963785       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217034900476       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217036150253       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217036051817       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217037761080       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217036342543       residual = 5.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217035343758       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.217036367216       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.217036305584       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 7.696111e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217009571002       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217012288179       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217011378944       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217012026805       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217013830752       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217017663701       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217018689861       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217018945602       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217018462554       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217018684422       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217018567486       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.503675e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.021839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5670e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.099887e-01 1 1  ON 0
 uu_1                 4.810895e-02 1 1  ON 1
 uu_2                -4.586523e-02 1 1  ON 2
 uu_3                -9.985068e-02 1 1  ON 3
 uu_4                -1.325242e-01 1 1  ON 4
 uu_5                -1.383066e-01 1 1  ON 5
 uu_6                -1.147974e-01 1 1  ON 6
 uu_7                -4.156984e-02 1 1  ON 7
 uu_8                 9.721939e-02 1 1  ON 8
 uu_9                 1.223125e-01 1 1  ON 9
 ud_0                 3.509036e-01 1 1  ON 10
 ud_1                 9.320108e-02 1 1  ON 11
 ud_2                -1.559987e-02 1 1  ON 12
 ud_3                -7.574363e-02 1 1  ON 13
 ud_4                -1.226240e-01 1 1  ON 14
 ud_5                -1.536978e-01 1 1  ON 15
 ud_6                -1.554165e-01 1 1  ON 16
 ud_7                -1.104173e-01 1 1  ON 17
 ud_8                 1.438246e-03 1 1  ON 18
 ud_9                 9.292343e-02 1 1  ON 19
 eO_0                -7.642018e-01 1 1  ON 20
 eO_1                -4.457298e-01 1 1  ON 21
 eO_2                -4.070389e-02 1 1  ON 22
 eO_3                 2.102501e-01 1 1  ON 23
 eO_4                 3.003422e-01 1 1  ON 24
 eO_5                 3.129598e-01 1 1  ON 25
 eO_6                 2.533090e-01 1 1  ON 26
 eO_7                 1.157243e-01 1 1  ON 27
 eO_8                 2.840453e-02 1 1  ON 28
 eO_9                 1.868397e-02 1 1  ON 29
eH1_0                -1.827503e-01 1 1  ON 30
eH1_1                -1.034695e-01 1 1  ON 31
eH1_2                -6.275411e-02 1 1  ON 32
eH1_3                -2.582369e-02 1 1  ON 33
eH1_4                 1.925823e-02 1 1  ON 34
eH1_5                 3.464622e-02 1 1  ON 35
eH1_6                 7.807215e-02 1 1  ON 36
eH1_7                 1.097991e-01 1 1  ON 37
eH1_8                 9.258222e-02 1 1  ON 38
eH1_9                 2.478472e-02 1 1  ON 39
eH2_0                -1.842960e-01 1 1  ON 40
eH2_1                -1.048113e-01 1 1  ON 41
eH2_2                -6.350431e-02 1 1  ON 42
eH2_3                -2.672888e-02 1 1  ON 43
eH2_4                 1.864803e-02 1 1  ON 44
eH2_5                 3.368668e-02 1 1  ON 45
eH2_6                 7.912048e-02 1 1  ON 46
eH2_7                 1.128125e-01 1 1  ON 47
eH2_8                 9.558860e-02 1 1  ON 48
eH2_9                 2.708459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.165714
====================================================
  Execution time = 1.9928e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1958e-01
  Total weights = 2.0000e+06
  Execution time = 1.8208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318402020986
                                         uncertainty =       0.005029643898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318402020986
                                         uncertainty =       0.005029643898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399081874
  error estimate for blocks of size 2^( 2) =       0.000408839059
  error estimate for blocks of size 2^( 3) =       0.000417669695
  error estimate for blocks of size 2^( 4) =       0.000423919314
  error estimate for blocks of size 2^( 5) =       0.000426840943
  error estimate for blocks of size 2^( 6) =       0.000427999347
  error estimate for blocks of size 2^( 7) =       0.000427522983

      target function =                  N/A
              le_mean =     -17.216051928278
             les_mean =     296.710976522824
             stat err =       0.000426570647
             autocorr =       1.142504522139
              std dev =       0.564386999242
             le_variance =       0.318532684913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320511700575
                                         uncertainty =       0.005084450293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320511700575
                                         uncertainty =       0.005084450293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400401357
  error estimate for blocks of size 2^( 2) =       0.000410092754
  error estimate for blocks of size 2^( 3) =       0.000418815980
  error estimate for blocks of size 2^( 4) =       0.000424975056
  error estimate for blocks of size 2^( 5) =       0.000427858515
  error estimate for blocks of size 2^( 6) =       0.000429004198
  error estimate for blocks of size 2^( 7) =       0.000428525359

      target function =                  N/A
              le_mean =     -17.216046886928
             les_mean =     296.712912745402
             stat err =       0.000427590782
             autocorr =       1.140422002037
              std dev =       0.566253028985
             le_variance =       0.320642492835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320551717615
                                         uncertainty =       0.005093473727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320551717615
                                         uncertainty =       0.005093473727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400426600
  error estimate for blocks of size 2^( 2) =       0.000410124563
  error estimate for blocks of size 2^( 3) =       0.000418857556
  error estimate for blocks of size 2^( 4) =       0.000425029919
  error estimate for blocks of size 2^( 5) =       0.000427922998
  error estimate for blocks of size 2^( 6) =       0.000429073174
  error estimate for blocks of size 2^( 7) =       0.000428594390

      target function =                  N/A
              le_mean =     -17.216049348449
             les_mean =     296.713037931111
             stat err =       0.000427655120
             autocorr =       1.140621395013
              std dev =       0.566288727798
             le_variance =       0.320682923231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318807569314
                                         uncertainty =       0.005044121473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318807569314
                                         uncertainty =       0.005044121473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399335958
  error estimate for blocks of size 2^( 2) =       0.000409080063
  error estimate for blocks of size 2^( 3) =       0.000417891002
  error estimate for blocks of size 2^( 4) =       0.000424126098
  error estimate for blocks of size 2^( 5) =       0.000427042342
  error estimate for blocks of size 2^( 6) =       0.000428199322
  error estimate for blocks of size 2^( 7) =       0.000427721653

      target function =                  N/A
              le_mean =     -17.216048175547
             les_mean =     296.711253038452
             stat err =       0.000426772354
             autocorr =       1.142130475850
              std dev =       0.564746328171
             le_variance =       0.318938415183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216051928278        initial  <--
     1.5625e-02     1.5625e-01             2.0365e-02       -17.216046886928
     6.2500e-02     6.2500e-01             7.6961e-03       -17.216049348449
     2.5000e-01     2.5000e+00             2.5037e-03       -17.216048175547

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5077
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.082413e-01 1 1  ON 0
 uu_1                 4.713680e-02 1 1  ON 1
 uu_2                -4.647038e-02 1 1  ON 2
 uu_3                -1.001253e-01 1 1  ON 3
 uu_4                -1.320474e-01 1 1  ON 4
 uu_5                -1.372685e-01 1 1  ON 5
 uu_6                -1.133233e-01 1 1  ON 6
 uu_7                -3.977044e-02 1 1  ON 7
 uu_8                 9.849232e-02 1 1  ON 8
 uu_9                 1.213572e-01 1 1  ON 9
 ud_0                 3.493331e-01 1 1  ON 10
 ud_1                 9.183777e-02 1 1  ON 11
 ud_2                -1.611007e-02 1 1  ON 12
 ud_3                -7.548348e-02 1 1  ON 13
 ud_4                -1.215778e-01 1 1  ON 14
 ud_5                -1.526992e-01 1 1  ON 15
 ud_6                -1.545881e-01 1 1  ON 16
 ud_7                -1.097708e-01 1 1  ON 17
 ud_8                 2.822394e-03 1 1  ON 18
 ud_9                 9.253933e-02 1 1  ON 19
 eO_0                -7.565057e-01 1 1  ON 20
 eO_1                -4.399748e-01 1 1  ON 21
 eO_2                -3.840252e-02 1 1  ON 22
 eO_3                 2.089362e-01 1 1  ON 23
 eO_4                 2.937452e-01 1 1  ON 24
 eO_5                 3.091103e-01 1 1  ON 25
 eO_6                 2.518678e-01 1 1  ON 26
 eO_7                 1.139119e-01 1 1  ON 27
 eO_8                 2.802583e-02 1 1  ON 28
 eO_9                 1.851733e-02 1 1  ON 29
eH1_0                -1.822660e-01 1 1  ON 30
eH1_1                -1.033236e-01 1 1  ON 31
eH1_2                -6.260374e-02 1 1  ON 32
eH1_3                -2.587493e-02 1 1  ON 33
eH1_4                 2.010520e-02 1 1  ON 34
eH1_5                 3.518094e-02 1 1  ON 35
eH1_6                 7.763709e-02 1 1  ON 36
eH1_7                 1.096433e-01 1 1  ON 37
eH1_8                 9.155389e-02 1 1  ON 38
eH1_9                 2.449636e-02 1 1  ON 39
eH2_0                -1.824028e-01 1 1  ON 40
eH2_1                -1.045916e-01 1 1  ON 41
eH2_2                -6.357059e-02 1 1  ON 42
eH2_3                -2.739879e-02 1 1  ON 43
eH2_4                 1.818647e-02 1 1  ON 44
eH2_5                 3.435058e-02 1 1  ON 45
eH2_6                 7.893331e-02 1 1  ON 46
eH2_7                 1.131312e-01 1 1  ON 47
eH2_8                 9.445148e-02 1 1  ON 48
eH2_9                 2.668711e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7184e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2561
    reference variance = 0.280664
====================================================
  Execution time = 2.0230e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1924e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319349094060
                                         uncertainty =       0.005302111281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319349094060
                                         uncertainty =       0.005302111281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399523184
  error estimate for blocks of size 2^( 2) =       0.000408942475
  error estimate for blocks of size 2^( 3) =       0.000417521748
  error estimate for blocks of size 2^( 4) =       0.000424084726
  error estimate for blocks of size 2^( 5) =       0.000429183081
  error estimate for blocks of size 2^( 6) =       0.000429704178
  error estimate for blocks of size 2^( 7) =       0.000431961179

      target function =                  N/A
              le_mean =     -17.216660828901
             les_mean =     296.732647486394
             stat err =       0.000428733291
             autocorr =       1.151570268501
              std dev =       0.565011104835
             le_variance =       0.319237548587


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666082890e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660828901       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216662374749       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216662516641       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216664940096       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216667340815       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216672485946       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216671746938       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216671604866       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216672451215       residual = 7.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216672359903       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216672331586       residual = 6.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 3.369353e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660828901       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661629993       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661620018       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216662254059       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216663168953       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664504366       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664204300       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216664371099       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216664423577       residual = 5.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 9.183499e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216660828901       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216661102581       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216661092013       residual = 7.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216661227436       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216661444112       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216661758731       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216661721834       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216661773229       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.311392e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5816e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.087203e-01 1 1  ON 0
 uu_1                 4.721988e-02 1 1  ON 1
 uu_2                -4.642238e-02 1 1  ON 2
 uu_3                -1.001360e-01 1 1  ON 3
 uu_4                -1.322010e-01 1 1  ON 4
 uu_5                -1.374808e-01 1 1  ON 5
 uu_6                -1.135573e-01 1 1  ON 6
 uu_7                -3.992746e-02 1 1  ON 7
 uu_8                 9.841505e-02 1 1  ON 8
 uu_9                 1.214606e-01 1 1  ON 9
 ud_0                 3.497405e-01 1 1  ON 10
 ud_1                 9.198460e-02 1 1  ON 11
 ud_2                -1.616682e-02 1 1  ON 12
 ud_3                -7.558934e-02 1 1  ON 13
 ud_4                -1.217247e-01 1 1  ON 14
 ud_5                -1.528459e-01 1 1  ON 15
 ud_6                -1.546777e-01 1 1  ON 16
 ud_7                -1.098077e-01 1 1  ON 17
 ud_8                 2.684860e-03 1 1  ON 18
 ud_9                 9.257620e-02 1 1  ON 19
 eO_0                -7.574240e-01 1 1  ON 20
 eO_1                -4.407566e-01 1 1  ON 21
 eO_2                -3.860224e-02 1 1  ON 22
 eO_3                 2.092913e-01 1 1  ON 23
 eO_4                 2.946556e-01 1 1  ON 24
 eO_5                 3.093042e-01 1 1  ON 25
 eO_6                 2.520183e-01 1 1  ON 26
 eO_7                 1.141270e-01 1 1  ON 27
 eO_8                 2.806781e-02 1 1  ON 28
 eO_9                 1.853646e-02 1 1  ON 29
eH1_0                -1.823070e-01 1 1  ON 30
eH1_1                -1.032711e-01 1 1  ON 31
eH1_2                -6.253238e-02 1 1  ON 32
eH1_3                -2.590571e-02 1 1  ON 33
eH1_4                 1.991977e-02 1 1  ON 34
eH1_5                 3.519296e-02 1 1  ON 35
eH1_6                 7.765436e-02 1 1  ON 36
eH1_7                 1.095883e-01 1 1  ON 37
eH1_8                 9.165384e-02 1 1  ON 38
eH1_9                 2.453100e-02 1 1  ON 39
eH2_0                -1.827110e-01 1 1  ON 40
eH2_1                -1.045530e-01 1 1  ON 41
eH2_2                -6.365654e-02 1 1  ON 42
eH2_3                -2.732036e-02 1 1  ON 43
eH2_4                 1.823500e-02 1 1  ON 44
eH2_5                 3.430305e-02 1 1  ON 45
eH2_6                 7.898554e-02 1 1  ON 46
eH2_7                 1.131595e-01 1 1  ON 47
eH2_8                 9.460176e-02 1 1  ON 48
eH2_9                 2.672447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.330382
====================================================
  Execution time = 1.9704e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2153e-01
  Total weights = 2.0000e+06
  Execution time = 1.8286e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321160425172
                                         uncertainty =       0.007695252888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321160425172
                                         uncertainty =       0.007695252888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400695379
  error estimate for blocks of size 2^( 2) =       0.000410406704
  error estimate for blocks of size 2^( 3) =       0.000419873466
  error estimate for blocks of size 2^( 4) =       0.000426456986
  error estimate for blocks of size 2^( 5) =       0.000431187348
  error estimate for blocks of size 2^( 6) =       0.000433032985
  error estimate for blocks of size 2^( 7) =       0.000434562839

      target function =                  N/A
              le_mean =     -17.216840307971
             les_mean =     296.740703603525
             stat err =       0.000431310040
             autocorr =       1.158645199001
              std dev =       0.566668839730
             le_variance =       0.321113573921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172679091
                                         uncertainty =       0.007715123718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322172679091
                                         uncertainty =       0.007715123718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401326230
  error estimate for blocks of size 2^( 2) =       0.000411004889
  error estimate for blocks of size 2^( 3) =       0.000420436851
  error estimate for blocks of size 2^( 4) =       0.000426988765
  error estimate for blocks of size 2^( 5) =       0.000431703952
  error estimate for blocks of size 2^( 6) =       0.000433545625
  error estimate for blocks of size 2^( 7) =       0.000435068500

      target function =                  N/A
              le_mean =     -17.216840328835
             les_mean =     296.741716232923
             stat err =       0.000431826711
             autocorr =       1.157774324119
              std dev =       0.567560997048
             le_variance =       0.322125485370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322008886464
                                         uncertainty =       0.007712365963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322008886464
                                         uncertainty =       0.007712365963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401224224
  error estimate for blocks of size 2^( 2) =       0.000410909400
  error estimate for blocks of size 2^( 3) =       0.000420350244
  error estimate for blocks of size 2^( 4) =       0.000426910896
  error estimate for blocks of size 2^( 5) =       0.000431631446
  error estimate for blocks of size 2^( 6) =       0.000433471908
  error estimate for blocks of size 2^( 7) =       0.000434990775

      target function =                  N/A
              le_mean =     -17.216840640612
             les_mean =     296.741563239087
             stat err =       0.000431751257
             autocorr =       1.157958323568
              std dev =       0.567416739116
             le_variance =       0.321961755829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321301468129
                                         uncertainty =       0.007698176239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321301468129
                                         uncertainty =       0.007698176239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400783339
  error estimate for blocks of size 2^( 2) =       0.000410490194
  error estimate for blocks of size 2^( 3) =       0.000419952832
  error estimate for blocks of size 2^( 4) =       0.000426532780
  error estimate for blocks of size 2^( 5) =       0.000431261769
  error estimate for blocks of size 2^( 6) =       0.000433106442
  error estimate for blocks of size 2^( 7) =       0.000434634062

      target function =                  N/A
              le_mean =     -17.216840193568
             les_mean =     296.740840660235
             stat err =       0.000431383763
             autocorr =       1.158532631962
              std dev =       0.566793233923
             le_variance =       0.321254570021


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216840307971        initial
     1.5625e-01     1.5625e+00             3.3694e-03       -17.216840328835
     6.2500e-01     6.2500e+00             9.1835e-04       -17.216840640612  <--
     2.5000e+00     2.5000e+01             2.3114e-04       -17.216840193568

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.8960e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.087203e-01 1 1  ON 0
 uu_1                 4.721988e-02 1 1  ON 1
 uu_2                -4.642238e-02 1 1  ON 2
 uu_3                -1.001360e-01 1 1  ON 3
 uu_4                -1.322010e-01 1 1  ON 4
 uu_5                -1.374808e-01 1 1  ON 5
 uu_6                -1.135573e-01 1 1  ON 6
 uu_7                -3.992746e-02 1 1  ON 7
 uu_8                 9.841505e-02 1 1  ON 8
 uu_9                 1.214606e-01 1 1  ON 9
 ud_0                 3.497405e-01 1 1  ON 10
 ud_1                 9.198460e-02 1 1  ON 11
 ud_2                -1.616682e-02 1 1  ON 12
 ud_3                -7.558934e-02 1 1  ON 13
 ud_4                -1.217247e-01 1 1  ON 14
 ud_5                -1.528459e-01 1 1  ON 15
 ud_6                -1.546777e-01 1 1  ON 16
 ud_7                -1.098077e-01 1 1  ON 17
 ud_8                 2.684860e-03 1 1  ON 18
 ud_9                 9.257620e-02 1 1  ON 19
 eO_0                -7.574240e-01 1 1  ON 20
 eO_1                -4.407566e-01 1 1  ON 21
 eO_2                -3.860224e-02 1 1  ON 22
 eO_3                 2.092913e-01 1 1  ON 23
 eO_4                 2.946556e-01 1 1  ON 24
 eO_5                 3.093042e-01 1 1  ON 25
 eO_6                 2.520183e-01 1 1  ON 26
 eO_7                 1.141270e-01 1 1  ON 27
 eO_8                 2.806781e-02 1 1  ON 28
 eO_9                 1.853646e-02 1 1  ON 29
eH1_0                -1.823070e-01 1 1  ON 30
eH1_1                -1.032711e-01 1 1  ON 31
eH1_2                -6.253238e-02 1 1  ON 32
eH1_3                -2.590571e-02 1 1  ON 33
eH1_4                 1.991977e-02 1 1  ON 34
eH1_5                 3.519296e-02 1 1  ON 35
eH1_6                 7.765436e-02 1 1  ON 36
eH1_7                 1.095883e-01 1 1  ON 37
eH1_8                 9.165384e-02 1 1  ON 38
eH1_9                 2.453100e-02 1 1  ON 39
eH2_0                -1.827110e-01 1 1  ON 40
eH2_1                -1.045530e-01 1 1  ON 41
eH2_2                -6.365654e-02 1 1  ON 42
eH2_3                -2.732036e-02 1 1  ON 43
eH2_4                 1.823500e-02 1 1  ON 44
eH2_5                 3.430305e-02 1 1  ON 45
eH2_6                 7.898554e-02 1 1  ON 46
eH2_7                 1.131595e-01 1 1  ON 47
eH2_8                 9.460176e-02 1 1  ON 48
eH2_9                 2.672447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4782e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1676
    reference variance = 0.215931
====================================================
  Execution time = 2.0055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5799e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320043274922
                                         uncertainty =       0.004465421170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320043274922
                                         uncertainty =       0.004465421170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400010953
  error estimate for blocks of size 2^( 2) =       0.000409705670
  error estimate for blocks of size 2^( 3) =       0.000418593667
  error estimate for blocks of size 2^( 4) =       0.000424638246
  error estimate for blocks of size 2^( 5) =       0.000428770025
  error estimate for blocks of size 2^( 6) =       0.000431710282
  error estimate for blocks of size 2^( 7) =       0.000430467171

      target function =                  N/A
              le_mean =     -17.216825918061
             les_mean =     296.739112058123
             stat err =       0.000428896431
             autocorr =       1.149637966053
              std dev =       0.565700915086
             le_variance =       0.320017525329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682591806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216825918061       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216828137315       residual = 6.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216824177639       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216824270765       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216825181525       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216830093798       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216829330729       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216828483740       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216828984445       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216828898168       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216829291055       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 3.577005e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216825918061       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216826881426       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216825327490       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216824947490       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216825274710       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216826567981       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216826356572       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216826245253       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216826329878       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.079365e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216825918061       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216826213243       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216825769695       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216825588138       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216825645861       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216825958743       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216825906418       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216825891922       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.929097e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028867 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5647e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.088632e-01 1 1  ON 0
 uu_1                 4.747645e-02 1 1  ON 1
 uu_2                -4.635540e-02 1 1  ON 2
 uu_3                -1.001135e-01 1 1  ON 3
 uu_4                -1.322385e-01 1 1  ON 4
 uu_5                -1.377749e-01 1 1  ON 5
 uu_6                -1.136807e-01 1 1  ON 6
 uu_7                -4.004388e-02 1 1  ON 7
 uu_8                 9.832277e-02 1 1  ON 8
 uu_9                 1.215389e-01 1 1  ON 9
 ud_0                 3.500447e-01 1 1  ON 10
 ud_1                 9.217581e-02 1 1  ON 11
 ud_2                -1.615667e-02 1 1  ON 12
 ud_3                -7.571889e-02 1 1  ON 13
 ud_4                -1.218516e-01 1 1  ON 14
 ud_5                -1.529938e-01 1 1  ON 15
 ud_6                -1.546683e-01 1 1  ON 16
 ud_7                -1.097960e-01 1 1  ON 17
 ud_8                 2.520436e-03 1 1  ON 18
 ud_9                 9.255759e-02 1 1  ON 19
 eO_0                -7.585034e-01 1 1  ON 20
 eO_1                -4.413484e-01 1 1  ON 21
 eO_2                -3.881312e-02 1 1  ON 22
 eO_3                 2.096828e-01 1 1  ON 23
 eO_4                 2.954564e-01 1 1  ON 24
 eO_5                 3.095898e-01 1 1  ON 25
 eO_6                 2.522000e-01 1 1  ON 26
 eO_7                 1.143070e-01 1 1  ON 27
 eO_8                 2.809601e-02 1 1  ON 28
 eO_9                 1.854435e-02 1 1  ON 29
eH1_0                -1.823221e-01 1 1  ON 30
eH1_1                -1.032769e-01 1 1  ON 31
eH1_2                -6.259132e-02 1 1  ON 32
eH1_3                -2.579017e-02 1 1  ON 33
eH1_4                 1.989802e-02 1 1  ON 34
eH1_5                 3.505735e-02 1 1  ON 35
eH1_6                 7.764123e-02 1 1  ON 36
eH1_7                 1.095893e-01 1 1  ON 37
eH1_8                 9.175975e-02 1 1  ON 38
eH1_9                 2.455779e-02 1 1  ON 39
eH2_0                -1.829786e-01 1 1  ON 40
eH2_1                -1.044629e-01 1 1  ON 41
eH2_2                -6.380734e-02 1 1  ON 42
eH2_3                -2.737947e-02 1 1  ON 43
eH2_4                 1.828780e-02 1 1  ON 44
eH2_5                 3.439721e-02 1 1  ON 45
eH2_6                 7.904686e-02 1 1  ON 46
eH2_7                 1.131608e-01 1 1  ON 47
eH2_8                 9.473263e-02 1 1  ON 48
eH2_9                 2.675838e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1238
    reference variance = 0.363164
====================================================
  Execution time = 1.9852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1142e-01
  Total weights = 2.0000e+06
  Execution time = 1.8293e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311115037118
                                         uncertainty =       0.002306221978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311115037118
                                         uncertainty =       0.002306221978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394422273
  error estimate for blocks of size 2^( 2) =       0.000403840645
  error estimate for blocks of size 2^( 3) =       0.000412641767
  error estimate for blocks of size 2^( 4) =       0.000419159598
  error estimate for blocks of size 2^( 5) =       0.000423289643
  error estimate for blocks of size 2^( 6) =       0.000425808174
  error estimate for blocks of size 2^( 7) =       0.000427460448

      target function =                  N/A
              le_mean =     -17.216308289640
             les_mean =     296.712408827366
             stat err =       0.000423929466
             autocorr =       1.155219057504
              std dev =       0.557797327903
             le_variance =       0.311137859016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311892820098
                                         uncertainty =       0.002312509359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311892820098
                                         uncertainty =       0.002312509359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394915156
  error estimate for blocks of size 2^( 2) =       0.000404303382
  error estimate for blocks of size 2^( 3) =       0.000413071827
  error estimate for blocks of size 2^( 4) =       0.000419565383
  error estimate for blocks of size 2^( 5) =       0.000423680047
  error estimate for blocks of size 2^( 6) =       0.000426202915
  error estimate for blocks of size 2^( 7) =       0.000427863176

      target function =                  N/A
              le_mean =     -17.216308177771
             les_mean =     296.713183077353
             stat err =       0.000424327880
             autocorr =       1.154504241258
              std dev =       0.558494370017
             le_variance =       0.311915961341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311691563663
                                         uncertainty =       0.002311023100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311691563663
                                         uncertainty =       0.002311023100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394787706
  error estimate for blocks of size 2^( 2) =       0.000404183379
  error estimate for blocks of size 2^( 3) =       0.000412960946
  error estimate for blocks of size 2^( 4) =       0.000419461385
  error estimate for blocks of size 2^( 5) =       0.000423579540
  error estimate for blocks of size 2^( 6) =       0.000426102165
  error estimate for blocks of size 2^( 7) =       0.000427759896

      target function =                  N/A
              le_mean =     -17.216307925465
             les_mean =     296.712973093816
             stat err =       0.000424225746
             autocorr =       1.154693723890
              std dev =       0.558314127757
             le_variance =       0.311714665253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311204473662
                                         uncertainty =       0.002306982779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311204473662
                                         uncertainty =       0.002306982779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394478984
  error estimate for blocks of size 2^( 2) =       0.000403893704
  error estimate for blocks of size 2^( 3) =       0.000412691171
  error estimate for blocks of size 2^( 4) =       0.000419206371
  error estimate for blocks of size 2^( 5) =       0.000423334497
  error estimate for blocks of size 2^( 6) =       0.000425853822
  error estimate for blocks of size 2^( 7) =       0.000427506917

      target function =                  N/A
              le_mean =     -17.216308092961
             les_mean =     296.712491534079
             stat err =       0.000423975402
             autocorr =       1.155137221659
              std dev =       0.557877529531
             le_variance =       0.311227337955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216308289640        initial  <--
     1.5625e-01     1.5625e+00             3.5770e-03       -17.216308177771
     6.2500e-01     6.2500e+00             1.0794e-03       -17.216307925465
     2.5000e+00     2.5000e+01             2.9291e-04       -17.216308092961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1072
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.087203e-01 1 1  ON 0
 uu_1                 4.721988e-02 1 1  ON 1
 uu_2                -4.642238e-02 1 1  ON 2
 uu_3                -1.001360e-01 1 1  ON 3
 uu_4                -1.322010e-01 1 1  ON 4
 uu_5                -1.374808e-01 1 1  ON 5
 uu_6                -1.135573e-01 1 1  ON 6
 uu_7                -3.992746e-02 1 1  ON 7
 uu_8                 9.841505e-02 1 1  ON 8
 uu_9                 1.214606e-01 1 1  ON 9
 ud_0                 3.497405e-01 1 1  ON 10
 ud_1                 9.198460e-02 1 1  ON 11
 ud_2                -1.616682e-02 1 1  ON 12
 ud_3                -7.558934e-02 1 1  ON 13
 ud_4                -1.217247e-01 1 1  ON 14
 ud_5                -1.528459e-01 1 1  ON 15
 ud_6                -1.546777e-01 1 1  ON 16
 ud_7                -1.098077e-01 1 1  ON 17
 ud_8                 2.684860e-03 1 1  ON 18
 ud_9                 9.257620e-02 1 1  ON 19
 eO_0                -7.574240e-01 1 1  ON 20
 eO_1                -4.407566e-01 1 1  ON 21
 eO_2                -3.860224e-02 1 1  ON 22
 eO_3                 2.092913e-01 1 1  ON 23
 eO_4                 2.946556e-01 1 1  ON 24
 eO_5                 3.093042e-01 1 1  ON 25
 eO_6                 2.520183e-01 1 1  ON 26
 eO_7                 1.141270e-01 1 1  ON 27
 eO_8                 2.806781e-02 1 1  ON 28
 eO_9                 1.853646e-02 1 1  ON 29
eH1_0                -1.823070e-01 1 1  ON 30
eH1_1                -1.032711e-01 1 1  ON 31
eH1_2                -6.253238e-02 1 1  ON 32
eH1_3                -2.590571e-02 1 1  ON 33
eH1_4                 1.991977e-02 1 1  ON 34
eH1_5                 3.519296e-02 1 1  ON 35
eH1_6                 7.765436e-02 1 1  ON 36
eH1_7                 1.095883e-01 1 1  ON 37
eH1_8                 9.165384e-02 1 1  ON 38
eH1_9                 2.453100e-02 1 1  ON 39
eH2_0                -1.827110e-01 1 1  ON 40
eH2_1                -1.045530e-01 1 1  ON 41
eH2_2                -6.365654e-02 1 1  ON 42
eH2_3                -2.732036e-02 1 1  ON 43
eH2_4                 1.823500e-02 1 1  ON 44
eH2_5                 3.430305e-02 1 1  ON 45
eH2_6                 7.898554e-02 1 1  ON 46
eH2_7                 1.131595e-01 1 1  ON 47
eH2_8                 9.460176e-02 1 1  ON 48
eH2_9                 2.672447e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4760e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1617
    reference variance = 0.256157
====================================================
  Execution time = 2.0331e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314589306602
                                         uncertainty =       0.003237335405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314589306602
                                         uncertainty =       0.003237335405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396620342
  error estimate for blocks of size 2^( 2) =       0.000406261434
  error estimate for blocks of size 2^( 3) =       0.000415109193
  error estimate for blocks of size 2^( 4) =       0.000421444038
  error estimate for blocks of size 2^( 5) =       0.000424974825
  error estimate for blocks of size 2^( 6) =       0.000427570363
  error estimate for blocks of size 2^( 7) =       0.000429170382

      target function =                  N/A
              le_mean =     -17.217428598096
             les_mean =     296.754462764722
             stat err =       0.000425789902
             autocorr =       1.152499498450
              std dev =       0.560905866874
             le_variance =       0.314615391494


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721742859810e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217428598096       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217429482333       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217430026913       residual = 8.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217430419006       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217429860799       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217429932207       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217430082134       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217430184888       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 5.006215e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217428598096       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217428832835       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217428982098       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217429094614       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217428951214       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217428978601       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217429012548       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217429030155       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.301074e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217428598096       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217428657703       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217428695962       residual = 7.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217428725198       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217428689211       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217428696852       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217428705126       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217428709140       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 3.288225e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.031563 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5907e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.087449e-01 1 1  ON 0
 uu_1                 4.725593e-02 1 1  ON 1
 uu_2                -4.642142e-02 1 1  ON 2
 uu_3                -1.001377e-01 1 1  ON 3
 uu_4                -1.322067e-01 1 1  ON 4
 uu_5                -1.374976e-01 1 1  ON 5
 uu_6                -1.135739e-01 1 1  ON 6
 uu_7                -3.995614e-02 1 1  ON 7
 uu_8                 9.840571e-02 1 1  ON 8
 uu_9                 1.214693e-01 1 1  ON 9
 ud_0                 3.497607e-01 1 1  ON 10
 ud_1                 9.202310e-02 1 1  ON 11
 ud_2                -1.615652e-02 1 1  ON 12
 ud_3                -7.558391e-02 1 1  ON 13
 ud_4                -1.217424e-01 1 1  ON 14
 ud_5                -1.528381e-01 1 1  ON 15
 ud_6                -1.546976e-01 1 1  ON 16
 ud_7                -1.098366e-01 1 1  ON 17
 ud_8                 2.661613e-03 1 1  ON 18
 ud_9                 9.257528e-02 1 1  ON 19
 eO_0                -7.575541e-01 1 1  ON 20
 eO_1                -4.408206e-01 1 1  ON 21
 eO_2                -3.859926e-02 1 1  ON 22
 eO_3                 2.093378e-01 1 1  ON 23
 eO_4                 2.947450e-01 1 1  ON 24
 eO_5                 3.093331e-01 1 1  ON 25
 eO_6                 2.520267e-01 1 1  ON 26
 eO_7                 1.141412e-01 1 1  ON 27
 eO_8                 2.807061e-02 1 1  ON 28
 eO_9                 1.853719e-02 1 1  ON 29
eH1_0                -1.823102e-01 1 1  ON 30
eH1_1                -1.032712e-01 1 1  ON 31
eH1_2                -6.253493e-02 1 1  ON 32
eH1_3                -2.591004e-02 1 1  ON 33
eH1_4                 1.991690e-02 1 1  ON 34
eH1_5                 3.519873e-02 1 1  ON 35
eH1_6                 7.765589e-02 1 1  ON 36
eH1_7                 1.095825e-01 1 1  ON 37
eH1_8                 9.166161e-02 1 1  ON 38
eH1_9                 2.453375e-02 1 1  ON 39
eH2_0                -1.827271e-01 1 1  ON 40
eH2_1                -1.045577e-01 1 1  ON 41
eH2_2                -6.365894e-02 1 1  ON 42
eH2_3                -2.732217e-02 1 1  ON 43
eH2_4                 1.826218e-02 1 1  ON 44
eH2_5                 3.430113e-02 1 1  ON 45
eH2_6                 7.897746e-02 1 1  ON 46
eH2_7                 1.131554e-01 1 1  ON 47
eH2_8                 9.461123e-02 1 1  ON 48
eH2_9                 2.672701e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3401
    reference variance = 0.324797
====================================================
  Execution time = 1.9905e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1029e-01
  Total weights = 2.0000e+06
  Execution time = 1.8397e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310273029523
                                         uncertainty =       0.003415988331

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310273029523
                                         uncertainty =       0.003415988331

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393873418
  error estimate for blocks of size 2^( 2) =       0.000403296716
  error estimate for blocks of size 2^( 3) =       0.000412096372
  error estimate for blocks of size 2^( 4) =       0.000418331307
  error estimate for blocks of size 2^( 5) =       0.000420996418
  error estimate for blocks of size 2^( 6) =       0.000423280145
  error estimate for blocks of size 2^( 7) =       0.000423408081

      target function =                  N/A
              le_mean =     -17.216853115813
             les_mean =     296.730303595459
             stat err =       0.000421503988
             autocorr =       1.145222920956
              std dev =       0.557021129868
             le_variance =       0.310272539119

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310343937066
                                         uncertainty =       0.003418070127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310343937066
                                         uncertainty =       0.003418070127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393918425
  error estimate for blocks of size 2^( 2) =       0.000403338838
  error estimate for blocks of size 2^( 3) =       0.000412134725
  error estimate for blocks of size 2^( 4) =       0.000418367696
  error estimate for blocks of size 2^( 5) =       0.000421030694
  error estimate for blocks of size 2^( 6) =       0.000423311342
  error estimate for blocks of size 2^( 7) =       0.000423438644

      target function =                  N/A
              le_mean =     -17.216853157188
             les_mean =     296.730375932061
             stat err =       0.000421537094
             autocorr =       1.145141107038
              std dev =       0.557084779074
             le_variance =       0.310343451076

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310305797225
                                         uncertainty =       0.003417101836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310305797225
                                         uncertainty =       0.003417101836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393894217
  error estimate for blocks of size 2^( 2) =       0.000403316114
  error estimate for blocks of size 2^( 3) =       0.000412113840
  error estimate for blocks of size 2^( 4) =       0.000418347883
  error estimate for blocks of size 2^( 5) =       0.000421011922
  error estimate for blocks of size 2^( 6) =       0.000423293960
  error estimate for blocks of size 2^( 7) =       0.000423421507

      target function =                  N/A
              le_mean =     -17.216853166983
             les_mean =     296.730338126808
             stat err =       0.000421518818
             autocorr =       1.145182560004
              std dev =       0.557050543932
             le_variance =       0.310305308495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276982727
                                         uncertainty =       0.003416130160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310276982727
                                         uncertainty =       0.003416130160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393875927
  error estimate for blocks of size 2^( 2) =       0.000403299052
  error estimate for blocks of size 2^( 3) =       0.000412098465
  error estimate for blocks of size 2^( 4) =       0.000418333293
  error estimate for blocks of size 2^( 5) =       0.000420998269
  error estimate for blocks of size 2^( 6) =       0.000423281779
  error estimate for blocks of size 2^( 7) =       0.000423409663

      target function =                  N/A
              le_mean =     -17.216853122187
             les_mean =     296.730307768342
             stat err =       0.000421505751
             autocorr =       1.145217909609
              std dev =       0.557024678546
             le_variance =       0.310276492509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216853115813        initial
     1.5625e+00     1.5625e+01             5.0062e-04       -17.216853157188
     6.2500e+00     6.2500e+01             1.3011e-04       -17.216853166983  <--
     2.5000e+01     2.5000e+02             3.2882e-05       -17.216853122187

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9170e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.087449e-01 1 1  ON 0
 uu_1                 4.725593e-02 1 1  ON 1
 uu_2                -4.642142e-02 1 1  ON 2
 uu_3                -1.001377e-01 1 1  ON 3
 uu_4                -1.322067e-01 1 1  ON 4
 uu_5                -1.374976e-01 1 1  ON 5
 uu_6                -1.135739e-01 1 1  ON 6
 uu_7                -3.995614e-02 1 1  ON 7
 uu_8                 9.840571e-02 1 1  ON 8
 uu_9                 1.214693e-01 1 1  ON 9
 ud_0                 3.497607e-01 1 1  ON 10
 ud_1                 9.202310e-02 1 1  ON 11
 ud_2                -1.615652e-02 1 1  ON 12
 ud_3                -7.558391e-02 1 1  ON 13
 ud_4                -1.217424e-01 1 1  ON 14
 ud_5                -1.528381e-01 1 1  ON 15
 ud_6                -1.546976e-01 1 1  ON 16
 ud_7                -1.098366e-01 1 1  ON 17
 ud_8                 2.661613e-03 1 1  ON 18
 ud_9                 9.257528e-02 1 1  ON 19
 eO_0                -7.575541e-01 1 1  ON 20
 eO_1                -4.408206e-01 1 1  ON 21
 eO_2                -3.859926e-02 1 1  ON 22
 eO_3                 2.093378e-01 1 1  ON 23
 eO_4                 2.947450e-01 1 1  ON 24
 eO_5                 3.093331e-01 1 1  ON 25
 eO_6                 2.520267e-01 1 1  ON 26
 eO_7                 1.141412e-01 1 1  ON 27
 eO_8                 2.807061e-02 1 1  ON 28
 eO_9                 1.853719e-02 1 1  ON 29
eH1_0                -1.823102e-01 1 1  ON 30
eH1_1                -1.032712e-01 1 1  ON 31
eH1_2                -6.253493e-02 1 1  ON 32
eH1_3                -2.591004e-02 1 1  ON 33
eH1_4                 1.991690e-02 1 1  ON 34
eH1_5                 3.519873e-02 1 1  ON 35
eH1_6                 7.765589e-02 1 1  ON 36
eH1_7                 1.095825e-01 1 1  ON 37
eH1_8                 9.166161e-02 1 1  ON 38
eH1_9                 2.453375e-02 1 1  ON 39
eH2_0                -1.827271e-01 1 1  ON 40
eH2_1                -1.045577e-01 1 1  ON 41
eH2_2                -6.365894e-02 1 1  ON 42
eH2_3                -2.732217e-02 1 1  ON 43
eH2_4                 1.826218e-02 1 1  ON 44
eH2_5                 3.430113e-02 1 1  ON 45
eH2_6                 7.897746e-02 1 1  ON 46
eH2_7                 1.131554e-01 1 1  ON 47
eH2_8                 9.461123e-02 1 1  ON 48
eH2_9                 2.672701e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.1789
    reference variance = 0.223461
====================================================
  Execution time = 2.0094e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1574e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315796120661
                                         uncertainty =       0.003076798377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315796120661
                                         uncertainty =       0.003076798377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397330429
  error estimate for blocks of size 2^( 2) =       0.000406966012
  error estimate for blocks of size 2^( 3) =       0.000415843852
  error estimate for blocks of size 2^( 4) =       0.000422818266
  error estimate for blocks of size 2^( 5) =       0.000427193733
  error estimate for blocks of size 2^( 6) =       0.000431084212
  error estimate for blocks of size 2^( 7) =       0.000433433312

      target function =                  N/A
              le_mean =     -17.217226057687
             les_mean =     296.748615903653
             stat err =       0.000428632381
             autocorr =       1.163767700859
              std dev =       0.561910081808
             le_variance =       0.315742940038


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721722605769e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217226057687       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217226464145       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217226754229       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217226849621       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217226848719       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217226827766       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217226977369       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217226954970       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.905892e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217226057687       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217226166818       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217226245048       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217226258552       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217226239963       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217226241740       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217226279312       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 9.947039e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217226057687       residual = 5.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217226085484       residual = 5.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217226105454       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217226108016       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217226101736       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217226102636       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217226112114       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.502928e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5743e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.087837e-01 1 1  ON 0
 uu_1                 4.725477e-02 1 1  ON 1
 uu_2                -4.640321e-02 1 1  ON 2
 uu_3                -1.001380e-01 1 1  ON 3
 uu_4                -1.322123e-01 1 1  ON 4
 uu_5                -1.375160e-01 1 1  ON 5
 uu_6                -1.136010e-01 1 1  ON 6
 uu_7                -3.997289e-02 1 1  ON 7
 uu_8                 9.839605e-02 1 1  ON 8
 uu_9                 1.214779e-01 1 1  ON 9
 ud_0                 3.497923e-01 1 1  ON 10
 ud_1                 9.203775e-02 1 1  ON 11
 ud_2                -1.615097e-02 1 1  ON 12
 ud_3                -7.559617e-02 1 1  ON 13
 ud_4                -1.217698e-01 1 1  ON 14
 ud_5                -1.528546e-01 1 1  ON 15
 ud_6                -1.546929e-01 1 1  ON 16
 ud_7                -1.098384e-01 1 1  ON 17
 ud_8                 2.647633e-03 1 1  ON 18
 ud_9                 9.257802e-02 1 1  ON 19
 eO_0                -7.576536e-01 1 1  ON 20
 eO_1                -4.408789e-01 1 1  ON 21
 eO_2                -3.862852e-02 1 1  ON 22
 eO_3                 2.093720e-01 1 1  ON 23
 eO_4                 2.948385e-01 1 1  ON 24
 eO_5                 3.093500e-01 1 1  ON 25
 eO_6                 2.520402e-01 1 1  ON 26
 eO_7                 1.141623e-01 1 1  ON 27
 eO_8                 2.807499e-02 1 1  ON 28
 eO_9                 1.853861e-02 1 1  ON 29
eH1_0                -1.823231e-01 1 1  ON 30
eH1_1                -1.032700e-01 1 1  ON 31
eH1_2                -6.253658e-02 1 1  ON 32
eH1_3                -2.591537e-02 1 1  ON 33
eH1_4                 1.990200e-02 1 1  ON 34
eH1_5                 3.521071e-02 1 1  ON 35
eH1_6                 7.766493e-02 1 1  ON 36
eH1_7                 1.095761e-01 1 1  ON 37
eH1_8                 9.167350e-02 1 1  ON 38
eH1_9                 2.453890e-02 1 1  ON 39
eH2_0                -1.827612e-01 1 1  ON 40
eH2_1                -1.045573e-01 1 1  ON 41
eH2_2                -6.366778e-02 1 1  ON 42
eH2_3                -2.730535e-02 1 1  ON 43
eH2_4                 1.828397e-02 1 1  ON 44
eH2_5                 3.429639e-02 1 1  ON 45
eH2_6                 7.897499e-02 1 1  ON 46
eH2_7                 1.131505e-01 1 1  ON 47
eH2_8                 9.462217e-02 1 1  ON 48
eH2_9                 2.673010e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2914
    reference variance = 0.186135
====================================================
  Execution time = 1.9864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1629e-01
  Total weights = 2.0000e+06
  Execution time = 1.8274e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316349257381
                                         uncertainty =       0.004403032897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316349257381
                                         uncertainty =       0.004403032897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397656437
  error estimate for blocks of size 2^( 2) =       0.000407518372
  error estimate for blocks of size 2^( 3) =       0.000416020605
  error estimate for blocks of size 2^( 4) =       0.000422717196
  error estimate for blocks of size 2^( 5) =       0.000427048384
  error estimate for blocks of size 2^( 6) =       0.000427599165
  error estimate for blocks of size 2^( 7) =       0.000429237370

      target function =                  N/A
              le_mean =     -17.215987469929
             les_mean =     296.706485689782
             stat err =       0.000426650529
             autocorr =       1.151141055686
              std dev =       0.562371125811
             le_variance =       0.316261283146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316441274176
                                         uncertainty =       0.004406492741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316441274176
                                         uncertainty =       0.004406492741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397714253
  error estimate for blocks of size 2^( 2) =       0.000407573024
  error estimate for blocks of size 2^( 3) =       0.000416070569
  error estimate for blocks of size 2^( 4) =       0.000422764015
  error estimate for blocks of size 2^( 5) =       0.000427092928
  error estimate for blocks of size 2^( 6) =       0.000427642603
  error estimate for blocks of size 2^( 7) =       0.000429282530

      target function =                  N/A
              le_mean =     -17.215987635196
             les_mean =     296.706583350859
             stat err =       0.000426695519
             autocorr =       1.151049112677
              std dev =       0.562452890297
             le_variance =       0.316353253803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316397440259
                                         uncertainty =       0.004405013978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316397440259
                                         uncertainty =       0.004405013978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397686710
  error estimate for blocks of size 2^( 2) =       0.000407547028
  error estimate for blocks of size 2^( 3) =       0.000416046815
  error estimate for blocks of size 2^( 4) =       0.000422741734
  error estimate for blocks of size 2^( 5) =       0.000427071741
  error estimate for blocks of size 2^( 6) =       0.000427621818
  error estimate for blocks of size 2^( 7) =       0.000429261039

      target function =                  N/A
              le_mean =     -17.215987590615
             les_mean =     296.706538001016
             stat err =       0.000426674083
             autocorr =       1.151092890437
              std dev =       0.562413939164
             le_variance =       0.316309438966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316355338177
                                         uncertainty =       0.004403289052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316355338177
                                         uncertainty =       0.004403289052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397660257
  error estimate for blocks of size 2^( 2) =       0.000407521988
  error estimate for blocks of size 2^( 3) =       0.000416023909
  error estimate for blocks of size 2^( 4) =       0.000422720288
  error estimate for blocks of size 2^( 5) =       0.000427051327
  error estimate for blocks of size 2^( 6) =       0.000427602013
  error estimate for blocks of size 2^( 7) =       0.000429240349

      target function =                  N/A
              le_mean =     -17.215987483436
             les_mean =     296.706492232098
             stat err =       0.000426653495
             autocorr =       1.151134939349
              std dev =       0.562376529041
             le_variance =       0.316267360416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215987469929        initial
     1.5625e+00     1.5625e+01             3.9059e-04       -17.215987635196  <--
     6.2500e+00     6.2500e+01             9.9470e-05       -17.215987590615
     2.5000e+01     2.5000e+02             2.5029e-05       -17.215987483436

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9120e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.088925e-01 1 1  ON 0
 uu_1                 4.726574e-02 1 1  ON 1
 uu_2                -4.635408e-02 1 1  ON 2
 uu_3                -1.001367e-01 1 1  ON 3
 uu_4                -1.322367e-01 1 1  ON 4
 uu_5                -1.375698e-01 1 1  ON 5
 uu_6                -1.136805e-01 1 1  ON 6
 uu_7                -4.002320e-02 1 1  ON 7
 uu_8                 9.836681e-02 1 1  ON 8
 uu_9                 1.215039e-01 1 1  ON 9
 ud_0                 3.498782e-01 1 1  ON 10
 ud_1                 9.208145e-02 1 1  ON 11
 ud_2                -1.613786e-02 1 1  ON 12
 ud_3                -7.562615e-02 1 1  ON 13
 ud_4                -1.218420e-01 1 1  ON 14
 ud_5                -1.529074e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.098435e-01 1 1  ON 17
 ud_8                 2.605664e-03 1 1  ON 18
 ud_9                 9.258633e-02 1 1  ON 19
 eO_0                -7.579447e-01 1 1  ON 20
 eO_1                -4.410594e-01 1 1  ON 21
 eO_2                -3.871031e-02 1 1  ON 22
 eO_3                 2.094667e-01 1 1  ON 23
 eO_4                 2.951149e-01 1 1  ON 24
 eO_5                 3.094034e-01 1 1  ON 25
 eO_6                 2.520817e-01 1 1  ON 26
 eO_7                 1.142263e-01 1 1  ON 27
 eO_8                 2.808820e-02 1 1  ON 28
 eO_9                 1.854288e-02 1 1  ON 29
eH1_0                -1.823609e-01 1 1  ON 30
eH1_1                -1.032688e-01 1 1  ON 31
eH1_2                -6.253929e-02 1 1  ON 32
eH1_3                -2.592898e-02 1 1  ON 33
eH1_4                 1.985826e-02 1 1  ON 34
eH1_5                 3.524154e-02 1 1  ON 35
eH1_6                 7.769206e-02 1 1  ON 36
eH1_7                 1.095573e-01 1 1  ON 37
eH1_8                 9.170946e-02 1 1  ON 38
eH1_9                 2.455446e-02 1 1  ON 39
eH2_0                -1.828577e-01 1 1  ON 40
eH2_1                -1.045592e-01 1 1  ON 41
eH2_2                -6.369205e-02 1 1  ON 42
eH2_3                -2.726088e-02 1 1  ON 43
eH2_4                 1.834663e-02 1 1  ON 44
eH2_5                 3.428388e-02 1 1  ON 45
eH2_6                 7.896868e-02 1 1  ON 46
eH2_7                 1.131361e-01 1 1  ON 47
eH2_8                 9.465524e-02 1 1  ON 48
eH2_9                 2.673944e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4869e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2794
    reference variance = 0.2341
====================================================
  Execution time = 2.0362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2274e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322796249825
                                         uncertainty =       0.005555915741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322796249825
                                         uncertainty =       0.005555915741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401711288
  error estimate for blocks of size 2^( 2) =       0.000410997706
  error estimate for blocks of size 2^( 3) =       0.000419411361
  error estimate for blocks of size 2^( 4) =       0.000426102192
  error estimate for blocks of size 2^( 5) =       0.000430441633
  error estimate for blocks of size 2^( 6) =       0.000432477190
  error estimate for blocks of size 2^( 7) =       0.000430779824

      target function =                  N/A
              le_mean =     -17.216663885713
             les_mean =     296.736259109465
             stat err =       0.000429950210
             autocorr =       1.145534728508
              std dev =       0.568105551132
             le_variance =       0.322743917227


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666388571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216663885713       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216668213989       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216668967976       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216668584948       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216669454245       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216670118545       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216670354676       residual = 6.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216669973111       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216670135489       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.554039e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216663885713       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216665482236       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216665689208       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216665943143       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216665746150       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216665873230       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216665938597       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216665856675       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 4.184971e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216663885713       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216664338683       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216664394089       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216664463841       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216664429644       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216664436759       residual = 6.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216664446869       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216664432285       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.073318e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.036975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5914e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.089627e-01 1 1  ON 0
 uu_1                 4.736831e-02 1 1  ON 1
 uu_2                -4.630787e-02 1 1  ON 2
 uu_3                -1.001424e-01 1 1  ON 3
 uu_4                -1.322460e-01 1 1  ON 4
 uu_5                -1.376628e-01 1 1  ON 5
 uu_6                -1.137324e-01 1 1  ON 6
 uu_7                -4.008119e-02 1 1  ON 7
 uu_8                 9.830644e-02 1 1  ON 8
 uu_9                 1.215301e-01 1 1  ON 9
 ud_0                 3.500275e-01 1 1  ON 10
 ud_1                 9.215524e-02 1 1  ON 11
 ud_2                -1.615129e-02 1 1  ON 12
 ud_3                -7.564118e-02 1 1  ON 13
 ud_4                -1.219106e-01 1 1  ON 14
 ud_5                -1.529313e-01 1 1  ON 15
 ud_6                -1.546805e-01 1 1  ON 16
 ud_7                -1.098864e-01 1 1  ON 17
 ud_8                 2.517392e-03 1 1  ON 18
 ud_9                 9.257993e-02 1 1  ON 19
 eO_0                -7.583632e-01 1 1  ON 20
 eO_1                -4.413530e-01 1 1  ON 21
 eO_2                -3.876326e-02 1 1  ON 22
 eO_3                 2.095986e-01 1 1  ON 23
 eO_4                 2.954924e-01 1 1  ON 24
 eO_5                 3.095243e-01 1 1  ON 25
 eO_6                 2.521345e-01 1 1  ON 26
 eO_7                 1.142953e-01 1 1  ON 27
 eO_8                 2.809667e-02 1 1  ON 28
 eO_9                 1.854532e-02 1 1  ON 29
eH1_0                -1.823589e-01 1 1  ON 30
eH1_1                -1.032485e-01 1 1  ON 31
eH1_2                -6.256160e-02 1 1  ON 32
eH1_3                -2.596663e-02 1 1  ON 33
eH1_4                 1.979104e-02 1 1  ON 34
eH1_5                 3.530482e-02 1 1  ON 35
eH1_6                 7.771808e-02 1 1  ON 36
eH1_7                 1.095325e-01 1 1  ON 37
eH1_8                 9.173688e-02 1 1  ON 38
eH1_9                 2.456634e-02 1 1  ON 39
eH2_0                -1.829508e-01 1 1  ON 40
eH2_1                -1.045439e-01 1 1  ON 41
eH2_2                -6.370132e-02 1 1  ON 42
eH2_3                -2.717967e-02 1 1  ON 43
eH2_4                 1.841129e-02 1 1  ON 44
eH2_5                 3.420721e-02 1 1  ON 45
eH2_6                 7.896335e-02 1 1  ON 46
eH2_7                 1.131136e-01 1 1  ON 47
eH2_8                 9.468722e-02 1 1  ON 48
eH2_9                 2.674796e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1603
    reference variance = 0.233265
====================================================
  Execution time = 2.0228e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3101e-01
  Total weights = 2.0000e+06
  Execution time = 1.8269e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330816360566
                                         uncertainty =       0.011023196819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330816360566
                                         uncertainty =       0.011023196819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406735988
  error estimate for blocks of size 2^( 2) =       0.000416564450
  error estimate for blocks of size 2^( 3) =       0.000425401283
  error estimate for blocks of size 2^( 4) =       0.000431948815
  error estimate for blocks of size 2^( 5) =       0.000437044504
  error estimate for blocks of size 2^( 6) =       0.000439375497
  error estimate for blocks of size 2^( 7) =       0.000441347933

      target function =                  N/A
              le_mean =     -17.215891843905
             les_mean =     296.717800143662
             stat err =       0.000437429187
             autocorr =       1.156618978117
              std dev =       0.575211550717
             le_variance =       0.330868328078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331233364659
                                         uncertainty =       0.011030702204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331233364659
                                         uncertainty =       0.011030702204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406992302
  error estimate for blocks of size 2^( 2) =       0.000416806081
  error estimate for blocks of size 2^( 3) =       0.000425626325
  error estimate for blocks of size 2^( 4) =       0.000432166572
  error estimate for blocks of size 2^( 5) =       0.000437255137
  error estimate for blocks of size 2^( 6) =       0.000439577925
  error estimate for blocks of size 2^( 7) =       0.000441553493

      target function =                  N/A
              le_mean =     -17.215892615146
             les_mean =     296.718243837852
             stat err =       0.000437638282
             autocorr =       1.156267236296
              std dev =       0.575574032826
             le_variance =       0.331285467263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331102249939
                                         uncertainty =       0.011027668296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331102249939
                                         uncertainty =       0.011027668296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406911746
  error estimate for blocks of size 2^( 2) =       0.000416729923
  error estimate for blocks of size 2^( 3) =       0.000425555594
  error estimate for blocks of size 2^( 4) =       0.000432098776
  error estimate for blocks of size 2^( 5) =       0.000437190278
  error estimate for blocks of size 2^( 6) =       0.000439516364
  error estimate for blocks of size 2^( 7) =       0.000441492163

      target function =                  N/A
              le_mean =     -17.215892425855
             les_mean =     296.718106191652
             stat err =       0.000437574396
             autocorr =       1.156387395785
              std dev =       0.575460110367
             le_variance =       0.331154338624

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330856271974
                                         uncertainty =       0.011023763852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330856271974
                                         uncertainty =       0.011023763852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406760530
  error estimate for blocks of size 2^( 2) =       0.000416587512
  error estimate for blocks of size 2^( 3) =       0.000425422761
  error estimate for blocks of size 2^( 4) =       0.000431969711
  error estimate for blocks of size 2^( 5) =       0.000437064848
  error estimate for blocks of size 2^( 6) =       0.000439395155
  error estimate for blocks of size 2^( 7) =       0.000441368046

      target function =                  N/A
              le_mean =     -17.215891910395
             les_mean =     296.717842362875
             stat err =       0.000437449440
             autocorr =       1.156586502623
              std dev =       0.575246258520
             le_variance =       0.330908257941


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215891843905        initial
     3.9062e-01     3.9062e+00             1.5540e-03       -17.215892615146  <--
     1.5625e+00     1.5625e+01             4.1850e-04       -17.215892425855
     6.2500e+00     6.2500e+01             1.0733e-04       -17.215891910395

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9485e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.092143e-01 1 1  ON 0
 uu_1                 4.761099e-02 1 1  ON 1
 uu_2                -4.617824e-02 1 1  ON 2
 uu_3                -1.001530e-01 1 1  ON 3
 uu_4                -1.323121e-01 1 1  ON 4
 uu_5                -1.378866e-01 1 1  ON 5
 uu_6                -1.138832e-01 1 1  ON 6
 uu_7                -4.025174e-02 1 1  ON 7
 uu_8                 9.812820e-02 1 1  ON 8
 uu_9                 1.216078e-01 1 1  ON 9
 ud_0                 3.503452e-01 1 1  ON 10
 ud_1                 9.236482e-02 1 1  ON 11
 ud_2                -1.611056e-02 1 1  ON 12
 ud_3                -7.565741e-02 1 1  ON 13
 ud_4                -1.220616e-01 1 1  ON 14
 ud_5                -1.530446e-01 1 1  ON 15
 ud_6                -1.546795e-01 1 1  ON 16
 ud_7                -1.100030e-01 1 1  ON 17
 ud_8                 2.258305e-03 1 1  ON 18
 ud_9                 9.256109e-02 1 1  ON 19
 eO_0                -7.594987e-01 1 1  ON 20
 eO_1                -4.421841e-01 1 1  ON 21
 eO_2                -3.900567e-02 1 1  ON 22
 eO_3                 2.099401e-01 1 1  ON 23
 eO_4                 2.965740e-01 1 1  ON 24
 eO_5                 3.099037e-01 1 1  ON 25
 eO_6                 2.522971e-01 1 1  ON 26
 eO_7                 1.145005e-01 1 1  ON 27
 eO_8                 2.812192e-02 1 1  ON 28
 eO_9                 1.855258e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032364e-01 1 1  ON 31
eH1_2                -6.262216e-02 1 1  ON 32
eH1_3                -2.603763e-02 1 1  ON 33
eH1_4                 1.963374e-02 1 1  ON 34
eH1_5                 3.545168e-02 1 1  ON 35
eH1_6                 7.779843e-02 1 1  ON 36
eH1_7                 1.094646e-01 1 1  ON 37
eH1_8                 9.181893e-02 1 1  ON 38
eH1_9                 2.460171e-02 1 1  ON 39
eH2_0                -1.831663e-01 1 1  ON 40
eH2_1                -1.045115e-01 1 1  ON 41
eH2_2                -6.371543e-02 1 1  ON 42
eH2_3                -2.701404e-02 1 1  ON 43
eH2_4                 1.858171e-02 1 1  ON 44
eH2_5                 3.401059e-02 1 1  ON 45
eH2_6                 7.895049e-02 1 1  ON 46
eH2_7                 1.130485e-01 1 1  ON 47
eH2_8                 9.478236e-02 1 1  ON 48
eH2_9                 2.677329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2145
    reference variance = 0.226572
====================================================
  Execution time = 2.2259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2406e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324071592948
                                         uncertainty =       0.008211595837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324071592948
                                         uncertainty =       0.008211595837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402529011
  error estimate for blocks of size 2^( 2) =       0.000412133389
  error estimate for blocks of size 2^( 3) =       0.000421064834
  error estimate for blocks of size 2^( 4) =       0.000427878811
  error estimate for blocks of size 2^( 5) =       0.000432290028
  error estimate for blocks of size 2^( 6) =       0.000434534388
  error estimate for blocks of size 2^( 7) =       0.000435028287

      target function =                  N/A
              le_mean =     -17.216716848656
             les_mean =     296.739398093822
             stat err =       0.000432432879
             autocorr =       1.154098937871
              std dev =       0.569261986300
             le_variance =       0.324059209046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671684866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216716848656       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216720099456       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717859427       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216721863946       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216718850418       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216725487949       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216726277907       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216724837628       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216724399175       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216725686411       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216726008719       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216726169933       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 5.081600e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216716848656       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216718368296       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717325581       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216719700210       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717961466       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216719814535       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216719826767       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216719528250       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216719498291       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216719598924       residual = 1.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.568847e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216716848656       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717334143       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717008118       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717866393       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717334202       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717694500       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717618940       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 4.300606e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040640 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7845e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.095554e-01 1 1  ON 0
 uu_1                 4.783541e-02 1 1  ON 1
 uu_2                -4.612700e-02 1 1  ON 2
 uu_3                -1.001452e-01 1 1  ON 3
 uu_4                -1.324957e-01 1 1  ON 4
 uu_5                -1.381420e-01 1 1  ON 5
 uu_6                -1.141623e-01 1 1  ON 6
 uu_7                -4.049420e-02 1 1  ON 7
 uu_8                 9.793342e-02 1 1  ON 8
 uu_9                 1.218067e-01 1 1  ON 9
 ud_0                 3.505540e-01 1 1  ON 10
 ud_1                 9.261920e-02 1 1  ON 11
 ud_2                -1.597318e-02 1 1  ON 12
 ud_3                -7.584305e-02 1 1  ON 13
 ud_4                -1.223361e-01 1 1  ON 14
 ud_5                -1.532667e-01 1 1  ON 15
 ud_6                -1.547893e-01 1 1  ON 16
 ud_7                -1.100295e-01 1 1  ON 17
 ud_8                 2.037009e-03 1 1  ON 18
 ud_9                 9.265315e-02 1 1  ON 19
 eO_0                -7.610676e-01 1 1  ON 20
 eO_1                -4.431568e-01 1 1  ON 21
 eO_2                -3.934112e-02 1 1  ON 22
 eO_3                 2.105245e-01 1 1  ON 23
 eO_4                 2.977593e-01 1 1  ON 24
 eO_5                 3.103270e-01 1 1  ON 25
 eO_6                 2.524877e-01 1 1  ON 26
 eO_7                 1.148209e-01 1 1  ON 27
 eO_8                 2.818483e-02 1 1  ON 28
 eO_9                 1.861201e-02 1 1  ON 29
eH1_0                -1.823835e-01 1 1  ON 30
eH1_1                -1.035292e-01 1 1  ON 31
eH1_2                -6.262771e-02 1 1  ON 32
eH1_3                -2.590147e-02 1 1  ON 33
eH1_4                 1.956443e-02 1 1  ON 34
eH1_5                 3.534324e-02 1 1  ON 35
eH1_6                 7.786660e-02 1 1  ON 36
eH1_7                 1.094517e-01 1 1  ON 37
eH1_8                 9.201460e-02 1 1  ON 38
eH1_9                 2.467791e-02 1 1  ON 39
eH2_0                -1.834063e-01 1 1  ON 40
eH2_1                -1.045553e-01 1 1  ON 41
eH2_2                -6.356679e-02 1 1  ON 42
eH2_3                -2.690119e-02 1 1  ON 43
eH2_4                 1.858933e-02 1 1  ON 44
eH2_5                 3.375473e-02 1 1  ON 45
eH2_6                 7.889308e-02 1 1  ON 46
eH2_7                 1.130735e-01 1 1  ON 47
eH2_8                 9.495487e-02 1 1  ON 48
eH2_9                 2.684365e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.266
    reference variance = 0.254551
====================================================
  Execution time = 1.9671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1240e-01
  Total weights = 2.0000e+06
  Execution time = 1.8204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312279925745
                                         uncertainty =       0.002847336251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312279925745
                                         uncertainty =       0.002847336251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395139042
  error estimate for blocks of size 2^( 2) =       0.000404556753
  error estimate for blocks of size 2^( 3) =       0.000413448501
  error estimate for blocks of size 2^( 4) =       0.000420644844
  error estimate for blocks of size 2^( 5) =       0.000424379230
  error estimate for blocks of size 2^( 6) =       0.000426200814
  error estimate for blocks of size 2^( 7) =       0.000427484659

      target function =                  N/A
              le_mean =     -17.216994684425
             les_mean =     296.737175532322
             stat err =       0.000424677387
             autocorr =       1.155096817312
              std dev =       0.558810992136
             le_variance =       0.312269724932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312815186648
                                         uncertainty =       0.002850872701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312815186648
                                         uncertainty =       0.002850872701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395477422
  error estimate for blocks of size 2^( 2) =       0.000404874345
  error estimate for blocks of size 2^( 3) =       0.000413731785
  error estimate for blocks of size 2^( 4) =       0.000420905630
  error estimate for blocks of size 2^( 5) =       0.000424619742
  error estimate for blocks of size 2^( 6) =       0.000426415204
  error estimate for blocks of size 2^( 7) =       0.000427680415

      target function =                  N/A
              le_mean =     -17.216993890130
             les_mean =     296.737683238753
             stat err =       0.000424905248
             autocorr =       1.154358754861
              std dev =       0.559289533604
             le_variance =       0.312804782399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312537099062
                                         uncertainty =       0.002848480580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312537099062
                                         uncertainty =       0.002848480580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395301692
  error estimate for blocks of size 2^( 2) =       0.000404709579
  error estimate for blocks of size 2^( 3) =       0.000413581214
  error estimate for blocks of size 2^( 4) =       0.000420765029
  error estimate for blocks of size 2^( 5) =       0.000424483795
  error estimate for blocks of size 2^( 6) =       0.000426285834
  error estimate for blocks of size 2^( 7) =       0.000427557362

      target function =                  N/A
              le_mean =     -17.216993366304
             les_mean =     296.737387274247
             stat err =       0.000424773005
             autocorr =       1.154666249276
              std dev =       0.559041013847
             le_variance =       0.312526855163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312293855759
                                         uncertainty =       0.002847236078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312293855759
                                         uncertainty =       0.002847236078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395147859
  error estimate for blocks of size 2^( 2) =       0.000404564872
  error estimate for blocks of size 2^( 3) =       0.000413454261
  error estimate for blocks of size 2^( 4) =       0.000420649255
  error estimate for blocks of size 2^( 5) =       0.000424380904
  error estimate for blocks of size 2^( 6) =       0.000426199510
  error estimate for blocks of size 2^( 7) =       0.000427481645

      target function =                  N/A
              le_mean =     -17.216994185760
             les_mean =     296.737172296698
             stat err =       0.000424677828
             autocorr =       1.155047675389
              std dev =       0.558823460796
             le_variance =       0.312283660336


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216994684425        initial  <--
     9.7656e-02     9.7656e-01             5.0816e-03       -17.216993890130
     3.9062e-01     3.9062e+00             1.5688e-03       -17.216993366304
     1.5625e+00     1.5625e+01             4.3006e-04       -17.216994185760

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8824
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.092143e-01 1 1  ON 0
 uu_1                 4.761099e-02 1 1  ON 1
 uu_2                -4.617824e-02 1 1  ON 2
 uu_3                -1.001530e-01 1 1  ON 3
 uu_4                -1.323121e-01 1 1  ON 4
 uu_5                -1.378866e-01 1 1  ON 5
 uu_6                -1.138832e-01 1 1  ON 6
 uu_7                -4.025174e-02 1 1  ON 7
 uu_8                 9.812820e-02 1 1  ON 8
 uu_9                 1.216078e-01 1 1  ON 9
 ud_0                 3.503452e-01 1 1  ON 10
 ud_1                 9.236482e-02 1 1  ON 11
 ud_2                -1.611056e-02 1 1  ON 12
 ud_3                -7.565741e-02 1 1  ON 13
 ud_4                -1.220616e-01 1 1  ON 14
 ud_5                -1.530446e-01 1 1  ON 15
 ud_6                -1.546795e-01 1 1  ON 16
 ud_7                -1.100030e-01 1 1  ON 17
 ud_8                 2.258305e-03 1 1  ON 18
 ud_9                 9.256109e-02 1 1  ON 19
 eO_0                -7.594987e-01 1 1  ON 20
 eO_1                -4.421841e-01 1 1  ON 21
 eO_2                -3.900567e-02 1 1  ON 22
 eO_3                 2.099401e-01 1 1  ON 23
 eO_4                 2.965740e-01 1 1  ON 24
 eO_5                 3.099037e-01 1 1  ON 25
 eO_6                 2.522971e-01 1 1  ON 26
 eO_7                 1.145005e-01 1 1  ON 27
 eO_8                 2.812192e-02 1 1  ON 28
 eO_9                 1.855258e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032364e-01 1 1  ON 31
eH1_2                -6.262216e-02 1 1  ON 32
eH1_3                -2.603763e-02 1 1  ON 33
eH1_4                 1.963374e-02 1 1  ON 34
eH1_5                 3.545168e-02 1 1  ON 35
eH1_6                 7.779843e-02 1 1  ON 36
eH1_7                 1.094646e-01 1 1  ON 37
eH1_8                 9.181893e-02 1 1  ON 38
eH1_9                 2.460171e-02 1 1  ON 39
eH2_0                -1.831663e-01 1 1  ON 40
eH2_1                -1.045115e-01 1 1  ON 41
eH2_2                -6.371543e-02 1 1  ON 42
eH2_3                -2.701404e-02 1 1  ON 43
eH2_4                 1.858171e-02 1 1  ON 44
eH2_5                 3.401059e-02 1 1  ON 45
eH2_6                 7.895049e-02 1 1  ON 46
eH2_7                 1.130485e-01 1 1  ON 47
eH2_8                 9.478236e-02 1 1  ON 48
eH2_9                 2.677329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2339
    reference variance = 0.191692
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3205e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331854133990
                                         uncertainty =       0.016540731141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331854133990
                                         uncertainty =       0.016540731141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407461094
  error estimate for blocks of size 2^( 2) =       0.000417056683
  error estimate for blocks of size 2^( 3) =       0.000425851964
  error estimate for blocks of size 2^( 4) =       0.000432555829
  error estimate for blocks of size 2^( 5) =       0.000437585242
  error estimate for blocks of size 2^( 6) =       0.000438755935
  error estimate for blocks of size 2^( 7) =       0.000440094565

      target function =                  N/A
              le_mean =     -17.215739988108
             les_mean =     296.713752258038
             stat err =       0.000437247893
             autocorr =       1.151550948752
              std dev =       0.576237004986
             le_variance =       0.332049085915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721573998811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215739988108       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215740622248       residual = 6.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215740907849       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215741043960       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215741781000       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215742004221       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215741843374       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215741781668       residual = 8.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 5.410503e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215739988108       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215740180814       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215740266517       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215740306231       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215740498416       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215740518740       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215740514315       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215740477729       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.382302e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215739988108       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215740039029       residual = 7.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215740061654       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215740072242       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215740120839       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215740122914       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215740124375       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215740115263       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.524860e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.043363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5912e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.092635e-01 1 1  ON 0
 uu_1                 4.762358e-02 1 1  ON 1
 uu_2                -4.619075e-02 1 1  ON 2
 uu_3                -1.001472e-01 1 1  ON 3
 uu_4                -1.323614e-01 1 1  ON 4
 uu_5                -1.378914e-01 1 1  ON 5
 uu_6                -1.139067e-01 1 1  ON 6
 uu_7                -4.027980e-02 1 1  ON 7
 uu_8                 9.811540e-02 1 1  ON 8
 uu_9                 1.216311e-01 1 1  ON 9
 ud_0                 3.503691e-01 1 1  ON 10
 ud_1                 9.238698e-02 1 1  ON 11
 ud_2                -1.610886e-02 1 1  ON 12
 ud_3                -7.567836e-02 1 1  ON 13
 ud_4                -1.221027e-01 1 1  ON 14
 ud_5                -1.530596e-01 1 1  ON 15
 ud_6                -1.546753e-01 1 1  ON 16
 ud_7                -1.100003e-01 1 1  ON 17
 ud_8                 2.236736e-03 1 1  ON 18
 ud_9                 9.256956e-02 1 1  ON 19
 eO_0                -7.596325e-01 1 1  ON 20
 eO_1                -4.423223e-01 1 1  ON 21
 eO_2                -3.904339e-02 1 1  ON 22
 eO_3                 2.099978e-01 1 1  ON 23
 eO_4                 2.967023e-01 1 1  ON 24
 eO_5                 3.099497e-01 1 1  ON 25
 eO_6                 2.523199e-01 1 1  ON 26
 eO_7                 1.145352e-01 1 1  ON 27
 eO_8                 2.812995e-02 1 1  ON 28
 eO_9                 1.855780e-02 1 1  ON 29
eH1_0                -1.823670e-01 1 1  ON 30
eH1_1                -1.032456e-01 1 1  ON 31
eH1_2                -6.260830e-02 1 1  ON 32
eH1_3                -2.603148e-02 1 1  ON 33
eH1_4                 1.961562e-02 1 1  ON 34
eH1_5                 3.542549e-02 1 1  ON 35
eH1_6                 7.780282e-02 1 1  ON 36
eH1_7                 1.094669e-01 1 1  ON 37
eH1_8                 9.183867e-02 1 1  ON 38
eH1_9                 2.460947e-02 1 1  ON 39
eH2_0                -1.831935e-01 1 1  ON 40
eH2_1                -1.044950e-01 1 1  ON 41
eH2_2                -6.371166e-02 1 1  ON 42
eH2_3                -2.703221e-02 1 1  ON 43
eH2_4                 1.857246e-02 1 1  ON 44
eH2_5                 3.401474e-02 1 1  ON 45
eH2_6                 7.895022e-02 1 1  ON 46
eH2_7                 1.130398e-01 1 1  ON 47
eH2_8                 9.480423e-02 1 1  ON 48
eH2_9                 2.678316e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.55516
====================================================
  Execution time = 1.9779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3480e-01
  Total weights = 2.0000e+06
  Execution time = 1.8337e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334771819597
                                         uncertainty =       0.014755072152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334771819597
                                         uncertainty =       0.014755072152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409133492
  error estimate for blocks of size 2^( 2) =       0.000419018352
  error estimate for blocks of size 2^( 3) =       0.000428070236
  error estimate for blocks of size 2^( 4) =       0.000434606832
  error estimate for blocks of size 2^( 5) =       0.000438482891
  error estimate for blocks of size 2^( 6) =       0.000440355099
  error estimate for blocks of size 2^( 7) =       0.000440546703

      target function =                  N/A
              le_mean =     -17.216893651559
             les_mean =     296.756207270380
             stat err =       0.000438497881
             autocorr =       1.148695535870
              std dev =       0.578602133313
             le_variance =       0.334780428674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334849083990
                                         uncertainty =       0.014742821966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334849083990
                                         uncertainty =       0.014742821966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409180718
  error estimate for blocks of size 2^( 2) =       0.000419064402
  error estimate for blocks of size 2^( 3) =       0.000428113763
  error estimate for blocks of size 2^( 4) =       0.000434647707
  error estimate for blocks of size 2^( 5) =       0.000438519999
  error estimate for blocks of size 2^( 6) =       0.000440389852
  error estimate for blocks of size 2^( 7) =       0.000440577472

      target function =                  N/A
              le_mean =     -17.216892311364
             les_mean =     296.756238414175
             stat err =       0.000438533757
             autocorr =       1.148618320768
              std dev =       0.578668921309
             le_variance =       0.334857720488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334810841261
                                         uncertainty =       0.014746269390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334810841261
                                         uncertainty =       0.014746269390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409157346
  error estimate for blocks of size 2^( 2) =       0.000419041715
  error estimate for blocks of size 2^( 3) =       0.000428092398
  error estimate for blocks of size 2^( 4) =       0.000434627660
  error estimate for blocks of size 2^( 5) =       0.000438501632
  error estimate for blocks of size 2^( 6) =       0.000440372317
  error estimate for blocks of size 2^( 7) =       0.000440561357

      target function =                  N/A
              le_mean =     -17.216892812904
             les_mean =     296.756217431181
             stat err =       0.000438515741
             autocorr =       1.148655165403
              std dev =       0.578635867849
             le_variance =       0.334819467561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334776695341
                                         uncertainty =       0.014753868727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334776695341
                                         uncertainty =       0.014753868727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409136473
  error estimate for blocks of size 2^( 2) =       0.000419021276
  error estimate for blocks of size 2^( 3) =       0.000428073017
  error estimate for blocks of size 2^( 4) =       0.000434609445
  error estimate for blocks of size 2^( 5) =       0.000438485233
  error estimate for blocks of size 2^( 6) =       0.000440357239
  error estimate for blocks of size 2^( 7) =       0.000440548490

      target function =                  N/A
              le_mean =     -17.216893534535
             les_mean =     296.756208118852
             stat err =       0.000438500102
             autocorr =       1.148690432210
              std dev =       0.578606348681
             le_variance =       0.334785306734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216893651559        initial  <--
     9.7656e-01     9.7656e+00             5.4105e-04       -17.216892311364
     3.9062e+00     3.9062e+01             1.3823e-04       -17.216892812904
     1.5625e+01     1.5625e+02             3.5249e-05       -17.216893534535

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0692
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.092143e-01 1 1  ON 0
 uu_1                 4.761099e-02 1 1  ON 1
 uu_2                -4.617824e-02 1 1  ON 2
 uu_3                -1.001530e-01 1 1  ON 3
 uu_4                -1.323121e-01 1 1  ON 4
 uu_5                -1.378866e-01 1 1  ON 5
 uu_6                -1.138832e-01 1 1  ON 6
 uu_7                -4.025174e-02 1 1  ON 7
 uu_8                 9.812820e-02 1 1  ON 8
 uu_9                 1.216078e-01 1 1  ON 9
 ud_0                 3.503452e-01 1 1  ON 10
 ud_1                 9.236482e-02 1 1  ON 11
 ud_2                -1.611056e-02 1 1  ON 12
 ud_3                -7.565741e-02 1 1  ON 13
 ud_4                -1.220616e-01 1 1  ON 14
 ud_5                -1.530446e-01 1 1  ON 15
 ud_6                -1.546795e-01 1 1  ON 16
 ud_7                -1.100030e-01 1 1  ON 17
 ud_8                 2.258305e-03 1 1  ON 18
 ud_9                 9.256109e-02 1 1  ON 19
 eO_0                -7.594987e-01 1 1  ON 20
 eO_1                -4.421841e-01 1 1  ON 21
 eO_2                -3.900567e-02 1 1  ON 22
 eO_3                 2.099401e-01 1 1  ON 23
 eO_4                 2.965740e-01 1 1  ON 24
 eO_5                 3.099037e-01 1 1  ON 25
 eO_6                 2.522971e-01 1 1  ON 26
 eO_7                 1.145005e-01 1 1  ON 27
 eO_8                 2.812192e-02 1 1  ON 28
 eO_9                 1.855258e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032364e-01 1 1  ON 31
eH1_2                -6.262216e-02 1 1  ON 32
eH1_3                -2.603763e-02 1 1  ON 33
eH1_4                 1.963374e-02 1 1  ON 34
eH1_5                 3.545168e-02 1 1  ON 35
eH1_6                 7.779843e-02 1 1  ON 36
eH1_7                 1.094646e-01 1 1  ON 37
eH1_8                 9.181893e-02 1 1  ON 38
eH1_9                 2.460171e-02 1 1  ON 39
eH2_0                -1.831663e-01 1 1  ON 40
eH2_1                -1.045115e-01 1 1  ON 41
eH2_2                -6.371543e-02 1 1  ON 42
eH2_3                -2.701404e-02 1 1  ON 43
eH2_4                 1.858171e-02 1 1  ON 44
eH2_5                 3.401059e-02 1 1  ON 45
eH2_6                 7.895049e-02 1 1  ON 46
eH2_7                 1.130485e-01 1 1  ON 47
eH2_8                 9.478236e-02 1 1  ON 48
eH2_9                 2.677329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4987e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.209
    reference variance = 0.27322
====================================================
  Execution time = 2.0346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1463e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314711042888
                                         uncertainty =       0.003873610829

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314711042888
                                         uncertainty =       0.003873610829

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396627993
  error estimate for blocks of size 2^( 2) =       0.000406342378
  error estimate for blocks of size 2^( 3) =       0.000415183657
  error estimate for blocks of size 2^( 4) =       0.000422044525
  error estimate for blocks of size 2^( 5) =       0.000425410988
  error estimate for blocks of size 2^( 6) =       0.000429400285
  error estimate for blocks of size 2^( 7) =       0.000429459082

      target function =                  N/A
              le_mean =     -17.216011125381
             les_mean =     296.705666441959
             stat err =       0.000426578720
             autocorr =       1.156729065357
              std dev =       0.560916687235
             le_variance =       0.314627530018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721601112538e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216011125381       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216011130450       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216011255016       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216011346732       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216011325706       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216011303730       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216011313316       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 5.317275e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216011125381       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216011126665       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216011157856       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216011180953       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216011176064       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216011170240       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216011172698       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.331613e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216011125381       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216011125703       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216011133504       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216011139287       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216011138091       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216011136615       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216011137232       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.330494e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045653 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5872e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.092183e-01 1 1  ON 0
 uu_1                 4.761329e-02 1 1  ON 1
 uu_2                -4.617717e-02 1 1  ON 2
 uu_3                -1.001519e-01 1 1  ON 3
 uu_4                -1.323134e-01 1 1  ON 4
 uu_5                -1.378889e-01 1 1  ON 5
 uu_6                -1.138867e-01 1 1  ON 6
 uu_7                -4.025468e-02 1 1  ON 7
 uu_8                 9.812646e-02 1 1  ON 8
 uu_9                 1.216093e-01 1 1  ON 9
 ud_0                 3.503515e-01 1 1  ON 10
 ud_1                 9.236595e-02 1 1  ON 11
 ud_2                -1.610803e-02 1 1  ON 12
 ud_3                -7.565939e-02 1 1  ON 13
 ud_4                -1.220640e-01 1 1  ON 14
 ud_5                -1.530469e-01 1 1  ON 15
 ud_6                -1.546808e-01 1 1  ON 16
 ud_7                -1.100050e-01 1 1  ON 17
 ud_8                 2.255788e-03 1 1  ON 18
 ud_9                 9.256153e-02 1 1  ON 19
 eO_0                -7.595119e-01 1 1  ON 20
 eO_1                -4.421933e-01 1 1  ON 21
 eO_2                -3.901169e-02 1 1  ON 22
 eO_3                 2.099441e-01 1 1  ON 23
 eO_4                 2.965873e-01 1 1  ON 24
 eO_5                 3.099087e-01 1 1  ON 25
 eO_6                 2.522992e-01 1 1  ON 26
 eO_7                 1.145033e-01 1 1  ON 27
 eO_8                 2.812243e-02 1 1  ON 28
 eO_9                 1.855289e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032368e-01 1 1  ON 31
eH1_2                -6.262248e-02 1 1  ON 32
eH1_3                -2.603907e-02 1 1  ON 33
eH1_4                 1.963359e-02 1 1  ON 34
eH1_5                 3.545023e-02 1 1  ON 35
eH1_6                 7.779949e-02 1 1  ON 36
eH1_7                 1.094647e-01 1 1  ON 37
eH1_8                 9.182072e-02 1 1  ON 38
eH1_9                 2.460243e-02 1 1  ON 39
eH2_0                -1.831688e-01 1 1  ON 40
eH2_1                -1.045108e-01 1 1  ON 41
eH2_2                -6.371581e-02 1 1  ON 42
eH2_3                -2.701416e-02 1 1  ON 43
eH2_4                 1.858265e-02 1 1  ON 44
eH2_5                 3.400957e-02 1 1  ON 45
eH2_6                 7.895067e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478389e-02 1 1  ON 48
eH2_9                 2.677376e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1864
    reference variance = 0.270023
====================================================
  Execution time = 1.9771e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1357e-01
  Total weights = 2.0000e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313394799526
                                         uncertainty =       0.003130445034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313394799526
                                         uncertainty =       0.003130445034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395955441
  error estimate for blocks of size 2^( 2) =       0.000405703980
  error estimate for blocks of size 2^( 3) =       0.000414486354
  error estimate for blocks of size 2^( 4) =       0.000419993261
  error estimate for blocks of size 2^( 5) =       0.000424878177
  error estimate for blocks of size 2^( 6) =       0.000427218039
  error estimate for blocks of size 2^( 7) =       0.000428147105

      target function =                  N/A
              le_mean =     -17.216955890172
             les_mean =     296.737131389864
             stat err =       0.000425059146
             autocorr =       1.152407562452
              std dev =       0.559965554744
             le_variance =       0.313561422499

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313412165350
                                         uncertainty =       0.003130582113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313412165350
                                         uncertainty =       0.003130582113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395966408
  error estimate for blocks of size 2^( 2) =       0.000405714440
  error estimate for blocks of size 2^( 3) =       0.000414496272
  error estimate for blocks of size 2^( 4) =       0.000420002773
  error estimate for blocks of size 2^( 5) =       0.000424887115
  error estimate for blocks of size 2^( 6) =       0.000427226913
  error estimate for blocks of size 2^( 7) =       0.000428156070

      target function =                  N/A
              le_mean =     -17.216955702597
             les_mean =     296.737142301666
             stat err =       0.000425068218
             autocorr =       1.152392915071
              std dev =       0.559981065091
             le_variance =       0.313578793260

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313403633037
                                         uncertainty =       0.003130513460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313403633037
                                         uncertainty =       0.003130513460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395961020
  error estimate for blocks of size 2^( 2) =       0.000405709303
  error estimate for blocks of size 2^( 3) =       0.000414491403
  error estimate for blocks of size 2^( 4) =       0.000419998106
  error estimate for blocks of size 2^( 5) =       0.000424882729
  error estimate for blocks of size 2^( 6) =       0.000427222560
  error estimate for blocks of size 2^( 7) =       0.000428151678

      target function =                  N/A
              le_mean =     -17.216955794005
             les_mean =     296.737136914460
             stat err =       0.000425063768
             autocorr =       1.152400153069
              std dev =       0.559973444482
             le_variance =       0.313570258525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313395908322
                                         uncertainty =       0.003130453582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313395908322
                                         uncertainty =       0.003130453582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395956141
  error estimate for blocks of size 2^( 2) =       0.000405704648
  error estimate for blocks of size 2^( 3) =       0.000414486988
  error estimate for blocks of size 2^( 4) =       0.000419993870
  error estimate for blocks of size 2^( 5) =       0.000424878749
  error estimate for blocks of size 2^( 6) =       0.000427218607
  error estimate for blocks of size 2^( 7) =       0.000428147679

      target function =                  N/A
              le_mean =     -17.216955878054
             les_mean =     296.737132081689
             stat err =       0.000425059726
             autocorr =       1.152406633489
              std dev =       0.559966545082
             le_variance =       0.313562531611


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216955890172        initial  <--
     9.7656e+00     9.7656e+01             5.3173e-05       -17.216955702597
     3.9062e+01     3.9062e+02             1.3316e-05       -17.216955794005
     1.5625e+02     1.5625e+03             3.3305e-06       -17.216955878054

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0136
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.092143e-01 1 1  ON 0
 uu_1                 4.761099e-02 1 1  ON 1
 uu_2                -4.617824e-02 1 1  ON 2
 uu_3                -1.001530e-01 1 1  ON 3
 uu_4                -1.323121e-01 1 1  ON 4
 uu_5                -1.378866e-01 1 1  ON 5
 uu_6                -1.138832e-01 1 1  ON 6
 uu_7                -4.025174e-02 1 1  ON 7
 uu_8                 9.812820e-02 1 1  ON 8
 uu_9                 1.216078e-01 1 1  ON 9
 ud_0                 3.503452e-01 1 1  ON 10
 ud_1                 9.236482e-02 1 1  ON 11
 ud_2                -1.611056e-02 1 1  ON 12
 ud_3                -7.565741e-02 1 1  ON 13
 ud_4                -1.220616e-01 1 1  ON 14
 ud_5                -1.530446e-01 1 1  ON 15
 ud_6                -1.546795e-01 1 1  ON 16
 ud_7                -1.100030e-01 1 1  ON 17
 ud_8                 2.258305e-03 1 1  ON 18
 ud_9                 9.256109e-02 1 1  ON 19
 eO_0                -7.594987e-01 1 1  ON 20
 eO_1                -4.421841e-01 1 1  ON 21
 eO_2                -3.900567e-02 1 1  ON 22
 eO_3                 2.099401e-01 1 1  ON 23
 eO_4                 2.965740e-01 1 1  ON 24
 eO_5                 3.099037e-01 1 1  ON 25
 eO_6                 2.522971e-01 1 1  ON 26
 eO_7                 1.145005e-01 1 1  ON 27
 eO_8                 2.812192e-02 1 1  ON 28
 eO_9                 1.855258e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032364e-01 1 1  ON 31
eH1_2                -6.262216e-02 1 1  ON 32
eH1_3                -2.603763e-02 1 1  ON 33
eH1_4                 1.963374e-02 1 1  ON 34
eH1_5                 3.545168e-02 1 1  ON 35
eH1_6                 7.779843e-02 1 1  ON 36
eH1_7                 1.094646e-01 1 1  ON 37
eH1_8                 9.181893e-02 1 1  ON 38
eH1_9                 2.460171e-02 1 1  ON 39
eH2_0                -1.831663e-01 1 1  ON 40
eH2_1                -1.045115e-01 1 1  ON 41
eH2_2                -6.371543e-02 1 1  ON 42
eH2_3                -2.701404e-02 1 1  ON 43
eH2_4                 1.858171e-02 1 1  ON 44
eH2_5                 3.401059e-02 1 1  ON 45
eH2_6                 7.895049e-02 1 1  ON 46
eH2_7                 1.130485e-01 1 1  ON 47
eH2_8                 9.478236e-02 1 1  ON 48
eH2_9                 2.677329e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.15579
====================================================
  Execution time = 2.0453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1978e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319840220200
                                         uncertainty =       0.005814584038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319840220200
                                         uncertainty =       0.005814584038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399864686
  error estimate for blocks of size 2^( 2) =       0.000409452036
  error estimate for blocks of size 2^( 3) =       0.000417882898
  error estimate for blocks of size 2^( 4) =       0.000423818331
  error estimate for blocks of size 2^( 5) =       0.000428412284
  error estimate for blocks of size 2^( 6) =       0.000428995420
  error estimate for blocks of size 2^( 7) =       0.000429239393

      target function =                  N/A
              le_mean =     -17.216889543571
             les_mean =     296.741068929256
             stat err =       0.000427616357
             autocorr =       1.143622041392
              std dev =       0.565494061533
             le_variance =       0.319783533629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688954357e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216889543571       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216889542648       residual = 8.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216889545743       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216889549303       residual = 9.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216889552951       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216889554961       residual = 4.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216889554828       residual = 9.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 5.747935e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216889543571       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216889543340       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216889544114       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216889545000       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216889545912       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216889546416       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216889546384       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.437295e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216889543571       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216889543513       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216889543706       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216889543928       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216889544156       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216889544281       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216889544273       residual = 9.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.593431e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.047937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6054e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.092147e-01 1 1  ON 0
 uu_1                 4.761103e-02 1 1  ON 1
 uu_2                -4.617819e-02 1 1  ON 2
 uu_3                -1.001528e-01 1 1  ON 3
 uu_4                -1.323122e-01 1 1  ON 4
 uu_5                -1.378866e-01 1 1  ON 5
 uu_6                -1.138834e-01 1 1  ON 6
 uu_7                -4.025208e-02 1 1  ON 7
 uu_8                 9.812799e-02 1 1  ON 8
 uu_9                 1.216080e-01 1 1  ON 9
 ud_0                 3.503453e-01 1 1  ON 10
 ud_1                 9.236514e-02 1 1  ON 11
 ud_2                -1.611037e-02 1 1  ON 12
 ud_3                -7.565755e-02 1 1  ON 13
 ud_4                -1.220619e-01 1 1  ON 14
 ud_5                -1.530448e-01 1 1  ON 15
 ud_6                -1.546795e-01 1 1  ON 16
 ud_7                -1.100030e-01 1 1  ON 17
 ud_8                 2.258116e-03 1 1  ON 18
 ud_9                 9.256108e-02 1 1  ON 19
 eO_0                -7.595002e-01 1 1  ON 20
 eO_1                -4.421851e-01 1 1  ON 21
 eO_2                -3.900618e-02 1 1  ON 22
 eO_3                 2.099407e-01 1 1  ON 23
 eO_4                 2.965753e-01 1 1  ON 24
 eO_5                 3.099041e-01 1 1  ON 25
 eO_6                 2.522974e-01 1 1  ON 26
 eO_7                 1.145008e-01 1 1  ON 27
 eO_8                 2.812196e-02 1 1  ON 28
 eO_9                 1.855260e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032367e-01 1 1  ON 31
eH1_2                -6.262201e-02 1 1  ON 32
eH1_3                -2.603776e-02 1 1  ON 33
eH1_4                 1.963357e-02 1 1  ON 34
eH1_5                 3.545157e-02 1 1  ON 35
eH1_6                 7.779864e-02 1 1  ON 36
eH1_7                 1.094647e-01 1 1  ON 37
eH1_8                 9.181913e-02 1 1  ON 38
eH1_9                 2.460175e-02 1 1  ON 39
eH2_0                -1.831663e-01 1 1  ON 40
eH2_1                -1.045113e-01 1 1  ON 41
eH2_2                -6.371533e-02 1 1  ON 42
eH2_3                -2.701395e-02 1 1  ON 43
eH2_4                 1.858144e-02 1 1  ON 44
eH2_5                 3.401026e-02 1 1  ON 45
eH2_6                 7.895052e-02 1 1  ON 46
eH2_7                 1.130485e-01 1 1  ON 47
eH2_8                 9.478251e-02 1 1  ON 48
eH2_9                 2.677335e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2905
    reference variance = 0.28417
====================================================
  Execution time = 1.9823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1845e-01
  Total weights = 2.0000e+06
  Execution time = 1.8243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458367114
                                         uncertainty =       0.004304499373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458367114
                                         uncertainty =       0.004304499373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399033264
  error estimate for blocks of size 2^( 2) =       0.000408945438
  error estimate for blocks of size 2^( 3) =       0.000417317674
  error estimate for blocks of size 2^( 4) =       0.000423884254
  error estimate for blocks of size 2^( 5) =       0.000427262042
  error estimate for blocks of size 2^( 6) =       0.000429186208
  error estimate for blocks of size 2^( 7) =       0.000431456093

      target function =                  N/A
              le_mean =     -17.216665019807
             les_mean =     296.732009336019
             stat err =       0.000427947149
             autocorr =       1.150170104457
              std dev =       0.564318253282
             le_variance =       0.318455090987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458104265
                                         uncertainty =       0.004304511713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458104265
                                         uncertainty =       0.004304511713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399033099
  error estimate for blocks of size 2^( 2) =       0.000408945285
  error estimate for blocks of size 2^( 3) =       0.000417317513
  error estimate for blocks of size 2^( 4) =       0.000423884084
  error estimate for blocks of size 2^( 5) =       0.000427261876
  error estimate for blocks of size 2^( 6) =       0.000429186010
  error estimate for blocks of size 2^( 7) =       0.000431455918

      target function =                  N/A
              le_mean =     -17.216665031419
             les_mean =     296.732009473541
             stat err =       0.000427946972
             autocorr =       1.150170098360
              std dev =       0.564318020862
             le_variance =       0.318454828670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458233831
                                         uncertainty =       0.004304505538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458233831
                                         uncertainty =       0.004304505538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399033180
  error estimate for blocks of size 2^( 2) =       0.000408945360
  error estimate for blocks of size 2^( 3) =       0.000417317592
  error estimate for blocks of size 2^( 4) =       0.000423884168
  error estimate for blocks of size 2^( 5) =       0.000427261958
  error estimate for blocks of size 2^( 6) =       0.000429186108
  error estimate for blocks of size 2^( 7) =       0.000431456005

      target function =                  N/A
              le_mean =     -17.216665025624
             les_mean =     296.732009403300
             stat err =       0.000427947060
             autocorr =       1.150170102682
              std dev =       0.564318135425
             le_variance =       0.318454957970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458350393
                                         uncertainty =       0.004304500143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318458350393
                                         uncertainty =       0.004304500143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399033253
  error estimate for blocks of size 2^( 2) =       0.000408945428
  error estimate for blocks of size 2^( 3) =       0.000417317663
  error estimate for blocks of size 2^( 4) =       0.000423884243
  error estimate for blocks of size 2^( 5) =       0.000427262032
  error estimate for blocks of size 2^( 6) =       0.000429186195
  error estimate for blocks of size 2^( 7) =       0.000431456082

      target function =                  N/A
              le_mean =     -17.216665020535
             les_mean =     296.732009344374
             stat err =       0.000427947138
             autocorr =       1.150170104270
              std dev =       0.564318238496
             le_variance =       0.318455074300


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216665019807        initial
     9.7656e+01     9.7656e+02             5.7479e-06       -17.216665031419  <--
     3.9062e+02     3.9062e+03             1.4373e-06       -17.216665025624
     1.5625e+03     1.5625e+04             3.5934e-07       -17.216665020535

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.9058e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.092158e-01 1 1  ON 0
 uu_1                 4.761117e-02 1 1  ON 1
 uu_2                -4.617803e-02 1 1  ON 2
 uu_3                -1.001525e-01 1 1  ON 3
 uu_4                -1.323128e-01 1 1  ON 4
 uu_5                -1.378867e-01 1 1  ON 5
 uu_6                -1.138840e-01 1 1  ON 6
 uu_7                -4.025307e-02 1 1  ON 7
 uu_8                 9.812736e-02 1 1  ON 8
 uu_9                 1.216084e-01 1 1  ON 9
 ud_0                 3.503455e-01 1 1  ON 10
 ud_1                 9.236610e-02 1 1  ON 11
 ud_2                -1.610980e-02 1 1  ON 12
 ud_3                -7.565795e-02 1 1  ON 13
 ud_4                -1.220627e-01 1 1  ON 14
 ud_5                -1.530452e-01 1 1  ON 15
 ud_6                -1.546796e-01 1 1  ON 16
 ud_7                -1.100030e-01 1 1  ON 17
 ud_8                 2.257550e-03 1 1  ON 18
 ud_9                 9.256106e-02 1 1  ON 19
 eO_0                -7.595045e-01 1 1  ON 20
 eO_1                -4.421881e-01 1 1  ON 21
 eO_2                -3.900770e-02 1 1  ON 22
 eO_3                 2.099426e-01 1 1  ON 23
 eO_4                 2.965791e-01 1 1  ON 24
 eO_5                 3.099054e-01 1 1  ON 25
 eO_6                 2.522981e-01 1 1  ON 26
 eO_7                 1.145017e-01 1 1  ON 27
 eO_8                 2.812207e-02 1 1  ON 28
 eO_9                 1.855267e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032376e-01 1 1  ON 31
eH1_2                -6.262155e-02 1 1  ON 32
eH1_3                -2.603815e-02 1 1  ON 33
eH1_4                 1.963304e-02 1 1  ON 34
eH1_5                 3.545127e-02 1 1  ON 35
eH1_6                 7.779924e-02 1 1  ON 36
eH1_7                 1.094651e-01 1 1  ON 37
eH1_8                 9.181972e-02 1 1  ON 38
eH1_9                 2.460186e-02 1 1  ON 39
eH2_0                -1.831665e-01 1 1  ON 40
eH2_1                -1.045106e-01 1 1  ON 41
eH2_2                -6.371503e-02 1 1  ON 42
eH2_3                -2.701367e-02 1 1  ON 43
eH2_4                 1.858065e-02 1 1  ON 44
eH2_5                 3.400929e-02 1 1  ON 45
eH2_6                 7.895059e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478297e-02 1 1  ON 48
eH2_9                 2.677353e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5119e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1977
    reference variance = 0.290597
====================================================
  Execution time = 2.0095e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1483e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314864409223
                                         uncertainty =       0.003839135388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314864409223
                                         uncertainty =       0.003839135388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396757321
  error estimate for blocks of size 2^( 2) =       0.000406650088
  error estimate for blocks of size 2^( 3) =       0.000415572270
  error estimate for blocks of size 2^( 4) =       0.000421811107
  error estimate for blocks of size 2^( 5) =       0.000426256787
  error estimate for blocks of size 2^( 6) =       0.000428774810
  error estimate for blocks of size 2^( 7) =       0.000428266263

      target function =                  N/A
              le_mean =     -17.216492588291
             les_mean =     296.722449628610
             stat err =       0.000426277242
             autocorr =       1.154341729363
              std dev =       0.561099584167
             le_variance =       0.314832743352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721649258829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492588291       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492599585       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492594103       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216492618600       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216492656982       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216492658636       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216492659578       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216492658030       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 2.312981e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492588291       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492591134       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492589743       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216492595856       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216492605361       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216492605876       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216492606094       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216492605676       residual = 2.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 5.800000e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216492588291       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216492589003       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216492588654       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216492590182       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216492592552       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216492592687       residual = 4.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216492592740       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216492592634       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.451108e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5764e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.092170e-01 1 1  ON 0
 uu_1                 4.761211e-02 1 1  ON 1
 uu_2                -4.617752e-02 1 1  ON 2
 uu_3                -1.001521e-01 1 1  ON 3
 uu_4                -1.323139e-01 1 1  ON 4
 uu_5                -1.378868e-01 1 1  ON 5
 uu_6                -1.138851e-01 1 1  ON 6
 uu_7                -4.025425e-02 1 1  ON 7
 uu_8                 9.812688e-02 1 1  ON 8
 uu_9                 1.216090e-01 1 1  ON 9
 ud_0                 3.503468e-01 1 1  ON 10
 ud_1                 9.236682e-02 1 1  ON 11
 ud_2                -1.610885e-02 1 1  ON 12
 ud_3                -7.565798e-02 1 1  ON 13
 ud_4                -1.220638e-01 1 1  ON 14
 ud_5                -1.530450e-01 1 1  ON 15
 ud_6                -1.546802e-01 1 1  ON 16
 ud_7                -1.100034e-01 1 1  ON 17
 ud_8                 2.256284e-03 1 1  ON 18
 ud_9                 9.256091e-02 1 1  ON 19
 eO_0                -7.595093e-01 1 1  ON 20
 eO_1                -4.421939e-01 1 1  ON 21
 eO_2                -3.900928e-02 1 1  ON 22
 eO_3                 2.099458e-01 1 1  ON 23
 eO_4                 2.965840e-01 1 1  ON 24
 eO_5                 3.099071e-01 1 1  ON 25
 eO_6                 2.522989e-01 1 1  ON 26
 eO_7                 1.145031e-01 1 1  ON 27
 eO_8                 2.812226e-02 1 1  ON 28
 eO_9                 1.855268e-02 1 1  ON 29
eH1_0                -1.823627e-01 1 1  ON 30
eH1_1                -1.032378e-01 1 1  ON 31
eH1_2                -6.262131e-02 1 1  ON 32
eH1_3                -2.603704e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545083e-02 1 1  ON 35
eH1_6                 7.779977e-02 1 1  ON 36
eH1_7                 1.094648e-01 1 1  ON 37
eH1_8                 9.182043e-02 1 1  ON 38
eH1_9                 2.460208e-02 1 1  ON 39
eH2_0                -1.831668e-01 1 1  ON 40
eH2_1                -1.045099e-01 1 1  ON 41
eH2_2                -6.371421e-02 1 1  ON 42
eH2_3                -2.701371e-02 1 1  ON 43
eH2_4                 1.857930e-02 1 1  ON 44
eH2_5                 3.400874e-02 1 1  ON 45
eH2_6                 7.895080e-02 1 1  ON 46
eH2_7                 1.130479e-01 1 1  ON 47
eH2_8                 9.478356e-02 1 1  ON 48
eH2_9                 2.677373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2282
    reference variance = 0.241398
====================================================
  Execution time = 2.0155e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.6022e-01
  Total weights = 2.0000e+06
  Execution time = 1.8231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360365741782
                                         uncertainty =       0.038178055711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360365741782
                                         uncertainty =       0.038178055711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424390808
  error estimate for blocks of size 2^( 2) =       0.000433601737
  error estimate for blocks of size 2^( 3) =       0.000441878832
  error estimate for blocks of size 2^( 4) =       0.000448957947
  error estimate for blocks of size 2^( 5) =       0.000452739674
  error estimate for blocks of size 2^( 6) =       0.000454040362
  error estimate for blocks of size 2^( 7) =       0.000457541517

      target function =                  N/A
              le_mean =     -17.216219872635
             les_mean =     296.758441638082
             stat err =       0.000453319875
             autocorr =       1.140978822086
              std dev =       0.600179235957
             le_variance =       0.360215115274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360366141788
                                         uncertainty =       0.038177186786

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360366141788
                                         uncertainty =       0.038177186786

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424391045
  error estimate for blocks of size 2^( 2) =       0.000433601938
  error estimate for blocks of size 2^( 3) =       0.000441878995
  error estimate for blocks of size 2^( 4) =       0.000448958096
  error estimate for blocks of size 2^( 5) =       0.000452739714
  error estimate for blocks of size 2^( 6) =       0.000454040353
  error estimate for blocks of size 2^( 7) =       0.000457541528

      target function =                  N/A
              le_mean =     -17.216219855984
             les_mean =     296.758441467195
             stat err =       0.000453319923
             autocorr =       1.140977788815
              std dev =       0.600179571239
             le_variance =       0.360215517732

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360365944693
                                         uncertainty =       0.038177622868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360365944693
                                         uncertainty =       0.038177622868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424390928
  error estimate for blocks of size 2^( 2) =       0.000433601839
  error estimate for blocks of size 2^( 3) =       0.000441878916
  error estimate for blocks of size 2^( 4) =       0.000448958024
  error estimate for blocks of size 2^( 5) =       0.000452739696
  error estimate for blocks of size 2^( 6) =       0.000454040359
  error estimate for blocks of size 2^( 7) =       0.000457541523

      target function =                  N/A
              le_mean =     -17.216219864140
             les_mean =     296.758441549718
             stat err =       0.000453319900
             autocorr =       1.140978303854
              std dev =       0.600179406025
             le_variance =       0.360215319416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360365767226
                                         uncertainty =       0.038178001659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360365767226
                                         uncertainty =       0.038178001659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424390823
  error estimate for blocks of size 2^( 2) =       0.000433601750
  error estimate for blocks of size 2^( 3) =       0.000441878843
  error estimate for blocks of size 2^( 4) =       0.000448957957
  error estimate for blocks of size 2^( 5) =       0.000452739677
  error estimate for blocks of size 2^( 6) =       0.000454040361
  error estimate for blocks of size 2^( 7) =       0.000457541517

      target function =                  N/A
              le_mean =     -17.216219871564
             les_mean =     296.758441626797
             stat err =       0.000453319878
             autocorr =       1.140978757234
              std dev =       0.600179257282
             le_variance =       0.360215140872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216219872635        initial  <--
     2.4414e+01     2.4414e+02             2.3130e-05       -17.216219855984
     9.7656e+01     9.7656e+02             5.8000e-06       -17.216219864140
     3.9062e+02     3.9062e+03             1.4511e-06       -17.216219871564

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3943
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.092158e-01 1 1  ON 0
 uu_1                 4.761117e-02 1 1  ON 1
 uu_2                -4.617803e-02 1 1  ON 2
 uu_3                -1.001525e-01 1 1  ON 3
 uu_4                -1.323128e-01 1 1  ON 4
 uu_5                -1.378867e-01 1 1  ON 5
 uu_6                -1.138840e-01 1 1  ON 6
 uu_7                -4.025307e-02 1 1  ON 7
 uu_8                 9.812736e-02 1 1  ON 8
 uu_9                 1.216084e-01 1 1  ON 9
 ud_0                 3.503455e-01 1 1  ON 10
 ud_1                 9.236610e-02 1 1  ON 11
 ud_2                -1.610980e-02 1 1  ON 12
 ud_3                -7.565795e-02 1 1  ON 13
 ud_4                -1.220627e-01 1 1  ON 14
 ud_5                -1.530452e-01 1 1  ON 15
 ud_6                -1.546796e-01 1 1  ON 16
 ud_7                -1.100030e-01 1 1  ON 17
 ud_8                 2.257550e-03 1 1  ON 18
 ud_9                 9.256106e-02 1 1  ON 19
 eO_0                -7.595045e-01 1 1  ON 20
 eO_1                -4.421881e-01 1 1  ON 21
 eO_2                -3.900770e-02 1 1  ON 22
 eO_3                 2.099426e-01 1 1  ON 23
 eO_4                 2.965791e-01 1 1  ON 24
 eO_5                 3.099054e-01 1 1  ON 25
 eO_6                 2.522981e-01 1 1  ON 26
 eO_7                 1.145017e-01 1 1  ON 27
 eO_8                 2.812207e-02 1 1  ON 28
 eO_9                 1.855267e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032376e-01 1 1  ON 31
eH1_2                -6.262155e-02 1 1  ON 32
eH1_3                -2.603815e-02 1 1  ON 33
eH1_4                 1.963304e-02 1 1  ON 34
eH1_5                 3.545127e-02 1 1  ON 35
eH1_6                 7.779924e-02 1 1  ON 36
eH1_7                 1.094651e-01 1 1  ON 37
eH1_8                 9.181972e-02 1 1  ON 38
eH1_9                 2.460186e-02 1 1  ON 39
eH2_0                -1.831665e-01 1 1  ON 40
eH2_1                -1.045106e-01 1 1  ON 41
eH2_2                -6.371503e-02 1 1  ON 42
eH2_3                -2.701367e-02 1 1  ON 43
eH2_4                 1.858065e-02 1 1  ON 44
eH2_5                 3.400929e-02 1 1  ON 45
eH2_6                 7.895059e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478297e-02 1 1  ON 48
eH2_9                 2.677353e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5164e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2357
    reference variance = 0.252531
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2156e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321564341690
                                         uncertainty =       0.003627281166

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321564341690
                                         uncertainty =       0.003627281166

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400975276
  error estimate for blocks of size 2^( 2) =       0.000410781356
  error estimate for blocks of size 2^( 3) =       0.000418953528
  error estimate for blocks of size 2^( 4) =       0.000426557800
  error estimate for blocks of size 2^( 5) =       0.000430809853
  error estimate for blocks of size 2^( 6) =       0.000432026090
  error estimate for blocks of size 2^( 7) =       0.000433394040

      target function =                  N/A
              le_mean =     -17.216214953754
             les_mean =     296.719619516949
             stat err =       0.000430696946
             autocorr =       1.153741180907
              std dev =       0.567064673441
             le_variance =       0.321562343864


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621495375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216214953754       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216214957109       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216214953578       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216214957291       residual = 5.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216214956253       residual = 4.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216214957831       residual = 2.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216214957891       residual = 9.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.203502e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216214953754       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216214954593       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216214953711       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216214954637       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216214954383       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216214954773       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216214954787       residual = 9.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.508898e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216214953754       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216214953964       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216214953743       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216214953974       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216214953911       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216214954008       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216214954013       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.377233e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052953 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5900e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.092159e-01 1 1  ON 0
 uu_1                 4.761127e-02 1 1  ON 1
 uu_2                -4.617792e-02 1 1  ON 2
 uu_3                -1.001525e-01 1 1  ON 3
 uu_4                -1.323128e-01 1 1  ON 4
 uu_5                -1.378867e-01 1 1  ON 5
 uu_6                -1.138842e-01 1 1  ON 6
 uu_7                -4.025324e-02 1 1  ON 7
 uu_8                 9.812730e-02 1 1  ON 8
 uu_9                 1.216085e-01 1 1  ON 9
 ud_0                 3.503457e-01 1 1  ON 10
 ud_1                 9.236613e-02 1 1  ON 11
 ud_2                -1.610975e-02 1 1  ON 12
 ud_3                -7.565807e-02 1 1  ON 13
 ud_4                -1.220628e-01 1 1  ON 14
 ud_5                -1.530452e-01 1 1  ON 15
 ud_6                -1.546795e-01 1 1  ON 16
 ud_7                -1.100031e-01 1 1  ON 17
 ud_8                 2.257425e-03 1 1  ON 18
 ud_9                 9.256106e-02 1 1  ON 19
 eO_0                -7.595050e-01 1 1  ON 20
 eO_1                -4.421886e-01 1 1  ON 21
 eO_2                -3.900784e-02 1 1  ON 22
 eO_3                 2.099429e-01 1 1  ON 23
 eO_4                 2.965795e-01 1 1  ON 24
 eO_5                 3.099055e-01 1 1  ON 25
 eO_6                 2.522982e-01 1 1  ON 26
 eO_7                 1.145019e-01 1 1  ON 27
 eO_8                 2.812209e-02 1 1  ON 28
 eO_9                 1.855267e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032375e-01 1 1  ON 31
eH1_2                -6.262150e-02 1 1  ON 32
eH1_3                -2.603815e-02 1 1  ON 33
eH1_4                 1.963292e-02 1 1  ON 34
eH1_5                 3.545119e-02 1 1  ON 35
eH1_6                 7.779924e-02 1 1  ON 36
eH1_7                 1.094650e-01 1 1  ON 37
eH1_8                 9.181978e-02 1 1  ON 38
eH1_9                 2.460188e-02 1 1  ON 39
eH2_0                -1.831665e-01 1 1  ON 40
eH2_1                -1.045107e-01 1 1  ON 41
eH2_2                -6.371499e-02 1 1  ON 42
eH2_3                -2.701372e-02 1 1  ON 43
eH2_4                 1.858061e-02 1 1  ON 44
eH2_5                 3.400936e-02 1 1  ON 45
eH2_6                 7.895061e-02 1 1  ON 46
eH2_7                 1.130482e-01 1 1  ON 47
eH2_8                 9.478304e-02 1 1  ON 48
eH2_9                 2.677355e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1683
    reference variance = 0.170849
====================================================
  Execution time = 2.1898e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1991e-01
  Total weights = 2.0000e+06
  Execution time = 1.8192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953110890
                                         uncertainty =       0.005160491010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953110890
                                         uncertainty =       0.005160491010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946812
  error estimate for blocks of size 2^( 2) =       0.000409830977
  error estimate for blocks of size 2^( 3) =       0.000418536587
  error estimate for blocks of size 2^( 4) =       0.000424256467
  error estimate for blocks of size 2^( 5) =       0.000427336017
  error estimate for blocks of size 2^( 6) =       0.000429020095
  error estimate for blocks of size 2^( 7) =       0.000431583341

      target function =                  N/A
              le_mean =     -17.216959080833
             les_mean =     296.743594736696
             stat err =       0.000428048980
             autocorr =       1.145466661182
              std dev =       0.565610206386
             le_variance =       0.319914905568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953706314
                                         uncertainty =       0.005160501971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953706314
                                         uncertainty =       0.005160501971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399947185
  error estimate for blocks of size 2^( 2) =       0.000409831331
  error estimate for blocks of size 2^( 3) =       0.000418536919
  error estimate for blocks of size 2^( 4) =       0.000424256785
  error estimate for blocks of size 2^( 5) =       0.000427336324
  error estimate for blocks of size 2^( 6) =       0.000429020397
  error estimate for blocks of size 2^( 7) =       0.000431583646

      target function =                  N/A
              le_mean =     -17.216959083670
             les_mean =     296.743595429816
             stat err =       0.000428049288
             autocorr =       1.145466176967
              std dev =       0.565610732751
             le_variance =       0.319915501003

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953408810
                                         uncertainty =       0.005160496492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953408810
                                         uncertainty =       0.005160496492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946999
  error estimate for blocks of size 2^( 2) =       0.000409831154
  error estimate for blocks of size 2^( 3) =       0.000418536753
  error estimate for blocks of size 2^( 4) =       0.000424256626
  error estimate for blocks of size 2^( 5) =       0.000427336171
  error estimate for blocks of size 2^( 6) =       0.000429020246
  error estimate for blocks of size 2^( 7) =       0.000431583494

      target function =                  N/A
              le_mean =     -17.216959082251
             les_mean =     296.743595083436
             stat err =       0.000428049134
             autocorr =       1.145466418975
              std dev =       0.565610469752
             le_variance =       0.319915203494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953148137
                                         uncertainty =       0.005160491695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319953148137
                                         uncertainty =       0.005160491695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399946836
  error estimate for blocks of size 2^( 2) =       0.000409831000
  error estimate for blocks of size 2^( 3) =       0.000418536608
  error estimate for blocks of size 2^( 4) =       0.000424256487
  error estimate for blocks of size 2^( 5) =       0.000427336037
  error estimate for blocks of size 2^( 6) =       0.000429020114
  error estimate for blocks of size 2^( 7) =       0.000431583360

      target function =                  N/A
              le_mean =     -17.216959081010
             les_mean =     296.743594780043
             stat err =       0.000428048999
             autocorr =       1.145466630903
              std dev =       0.565610239313
             le_variance =       0.319914942815


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216959080833        initial
     2.4414e+02     2.4414e+03             2.2035e-06       -17.216959083670  <--
     9.7656e+02     9.7656e+03             5.5089e-07       -17.216959082251
     3.9062e+03     3.9062e+04             1.3772e-07       -17.216959081010

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 3.1102e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.092162e-01 1 1  ON 0
 uu_1                 4.761158e-02 1 1  ON 1
 uu_2                -4.617761e-02 1 1  ON 2
 uu_3                -1.001523e-01 1 1  ON 3
 uu_4                -1.323131e-01 1 1  ON 4
 uu_5                -1.378868e-01 1 1  ON 5
 uu_6                -1.138846e-01 1 1  ON 6
 uu_7                -4.025373e-02 1 1  ON 7
 uu_8                 9.812712e-02 1 1  ON 8
 uu_9                 1.216087e-01 1 1  ON 9
 ud_0                 3.503464e-01 1 1  ON 10
 ud_1                 9.236621e-02 1 1  ON 11
 ud_2                -1.610958e-02 1 1  ON 12
 ud_3                -7.565842e-02 1 1  ON 13
 ud_4                -1.220631e-01 1 1  ON 14
 ud_5                -1.530453e-01 1 1  ON 15
 ud_6                -1.546793e-01 1 1  ON 16
 ud_7                -1.100033e-01 1 1  ON 17
 ud_8                 2.257050e-03 1 1  ON 18
 ud_9                 9.256106e-02 1 1  ON 19
 eO_0                -7.595067e-01 1 1  ON 20
 eO_1                -4.421898e-01 1 1  ON 21
 eO_2                -3.900825e-02 1 1  ON 22
 eO_3                 2.099437e-01 1 1  ON 23
 eO_4                 2.965809e-01 1 1  ON 24
 eO_5                 3.099060e-01 1 1  ON 25
 eO_6                 2.522984e-01 1 1  ON 26
 eO_7                 1.145022e-01 1 1  ON 27
 eO_8                 2.812216e-02 1 1  ON 28
 eO_9                 1.855269e-02 1 1  ON 29
eH1_0                -1.823616e-01 1 1  ON 30
eH1_1                -1.032374e-01 1 1  ON 31
eH1_2                -6.262134e-02 1 1  ON 32
eH1_3                -2.603815e-02 1 1  ON 33
eH1_4                 1.963255e-02 1 1  ON 34
eH1_5                 3.545095e-02 1 1  ON 35
eH1_6                 7.779924e-02 1 1  ON 36
eH1_7                 1.094650e-01 1 1  ON 37
eH1_8                 9.181998e-02 1 1  ON 38
eH1_9                 2.460193e-02 1 1  ON 39
eH2_0                -1.831667e-01 1 1  ON 40
eH2_1                -1.045108e-01 1 1  ON 41
eH2_2                -6.371487e-02 1 1  ON 42
eH2_3                -2.701387e-02 1 1  ON 43
eH2_4                 1.858049e-02 1 1  ON 44
eH2_5                 3.400956e-02 1 1  ON 45
eH2_6                 7.895066e-02 1 1  ON 46
eH2_7                 1.130482e-01 1 1  ON 47
eH2_8                 9.478323e-02 1 1  ON 48
eH2_9                 2.677363e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7008e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1693
    reference variance = 0.244348
====================================================
  Execution time = 2.0240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2491e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324928602594
                                         uncertainty =       0.006477523809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324928602594
                                         uncertainty =       0.006477523809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403059230
  error estimate for blocks of size 2^( 2) =       0.000412410479
  error estimate for blocks of size 2^( 3) =       0.000421015091
  error estimate for blocks of size 2^( 4) =       0.000427526352
  error estimate for blocks of size 2^( 5) =       0.000431835222
  error estimate for blocks of size 2^( 6) =       0.000433420936
  error estimate for blocks of size 2^( 7) =       0.000432812730

      target function =                  N/A
              le_mean =     -17.217158034505
             les_mean =     296.755444108610
             stat err =       0.000431398810
             autocorr =       1.145566073566
              std dev =       0.570011829668
             le_variance =       0.324913485961


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721715803450e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217158034505       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217158043515       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217158051344       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217158069322       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217158062489       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217158061268       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217158062816       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.070700e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217158034505       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217158036762       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217158038729       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217158043234       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217158041527       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217158041212       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217158041597       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.678606e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217158034505       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217158035069       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217158035562       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217158036688       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217158036263       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217158036183       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217158036279       residual = 5.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 6.697678e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055150 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5786e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.092168e-01 1 1  ON 0
 uu_1                 4.761174e-02 1 1  ON 1
 uu_2                -4.617758e-02 1 1  ON 2
 uu_3                -1.001523e-01 1 1  ON 3
 uu_4                -1.323132e-01 1 1  ON 4
 uu_5                -1.378868e-01 1 1  ON 5
 uu_6                -1.138851e-01 1 1  ON 6
 uu_7                -4.025428e-02 1 1  ON 7
 uu_8                 9.812683e-02 1 1  ON 8
 uu_9                 1.216089e-01 1 1  ON 9
 ud_0                 3.503466e-01 1 1  ON 10
 ud_1                 9.236684e-02 1 1  ON 11
 ud_2                -1.610917e-02 1 1  ON 12
 ud_3                -7.565867e-02 1 1  ON 13
 ud_4                -1.220634e-01 1 1  ON 14
 ud_5                -1.530458e-01 1 1  ON 15
 ud_6                -1.546796e-01 1 1  ON 16
 ud_7                -1.100032e-01 1 1  ON 17
 ud_8                 2.256711e-03 1 1  ON 18
 ud_9                 9.256110e-02 1 1  ON 19
 eO_0                -7.595094e-01 1 1  ON 20
 eO_1                -4.421915e-01 1 1  ON 21
 eO_2                -3.900858e-02 1 1  ON 22
 eO_3                 2.099444e-01 1 1  ON 23
 eO_4                 2.965830e-01 1 1  ON 24
 eO_5                 3.099068e-01 1 1  ON 25
 eO_6                 2.522988e-01 1 1  ON 26
 eO_7                 1.145027e-01 1 1  ON 27
 eO_8                 2.812224e-02 1 1  ON 28
 eO_9                 1.855273e-02 1 1  ON 29
eH1_0                -1.823617e-01 1 1  ON 30
eH1_1                -1.032378e-01 1 1  ON 31
eH1_2                -6.262109e-02 1 1  ON 32
eH1_3                -2.603826e-02 1 1  ON 33
eH1_4                 1.963252e-02 1 1  ON 34
eH1_5                 3.545094e-02 1 1  ON 35
eH1_6                 7.779939e-02 1 1  ON 36
eH1_7                 1.094650e-01 1 1  ON 37
eH1_8                 9.182024e-02 1 1  ON 38
eH1_9                 2.460201e-02 1 1  ON 39
eH2_0                -1.831672e-01 1 1  ON 40
eH2_1                -1.045108e-01 1 1  ON 41
eH2_2                -6.371468e-02 1 1  ON 42
eH2_3                -2.701361e-02 1 1  ON 43
eH2_4                 1.858032e-02 1 1  ON 44
eH2_5                 3.400940e-02 1 1  ON 45
eH2_6                 7.895069e-02 1 1  ON 46
eH2_7                 1.130481e-01 1 1  ON 47
eH2_8                 9.478349e-02 1 1  ON 48
eH2_9                 2.677373e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1902
    reference variance = 0.328074
====================================================
  Execution time = 1.9889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1580e-01
  Total weights = 2.0000e+06
  Execution time = 1.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886620146
                                         uncertainty =       0.003531991381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886620146
                                         uncertainty =       0.003531991381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397366591
  error estimate for blocks of size 2^( 2) =       0.000407459116
  error estimate for blocks of size 2^( 3) =       0.000416320111
  error estimate for blocks of size 2^( 4) =       0.000423039188
  error estimate for blocks of size 2^( 5) =       0.000426776723
  error estimate for blocks of size 2^( 6) =       0.000430567435
  error estimate for blocks of size 2^( 7) =       0.000434579810

      target function =                  N/A
              le_mean =     -17.216777646836
             les_mean =     296.733232797433
             stat err =       0.000428740789
             autocorr =       1.164144537971
              std dev =       0.561961221745
             le_variance =       0.315800414746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886307950
                                         uncertainty =       0.003532015567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886307950
                                         uncertainty =       0.003532015567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397366394
  error estimate for blocks of size 2^( 2) =       0.000407458925
  error estimate for blocks of size 2^( 3) =       0.000416319923
  error estimate for blocks of size 2^( 4) =       0.000423038984
  error estimate for blocks of size 2^( 5) =       0.000426776502
  error estimate for blocks of size 2^( 6) =       0.000430567168
  error estimate for blocks of size 2^( 7) =       0.000434579630

      target function =                  N/A
              le_mean =     -17.216777643189
             les_mean =     296.733232359093
             stat err =       0.000428740571
             autocorr =       1.164144507562
              std dev =       0.561960943480
             le_variance =       0.315800101997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886457520
                                         uncertainty =       0.003532003447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886457520
                                         uncertainty =       0.003532003447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397366488
  error estimate for blocks of size 2^( 2) =       0.000407459016
  error estimate for blocks of size 2^( 3) =       0.000416320013
  error estimate for blocks of size 2^( 4) =       0.000423039082
  error estimate for blocks of size 2^( 5) =       0.000426776609
  error estimate for blocks of size 2^( 6) =       0.000430567298
  error estimate for blocks of size 2^( 7) =       0.000434579717

      target function =                  N/A
              le_mean =     -17.216777645007
             les_mean =     296.733232571563
             stat err =       0.000428740676
             autocorr =       1.164144527798
              std dev =       0.561961076805
             le_variance =       0.315800251844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886599608
                                         uncertainty =       0.003531992888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315886599608
                                         uncertainty =       0.003531992888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397366578
  error estimate for blocks of size 2^( 2) =       0.000407459103
  error estimate for blocks of size 2^( 3) =       0.000416320099
  error estimate for blocks of size 2^( 4) =       0.000423039174
  error estimate for blocks of size 2^( 5) =       0.000426776709
  error estimate for blocks of size 2^( 6) =       0.000430567417
  error estimate for blocks of size 2^( 7) =       0.000434579798

      target function =                  N/A
              le_mean =     -17.216777646607
             les_mean =     296.733232768965
             stat err =       0.000428740775
             autocorr =       1.164144536854
              std dev =       0.561961203441
             le_variance =       0.315800394173


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216777646836        initial  <--
     6.1035e+01     6.1035e+02             1.0707e-05       -17.216777643189
     2.4414e+02     2.4414e+03             2.6786e-06       -17.216777645007
     9.7656e+02     9.7656e+03             6.6977e-07       -17.216777646607

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1369
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.092162e-01 1 1  ON 0
 uu_1                 4.761158e-02 1 1  ON 1
 uu_2                -4.617761e-02 1 1  ON 2
 uu_3                -1.001523e-01 1 1  ON 3
 uu_4                -1.323131e-01 1 1  ON 4
 uu_5                -1.378868e-01 1 1  ON 5
 uu_6                -1.138846e-01 1 1  ON 6
 uu_7                -4.025373e-02 1 1  ON 7
 uu_8                 9.812712e-02 1 1  ON 8
 uu_9                 1.216087e-01 1 1  ON 9
 ud_0                 3.503464e-01 1 1  ON 10
 ud_1                 9.236621e-02 1 1  ON 11
 ud_2                -1.610958e-02 1 1  ON 12
 ud_3                -7.565842e-02 1 1  ON 13
 ud_4                -1.220631e-01 1 1  ON 14
 ud_5                -1.530453e-01 1 1  ON 15
 ud_6                -1.546793e-01 1 1  ON 16
 ud_7                -1.100033e-01 1 1  ON 17
 ud_8                 2.257050e-03 1 1  ON 18
 ud_9                 9.256106e-02 1 1  ON 19
 eO_0                -7.595067e-01 1 1  ON 20
 eO_1                -4.421898e-01 1 1  ON 21
 eO_2                -3.900825e-02 1 1  ON 22
 eO_3                 2.099437e-01 1 1  ON 23
 eO_4                 2.965809e-01 1 1  ON 24
 eO_5                 3.099060e-01 1 1  ON 25
 eO_6                 2.522984e-01 1 1  ON 26
 eO_7                 1.145022e-01 1 1  ON 27
 eO_8                 2.812216e-02 1 1  ON 28
 eO_9                 1.855269e-02 1 1  ON 29
eH1_0                -1.823616e-01 1 1  ON 30
eH1_1                -1.032374e-01 1 1  ON 31
eH1_2                -6.262134e-02 1 1  ON 32
eH1_3                -2.603815e-02 1 1  ON 33
eH1_4                 1.963255e-02 1 1  ON 34
eH1_5                 3.545095e-02 1 1  ON 35
eH1_6                 7.779924e-02 1 1  ON 36
eH1_7                 1.094650e-01 1 1  ON 37
eH1_8                 9.181998e-02 1 1  ON 38
eH1_9                 2.460193e-02 1 1  ON 39
eH2_0                -1.831667e-01 1 1  ON 40
eH2_1                -1.045108e-01 1 1  ON 41
eH2_2                -6.371487e-02 1 1  ON 42
eH2_3                -2.701387e-02 1 1  ON 43
eH2_4                 1.858049e-02 1 1  ON 44
eH2_5                 3.400956e-02 1 1  ON 45
eH2_6                 7.895066e-02 1 1  ON 46
eH2_7                 1.130482e-01 1 1  ON 47
eH2_8                 9.478323e-02 1 1  ON 48
eH2_9                 2.677363e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.3596
    reference variance = 0.673898
====================================================
  Execution time = 2.0641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1626e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316066904906
                                         uncertainty =       0.002975806765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316066904906
                                         uncertainty =       0.002975806765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397653905
  error estimate for blocks of size 2^( 2) =       0.000407005426
  error estimate for blocks of size 2^( 3) =       0.000416049261
  error estimate for blocks of size 2^( 4) =       0.000422438050
  error estimate for blocks of size 2^( 5) =       0.000427033971
  error estimate for blocks of size 2^( 6) =       0.000429123322
  error estimate for blocks of size 2^( 7) =       0.000429379268

      target function =                  N/A
              le_mean =     -17.216603143100
             les_mean =     296.727680885668
             stat err =       0.000426993653
             autocorr =       1.153008037228
              std dev =       0.562367546015
             le_variance =       0.316257256811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660314310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216603143100       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603144495       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603146202       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216603146026       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216603145804       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216603145812       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216603145932       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216603145978       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 8.896113e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216603143100       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603143449       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603143875       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216603143832       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216603143776       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216603143778       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216603143808       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216603143818       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.224011e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216603143100       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216603143187       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216603143294       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216603143283       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216603143270       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216603143271       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216603143265       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216603143251       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 5.560017e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.057823 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6202e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.092163e-01 1 1  ON 0
 uu_1                 4.761159e-02 1 1  ON 1
 uu_2                -4.617757e-02 1 1  ON 2
 uu_3                -1.001523e-01 1 1  ON 3
 uu_4                -1.323131e-01 1 1  ON 4
 uu_5                -1.378868e-01 1 1  ON 5
 uu_6                -1.138847e-01 1 1  ON 6
 uu_7                -4.025379e-02 1 1  ON 7
 uu_8                 9.812708e-02 1 1  ON 8
 uu_9                 1.216087e-01 1 1  ON 9
 ud_0                 3.503465e-01 1 1  ON 10
 ud_1                 9.236624e-02 1 1  ON 11
 ud_2                -1.610951e-02 1 1  ON 12
 ud_3                -7.565845e-02 1 1  ON 13
 ud_4                -1.220632e-01 1 1  ON 14
 ud_5                -1.530453e-01 1 1  ON 15
 ud_6                -1.546793e-01 1 1  ON 16
 ud_7                -1.100034e-01 1 1  ON 17
 ud_8                 2.257002e-03 1 1  ON 18
 ud_9                 9.256106e-02 1 1  ON 19
 eO_0                -7.595069e-01 1 1  ON 20
 eO_1                -4.421900e-01 1 1  ON 21
 eO_2                -3.900830e-02 1 1  ON 22
 eO_3                 2.099438e-01 1 1  ON 23
 eO_4                 2.965811e-01 1 1  ON 24
 eO_5                 3.099061e-01 1 1  ON 25
 eO_6                 2.522984e-01 1 1  ON 26
 eO_7                 1.145023e-01 1 1  ON 27
 eO_8                 2.812217e-02 1 1  ON 28
 eO_9                 1.855270e-02 1 1  ON 29
eH1_0                -1.823616e-01 1 1  ON 30
eH1_1                -1.032374e-01 1 1  ON 31
eH1_2                -6.262133e-02 1 1  ON 32
eH1_3                -2.603818e-02 1 1  ON 33
eH1_4                 1.963251e-02 1 1  ON 34
eH1_5                 3.545096e-02 1 1  ON 35
eH1_6                 7.779927e-02 1 1  ON 36
eH1_7                 1.094650e-01 1 1  ON 37
eH1_8                 9.182001e-02 1 1  ON 38
eH1_9                 2.460194e-02 1 1  ON 39
eH2_0                -1.831667e-01 1 1  ON 40
eH2_1                -1.045108e-01 1 1  ON 41
eH2_2                -6.371483e-02 1 1  ON 42
eH2_3                -2.701383e-02 1 1  ON 43
eH2_4                 1.858050e-02 1 1  ON 44
eH2_5                 3.400951e-02 1 1  ON 45
eH2_6                 7.895064e-02 1 1  ON 46
eH2_7                 1.130482e-01 1 1  ON 47
eH2_8                 9.478326e-02 1 1  ON 48
eH2_9                 2.677364e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1776
    reference variance = 0.38606
====================================================
  Execution time = 1.9780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1704e-01
  Total weights = 2.0000e+06
  Execution time = 1.8179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828512667
                                         uncertainty =       0.003934633695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828512667
                                         uncertainty =       0.003934633695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143111
  error estimate for blocks of size 2^( 2) =       0.000407337042
  error estimate for blocks of size 2^( 3) =       0.000415980916
  error estimate for blocks of size 2^( 4) =       0.000422552088
  error estimate for blocks of size 2^( 5) =       0.000426930344
  error estimate for blocks of size 2^( 6) =       0.000430469743
  error estimate for blocks of size 2^( 7) =       0.000432768062

      target function =                  N/A
              le_mean =     -17.216927978986
             les_mean =     296.739644749219
             stat err =       0.000428180059
             autocorr =       1.156576767182
              std dev =       0.563059387764
             le_variance =       0.317035874149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828500082
                                         uncertainty =       0.003934635705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828500082
                                         uncertainty =       0.003934635705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143103
  error estimate for blocks of size 2^( 2) =       0.000407337035
  error estimate for blocks of size 2^( 3) =       0.000415980911
  error estimate for blocks of size 2^( 4) =       0.000422552082
  error estimate for blocks of size 2^( 5) =       0.000426930338
  error estimate for blocks of size 2^( 6) =       0.000430469742
  error estimate for blocks of size 2^( 7) =       0.000432768062

      target function =                  N/A
              le_mean =     -17.216927981384
             les_mean =     296.739644819186
             stat err =       0.000428180056
             autocorr =       1.156576795556
              std dev =       0.563059376582
             le_variance =       0.317035861557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828506335
                                         uncertainty =       0.003934634701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828506335
                                         uncertainty =       0.003934634701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143107
  error estimate for blocks of size 2^( 2) =       0.000407337039
  error estimate for blocks of size 2^( 3) =       0.000415980913
  error estimate for blocks of size 2^( 4) =       0.000422552085
  error estimate for blocks of size 2^( 5) =       0.000426930341
  error estimate for blocks of size 2^( 6) =       0.000430469742
  error estimate for blocks of size 2^( 7) =       0.000432768062

      target function =                  N/A
              le_mean =     -17.216927980185
             les_mean =     296.739644784184
             stat err =       0.000428180058
             autocorr =       1.156576781420
              std dev =       0.563059382138
             le_variance =       0.317035867813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828511875
                                         uncertainty =       0.003934633821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316828511875
                                         uncertainty =       0.003934633821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143111
  error estimate for blocks of size 2^( 2) =       0.000407337042
  error estimate for blocks of size 2^( 3) =       0.000415980915
  error estimate for blocks of size 2^( 4) =       0.000422552088
  error estimate for blocks of size 2^( 5) =       0.000426930344
  error estimate for blocks of size 2^( 6) =       0.000430469743
  error estimate for blocks of size 2^( 7) =       0.000432768062

      target function =                  N/A
              le_mean =     -17.216927979136
             les_mean =     296.739644753589
             stat err =       0.000428180059
             autocorr =       1.156576768965
              std dev =       0.563059387059
             le_variance =       0.317035873355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216927978986        initial
     6.1035e+02     6.1035e+03             8.8961e-07       -17.216927981384  <--
     2.4414e+03     2.4414e+04             2.2240e-07       -17.216927980185
     9.7656e+03     9.7656e+04             5.5600e-08       -17.216927979136

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.8984e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.092165e-01 1 1  ON 0
 uu_1                 4.761164e-02 1 1  ON 1
 uu_2                -4.617744e-02 1 1  ON 2
 uu_3                -1.001524e-01 1 1  ON 3
 uu_4                -1.323131e-01 1 1  ON 4
 uu_5                -1.378867e-01 1 1  ON 5
 uu_6                -1.138849e-01 1 1  ON 6
 uu_7                -4.025396e-02 1 1  ON 7
 uu_8                 9.812698e-02 1 1  ON 8
 uu_9                 1.216087e-01 1 1  ON 9
 ud_0                 3.503466e-01 1 1  ON 10
 ud_1                 9.236633e-02 1 1  ON 11
 ud_2                -1.610928e-02 1 1  ON 12
 ud_3                -7.565852e-02 1 1  ON 13
 ud_4                -1.220632e-01 1 1  ON 14
 ud_5                -1.530454e-01 1 1  ON 15
 ud_6                -1.546793e-01 1 1  ON 16
 ud_7                -1.100035e-01 1 1  ON 17
 ud_8                 2.256858e-03 1 1  ON 18
 ud_9                 9.256105e-02 1 1  ON 19
 eO_0                -7.595076e-01 1 1  ON 20
 eO_1                -4.421906e-01 1 1  ON 21
 eO_2                -3.900844e-02 1 1  ON 22
 eO_3                 2.099441e-01 1 1  ON 23
 eO_4                 2.965817e-01 1 1  ON 24
 eO_5                 3.099064e-01 1 1  ON 25
 eO_6                 2.522985e-01 1 1  ON 26
 eO_7                 1.145024e-01 1 1  ON 27
 eO_8                 2.812220e-02 1 1  ON 28
 eO_9                 1.855270e-02 1 1  ON 29
eH1_0                -1.823616e-01 1 1  ON 30
eH1_1                -1.032374e-01 1 1  ON 31
eH1_2                -6.262130e-02 1 1  ON 32
eH1_3                -2.603826e-02 1 1  ON 33
eH1_4                 1.963239e-02 1 1  ON 34
eH1_5                 3.545099e-02 1 1  ON 35
eH1_6                 7.779936e-02 1 1  ON 36
eH1_7                 1.094650e-01 1 1  ON 37
eH1_8                 9.182009e-02 1 1  ON 38
eH1_9                 2.460196e-02 1 1  ON 39
eH2_0                -1.831668e-01 1 1  ON 40
eH2_1                -1.045108e-01 1 1  ON 41
eH2_2                -6.371471e-02 1 1  ON 42
eH2_3                -2.701373e-02 1 1  ON 43
eH2_4                 1.858050e-02 1 1  ON 44
eH2_5                 3.400939e-02 1 1  ON 45
eH2_6                 7.895056e-02 1 1  ON 46
eH2_7                 1.130481e-01 1 1  ON 47
eH2_8                 9.478333e-02 1 1  ON 48
eH2_9                 2.677365e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5192e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2816
    reference variance = 0.287198
====================================================
  Execution time = 2.0370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1457e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314648720113
                                         uncertainty =       0.003224273091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314648720113
                                         uncertainty =       0.003224273091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396591429
  error estimate for blocks of size 2^( 2) =       0.000406444191
  error estimate for blocks of size 2^( 3) =       0.000415494385
  error estimate for blocks of size 2^( 4) =       0.000422188187
  error estimate for blocks of size 2^( 5) =       0.000427393940
  error estimate for blocks of size 2^( 6) =       0.000429704288
  error estimate for blocks of size 2^( 7) =       0.000429672665

      target function =                  N/A
              le_mean =     -17.216687108049
             les_mean =     296.728884341869
             stat err =       0.000427239770
             autocorr =       1.160530870654
              std dev =       0.560864977243
             le_variance =       0.314569522698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721668710805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216687108049       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216687107978       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216687115932       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216687114531       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216687114355       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216687115399       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216687115879       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.791839e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216687108049       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216687108031       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216687110022       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216687109668       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216687109624       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216687109885       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216687110005       residual = 6.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 9.481177e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216687108049       residual = 5.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216687108044       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216687108542       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216687108454       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216687108442       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216687108508       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216687108538       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.370393e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.060229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6014e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.092169e-01 1 1  ON 0
 uu_1                 4.761185e-02 1 1  ON 1
 uu_2                -4.617725e-02 1 1  ON 2
 uu_3                -1.001523e-01 1 1  ON 3
 uu_4                -1.323133e-01 1 1  ON 4
 uu_5                -1.378870e-01 1 1  ON 5
 uu_6                -1.138851e-01 1 1  ON 6
 uu_7                -4.025419e-02 1 1  ON 7
 uu_8                 9.812685e-02 1 1  ON 8
 uu_9                 1.216088e-01 1 1  ON 9
 ud_0                 3.503467e-01 1 1  ON 10
 ud_1                 9.236649e-02 1 1  ON 11
 ud_2                -1.610911e-02 1 1  ON 12
 ud_3                -7.565861e-02 1 1  ON 13
 ud_4                -1.220633e-01 1 1  ON 14
 ud_5                -1.530455e-01 1 1  ON 15
 ud_6                -1.546793e-01 1 1  ON 16
 ud_7                -1.100035e-01 1 1  ON 17
 ud_8                 2.256658e-03 1 1  ON 18
 ud_9                 9.256104e-02 1 1  ON 19
 eO_0                -7.595085e-01 1 1  ON 20
 eO_1                -4.421913e-01 1 1  ON 21
 eO_2                -3.900871e-02 1 1  ON 22
 eO_3                 2.099446e-01 1 1  ON 23
 eO_4                 2.965826e-01 1 1  ON 24
 eO_5                 3.099066e-01 1 1  ON 25
 eO_6                 2.522987e-01 1 1  ON 26
 eO_7                 1.145026e-01 1 1  ON 27
 eO_8                 2.812223e-02 1 1  ON 28
 eO_9                 1.855271e-02 1 1  ON 29
eH1_0                -1.823616e-01 1 1  ON 30
eH1_1                -1.032376e-01 1 1  ON 31
eH1_2                -6.262142e-02 1 1  ON 32
eH1_3                -2.603830e-02 1 1  ON 33
eH1_4                 1.963232e-02 1 1  ON 34
eH1_5                 3.545115e-02 1 1  ON 35
eH1_6                 7.779936e-02 1 1  ON 36
eH1_7                 1.094650e-01 1 1  ON 37
eH1_8                 9.182020e-02 1 1  ON 38
eH1_9                 2.460201e-02 1 1  ON 39
eH2_0                -1.831669e-01 1 1  ON 40
eH2_1                -1.045107e-01 1 1  ON 41
eH2_2                -6.371479e-02 1 1  ON 42
eH2_3                -2.701371e-02 1 1  ON 43
eH2_4                 1.858034e-02 1 1  ON 44
eH2_5                 3.400942e-02 1 1  ON 45
eH2_6                 7.895060e-02 1 1  ON 46
eH2_7                 1.130481e-01 1 1  ON 47
eH2_8                 9.478342e-02 1 1  ON 48
eH2_9                 2.677368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.218381
====================================================
  Execution time = 1.9900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1787e-01
  Total weights = 2.0000e+06
  Execution time = 1.8266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842091255
                                         uncertainty =       0.005095650034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842091255
                                         uncertainty =       0.005095650034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398668586
  error estimate for blocks of size 2^( 2) =       0.000408867885
  error estimate for blocks of size 2^( 3) =       0.000417723641
  error estimate for blocks of size 2^( 4) =       0.000425238084
  error estimate for blocks of size 2^( 5) =       0.000429229131
  error estimate for blocks of size 2^( 6) =       0.000431355076
  error estimate for blocks of size 2^( 7) =       0.000433327998

      target function =                  N/A
              le_mean =     -17.216330096935
             les_mean =     296.719895130290
             stat err =       0.000429787572
             autocorr =       1.162207505031
              std dev =       0.563802520909
             le_variance =       0.317873282583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842232196
                                         uncertainty =       0.005095656294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842232196
                                         uncertainty =       0.005095656294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398668674
  error estimate for blocks of size 2^( 2) =       0.000408867970
  error estimate for blocks of size 2^( 3) =       0.000417723704
  error estimate for blocks of size 2^( 4) =       0.000425238126
  error estimate for blocks of size 2^( 5) =       0.000429229175
  error estimate for blocks of size 2^( 6) =       0.000431355124
  error estimate for blocks of size 2^( 7) =       0.000433328049

      target function =                  N/A
              le_mean =     -17.216330102320
             les_mean =     296.719895456764
             stat err =       0.000429787618
             autocorr =       1.162207238333
              std dev =       0.563802646018
             le_variance =       0.317873423657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842161139
                                         uncertainty =       0.005095653167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842161139
                                         uncertainty =       0.005095653167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398668630
  error estimate for blocks of size 2^( 2) =       0.000408867927
  error estimate for blocks of size 2^( 3) =       0.000417723672
  error estimate for blocks of size 2^( 4) =       0.000425238105
  error estimate for blocks of size 2^( 5) =       0.000429229153
  error estimate for blocks of size 2^( 6) =       0.000431355100
  error estimate for blocks of size 2^( 7) =       0.000433328023

      target function =                  N/A
              le_mean =     -17.216330099630
             les_mean =     296.719895293018
             stat err =       0.000429787595
             autocorr =       1.162207372085
              std dev =       0.563802582943
             le_variance =       0.317873352533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842099972
                                         uncertainty =       0.005095650426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317842099972
                                         uncertainty =       0.005095650426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398668591
  error estimate for blocks of size 2^( 2) =       0.000408867891
  error estimate for blocks of size 2^( 3) =       0.000417723645
  error estimate for blocks of size 2^( 4) =       0.000425238087
  error estimate for blocks of size 2^( 5) =       0.000429229134
  error estimate for blocks of size 2^( 6) =       0.000431355079
  error estimate for blocks of size 2^( 7) =       0.000433328001

      target function =                  N/A
              le_mean =     -17.216330097272
             les_mean =     296.719895150612
             stat err =       0.000429787575
             autocorr =       1.162207488428
              std dev =       0.563802528646
             le_variance =       0.317873291308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216330096935        initial
     1.5259e+02     1.5259e+03             3.7918e-06       -17.216330102320  <--
     6.1035e+02     6.1035e+03             9.4812e-07       -17.216330099630
     2.4414e+03     2.4414e+04             2.3704e-07       -17.216330097272

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.9120e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.092179e-01 1 1  ON 0
 uu_1                 4.761246e-02 1 1  ON 1
 uu_2                -4.617668e-02 1 1  ON 2
 uu_3                -1.001522e-01 1 1  ON 3
 uu_4                -1.323139e-01 1 1  ON 4
 uu_5                -1.378876e-01 1 1  ON 5
 uu_6                -1.138858e-01 1 1  ON 6
 uu_7                -4.025486e-02 1 1  ON 7
 uu_8                 9.812646e-02 1 1  ON 8
 uu_9                 1.216091e-01 1 1  ON 9
 ud_0                 3.503469e-01 1 1  ON 10
 ud_1                 9.236694e-02 1 1  ON 11
 ud_2                -1.610862e-02 1 1  ON 12
 ud_3                -7.565886e-02 1 1  ON 13
 ud_4                -1.220634e-01 1 1  ON 14
 ud_5                -1.530459e-01 1 1  ON 15
 ud_6                -1.546792e-01 1 1  ON 16
 ud_7                -1.100037e-01 1 1  ON 17
 ud_8                 2.256059e-03 1 1  ON 18
 ud_9                 9.256102e-02 1 1  ON 19
 eO_0                -7.595114e-01 1 1  ON 20
 eO_1                -4.421935e-01 1 1  ON 21
 eO_2                -3.900952e-02 1 1  ON 22
 eO_3                 2.099459e-01 1 1  ON 23
 eO_4                 2.965851e-01 1 1  ON 24
 eO_5                 3.099074e-01 1 1  ON 25
 eO_6                 2.522991e-01 1 1  ON 26
 eO_7                 1.145031e-01 1 1  ON 27
 eO_8                 2.812233e-02 1 1  ON 28
 eO_9                 1.855274e-02 1 1  ON 29
eH1_0                -1.823614e-01 1 1  ON 30
eH1_1                -1.032379e-01 1 1  ON 31
eH1_2                -6.262177e-02 1 1  ON 32
eH1_3                -2.603841e-02 1 1  ON 33
eH1_4                 1.963209e-02 1 1  ON 34
eH1_5                 3.545162e-02 1 1  ON 35
eH1_6                 7.779935e-02 1 1  ON 36
eH1_7                 1.094648e-01 1 1  ON 37
eH1_8                 9.182056e-02 1 1  ON 38
eH1_9                 2.460216e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045103e-01 1 1  ON 41
eH2_2                -6.371500e-02 1 1  ON 42
eH2_3                -2.701365e-02 1 1  ON 43
eH2_4                 1.857984e-02 1 1  ON 44
eH2_5                 3.400951e-02 1 1  ON 45
eH2_6                 7.895070e-02 1 1  ON 46
eH2_7                 1.130480e-01 1 1  ON 47
eH2_8                 9.478372e-02 1 1  ON 48
eH2_9                 2.677377e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.261417
====================================================
  Execution time = 2.0474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.5236e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352458181553
                                         uncertainty =       0.034436444097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352458181553
                                         uncertainty =       0.034436444097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419739707
  error estimate for blocks of size 2^( 2) =       0.000428920001
  error estimate for blocks of size 2^( 3) =       0.000437027814
  error estimate for blocks of size 2^( 4) =       0.000443036783
  error estimate for blocks of size 2^( 5) =       0.000446626120
  error estimate for blocks of size 2^( 6) =       0.000448700576
  error estimate for blocks of size 2^( 7) =       0.000447984787

      target function =                  N/A
              le_mean =     -17.216297257185
             les_mean =     296.753253914170
             stat err =       0.000446587066
             autocorr =       1.132014977747
              std dev =       0.593601585743
             le_variance =       0.352362842596


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721629725718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216297257185       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216297272050       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216297277866       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216297284853       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216297302285       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297306531       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216297303146       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.370079e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216297257185       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216297260919       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216297262375       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216297264126       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216297268485       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297269546       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216297268701       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.426804e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216297257185       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216297258120       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216297258484       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216297258922       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216297260012       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216297260277       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216297260066       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 8.568013e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6024e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.092189e-01 1 1  ON 0
 uu_1                 4.761273e-02 1 1  ON 1
 uu_2                -4.617637e-02 1 1  ON 2
 uu_3                -1.001521e-01 1 1  ON 3
 uu_4                -1.323144e-01 1 1  ON 4
 uu_5                -1.378881e-01 1 1  ON 5
 uu_6                -1.138863e-01 1 1  ON 6
 uu_7                -4.025546e-02 1 1  ON 7
 uu_8                 9.812610e-02 1 1  ON 8
 uu_9                 1.216095e-01 1 1  ON 9
 ud_0                 3.503476e-01 1 1  ON 10
 ud_1                 9.236792e-02 1 1  ON 11
 ud_2                -1.610813e-02 1 1  ON 12
 ud_3                -7.565903e-02 1 1  ON 13
 ud_4                -1.220640e-01 1 1  ON 14
 ud_5                -1.530467e-01 1 1  ON 15
 ud_6                -1.546795e-01 1 1  ON 16
 ud_7                -1.100040e-01 1 1  ON 17
 ud_8                 2.255478e-03 1 1  ON 18
 ud_9                 9.256111e-02 1 1  ON 19
 eO_0                -7.595148e-01 1 1  ON 20
 eO_1                -4.421966e-01 1 1  ON 21
 eO_2                -3.901064e-02 1 1  ON 22
 eO_3                 2.099476e-01 1 1  ON 23
 eO_4                 2.965883e-01 1 1  ON 24
 eO_5                 3.099084e-01 1 1  ON 25
 eO_6                 2.522996e-01 1 1  ON 26
 eO_7                 1.145040e-01 1 1  ON 27
 eO_8                 2.812250e-02 1 1  ON 28
 eO_9                 1.855280e-02 1 1  ON 29
eH1_0                -1.823615e-01 1 1  ON 30
eH1_1                -1.032381e-01 1 1  ON 31
eH1_2                -6.262243e-02 1 1  ON 32
eH1_3                -2.603811e-02 1 1  ON 33
eH1_4                 1.963210e-02 1 1  ON 34
eH1_5                 3.545157e-02 1 1  ON 35
eH1_6                 7.779967e-02 1 1  ON 36
eH1_7                 1.094647e-01 1 1  ON 37
eH1_8                 9.182098e-02 1 1  ON 38
eH1_9                 2.460230e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045107e-01 1 1  ON 41
eH2_2                -6.371484e-02 1 1  ON 42
eH2_3                -2.701371e-02 1 1  ON 43
eH2_4                 1.857992e-02 1 1  ON 44
eH2_5                 3.400903e-02 1 1  ON 45
eH2_6                 7.895051e-02 1 1  ON 46
eH2_7                 1.130481e-01 1 1  ON 47
eH2_8                 9.478426e-02 1 1  ON 48
eH2_9                 2.677392e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2526
    reference variance = 0.230702
====================================================
  Execution time = 1.9803e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3546e-01
  Total weights = 2.0000e+06
  Execution time = 1.8259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335559495479
                                         uncertainty =       0.016110869658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335559495479
                                         uncertainty =       0.016110869658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409546690
  error estimate for blocks of size 2^( 2) =       0.000418832615
  error estimate for blocks of size 2^( 3) =       0.000427084323
  error estimate for blocks of size 2^( 4) =       0.000433605646
  error estimate for blocks of size 2^( 5) =       0.000437681448
  error estimate for blocks of size 2^( 6) =       0.000439947372
  error estimate for blocks of size 2^( 7) =       0.000441336171

      target function =                  N/A
              le_mean =     -17.217294110195
             les_mean =     296.770673291008
             stat err =       0.000438142659
             autocorr =       1.144522250546
              std dev =       0.579186482737
             le_variance =       0.335456981785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335560551732
                                         uncertainty =       0.016110881999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335560551732
                                         uncertainty =       0.016110881999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409547334
  error estimate for blocks of size 2^( 2) =       0.000418833201
  error estimate for blocks of size 2^( 3) =       0.000427084813
  error estimate for blocks of size 2^( 4) =       0.000433606076
  error estimate for blocks of size 2^( 5) =       0.000437681792
  error estimate for blocks of size 2^( 6) =       0.000439947717
  error estimate for blocks of size 2^( 7) =       0.000441336390

      target function =                  N/A
              le_mean =     -17.217294117343
             les_mean =     296.770674592949
             stat err =       0.000438142994
             autocorr =       1.144520395275
              std dev =       0.579187394184
             le_variance =       0.335458037581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335560017206
                                         uncertainty =       0.016110875634

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335560017206
                                         uncertainty =       0.016110875634

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409547008
  error estimate for blocks of size 2^( 2) =       0.000418832904
  error estimate for blocks of size 2^( 3) =       0.000427084564
  error estimate for blocks of size 2^( 4) =       0.000433605857
  error estimate for blocks of size 2^( 5) =       0.000437681616
  error estimate for blocks of size 2^( 6) =       0.000439947540
  error estimate for blocks of size 2^( 7) =       0.000441336277

      target function =                  N/A
              le_mean =     -17.217294113732
             les_mean =     296.770673934309
             stat err =       0.000438142823
             autocorr =       1.144521324931
              std dev =       0.579186932938
             le_variance =       0.335457503286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335559560487
                                         uncertainty =       0.016110870399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335559560487
                                         uncertainty =       0.016110870399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409546729
  error estimate for blocks of size 2^( 2) =       0.000418832651
  error estimate for blocks of size 2^( 3) =       0.000427084353
  error estimate for blocks of size 2^( 4) =       0.000433605672
  error estimate for blocks of size 2^( 5) =       0.000437681469
  error estimate for blocks of size 2^( 6) =       0.000439947393
  error estimate for blocks of size 2^( 7) =       0.000441336184

      target function =                  N/A
              le_mean =     -17.217294110635
             les_mean =     296.770673371142
             stat err =       0.000438142680
             autocorr =       1.144522134894
              std dev =       0.579186538832
             le_variance =       0.335457046765


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217294110195        initial
     3.8147e+01     3.8147e+02             1.3701e-05       -17.217294117343  <--
     1.5259e+02     1.5259e+03             3.4268e-06       -17.217294113732
     6.1035e+02     6.1035e+03             8.5680e-07       -17.217294110635

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.9059e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.092218e-01 1 1  ON 0
 uu_1                 4.761355e-02 1 1  ON 1
 uu_2                -4.617546e-02 1 1  ON 2
 uu_3                -1.001518e-01 1 1  ON 3
 uu_4                -1.323160e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138875e-01 1 1  ON 6
 uu_7                -4.025724e-02 1 1  ON 7
 uu_8                 9.812503e-02 1 1  ON 8
 uu_9                 1.216105e-01 1 1  ON 9
 ud_0                 3.503498e-01 1 1  ON 10
 ud_1                 9.237087e-02 1 1  ON 11
 ud_2                -1.610665e-02 1 1  ON 12
 ud_3                -7.565955e-02 1 1  ON 13
 ud_4                -1.220655e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546803e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253735e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595251e-01 1 1  ON 20
 eO_1                -4.422058e-01 1 1  ON 21
 eO_2                -3.901400e-02 1 1  ON 22
 eO_3                 2.099525e-01 1 1  ON 23
 eO_4                 2.965979e-01 1 1  ON 24
 eO_5                 3.099117e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145067e-01 1 1  ON 27
 eO_8                 2.812300e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823621e-01 1 1  ON 30
eH1_1                -1.032388e-01 1 1  ON 31
eH1_2                -6.262438e-02 1 1  ON 32
eH1_3                -2.603721e-02 1 1  ON 33
eH1_4                 1.963214e-02 1 1  ON 34
eH1_5                 3.545141e-02 1 1  ON 35
eH1_6                 7.780062e-02 1 1  ON 36
eH1_7                 1.094645e-01 1 1  ON 37
eH1_8                 9.182224e-02 1 1  ON 38
eH1_9                 2.460270e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858017e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894993e-02 1 1  ON 46
eH2_7                 1.130484e-01 1 1  ON 47
eH2_8                 9.478590e-02 1 1  ON 48
eH2_9                 2.677439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5089e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1344
    reference variance = 0.225958
====================================================
  Execution time = 2.0353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315307143092
                                         uncertainty =       0.004090490693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315307143092
                                         uncertainty =       0.004090490693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397130264
  error estimate for blocks of size 2^( 2) =       0.000406753239
  error estimate for blocks of size 2^( 3) =       0.000415455223
  error estimate for blocks of size 2^( 4) =       0.000422268994
  error estimate for blocks of size 2^( 5) =       0.000424703581
  error estimate for blocks of size 2^( 6) =       0.000426371211
  error estimate for blocks of size 2^( 7) =       0.000428502445

      target function =                  N/A
              le_mean =     -17.216554687021
             les_mean =     296.725180027206
             stat err =       0.000425461558
             autocorr =       1.147769504661
              std dev =       0.561627005891
             le_variance =       0.315424893746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655468702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554687021       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216554729884       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554900898       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216555002967       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554895717       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554931418       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554919145       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216554919472       residual = 2.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 6.083957e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554687021       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216554697888       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554741411       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216554767902       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554741476       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554749637       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554746221       residual = 9.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.524497e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216554687021       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216554689747       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216554700678       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216554707362       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216554700786       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216554702774       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216554701898       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.814310e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064925 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5856e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.092280e-01 1 1  ON 0
 uu_1                 4.761705e-02 1 1  ON 1
 uu_2                -4.617588e-02 1 1  ON 2
 uu_3                -1.001510e-01 1 1  ON 3
 uu_4                -1.323164e-01 1 1  ON 4
 uu_5                -1.378939e-01 1 1  ON 5
 uu_6                -1.138915e-01 1 1  ON 6
 uu_7                -4.026033e-02 1 1  ON 7
 uu_8                 9.812339e-02 1 1  ON 8
 uu_9                 1.216120e-01 1 1  ON 9
 ud_0                 3.503524e-01 1 1  ON 10
 ud_1                 9.237375e-02 1 1  ON 11
 ud_2                -1.610506e-02 1 1  ON 12
 ud_3                -7.566206e-02 1 1  ON 13
 ud_4                -1.220680e-01 1 1  ON 14
 ud_5                -1.530483e-01 1 1  ON 15
 ud_6                -1.546805e-01 1 1  ON 16
 ud_7                -1.100059e-01 1 1  ON 17
 ud_8                 2.250658e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595403e-01 1 1  ON 20
 eO_1                -4.422150e-01 1 1  ON 21
 eO_2                -3.901524e-02 1 1  ON 22
 eO_3                 2.099570e-01 1 1  ON 23
 eO_4                 2.966084e-01 1 1  ON 24
 eO_5                 3.099161e-01 1 1  ON 25
 eO_6                 2.523036e-01 1 1  ON 26
 eO_7                 1.145099e-01 1 1  ON 27
 eO_8                 2.812344e-02 1 1  ON 28
 eO_9                 1.855315e-02 1 1  ON 29
eH1_0                -1.823648e-01 1 1  ON 30
eH1_1                -1.032424e-01 1 1  ON 31
eH1_2                -6.262151e-02 1 1  ON 32
eH1_3                -2.603783e-02 1 1  ON 33
eH1_4                 1.963167e-02 1 1  ON 34
eH1_5                 3.545114e-02 1 1  ON 35
eH1_6                 7.780243e-02 1 1  ON 36
eH1_7                 1.094648e-01 1 1  ON 37
eH1_8                 9.182426e-02 1 1  ON 38
eH1_9                 2.460323e-02 1 1  ON 39
eH2_0                -1.831706e-01 1 1  ON 40
eH2_1                -1.045095e-01 1 1  ON 41
eH2_2                -6.371343e-02 1 1  ON 42
eH2_3                -2.701358e-02 1 1  ON 43
eH2_4                 1.858088e-02 1 1  ON 44
eH2_5                 3.400639e-02 1 1  ON 45
eH2_6                 7.894911e-02 1 1  ON 46
eH2_7                 1.130476e-01 1 1  ON 47
eH2_8                 9.478726e-02 1 1  ON 48
eH2_9                 2.677481e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.3023
    reference variance = 0.211478
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1886e-01
  Total weights = 2.0000e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318957773367
                                         uncertainty =       0.003540028364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318957773367
                                         uncertainty =       0.003540028364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399286525
  error estimate for blocks of size 2^( 2) =       0.000409082219
  error estimate for blocks of size 2^( 3) =       0.000417494764
  error estimate for blocks of size 2^( 4) =       0.000423267803
  error estimate for blocks of size 2^( 5) =       0.000427895553
  error estimate for blocks of size 2^( 6) =       0.000429538479
  error estimate for blocks of size 2^( 7) =       0.000431827731

      target function =                  N/A
              le_mean =     -17.216648638124
             les_mean =     296.731849626629
             stat err =       0.000428132392
             autocorr =       1.149706182102
              std dev =       0.564676418352
             le_variance =       0.318859457443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965730451
                                         uncertainty =       0.003540129727

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318965730451
                                         uncertainty =       0.003540129727

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399291510
  error estimate for blocks of size 2^( 2) =       0.000409087078
  error estimate for blocks of size 2^( 3) =       0.000417499400
  error estimate for blocks of size 2^( 4) =       0.000423272084
  error estimate for blocks of size 2^( 5) =       0.000427899595
  error estimate for blocks of size 2^( 6) =       0.000429542671
  error estimate for blocks of size 2^( 7) =       0.000431831839

      target function =                  N/A
              le_mean =     -17.216648575826
             les_mean =     296.731855443381
             stat err =       0.000428136547
             autocorr =       1.149699791616
              std dev =       0.564683468268
             le_variance =       0.318867419335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318961801966
                                         uncertainty =       0.003540076667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318961801966
                                         uncertainty =       0.003540076667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399289048
  error estimate for blocks of size 2^( 2) =       0.000409084679
  error estimate for blocks of size 2^( 3) =       0.000417497109
  error estimate for blocks of size 2^( 4) =       0.000423269970
  error estimate for blocks of size 2^( 5) =       0.000427897597
  error estimate for blocks of size 2^( 6) =       0.000429540613
  error estimate for blocks of size 2^( 7) =       0.000431829808

      target function =                  N/A
              le_mean =     -17.216648609341
             les_mean =     296.731852666558
             stat err =       0.000428134497
             autocorr =       1.149702955531
              std dev =       0.564679987669
             le_variance =       0.318863488474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318958275958
                                         uncertainty =       0.003540034433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318958275958
                                         uncertainty =       0.003540034433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399286839
  error estimate for blocks of size 2^( 2) =       0.000409082526
  error estimate for blocks of size 2^( 3) =       0.000417495057
  error estimate for blocks of size 2^( 4) =       0.000423268074
  error estimate for blocks of size 2^( 5) =       0.000427895808
  error estimate for blocks of size 2^( 6) =       0.000429538745
  error estimate for blocks of size 2^( 7) =       0.000431827990

      target function =                  N/A
              le_mean =     -17.216648634399
             les_mean =     296.731850001275
             stat err =       0.000428132654
             autocorr =       1.149705779427
              std dev =       0.564676863652
             le_variance =       0.318859960344


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216648638124        initial  <--
     9.5367e+00     9.5367e+01             6.0840e-05       -17.216648575826
     3.8147e+01     3.8147e+02             1.5245e-05       -17.216648609341
     1.5259e+02     1.5259e+03             3.8143e-06       -17.216648634399

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2125
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.092218e-01 1 1  ON 0
 uu_1                 4.761355e-02 1 1  ON 1
 uu_2                -4.617546e-02 1 1  ON 2
 uu_3                -1.001518e-01 1 1  ON 3
 uu_4                -1.323160e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138875e-01 1 1  ON 6
 uu_7                -4.025724e-02 1 1  ON 7
 uu_8                 9.812503e-02 1 1  ON 8
 uu_9                 1.216105e-01 1 1  ON 9
 ud_0                 3.503498e-01 1 1  ON 10
 ud_1                 9.237087e-02 1 1  ON 11
 ud_2                -1.610665e-02 1 1  ON 12
 ud_3                -7.565955e-02 1 1  ON 13
 ud_4                -1.220655e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546803e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253735e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595251e-01 1 1  ON 20
 eO_1                -4.422058e-01 1 1  ON 21
 eO_2                -3.901400e-02 1 1  ON 22
 eO_3                 2.099525e-01 1 1  ON 23
 eO_4                 2.965979e-01 1 1  ON 24
 eO_5                 3.099117e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145067e-01 1 1  ON 27
 eO_8                 2.812300e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823621e-01 1 1  ON 30
eH1_1                -1.032388e-01 1 1  ON 31
eH1_2                -6.262438e-02 1 1  ON 32
eH1_3                -2.603721e-02 1 1  ON 33
eH1_4                 1.963214e-02 1 1  ON 34
eH1_5                 3.545141e-02 1 1  ON 35
eH1_6                 7.780062e-02 1 1  ON 36
eH1_7                 1.094645e-01 1 1  ON 37
eH1_8                 9.182224e-02 1 1  ON 38
eH1_9                 2.460270e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858017e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894993e-02 1 1  ON 46
eH2_7                 1.130484e-01 1 1  ON 47
eH2_8                 9.478590e-02 1 1  ON 48
eH2_9                 2.677439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1941
    reference variance = 0.225263
====================================================
  Execution time = 2.2416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327074220296
                                         uncertainty =       0.004955257623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327074220296
                                         uncertainty =       0.004955257623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404371206
  error estimate for blocks of size 2^( 2) =       0.000413589749
  error estimate for blocks of size 2^( 3) =       0.000421656800
  error estimate for blocks of size 2^( 4) =       0.000427682139
  error estimate for blocks of size 2^( 5) =       0.000432110841
  error estimate for blocks of size 2^( 6) =       0.000433077263
  error estimate for blocks of size 2^( 7) =       0.000432682279

      target function =                  N/A
              le_mean =     -17.215793850709
             les_mean =     296.710589891478
             stat err =       0.000431388130
             autocorr =       1.138088239603
              std dev =       0.571867244120
             le_variance =       0.327032144897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721579385071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215793850709       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215793849400       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215793855537       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215793860094       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215793861659       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215793861177       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215793860365       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 6.275298e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215793850709       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215793850381       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215793851917       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215793853052       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215793853444       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215793853326       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215793853122       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.569536e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215793850709       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215793850627       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215793851011       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215793851294       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215793851392       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215793851363       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215793851312       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 3.924287e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.067180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8104e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.092224e-01 1 1  ON 0
 uu_1                 4.761393e-02 1 1  ON 1
 uu_2                -4.617525e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378898e-01 1 1  ON 5
 uu_6                -1.138881e-01 1 1  ON 6
 uu_7                -4.025769e-02 1 1  ON 7
 uu_8                 9.812485e-02 1 1  ON 8
 uu_9                 1.216107e-01 1 1  ON 9
 ud_0                 3.503502e-01 1 1  ON 10
 ud_1                 9.237122e-02 1 1  ON 11
 ud_2                -1.610662e-02 1 1  ON 12
 ud_3                -7.565947e-02 1 1  ON 13
 ud_4                -1.220657e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100050e-01 1 1  ON 17
 ud_8                 2.253353e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595266e-01 1 1  ON 20
 eO_1                -4.422068e-01 1 1  ON 21
 eO_2                -3.901438e-02 1 1  ON 22
 eO_3                 2.099533e-01 1 1  ON 23
 eO_4                 2.965993e-01 1 1  ON 24
 eO_5                 3.099121e-01 1 1  ON 25
 eO_6                 2.523014e-01 1 1  ON 26
 eO_7                 1.145069e-01 1 1  ON 27
 eO_8                 2.812304e-02 1 1  ON 28
 eO_9                 1.855299e-02 1 1  ON 29
eH1_0                -1.823624e-01 1 1  ON 30
eH1_1                -1.032387e-01 1 1  ON 31
eH1_2                -6.262430e-02 1 1  ON 32
eH1_3                -2.603696e-02 1 1  ON 33
eH1_4                 1.963210e-02 1 1  ON 34
eH1_5                 3.545105e-02 1 1  ON 35
eH1_6                 7.780056e-02 1 1  ON 36
eH1_7                 1.094645e-01 1 1  ON 37
eH1_8                 9.182243e-02 1 1  ON 38
eH1_9                 2.460277e-02 1 1  ON 39
eH2_0                -1.831673e-01 1 1  ON 40
eH2_1                -1.045117e-01 1 1  ON 41
eH2_2                -6.371454e-02 1 1  ON 42
eH2_3                -2.701399e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400789e-02 1 1  ON 45
eH2_6                 7.895001e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478604e-02 1 1  ON 48
eH2_9                 2.677443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.278898
====================================================
  Execution time = 1.9883e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1707e-01
  Total weights = 2.0000e+06
  Execution time = 1.8221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317078435273
                                         uncertainty =       0.003305525898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317078435273
                                         uncertainty =       0.003305525898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398163349
  error estimate for blocks of size 2^( 2) =       0.000407661362
  error estimate for blocks of size 2^( 3) =       0.000416451083
  error estimate for blocks of size 2^( 4) =       0.000422386847
  error estimate for blocks of size 2^( 5) =       0.000425962743
  error estimate for blocks of size 2^( 6) =       0.000429088144
  error estimate for blocks of size 2^( 7) =       0.000429650359

      target function =                  N/A
              le_mean =     -17.217188033152
             les_mean =     296.748631715741
             stat err =       0.000426772023
             autocorr =       1.148865853058
              std dev =       0.563088008541
             le_variance =       0.317068105362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317079874165
                                         uncertainty =       0.003305545264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317079874165
                                         uncertainty =       0.003305545264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398164253
  error estimate for blocks of size 2^( 2) =       0.000407662211
  error estimate for blocks of size 2^( 3) =       0.000416451872
  error estimate for blocks of size 2^( 4) =       0.000422387586
  error estimate for blocks of size 2^( 5) =       0.000425963456
  error estimate for blocks of size 2^( 6) =       0.000429088826
  error estimate for blocks of size 2^( 7) =       0.000429651008

      target function =                  N/A
              le_mean =     -17.217188030449
             les_mean =     296.748633061305
             stat err =       0.000426772719
             autocorr =       1.148864387318
              std dev =       0.563089286004
             le_variance =       0.317069544013

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317079155247
                                         uncertainty =       0.003305535591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317079155247
                                         uncertainty =       0.003305535591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398163801
  error estimate for blocks of size 2^( 2) =       0.000407661786
  error estimate for blocks of size 2^( 3) =       0.000416451478
  error estimate for blocks of size 2^( 4) =       0.000422387217
  error estimate for blocks of size 2^( 5) =       0.000425963100
  error estimate for blocks of size 2^( 6) =       0.000429088485
  error estimate for blocks of size 2^( 7) =       0.000429650684

      target function =                  N/A
              le_mean =     -17.217188031809
             les_mean =     296.748632389332
             stat err =       0.000426772371
             autocorr =       1.148865119235
              std dev =       0.563088647742
             le_variance =       0.317068825216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317078525285
                                         uncertainty =       0.003305527110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317078525285
                                         uncertainty =       0.003305527110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398163406
  error estimate for blocks of size 2^( 2) =       0.000407661415
  error estimate for blocks of size 2^( 3) =       0.000416451132
  error estimate for blocks of size 2^( 4) =       0.000422386893
  error estimate for blocks of size 2^( 5) =       0.000425962787
  error estimate for blocks of size 2^( 6) =       0.000429088186
  error estimate for blocks of size 2^( 7) =       0.000429650400

      target function =                  N/A
              le_mean =     -17.217188032984
             les_mean =     296.748631799957
             stat err =       0.000426772067
             autocorr =       1.148865761308
              std dev =       0.563088088454
             le_variance =       0.317068195359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217188033152        initial  <--
     9.5367e+01     9.5367e+02             6.2753e-06       -17.217188030449
     3.8147e+02     3.8147e+03             1.5695e-06       -17.217188031809
     1.5259e+03     1.5259e+04             3.9243e-07       -17.217188032984

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2073
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.092218e-01 1 1  ON 0
 uu_1                 4.761355e-02 1 1  ON 1
 uu_2                -4.617546e-02 1 1  ON 2
 uu_3                -1.001518e-01 1 1  ON 3
 uu_4                -1.323160e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138875e-01 1 1  ON 6
 uu_7                -4.025724e-02 1 1  ON 7
 uu_8                 9.812503e-02 1 1  ON 8
 uu_9                 1.216105e-01 1 1  ON 9
 ud_0                 3.503498e-01 1 1  ON 10
 ud_1                 9.237087e-02 1 1  ON 11
 ud_2                -1.610665e-02 1 1  ON 12
 ud_3                -7.565955e-02 1 1  ON 13
 ud_4                -1.220655e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546803e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253735e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595251e-01 1 1  ON 20
 eO_1                -4.422058e-01 1 1  ON 21
 eO_2                -3.901400e-02 1 1  ON 22
 eO_3                 2.099525e-01 1 1  ON 23
 eO_4                 2.965979e-01 1 1  ON 24
 eO_5                 3.099117e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145067e-01 1 1  ON 27
 eO_8                 2.812300e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823621e-01 1 1  ON 30
eH1_1                -1.032388e-01 1 1  ON 31
eH1_2                -6.262438e-02 1 1  ON 32
eH1_3                -2.603721e-02 1 1  ON 33
eH1_4                 1.963214e-02 1 1  ON 34
eH1_5                 3.545141e-02 1 1  ON 35
eH1_6                 7.780062e-02 1 1  ON 36
eH1_7                 1.094645e-01 1 1  ON 37
eH1_8                 9.182224e-02 1 1  ON 38
eH1_9                 2.460270e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858017e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894993e-02 1 1  ON 46
eH2_7                 1.130484e-01 1 1  ON 47
eH2_8                 9.478590e-02 1 1  ON 48
eH2_9                 2.677439e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.346284
====================================================
  Execution time = 2.0281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2207e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322051413161
                                         uncertainty =       0.005002739990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322051413161
                                         uncertainty =       0.005002739990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401294191
  error estimate for blocks of size 2^( 2) =       0.000411264170
  error estimate for blocks of size 2^( 3) =       0.000420283132
  error estimate for blocks of size 2^( 4) =       0.000426265177
  error estimate for blocks of size 2^( 5) =       0.000430520933
  error estimate for blocks of size 2^( 6) =       0.000433654212
  error estimate for blocks of size 2^( 7) =       0.000437485848

      target function =                  N/A
              le_mean =     -17.216477740698
             les_mean =     296.729179690787
             stat err =       0.000431981543
             autocorr =       1.158789723462
              std dev =       0.567515687786
             le_variance =       0.322074055883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647774070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216477740698       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477741637       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216477741030       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216477741593       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216477741039       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216477741814       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216477741752       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 5.991616e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216477740698       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477740933       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216477740781       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216477740922       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216477740784       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216477740977       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216477740961       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.497967e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216477740698       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216477740756       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216477740719       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216477740749       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216477740718       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216477740796       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216477740758       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 3.744955e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069434 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5800e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.092218e-01 1 1  ON 0
 uu_1                 4.761357e-02 1 1  ON 1
 uu_2                -4.617544e-02 1 1  ON 2
 uu_3                -1.001518e-01 1 1  ON 3
 uu_4                -1.323160e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138875e-01 1 1  ON 6
 uu_7                -4.025729e-02 1 1  ON 7
 uu_8                 9.812500e-02 1 1  ON 8
 uu_9                 1.216105e-01 1 1  ON 9
 ud_0                 3.503498e-01 1 1  ON 10
 ud_1                 9.237090e-02 1 1  ON 11
 ud_2                -1.610662e-02 1 1  ON 12
 ud_3                -7.565957e-02 1 1  ON 13
 ud_4                -1.220655e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546803e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253701e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595252e-01 1 1  ON 20
 eO_1                -4.422059e-01 1 1  ON 21
 eO_2                -3.901405e-02 1 1  ON 22
 eO_3                 2.099526e-01 1 1  ON 23
 eO_4                 2.965981e-01 1 1  ON 24
 eO_5                 3.099118e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145067e-01 1 1  ON 27
 eO_8                 2.812300e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823621e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262439e-02 1 1  ON 32
eH1_3                -2.603717e-02 1 1  ON 33
eH1_4                 1.963214e-02 1 1  ON 34
eH1_5                 3.545140e-02 1 1  ON 35
eH1_6                 7.780063e-02 1 1  ON 36
eH1_7                 1.094645e-01 1 1  ON 37
eH1_8                 9.182226e-02 1 1  ON 38
eH1_9                 2.460271e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858015e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894993e-02 1 1  ON 46
eH2_7                 1.130484e-01 1 1  ON 47
eH2_8                 9.478591e-02 1 1  ON 48
eH2_9                 2.677440e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1935
    reference variance = 0.212419
====================================================
  Execution time = 1.9823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2286e-01
  Total weights = 2.0000e+06
  Execution time = 1.8187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952039876
                                         uncertainty =       0.006577639232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952039876
                                         uncertainty =       0.006577639232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401780604
  error estimate for blocks of size 2^( 2) =       0.000411658770
  error estimate for blocks of size 2^( 3) =       0.000420199031
  error estimate for blocks of size 2^( 4) =       0.000426300058
  error estimate for blocks of size 2^( 5) =       0.000430497663
  error estimate for blocks of size 2^( 6) =       0.000434312008
  error estimate for blocks of size 2^( 7) =       0.000434767629

      target function =                  N/A
              le_mean =     -17.216602941261
             les_mean =     296.734271982595
             stat err =       0.000431469340
             autocorr =       1.153245970927
              std dev =       0.568203578836
             le_variance =       0.322855307002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952107762
                                         uncertainty =       0.006577638683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952107762
                                         uncertainty =       0.006577638683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401780646
  error estimate for blocks of size 2^( 2) =       0.000411658809
  error estimate for blocks of size 2^( 3) =       0.000420199066
  error estimate for blocks of size 2^( 4) =       0.000426300091
  error estimate for blocks of size 2^( 5) =       0.000430497694
  error estimate for blocks of size 2^( 6) =       0.000434312043
  error estimate for blocks of size 2^( 7) =       0.000434767665

      target function =                  N/A
              le_mean =     -17.216602941359
             les_mean =     296.734272053841
             stat err =       0.000431469373
             autocorr =       1.153245906997
              std dev =       0.568203638536
             le_variance =       0.322855374846

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952073812
                                         uncertainty =       0.006577638957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952073812
                                         uncertainty =       0.006577638957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401780625
  error estimate for blocks of size 2^( 2) =       0.000411658789
  error estimate for blocks of size 2^( 3) =       0.000420199048
  error estimate for blocks of size 2^( 4) =       0.000426300074
  error estimate for blocks of size 2^( 5) =       0.000430497678
  error estimate for blocks of size 2^( 6) =       0.000434312025
  error estimate for blocks of size 2^( 7) =       0.000434767647

      target function =                  N/A
              le_mean =     -17.216602941310
             les_mean =     296.734272018206
             stat err =       0.000431469356
             autocorr =       1.153245938972
              std dev =       0.568203608680
             le_variance =       0.322855340917

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952044118
                                         uncertainty =       0.006577639197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952044118
                                         uncertainty =       0.006577639197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401780606
  error estimate for blocks of size 2^( 2) =       0.000411658772
  error estimate for blocks of size 2^( 3) =       0.000420199033
  error estimate for blocks of size 2^( 4) =       0.000426300060
  error estimate for blocks of size 2^( 5) =       0.000430497665
  error estimate for blocks of size 2^( 6) =       0.000434312011
  error estimate for blocks of size 2^( 7) =       0.000434767631

      target function =                  N/A
              le_mean =     -17.216602941267
             les_mean =     296.734271987046
             stat err =       0.000431469342
             autocorr =       1.153245966939
              std dev =       0.568203582566
             le_variance =       0.322855311241


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216602941261        initial
     9.5367e+02     9.5367e+03             5.9916e-07       -17.216602941359  <--
     3.8147e+03     3.8147e+04             1.4980e-07       -17.216602941310
     1.5259e+04     1.5259e+05             3.7450e-08       -17.216602941267

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 2.9045e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761365e-02 1 1  ON 1
 uu_2                -4.617536e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138876e-01 1 1  ON 6
 uu_7                -4.025743e-02 1 1  ON 7
 uu_8                 9.812492e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237101e-02 1 1  ON 11
 ud_2                -1.610656e-02 1 1  ON 12
 ud_3                -7.565965e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253601e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595257e-01 1 1  ON 20
 eO_1                -4.422062e-01 1 1  ON 21
 eO_2                -3.901418e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965985e-01 1 1  ON 24
 eO_5                 3.099119e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812301e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262443e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963213e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182229e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858010e-02 1 1  ON 44
eH2_5                 3.400757e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478596e-02 1 1  ON 48
eH2_9                 2.677441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1482
    reference variance = 0.178183
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3125e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331326603687
                                         uncertainty =       0.010052494272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331326603687
                                         uncertainty =       0.010052494272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406968674
  error estimate for blocks of size 2^( 2) =       0.000416403030
  error estimate for blocks of size 2^( 3) =       0.000425148536
  error estimate for blocks of size 2^( 4) =       0.000431936285
  error estimate for blocks of size 2^( 5) =       0.000435033559
  error estimate for blocks of size 2^( 6) =       0.000437902872
  error estimate for blocks of size 2^( 7) =       0.000441242338

      target function =                  N/A
              le_mean =     -17.216636383036
             les_mean =     296.743815183939
             stat err =       0.000436528763
             autocorr =       1.150545417401
              std dev =       0.575540618780
             le_variance =       0.331247003866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721663638304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216636383036       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216636384121       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216636384428       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216636385725       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216636391100       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216636391501       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216636392331       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216636392248       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 2.335160e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216636383036       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216636383308       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216636383384       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216636383708       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216636385051       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216636385152       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216636385359       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216636385340       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 5.838015e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216636383036       residual = 5.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216636383104       residual = 5.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216636383123       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216636383206       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216636383540       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216636383564       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216636383616       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216636383609       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.459511e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.072230 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5778e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.092221e-01 1 1  ON 0
 uu_1                 4.761372e-02 1 1  ON 1
 uu_2                -4.617533e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378897e-01 1 1  ON 5
 uu_6                -1.138878e-01 1 1  ON 6
 uu_7                -4.025758e-02 1 1  ON 7
 uu_8                 9.812486e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503501e-01 1 1  ON 10
 ud_1                 9.237110e-02 1 1  ON 11
 ud_2                -1.610646e-02 1 1  ON 12
 ud_3                -7.565977e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100050e-01 1 1  ON 17
 ud_8                 2.253516e-03 1 1  ON 18
 ud_9                 9.256143e-02 1 1  ON 19
 eO_0                -7.595263e-01 1 1  ON 20
 eO_1                -4.422068e-01 1 1  ON 21
 eO_2                -3.901432e-02 1 1  ON 22
 eO_3                 2.099531e-01 1 1  ON 23
 eO_4                 2.965991e-01 1 1  ON 24
 eO_5                 3.099121e-01 1 1  ON 25
 eO_6                 2.523013e-01 1 1  ON 26
 eO_7                 1.145069e-01 1 1  ON 27
 eO_8                 2.812304e-02 1 1  ON 28
 eO_9                 1.855299e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032391e-01 1 1  ON 31
eH1_2                -6.262440e-02 1 1  ON 32
eH1_3                -2.603693e-02 1 1  ON 33
eH1_4                 1.963207e-02 1 1  ON 34
eH1_5                 3.545135e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182236e-02 1 1  ON 38
eH1_9                 2.460275e-02 1 1  ON 39
eH2_0                -1.831672e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371441e-02 1 1  ON 42
eH2_3                -2.701384e-02 1 1  ON 43
eH2_4                 1.857994e-02 1 1  ON 44
eH2_5                 3.400768e-02 1 1  ON 45
eH2_6                 7.894993e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478602e-02 1 1  ON 48
eH2_9                 2.677443e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.237603
====================================================
  Execution time = 2.0091e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2146e-01
  Total weights = 2.0000e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441366596
                                         uncertainty =       0.007657475517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441366596
                                         uncertainty =       0.007657475517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400909967
  error estimate for blocks of size 2^( 2) =       0.000410258436
  error estimate for blocks of size 2^( 3) =       0.000419478414
  error estimate for blocks of size 2^( 4) =       0.000426430092
  error estimate for blocks of size 2^( 5) =       0.000431153074
  error estimate for blocks of size 2^( 6) =       0.000434419936
  error estimate for blocks of size 2^( 7) =       0.000436198781

      target function =                  N/A
              le_mean =     -17.216468096050
             les_mean =     296.728231144079
             stat err =       0.000432050471
             autocorr =       1.161382452391
              std dev =       0.566972311921
             le_variance =       0.321457602485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441545516
                                         uncertainty =       0.007657459939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441545516
                                         uncertainty =       0.007657459939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400910078
  error estimate for blocks of size 2^( 2) =       0.000410258539
  error estimate for blocks of size 2^( 3) =       0.000419478508
  error estimate for blocks of size 2^( 4) =       0.000426430183
  error estimate for blocks of size 2^( 5) =       0.000431153168
  error estimate for blocks of size 2^( 6) =       0.000434420031
  error estimate for blocks of size 2^( 7) =       0.000436198897

      target function =                  N/A
              le_mean =     -17.216468091818
             les_mean =     296.728231177946
             stat err =       0.000432050570
             autocorr =       1.161382335121
              std dev =       0.566972470304
             le_variance =       0.321457782083

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441455940
                                         uncertainty =       0.007657467716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441455940
                                         uncertainty =       0.007657467716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400910022
  error estimate for blocks of size 2^( 2) =       0.000410258487
  error estimate for blocks of size 2^( 3) =       0.000419478461
  error estimate for blocks of size 2^( 4) =       0.000426430137
  error estimate for blocks of size 2^( 5) =       0.000431153121
  error estimate for blocks of size 2^( 6) =       0.000434419984
  error estimate for blocks of size 2^( 7) =       0.000436198839

      target function =                  N/A
              le_mean =     -17.216468093932
             les_mean =     296.728231160812
             stat err =       0.000432050520
             autocorr =       1.161382393997
              std dev =       0.566972391010
             le_variance =       0.321457692168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441377760
                                         uncertainty =       0.007657474542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321441377760
                                         uncertainty =       0.007657474542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400909973
  error estimate for blocks of size 2^( 2) =       0.000410258443
  error estimate for blocks of size 2^( 3) =       0.000419478420
  error estimate for blocks of size 2^( 4) =       0.000426430098
  error estimate for blocks of size 2^( 5) =       0.000431153080
  error estimate for blocks of size 2^( 6) =       0.000434419942
  error estimate for blocks of size 2^( 7) =       0.000436198789

      target function =                  N/A
              le_mean =     -17.216468095785
             les_mean =     296.728231146162
             stat err =       0.000432050477
             autocorr =       1.161382445091
              std dev =       0.566972321803
             le_variance =       0.321457613691


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216468096050        initial  <--
     2.3842e+02     2.3842e+03             2.3352e-06       -17.216468091818
     9.5367e+02     9.5367e+03             5.8380e-07       -17.216468093932
     3.8147e+03     3.8147e+04             1.4595e-07       -17.216468095785

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2923
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761365e-02 1 1  ON 1
 uu_2                -4.617536e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138876e-01 1 1  ON 6
 uu_7                -4.025743e-02 1 1  ON 7
 uu_8                 9.812492e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237101e-02 1 1  ON 11
 ud_2                -1.610656e-02 1 1  ON 12
 ud_3                -7.565965e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253601e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595257e-01 1 1  ON 20
 eO_1                -4.422062e-01 1 1  ON 21
 eO_2                -3.901418e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965985e-01 1 1  ON 24
 eO_5                 3.099119e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812301e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262443e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963213e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182229e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858010e-02 1 1  ON 44
eH2_5                 3.400757e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478596e-02 1 1  ON 48
eH2_9                 2.677441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5076e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2247
    reference variance = 0.314044
====================================================
  Execution time = 2.0226e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1400e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314075254532
                                         uncertainty =       0.003269519703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314075254532
                                         uncertainty =       0.003269519703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396230564
  error estimate for blocks of size 2^( 2) =       0.000405885939
  error estimate for blocks of size 2^( 3) =       0.000414979734
  error estimate for blocks of size 2^( 4) =       0.000421557535
  error estimate for blocks of size 2^( 5) =       0.000424962980
  error estimate for blocks of size 2^( 6) =       0.000428679183
  error estimate for blocks of size 2^( 7) =       0.000429752503

      target function =                  N/A
              le_mean =     -17.216428363683
             les_mean =     296.719402763781
             stat err =       0.000426238050
             autocorr =       1.157200170739
              std dev =       0.560354636767
             le_variance =       0.313997318946


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721642836368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216428363683       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216428364053       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216428364227       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216428364251       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216428364177       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216428364394       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216428364402       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 2.591442e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216428363683       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216428363776       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216428363819       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216428363826       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216428363807       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216428363862       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216428363827       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 6.478641e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216428363683       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216428363706       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216428363717       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216428363719       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216428363724       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216428363745       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216428363740       residual = 5.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.619662e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074480 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5800e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761366e-02 1 1  ON 1
 uu_2                -4.617536e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138876e-01 1 1  ON 6
 uu_7                -4.025744e-02 1 1  ON 7
 uu_8                 9.812492e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237102e-02 1 1  ON 11
 ud_2                -1.610656e-02 1 1  ON 12
 ud_3                -7.565965e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253593e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595257e-01 1 1  ON 20
 eO_1                -4.422062e-01 1 1  ON 21
 eO_2                -3.901420e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965986e-01 1 1  ON 24
 eO_5                 3.099119e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812301e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603708e-02 1 1  ON 33
eH1_4                 1.963214e-02 1 1  ON 34
eH1_5                 3.545136e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182230e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701387e-02 1 1  ON 43
eH2_4                 1.858010e-02 1 1  ON 44
eH2_5                 3.400757e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478597e-02 1 1  ON 48
eH2_9                 2.677441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1671
    reference variance = 0.189586
====================================================
  Execution time = 1.9755e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2467e-01
  Total weights = 2.0000e+06
  Execution time = 1.8236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458340845
                                         uncertainty =       0.008280640471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458340845
                                         uncertainty =       0.008280640471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402908274
  error estimate for blocks of size 2^( 2) =       0.000412354103
  error estimate for blocks of size 2^( 3) =       0.000421779309
  error estimate for blocks of size 2^( 4) =       0.000428214725
  error estimate for blocks of size 2^( 5) =       0.000433264739
  error estimate for blocks of size 2^( 6) =       0.000435888851
  error estimate for blocks of size 2^( 7) =       0.000436378694

      target function =                  N/A
              le_mean =     -17.215796760585
             les_mean =     296.708328093187
             stat err =       0.000433436752
             autocorr =       1.157281727503
              std dev =       0.569798344799
             le_variance =       0.324670153736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458382769
                                         uncertainty =       0.008280641560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458382769
                                         uncertainty =       0.008280641560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402908300
  error estimate for blocks of size 2^( 2) =       0.000412354128
  error estimate for blocks of size 2^( 3) =       0.000421779332
  error estimate for blocks of size 2^( 4) =       0.000428214748
  error estimate for blocks of size 2^( 5) =       0.000433264761
  error estimate for blocks of size 2^( 6) =       0.000435888875
  error estimate for blocks of size 2^( 7) =       0.000436378716

      target function =                  N/A
              le_mean =     -17.215796760466
             les_mean =     296.708328131098
             stat err =       0.000433436775
             autocorr =       1.157281697907
              std dev =       0.569798381679
             le_variance =       0.324670195764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458361807
                                         uncertainty =       0.008280641016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458361807
                                         uncertainty =       0.008280641016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402908287
  error estimate for blocks of size 2^( 2) =       0.000412354115
  error estimate for blocks of size 2^( 3) =       0.000421779321
  error estimate for blocks of size 2^( 4) =       0.000428214736
  error estimate for blocks of size 2^( 5) =       0.000433264750
  error estimate for blocks of size 2^( 6) =       0.000435888863
  error estimate for blocks of size 2^( 7) =       0.000436378705

      target function =                  N/A
              le_mean =     -17.215796760526
             les_mean =     296.708328112142
             stat err =       0.000433436763
             autocorr =       1.157281712704
              std dev =       0.569798363240
             le_variance =       0.324670174751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458343465
                                         uncertainty =       0.008280640539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324458343465
                                         uncertainty =       0.008280640539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402908275
  error estimate for blocks of size 2^( 2) =       0.000412354105
  error estimate for blocks of size 2^( 3) =       0.000421779310
  error estimate for blocks of size 2^( 4) =       0.000428214727
  error estimate for blocks of size 2^( 5) =       0.000433264740
  error estimate for blocks of size 2^( 6) =       0.000435888853
  error estimate for blocks of size 2^( 7) =       0.000436378695

      target function =                  N/A
              le_mean =     -17.215796760578
             les_mean =     296.708328095556
             stat err =       0.000433436754
             autocorr =       1.157281725637
              std dev =       0.569798347105
             le_variance =       0.324670156363


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215796760585        initial  <--
     2.3842e+03     2.3842e+04             2.5914e-07       -17.215796760466
     9.5367e+03     9.5367e+04             6.4786e-08       -17.215796760526
     3.8147e+04     3.8147e+05             1.6197e-08       -17.215796760578

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9873
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761365e-02 1 1  ON 1
 uu_2                -4.617536e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138876e-01 1 1  ON 6
 uu_7                -4.025743e-02 1 1  ON 7
 uu_8                 9.812492e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237101e-02 1 1  ON 11
 ud_2                -1.610656e-02 1 1  ON 12
 ud_3                -7.565965e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253601e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595257e-01 1 1  ON 20
 eO_1                -4.422062e-01 1 1  ON 21
 eO_2                -3.901418e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965985e-01 1 1  ON 24
 eO_5                 3.099119e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812301e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262443e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963213e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182229e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858010e-02 1 1  ON 44
eH2_5                 3.400757e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478596e-02 1 1  ON 48
eH2_9                 2.677441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4793e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.187893
====================================================
  Execution time = 2.0267e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1405e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314085342775
                                         uncertainty =       0.002905640134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314085342775
                                         uncertainty =       0.002905640134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396262231
  error estimate for blocks of size 2^( 2) =       0.000405871312
  error estimate for blocks of size 2^( 3) =       0.000415147929
  error estimate for blocks of size 2^( 4) =       0.000421410574
  error estimate for blocks of size 2^( 5) =       0.000425352736
  error estimate for blocks of size 2^( 6) =       0.000427278042
  error estimate for blocks of size 2^( 7) =       0.000429700757

      target function =                  N/A
              le_mean =     -17.216516403597
             les_mean =     296.722484429342
             stat err =       0.000425935527
             autocorr =       1.155373420020
              std dev =       0.560399420992
             le_variance =       0.314047511048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721651640360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516403597       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216516403586       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216516403600       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216516403629       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216516403653       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216516403633       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216516403647       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216516403642       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.414258e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516403597       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216516403594       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216516403598       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216516403605       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216516403612       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216516403593       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216516403546       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216516403615       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 6.035647e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216516403597       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216516403596       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216516403597       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216516403599       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216516403614       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216516403587       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216516403676       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216516403379       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.508912e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.077125 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5815e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761365e-02 1 1  ON 1
 uu_2                -4.617536e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138876e-01 1 1  ON 6
 uu_7                -4.025743e-02 1 1  ON 7
 uu_8                 9.812492e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237101e-02 1 1  ON 11
 ud_2                -1.610656e-02 1 1  ON 12
 ud_3                -7.565965e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100048e-01 1 1  ON 17
 ud_8                 2.253600e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595257e-01 1 1  ON 20
 eO_1                -4.422062e-01 1 1  ON 21
 eO_2                -3.901418e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965985e-01 1 1  ON 24
 eO_5                 3.099119e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812301e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963213e-02 1 1  ON 34
eH1_5                 3.545136e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182229e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858010e-02 1 1  ON 44
eH2_5                 3.400757e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478596e-02 1 1  ON 48
eH2_9                 2.677441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1708
    reference variance = 0.182234
====================================================
  Execution time = 2.0035e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2602e-01
  Total weights = 2.0000e+06
  Execution time = 1.8239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129233667
                                         uncertainty =       0.006386713612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129233667
                                         uncertainty =       0.006386713612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403745561
  error estimate for blocks of size 2^( 2) =       0.000413179865
  error estimate for blocks of size 2^( 3) =       0.000421690020
  error estimate for blocks of size 2^( 4) =       0.000427672405
  error estimate for blocks of size 2^( 5) =       0.000431546846
  error estimate for blocks of size 2^( 6) =       0.000433755491
  error estimate for blocks of size 2^( 7) =       0.000435428078

      target function =                  N/A
              le_mean =     -17.216348284971
             les_mean =     296.728669063067
             stat err =       0.000432100705
             autocorr =       1.145392746533
              std dev =       0.570982448652
             le_variance =       0.326020956668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129232834
                                         uncertainty =       0.006386713680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129232834
                                         uncertainty =       0.006386713680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403745561
  error estimate for blocks of size 2^( 2) =       0.000413179864
  error estimate for blocks of size 2^( 3) =       0.000421690020
  error estimate for blocks of size 2^( 4) =       0.000427672405
  error estimate for blocks of size 2^( 5) =       0.000431546845
  error estimate for blocks of size 2^( 6) =       0.000433755490
  error estimate for blocks of size 2^( 7) =       0.000435428078

      target function =                  N/A
              le_mean =     -17.216348284998
             les_mean =     296.728669063174
             stat err =       0.000432100704
             autocorr =       1.145392745216
              std dev =       0.570982447922
             le_variance =       0.326020955835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129233251
                                         uncertainty =       0.006386713646

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129233251
                                         uncertainty =       0.006386713646

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403745561
  error estimate for blocks of size 2^( 2) =       0.000413179864
  error estimate for blocks of size 2^( 3) =       0.000421690020
  error estimate for blocks of size 2^( 4) =       0.000427672405
  error estimate for blocks of size 2^( 5) =       0.000431546846
  error estimate for blocks of size 2^( 6) =       0.000433755491
  error estimate for blocks of size 2^( 7) =       0.000435428078

      target function =                  N/A
              le_mean =     -17.216348284984
             les_mean =     296.728669063120
             stat err =       0.000432100705
             autocorr =       1.145392745881
              std dev =       0.570982448287
             le_variance =       0.326020956252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129233615
                                         uncertainty =       0.006386713617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326129233615
                                         uncertainty =       0.006386713617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403745561
  error estimate for blocks of size 2^( 2) =       0.000413179865
  error estimate for blocks of size 2^( 3) =       0.000421690020
  error estimate for blocks of size 2^( 4) =       0.000427672405
  error estimate for blocks of size 2^( 5) =       0.000431546846
  error estimate for blocks of size 2^( 6) =       0.000433755491
  error estimate for blocks of size 2^( 7) =       0.000435428078

      target function =                  N/A
              le_mean =     -17.216348284972
             les_mean =     296.728669063073
             stat err =       0.000432100705
             autocorr =       1.145392746454
              std dev =       0.570982448606
             le_variance =       0.326020956616


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216348284971        initial
     2.3842e+04     2.3842e+05             2.4143e-08       -17.216348284998  <--
     9.5367e+04     9.5367e+05             6.0356e-09       -17.216348284984
     3.8147e+05     3.8147e+06             1.5089e-09       -17.216348284972

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.9280e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761365e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138876e-01 1 1  ON 6
 uu_7                -4.025744e-02 1 1  ON 7
 uu_8                 9.812492e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237102e-02 1 1  ON 11
 ud_2                -1.610656e-02 1 1  ON 12
 ud_3                -7.565965e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253597e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595257e-01 1 1  ON 20
 eO_1                -4.422062e-01 1 1  ON 21
 eO_2                -3.901419e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965986e-01 1 1  ON 24
 eO_5                 3.099119e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812301e-02 1 1  ON 28
 eO_9                 1.855297e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963213e-02 1 1  ON 34
eH1_5                 3.545136e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182229e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858010e-02 1 1  ON 44
eH2_5                 3.400757e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478597e-02 1 1  ON 48
eH2_9                 2.677441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5101e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1796
    reference variance = 0.233678
====================================================
  Execution time = 2.0311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1326e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313193818443
                                         uncertainty =       0.002447061854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313193818443
                                         uncertainty =       0.002447061854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395763768
  error estimate for blocks of size 2^( 2) =       0.000405628712
  error estimate for blocks of size 2^( 3) =       0.000414242011
  error estimate for blocks of size 2^( 4) =       0.000420403939
  error estimate for blocks of size 2^( 5) =       0.000423885778
  error estimate for blocks of size 2^( 6) =       0.000424773626
  error estimate for blocks of size 2^( 7) =       0.000426537530

      target function =                  N/A
              le_mean =     -17.216797859455
             les_mean =     296.731386296258
             stat err =       0.000423900218
             autocorr =       1.147242471767
              std dev =       0.559694487678
             le_variance =       0.313257919537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679785946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216797859455       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216797859506       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216797859773       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216797859943       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216797859889       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216797859869       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216797859913       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 9.950155e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216797859455       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216797859468       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216797859535       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216797859578       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216797859558       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216797859562       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216797859574       residual = 7.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.487561e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216797859455       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216797859459       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216797859475       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216797859486       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216797859505       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216797859461       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216797859485       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 6.218916e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079392 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5929e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761366e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138876e-01 1 1  ON 6
 uu_7                -4.025745e-02 1 1  ON 7
 uu_8                 9.812492e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237102e-02 1 1  ON 11
 ud_2                -1.610656e-02 1 1  ON 12
 ud_3                -7.565965e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253593e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595257e-01 1 1  ON 20
 eO_1                -4.422062e-01 1 1  ON 21
 eO_2                -3.901419e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965986e-01 1 1  ON 24
 eO_5                 3.099119e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812301e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963213e-02 1 1  ON 34
eH1_5                 3.545136e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182230e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858009e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478597e-02 1 1  ON 48
eH2_9                 2.677441e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1978
    reference variance = 0.224395
====================================================
  Execution time = 2.1944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1898e-01
  Total weights = 2.0000e+06
  Execution time = 1.8273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018512886
                                         uncertainty =       0.006818043884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018512886
                                         uncertainty =       0.006818043884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399360353
  error estimate for blocks of size 2^( 2) =       0.000409113104
  error estimate for blocks of size 2^( 3) =       0.000418320546
  error estimate for blocks of size 2^( 4) =       0.000424975880
  error estimate for blocks of size 2^( 5) =       0.000428652942
  error estimate for blocks of size 2^( 6) =       0.000430724166
  error estimate for blocks of size 2^( 7) =       0.000431530209

      target function =                  N/A
              le_mean =     -17.216674004530
             les_mean =     296.732841001395
             stat err =       0.000428970799
             autocorr =       1.153786798786
              std dev =       0.564780827065
             le_variance =       0.318977382621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018501684
                                         uncertainty =       0.006818043312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018501684
                                         uncertainty =       0.006818043312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399360346
  error estimate for blocks of size 2^( 2) =       0.000409113097
  error estimate for blocks of size 2^( 3) =       0.000418320539
  error estimate for blocks of size 2^( 4) =       0.000424975873
  error estimate for blocks of size 2^( 5) =       0.000428652935
  error estimate for blocks of size 2^( 6) =       0.000430724160
  error estimate for blocks of size 2^( 7) =       0.000431530202

      target function =                  N/A
              le_mean =     -17.216674004656
             les_mean =     296.732840994508
             stat err =       0.000428970792
             autocorr =       1.153786802018
              std dev =       0.564780817143
             le_variance =       0.318977371413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018507285
                                         uncertainty =       0.006818043598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018507285
                                         uncertainty =       0.006818043598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399360349
  error estimate for blocks of size 2^( 2) =       0.000409113100
  error estimate for blocks of size 2^( 3) =       0.000418320542
  error estimate for blocks of size 2^( 4) =       0.000424975876
  error estimate for blocks of size 2^( 5) =       0.000428652938
  error estimate for blocks of size 2^( 6) =       0.000430724163
  error estimate for blocks of size 2^( 7) =       0.000431530206

      target function =                  N/A
              le_mean =     -17.216674004593
             les_mean =     296.732840997951
             stat err =       0.000428970796
             autocorr =       1.153786800396
              std dev =       0.564780822104
             le_variance =       0.318977377016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018512186
                                         uncertainty =       0.006818043849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319018512186
                                         uncertainty =       0.006818043849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399360352
  error estimate for blocks of size 2^( 2) =       0.000409113103
  error estimate for blocks of size 2^( 3) =       0.000418320545
  error estimate for blocks of size 2^( 4) =       0.000424975879
  error estimate for blocks of size 2^( 5) =       0.000428652941
  error estimate for blocks of size 2^( 6) =       0.000430724166
  error estimate for blocks of size 2^( 7) =       0.000431530209

      target function =                  N/A
              le_mean =     -17.216674004538
             les_mean =     296.732841000965
             stat err =       0.000428970799
             autocorr =       1.153786798988
              std dev =       0.564780826445
             le_variance =       0.318977381920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216674004530        initial
     5.9605e+03     5.9605e+04             9.9502e-08       -17.216674004656  <--
     2.3842e+04     2.3842e+05             2.4876e-08       -17.216674004593
     9.5367e+04     9.5367e+05             6.2189e-09       -17.216674004538

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 3.1209e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610655e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253579e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901421e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2252
    reference variance = 0.322648
====================================================
  Execution time = 2.0208e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1491e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314913204387
                                         uncertainty =       0.004990404672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314913204387
                                         uncertainty =       0.004990404672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396804371
  error estimate for blocks of size 2^( 2) =       0.000406372376
  error estimate for blocks of size 2^( 3) =       0.000415367177
  error estimate for blocks of size 2^( 4) =       0.000421523927
  error estimate for blocks of size 2^( 5) =       0.000426438303
  error estimate for blocks of size 2^( 6) =       0.000428717771
  error estimate for blocks of size 2^( 7) =       0.000432179789

      target function =                  N/A
              le_mean =     -17.216733719015
             les_mean =     296.730827212095
             stat err =       0.000427214948
             autocorr =       1.159150918605
              std dev =       0.561166123430
             le_variance =       0.314907418086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721673371901e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733719015       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733719826       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733719650       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733719917       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733719645       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733720050       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733720446       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 3.992624e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733719015       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733719218       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733719174       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733719240       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733719172       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733719274       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733719388       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 9.981750e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216733719015       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733719066       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733719055       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733719071       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216733719058       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216733719069       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216733719084       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 2.495449e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5702e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761370e-02 1 1  ON 1
 uu_2                -4.617533e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025750e-02 1 1  ON 7
 uu_8                 9.812490e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237107e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253560e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595259e-01 1 1  ON 20
 eO_1                -4.422064e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099529e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182232e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701387e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894990e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2225
    reference variance = 0.389396
====================================================
  Execution time = 1.9668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1880e-01
  Total weights = 2.0000e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812343837
                                         uncertainty =       0.003792137870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812343837
                                         uncertainty =       0.003792137870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252294
  error estimate for blocks of size 2^( 2) =       0.000409223047
  error estimate for blocks of size 2^( 3) =       0.000417382241
  error estimate for blocks of size 2^( 4) =       0.000424037687
  error estimate for blocks of size 2^( 5) =       0.000427572634
  error estimate for blocks of size 2^( 6) =       0.000429526965
  error estimate for blocks of size 2^( 7) =       0.000432020369

      target function =                  N/A
              le_mean =     -17.216750028043
             les_mean =     296.735286157094
             stat err =       0.000428289414
             autocorr =       1.150746968342
              std dev =       0.564628008859
             le_variance =       0.318804788388

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812383654
                                         uncertainty =       0.003792138463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812383654
                                         uncertainty =       0.003792138463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252319
  error estimate for blocks of size 2^( 2) =       0.000409223070
  error estimate for blocks of size 2^( 3) =       0.000417382261
  error estimate for blocks of size 2^( 4) =       0.000424037704
  error estimate for blocks of size 2^( 5) =       0.000427572651
  error estimate for blocks of size 2^( 6) =       0.000429526980
  error estimate for blocks of size 2^( 7) =       0.000432020382

      target function =                  N/A
              le_mean =     -17.216750027884
             les_mean =     296.735286191480
             stat err =       0.000428289429
             autocorr =       1.150746908311
              std dev =       0.564628044137
             le_variance =       0.318804828226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812363741
                                         uncertainty =       0.003792138167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812363741
                                         uncertainty =       0.003792138167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252306
  error estimate for blocks of size 2^( 2) =       0.000409223059
  error estimate for blocks of size 2^( 3) =       0.000417382251
  error estimate for blocks of size 2^( 4) =       0.000424037696
  error estimate for blocks of size 2^( 5) =       0.000427572643
  error estimate for blocks of size 2^( 6) =       0.000429526973
  error estimate for blocks of size 2^( 7) =       0.000432020375

      target function =                  N/A
              le_mean =     -17.216750027964
             les_mean =     296.735286174282
             stat err =       0.000428289421
             autocorr =       1.150746938324
              std dev =       0.564628026494
             le_variance =       0.318804808303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812346325
                                         uncertainty =       0.003792137907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318812346325
                                         uncertainty =       0.003792137907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399252295
  error estimate for blocks of size 2^( 2) =       0.000409223049
  error estimate for blocks of size 2^( 3) =       0.000417382242
  error estimate for blocks of size 2^( 4) =       0.000424037688
  error estimate for blocks of size 2^( 5) =       0.000427572635
  error estimate for blocks of size 2^( 6) =       0.000429526966
  error estimate for blocks of size 2^( 7) =       0.000432020369

      target function =                  N/A
              le_mean =     -17.216750028033
             les_mean =     296.735286159242
             stat err =       0.000428289415
             autocorr =       1.150746964580
              std dev =       0.564628011063
             le_variance =       0.318804790877


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216750028043        initial  <--
     1.4901e+03     1.4901e+04             3.9926e-07       -17.216750027884
     5.9605e+03     5.9605e+04             9.9818e-08       -17.216750027964
     2.3842e+04     2.3842e+05             2.4954e-08       -17.216750028033

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8837
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610655e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253579e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901421e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.0712
    reference variance = 0.235052
====================================================
  Execution time = 2.0275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3933e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5061e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339361163344
                                         uncertainty =       0.014376003109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339361163344
                                         uncertainty =       0.014376003109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411902656
  error estimate for blocks of size 2^( 2) =       0.000421103197
  error estimate for blocks of size 2^( 3) =       0.000428944619
  error estimate for blocks of size 2^( 4) =       0.000435092898
  error estimate for blocks of size 2^( 5) =       0.000438346354
  error estimate for blocks of size 2^( 6) =       0.000440006776
  error estimate for blocks of size 2^( 7) =       0.000439679566

      target function =                  N/A
              le_mean =     -17.216862868290
             les_mean =     296.759694452177
             stat err =       0.000438281399
             autocorr =       1.132183685779
              std dev =       0.582518322737
             le_variance =       0.339327596325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721686286829e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862868290       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216862868261       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216862868281       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216862868278       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216862868324       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216862868345       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216862868349       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 3.805935e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862868290       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216862868283       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216862868288       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216862868287       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216862868300       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216862868278       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216862868298       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 9.514850e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216862868290       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216862868289       residual = 9.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216862868290       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216862868290       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216862868292       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216862868400       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216862868295       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 2.378714e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083880 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5792e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253576e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.288479
====================================================
  Execution time = 1.9915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1613e-01
  Total weights = 2.0000e+06
  Execution time = 1.8287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157393567
                                         uncertainty =       0.004910414938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157393567
                                         uncertainty =       0.004910414938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397572403
  error estimate for blocks of size 2^( 2) =       0.000407865357
  error estimate for blocks of size 2^( 3) =       0.000416588591
  error estimate for blocks of size 2^( 4) =       0.000423455472
  error estimate for blocks of size 2^( 5) =       0.000428181947
  error estimate for blocks of size 2^( 6) =       0.000430717094
  error estimate for blocks of size 2^( 7) =       0.000431556317

      target function =                  N/A
              le_mean =     -17.215754472953
             les_mean =     296.698329546047
             stat err =       0.000428477707
             autocorr =       1.161512804893
              std dev =       0.562252284209
             le_variance =       0.316127631098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157385678
                                         uncertainty =       0.004910414862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157385678
                                         uncertainty =       0.004910414862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397572398
  error estimate for blocks of size 2^( 2) =       0.000407865353
  error estimate for blocks of size 2^( 3) =       0.000416588587
  error estimate for blocks of size 2^( 4) =       0.000423455467
  error estimate for blocks of size 2^( 5) =       0.000428181942
  error estimate for blocks of size 2^( 6) =       0.000430717089
  error estimate for blocks of size 2^( 7) =       0.000431556311

      target function =                  N/A
              le_mean =     -17.215754472916
             les_mean =     296.698329536880
             stat err =       0.000428477702
             autocorr =       1.161512806299
              std dev =       0.562252277200
             le_variance =       0.316127623216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157389622
                                         uncertainty =       0.004910414900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157389622
                                         uncertainty =       0.004910414900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397572400
  error estimate for blocks of size 2^( 2) =       0.000407865355
  error estimate for blocks of size 2^( 3) =       0.000416588589
  error estimate for blocks of size 2^( 4) =       0.000423455470
  error estimate for blocks of size 2^( 5) =       0.000428181944
  error estimate for blocks of size 2^( 6) =       0.000430717092
  error estimate for blocks of size 2^( 7) =       0.000431556314

      target function =                  N/A
              le_mean =     -17.215754472935
             les_mean =     296.698329541463
             stat err =       0.000428477705
             autocorr =       1.161512805609
              std dev =       0.562252280704
             le_variance =       0.316127627157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157393074
                                         uncertainty =       0.004910414934

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316157393074
                                         uncertainty =       0.004910414934

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397572403
  error estimate for blocks of size 2^( 2) =       0.000407865357
  error estimate for blocks of size 2^( 3) =       0.000416588591
  error estimate for blocks of size 2^( 4) =       0.000423455472
  error estimate for blocks of size 2^( 5) =       0.000428181946
  error estimate for blocks of size 2^( 6) =       0.000430717094
  error estimate for blocks of size 2^( 7) =       0.000431556316

      target function =                  N/A
              le_mean =     -17.215754472951
             les_mean =     296.698329545474
             stat err =       0.000428477707
             autocorr =       1.161512804990
              std dev =       0.562252283771
             le_variance =       0.316127630606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215754472953        initial  <--
     1.4901e+04     1.4901e+05             3.8059e-08       -17.215754472916
     5.9605e+04     5.9605e+05             9.5149e-09       -17.215754472935
     2.3842e+05     2.3842e+06             2.3787e-09       -17.215754472951

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1421
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610655e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253579e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901421e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460272e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4940e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1771
    reference variance = 0.211231
====================================================
  Execution time = 2.0280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5331e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318038000614
                                         uncertainty =       0.003780293818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318038000614
                                         uncertainty =       0.003780293818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398842835
  error estimate for blocks of size 2^( 2) =       0.000408583101
  error estimate for blocks of size 2^( 3) =       0.000417361045
  error estimate for blocks of size 2^( 4) =       0.000423585223
  error estimate for blocks of size 2^( 5) =       0.000427324931
  error estimate for blocks of size 2^( 6) =       0.000428623543
  error estimate for blocks of size 2^( 7) =       0.000429214882

      target function =                  N/A
              le_mean =     -17.216773496455
             les_mean =     296.735440683536
             stat err =       0.000427187145
             autocorr =       1.147183154127
              std dev =       0.564048946791
             le_variance =       0.318151214376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677349645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216773496455       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216773496456       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216773496463       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216773496405       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216773496481       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216773496438       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216773496446       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 4.362557e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216773496455       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216773496455       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216773496457       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216773496330       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216773496244       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216773496520       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216773496479       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.090640e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216773496455       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216773496455       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216773496456       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216773496457       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216773496486       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216773496439       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216773497883       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.726599e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.086139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5824e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610655e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253579e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901421e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262442e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1954
    reference variance = 0.323816
====================================================
  Execution time = 2.0104e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1558e-01
  Total weights = 2.0000e+06
  Execution time = 1.8256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380748
                                         uncertainty =       0.002662444677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380748
                                         uncertainty =       0.002662444677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397229520
  error estimate for blocks of size 2^( 2) =       0.000407101250
  error estimate for blocks of size 2^( 3) =       0.000415687524
  error estimate for blocks of size 2^( 4) =       0.000421835552
  error estimate for blocks of size 2^( 5) =       0.000425141502
  error estimate for blocks of size 2^( 6) =       0.000427550864
  error estimate for blocks of size 2^( 7) =       0.000426923235

      target function =                  N/A
              le_mean =     -17.217246478159
             les_mean =     296.749158715441
             stat err =       0.000425362788
             autocorr =       1.146663416535
              std dev =       0.561767374947
             le_variance =       0.315582583554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380630
                                         uncertainty =       0.002662444678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380630
                                         uncertainty =       0.002662444678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397229520
  error estimate for blocks of size 2^( 2) =       0.000407101250
  error estimate for blocks of size 2^( 3) =       0.000415687524
  error estimate for blocks of size 2^( 4) =       0.000421835552
  error estimate for blocks of size 2^( 5) =       0.000425141502
  error estimate for blocks of size 2^( 6) =       0.000427550864
  error estimate for blocks of size 2^( 7) =       0.000426923235

      target function =                  N/A
              le_mean =     -17.217246478165
             les_mean =     296.749158715533
             stat err =       0.000425362788
             autocorr =       1.146663416314
              std dev =       0.561767374842
             le_variance =       0.315582583437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380689
                                         uncertainty =       0.002662444677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380689
                                         uncertainty =       0.002662444677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397229520
  error estimate for blocks of size 2^( 2) =       0.000407101250
  error estimate for blocks of size 2^( 3) =       0.000415687524
  error estimate for blocks of size 2^( 4) =       0.000421835552
  error estimate for blocks of size 2^( 5) =       0.000425141502
  error estimate for blocks of size 2^( 6) =       0.000427550864
  error estimate for blocks of size 2^( 7) =       0.000426923235

      target function =                  N/A
              le_mean =     -17.217246478162
             les_mean =     296.749158715487
             stat err =       0.000425362788
             autocorr =       1.146663416424
              std dev =       0.561767374894
             le_variance =       0.315582583495

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380741
                                         uncertainty =       0.002662444677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315603380741
                                         uncertainty =       0.002662444677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397229520
  error estimate for blocks of size 2^( 2) =       0.000407101250
  error estimate for blocks of size 2^( 3) =       0.000415687524
  error estimate for blocks of size 2^( 4) =       0.000421835552
  error estimate for blocks of size 2^( 5) =       0.000425141502
  error estimate for blocks of size 2^( 6) =       0.000427550864
  error estimate for blocks of size 2^( 7) =       0.000426923235

      target function =                  N/A
              le_mean =     -17.217246478159
             les_mean =     296.749158715447
             stat err =       0.000425362788
             autocorr =       1.146663416525
              std dev =       0.561767374940
             le_variance =       0.315582583547


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217246478159        initial
     1.4901e+05     1.4901e+06             4.3626e-09       -17.217246478165  <--
     5.9605e+05     5.9605e+06             1.0906e-09       -17.217246478162
     2.3842e+06     2.3842e+07             2.7266e-10       -17.217246478159

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 2.9407e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610655e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253579e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901421e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1485
    reference variance = 0.178811
====================================================
  Execution time = 2.0224e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315647574368
                                         uncertainty =       0.002604689563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315647574368
                                         uncertainty =       0.002604689563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397317203
  error estimate for blocks of size 2^( 2) =       0.000407241012
  error estimate for blocks of size 2^( 3) =       0.000415928593
  error estimate for blocks of size 2^( 4) =       0.000422068592
  error estimate for blocks of size 2^( 5) =       0.000425661328
  error estimate for blocks of size 2^( 6) =       0.000425552532
  error estimate for blocks of size 2^( 7) =       0.000426497561

      target function =                  N/A
              le_mean =     -17.217176124348
             les_mean =     296.746875458458
             stat err =       0.000424945003
             autocorr =       1.143906992523
              std dev =       0.561891376954
             le_variance =       0.315721919496


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721717612435e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217176124348       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217176124351       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217176124359       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176124392       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176124370       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217176124386       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217176124396       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.648547e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217176124348       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217176124349       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217176124351       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176124295       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176124356       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217176124394       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217176124367       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 4.121374e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217176124348       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217176124348       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217176124349       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217176124313       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217176124316       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217176125171       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217176123939       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.030344e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5841e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617535e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610655e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253578e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780066e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2073
    reference variance = 0.528814
====================================================
  Execution time = 1.9955e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2149e-01
  Total weights = 2.0000e+06
  Execution time = 1.8203e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432349054
                                         uncertainty =       0.003563006438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432349054
                                         uncertainty =       0.003563006438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400928465
  error estimate for blocks of size 2^( 2) =       0.000410711868
  error estimate for blocks of size 2^( 3) =       0.000418935189
  error estimate for blocks of size 2^( 4) =       0.000425009057
  error estimate for blocks of size 2^( 5) =       0.000429045732
  error estimate for blocks of size 2^( 6) =       0.000431484691
  error estimate for blocks of size 2^( 7) =       0.000434324972

      target function =                  N/A
              le_mean =     -17.217086895068
             les_mean =     296.749568258974
             stat err =       0.000429966113
             autocorr =       1.150097544229
              std dev =       0.566998472131
             le_variance =       0.321487267399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432346579
                                         uncertainty =       0.003563006480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432346579
                                         uncertainty =       0.003563006480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400928463
  error estimate for blocks of size 2^( 2) =       0.000410711867
  error estimate for blocks of size 2^( 3) =       0.000418935188
  error estimate for blocks of size 2^( 4) =       0.000425009056
  error estimate for blocks of size 2^( 5) =       0.000429045730
  error estimate for blocks of size 2^( 6) =       0.000431484690
  error estimate for blocks of size 2^( 7) =       0.000434324970

      target function =                  N/A
              le_mean =     -17.217086895074
             les_mean =     296.749568256708
             stat err =       0.000429966111
             autocorr =       1.150097544559
              std dev =       0.566998469946
             le_variance =       0.321487264921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432347817
                                         uncertainty =       0.003563006459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432347817
                                         uncertainty =       0.003563006459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400928464
  error estimate for blocks of size 2^( 2) =       0.000410711867
  error estimate for blocks of size 2^( 3) =       0.000418935188
  error estimate for blocks of size 2^( 4) =       0.000425009057
  error estimate for blocks of size 2^( 5) =       0.000429045731
  error estimate for blocks of size 2^( 6) =       0.000431484690
  error estimate for blocks of size 2^( 7) =       0.000434324971

      target function =                  N/A
              le_mean =     -17.217086895071
             les_mean =     296.749568257841
             stat err =       0.000429966112
             autocorr =       1.150097544399
              std dev =       0.566998471039
             le_variance =       0.321487266160

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432348900
                                         uncertainty =       0.003563006440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321432348900
                                         uncertainty =       0.003563006440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400928464
  error estimate for blocks of size 2^( 2) =       0.000410711868
  error estimate for blocks of size 2^( 3) =       0.000418935189
  error estimate for blocks of size 2^( 4) =       0.000425009057
  error estimate for blocks of size 2^( 5) =       0.000429045732
  error estimate for blocks of size 2^( 6) =       0.000431484691
  error estimate for blocks of size 2^( 7) =       0.000434324972

      target function =                  N/A
              le_mean =     -17.217086895068
             les_mean =     296.749568258832
             stat err =       0.000429966113
             autocorr =       1.150097544253
              std dev =       0.566998471995
             le_variance =       0.321487267244


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217086895068        initial
     3.7253e+04     3.7253e+05             1.6485e-08       -17.217086895074  <--
     1.4901e+05     1.4901e+06             4.1214e-09       -17.217086895071
     5.9605e+05     5.9605e+06             1.0303e-09       -17.217086895068

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.9185e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253575e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5032e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2254
    reference variance = 0.473438
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314039376551
                                         uncertainty =       0.002985907759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314039376551
                                         uncertainty =       0.002985907759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396287219
  error estimate for blocks of size 2^( 2) =       0.000406402995
  error estimate for blocks of size 2^( 3) =       0.000415433270
  error estimate for blocks of size 2^( 4) =       0.000422561445
  error estimate for blocks of size 2^( 5) =       0.000425951022
  error estimate for blocks of size 2^( 6) =       0.000427995411
  error estimate for blocks of size 2^( 7) =       0.000428138819

      target function =                  N/A
              le_mean =     -17.217080938194
             les_mean =     296.741962995459
             stat err =       0.000426161674
             autocorr =       1.156454759198
              std dev =       0.560434759961
             le_variance =       0.314087120173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708093819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217080938194       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217080938251       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217080938379       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217080938381       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217080938359       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217080938376       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217080938379       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 6.969650e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217080938194       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217080938208       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217080938240       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217080938226       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217080938210       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217080938241       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217080938242       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.742418e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217080938194       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217080938198       residual = 8.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217080938206       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217080938206       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217080938204       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217080938207       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217080938237       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 4.356049e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6068e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253572e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.154
    reference variance = 0.184276
====================================================
  Execution time = 1.9906e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1654e-01
  Total weights = 2.0000e+06
  Execution time = 1.8212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368252581
                                         uncertainty =       0.006628659262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368252581
                                         uncertainty =       0.006628659262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397829566
  error estimate for blocks of size 2^( 2) =       0.000407244527
  error estimate for blocks of size 2^( 3) =       0.000416512160
  error estimate for blocks of size 2^( 4) =       0.000423558774
  error estimate for blocks of size 2^( 5) =       0.000426881049
  error estimate for blocks of size 2^( 6) =       0.000429693543
  error estimate for blocks of size 2^( 7) =       0.000430739663

      target function =                  N/A
              le_mean =     -17.216164310991
             les_mean =     296.712850151825
             stat err =       0.000427718257
             autocorr =       1.155903198880
              std dev =       0.562615967646
             le_variance =       0.316536727050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368268415
                                         uncertainty =       0.006628659558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368268415
                                         uncertainty =       0.006628659558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397829576
  error estimate for blocks of size 2^( 2) =       0.000407244536
  error estimate for blocks of size 2^( 3) =       0.000416512169
  error estimate for blocks of size 2^( 4) =       0.000423558783
  error estimate for blocks of size 2^( 5) =       0.000426881058
  error estimate for blocks of size 2^( 6) =       0.000429693552
  error estimate for blocks of size 2^( 7) =       0.000430739672

      target function =                  N/A
              le_mean =     -17.216164310905
             les_mean =     296.712850164709
             stat err =       0.000427718266
             autocorr =       1.155903189271
              std dev =       0.562615981742
             le_variance =       0.316536742911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368260498
                                         uncertainty =       0.006628659410

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368260498
                                         uncertainty =       0.006628659410

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397829571
  error estimate for blocks of size 2^( 2) =       0.000407244531
  error estimate for blocks of size 2^( 3) =       0.000416512165
  error estimate for blocks of size 2^( 4) =       0.000423558778
  error estimate for blocks of size 2^( 5) =       0.000426881054
  error estimate for blocks of size 2^( 6) =       0.000429693548
  error estimate for blocks of size 2^( 7) =       0.000430739667

      target function =                  N/A
              le_mean =     -17.216164310948
             les_mean =     296.712850158267
             stat err =       0.000427718262
             autocorr =       1.155903194073
              std dev =       0.562615974694
             le_variance =       0.316536734981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368253571
                                         uncertainty =       0.006628659280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368253571
                                         uncertainty =       0.006628659280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397829567
  error estimate for blocks of size 2^( 2) =       0.000407244527
  error estimate for blocks of size 2^( 3) =       0.000416512161
  error estimate for blocks of size 2^( 4) =       0.000423558774
  error estimate for blocks of size 2^( 5) =       0.000426881050
  error estimate for blocks of size 2^( 6) =       0.000429693544
  error estimate for blocks of size 2^( 7) =       0.000430739664

      target function =                  N/A
              le_mean =     -17.216164310986
             les_mean =     296.712850152630
             stat err =       0.000427718258
             autocorr =       1.155903198273
              std dev =       0.562615968527
             le_variance =       0.316536728041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216164310991        initial  <--
     9.3132e+03     9.3132e+04             6.9696e-08       -17.216164310905
     3.7253e+04     3.7253e+05             1.7424e-08       -17.216164310948
     1.4901e+05     1.4901e+06             4.3560e-09       -17.216164310986

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.0686
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253575e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.214
    reference variance = 0.272153
====================================================
  Execution time = 2.0423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4942e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335184863227
                                         uncertainty =       0.014656406261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335184863227
                                         uncertainty =       0.014656406261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409355951
  error estimate for blocks of size 2^( 2) =       0.000418848182
  error estimate for blocks of size 2^( 3) =       0.000427278482
  error estimate for blocks of size 2^( 4) =       0.000433811504
  error estimate for blocks of size 2^( 5) =       0.000438365448
  error estimate for blocks of size 2^( 6) =       0.000440866745
  error estimate for blocks of size 2^( 7) =       0.000442346085

      target function =                  N/A
              le_mean =     -17.216309657113
             les_mean =     296.736462631832
             stat err =       0.000438847446
             autocorr =       1.149277573195
              std dev =       0.578916738237
             le_variance =       0.335144589811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721630965711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216309657113       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216309657120       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216309657140       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216309657138       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216309657142       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216309657161       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309657202       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 5.592771e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216309657113       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216309657114       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216309657120       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216309657119       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216309657120       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216309657095       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309657617       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.398193e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216309657113       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216309657113       residual = 8.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216309657114       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216309657114       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216309657075       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216309656998       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216309658113       residual = 9.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.495483e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.092890 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5928e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025747e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253575e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963212e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1873
    reference variance = 0.2005
====================================================
  Execution time = 1.9673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2549e-01
  Total weights = 2.0000e+06
  Execution time = 1.8225e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289270
                                         uncertainty =       0.007307041749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289270
                                         uncertainty =       0.007307041749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403418257
  error estimate for blocks of size 2^( 2) =       0.000412693103
  error estimate for blocks of size 2^( 3) =       0.000421464837
  error estimate for blocks of size 2^( 4) =       0.000427673124
  error estimate for blocks of size 2^( 5) =       0.000431243465
  error estimate for blocks of size 2^( 6) =       0.000434033449
  error estimate for blocks of size 2^( 7) =       0.000433249536

      target function =                  N/A
              le_mean =     -17.216196841316
             les_mean =     296.722926096601
             stat err =       0.000431549894
             autocorr =       1.144329068563
              std dev =       0.570519570568
             le_variance =       0.325492580401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289941
                                         uncertainty =       0.007307041777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289941
                                         uncertainty =       0.007307041777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403418258
  error estimate for blocks of size 2^( 2) =       0.000412693104
  error estimate for blocks of size 2^( 3) =       0.000421464838
  error estimate for blocks of size 2^( 4) =       0.000427673125
  error estimate for blocks of size 2^( 5) =       0.000431243465
  error estimate for blocks of size 2^( 6) =       0.000434033450
  error estimate for blocks of size 2^( 7) =       0.000433249536

      target function =                  N/A
              le_mean =     -17.216196841319
             les_mean =     296.722926097373
             stat err =       0.000431549894
             autocorr =       1.144329068148
              std dev =       0.570519571156
             le_variance =       0.325492581072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289606
                                         uncertainty =       0.007307041763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289606
                                         uncertainty =       0.007307041763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403418257
  error estimate for blocks of size 2^( 2) =       0.000412693103
  error estimate for blocks of size 2^( 3) =       0.000421464838
  error estimate for blocks of size 2^( 4) =       0.000427673124
  error estimate for blocks of size 2^( 5) =       0.000431243465
  error estimate for blocks of size 2^( 6) =       0.000434033450
  error estimate for blocks of size 2^( 7) =       0.000433249536

      target function =                  N/A
              le_mean =     -17.216196841318
             les_mean =     296.722926096987
             stat err =       0.000431549894
             autocorr =       1.144329068355
              std dev =       0.570519570862
             le_variance =       0.325492580736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289312
                                         uncertainty =       0.007307041751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325487289312
                                         uncertainty =       0.007307041751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403418257
  error estimate for blocks of size 2^( 2) =       0.000412693103
  error estimate for blocks of size 2^( 3) =       0.000421464837
  error estimate for blocks of size 2^( 4) =       0.000427673124
  error estimate for blocks of size 2^( 5) =       0.000431243465
  error estimate for blocks of size 2^( 6) =       0.000434033450
  error estimate for blocks of size 2^( 7) =       0.000433249536

      target function =                  N/A
              le_mean =     -17.216196841316
             les_mean =     296.722926096649
             stat err =       0.000431549894
             autocorr =       1.144329068541
              std dev =       0.570519570605
             le_variance =       0.325492580443


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216196841316        initial
     9.3132e+04     9.3132e+05             5.5928e-09       -17.216196841319  <--
     3.7253e+05     3.7253e+06             1.3982e-09       -17.216196841318
     1.4901e+06     1.4901e+07             3.4955e-10       -17.216196841316

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.8900e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237104e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253574e-03 1 1  ON 18
 ud_9                 9.256139e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2072
    reference variance = 0.163594
====================================================
  Execution time = 1.9915e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1241e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6900e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312412268862
                                         uncertainty =       0.002053777930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312412268862
                                         uncertainty =       0.002053777930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395228862
  error estimate for blocks of size 2^( 2) =       0.000405018915
  error estimate for blocks of size 2^( 3) =       0.000413546749
  error estimate for blocks of size 2^( 4) =       0.000419497246
  error estimate for blocks of size 2^( 5) =       0.000424000075
  error estimate for blocks of size 2^( 6) =       0.000425754522
  error estimate for blocks of size 2^( 7) =       0.000427043832

      target function =                  N/A
              le_mean =     -17.217249092296
             les_mean =     296.746077857429
             stat err =       0.000424073919
             autocorr =       1.151292887854
              std dev =       0.558938017543
             le_variance =       0.312411707455


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721724909230e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217249092296       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217249092316       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217249092315       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217249092358       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217249092366       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217249092349       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217249092350       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 2.571665e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217249092296       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217249092301       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217249092301       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217249092309       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217249092314       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217249092312       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217249092315       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 6.429171e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217249092296       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217249092298       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217249092298       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217249092300       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217249092301       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217249092337       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217249092281       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.607293e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.095118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5616e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761368e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530492e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253573e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901422e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2377
    reference variance = 0.709373
====================================================
  Execution time = 1.9899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2184e-01
  Total weights = 2.0000e+06
  Execution time = 1.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805614330
                                         uncertainty =       0.003915222070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805614330
                                         uncertainty =       0.003915222070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401147856
  error estimate for blocks of size 2^( 2) =       0.000410403085
  error estimate for blocks of size 2^( 3) =       0.000419035766
  error estimate for blocks of size 2^( 4) =       0.000426033159
  error estimate for blocks of size 2^( 5) =       0.000430640977
  error estimate for blocks of size 2^( 6) =       0.000432336430
  error estimate for blocks of size 2^( 7) =       0.000434813488

      target function =                  N/A
              le_mean =     -17.217179489867
             les_mean =     296.753108629636
             stat err =       0.000430956014
             autocorr =       1.154135874646
              std dev =       0.567308738035
             le_variance =       0.321839204251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805616937
                                         uncertainty =       0.003915221998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805616937
                                         uncertainty =       0.003915221998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401147857
  error estimate for blocks of size 2^( 2) =       0.000410403087
  error estimate for blocks of size 2^( 3) =       0.000419035768
  error estimate for blocks of size 2^( 4) =       0.000426033160
  error estimate for blocks of size 2^( 5) =       0.000430640978
  error estimate for blocks of size 2^( 6) =       0.000432336432
  error estimate for blocks of size 2^( 7) =       0.000434813490

      target function =                  N/A
              le_mean =     -17.217179489875
             les_mean =     296.753108632525
             stat err =       0.000430956015
             autocorr =       1.154135872085
              std dev =       0.567308740335
             le_variance =       0.321839206861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805615634
                                         uncertainty =       0.003915222034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805615634
                                         uncertainty =       0.003915222034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401147857
  error estimate for blocks of size 2^( 2) =       0.000410403086
  error estimate for blocks of size 2^( 3) =       0.000419035767
  error estimate for blocks of size 2^( 4) =       0.000426033160
  error estimate for blocks of size 2^( 5) =       0.000430640978
  error estimate for blocks of size 2^( 6) =       0.000432336431
  error estimate for blocks of size 2^( 7) =       0.000434813489

      target function =                  N/A
              le_mean =     -17.217179489871
             les_mean =     296.753108631081
             stat err =       0.000430956014
             autocorr =       1.154135873365
              std dev =       0.567308739185
             le_variance =       0.321839205556

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805614493
                                         uncertainty =       0.003915222065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321805614493
                                         uncertainty =       0.003915222065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401147856
  error estimate for blocks of size 2^( 2) =       0.000410403085
  error estimate for blocks of size 2^( 3) =       0.000419035766
  error estimate for blocks of size 2^( 4) =       0.000426033159
  error estimate for blocks of size 2^( 5) =       0.000430640977
  error estimate for blocks of size 2^( 6) =       0.000432336430
  error estimate for blocks of size 2^( 7) =       0.000434813488

      target function =                  N/A
              le_mean =     -17.217179489868
             les_mean =     296.753108629817
             stat err =       0.000430956014
             autocorr =       1.154135874488
              std dev =       0.567308738179
             le_variance =       0.321839204414


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217179489867        initial
     2.3283e+04     2.3283e+05             2.5717e-08       -17.217179489875  <--
     9.3132e+04     9.3132e+05             6.4292e-09       -17.217179489871
     3.7253e+05     3.7253e+06             1.6073e-09       -17.217179489868

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 2.9150e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4771e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2462
    reference variance = 0.257651
====================================================
  Execution time = 2.0009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1540e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5209e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315508999683
                                         uncertainty =       0.004506988991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315508999683
                                         uncertainty =       0.004506988991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397116475
  error estimate for blocks of size 2^( 2) =       0.000407054058
  error estimate for blocks of size 2^( 3) =       0.000415784049
  error estimate for blocks of size 2^( 4) =       0.000422449139
  error estimate for blocks of size 2^( 5) =       0.000425846914
  error estimate for blocks of size 2^( 6) =       0.000426769220
  error estimate for blocks of size 2^( 7) =       0.000426990452

      target function =                  N/A
              le_mean =     -17.216501886314
             les_mean =     296.723340033553
             stat err =       0.000425513931
             autocorr =       1.148131827790
              std dev =       0.561607505109
             le_variance =       0.315402989795


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650188631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216501886314       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216501886428       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216501886724       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216501886686       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216501886647       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216501886669       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216501886708       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 1.049471e-07

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216501886314       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216501886343       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216501886417       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216501886415       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216501886401       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216501886390       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216501886421       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 2.623698e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216501886314       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216501886321       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216501886340       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216501886337       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216501886319       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216501886331       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216501886345       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 6.559257e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097356 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5544e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761370e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025749e-02 1 1  ON 7
 uu_8                 9.812490e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253564e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595259e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545137e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182232e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371438e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400758e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.315548
====================================================
  Execution time = 1.9659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2026e-01
  Total weights = 2.0000e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263261281
                                         uncertainty =       0.004967208706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263261281
                                         uncertainty =       0.004967208706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400165418
  error estimate for blocks of size 2^( 2) =       0.000410096352
  error estimate for blocks of size 2^( 3) =       0.000419225779
  error estimate for blocks of size 2^( 4) =       0.000425696107
  error estimate for blocks of size 2^( 5) =       0.000428540836
  error estimate for blocks of size 2^( 6) =       0.000430375047
  error estimate for blocks of size 2^( 7) =       0.000433170721

      target function =                  N/A
              le_mean =     -17.216460763968
             les_mean =     296.726785801287
             stat err =       0.000429445677
             autocorr =       1.151694682542
              std dev =       0.565919361883
             le_variance =       0.320264724154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263286203
                                         uncertainty =       0.004967209209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263286203
                                         uncertainty =       0.004967209209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400165434
  error estimate for blocks of size 2^( 2) =       0.000410096367
  error estimate for blocks of size 2^( 3) =       0.000419225792
  error estimate for blocks of size 2^( 4) =       0.000425696119
  error estimate for blocks of size 2^( 5) =       0.000428540848
  error estimate for blocks of size 2^( 6) =       0.000430375060
  error estimate for blocks of size 2^( 7) =       0.000433170733

      target function =                  N/A
              le_mean =     -17.216460763855
             les_mean =     296.726785822304
             stat err =       0.000429445690
             autocorr =       1.151694660909
              std dev =       0.565919383903
             le_variance =       0.320264749077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263273742
                                         uncertainty =       0.004967208958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263273742
                                         uncertainty =       0.004967208958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400165426
  error estimate for blocks of size 2^( 2) =       0.000410096360
  error estimate for blocks of size 2^( 3) =       0.000419225785
  error estimate for blocks of size 2^( 4) =       0.000425696113
  error estimate for blocks of size 2^( 5) =       0.000428540842
  error estimate for blocks of size 2^( 6) =       0.000430375053
  error estimate for blocks of size 2^( 7) =       0.000433170727

      target function =                  N/A
              le_mean =     -17.216460763912
             les_mean =     296.726785811796
             stat err =       0.000429445684
             autocorr =       1.151694671715
              std dev =       0.565919372893
             le_variance =       0.320264736616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263262839
                                         uncertainty =       0.004967208737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320263262839
                                         uncertainty =       0.004967208737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400165419
  error estimate for blocks of size 2^( 2) =       0.000410096353
  error estimate for blocks of size 2^( 3) =       0.000419225779
  error estimate for blocks of size 2^( 4) =       0.000425696107
  error estimate for blocks of size 2^( 5) =       0.000428540837
  error estimate for blocks of size 2^( 6) =       0.000430375048
  error estimate for blocks of size 2^( 7) =       0.000433170721

      target function =                  N/A
              le_mean =     -17.216460763961
             les_mean =     296.726785802601
             stat err =       0.000429445678
             autocorr =       1.151694681185
              std dev =       0.565919363259
             le_variance =       0.320264725712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216460763968        initial  <--
     5.8208e+03     5.8208e+04             1.0495e-07       -17.216460763855
     2.3283e+04     2.3283e+05             2.6237e-08       -17.216460763912
     9.3132e+04     9.3132e+05             6.5593e-09       -17.216460763961

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8793
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2613
    reference variance = 0.255881
====================================================
  Execution time = 1.9947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1625e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316137261179
                                         uncertainty =       0.004036324868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316137261179
                                         uncertainty =       0.004036324868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397649946
  error estimate for blocks of size 2^( 2) =       0.000407982854
  error estimate for blocks of size 2^( 3) =       0.000416720001
  error estimate for blocks of size 2^( 4) =       0.000423013535
  error estimate for blocks of size 2^( 5) =       0.000426487566
  error estimate for blocks of size 2^( 6) =       0.000429407248
  error estimate for blocks of size 2^( 7) =       0.000430527891

      target function =                  N/A
              le_mean =     -17.216577773959
             les_mean =     296.726801048306
             stat err =       0.000427359060
             autocorr =       1.155005291825
              std dev =       0.562361947184
             le_variance =       0.316250959641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721657777396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577773959       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577773965       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577773977       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577773986       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577773999       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577774000       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577773901       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 1.025623e-08

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577773959       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577773961       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577773964       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577773864       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577773761       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577773800       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577774186       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 2.564058e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216577773959       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216577773960       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216577773960       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216577774204       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216577773726       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216577773977       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216577773990       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 6.410142e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5642e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253569e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595259e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1922
    reference variance = 0.218743
====================================================
  Execution time = 1.9922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1910e-01
  Total weights = 2.0000e+06
  Execution time = 1.8191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014365
                                         uncertainty =       0.007102789918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014365
                                         uncertainty =       0.007102789918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399435878
  error estimate for blocks of size 2^( 2) =       0.000409006688
  error estimate for blocks of size 2^( 3) =       0.000417746574
  error estimate for blocks of size 2^( 4) =       0.000424769661
  error estimate for blocks of size 2^( 5) =       0.000429331267
  error estimate for blocks of size 2^( 6) =       0.000432020706
  error estimate for blocks of size 2^( 7) =       0.000432839758

      target function =                  N/A
              le_mean =     -17.217691875203
             les_mean =     296.768011390828
             stat err =       0.000429740348
             autocorr =       1.157492325667
              std dev =       0.564887635692
             le_variance =       0.319098040957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014333
                                         uncertainty =       0.007102789885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014333
                                         uncertainty =       0.007102789885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399435878
  error estimate for blocks of size 2^( 2) =       0.000409006688
  error estimate for blocks of size 2^( 3) =       0.000417746574
  error estimate for blocks of size 2^( 4) =       0.000424769661
  error estimate for blocks of size 2^( 5) =       0.000429331267
  error estimate for blocks of size 2^( 6) =       0.000432020706
  error estimate for blocks of size 2^( 7) =       0.000432839757

      target function =                  N/A
              le_mean =     -17.217691875186
             les_mean =     296.768011390212
             stat err =       0.000429740348
             autocorr =       1.157492325248
              std dev =       0.564887635664
             le_variance =       0.319098040926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014349
                                         uncertainty =       0.007102789901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014349
                                         uncertainty =       0.007102789901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399435878
  error estimate for blocks of size 2^( 2) =       0.000409006688
  error estimate for blocks of size 2^( 3) =       0.000417746574
  error estimate for blocks of size 2^( 4) =       0.000424769661
  error estimate for blocks of size 2^( 5) =       0.000429331267
  error estimate for blocks of size 2^( 6) =       0.000432020706
  error estimate for blocks of size 2^( 7) =       0.000432839758

      target function =                  N/A
              le_mean =     -17.217691875194
             les_mean =     296.768011390520
             stat err =       0.000429740348
             autocorr =       1.157492325466
              std dev =       0.564887635678
             le_variance =       0.319098040942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014363
                                         uncertainty =       0.007102789916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318934014363
                                         uncertainty =       0.007102789916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399435878
  error estimate for blocks of size 2^( 2) =       0.000409006688
  error estimate for blocks of size 2^( 3) =       0.000417746574
  error estimate for blocks of size 2^( 4) =       0.000424769661
  error estimate for blocks of size 2^( 5) =       0.000429331267
  error estimate for blocks of size 2^( 6) =       0.000432020706
  error estimate for blocks of size 2^( 7) =       0.000432839758

      target function =                  N/A
              le_mean =     -17.217691875202
             les_mean =     296.768011390789
             stat err =       0.000429740348
             autocorr =       1.157492325647
              std dev =       0.564887635690
             le_variance =       0.319098040955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217691875203        initial  <--
     5.8208e+04     5.8208e+05             1.0256e-08       -17.217691875186
     2.3283e+05     2.3283e+06             2.5641e-09       -17.217691875194
     9.3132e+05     9.3132e+06             6.4101e-10       -17.217691875202

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1478
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4796e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2577
    reference variance = 0.262442
====================================================
  Execution time = 2.0058e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2732e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327364672198
                                         uncertainty =       0.007875169716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327364672198
                                         uncertainty =       0.007875169716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404548138
  error estimate for blocks of size 2^( 2) =       0.000414044653
  error estimate for blocks of size 2^( 3) =       0.000423221280
  error estimate for blocks of size 2^( 4) =       0.000429761331
  error estimate for blocks of size 2^( 5) =       0.000432636299
  error estimate for blocks of size 2^( 6) =       0.000433623934
  error estimate for blocks of size 2^( 7) =       0.000435090132

      target function =                  N/A
              le_mean =     -17.216455583542
             les_mean =     296.733661088875
             stat err =       0.000432777924
             autocorr =       1.144431451713
              std dev =       0.572117463877
             le_variance =       0.327318392473


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721645558354e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216455583542       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216455583542       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216455583544       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216455583508       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216455583580       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216455583240       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216455583395       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 1.083970e-09

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216455583542       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216455583542       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216455583542       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216455583537       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216455583497       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216455583273       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216455584167       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 2.709925e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216455583542       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216455583542       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216455583542       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216455583542       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216455585294       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216455581924       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216455585158       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 6.774815e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101885 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5569e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.217
    reference variance = 0.429876
====================================================
  Execution time = 1.9823e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1542e-01
  Total weights = 2.0000e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191368
                                         uncertainty =       0.003098141689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191368
                                         uncertainty =       0.003098141689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397129788
  error estimate for blocks of size 2^( 2) =       0.000406870481
  error estimate for blocks of size 2^( 3) =       0.000414907815
  error estimate for blocks of size 2^( 4) =       0.000421190949
  error estimate for blocks of size 2^( 5) =       0.000424265581
  error estimate for blocks of size 2^( 6) =       0.000425031537
  error estimate for blocks of size 2^( 7) =       0.000425339419

      target function =                  N/A
              le_mean =     -17.216030939338
             les_mean =     296.707145283158
             stat err =       0.000423956871
             autocorr =       1.139668199084
              std dev =       0.561626331838
             le_variance =       0.315424136614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191766
                                         uncertainty =       0.003098141694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191766
                                         uncertainty =       0.003098141694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397129788
  error estimate for blocks of size 2^( 2) =       0.000406870481
  error estimate for blocks of size 2^( 3) =       0.000414907816
  error estimate for blocks of size 2^( 4) =       0.000421190950
  error estimate for blocks of size 2^( 5) =       0.000424265581
  error estimate for blocks of size 2^( 6) =       0.000425031537
  error estimate for blocks of size 2^( 7) =       0.000425339419

      target function =                  N/A
              le_mean =     -17.216030939338
             les_mean =     296.707145283550
             stat err =       0.000423956872
             autocorr =       1.139668198777
              std dev =       0.561626332191
             le_variance =       0.315424137011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191567
                                         uncertainty =       0.003098141692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191567
                                         uncertainty =       0.003098141692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397129788
  error estimate for blocks of size 2^( 2) =       0.000406870481
  error estimate for blocks of size 2^( 3) =       0.000414907815
  error estimate for blocks of size 2^( 4) =       0.000421190950
  error estimate for blocks of size 2^( 5) =       0.000424265581
  error estimate for blocks of size 2^( 6) =       0.000425031537
  error estimate for blocks of size 2^( 7) =       0.000425339419

      target function =                  N/A
              le_mean =     -17.216030939338
             les_mean =     296.707145283354
             stat err =       0.000423956872
             autocorr =       1.139668198934
              std dev =       0.561626332015
             le_variance =       0.315424136812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191393
                                         uncertainty =       0.003098141689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315514191393
                                         uncertainty =       0.003098141689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397129788
  error estimate for blocks of size 2^( 2) =       0.000406870481
  error estimate for blocks of size 2^( 3) =       0.000414907815
  error estimate for blocks of size 2^( 4) =       0.000421190949
  error estimate for blocks of size 2^( 5) =       0.000424265581
  error estimate for blocks of size 2^( 6) =       0.000425031537
  error estimate for blocks of size 2^( 7) =       0.000425339419

      target function =                  N/A
              le_mean =     -17.216030939338
             les_mean =     296.707145283183
             stat err =       0.000423956871
             autocorr =       1.139668199076
              std dev =       0.561626331860
             le_variance =       0.315424136639


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216030939338        initial  <--
     5.8208e+05     5.8208e+06             1.0840e-09       -17.216030939338
     2.3283e+06     2.3283e+07             2.7099e-10       -17.216030939338
     9.3132e+06     9.3132e+07             6.7748e-11       -17.216030939338

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0921
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.169767
====================================================
  Execution time = 1.9871e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1580e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315854431554
                                         uncertainty =       0.003273916752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315854431554
                                         uncertainty =       0.003273916752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397369192
  error estimate for blocks of size 2^( 2) =       0.000407118155
  error estimate for blocks of size 2^( 3) =       0.000415892348
  error estimate for blocks of size 2^( 4) =       0.000422481319
  error estimate for blocks of size 2^( 5) =       0.000426432064
  error estimate for blocks of size 2^( 6) =       0.000427843453
  error estimate for blocks of size 2^( 7) =       0.000430311607

      target function =                  N/A
              le_mean =     -17.217218427372
             les_mean =     296.748414768215
             stat err =       0.000426767111
             autocorr =       1.153435988471
              std dev =       0.561964901291
             le_variance =       0.315804550283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721842737e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218427372       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218427372       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218427372       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218429221       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218427635       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218427215       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217218426945       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 1.126739e-10

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218427372       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218427372       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218427372       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218427372       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218434580       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218434639       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217218407689       residual = 5.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.816837e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217218427372       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217218427372       residual = 6.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217218427372       residual = 5.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217218427372       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217218443074       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217218398908       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217218454349       residual = 5.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 7.042167e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104159 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6128e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.184
    reference variance = 0.223746
====================================================
  Execution time = 1.9858e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1641e-01
  Total weights = 2.0000e+06
  Execution time = 1.8216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439605
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439605
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397752806
  error estimate for blocks of size 2^( 2) =       0.000406906026
  error estimate for blocks of size 2^( 3) =       0.000415762475
  error estimate for blocks of size 2^( 4) =       0.000422709305
  error estimate for blocks of size 2^( 5) =       0.000425719452
  error estimate for blocks of size 2^( 6) =       0.000427885476
  error estimate for blocks of size 2^( 7) =       0.000428954810

      target function =                  N/A
              le_mean =     -17.217536394593
             les_mean =     296.759973930553
             stat err =       0.000426317261
             autocorr =       1.148786514784
              std dev =       0.562507412966
             le_variance =       0.316414589641

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439609
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439609
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397752806
  error estimate for blocks of size 2^( 2) =       0.000406906026
  error estimate for blocks of size 2^( 3) =       0.000415762475
  error estimate for blocks of size 2^( 4) =       0.000422709305
  error estimate for blocks of size 2^( 5) =       0.000425719452
  error estimate for blocks of size 2^( 6) =       0.000427885476
  error estimate for blocks of size 2^( 7) =       0.000428954810

      target function =                  N/A
              le_mean =     -17.217536394593
             les_mean =     296.759973930557
             stat err =       0.000426317261
             autocorr =       1.148786514778
              std dev =       0.562507412969
             le_variance =       0.316414589645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439607
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439607
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397752806
  error estimate for blocks of size 2^( 2) =       0.000406906026
  error estimate for blocks of size 2^( 3) =       0.000415762475
  error estimate for blocks of size 2^( 4) =       0.000422709305
  error estimate for blocks of size 2^( 5) =       0.000425719452
  error estimate for blocks of size 2^( 6) =       0.000427885476
  error estimate for blocks of size 2^( 7) =       0.000428954810

      target function =                  N/A
              le_mean =     -17.217536394593
             les_mean =     296.759973930555
             stat err =       0.000426317261
             autocorr =       1.148786514775
              std dev =       0.562507412967
             le_variance =       0.316414589643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439605
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316368439605
                                         uncertainty =       0.003288015055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397752806
  error estimate for blocks of size 2^( 2) =       0.000406906026
  error estimate for blocks of size 2^( 3) =       0.000415762475
  error estimate for blocks of size 2^( 4) =       0.000422709305
  error estimate for blocks of size 2^( 5) =       0.000425719452
  error estimate for blocks of size 2^( 6) =       0.000427885476
  error estimate for blocks of size 2^( 7) =       0.000428954810

      target function =                  N/A
              le_mean =     -17.217536394593
             les_mean =     296.759973930553
             stat err =       0.000426317261
             autocorr =       1.148786514784
              std dev =       0.562507412966
             le_variance =       0.316414589642


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217536394593        initial
     5.8208e+06     5.8208e+07             1.1267e-10       -17.217536394593
     2.3283e+07     2.3283e+08             2.8168e-11       -17.217536394593
     9.3132e+07     9.3132e+08             7.0422e-12       -17.217536394593  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 2.9079e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5213e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2313
    reference variance = 0.168552
====================================================
  Execution time = 1.9960e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1454e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314631963176
                                         uncertainty =       0.003521687041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314631963176
                                         uncertainty =       0.003521687041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396573306
  error estimate for blocks of size 2^( 2) =       0.000406363215
  error estimate for blocks of size 2^( 3) =       0.000415355392
  error estimate for blocks of size 2^( 4) =       0.000421556977
  error estimate for blocks of size 2^( 5) =       0.000426095716
  error estimate for blocks of size 2^( 6) =       0.000428631597
  error estimate for blocks of size 2^( 7) =       0.000428588154

      target function =                  N/A
              le_mean =     -17.216214625595
             les_mean =     296.712586651656
             stat err =       0.000426218111
             autocorr =       1.155092712405
              std dev =       0.560839348091
             le_variance =       0.314540774367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621462560e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216214625595       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216214625595       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216214625595       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216214625595       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216214620429       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216214625595       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216214623669       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.231551e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216214625595       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216214625595       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216214625595       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216214625595       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216214629224       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216214625595       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216214708185       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 5.578872e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216214625595       residual = 6.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216214625595       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216214625595       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216214625595       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216214625406       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216214625595       residual = 3.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216214623677       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.394719e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106479 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5506e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1529
    reference variance = 0.296325
====================================================
  Execution time = 1.9900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1852e-01
  Total weights = 2.0000e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309358
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309358
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075738
  error estimate for blocks of size 2^( 2) =       0.000408946627
  error estimate for blocks of size 2^( 3) =       0.000417975184
  error estimate for blocks of size 2^( 4) =       0.000424680910
  error estimate for blocks of size 2^( 5) =       0.000427624832
  error estimate for blocks of size 2^( 6) =       0.000429247249
  error estimate for blocks of size 2^( 7) =       0.000431885238

      target function =                  N/A
              le_mean =     -17.216732797999
             les_mean =     296.734410967815
             stat err =       0.000428359557
             autocorr =       1.152142695385
              std dev =       0.564378321151
             le_variance =       0.318522889385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309364
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309364
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075738
  error estimate for blocks of size 2^( 2) =       0.000408946627
  error estimate for blocks of size 2^( 3) =       0.000417975184
  error estimate for blocks of size 2^( 4) =       0.000424680910
  error estimate for blocks of size 2^( 5) =       0.000427624832
  error estimate for blocks of size 2^( 6) =       0.000429247249
  error estimate for blocks of size 2^( 7) =       0.000431885238

      target function =                  N/A
              le_mean =     -17.216732797999
             les_mean =     296.734410967821
             stat err =       0.000428359557
             autocorr =       1.152142695390
              std dev =       0.564378321156
             le_variance =       0.318522889391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309361
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309361
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075738
  error estimate for blocks of size 2^( 2) =       0.000408946627
  error estimate for blocks of size 2^( 3) =       0.000417975184
  error estimate for blocks of size 2^( 4) =       0.000424680910
  error estimate for blocks of size 2^( 5) =       0.000427624832
  error estimate for blocks of size 2^( 6) =       0.000429247249
  error estimate for blocks of size 2^( 7) =       0.000431885238

      target function =                  N/A
              le_mean =     -17.216732797999
             les_mean =     296.734410967818
             stat err =       0.000428359557
             autocorr =       1.152142695390
              std dev =       0.564378321153
             le_variance =       0.318522889387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309358
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318434309358
                                         uncertainty =       0.003387601189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399075738
  error estimate for blocks of size 2^( 2) =       0.000408946627
  error estimate for blocks of size 2^( 3) =       0.000417975184
  error estimate for blocks of size 2^( 4) =       0.000424680910
  error estimate for blocks of size 2^( 5) =       0.000427624832
  error estimate for blocks of size 2^( 6) =       0.000429247249
  error estimate for blocks of size 2^( 7) =       0.000431885238

      target function =                  N/A
              le_mean =     -17.216732797999
             les_mean =     296.734410967816
             stat err =       0.000428359557
             autocorr =       1.152142695390
              std dev =       0.564378321151
             le_variance =       0.318522889385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216732797999        initial
     2.3283e+07     2.3283e+08             2.2316e-11       -17.216732797999
     9.3132e+07     9.3132e+08             5.5789e-12       -17.216732797999
     3.7253e+08     3.7253e+09             1.3947e-12       -17.216732797999  <--

*****************************************************************************
Applying the update for shift_i =   3.7253e+08     and shift_s =   3.7253e+09
*****************************************************************************

  Execution time = 2.9116e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4628e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2074
    reference variance = 0.329083
====================================================
  Execution time = 2.0086e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1290e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313018151466
                                         uncertainty =       0.003140264814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313018151466
                                         uncertainty =       0.003140264814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395534944
  error estimate for blocks of size 2^( 2) =       0.000405363310
  error estimate for blocks of size 2^( 3) =       0.000414015706
  error estimate for blocks of size 2^( 4) =       0.000420339490
  error estimate for blocks of size 2^( 5) =       0.000425375253
  error estimate for blocks of size 2^( 6) =       0.000427653231
  error estimate for blocks of size 2^( 7) =       0.000428309306

      target function =                  N/A
              le_mean =     -17.216319919576
             les_mean =     296.714567200051
             stat err =       0.000425419320
             autocorr =       1.156817108624
              std dev =       0.559370881728
             le_variance =       0.312895783325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721631991958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319919576       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319919576       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216319919576       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216319919576       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216319951582       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216319922106       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216319903348       residual = 7.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 5.998919e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319919576       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319919576       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216319919576       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216319919576       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216319986955       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216319920173       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216319772222       residual = 7.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.499723e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216319919576       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216319919576       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216319919576       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216319919576       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216319793946       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216321945463       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216319138912       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 3.755551e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.108722 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5623e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2121
    reference variance = 0.424124
====================================================
  Execution time = 2.0085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4690e-01
  Total weights = 2.0000e+06
  Execution time = 1.8212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415606
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415606
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416472192
  error estimate for blocks of size 2^( 2) =       0.000425562605
  error estimate for blocks of size 2^( 3) =       0.000433967039
  error estimate for blocks of size 2^( 4) =       0.000440226307
  error estimate for blocks of size 2^( 5) =       0.000444691059
  error estimate for blocks of size 2^( 6) =       0.000447407840
  error estimate for blocks of size 2^( 7) =       0.000449265774

      target function =                  N/A
              le_mean =     -17.216652289498
             les_mean =     296.760014056629
             stat err =       0.000445397745
             autocorr =       1.143731313068
              std dev =       0.588980621586
             le_variance =       0.346898172604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415607
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415607
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416472192
  error estimate for blocks of size 2^( 2) =       0.000425562605
  error estimate for blocks of size 2^( 3) =       0.000433967039
  error estimate for blocks of size 2^( 4) =       0.000440226307
  error estimate for blocks of size 2^( 5) =       0.000444691059
  error estimate for blocks of size 2^( 6) =       0.000447407840
  error estimate for blocks of size 2^( 7) =       0.000449265774

      target function =                  N/A
              le_mean =     -17.216652289498
             les_mean =     296.760014056630
             stat err =       0.000445397745
             autocorr =       1.143731313072
              std dev =       0.588980621587
             le_variance =       0.346898172605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415607
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415607
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416472192
  error estimate for blocks of size 2^( 2) =       0.000425562605
  error estimate for blocks of size 2^( 3) =       0.000433967039
  error estimate for blocks of size 2^( 4) =       0.000440226307
  error estimate for blocks of size 2^( 5) =       0.000444691059
  error estimate for blocks of size 2^( 6) =       0.000447407840
  error estimate for blocks of size 2^( 7) =       0.000449265774

      target function =                  N/A
              le_mean =     -17.216652289498
             les_mean =     296.760014056629
             stat err =       0.000445397745
             autocorr =       1.143731313074
              std dev =       0.588980621587
             le_variance =       0.346898172605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415606
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347020415606
                                         uncertainty =       0.030371483845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416472192
  error estimate for blocks of size 2^( 2) =       0.000425562605
  error estimate for blocks of size 2^( 3) =       0.000433967039
  error estimate for blocks of size 2^( 4) =       0.000440226307
  error estimate for blocks of size 2^( 5) =       0.000444691059
  error estimate for blocks of size 2^( 6) =       0.000447407840
  error estimate for blocks of size 2^( 7) =       0.000449265774

      target function =                  N/A
              le_mean =     -17.216652289498
             les_mean =     296.760014056629
             stat err =       0.000445397745
             autocorr =       1.143731313068
              std dev =       0.588980621586
             le_variance =       0.346898172604


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216652289498        initial  <--
     9.3132e+07     9.3132e+08             5.9989e-12       -17.216652289498
     3.7253e+08     3.7253e+09             1.4997e-12       -17.216652289498
     1.4901e+09     1.4901e+10             3.7556e-13       -17.216652289498

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3229
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4952e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2042
    reference variance = 0.263097
====================================================
  Execution time = 2.0092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2028e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5898e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320347704398
                                         uncertainty =       0.003814446423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320347704398
                                         uncertainty =       0.003814446423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400175434
  error estimate for blocks of size 2^( 2) =       0.000409889148
  error estimate for blocks of size 2^( 3) =       0.000418882289
  error estimate for blocks of size 2^( 4) =       0.000425288289
  error estimate for blocks of size 2^( 5) =       0.000429847146
  error estimate for blocks of size 2^( 6) =       0.000431387836
  error estimate for blocks of size 2^( 7) =       0.000433904078

      target function =                  N/A
              le_mean =     -17.216524983372
             les_mean =     296.729013098497
             stat err =       0.000430106837
             autocorr =       1.155185806983
              std dev =       0.565933525756
             le_variance =       0.320280755574


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652498337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524983372       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524983372       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216524983372       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216524656402       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216526978476       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216525498396       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216524749394       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216525972339       residual = 1.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 5.482584e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524983372       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524983372       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216524983372       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216524983372       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216522996705       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216524690758       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216525612680       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216523290489       residual = 1.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 1.371749e-13

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216524983372       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216524983372       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216524983372       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216524983372       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216528699688       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216519421338       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216530935744       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216527896076       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 3.416790e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111332 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5693e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.251951
====================================================
  Execution time = 1.9715e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1735e-01
  Total weights = 2.0000e+06
  Execution time = 1.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398339474
  error estimate for blocks of size 2^( 2) =       0.000408036734
  error estimate for blocks of size 2^( 3) =       0.000416892561
  error estimate for blocks of size 2^( 4) =       0.000423430970
  error estimate for blocks of size 2^( 5) =       0.000427886801
  error estimate for blocks of size 2^( 6) =       0.000429339907
  error estimate for blocks of size 2^( 7) =       0.000428527025

      target function =                  N/A
              le_mean =     -17.216088466736
             les_mean =     296.711050608971
             stat err =       0.000427296175
             autocorr =       1.150671403342
              std dev =       0.563337086608
             le_variance =       0.317348673148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398339474
  error estimate for blocks of size 2^( 2) =       0.000408036734
  error estimate for blocks of size 2^( 3) =       0.000416892561
  error estimate for blocks of size 2^( 4) =       0.000423430970
  error estimate for blocks of size 2^( 5) =       0.000427886801
  error estimate for blocks of size 2^( 6) =       0.000429339907
  error estimate for blocks of size 2^( 7) =       0.000428527025

      target function =                  N/A
              le_mean =     -17.216088466736
             les_mean =     296.711050608971
             stat err =       0.000427296175
             autocorr =       1.150671403343
              std dev =       0.563337086608
             le_variance =       0.317348673148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398339474
  error estimate for blocks of size 2^( 2) =       0.000408036734
  error estimate for blocks of size 2^( 3) =       0.000416892561
  error estimate for blocks of size 2^( 4) =       0.000423430970
  error estimate for blocks of size 2^( 5) =       0.000427886801
  error estimate for blocks of size 2^( 6) =       0.000429339907
  error estimate for blocks of size 2^( 7) =       0.000428527025

      target function =                  N/A
              le_mean =     -17.216088466736
             les_mean =     296.711050608971
             stat err =       0.000427296175
             autocorr =       1.150671403345
              std dev =       0.563337086608
             le_variance =       0.317348673148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317404806731
                                         uncertainty =       0.004056663473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398339474
  error estimate for blocks of size 2^( 2) =       0.000408036734
  error estimate for blocks of size 2^( 3) =       0.000416892561
  error estimate for blocks of size 2^( 4) =       0.000423430970
  error estimate for blocks of size 2^( 5) =       0.000427886801
  error estimate for blocks of size 2^( 6) =       0.000429339907
  error estimate for blocks of size 2^( 7) =       0.000428527025

      target function =                  N/A
              le_mean =     -17.216088466736
             les_mean =     296.711050608971
             stat err =       0.000427296175
             autocorr =       1.150671403342
              std dev =       0.563337086608
             le_variance =       0.317348673148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216088466736        initial  <--
     9.3132e+08     9.3132e+09             5.4826e-13       -17.216088466736
     3.7253e+09     3.7253e+10             1.3717e-13       -17.216088466736
     1.4901e+10     1.4901e+11             3.4168e-14       -17.216088466736

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9269
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4627e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2936
    reference variance = 0.292151
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1117e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5846e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311202607558
                                         uncertainty =       0.002524756560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311202607558
                                         uncertainty =       0.002524756560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394443625
  error estimate for blocks of size 2^( 2) =       0.000404656498
  error estimate for blocks of size 2^( 3) =       0.000413468015
  error estimate for blocks of size 2^( 4) =       0.000420046094
  error estimate for blocks of size 2^( 5) =       0.000424688983
  error estimate for blocks of size 2^( 6) =       0.000425965033
  error estimate for blocks of size 2^( 7) =       0.000423909347

      target function =                  N/A
              le_mean =     -17.216821100447
             les_mean =     296.730100196441
             stat err =       0.000423652364
             autocorr =       1.153584429789
              std dev =       0.557827524626
             le_variance =       0.311171547230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721682110045e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821100447       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821100447       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216821100447       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216821100447       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216829949763       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216823712414       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216821100446       residual = 6.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 7.049886e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821100447       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821100447       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216821100447       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216816559200       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216815984884       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216826721056       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216793374273       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216836517945       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216826915697       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 1.758175e-14

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216821100447       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216821100447       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216821100447       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216847939970       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216905110802       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216821100447       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216794421844       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217178636047       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.215485127065       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216676329395       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216743571501       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.218714504155       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.211110440390       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.214029464193       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.216238019474       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -17.213078098662       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -17.216407784143       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -17.211685435148       residual = 4.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -17.212967591879       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -17.221313869641       residual = 3.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -17.215378160643       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.238012024979       residual = 7.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -17.227122632935       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -17.230287309232       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.243540408605       residual = 1.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.240750923213       residual = 9.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.171133941547       residual = 3.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -17.226234528183       residual = 1.44e-02           smallest_sin_value = 9.99e-01
davidson iteration   28:   krylov dim =  29   energy =     -17.226089434994       residual = 1.40e-02           smallest_sin_value = 9.90e-01
davidson iteration   29 stopping due to small subspace S singular value of 9.39e-01
davidson solver did not converge after         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 4.568885e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.124857 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5895e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1607
    reference variance = 0.298618
====================================================
  Execution time = 1.9830e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1853e-01
  Total weights = 2.0000e+06
  Execution time = 1.8214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399077464
  error estimate for blocks of size 2^( 2) =       0.000409097057
  error estimate for blocks of size 2^( 3) =       0.000417641102
  error estimate for blocks of size 2^( 4) =       0.000423620060
  error estimate for blocks of size 2^( 5) =       0.000428262443
  error estimate for blocks of size 2^( 6) =       0.000431540320
  error estimate for blocks of size 2^( 7) =       0.000431061722

      target function =                  N/A
              le_mean =     -17.217093068453
             les_mean =     296.746819213512
             stat err =       0.000428621136
             autocorr =       1.153540265502
              std dev =       0.564380762429
             le_variance =       0.318525645000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399077464
  error estimate for blocks of size 2^( 2) =       0.000409097057
  error estimate for blocks of size 2^( 3) =       0.000417641102
  error estimate for blocks of size 2^( 4) =       0.000423620060
  error estimate for blocks of size 2^( 5) =       0.000428262443
  error estimate for blocks of size 2^( 6) =       0.000431540320
  error estimate for blocks of size 2^( 7) =       0.000431061722

      target function =                  N/A
              le_mean =     -17.217093068453
             les_mean =     296.746819213512
             stat err =       0.000428621136
             autocorr =       1.153540265508
              std dev =       0.564380762429
             le_variance =       0.318525645000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399077464
  error estimate for blocks of size 2^( 2) =       0.000409097057
  error estimate for blocks of size 2^( 3) =       0.000417641102
  error estimate for blocks of size 2^( 4) =       0.000423620060
  error estimate for blocks of size 2^( 5) =       0.000428262443
  error estimate for blocks of size 2^( 6) =       0.000431540320
  error estimate for blocks of size 2^( 7) =       0.000431061722

      target function =                  N/A
              le_mean =     -17.217093068453
             les_mean =     296.746819213512
             stat err =       0.000428621136
             autocorr =       1.153540265502
              std dev =       0.564380762429
             le_variance =       0.318525645000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318647499945
                                         uncertainty =       0.003175692536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399077464
  error estimate for blocks of size 2^( 2) =       0.000409097057
  error estimate for blocks of size 2^( 3) =       0.000417641102
  error estimate for blocks of size 2^( 4) =       0.000423620060
  error estimate for blocks of size 2^( 5) =       0.000428262443
  error estimate for blocks of size 2^( 6) =       0.000431540320
  error estimate for blocks of size 2^( 7) =       0.000431061722

      target function =                  N/A
              le_mean =     -17.217093068453
             les_mean =     296.746819213512
             stat err =       0.000428621136
             autocorr =       1.153540265508
              std dev =       0.564380762429
             le_variance =       0.318525645000


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217093068453        initial  <--
     9.3132e+09     9.3132e+10             7.0499e-14       -17.217093068453
     3.7253e+10     3.7253e+11             1.7582e-14       -17.217093068453
     1.4901e+11     1.4901e+12             4.5689e-15       -17.217093068453

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0684
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.092219e-01 1 1  ON 0
 uu_1                 4.761369e-02 1 1  ON 1
 uu_2                -4.617534e-02 1 1  ON 2
 uu_3                -1.001517e-01 1 1  ON 3
 uu_4                -1.323161e-01 1 1  ON 4
 uu_5                -1.378896e-01 1 1  ON 5
 uu_6                -1.138877e-01 1 1  ON 6
 uu_7                -4.025748e-02 1 1  ON 7
 uu_8                 9.812491e-02 1 1  ON 8
 uu_9                 1.216106e-01 1 1  ON 9
 ud_0                 3.503500e-01 1 1  ON 10
 ud_1                 9.237105e-02 1 1  ON 11
 ud_2                -1.610654e-02 1 1  ON 12
 ud_3                -7.565966e-02 1 1  ON 13
 ud_4                -1.220656e-01 1 1  ON 14
 ud_5                -1.530493e-01 1 1  ON 15
 ud_6                -1.546804e-01 1 1  ON 16
 ud_7                -1.100049e-01 1 1  ON 17
 ud_8                 2.253570e-03 1 1  ON 18
 ud_9                 9.256140e-02 1 1  ON 19
 eO_0                -7.595258e-01 1 1  ON 20
 eO_1                -4.422063e-01 1 1  ON 21
 eO_2                -3.901423e-02 1 1  ON 22
 eO_3                 2.099528e-01 1 1  ON 23
 eO_4                 2.965987e-01 1 1  ON 24
 eO_5                 3.099120e-01 1 1  ON 25
 eO_6                 2.523012e-01 1 1  ON 26
 eO_7                 1.145068e-01 1 1  ON 27
 eO_8                 2.812302e-02 1 1  ON 28
 eO_9                 1.855298e-02 1 1  ON 29
eH1_0                -1.823622e-01 1 1  ON 30
eH1_1                -1.032389e-01 1 1  ON 31
eH1_2                -6.262441e-02 1 1  ON 32
eH1_3                -2.603707e-02 1 1  ON 33
eH1_4                 1.963211e-02 1 1  ON 34
eH1_5                 3.545138e-02 1 1  ON 35
eH1_6                 7.780067e-02 1 1  ON 36
eH1_7                 1.094644e-01 1 1  ON 37
eH1_8                 9.182231e-02 1 1  ON 38
eH1_9                 2.460273e-02 1 1  ON 39
eH2_0                -1.831671e-01 1 1  ON 40
eH2_1                -1.045118e-01 1 1  ON 41
eH2_2                -6.371439e-02 1 1  ON 42
eH2_3                -2.701386e-02 1 1  ON 43
eH2_4                 1.858008e-02 1 1  ON 44
eH2_5                 3.400759e-02 1 1  ON 45
eH2_6                 7.894991e-02 1 1  ON 46
eH2_7                 1.130483e-01 1 1  ON 47
eH2_8                 9.478598e-02 1 1  ON 48
eH2_9                 2.677442e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4969e+01 secs
  Total Execution time = 2.2127e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
