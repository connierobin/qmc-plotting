Rank =    0  Free Memory = 85020 MB
Rank =    1  Free Memory = 85020 MB
Rank =    2  Free Memory = 85020 MB
Rank =    3  Free Memory = 85020 MB
Rank =    4  Free Memory = 85019 MB
Rank =    5  Free Memory = 85019 MB
Rank =    6  Free Memory = 85018 MB
Rank =    7  Free Memory = 85018 MB
Rank =    8  Free Memory = 85017 MB
Rank =    9  Free Memory = 85017 MB
Rank =   10  Free Memory = 85017 MB
Rank =   11  Free Memory = 85017 MB
Rank =   12  Free Memory = 85017 MB
Rank =   13  Free Memory = 85017 MB
Rank =   14  Free Memory = 85016 MB
Rank =   15  Free Memory = 85003 MB
Rank =   16  Free Memory = 85003 MB
Rank =   17  Free Memory = 85003 MB
Rank =   18  Free Memory = 85003 MB
Rank =   19  Free Memory = 85003 MB
Rank =   20  Free Memory = 85003 MB
Rank =   21  Free Memory = 85003 MB
Rank =   22  Free Memory = 85003 MB
Rank =   23  Free Memory = 85003 MB
Rank =   24  Free Memory = 85003 MB
Rank =   25  Free Memory = 85003 MB
Rank =   26  Free Memory = 85003 MB
Rank =   27  Free Memory = 85003 MB
Rank =   28  Free Memory = 85003 MB
Rank =   29  Free Memory = 85003 MB
Rank =   30  Free Memory = 85003 MB
Rank =   31  Free Memory = 85003 MB
Rank =   32  Free Memory = 90145 MB
Rank =   33  Free Memory = 90145 MB
Rank =   34  Free Memory = 90145 MB
Rank =   35  Free Memory = 90145 MB
Rank =   36  Free Memory = 90145 MB
Rank =   37  Free Memory = 90145 MB
Rank =   38  Free Memory = 90145 MB
Rank =   39  Free Memory = 90145 MB
Rank =   40  Free Memory = 90145 MB
Rank =   41  Free Memory = 90145 MB
Rank =   42  Free Memory = 90145 MB
Rank =   43  Free Memory = 90145 MB
Rank =   44  Free Memory = 90145 MB
Rank =   45  Free Memory = 90145 MB
Rank =   46  Free Memory = 90145 MB
Rank =   47  Free Memory = 90145 MB
Rank =   48  Free Memory = 90145 MB
Rank =   49  Free Memory = 90145 MB
Rank =   50  Free Memory = 90145 MB
Rank =   51  Free Memory = 90145 MB
Rank =   52  Free Memory = 90145 MB
Rank =   53  Free Memory = 90145 MB
Rank =   54  Free Memory = 90145 MB
Rank =   55  Free Memory = 90145 MB
Rank =   56  Free Memory = 90145 MB
Rank =   57  Free Memory = 90145 MB
Rank =   58  Free Memory = 90145 MB
Rank =   59  Free Memory = 90145 MB
Rank =   60  Free Memory = 90145 MB
Rank =   61  Free Memory = 90145 MB
Rank =   62  Free Memory = 90145 MB
Rank =   63  Free Memory = 90145 MB
Rank =   64  Free Memory = 87451 MB
Rank =   65  Free Memory = 87451 MB
Rank =   66  Free Memory = 87451 MB
Rank =   67  Free Memory = 87451 MB
Rank =   68  Free Memory = 87451 MB
Rank =   69  Free Memory = 87451 MB
Rank =   70  Free Memory = 87451 MB
Rank =   71  Free Memory = 87451 MB
Rank =   72  Free Memory = 87451 MB
Rank =   73  Free Memory = 87451 MB
Rank =   74  Free Memory = 87451 MB
Rank =   75  Free Memory = 87451 MB
Rank =   76  Free Memory = 87451 MB
Rank =   77  Free Memory = 87451 MB
Rank =   78  Free Memory = 87451 MB
Rank =   79  Free Memory = 87451 MB
Rank =   80  Free Memory = 87451 MB
Rank =   81  Free Memory = 87451 MB
Rank =   82  Free Memory = 87451 MB
Rank =   83  Free Memory = 87451 MB
Rank =   84  Free Memory = 87451 MB
Rank =   85  Free Memory = 87451 MB
Rank =   86  Free Memory = 87451 MB
Rank =   87  Free Memory = 87451 MB
Rank =   88  Free Memory = 87451 MB
Rank =   89  Free Memory = 87451 MB
Rank =   90  Free Memory = 87451 MB
Rank =   91  Free Memory = 87451 MB
Rank =   92  Free Memory = 87451 MB
Rank =   93  Free Memory = 87451 MB
Rank =   94  Free Memory = 87451 MB
Rank =   95  Free Memory = 87451 MB
Rank =   96  Free Memory = 89814 MB
Rank =   97  Free Memory = 89814 MB
Rank =   98  Free Memory = 89814 MB
Rank =   99  Free Memory = 89814 MB
Rank =  100  Free Memory = 89814 MB
Rank =  101  Free Memory = 89814 MB
Rank =  102  Free Memory = 89814 MB
Rank =  103  Free Memory = 89814 MB
Rank =  104  Free Memory = 89814 MB
Rank =  105  Free Memory = 89814 MB
Rank =  106  Free Memory = 89814 MB
Rank =  107  Free Memory = 89814 MB
Rank =  108  Free Memory = 89814 MB
Rank =  109  Free Memory = 89814 MB
Rank =  110  Free Memory = 89814 MB
Rank =  111  Free Memory = 89814 MB
Rank =  112  Free Memory = 89814 MB
Rank =  113  Free Memory = 89814 MB
Rank =  114  Free Memory = 89814 MB
Rank =  115  Free Memory = 89814 MB
Rank =  116  Free Memory = 89814 MB
Rank =  117  Free Memory = 89814 MB
Rank =  118  Free Memory = 89814 MB
Rank =  119  Free Memory = 89814 MB
Rank =  120  Free Memory = 89814 MB
Rank =  121  Free Memory = 89814 MB
Rank =  122  Free Memory = 89814 MB
Rank =  123  Free Memory = 89814 MB
Rank =  124  Free Memory = 89814 MB
Rank =  125  Free Memory = 89814 MB
Rank =  126  Free Memory = 89814 MB
Rank =  127  Free Memory = 89814 MB
  Input file(s): opt_h2o_gs_gvptt_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_gvptt_run001f.xml

  Project = H2O
  date    = 2023-03-06 13:52:10 PST
  host    = n0025.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 138

  Range of prime numbers to use as seeds over processors and threads = 809-1721


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.092219e-01    1         1  ON     0
     uu_1                 4.761369e-02    1         1  ON     1
     uu_2                -4.617534e-02    1         1  ON     2
     uu_3                -1.001517e-01    1         1  ON     3
     uu_4                -1.323161e-01    1         1  ON     4
     uu_5                -1.378896e-01    1         1  ON     5
     uu_6                -1.138877e-01    1         1  ON     6
     uu_7                -4.025748e-02    1         1  ON     7
     uu_8                 9.812491e-02    1         1  ON     8
     uu_9                 1.216106e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.503500e-01    1         1  ON     0
     ud_1                 9.237105e-02    1         1  ON     1
     ud_2                -1.610654e-02    1         1  ON     2
     ud_3                -7.565966e-02    1         1  ON     3
     ud_4                -1.220656e-01    1         1  ON     4
     ud_5                -1.530493e-01    1         1  ON     5
     ud_6                -1.546804e-01    1         1  ON     6
     ud_7                -1.100049e-01    1         1  ON     7
     ud_8                 2.253570e-03    1         1  ON     8
     ud_9                 9.256140e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.595258e-01    1         1  ON     0
     eO_1                -4.422063e-01    1         1  ON     1
     eO_2                -3.901423e-02    1         1  ON     2
     eO_3                 2.099528e-01    1         1  ON     3
     eO_4                 2.965987e-01    1         1  ON     4
     eO_5                 3.099120e-01    1         1  ON     5
     eO_6                 2.523012e-01    1         1  ON     6
     eO_7                 1.145068e-01    1         1  ON     7
     eO_8                 2.812302e-02    1         1  ON     8
     eO_9                 1.855298e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.823622e-01    1         1  ON     0
     eH1_1                -1.032389e-01    1         1  ON     1
     eH1_2                -6.262441e-02    1         1  ON     2
     eH1_3                -2.603707e-02    1         1  ON     3
     eH1_4                 1.963211e-02    1         1  ON     4
     eH1_5                 3.545138e-02    1         1  ON     5
     eH1_6                 7.780067e-02    1         1  ON     6
     eH1_7                 1.094644e-01    1         1  ON     7
     eH1_8                 9.182231e-02    1         1  ON     8
     eH1_9                 2.460273e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.831671e-01    1         1  ON     0
     eH2_1                -1.045118e-01    1         1  ON     1
     eH2_2                -6.371439e-02    1         1  ON     2
     eH2_3                -2.701386e-02    1         1  ON     3
     eH2_4                 1.858008e-02    1         1  ON     4
     eH2_5                 3.400759e-02    1         1  ON     5
     eH2_6                 7.894991e-02    1         1  ON     6
     eH2_7                 1.130483e-01    1         1  ON     7
     eH2_8                 9.478598e-02    1         1  ON     8
     eH2_9                 2.677442e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.700740e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.7285e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2723
    reference variance = 0.178426
====================================================
  Execution time = 2.0668e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2424e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324242366276
                                         uncertainty =       0.009230958445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324242366276
                                         uncertainty =       0.009230958445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402643735
  error estimate for blocks of size 2^( 2) =       0.000411973764
  error estimate for blocks of size 2^( 3) =       0.000420041817
  error estimate for blocks of size 2^( 4) =       0.000427198248
  error estimate for blocks of size 2^( 5) =       0.000431269949
  error estimate for blocks of size 2^( 6) =       0.000433413640
  error estimate for blocks of size 2^( 7) =       0.000435904821

      target function =                  N/A
              le_mean =     -17.217000128478
             les_mean =     296.749337216704
             stat err =       0.000431946664
             autocorr =       1.150849032962
              std dev =       0.569424230962
             le_variance =       0.324243954807


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721700012848e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217000128478       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217001189101       residual = 7.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217002407475       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217006343166       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217010801671       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217011531710       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217011033159       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217011205173       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217011195287       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217011561547       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217011553257       residual = 3.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.845399e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217000128478       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217000535920       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217000917692       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217002331640       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217004018590       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217003789808       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217003802771       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217003708285       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217003746845       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 8.066230e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217000128478       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217000246121       residual = 9.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217000351217       residual = 7.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217000752238       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217001230807       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217001151723       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217001145488       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217001128516       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.072093e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.191781 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6350e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  2.094130e-01                 1 1 ON  0
uu_1  4.777644e-02                 1 1 ON  1
uu_2  -4.617760e-02                1 1 ON  2
uu_3  -1.002222e-01                1 1 ON  3
uu_4  -1.323304e-01                1 1 ON  4
uu_5  -1.379143e-01                1 1 ON  5
uu_6  -1.140396e-01                1 1 ON  6
uu_7  -4.041734e-02                1 1 ON  7
uu_8  9.804498e-02                 1 1 ON  8
uu_9  1.216733e-01                 1 1 ON  9
ud_0  3.506268e-01                 1 1 ON  10
ud_1  9.258760e-02                 1 1 ON  11
ud_2  -1.610614e-02                1 1 ON  12
ud_3  -7.587225e-02                1 1 ON  13
ud_4  -1.222670e-01                1 1 ON  14
ud_5  -1.530493e-01                1 1 ON  15
ud_6  -1.546806e-01                1 1 ON  16
ud_7  -1.100533e-01                1 1 ON  17
ud_8  2.130383e-03                 1 1 ON  18
ud_9  9.256238e-02                 1 1 ON  19
eO_0  -7.603325e-01                1 1 ON  20
eO_1  -4.427921e-01                1 1 ON  21
eO_2  -3.889312e-02                1 1 ON  22
eO_3  2.103275e-01                 1 1 ON  23
eO_4  2.971302e-01                 1 1 ON  24
eO_5  3.100591e-01                 1 1 ON  25
eO_6  2.523632e-01                 1 1 ON  26
eO_7  1.146211e-01                 1 1 ON  27
eO_8  2.814350e-02                 1 1 ON  28
eO_9  1.856343e-02                 1 1 ON  29
eH1_0 -1.824817e-01                1 1 ON  30
eH1_1 -1.033123e-01                1 1 ON  31
eH1_2 -6.260189e-02                1 1 ON  32
eH1_3 -2.600470e-02                1 1 ON  33
eH1_4 1.966259e-02                 1 1 ON  34
eH1_5 3.545080e-02                 1 1 ON  35
eH1_6 7.780737e-02                 1 1 ON  36
eH1_7 1.094634e-01                 1 1 ON  37
eH1_8 9.188727e-02                 1 1 ON  38
eH1_9 2.462884e-02                 1 1 ON  39
eH2_0 -1.832952e-01                1 1 ON  40
eH2_1 -1.044861e-01                1 1 ON  41
eH2_2 -6.371062e-02                1 1 ON  42
eH2_3 -2.702221e-02                1 1 ON  43
eH2_4 1.853296e-02                 1 1 ON  44
eH2_5 3.409956e-02                 1 1 ON  45
eH2_6 7.894642e-02                 1 1 ON  46
eH2_7 1.130180e-01                 1 1 ON  47
eH2_8 9.484370e-02                 1 1 ON  48
eH2_9 2.679892e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.264
    reference variance = 0.230156
====================================================
  Execution time = 2.0428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3793e-01
  Total weights = 2.0000e+06
  Execution time = 1.8753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337778129850
                                         uncertainty =       0.025470010468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337778129850
                                         uncertainty =       0.025470010468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410888991
  error estimate for blocks of size 2^( 2) =       0.000420484375
  error estimate for blocks of size 2^( 3) =       0.000429198333
  error estimate for blocks of size 2^( 4) =       0.000436314825
  error estimate for blocks of size 2^( 5) =       0.000439852577
  error estimate for blocks of size 2^( 6) =       0.000443241250
  error estimate for blocks of size 2^( 7) =       0.000445446822

      target function =                  N/A
              le_mean =     -17.217421102030
             les_mean =     296.777248761639
             stat err =       0.000441213869
             autocorr =       1.153053078333
              std dev =       0.581084783685
             le_variance =       0.337659525830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338581712119
                                         uncertainty =       0.025552386484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338581712119
                                         uncertainty =       0.025552386484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411377323
  error estimate for blocks of size 2^( 2) =       0.000420946473
  error estimate for blocks of size 2^( 3) =       0.000429626944
  error estimate for blocks of size 2^( 4) =       0.000436712215
  error estimate for blocks of size 2^( 5) =       0.000440233137
  error estimate for blocks of size 2^( 6) =       0.000443602759
  error estimate for blocks of size 2^( 7) =       0.000445794187

      target function =                  N/A
              le_mean =     -17.217423075665
             les_mean =     296.778119801001
             stat err =       0.000441585574
             autocorr =       1.152256215224
              std dev =       0.581775389460
             le_variance =       0.338462603782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338314455802
                                         uncertainty =       0.025542404673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338314455802
                                         uncertainty =       0.025542404673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214961
  error estimate for blocks of size 2^( 2) =       0.000420792874
  error estimate for blocks of size 2^( 3) =       0.000429485016
  error estimate for blocks of size 2^( 4) =       0.000436579001
  error estimate for blocks of size 2^( 5) =       0.000440105852
  error estimate for blocks of size 2^( 6) =       0.000443481972
  error estimate for blocks of size 2^( 7) =       0.000445673299

      target function =                  N/A
              le_mean =     -17.217422042104
             les_mean =     296.777817094811
             stat err =       0.000441460031
             autocorr =       1.152510698564
              std dev =       0.581545774613
             le_variance =       0.338195487971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337850308126
                                         uncertainty =       0.025480545513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337850308126
                                         uncertainty =       0.025480545513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410932873
  error estimate for blocks of size 2^( 2) =       0.000420525803
  error estimate for blocks of size 2^( 3) =       0.000429236758
  error estimate for blocks of size 2^( 4) =       0.000436350046
  error estimate for blocks of size 2^( 5) =       0.000439886324
  error estimate for blocks of size 2^( 6) =       0.000443273373
  error estimate for blocks of size 2^( 7) =       0.000445476856

      target function =                  N/A
              le_mean =     -17.217421109899
             les_mean =     296.777321159602
             stat err =       0.000441246650
             autocorr =       1.152978136628
              std dev =       0.581146842771
             le_variance =       0.337731652863


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217421102030        initial
     2.5000e-01     2.5000e+00             2.8454e-03       -17.217423075665  <--
     1.0000e+00     1.0000e+01             8.0662e-04       -17.217422042104
     4.0000e+00     4.0000e+01             2.0721e-04       -17.217421109899

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9882e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 2.099370e-01 1 1  ON 0
 uu_1                 4.813513e-02 1 1  ON 1
 uu_2                -4.606452e-02 1 1  ON 2
 uu_3                -1.003143e-01 1 1  ON 3
 uu_4                -1.324675e-01 1 1  ON 4
 uu_5                -1.380768e-01 1 1  ON 5
 uu_6                -1.144080e-01 1 1  ON 6
 uu_7                -4.086559e-02 1 1  ON 7
 uu_8                 9.780650e-02 1 1  ON 8
 uu_9                 1.218622e-01 1 1  ON 9
 ud_0                 3.512322e-01 1 1  ON 10
 ud_1                 9.299244e-02 1 1  ON 11
 ud_2                -1.604464e-02 1 1  ON 12
 ud_3                -7.620413e-02 1 1  ON 13
 ud_4                -1.227137e-01 1 1  ON 14
 ud_5                -1.532000e-01 1 1  ON 15
 ud_6                -1.546494e-01 1 1  ON 16
 ud_7                -1.101490e-01 1 1  ON 17
 ud_8                 1.773503e-03 1 1  ON 18
 ud_9                 9.256673e-02 1 1  ON 19
 eO_0                -7.623712e-01 1 1  ON 20
 eO_1                -4.442485e-01 1 1  ON 21
 eO_2                -3.895985e-02 1 1  ON 22
 eO_3                 2.111317e-01 1 1  ON 23
 eO_4                 2.986595e-01 1 1  ON 24
 eO_5                 3.105970e-01 1 1  ON 25
 eO_6                 2.525794e-01 1 1  ON 26
 eO_7                 1.149691e-01 1 1  ON 27
 eO_8                 2.820557e-02 1 1  ON 28
 eO_9                 1.859497e-02 1 1  ON 29
eH1_0                -1.827925e-01 1 1  ON 30
eH1_1                -1.034945e-01 1 1  ON 31
eH1_2                -6.257528e-02 1 1  ON 32
eH1_3                -2.594464e-02 1 1  ON 33
eH1_4                 1.970461e-02 1 1  ON 34
eH1_5                 3.544293e-02 1 1  ON 35
eH1_6                 7.785658e-02 1 1  ON 36
eH1_7                 1.094753e-01 1 1  ON 37
eH1_8                 9.208529e-02 1 1  ON 38
eH1_9                 2.470781e-02 1 1  ON 39
eH2_0                -1.835944e-01 1 1  ON 40
eH2_1                -1.045104e-01 1 1  ON 41
eH2_2                -6.370486e-02 1 1  ON 42
eH2_3                -2.702812e-02 1 1  ON 43
eH2_4                 1.841189e-02 1 1  ON 44
eH2_5                 3.430173e-02 1 1  ON 45
eH2_6                 7.896841e-02 1 1  ON 46
eH2_7                 1.129465e-01 1 1  ON 47
eH2_8                 9.502038e-02 1 1  ON 48
eH2_9                 2.687312e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6238e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7268e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1615
    reference variance = 0.174587
====================================================
  Execution time = 2.0000e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1801e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318013742476
                                         uncertainty =       0.003000107432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318013742476
                                         uncertainty =       0.003000107432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398753088
  error estimate for blocks of size 2^( 2) =       0.000408354068
  error estimate for blocks of size 2^( 3) =       0.000417049254
  error estimate for blocks of size 2^( 4) =       0.000423461356
  error estimate for blocks of size 2^( 5) =       0.000429070223
  error estimate for blocks of size 2^( 6) =       0.000431871209
  error estimate for blocks of size 2^( 7) =       0.000432581163

      target function =                  N/A
              le_mean =     -17.216770178992
             les_mean =     296.735183286896
             stat err =       0.000429245988
             autocorr =       1.158789018950
              std dev =       0.563922024475
             le_variance =       0.318008049688


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677017899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770178992       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216770171889       residual = 5.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216771083400       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216774584193       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216778486530       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216783672786       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216783460083       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216781351032       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216781247907       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216782938847       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216783071847       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216781812515       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216782243473       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.216782791343       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.731227e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770178992       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216770174670       residual = 6.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216770626617       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216772796495       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216774405565       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216775181110       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216774507103       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216774121712       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216774224291       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216774467109       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.206206e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216770178992       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216770177307       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216770331773       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216771190210       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216771246006       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216771540022       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216771471790       residual = 3.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216771335510       residual = 6.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.336111e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196930 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5492e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.104604e-01 1 1  ON 0
 uu_1                 4.874232e-02 1 1  ON 1
 uu_2                -4.566226e-02 1 1  ON 2
 uu_3                -1.001996e-01 1 1  ON 3
 uu_4                -1.326208e-01 1 1  ON 4
 uu_5                -1.383323e-01 1 1  ON 5
 uu_6                -1.148223e-01 1 1  ON 6
 uu_7                -4.166975e-02 1 1  ON 7
 uu_8                 9.730300e-02 1 1  ON 8
 uu_9                 1.219842e-01 1 1  ON 9
 ud_0                 3.518918e-01 1 1  ON 10
 ud_1                 9.328724e-02 1 1  ON 11
 ud_2                -1.604547e-02 1 1  ON 12
 ud_3                -7.631233e-02 1 1  ON 13
 ud_4                -1.229550e-01 1 1  ON 14
 ud_5                -1.532790e-01 1 1  ON 15
 ud_6                -1.546201e-01 1 1  ON 16
 ud_7                -1.103288e-01 1 1  ON 17
 ud_8                 1.125123e-03 1 1  ON 18
 ud_9                 9.249689e-02 1 1  ON 19
 eO_0                -7.645775e-01 1 1  ON 20
 eO_1                -4.456396e-01 1 1  ON 21
 eO_2                -3.942196e-02 1 1  ON 22
 eO_3                 2.118737e-01 1 1  ON 23
 eO_4                 3.002633e-01 1 1  ON 24
 eO_5                 3.114575e-01 1 1  ON 25
 eO_6                 2.529554e-01 1 1  ON 26
 eO_7                 1.153405e-01 1 1  ON 27
 eO_8                 2.823385e-02 1 1  ON 28
 eO_9                 1.860298e-02 1 1  ON 29
eH1_0                -1.829429e-01 1 1  ON 30
eH1_1                -1.036306e-01 1 1  ON 31
eH1_2                -6.271431e-02 1 1  ON 32
eH1_3                -2.590644e-02 1 1  ON 33
eH1_4                 1.991155e-02 1 1  ON 34
eH1_5                 3.536351e-02 1 1  ON 35
eH1_6                 7.788514e-02 1 1  ON 36
eH1_7                 1.093458e-01 1 1  ON 37
eH1_8                 9.230765e-02 1 1  ON 38
eH1_9                 2.476331e-02 1 1  ON 39
eH2_0                -1.838202e-01 1 1  ON 40
eH2_1                -1.046244e-01 1 1  ON 41
eH2_2                -6.379019e-02 1 1  ON 42
eH2_3                -2.686108e-02 1 1  ON 43
eH2_4                 1.870250e-02 1 1  ON 44
eH2_5                 3.415635e-02 1 1  ON 45
eH2_6                 7.889464e-02 1 1  ON 46
eH2_7                 1.128626e-01 1 1  ON 47
eH2_8                 9.519372e-02 1 1  ON 48
eH2_9                 2.694656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1509
    reference variance = 0.17295
====================================================
  Execution time = 1.9802e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1688e-01
  Total weights = 2.0000e+06
  Execution time = 1.8767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316272877363
                                         uncertainty =       0.002871369352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316272877363
                                         uncertainty =       0.002871369352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397667822
  error estimate for blocks of size 2^( 2) =       0.000407143202
  error estimate for blocks of size 2^( 3) =       0.000416032264
  error estimate for blocks of size 2^( 4) =       0.000422245526
  error estimate for blocks of size 2^( 5) =       0.000425523127
  error estimate for blocks of size 2^( 6) =       0.000428471473
  error estimate for blocks of size 2^( 7) =       0.000429959567

      target function =                  N/A
              le_mean =     -17.216865815279
             les_mean =     296.736747737025
             stat err =       0.000426549923
             autocorr =       1.150532349764
              std dev =       0.562387227664
             le_variance =       0.316279393840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317465914655
                                         uncertainty =       0.002879179325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317465914655
                                         uncertainty =       0.002879179325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398417242
  error estimate for blocks of size 2^( 2) =       0.000407842587
  error estimate for blocks of size 2^( 3) =       0.000416676850
  error estimate for blocks of size 2^( 4) =       0.000422842748
  error estimate for blocks of size 2^( 5) =       0.000426095300
  error estimate for blocks of size 2^( 6) =       0.000429035459
  error estimate for blocks of size 2^( 7) =       0.000430527660

      target function =                  N/A
              le_mean =     -17.216863526608
             les_mean =     296.737862132190
             stat err =       0.000427125292
             autocorr =       1.149302438356
              std dev =       0.563447066808
             le_variance =       0.317472597094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317487474898
                                         uncertainty =       0.002879709353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317487474898
                                         uncertainty =       0.002879709353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398430748
  error estimate for blocks of size 2^( 2) =       0.000407858091
  error estimate for blocks of size 2^( 3) =       0.000416699128
  error estimate for blocks of size 2^( 4) =       0.000422874357
  error estimate for blocks of size 2^( 5) =       0.000426132662
  error estimate for blocks of size 2^( 6) =       0.000429077294
  error estimate for blocks of size 2^( 7) =       0.000430567320

      target function =                  N/A
              le_mean =     -17.216864612108
             les_mean =     296.737921034049
             stat err =       0.000427162908
             autocorr =       1.149426952631
              std dev =       0.563466166797
             le_variance =       0.317494121125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316489745763
                                         uncertainty =       0.002872869676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316489745763
                                         uncertainty =       0.002872869676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397804148
  error estimate for blocks of size 2^( 2) =       0.000407270561
  error estimate for blocks of size 2^( 3) =       0.000416151284
  error estimate for blocks of size 2^( 4) =       0.000422358426
  error estimate for blocks of size 2^( 5) =       0.000425633240
  error estimate for blocks of size 2^( 6) =       0.000428581358
  error estimate for blocks of size 2^( 7) =       0.000430069888

      target function =                  N/A
              le_mean =     -17.216865417935
             les_mean =     296.736950940933
             stat err =       0.000426660728
             autocorr =       1.150341337505
              std dev =       0.562580020866
             le_variance =       0.316496279878


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216865815279        initial  <--
     6.2500e-02     6.2500e-01             6.7312e-03       -17.216863526608
     2.5000e-01     2.5000e+00             2.2062e-03       -17.216864612108
     1.0000e+00     1.0000e+01             6.3361e-04       -17.216865417935

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2469
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 2.099370e-01 1 1  ON 0
 uu_1                 4.813513e-02 1 1  ON 1
 uu_2                -4.606452e-02 1 1  ON 2
 uu_3                -1.003143e-01 1 1  ON 3
 uu_4                -1.324675e-01 1 1  ON 4
 uu_5                -1.380768e-01 1 1  ON 5
 uu_6                -1.144080e-01 1 1  ON 6
 uu_7                -4.086559e-02 1 1  ON 7
 uu_8                 9.780650e-02 1 1  ON 8
 uu_9                 1.218622e-01 1 1  ON 9
 ud_0                 3.512322e-01 1 1  ON 10
 ud_1                 9.299244e-02 1 1  ON 11
 ud_2                -1.604464e-02 1 1  ON 12
 ud_3                -7.620413e-02 1 1  ON 13
 ud_4                -1.227137e-01 1 1  ON 14
 ud_5                -1.532000e-01 1 1  ON 15
 ud_6                -1.546494e-01 1 1  ON 16
 ud_7                -1.101490e-01 1 1  ON 17
 ud_8                 1.773503e-03 1 1  ON 18
 ud_9                 9.256673e-02 1 1  ON 19
 eO_0                -7.623712e-01 1 1  ON 20
 eO_1                -4.442485e-01 1 1  ON 21
 eO_2                -3.895985e-02 1 1  ON 22
 eO_3                 2.111317e-01 1 1  ON 23
 eO_4                 2.986595e-01 1 1  ON 24
 eO_5                 3.105970e-01 1 1  ON 25
 eO_6                 2.525794e-01 1 1  ON 26
 eO_7                 1.149691e-01 1 1  ON 27
 eO_8                 2.820557e-02 1 1  ON 28
 eO_9                 1.859497e-02 1 1  ON 29
eH1_0                -1.827925e-01 1 1  ON 30
eH1_1                -1.034945e-01 1 1  ON 31
eH1_2                -6.257528e-02 1 1  ON 32
eH1_3                -2.594464e-02 1 1  ON 33
eH1_4                 1.970461e-02 1 1  ON 34
eH1_5                 3.544293e-02 1 1  ON 35
eH1_6                 7.785658e-02 1 1  ON 36
eH1_7                 1.094753e-01 1 1  ON 37
eH1_8                 9.208529e-02 1 1  ON 38
eH1_9                 2.470781e-02 1 1  ON 39
eH2_0                -1.835944e-01 1 1  ON 40
eH2_1                -1.045104e-01 1 1  ON 41
eH2_2                -6.370486e-02 1 1  ON 42
eH2_3                -2.702812e-02 1 1  ON 43
eH2_4                 1.841189e-02 1 1  ON 44
eH2_5                 3.430173e-02 1 1  ON 45
eH2_6                 7.896841e-02 1 1  ON 46
eH2_7                 1.129465e-01 1 1  ON 47
eH2_8                 9.502038e-02 1 1  ON 48
eH2_9                 2.687312e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4744e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2331
    reference variance = 0.462821
====================================================
  Execution time = 2.0060e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2113e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321135875860
                                         uncertainty =       0.005218572053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321135875860
                                         uncertainty =       0.005218572053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400706636
  error estimate for blocks of size 2^( 2) =       0.000410145094
  error estimate for blocks of size 2^( 3) =       0.000418848284
  error estimate for blocks of size 2^( 4) =       0.000425633908
  error estimate for blocks of size 2^( 5) =       0.000429023216
  error estimate for blocks of size 2^( 6) =       0.000430259053
  error estimate for blocks of size 2^( 7) =       0.000430641995

      target function =                  N/A
              le_mean =     -17.217116820722
             les_mean =     296.750243073625
             stat err =       0.000428889543
             autocorr =       1.145612772040
              std dev =       0.566684758748
             le_variance =       0.321131615797


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721711682072e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217116820722       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217116711099       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217116891334       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217117718505       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217117868522       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217118423728       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217118895697       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217118792307       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217118656465       residual = 7.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 1.213223e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217116820722       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217116784246       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217116839324       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217117049211       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217117083009       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217117191832       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217117292720       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217117272557       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 3.363272e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217116820722       residual = 6.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217116810780       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217116825423       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217116877837       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217116885420       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217116907874       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217116931537       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217116928338       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 8.701322e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199832 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5558e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.099811e-01 1 1  ON 0
 uu_1                 4.818188e-02 1 1  ON 1
 uu_2                -4.602792e-02 1 1  ON 2
 uu_3                -1.002751e-01 1 1  ON 3
 uu_4                -1.325059e-01 1 1  ON 4
 uu_5                -1.381249e-01 1 1  ON 5
 uu_6                -1.144688e-01 1 1  ON 6
 uu_7                -4.091750e-02 1 1  ON 7
 uu_8                 9.778648e-02 1 1  ON 8
 uu_9                 1.218866e-01 1 1  ON 9
 ud_0                 3.513281e-01 1 1  ON 10
 ud_1                 9.301578e-02 1 1  ON 11
 ud_2                -1.608232e-02 1 1  ON 12
 ud_3                -7.622973e-02 1 1  ON 13
 ud_4                -1.227653e-01 1 1  ON 14
 ud_5                -1.532307e-01 1 1  ON 15
 ud_6                -1.546074e-01 1 1  ON 16
 ud_7                -1.101520e-01 1 1  ON 17
 ud_8                 1.732588e-03 1 1  ON 18
 ud_9                 9.256864e-02 1 1  ON 19
 eO_0                -7.627076e-01 1 1  ON 20
 eO_1                -4.443504e-01 1 1  ON 21
 eO_2                -3.899169e-02 1 1  ON 22
 eO_3                 2.112577e-01 1 1  ON 23
 eO_4                 2.988219e-01 1 1  ON 24
 eO_5                 3.106658e-01 1 1  ON 25
 eO_6                 2.526260e-01 1 1  ON 26
 eO_7                 1.150203e-01 1 1  ON 27
 eO_8                 2.821401e-02 1 1  ON 28
 eO_9                 1.859878e-02 1 1  ON 29
eH1_0                -1.828127e-01 1 1  ON 30
eH1_1                -1.034656e-01 1 1  ON 31
eH1_2                -6.258773e-02 1 1  ON 32
eH1_3                -2.594436e-02 1 1  ON 33
eH1_4                 1.964687e-02 1 1  ON 34
eH1_5                 3.545165e-02 1 1  ON 35
eH1_6                 7.787362e-02 1 1  ON 36
eH1_7                 1.094696e-01 1 1  ON 37
eH1_8                 9.211224e-02 1 1  ON 38
eH1_9                 2.471777e-02 1 1  ON 39
eH2_0                -1.836310e-01 1 1  ON 40
eH2_1                -1.045244e-01 1 1  ON 41
eH2_2                -6.370224e-02 1 1  ON 42
eH2_3                -2.701951e-02 1 1  ON 43
eH2_4                 1.840882e-02 1 1  ON 44
eH2_5                 3.431320e-02 1 1  ON 45
eH2_6                 7.897035e-02 1 1  ON 46
eH2_7                 1.129421e-01 1 1  ON 47
eH2_8                 9.504447e-02 1 1  ON 48
eH2_9                 2.688103e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1287
    reference variance = 0.2951
====================================================
  Execution time = 2.0118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1236e-01
  Total weights = 2.0000e+06
  Execution time = 1.8776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312068100257
                                         uncertainty =       0.002182745817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312068100257
                                         uncertainty =       0.002182745817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395128826
  error estimate for blocks of size 2^( 2) =       0.000404603204
  error estimate for blocks of size 2^( 3) =       0.000413520021
  error estimate for blocks of size 2^( 4) =       0.000419265020
  error estimate for blocks of size 2^( 5) =       0.000422969564
  error estimate for blocks of size 2^( 6) =       0.000423301027
  error estimate for blocks of size 2^( 7) =       0.000424623497

      target function =                  N/A
              le_mean =     -17.216514874780
             les_mean =     296.720637854953
             stat err =       0.000422539777
             autocorr =       1.143556878428
              std dev =       0.558796543965
             le_variance =       0.312253577547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312405917686
                                         uncertainty =       0.002185427528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312405917686
                                         uncertainty =       0.002185427528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395342787
  error estimate for blocks of size 2^( 2) =       0.000404803477
  error estimate for blocks of size 2^( 3) =       0.000413708831
  error estimate for blocks of size 2^( 4) =       0.000419445956
  error estimate for blocks of size 2^( 5) =       0.000423149535
  error estimate for blocks of size 2^( 6) =       0.000423482567
  error estimate for blocks of size 2^( 7) =       0.000424803054

      target function =                  N/A
              le_mean =     -17.216513093998
             les_mean =     296.720914797845
             stat err =       0.000422720278
             autocorr =       1.143295580757
              std dev =       0.559099131055
             le_variance =       0.312591838347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312282742605
                                         uncertainty =       0.002184361515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312282742605
                                         uncertainty =       0.002184361515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395264770
  error estimate for blocks of size 2^( 2) =       0.000404730282
  error estimate for blocks of size 2^( 3) =       0.000413639958
  error estimate for blocks of size 2^( 4) =       0.000419379998
  error estimate for blocks of size 2^( 5) =       0.000423084289
  error estimate for blocks of size 2^( 6) =       0.000423417473
  error estimate for blocks of size 2^( 7) =       0.000424738852

      target function =                  N/A
              le_mean =     -17.216513718478
             les_mean =     296.720812939614
             stat err =       0.000422655153
             autocorr =       1.143394557912
              std dev =       0.558988798923
             le_variance =       0.312468477321

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312097088949
                                         uncertainty =       0.002182960850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312097088949
                                         uncertainty =       0.002182960850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395147188
  error estimate for blocks of size 2^( 2) =       0.000404620349
  error estimate for blocks of size 2^( 3) =       0.000413536201
  error estimate for blocks of size 2^( 4) =       0.000419280523
  error estimate for blocks of size 2^( 5) =       0.000422985051
  error estimate for blocks of size 2^( 6) =       0.000423316775
  error estimate for blocks of size 2^( 7) =       0.000424639114

      target function =                  N/A
              le_mean =     -17.216514703989
             les_mean =     296.720660996232
             stat err =       0.000422555366
             autocorr =       1.143534972910
              std dev =       0.558822511804
             le_variance =       0.312282599699


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216514874780        initial  <--
     6.2500e-01     6.2500e+00             1.2132e-03       -17.216513093998
     2.5000e+00     2.5000e+01             3.3633e-04       -17.216513718478
     1.0000e+01     1.0000e+02             8.7013e-05       -17.216514703989

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4863
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 2.099370e-01 1 1  ON 0
 uu_1                 4.813513e-02 1 1  ON 1
 uu_2                -4.606452e-02 1 1  ON 2
 uu_3                -1.003143e-01 1 1  ON 3
 uu_4                -1.324675e-01 1 1  ON 4
 uu_5                -1.380768e-01 1 1  ON 5
 uu_6                -1.144080e-01 1 1  ON 6
 uu_7                -4.086559e-02 1 1  ON 7
 uu_8                 9.780650e-02 1 1  ON 8
 uu_9                 1.218622e-01 1 1  ON 9
 ud_0                 3.512322e-01 1 1  ON 10
 ud_1                 9.299244e-02 1 1  ON 11
 ud_2                -1.604464e-02 1 1  ON 12
 ud_3                -7.620413e-02 1 1  ON 13
 ud_4                -1.227137e-01 1 1  ON 14
 ud_5                -1.532000e-01 1 1  ON 15
 ud_6                -1.546494e-01 1 1  ON 16
 ud_7                -1.101490e-01 1 1  ON 17
 ud_8                 1.773503e-03 1 1  ON 18
 ud_9                 9.256673e-02 1 1  ON 19
 eO_0                -7.623712e-01 1 1  ON 20
 eO_1                -4.442485e-01 1 1  ON 21
 eO_2                -3.895985e-02 1 1  ON 22
 eO_3                 2.111317e-01 1 1  ON 23
 eO_4                 2.986595e-01 1 1  ON 24
 eO_5                 3.105970e-01 1 1  ON 25
 eO_6                 2.525794e-01 1 1  ON 26
 eO_7                 1.149691e-01 1 1  ON 27
 eO_8                 2.820557e-02 1 1  ON 28
 eO_9                 1.859497e-02 1 1  ON 29
eH1_0                -1.827925e-01 1 1  ON 30
eH1_1                -1.034945e-01 1 1  ON 31
eH1_2                -6.257528e-02 1 1  ON 32
eH1_3                -2.594464e-02 1 1  ON 33
eH1_4                 1.970461e-02 1 1  ON 34
eH1_5                 3.544293e-02 1 1  ON 35
eH1_6                 7.785658e-02 1 1  ON 36
eH1_7                 1.094753e-01 1 1  ON 37
eH1_8                 9.208529e-02 1 1  ON 38
eH1_9                 2.470781e-02 1 1  ON 39
eH2_0                -1.835944e-01 1 1  ON 40
eH2_1                -1.045104e-01 1 1  ON 41
eH2_2                -6.370486e-02 1 1  ON 42
eH2_3                -2.702812e-02 1 1  ON 43
eH2_4                 1.841189e-02 1 1  ON 44
eH2_5                 3.430173e-02 1 1  ON 45
eH2_6                 7.896841e-02 1 1  ON 46
eH2_7                 1.129465e-01 1 1  ON 47
eH2_8                 9.502038e-02 1 1  ON 48
eH2_9                 2.687312e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5059e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1409
    reference variance = 0.279099
====================================================
  Execution time = 2.0196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5917e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320004743737
                                         uncertainty =       0.004340258159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320004743737
                                         uncertainty =       0.004340258159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399944012
  error estimate for blocks of size 2^( 2) =       0.000409362635
  error estimate for blocks of size 2^( 3) =       0.000418154187
  error estimate for blocks of size 2^( 4) =       0.000424450444
  error estimate for blocks of size 2^( 5) =       0.000427959108
  error estimate for blocks of size 2^( 6) =       0.000430303566
  error estimate for blocks of size 2^( 7) =       0.000432244071

      target function =                  N/A
              le_mean =     -17.215874825871
             les_mean =     296.706256285829
             stat err =       0.000428739297
             autocorr =       1.149180333081
              std dev =       0.565606246178
             le_variance =       0.319910425715


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721587482587e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215874825871       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215874737578       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215874533315       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215874576754       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215874641367       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215874680879       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215874701814       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.084181e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215874825871       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215874803288       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215874750219       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215874759573       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215874776083       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215874786436       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215874791957       residual = 7.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.736607e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215874825871       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215874820193       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215874806794       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215874809032       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215874813180       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215874815799       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215874817198       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 6.858394e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5797e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.099396e-01 1 1  ON 0
 uu_1                 4.814003e-02 1 1  ON 1
 uu_2                -4.606171e-02 1 1  ON 2
 uu_3                -1.003136e-01 1 1  ON 3
 uu_4                -1.324698e-01 1 1  ON 4
 uu_5                -1.380790e-01 1 1  ON 5
 uu_6                -1.144129e-01 1 1  ON 6
 uu_7                -4.086935e-02 1 1  ON 7
 uu_8                 9.780447e-02 1 1  ON 8
 uu_9                 1.218640e-01 1 1  ON 9
 ud_0                 3.512390e-01 1 1  ON 10
 ud_1                 9.299738e-02 1 1  ON 11
 ud_2                -1.604280e-02 1 1  ON 12
 ud_3                -7.621085e-02 1 1  ON 13
 ud_4                -1.227146e-01 1 1  ON 14
 ud_5                -1.532024e-01 1 1  ON 15
 ud_6                -1.546493e-01 1 1  ON 16
 ud_7                -1.101507e-01 1 1  ON 17
 ud_8                 1.769211e-03 1 1  ON 18
 ud_9                 9.256675e-02 1 1  ON 19
 eO_0                -7.623986e-01 1 1  ON 20
 eO_1                -4.442659e-01 1 1  ON 21
 eO_2                -3.896313e-02 1 1  ON 22
 eO_3                 2.111462e-01 1 1  ON 23
 eO_4                 2.986773e-01 1 1  ON 24
 eO_5                 3.106047e-01 1 1  ON 25
 eO_6                 2.525822e-01 1 1  ON 26
 eO_7                 1.149731e-01 1 1  ON 27
 eO_8                 2.820640e-02 1 1  ON 28
 eO_9                 1.859525e-02 1 1  ON 29
eH1_0                -1.827950e-01 1 1  ON 30
eH1_1                -1.034984e-01 1 1  ON 31
eH1_2                -6.257781e-02 1 1  ON 32
eH1_3                -2.593914e-02 1 1  ON 33
eH1_4                 1.970434e-02 1 1  ON 34
eH1_5                 3.544313e-02 1 1  ON 35
eH1_6                 7.785784e-02 1 1  ON 36
eH1_7                 1.094740e-01 1 1  ON 37
eH1_8                 9.208766e-02 1 1  ON 38
eH1_9                 2.470878e-02 1 1  ON 39
eH2_0                -1.835938e-01 1 1  ON 40
eH2_1                -1.045155e-01 1 1  ON 41
eH2_2                -6.370672e-02 1 1  ON 42
eH2_3                -2.702544e-02 1 1  ON 43
eH2_4                 1.840944e-02 1 1  ON 44
eH2_5                 3.430258e-02 1 1  ON 45
eH2_6                 7.897073e-02 1 1  ON 46
eH2_7                 1.129460e-01 1 1  ON 47
eH2_8                 9.502272e-02 1 1  ON 48
eH2_9                 2.687400e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2629
    reference variance = 0.249302
====================================================
  Execution time = 2.0046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2281e-01
  Total weights = 2.0000e+06
  Execution time = 1.8381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871964704
                                         uncertainty =       0.005248916949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322871964704
                                         uncertainty =       0.005248916949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401750038
  error estimate for blocks of size 2^( 2) =       0.000411696349
  error estimate for blocks of size 2^( 3) =       0.000420528300
  error estimate for blocks of size 2^( 4) =       0.000427496404
  error estimate for blocks of size 2^( 5) =       0.000431795674
  error estimate for blocks of size 2^( 6) =       0.000432543792
  error estimate for blocks of size 2^( 7) =       0.000432611515

      target function =                  N/A
              le_mean =     -17.215918103219
             les_mean =     296.710642161980
             stat err =       0.000431111846
             autocorr =       1.151510917623
              std dev =       0.568160352921
             le_variance =       0.322806186632

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322889061281
                                         uncertainty =       0.005248894748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322889061281
                                         uncertainty =       0.005248894748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401760670
  error estimate for blocks of size 2^( 2) =       0.000411706150
  error estimate for blocks of size 2^( 3) =       0.000420537130
  error estimate for blocks of size 2^( 4) =       0.000427504381
  error estimate for blocks of size 2^( 5) =       0.000431803256
  error estimate for blocks of size 2^( 6) =       0.000432550943
  error estimate for blocks of size 2^( 7) =       0.000432618948

      target function =                  N/A
              le_mean =     -17.215918268573
             les_mean =     296.710664940427
             stat err =       0.000431119382
             autocorr =       1.151490228990
              std dev =       0.568175388102
             le_variance =       0.322823271645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322880416872
                                         uncertainty =       0.005248902235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322880416872
                                         uncertainty =       0.005248902235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401755294
  error estimate for blocks of size 2^( 2) =       0.000411701191
  error estimate for blocks of size 2^( 3) =       0.000420532653
  error estimate for blocks of size 2^( 4) =       0.000427500325
  error estimate for blocks of size 2^( 5) =       0.000431799398
  error estimate for blocks of size 2^( 6) =       0.000432547294
  error estimate for blocks of size 2^( 7) =       0.000432615166

      target function =                  N/A
              le_mean =     -17.215918189963
             les_mean =     296.710653594981
             stat err =       0.000431115546
             autocorr =       1.151500551545
              std dev =       0.568167785873
             le_variance =       0.322814632904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322873016903
                                         uncertainty =       0.005248914983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322873016903
                                         uncertainty =       0.005248914983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401750693
  error estimate for blocks of size 2^( 2) =       0.000411696951
  error estimate for blocks of size 2^( 3) =       0.000420528841
  error estimate for blocks of size 2^( 4) =       0.000427496891
  error estimate for blocks of size 2^( 5) =       0.000431796137
  error estimate for blocks of size 2^( 6) =       0.000432544226
  error estimate for blocks of size 2^( 7) =       0.000432611969

      target function =                  N/A
              le_mean =     -17.215918114113
             les_mean =     296.710643588521
             stat err =       0.000431112306
             autocorr =       1.151509621158
              std dev =       0.568161278238
             le_variance =       0.322807238089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215918103219        initial
     6.2500e+00     6.2500e+01             1.0842e-04       -17.215918268573  <--
     2.5000e+01     2.5000e+02             2.7366e-05       -17.215918189963
     1.0000e+02     1.0000e+03             6.8584e-06       -17.215918114113

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9339e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 2.099475e-01 1 1  ON 0
 uu_1                 4.815475e-02 1 1  ON 1
 uu_2                -4.605343e-02 1 1  ON 2
 uu_3                -1.003114e-01 1 1  ON 3
 uu_4                -1.324768e-01 1 1  ON 4
 uu_5                -1.380856e-01 1 1  ON 5
 uu_6                -1.144276e-01 1 1  ON 6
 uu_7                -4.088061e-02 1 1  ON 7
 uu_8                 9.779841e-02 1 1  ON 8
 uu_9                 1.218695e-01 1 1  ON 9
 ud_0                 3.512593e-01 1 1  ON 10
 ud_1                 9.301195e-02 1 1  ON 11
 ud_2                -1.603755e-02 1 1  ON 12
 ud_3                -7.623005e-02 1 1  ON 13
 ud_4                -1.227181e-01 1 1  ON 14
 ud_5                -1.532093e-01 1 1  ON 15
 ud_6                -1.546487e-01 1 1  ON 16
 ud_7                -1.101557e-01 1 1  ON 17
 ud_8                 1.756401e-03 1 1  ON 18
 ud_9                 9.256681e-02 1 1  ON 19
 eO_0                -7.624797e-01 1 1  ON 20
 eO_1                -4.443183e-01 1 1  ON 21
 eO_2                -3.897310e-02 1 1  ON 22
 eO_3                 2.111895e-01 1 1  ON 23
 eO_4                 2.987305e-01 1 1  ON 24
 eO_5                 3.106275e-01 1 1  ON 25
 eO_6                 2.525904e-01 1 1  ON 26
 eO_7                 1.149853e-01 1 1  ON 27
 eO_8                 2.820888e-02 1 1  ON 28
 eO_9                 1.859610e-02 1 1  ON 29
eH1_0                -1.828026e-01 1 1  ON 30
eH1_1                -1.035099e-01 1 1  ON 31
eH1_2                -6.258486e-02 1 1  ON 32
eH1_3                -2.592338e-02 1 1  ON 33
eH1_4                 1.970368e-02 1 1  ON 34
eH1_5                 3.544368e-02 1 1  ON 35
eH1_6                 7.786158e-02 1 1  ON 36
eH1_7                 1.094702e-01 1 1  ON 37
eH1_8                 9.209470e-02 1 1  ON 38
eH1_9                 2.471168e-02 1 1  ON 39
eH2_0                -1.835922e-01 1 1  ON 40
eH2_1                -1.045305e-01 1 1  ON 41
eH2_2                -6.371204e-02 1 1  ON 42
eH2_3                -2.701773e-02 1 1  ON 43
eH2_4                 1.840229e-02 1 1  ON 44
eH2_5                 3.430507e-02 1 1  ON 45
eH2_6                 7.897766e-02 1 1  ON 46
eH2_7                 1.129446e-01 1 1  ON 47
eH2_8                 9.502969e-02 1 1  ON 48
eH2_9                 2.687660e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5148e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1935
    reference variance = 0.174348
====================================================
  Execution time = 2.2341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319356452948
                                         uncertainty =       0.005487570176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319356452948
                                         uncertainty =       0.005487570176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399572269
  error estimate for blocks of size 2^( 2) =       0.000409699620
  error estimate for blocks of size 2^( 3) =       0.000418593468
  error estimate for blocks of size 2^( 4) =       0.000425393311
  error estimate for blocks of size 2^( 5) =       0.000429458128
  error estimate for blocks of size 2^( 6) =       0.000432318974
  error estimate for blocks of size 2^( 7) =       0.000433029641

      target function =                  N/A
              le_mean =     -17.216757259688
             les_mean =     296.736046376456
             stat err =       0.000430050014
             autocorr =       1.158369864647
              std dev =       0.565080522650
             le_variance =       0.319315997079


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675725969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216757259688       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216757453276       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216757746455       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216758555033       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216758728349       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216758823560       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216758853909       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216758846842       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 4.587949e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216757259688       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216757313895       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216757399113       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216757542073       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216757658310       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216757669086       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216757675748       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 1.194405e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216757259688       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216757273659       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216757295724       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216757318035       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216757361146       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216757363457       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216757364990       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 3.018204e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204646 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7987e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.099727e-01 1 1  ON 0
 uu_1                 4.816769e-02 1 1  ON 1
 uu_2                -4.606046e-02 1 1  ON 2
 uu_3                -1.002988e-01 1 1  ON 3
 uu_4                -1.324911e-01 1 1  ON 4
 uu_5                -1.381014e-01 1 1  ON 5
 uu_6                -1.144396e-01 1 1  ON 6
 uu_7                -4.089571e-02 1 1  ON 7
 uu_8                 9.779026e-02 1 1  ON 8
 uu_9                 1.218784e-01 1 1  ON 9
 ud_0                 3.512999e-01 1 1  ON 10
 ud_1                 9.304059e-02 1 1  ON 11
 ud_2                -1.604226e-02 1 1  ON 12
 ud_3                -7.623934e-02 1 1  ON 13
 ud_4                -1.227314e-01 1 1  ON 14
 ud_5                -1.532383e-01 1 1  ON 15
 ud_6                -1.546539e-01 1 1  ON 16
 ud_7                -1.101564e-01 1 1  ON 17
 ud_8                 1.738854e-03 1 1  ON 18
 ud_9                 9.256667e-02 1 1  ON 19
 eO_0                -7.625991e-01 1 1  ON 20
 eO_1                -4.443750e-01 1 1  ON 21
 eO_2                -3.898203e-02 1 1  ON 22
 eO_3                 2.112345e-01 1 1  ON 23
 eO_4                 2.988032e-01 1 1  ON 24
 eO_5                 3.106519e-01 1 1  ON 25
 eO_6                 2.526073e-01 1 1  ON 26
 eO_7                 1.150048e-01 1 1  ON 27
 eO_8                 2.821241e-02 1 1  ON 28
 eO_9                 1.859773e-02 1 1  ON 29
eH1_0                -1.828165e-01 1 1  ON 30
eH1_1                -1.035217e-01 1 1  ON 31
eH1_2                -6.257775e-02 1 1  ON 32
eH1_3                -2.592279e-02 1 1  ON 33
eH1_4                 1.970206e-02 1 1  ON 34
eH1_5                 3.544115e-02 1 1  ON 35
eH1_6                 7.786986e-02 1 1  ON 36
eH1_7                 1.094677e-01 1 1  ON 37
eH1_8                 9.210466e-02 1 1  ON 38
eH1_9                 2.471643e-02 1 1  ON 39
eH2_0                -1.836043e-01 1 1  ON 40
eH2_1                -1.045440e-01 1 1  ON 41
eH2_2                -6.371701e-02 1 1  ON 42
eH2_3                -2.699295e-02 1 1  ON 43
eH2_4                 1.839479e-02 1 1  ON 44
eH2_5                 3.430250e-02 1 1  ON 45
eH2_6                 7.897746e-02 1 1  ON 46
eH2_7                 1.129435e-01 1 1  ON 47
eH2_8                 9.504191e-02 1 1  ON 48
eH2_9                 2.687994e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.194532
====================================================
  Execution time = 1.9918e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1799e-01
  Total weights = 2.0000e+06
  Execution time = 1.8398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318016722885
                                         uncertainty =       0.003617705693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318016722885
                                         uncertainty =       0.003617705693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398719354
  error estimate for blocks of size 2^( 2) =       0.000408696550
  error estimate for blocks of size 2^( 3) =       0.000417354890
  error estimate for blocks of size 2^( 4) =       0.000424389501
  error estimate for blocks of size 2^( 5) =       0.000429289788
  error estimate for blocks of size 2^( 6) =       0.000431960528
  error estimate for blocks of size 2^( 7) =       0.000434571239

      target function =                  N/A
              le_mean =     -17.217144410322
             les_mean =     296.748015732938
             stat err =       0.000430052764
             autocorr =       1.163345872707
              std dev =       0.563874317586
             le_variance =       0.317954246033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318154251780
                                         uncertainty =       0.003618691314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318154251780
                                         uncertainty =       0.003618691314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398805557
  error estimate for blocks of size 2^( 2) =       0.000408777396
  error estimate for blocks of size 2^( 3) =       0.000417430981
  error estimate for blocks of size 2^( 4) =       0.000424461979
  error estimate for blocks of size 2^( 5) =       0.000429359755
  error estimate for blocks of size 2^( 6) =       0.000432033439
  error estimate for blocks of size 2^( 7) =       0.000434644322

      target function =                  N/A
              le_mean =     -17.217144641620
             les_mean =     296.748161196448
             stat err =       0.000430124874
             autocorr =       1.163232996897
              std dev =       0.563996227847
             le_variance =       0.318091745025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318091560113
                                         uncertainty =       0.003618222605

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318091560113
                                         uncertainty =       0.003618222605

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398766264
  error estimate for blocks of size 2^( 2) =       0.000408740507
  error estimate for blocks of size 2^( 3) =       0.000417396339
  error estimate for blocks of size 2^( 4) =       0.000424429069
  error estimate for blocks of size 2^( 5) =       0.000429328044
  error estimate for blocks of size 2^( 6) =       0.000432000623
  error estimate for blocks of size 2^( 7) =       0.000434611251

      target function =                  N/A
              le_mean =     -17.217144494951
             les_mean =     296.748093467199
             stat err =       0.000430092246
             autocorr =       1.163285750614
              std dev =       0.563940658400
             le_variance =       0.318029066197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318026249205
                                         uncertainty =       0.003617770295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318026249205
                                         uncertainty =       0.003617770295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398725325
  error estimate for blocks of size 2^( 2) =       0.000408702141
  error estimate for blocks of size 2^( 3) =       0.000417360160
  error estimate for blocks of size 2^( 4) =       0.000424394533
  error estimate for blocks of size 2^( 5) =       0.000429294653
  error estimate for blocks of size 2^( 6) =       0.000431965637
  error estimate for blocks of size 2^( 7) =       0.000434576327

      target function =                  N/A
              le_mean =     -17.217144417775
             les_mean =     296.748025513666
             stat err =       0.000430057787
             autocorr =       1.163338203499
              std dev =       0.563882762765
             le_variance =       0.317963770143


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217144410322        initial
     1.5625e+00     1.5625e+01             4.5879e-04       -17.217144641620  <--
     6.2500e+00     6.2500e+01             1.1944e-04       -17.217144494951
     2.5000e+01     2.5000e+02             3.0182e-05       -17.217144417775

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.9210e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 2.100479e-01 1 1  ON 0
 uu_1                 4.820421e-02 1 1  ON 1
 uu_2                -4.606547e-02 1 1  ON 2
 uu_3                -1.002744e-01 1 1  ON 3
 uu_4                -1.325308e-01 1 1  ON 4
 uu_5                -1.381513e-01 1 1  ON 5
 uu_6                -1.144769e-01 1 1  ON 6
 uu_7                -4.094166e-02 1 1  ON 7
 uu_8                 9.776525e-02 1 1  ON 8
 uu_9                 1.219056e-01 1 1  ON 9
 ud_0                 3.514138e-01 1 1  ON 10
 ud_1                 9.311662e-02 1 1  ON 11
 ud_2                -1.604743e-02 1 1  ON 12
 ud_3                -7.626283e-02 1 1  ON 13
 ud_4                -1.227713e-01 1 1  ON 14
 ud_5                -1.533191e-01 1 1  ON 15
 ud_6                -1.546705e-01 1 1  ON 16
 ud_7                -1.101589e-01 1 1  ON 17
 ud_8                 1.685191e-03 1 1  ON 18
 ud_9                 9.256626e-02 1 1  ON 19
 eO_0                -7.629385e-01 1 1  ON 20
 eO_1                -4.445541e-01 1 1  ON 21
 eO_2                -3.902250e-02 1 1  ON 22
 eO_3                 2.113638e-01 1 1  ON 23
 eO_4                 2.990230e-01 1 1  ON 24
 eO_5                 3.107293e-01 1 1  ON 25
 eO_6                 2.526597e-01 1 1  ON 26
 eO_7                 1.150645e-01 1 1  ON 27
 eO_8                 2.822326e-02 1 1  ON 28
 eO_9                 1.860273e-02 1 1  ON 29
eH1_0                -1.828541e-01 1 1  ON 30
eH1_1                -1.035510e-01 1 1  ON 31
eH1_2                -6.256503e-02 1 1  ON 32
eH1_3                -2.592272e-02 1 1  ON 33
eH1_4                 1.969706e-02 1 1  ON 34
eH1_5                 3.543159e-02 1 1  ON 35
eH1_6                 7.789563e-02 1 1  ON 36
eH1_7                 1.094603e-01 1 1  ON 37
eH1_8                 9.213523e-02 1 1  ON 38
eH1_9                 2.473101e-02 1 1  ON 39
eH2_0                -1.836406e-01 1 1  ON 40
eH2_1                -1.045868e-01 1 1  ON 41
eH2_2                -6.373175e-02 1 1  ON 42
eH2_3                -2.692850e-02 1 1  ON 43
eH2_4                 1.838367e-02 1 1  ON 44
eH2_5                 3.429403e-02 1 1  ON 45
eH2_6                 7.897692e-02 1 1  ON 46
eH2_7                 1.129403e-01 1 1  ON 47
eH2_8                 9.507942e-02 1 1  ON 48
eH2_9                 2.689018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7209e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.257
    reference variance = 0.229864
====================================================
  Execution time = 2.0048e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1839e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318469252772
                                         uncertainty =       0.003666907002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318469252772
                                         uncertainty =       0.003666907002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398991532
  error estimate for blocks of size 2^( 2) =       0.000408578146
  error estimate for blocks of size 2^( 3) =       0.000417563071
  error estimate for blocks of size 2^( 4) =       0.000424377450
  error estimate for blocks of size 2^( 5) =       0.000427484241
  error estimate for blocks of size 2^( 6) =       0.000430481444
  error estimate for blocks of size 2^( 7) =       0.000432279921

      target function =                  N/A
              le_mean =     -17.216413946546
             les_mean =     296.723297505005
             stat err =       0.000428655764
             autocorr =       1.154223675066
              std dev =       0.564259235970
             le_variance =       0.318388485377


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721641394655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413946546       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216415592593       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216413933396       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216413751521       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216415052024       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216415259272       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216415231408       residual = 5.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216415764305       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216415663135       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 1.464164e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413946546       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414470142       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216414078455       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216413884805       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216414160340       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216414247441       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216414303532       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216414369071       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.929914e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216413946546       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216414087010       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216413992534       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216413933210       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216413985438       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216414015279       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216414036726       residual = 5.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 9.978951e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207453 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5598e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.102143e-01 1 1  ON 0
 uu_1                 4.826898e-02 1 1  ON 1
 uu_2                -4.603203e-02 1 1  ON 2
 uu_3                -1.002829e-01 1 1  ON 3
 uu_4                -1.325857e-01 1 1  ON 4
 uu_5                -1.382477e-01 1 1  ON 5
 uu_6                -1.145073e-01 1 1  ON 6
 uu_7                -4.103482e-02 1 1  ON 7
 uu_8                 9.770984e-02 1 1  ON 8
 uu_9                 1.219353e-01 1 1  ON 9
 ud_0                 3.515202e-01 1 1  ON 10
 ud_1                 9.316879e-02 1 1  ON 11
 ud_2                -1.603362e-02 1 1  ON 12
 ud_3                -7.627929e-02 1 1  ON 13
 ud_4                -1.228123e-01 1 1  ON 14
 ud_5                -1.533471e-01 1 1  ON 15
 ud_6                -1.546873e-01 1 1  ON 16
 ud_7                -1.101880e-01 1 1  ON 17
 ud_8                 1.608402e-03 1 1  ON 18
 ud_9                 9.256389e-02 1 1  ON 19
 eO_0                -7.633315e-01 1 1  ON 20
 eO_1                -4.448042e-01 1 1  ON 21
 eO_2                -3.907392e-02 1 1  ON 22
 eO_3                 2.115155e-01 1 1  ON 23
 eO_4                 2.993002e-01 1 1  ON 24
 eO_5                 3.108613e-01 1 1  ON 25
 eO_6                 2.527067e-01 1 1  ON 26
 eO_7                 1.151309e-01 1 1  ON 27
 eO_8                 2.823447e-02 1 1  ON 28
 eO_9                 1.860779e-02 1 1  ON 29
eH1_0                -1.828528e-01 1 1  ON 30
eH1_1                -1.035672e-01 1 1  ON 31
eH1_2                -6.257512e-02 1 1  ON 32
eH1_3                -2.587662e-02 1 1  ON 33
eH1_4                 1.971849e-02 1 1  ON 34
eH1_5                 3.535874e-02 1 1  ON 35
eH1_6                 7.788882e-02 1 1  ON 36
eH1_7                 1.094495e-01 1 1  ON 37
eH1_8                 9.216893e-02 1 1  ON 38
eH1_9                 2.474071e-02 1 1  ON 39
eH2_0                -1.836449e-01 1 1  ON 40
eH2_1                -1.045864e-01 1 1  ON 41
eH2_2                -6.374165e-02 1 1  ON 42
eH2_3                -2.693034e-02 1 1  ON 43
eH2_4                 1.835557e-02 1 1  ON 44
eH2_5                 3.429051e-02 1 1  ON 45
eH2_6                 7.897023e-02 1 1  ON 46
eH2_7                 1.129382e-01 1 1  ON 47
eH2_8                 9.511693e-02 1 1  ON 48
eH2_9                 2.690379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1677
    reference variance = 0.225817
====================================================
  Execution time = 1.9711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1990e-01
  Total weights = 2.0000e+06
  Execution time = 1.8489e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319761066021
                                         uncertainty =       0.003050714962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319761066021
                                         uncertainty =       0.003050714962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399862539
  error estimate for blocks of size 2^( 2) =       0.000409204154
  error estimate for blocks of size 2^( 3) =       0.000418167918
  error estimate for blocks of size 2^( 4) =       0.000424493473
  error estimate for blocks of size 2^( 5) =       0.000428900130
  error estimate for blocks of size 2^( 6) =       0.000431705421
  error estimate for blocks of size 2^( 7) =       0.000434069995

      target function =                  N/A
              le_mean =     -17.217379402440
             les_mean =     296.757933427584
             stat err =       0.000429792255
             autocorr =       1.155302549270
              std dev =       0.565491025498
             le_variance =       0.319780099918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320114939405
                                         uncertainty =       0.003054550849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320114939405
                                         uncertainty =       0.003054550849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400083762
  error estimate for blocks of size 2^( 2) =       0.000409413618
  error estimate for blocks of size 2^( 3) =       0.000418362450
  error estimate for blocks of size 2^( 4) =       0.000424677703
  error estimate for blocks of size 2^( 5) =       0.000429080256
  error estimate for blocks of size 2^( 6) =       0.000431877855
  error estimate for blocks of size 2^( 7) =       0.000434251076

      target function =                  N/A
              le_mean =     -17.217377403303
             les_mean =     296.758218520340
             stat err =       0.000429971722
             autocorr =       1.154989243661
              std dev =       0.565803881791
             le_variance =       0.320134032650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319995214212
                                         uncertainty =       0.003053272635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319995214212
                                         uncertainty =       0.003053272635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400008925
  error estimate for blocks of size 2^( 2) =       0.000409342975
  error estimate for blocks of size 2^( 3) =       0.000418297616
  error estimate for blocks of size 2^( 4) =       0.000424617191
  error estimate for blocks of size 2^( 5) =       0.000429021162
  error estimate for blocks of size 2^( 6) =       0.000431821968
  error estimate for blocks of size 2^( 7) =       0.000434191967

      target function =                  N/A
              le_mean =     -17.217378107185
             les_mean =     296.758123005669
             stat err =       0.000429913072
             autocorr =       1.155106261100
              std dev =       0.565698046592
             le_variance =       0.320014279918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319794109001
                                         uncertainty =       0.003051084714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319794109001
                                         uncertainty =       0.003051084714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399883200
  error estimate for blocks of size 2^( 2) =       0.000409223749
  error estimate for blocks of size 2^( 3) =       0.000418186269
  error estimate for blocks of size 2^( 4) =       0.000424511029
  error estimate for blocks of size 2^( 5) =       0.000428917317
  error estimate for blocks of size 2^( 6) =       0.000431722013
  error estimate for blocks of size 2^( 7) =       0.000434087266

      target function =                  N/A
              le_mean =     -17.217379213855
             les_mean =     296.757959981176
             stat err =       0.000429809406
             autocorr =       1.155275368113
              std dev =       0.565520244900
             le_variance =       0.319813147392


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217379402440        initial  <--
     3.9062e-01     3.9062e+00             1.4642e-03       -17.217377403303
     1.5625e+00     1.5625e+01             3.9299e-04       -17.217378107185
     6.2500e+00     6.2500e+01             9.9790e-05       -17.217379213855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0306
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 2.100479e-01 1 1  ON 0
 uu_1                 4.820421e-02 1 1  ON 1
 uu_2                -4.606547e-02 1 1  ON 2
 uu_3                -1.002744e-01 1 1  ON 3
 uu_4                -1.325308e-01 1 1  ON 4
 uu_5                -1.381513e-01 1 1  ON 5
 uu_6                -1.144769e-01 1 1  ON 6
 uu_7                -4.094166e-02 1 1  ON 7
 uu_8                 9.776525e-02 1 1  ON 8
 uu_9                 1.219056e-01 1 1  ON 9
 ud_0                 3.514138e-01 1 1  ON 10
 ud_1                 9.311662e-02 1 1  ON 11
 ud_2                -1.604743e-02 1 1  ON 12
 ud_3                -7.626283e-02 1 1  ON 13
 ud_4                -1.227713e-01 1 1  ON 14
 ud_5                -1.533191e-01 1 1  ON 15
 ud_6                -1.546705e-01 1 1  ON 16
 ud_7                -1.101589e-01 1 1  ON 17
 ud_8                 1.685191e-03 1 1  ON 18
 ud_9                 9.256626e-02 1 1  ON 19
 eO_0                -7.629385e-01 1 1  ON 20
 eO_1                -4.445541e-01 1 1  ON 21
 eO_2                -3.902250e-02 1 1  ON 22
 eO_3                 2.113638e-01 1 1  ON 23
 eO_4                 2.990230e-01 1 1  ON 24
 eO_5                 3.107293e-01 1 1  ON 25
 eO_6                 2.526597e-01 1 1  ON 26
 eO_7                 1.150645e-01 1 1  ON 27
 eO_8                 2.822326e-02 1 1  ON 28
 eO_9                 1.860273e-02 1 1  ON 29
eH1_0                -1.828541e-01 1 1  ON 30
eH1_1                -1.035510e-01 1 1  ON 31
eH1_2                -6.256503e-02 1 1  ON 32
eH1_3                -2.592272e-02 1 1  ON 33
eH1_4                 1.969706e-02 1 1  ON 34
eH1_5                 3.543159e-02 1 1  ON 35
eH1_6                 7.789563e-02 1 1  ON 36
eH1_7                 1.094603e-01 1 1  ON 37
eH1_8                 9.213523e-02 1 1  ON 38
eH1_9                 2.473101e-02 1 1  ON 39
eH2_0                -1.836406e-01 1 1  ON 40
eH2_1                -1.045868e-01 1 1  ON 41
eH2_2                -6.373175e-02 1 1  ON 42
eH2_3                -2.692850e-02 1 1  ON 43
eH2_4                 1.838367e-02 1 1  ON 44
eH2_5                 3.429403e-02 1 1  ON 45
eH2_6                 7.897692e-02 1 1  ON 46
eH2_7                 1.129403e-01 1 1  ON 47
eH2_8                 9.507942e-02 1 1  ON 48
eH2_9                 2.689018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4637e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2258
    reference variance = 0.228371
====================================================
  Execution time = 2.0302e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323084852033
                                         uncertainty =       0.007515995389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323084852033
                                         uncertainty =       0.007515995389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401946665
  error estimate for blocks of size 2^( 2) =       0.000411344111
  error estimate for blocks of size 2^( 3) =       0.000419306603
  error estimate for blocks of size 2^( 4) =       0.000425535597
  error estimate for blocks of size 2^( 5) =       0.000428966271
  error estimate for blocks of size 2^( 6) =       0.000431999713
  error estimate for blocks of size 2^( 7) =       0.000433354286

      target function =                  N/A
              le_mean =     -17.216520541907
             les_mean =     296.731701650735
             stat err =       0.000429963967
             autocorr =       1.144266711144
              std dev =       0.568438424444
             le_variance =       0.323122242385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721652054191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520541907       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520518073       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520898887       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520908069       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216521026394       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216521070971       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216521045306       residual = 8.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.571374e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520541907       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520535735       residual = 6.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520637003       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520640861       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520671253       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520680450       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520673313       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.953905e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216520541907       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216520540350       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216520566079       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216520567176       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216520574822       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216520576997       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216520575158       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 9.900740e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5888e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.100627e-01 1 1  ON 0
 uu_1                 4.820942e-02 1 1  ON 1
 uu_2                -4.606271e-02 1 1  ON 2
 uu_3                -1.002700e-01 1 1  ON 3
 uu_4                -1.325391e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144888e-01 1 1  ON 6
 uu_7                -4.095071e-02 1 1  ON 7
 uu_8                 9.776236e-02 1 1  ON 8
 uu_9                 1.219098e-01 1 1  ON 9
 ud_0                 3.514230e-01 1 1  ON 10
 ud_1                 9.312667e-02 1 1  ON 11
 ud_2                -1.605035e-02 1 1  ON 12
 ud_3                -7.626519e-02 1 1  ON 13
 ud_4                -1.227779e-01 1 1  ON 14
 ud_5                -1.533233e-01 1 1  ON 15
 ud_6                -1.546665e-01 1 1  ON 16
 ud_7                -1.101618e-01 1 1  ON 17
 ud_8                 1.679039e-03 1 1  ON 18
 ud_9                 9.256601e-02 1 1  ON 19
 eO_0                -7.629780e-01 1 1  ON 20
 eO_1                -4.445825e-01 1 1  ON 21
 eO_2                -3.903115e-02 1 1  ON 22
 eO_3                 2.113869e-01 1 1  ON 23
 eO_4                 2.990487e-01 1 1  ON 24
 eO_5                 3.107394e-01 1 1  ON 25
 eO_6                 2.526669e-01 1 1  ON 26
 eO_7                 1.150725e-01 1 1  ON 27
 eO_8                 2.822499e-02 1 1  ON 28
 eO_9                 1.860322e-02 1 1  ON 29
eH1_0                -1.828507e-01 1 1  ON 30
eH1_1                -1.035540e-01 1 1  ON 31
eH1_2                -6.257139e-02 1 1  ON 32
eH1_3                -2.592456e-02 1 1  ON 33
eH1_4                 1.969487e-02 1 1  ON 34
eH1_5                 3.543158e-02 1 1  ON 35
eH1_6                 7.790017e-02 1 1  ON 36
eH1_7                 1.094607e-01 1 1  ON 37
eH1_8                 9.213921e-02 1 1  ON 38
eH1_9                 2.473206e-02 1 1  ON 39
eH2_0                -1.836458e-01 1 1  ON 40
eH2_1                -1.045866e-01 1 1  ON 41
eH2_2                -6.372850e-02 1 1  ON 42
eH2_3                -2.693282e-02 1 1  ON 43
eH2_4                 1.838702e-02 1 1  ON 44
eH2_5                 3.429111e-02 1 1  ON 45
eH2_6                 7.897626e-02 1 1  ON 46
eH2_7                 1.129395e-01 1 1  ON 47
eH2_8                 9.508453e-02 1 1  ON 48
eH2_9                 2.689169e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2649
    reference variance = 0.218148
====================================================
  Execution time = 1.9658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1619e-01
  Total weights = 2.0000e+06
  Execution time = 1.8403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316264125146
                                         uncertainty =       0.003557558977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316264125146
                                         uncertainty =       0.003557558977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397607070
  error estimate for blocks of size 2^( 2) =       0.000407383861
  error estimate for blocks of size 2^( 3) =       0.000416225556
  error estimate for blocks of size 2^( 4) =       0.000422974106
  error estimate for blocks of size 2^( 5) =       0.000426908964
  error estimate for blocks of size 2^( 6) =       0.000429989317
  error estimate for blocks of size 2^( 7) =       0.000429257748

      target function =                  N/A
              le_mean =     -17.216783034890
             les_mean =     296.733800675912
             stat err =       0.000427282534
             autocorr =       1.154840710102
              std dev =       0.562301310252
             le_variance =       0.316182763511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316302644220
                                         uncertainty =       0.003558248775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316302644220
                                         uncertainty =       0.003558248775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397631270
  error estimate for blocks of size 2^( 2) =       0.000407406844
  error estimate for blocks of size 2^( 3) =       0.000416246869
  error estimate for blocks of size 2^( 4) =       0.000422994295
  error estimate for blocks of size 2^( 5) =       0.000426928318
  error estimate for blocks of size 2^( 6) =       0.000430008243
  error estimate for blocks of size 2^( 7) =       0.000429276093

      target function =                  N/A
              le_mean =     -17.216782688939
             les_mean =     296.733827254243
             stat err =       0.000427301737
             autocorr =       1.154803935709
              std dev =       0.562335535243
             le_variance =       0.316221254197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316283675267
                                         uncertainty =       0.003557908139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316283675267
                                         uncertainty =       0.003557908139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397619353
  error estimate for blocks of size 2^( 2) =       0.000407395518
  error estimate for blocks of size 2^( 3) =       0.000416236358
  error estimate for blocks of size 2^( 4) =       0.000422984346
  error estimate for blocks of size 2^( 5) =       0.000426918767
  error estimate for blocks of size 2^( 6) =       0.000429998912
  error estimate for blocks of size 2^( 7) =       0.000429267025

      target function =                  N/A
              le_mean =     -17.216782850805
             les_mean =     296.733813872728
             stat err =       0.000427292262
             autocorr =       1.154821948130
              std dev =       0.562318681050
             le_variance =       0.316202299058

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316266576390
                                         uncertainty =       0.003557602760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316266576390
                                         uncertainty =       0.003557602760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397608610
  error estimate for blocks of size 2^( 2) =       0.000407385322
  error estimate for blocks of size 2^( 3) =       0.000416226909
  error estimate for blocks of size 2^( 4) =       0.000422975389
  error estimate for blocks of size 2^( 5) =       0.000426910192
  error estimate for blocks of size 2^( 6) =       0.000429990519
  error estimate for blocks of size 2^( 7) =       0.000429258909

      target function =                  N/A
              le_mean =     -17.216783011270
             les_mean =     296.733802311978
             stat err =       0.000427283752
             autocorr =       1.154838351847
              std dev =       0.562303488269
             le_variance =       0.316185212920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216783034890        initial  <--
     3.9062e+00     3.9062e+01             1.5714e-04       -17.216782688939
     1.5625e+01     1.5625e+02             3.9539e-05       -17.216782850805
     6.2500e+01     6.2500e+02             9.9007e-06       -17.216783011270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9983
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 2.100479e-01 1 1  ON 0
 uu_1                 4.820421e-02 1 1  ON 1
 uu_2                -4.606547e-02 1 1  ON 2
 uu_3                -1.002744e-01 1 1  ON 3
 uu_4                -1.325308e-01 1 1  ON 4
 uu_5                -1.381513e-01 1 1  ON 5
 uu_6                -1.144769e-01 1 1  ON 6
 uu_7                -4.094166e-02 1 1  ON 7
 uu_8                 9.776525e-02 1 1  ON 8
 uu_9                 1.219056e-01 1 1  ON 9
 ud_0                 3.514138e-01 1 1  ON 10
 ud_1                 9.311662e-02 1 1  ON 11
 ud_2                -1.604743e-02 1 1  ON 12
 ud_3                -7.626283e-02 1 1  ON 13
 ud_4                -1.227713e-01 1 1  ON 14
 ud_5                -1.533191e-01 1 1  ON 15
 ud_6                -1.546705e-01 1 1  ON 16
 ud_7                -1.101589e-01 1 1  ON 17
 ud_8                 1.685191e-03 1 1  ON 18
 ud_9                 9.256626e-02 1 1  ON 19
 eO_0                -7.629385e-01 1 1  ON 20
 eO_1                -4.445541e-01 1 1  ON 21
 eO_2                -3.902250e-02 1 1  ON 22
 eO_3                 2.113638e-01 1 1  ON 23
 eO_4                 2.990230e-01 1 1  ON 24
 eO_5                 3.107293e-01 1 1  ON 25
 eO_6                 2.526597e-01 1 1  ON 26
 eO_7                 1.150645e-01 1 1  ON 27
 eO_8                 2.822326e-02 1 1  ON 28
 eO_9                 1.860273e-02 1 1  ON 29
eH1_0                -1.828541e-01 1 1  ON 30
eH1_1                -1.035510e-01 1 1  ON 31
eH1_2                -6.256503e-02 1 1  ON 32
eH1_3                -2.592272e-02 1 1  ON 33
eH1_4                 1.969706e-02 1 1  ON 34
eH1_5                 3.543159e-02 1 1  ON 35
eH1_6                 7.789563e-02 1 1  ON 36
eH1_7                 1.094603e-01 1 1  ON 37
eH1_8                 9.213523e-02 1 1  ON 38
eH1_9                 2.473101e-02 1 1  ON 39
eH2_0                -1.836406e-01 1 1  ON 40
eH2_1                -1.045868e-01 1 1  ON 41
eH2_2                -6.373175e-02 1 1  ON 42
eH2_3                -2.692850e-02 1 1  ON 43
eH2_4                 1.838367e-02 1 1  ON 44
eH2_5                 3.429403e-02 1 1  ON 45
eH2_6                 7.897692e-02 1 1  ON 46
eH2_7                 1.129403e-01 1 1  ON 47
eH2_8                 9.507942e-02 1 1  ON 48
eH2_9                 2.689018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2588
    reference variance = 0.222823
====================================================
  Execution time = 2.0016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2272e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322754244303
                                         uncertainty =       0.009144044790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322754244303
                                         uncertainty =       0.009144044790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401696767
  error estimate for blocks of size 2^( 2) =       0.000411152028
  error estimate for blocks of size 2^( 3) =       0.000419931020
  error estimate for blocks of size 2^( 4) =       0.000426120085
  error estimate for blocks of size 2^( 5) =       0.000429243393
  error estimate for blocks of size 2^( 6) =       0.000432409433
  error estimate for blocks of size 2^( 7) =       0.000433058310

      target function =                  N/A
              le_mean =     -17.216877544449
             les_mean =     296.743592805015
             stat err =       0.000430207805
             autocorr =       1.146990701852
              std dev =       0.568085016366
             le_variance =       0.322720585819


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687754445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216877544449       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216877554529       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216877563266       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216877568587       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216877575712       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216877584059       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216877586696       residual = 7.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.788114e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216877544449       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216877546982       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216877549199       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216877550555       residual = 4.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216877552264       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216877554330       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216877554994       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 4.479320e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216877544449       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216877545083       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216877545639       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216877545980       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216877546403       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216877546918       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216877547084       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 1.120398e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5613e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.100490e-01 1 1  ON 0
 uu_1                 4.820468e-02 1 1  ON 1
 uu_2                -4.606571e-02 1 1  ON 2
 uu_3                -1.002739e-01 1 1  ON 3
 uu_4                -1.325316e-01 1 1  ON 4
 uu_5                -1.381515e-01 1 1  ON 5
 uu_6                -1.144770e-01 1 1  ON 6
 uu_7                -4.094251e-02 1 1  ON 7
 uu_8                 9.776470e-02 1 1  ON 8
 uu_9                 1.219059e-01 1 1  ON 9
 ud_0                 3.514149e-01 1 1  ON 10
 ud_1                 9.311780e-02 1 1  ON 11
 ud_2                -1.604742e-02 1 1  ON 12
 ud_3                -7.626323e-02 1 1  ON 13
 ud_4                -1.227722e-01 1 1  ON 14
 ud_5                -1.533191e-01 1 1  ON 15
 ud_6                -1.546705e-01 1 1  ON 16
 ud_7                -1.101593e-01 1 1  ON 17
 ud_8                 1.684326e-03 1 1  ON 18
 ud_9                 9.256623e-02 1 1  ON 19
 eO_0                -7.629429e-01 1 1  ON 20
 eO_1                -4.445563e-01 1 1  ON 21
 eO_2                -3.902266e-02 1 1  ON 22
 eO_3                 2.113657e-01 1 1  ON 23
 eO_4                 2.990253e-01 1 1  ON 24
 eO_5                 3.107304e-01 1 1  ON 25
 eO_6                 2.526603e-01 1 1  ON 26
 eO_7                 1.150651e-01 1 1  ON 27
 eO_8                 2.822334e-02 1 1  ON 28
 eO_9                 1.860279e-02 1 1  ON 29
eH1_0                -1.828542e-01 1 1  ON 30
eH1_1                -1.035512e-01 1 1  ON 31
eH1_2                -6.256538e-02 1 1  ON 32
eH1_3                -2.592196e-02 1 1  ON 33
eH1_4                 1.969686e-02 1 1  ON 34
eH1_5                 3.543107e-02 1 1  ON 35
eH1_6                 7.789554e-02 1 1  ON 36
eH1_7                 1.094604e-01 1 1  ON 37
eH1_8                 9.213572e-02 1 1  ON 38
eH1_9                 2.473115e-02 1 1  ON 39
eH2_0                -1.836414e-01 1 1  ON 40
eH2_1                -1.045871e-01 1 1  ON 41
eH2_2                -6.373181e-02 1 1  ON 42
eH2_3                -2.692735e-02 1 1  ON 43
eH2_4                 1.838414e-02 1 1  ON 44
eH2_5                 3.429321e-02 1 1  ON 45
eH2_6                 7.897699e-02 1 1  ON 46
eH2_7                 1.129401e-01 1 1  ON 47
eH2_8                 9.507974e-02 1 1  ON 48
eH2_9                 2.689027e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2772
    reference variance = 0.33987
====================================================
  Execution time = 1.9895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1736e-01
  Total weights = 2.0000e+06
  Execution time = 1.8281e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317435638906
                                         uncertainty =       0.004976255049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317435638906
                                         uncertainty =       0.004976255049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398345751
  error estimate for blocks of size 2^( 2) =       0.000407485302
  error estimate for blocks of size 2^( 3) =       0.000415410522
  error estimate for blocks of size 2^( 4) =       0.000421890521
  error estimate for blocks of size 2^( 5) =       0.000426997092
  error estimate for blocks of size 2^( 6) =       0.000429046105
  error estimate for blocks of size 2^( 7) =       0.000430114057

      target function =                  N/A
              le_mean =     -17.216488985082
             les_mean =     296.724851489203
             stat err =       0.000427011944
             autocorr =       1.149104875890
              std dev =       0.563345963354
             le_variance =       0.317358674427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317439805332
                                         uncertainty =       0.004976292935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317439805332
                                         uncertainty =       0.004976292935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398348365
  error estimate for blocks of size 2^( 2) =       0.000407487752
  error estimate for blocks of size 2^( 3) =       0.000415412737
  error estimate for blocks of size 2^( 4) =       0.000421892603
  error estimate for blocks of size 2^( 5) =       0.000426999056
  error estimate for blocks of size 2^( 6) =       0.000429048105
  error estimate for blocks of size 2^( 7) =       0.000430115915

      target function =                  N/A
              le_mean =     -17.216488979441
             les_mean =     296.724855459828
             stat err =       0.000427013920
             autocorr =       1.149100430098
              std dev =       0.563349659900
             le_variance =       0.317362839309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317437725369
                                         uncertainty =       0.004976273979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317437725369
                                         uncertainty =       0.004976273979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398347060
  error estimate for blocks of size 2^( 2) =       0.000407486529
  error estimate for blocks of size 2^( 3) =       0.000415411631
  error estimate for blocks of size 2^( 4) =       0.000421891563
  error estimate for blocks of size 2^( 5) =       0.000426998075
  error estimate for blocks of size 2^( 6) =       0.000429047106
  error estimate for blocks of size 2^( 7) =       0.000430114987

      target function =                  N/A
              le_mean =     -17.216488982226
             les_mean =     296.724853476545
             stat err =       0.000427012933
             autocorr =       1.149102646846
              std dev =       0.563347814513
             le_variance =       0.317360760116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317435899796
                                         uncertainty =       0.004976257415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317435899796
                                         uncertainty =       0.004976257415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398345915
  error estimate for blocks of size 2^( 2) =       0.000407485455
  error estimate for blocks of size 2^( 3) =       0.000415410660
  error estimate for blocks of size 2^( 4) =       0.000421890651
  error estimate for blocks of size 2^( 5) =       0.000426997215
  error estimate for blocks of size 2^( 6) =       0.000429046230
  error estimate for blocks of size 2^( 7) =       0.000430114174

      target function =                  N/A
              le_mean =     -17.216488984721
             les_mean =     296.724851737566
             stat err =       0.000427012067
             autocorr =       1.149104597058
              std dev =       0.563346194821
             le_variance =       0.317358935220


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216488985082        initial  <--
     3.9062e+01     3.9062e+02             1.7881e-05       -17.216488979441
     1.5625e+02     1.5625e+03             4.4793e-06       -17.216488982226
     6.2500e+02     6.2500e+03             1.1204e-06       -17.216488984721

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1514
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 2.100479e-01 1 1  ON 0
 uu_1                 4.820421e-02 1 1  ON 1
 uu_2                -4.606547e-02 1 1  ON 2
 uu_3                -1.002744e-01 1 1  ON 3
 uu_4                -1.325308e-01 1 1  ON 4
 uu_5                -1.381513e-01 1 1  ON 5
 uu_6                -1.144769e-01 1 1  ON 6
 uu_7                -4.094166e-02 1 1  ON 7
 uu_8                 9.776525e-02 1 1  ON 8
 uu_9                 1.219056e-01 1 1  ON 9
 ud_0                 3.514138e-01 1 1  ON 10
 ud_1                 9.311662e-02 1 1  ON 11
 ud_2                -1.604743e-02 1 1  ON 12
 ud_3                -7.626283e-02 1 1  ON 13
 ud_4                -1.227713e-01 1 1  ON 14
 ud_5                -1.533191e-01 1 1  ON 15
 ud_6                -1.546705e-01 1 1  ON 16
 ud_7                -1.101589e-01 1 1  ON 17
 ud_8                 1.685191e-03 1 1  ON 18
 ud_9                 9.256626e-02 1 1  ON 19
 eO_0                -7.629385e-01 1 1  ON 20
 eO_1                -4.445541e-01 1 1  ON 21
 eO_2                -3.902250e-02 1 1  ON 22
 eO_3                 2.113638e-01 1 1  ON 23
 eO_4                 2.990230e-01 1 1  ON 24
 eO_5                 3.107293e-01 1 1  ON 25
 eO_6                 2.526597e-01 1 1  ON 26
 eO_7                 1.150645e-01 1 1  ON 27
 eO_8                 2.822326e-02 1 1  ON 28
 eO_9                 1.860273e-02 1 1  ON 29
eH1_0                -1.828541e-01 1 1  ON 30
eH1_1                -1.035510e-01 1 1  ON 31
eH1_2                -6.256503e-02 1 1  ON 32
eH1_3                -2.592272e-02 1 1  ON 33
eH1_4                 1.969706e-02 1 1  ON 34
eH1_5                 3.543159e-02 1 1  ON 35
eH1_6                 7.789563e-02 1 1  ON 36
eH1_7                 1.094603e-01 1 1  ON 37
eH1_8                 9.213523e-02 1 1  ON 38
eH1_9                 2.473101e-02 1 1  ON 39
eH2_0                -1.836406e-01 1 1  ON 40
eH2_1                -1.045868e-01 1 1  ON 41
eH2_2                -6.373175e-02 1 1  ON 42
eH2_3                -2.692850e-02 1 1  ON 43
eH2_4                 1.838367e-02 1 1  ON 44
eH2_5                 3.429403e-02 1 1  ON 45
eH2_6                 7.897692e-02 1 1  ON 46
eH2_7                 1.129403e-01 1 1  ON 47
eH2_8                 9.507942e-02 1 1  ON 48
eH2_9                 2.689018e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4774e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.453
    reference variance = 4.28593
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1504e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5449e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314847899474
                                         uncertainty =       0.003132309083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314847899474
                                         uncertainty =       0.003132309083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396886064
  error estimate for blocks of size 2^( 2) =       0.000406052433
  error estimate for blocks of size 2^( 3) =       0.000414404575
  error estimate for blocks of size 2^( 4) =       0.000420540039
  error estimate for blocks of size 2^( 5) =       0.000424320013
  error estimate for blocks of size 2^( 6) =       0.000426089310
  error estimate for blocks of size 2^( 7) =       0.000429418796

      target function =                  N/A
              le_mean =     -17.216879902938
             les_mean =     296.735990529742
             stat err =       0.000425092039
             autocorr =       1.147187076000
              std dev =       0.561281653957
             le_variance =       0.315037095069


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721687990294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879902938       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879902491       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216879901307       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216879900432       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216879902076       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216879901250       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216879901814       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.770548e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879902938       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879902826       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216879902530       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216879902311       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216879902722       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216879902515       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216879902656       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 4.427157e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216879902938       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216879902910       residual = 6.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216879902836       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216879902779       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216879902884       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216879902833       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216879902868       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 1.106839e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6165e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.100480e-01 1 1  ON 0
 uu_1                 4.820426e-02 1 1  ON 1
 uu_2                -4.606546e-02 1 1  ON 2
 uu_3                -1.002743e-01 1 1  ON 3
 uu_4                -1.325309e-01 1 1  ON 4
 uu_5                -1.381514e-01 1 1  ON 5
 uu_6                -1.144769e-01 1 1  ON 6
 uu_7                -4.094172e-02 1 1  ON 7
 uu_8                 9.776519e-02 1 1  ON 8
 uu_9                 1.219056e-01 1 1  ON 9
 ud_0                 3.514139e-01 1 1  ON 10
 ud_1                 9.311673e-02 1 1  ON 11
 ud_2                -1.604749e-02 1 1  ON 12
 ud_3                -7.626283e-02 1 1  ON 13
 ud_4                -1.227713e-01 1 1  ON 14
 ud_5                -1.533191e-01 1 1  ON 15
 ud_6                -1.546705e-01 1 1  ON 16
 ud_7                -1.101590e-01 1 1  ON 17
 ud_8                 1.685095e-03 1 1  ON 18
 ud_9                 9.256624e-02 1 1  ON 19
 eO_0                -7.629389e-01 1 1  ON 20
 eO_1                -4.445543e-01 1 1  ON 21
 eO_2                -3.902254e-02 1 1  ON 22
 eO_3                 2.113639e-01 1 1  ON 23
 eO_4                 2.990233e-01 1 1  ON 24
 eO_5                 3.107294e-01 1 1  ON 25
 eO_6                 2.526598e-01 1 1  ON 26
 eO_7                 1.150646e-01 1 1  ON 27
 eO_8                 2.822327e-02 1 1  ON 28
 eO_9                 1.860273e-02 1 1  ON 29
eH1_0                -1.828541e-01 1 1  ON 30
eH1_1                -1.035510e-01 1 1  ON 31
eH1_2                -6.256502e-02 1 1  ON 32
eH1_3                -2.592275e-02 1 1  ON 33
eH1_4                 1.969706e-02 1 1  ON 34
eH1_5                 3.543158e-02 1 1  ON 35
eH1_6                 7.789565e-02 1 1  ON 36
eH1_7                 1.094603e-01 1 1  ON 37
eH1_8                 9.213528e-02 1 1  ON 38
eH1_9                 2.473102e-02 1 1  ON 39
eH2_0                -1.836407e-01 1 1  ON 40
eH2_1                -1.045869e-01 1 1  ON 41
eH2_2                -6.373172e-02 1 1  ON 42
eH2_3                -2.692843e-02 1 1  ON 43
eH2_4                 1.838371e-02 1 1  ON 44
eH2_5                 3.429399e-02 1 1  ON 45
eH2_6                 7.897690e-02 1 1  ON 46
eH2_7                 1.129403e-01 1 1  ON 47
eH2_8                 9.507945e-02 1 1  ON 48
eH2_9                 2.689020e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.155
    reference variance = 0.377376
====================================================
  Execution time = 2.0026e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4574e-01
  Total weights = 2.0000e+06
  Execution time = 1.8560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886322476
                                         uncertainty =       0.016113165052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886322476
                                         uncertainty =       0.016113165052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415777763
  error estimate for blocks of size 2^( 2) =       0.000425404317
  error estimate for blocks of size 2^( 3) =       0.000433606383
  error estimate for blocks of size 2^( 4) =       0.000439904469
  error estimate for blocks of size 2^( 5) =       0.000442190145
  error estimate for blocks of size 2^( 6) =       0.000444195287
  error estimate for blocks of size 2^( 7) =       0.000446603777

      target function =                  N/A
              le_mean =     -17.216364498318
             les_mean =     296.748948662720
             stat err =       0.000443223419
             autocorr =       1.136378172447
              std dev =       0.587998551555
             le_variance =       0.345742296631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886839338
                                         uncertainty =       0.016113195917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886839338
                                         uncertainty =       0.016113195917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415778074
  error estimate for blocks of size 2^( 2) =       0.000425404611
  error estimate for blocks of size 2^( 3) =       0.000433606657
  error estimate for blocks of size 2^( 4) =       0.000439904739
  error estimate for blocks of size 2^( 5) =       0.000442190408
  error estimate for blocks of size 2^( 6) =       0.000444195543
  error estimate for blocks of size 2^( 7) =       0.000446604047

      target function =                  N/A
              le_mean =     -17.216364499111
             les_mean =     296.748949206835
             stat err =       0.000443223684
             autocorr =       1.136377831281
              std dev =       0.587998991026
             le_variance =       0.345742813448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886580979
                                         uncertainty =       0.016113180486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886580979
                                         uncertainty =       0.016113180486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415777919
  error estimate for blocks of size 2^( 2) =       0.000425404464
  error estimate for blocks of size 2^( 3) =       0.000433606520
  error estimate for blocks of size 2^( 4) =       0.000439904604
  error estimate for blocks of size 2^( 5) =       0.000442190277
  error estimate for blocks of size 2^( 6) =       0.000444195415
  error estimate for blocks of size 2^( 7) =       0.000446603912

      target function =                  N/A
              le_mean =     -17.216364498716
             les_mean =     296.748948934879
             stat err =       0.000443223552
             autocorr =       1.136378001820
              std dev =       0.587998771352
             le_variance =       0.345742555111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886354791
                                         uncertainty =       0.016113166981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345886354791
                                         uncertainty =       0.016113166981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415777783
  error estimate for blocks of size 2^( 2) =       0.000425404335
  error estimate for blocks of size 2^( 3) =       0.000433606400
  error estimate for blocks of size 2^( 4) =       0.000439904486
  error estimate for blocks of size 2^( 5) =       0.000442190162
  error estimate for blocks of size 2^( 6) =       0.000444195303
  error estimate for blocks of size 2^( 7) =       0.000446603794

      target function =                  N/A
              le_mean =     -17.216364498368
             les_mean =     296.748948696742
             stat err =       0.000443223436
             autocorr =       1.136378151120
              std dev =       0.587998579032
             le_variance =       0.345742328943


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216364498318        initial
     3.9062e+02     3.9062e+03             1.7705e-06       -17.216364499111  <--
     1.5625e+03     1.5625e+04             4.4272e-07       -17.216364498716
     6.2500e+03     6.2500e+04             1.1068e-07       -17.216364498368

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9312e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 2.100483e-01 1 1  ON 0
 uu_1                 4.820442e-02 1 1  ON 1
 uu_2                -4.606543e-02 1 1  ON 2
 uu_3                -1.002742e-01 1 1  ON 3
 uu_4                -1.325310e-01 1 1  ON 4
 uu_5                -1.381516e-01 1 1  ON 5
 uu_6                -1.144770e-01 1 1  ON 6
 uu_7                -4.094192e-02 1 1  ON 7
 uu_8                 9.776503e-02 1 1  ON 8
 uu_9                 1.219057e-01 1 1  ON 9
 ud_0                 3.514142e-01 1 1  ON 10
 ud_1                 9.311705e-02 1 1  ON 11
 ud_2                -1.604767e-02 1 1  ON 12
 ud_3                -7.626283e-02 1 1  ON 13
 ud_4                -1.227715e-01 1 1  ON 14
 ud_5                -1.533191e-01 1 1  ON 15
 ud_6                -1.546705e-01 1 1  ON 16
 ud_7                -1.101590e-01 1 1  ON 17
 ud_8                 1.684806e-03 1 1  ON 18
 ud_9                 9.256621e-02 1 1  ON 19
 eO_0                -7.629402e-01 1 1  ON 20
 eO_1                -4.445549e-01 1 1  ON 21
 eO_2                -3.902265e-02 1 1  ON 22
 eO_3                 2.113642e-01 1 1  ON 23
 eO_4                 2.990242e-01 1 1  ON 24
 eO_5                 3.107297e-01 1 1  ON 25
 eO_6                 2.526600e-01 1 1  ON 26
 eO_7                 1.150648e-01 1 1  ON 27
 eO_8                 2.822331e-02 1 1  ON 28
 eO_9                 1.860274e-02 1 1  ON 29
eH1_0                -1.828542e-01 1 1  ON 30
eH1_1                -1.035510e-01 1 1  ON 31
eH1_2                -6.256499e-02 1 1  ON 32
eH1_3                -2.592285e-02 1 1  ON 33
eH1_4                 1.969705e-02 1 1  ON 34
eH1_5                 3.543153e-02 1 1  ON 35
eH1_6                 7.789570e-02 1 1  ON 36
eH1_7                 1.094603e-01 1 1  ON 37
eH1_8                 9.213540e-02 1 1  ON 38
eH1_9                 2.473105e-02 1 1  ON 39
eH2_0                -1.836409e-01 1 1  ON 40
eH2_1                -1.045870e-01 1 1  ON 41
eH2_2                -6.373162e-02 1 1  ON 42
eH2_3                -2.692824e-02 1 1  ON 43
eH2_4                 1.838383e-02 1 1  ON 44
eH2_5                 3.429387e-02 1 1  ON 45
eH2_6                 7.897685e-02 1 1  ON 46
eH2_7                 1.129403e-01 1 1  ON 47
eH2_8                 9.507956e-02 1 1  ON 48
eH2_9                 2.689024e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5487e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2684
    reference variance = 0.174011
====================================================
  Execution time = 2.0334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1663e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316640958550
                                         uncertainty =       0.003018586393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316640958550
                                         uncertainty =       0.003018586393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397887425
  error estimate for blocks of size 2^( 2) =       0.000407491436
  error estimate for blocks of size 2^( 3) =       0.000416479601
  error estimate for blocks of size 2^( 4) =       0.000422237580
  error estimate for blocks of size 2^( 5) =       0.000425805671
  error estimate for blocks of size 2^( 6) =       0.000428757826
  error estimate for blocks of size 2^( 7) =       0.000429539858

      target function =                  N/A
              le_mean =     -17.216254079755
             les_mean =     296.716033185758
             stat err =       0.000426585234
             autocorr =       1.149452978596
              std dev =       0.562697792249
             le_variance =       0.316628805402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721625407975e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216254079755       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216254090104       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216254116321       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216254121026       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216254118723       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216254120413       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216254118516       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 7.300602e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216254079755       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216254082346       residual = 9.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216254088918       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216254090110       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216254089520       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216254089935       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216254089464       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.826179e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216254079755       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216254080403       residual = 9.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216254082047       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216254082346       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216254082197       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216254082301       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216254082184       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 4.566091e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5905e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.100482e-01 1 1  ON 0
 uu_1                 4.820473e-02 1 1  ON 1
 uu_2                -4.606524e-02 1 1  ON 2
 uu_3                -1.002739e-01 1 1  ON 3
 uu_4                -1.325313e-01 1 1  ON 4
 uu_5                -1.381517e-01 1 1  ON 5
 uu_6                -1.144774e-01 1 1  ON 6
 uu_7                -4.094226e-02 1 1  ON 7
 uu_8                 9.776489e-02 1 1  ON 8
 uu_9                 1.219059e-01 1 1  ON 9
 ud_0                 3.514148e-01 1 1  ON 10
 ud_1                 9.311752e-02 1 1  ON 11
 ud_2                -1.604793e-02 1 1  ON 12
 ud_3                -7.626304e-02 1 1  ON 13
 ud_4                -1.227717e-01 1 1  ON 14
 ud_5                -1.533192e-01 1 1  ON 15
 ud_6                -1.546706e-01 1 1  ON 16
 ud_7                -1.101592e-01 1 1  ON 17
 ud_8                 1.684538e-03 1 1  ON 18
 ud_9                 9.256626e-02 1 1  ON 19
 eO_0                -7.629421e-01 1 1  ON 20
 eO_1                -4.445562e-01 1 1  ON 21
 eO_2                -3.902283e-02 1 1  ON 22
 eO_3                 2.113650e-01 1 1  ON 23
 eO_4                 2.990257e-01 1 1  ON 24
 eO_5                 3.107301e-01 1 1  ON 25
 eO_6                 2.526601e-01 1 1  ON 26
 eO_7                 1.150651e-01 1 1  ON 27
 eO_8                 2.822336e-02 1 1  ON 28
 eO_9                 1.860277e-02 1 1  ON 29
eH1_0                -1.828542e-01 1 1  ON 30
eH1_1                -1.035509e-01 1 1  ON 31
eH1_2                -6.256498e-02 1 1  ON 32
eH1_3                -2.592261e-02 1 1  ON 33
eH1_4                 1.969698e-02 1 1  ON 34
eH1_5                 3.543103e-02 1 1  ON 35
eH1_6                 7.789564e-02 1 1  ON 36
eH1_7                 1.094604e-01 1 1  ON 37
eH1_8                 9.213556e-02 1 1  ON 38
eH1_9                 2.473110e-02 1 1  ON 39
eH2_0                -1.836412e-01 1 1  ON 40
eH2_1                -1.045870e-01 1 1  ON 41
eH2_2                -6.373156e-02 1 1  ON 42
eH2_3                -2.692844e-02 1 1  ON 43
eH2_4                 1.838382e-02 1 1  ON 44
eH2_5                 3.429401e-02 1 1  ON 45
eH2_6                 7.897695e-02 1 1  ON 46
eH2_7                 1.129402e-01 1 1  ON 47
eH2_8                 9.507974e-02 1 1  ON 48
eH2_9                 2.689031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1158
    reference variance = 0.201029
====================================================
  Execution time = 2.1875e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1706e-01
  Total weights = 2.0000e+06
  Execution time = 1.8395e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317117240065
                                         uncertainty =       0.003183390732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317117240065
                                         uncertainty =       0.003183390732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398160902
  error estimate for blocks of size 2^( 2) =       0.000407721750
  error estimate for blocks of size 2^( 3) =       0.000416408790
  error estimate for blocks of size 2^( 4) =       0.000422346326
  error estimate for blocks of size 2^( 5) =       0.000426234318
  error estimate for blocks of size 2^( 6) =       0.000429207975
  error estimate for blocks of size 2^( 7) =       0.000431594874

      target function =                  N/A
              le_mean =     -17.216509590571
             les_mean =     296.725266531005
             stat err =       0.000427345873
             autocorr =       1.151971690472
              std dev =       0.563084547209
             le_variance =       0.317064207305

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317119005331
                                         uncertainty =       0.003183410098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317119005331
                                         uncertainty =       0.003183410098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398162011
  error estimate for blocks of size 2^( 2) =       0.000407722771
  error estimate for blocks of size 2^( 3) =       0.000416409737
  error estimate for blocks of size 2^( 4) =       0.000422347199
  error estimate for blocks of size 2^( 5) =       0.000426235143
  error estimate for blocks of size 2^( 6) =       0.000429208794
  error estimate for blocks of size 2^( 7) =       0.000431595585

      target function =                  N/A
              le_mean =     -17.216509603677
             les_mean =     296.725268748293
             stat err =       0.000427346680
             autocorr =       1.151969624148
              std dev =       0.563086115358
             le_variance =       0.317065973309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317118123638
                                         uncertainty =       0.003183400434

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317118123638
                                         uncertainty =       0.003183400434

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398161457
  error estimate for blocks of size 2^( 2) =       0.000407722261
  error estimate for blocks of size 2^( 3) =       0.000416409264
  error estimate for blocks of size 2^( 4) =       0.000422346763
  error estimate for blocks of size 2^( 5) =       0.000426234731
  error estimate for blocks of size 2^( 6) =       0.000429208385
  error estimate for blocks of size 2^( 7) =       0.000431595230

      target function =                  N/A
              le_mean =     -17.216509597130
             les_mean =     296.725267640785
             stat err =       0.000427346277
             autocorr =       1.151970655684
              std dev =       0.563085332119
             le_variance =       0.317065091248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317117350537
                                         uncertainty =       0.003183391946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317117350537
                                         uncertainty =       0.003183391946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398160971
  error estimate for blocks of size 2^( 2) =       0.000407721814
  error estimate for blocks of size 2^( 3) =       0.000416408849
  error estimate for blocks of size 2^( 4) =       0.000422346381
  error estimate for blocks of size 2^( 5) =       0.000426234370
  error estimate for blocks of size 2^( 6) =       0.000429208026
  error estimate for blocks of size 2^( 7) =       0.000431594919

      target function =                  N/A
              le_mean =     -17.216509591391
             les_mean =     296.725266669739
             stat err =       0.000427345924
             autocorr =       1.151971561083
              std dev =       0.563084645345
             le_variance =       0.317064317824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216509590571        initial
     9.7656e+01     9.7656e+02             7.3006e-06       -17.216509603677  <--
     3.9062e+02     3.9062e+03             1.8262e-06       -17.216509597130
     1.5625e+03     1.5625e+04             4.5661e-07       -17.216509591391

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 3.1223e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 2.100478e-01 1 1  ON 0
 uu_1                 4.820568e-02 1 1  ON 1
 uu_2                -4.606467e-02 1 1  ON 2
 uu_3                -1.002728e-01 1 1  ON 3
 uu_4                -1.325320e-01 1 1  ON 4
 uu_5                -1.381519e-01 1 1  ON 5
 uu_6                -1.144785e-01 1 1  ON 6
 uu_7                -4.094330e-02 1 1  ON 7
 uu_8                 9.776448e-02 1 1  ON 8
 uu_9                 1.219064e-01 1 1  ON 9
 ud_0                 3.514166e-01 1 1  ON 10
 ud_1                 9.311890e-02 1 1  ON 11
 ud_2                -1.604870e-02 1 1  ON 12
 ud_3                -7.626366e-02 1 1  ON 13
 ud_4                -1.227724e-01 1 1  ON 14
 ud_5                -1.533194e-01 1 1  ON 15
 ud_6                -1.546709e-01 1 1  ON 16
 ud_7                -1.101597e-01 1 1  ON 17
 ud_8                 1.683735e-03 1 1  ON 18
 ud_9                 9.256638e-02 1 1  ON 19
 eO_0                -7.629475e-01 1 1  ON 20
 eO_1                -4.445599e-01 1 1  ON 21
 eO_2                -3.902336e-02 1 1  ON 22
 eO_3                 2.113674e-01 1 1  ON 23
 eO_4                 2.990300e-01 1 1  ON 24
 eO_5                 3.107314e-01 1 1  ON 25
 eO_6                 2.526606e-01 1 1  ON 26
 eO_7                 1.150660e-01 1 1  ON 27
 eO_8                 2.822354e-02 1 1  ON 28
 eO_9                 1.860287e-02 1 1  ON 29
eH1_0                -1.828542e-01 1 1  ON 30
eH1_1                -1.035507e-01 1 1  ON 31
eH1_2                -6.256492e-02 1 1  ON 32
eH1_3                -2.592188e-02 1 1  ON 33
eH1_4                 1.969675e-02 1 1  ON 34
eH1_5                 3.542952e-02 1 1  ON 35
eH1_6                 7.789546e-02 1 1  ON 36
eH1_7                 1.094605e-01 1 1  ON 37
eH1_8                 9.213606e-02 1 1  ON 38
eH1_9                 2.473126e-02 1 1  ON 39
eH2_0                -1.836421e-01 1 1  ON 40
eH2_1                -1.045870e-01 1 1  ON 41
eH2_2                -6.373138e-02 1 1  ON 42
eH2_3                -2.692905e-02 1 1  ON 43
eH2_4                 1.838377e-02 1 1  ON 44
eH2_5                 3.429443e-02 1 1  ON 45
eH2_6                 7.897724e-02 1 1  ON 46
eH2_7                 1.129399e-01 1 1  ON 47
eH2_8                 9.508031e-02 1 1  ON 48
eH2_9                 2.689052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7137e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.193899
====================================================
  Execution time = 2.0184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2201e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322101543958
                                         uncertainty =       0.004035244913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322101543958
                                         uncertainty =       0.004035244913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401256509
  error estimate for blocks of size 2^( 2) =       0.000410965808
  error estimate for blocks of size 2^( 3) =       0.000419894445
  error estimate for blocks of size 2^( 4) =       0.000426619326
  error estimate for blocks of size 2^( 5) =       0.000430392872
  error estimate for blocks of size 2^( 6) =       0.000432665392
  error estimate for blocks of size 2^( 7) =       0.000433940567

      target function =                  N/A
              le_mean =     -17.217089556050
             les_mean =     296.750186191364
             stat err =       0.000430904539
             autocorr =       1.153235381230
              std dev =       0.567462396401
             le_variance =       0.322013571329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721708955605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089556050       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089583729       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089620396       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217089671084       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089655863       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217089659443       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217089658250       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 2.703958e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089556050       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089563012       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089572262       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217089584870       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089581041       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217089581993       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217089581679       residual = 7.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 6.775818e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217089556050       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217089557793       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217089560111       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217089563259       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217089562300       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217089562542       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217089562462       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.694961e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5683e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.100481e-01 1 1  ON 0
 uu_1                 4.820730e-02 1 1  ON 1
 uu_2                -4.606399e-02 1 1  ON 2
 uu_3                -1.002722e-01 1 1  ON 3
 uu_4                -1.325331e-01 1 1  ON 4
 uu_5                -1.381527e-01 1 1  ON 5
 uu_6                -1.144790e-01 1 1  ON 6
 uu_7                -4.094435e-02 1 1  ON 7
 uu_8                 9.776361e-02 1 1  ON 8
 uu_9                 1.219069e-01 1 1  ON 9
 ud_0                 3.514175e-01 1 1  ON 10
 ud_1                 9.312119e-02 1 1  ON 11
 ud_2                -1.604924e-02 1 1  ON 12
 ud_3                -7.626347e-02 1 1  ON 13
 ud_4                -1.227734e-01 1 1  ON 14
 ud_5                -1.533192e-01 1 1  ON 15
 ud_6                -1.546713e-01 1 1  ON 16
 ud_7                -1.101605e-01 1 1  ON 17
 ud_8                 1.682270e-03 1 1  ON 18
 ud_9                 9.256631e-02 1 1  ON 19
 eO_0                -7.629543e-01 1 1  ON 20
 eO_1                -4.445644e-01 1 1  ON 21
 eO_2                -3.902433e-02 1 1  ON 22
 eO_3                 2.113711e-01 1 1  ON 23
 eO_4                 2.990346e-01 1 1  ON 24
 eO_5                 3.107334e-01 1 1  ON 25
 eO_6                 2.526611e-01 1 1  ON 26
 eO_7                 1.150671e-01 1 1  ON 27
 eO_8                 2.822364e-02 1 1  ON 28
 eO_9                 1.860293e-02 1 1  ON 29
eH1_0                -1.828541e-01 1 1  ON 30
eH1_1                -1.035516e-01 1 1  ON 31
eH1_2                -6.256520e-02 1 1  ON 32
eH1_3                -2.592197e-02 1 1  ON 33
eH1_4                 1.969626e-02 1 1  ON 34
eH1_5                 3.542924e-02 1 1  ON 35
eH1_6                 7.789629e-02 1 1  ON 36
eH1_7                 1.094607e-01 1 1  ON 37
eH1_8                 9.213674e-02 1 1  ON 38
eH1_9                 2.473147e-02 1 1  ON 39
eH2_0                -1.836426e-01 1 1  ON 40
eH2_1                -1.045875e-01 1 1  ON 41
eH2_2                -6.373183e-02 1 1  ON 42
eH2_3                -2.692872e-02 1 1  ON 43
eH2_4                 1.838414e-02 1 1  ON 44
eH2_5                 3.429471e-02 1 1  ON 45
eH2_6                 7.897711e-02 1 1  ON 46
eH2_7                 1.129397e-01 1 1  ON 47
eH2_8                 9.508093e-02 1 1  ON 48
eH2_9                 2.689070e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2377
    reference variance = 0.213588
====================================================
  Execution time = 2.0134e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1602e-01
  Total weights = 2.0000e+06
  Execution time = 1.8522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957396461
                                         uncertainty =       0.003644866627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957396461
                                         uncertainty =       0.003644866627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397506416
  error estimate for blocks of size 2^( 2) =       0.000407219935
  error estimate for blocks of size 2^( 3) =       0.000415871863
  error estimate for blocks of size 2^( 4) =       0.000422916616
  error estimate for blocks of size 2^( 5) =       0.000427324665
  error estimate for blocks of size 2^( 6) =       0.000429654719
  error estimate for blocks of size 2^( 7) =       0.000427620645

      target function =                  N/A
              le_mean =     -17.216324293847
             les_mean =     296.717844734418
             stat err =       0.000426879161
             autocorr =       1.153245115278
              std dev =       0.562158964633
             le_variance =       0.316022701517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315960570535
                                         uncertainty =       0.003644924893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315960570535
                                         uncertainty =       0.003644924893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397508415
  error estimate for blocks of size 2^( 2) =       0.000407221702
  error estimate for blocks of size 2^( 3) =       0.000415873370
  error estimate for blocks of size 2^( 4) =       0.000422917790
  error estimate for blocks of size 2^( 5) =       0.000427325824
  error estimate for blocks of size 2^( 6) =       0.000429655844
  error estimate for blocks of size 2^( 7) =       0.000427621764

      target function =                  N/A
              le_mean =     -17.216324272445
             les_mean =     296.717847176284
             stat err =       0.000426880305
             autocorr =       1.153239696906
              std dev =       0.562161791950
             le_variance =       0.316025880328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315958971253
                                         uncertainty =       0.003644895693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315958971253
                                         uncertainty =       0.003644895693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397507408
  error estimate for blocks of size 2^( 2) =       0.000407220810
  error estimate for blocks of size 2^( 3) =       0.000415872608
  error estimate for blocks of size 2^( 4) =       0.000422917193
  error estimate for blocks of size 2^( 5) =       0.000427325235
  error estimate for blocks of size 2^( 6) =       0.000429655272
  error estimate for blocks of size 2^( 7) =       0.000427621194

      target function =                  N/A
              le_mean =     -17.216324283152
             les_mean =     296.717845943337
             stat err =       0.000426879723
             autocorr =       1.153242396181
              std dev =       0.562160367411
             le_variance =       0.316024278687

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957592864
                                         uncertainty =       0.003644870258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315957592864
                                         uncertainty =       0.003644870258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397506540
  error estimate for blocks of size 2^( 2) =       0.000407220044
  error estimate for blocks of size 2^( 3) =       0.000415871956
  error estimate for blocks of size 2^( 4) =       0.000422916688
  error estimate for blocks of size 2^( 5) =       0.000427324736
  error estimate for blocks of size 2^( 6) =       0.000429654788
  error estimate for blocks of size 2^( 7) =       0.000427620713

      target function =                  N/A
              le_mean =     -17.216324292505
             les_mean =     296.717844884912
             stat err =       0.000426879231
             autocorr =       1.153244775066
              std dev =       0.562159139583
             le_variance =       0.316022898217


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216324293847        initial  <--
     2.4414e+01     2.4414e+02             2.7040e-05       -17.216324272445
     9.7656e+01     9.7656e+02             6.7758e-06       -17.216324283152
     3.9062e+02     3.9062e+03             1.6950e-06       -17.216324292505

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4857
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 2.100478e-01 1 1  ON 0
 uu_1                 4.820568e-02 1 1  ON 1
 uu_2                -4.606467e-02 1 1  ON 2
 uu_3                -1.002728e-01 1 1  ON 3
 uu_4                -1.325320e-01 1 1  ON 4
 uu_5                -1.381519e-01 1 1  ON 5
 uu_6                -1.144785e-01 1 1  ON 6
 uu_7                -4.094330e-02 1 1  ON 7
 uu_8                 9.776448e-02 1 1  ON 8
 uu_9                 1.219064e-01 1 1  ON 9
 ud_0                 3.514166e-01 1 1  ON 10
 ud_1                 9.311890e-02 1 1  ON 11
 ud_2                -1.604870e-02 1 1  ON 12
 ud_3                -7.626366e-02 1 1  ON 13
 ud_4                -1.227724e-01 1 1  ON 14
 ud_5                -1.533194e-01 1 1  ON 15
 ud_6                -1.546709e-01 1 1  ON 16
 ud_7                -1.101597e-01 1 1  ON 17
 ud_8                 1.683735e-03 1 1  ON 18
 ud_9                 9.256638e-02 1 1  ON 19
 eO_0                -7.629475e-01 1 1  ON 20
 eO_1                -4.445599e-01 1 1  ON 21
 eO_2                -3.902336e-02 1 1  ON 22
 eO_3                 2.113674e-01 1 1  ON 23
 eO_4                 2.990300e-01 1 1  ON 24
 eO_5                 3.107314e-01 1 1  ON 25
 eO_6                 2.526606e-01 1 1  ON 26
 eO_7                 1.150660e-01 1 1  ON 27
 eO_8                 2.822354e-02 1 1  ON 28
 eO_9                 1.860287e-02 1 1  ON 29
eH1_0                -1.828542e-01 1 1  ON 30
eH1_1                -1.035507e-01 1 1  ON 31
eH1_2                -6.256492e-02 1 1  ON 32
eH1_3                -2.592188e-02 1 1  ON 33
eH1_4                 1.969675e-02 1 1  ON 34
eH1_5                 3.542952e-02 1 1  ON 35
eH1_6                 7.789546e-02 1 1  ON 36
eH1_7                 1.094605e-01 1 1  ON 37
eH1_8                 9.213606e-02 1 1  ON 38
eH1_9                 2.473126e-02 1 1  ON 39
eH2_0                -1.836421e-01 1 1  ON 40
eH2_1                -1.045870e-01 1 1  ON 41
eH2_2                -6.373138e-02 1 1  ON 42
eH2_3                -2.692905e-02 1 1  ON 43
eH2_4                 1.838377e-02 1 1  ON 44
eH2_5                 3.429443e-02 1 1  ON 45
eH2_6                 7.897724e-02 1 1  ON 46
eH2_7                 1.129399e-01 1 1  ON 47
eH2_8                 9.508031e-02 1 1  ON 48
eH2_9                 2.689052e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5174e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2451
    reference variance = 0.415476
====================================================
  Execution time = 2.0059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1874e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318785583604
                                         uncertainty =       0.005233833980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318785583604
                                         uncertainty =       0.005233833980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399211775
  error estimate for blocks of size 2^( 2) =       0.000409178149
  error estimate for blocks of size 2^( 3) =       0.000418182421
  error estimate for blocks of size 2^( 4) =       0.000425041662
  error estimate for blocks of size 2^( 5) =       0.000429623313
  error estimate for blocks of size 2^( 6) =       0.000431017358
  error estimate for blocks of size 2^( 7) =       0.000430398044

      target function =                  N/A
              le_mean =     -17.216621506969
             les_mean =     296.730796037049
             stat err =       0.000429020094
             autocorr =       1.154911173273
              std dev =       0.564570706094
             le_variance =       0.318740082180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721662150697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621506969       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216621512181       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216621516136       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216621516251       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216621515125       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216621515923       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216621515898       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216621515971       residual = 9.92e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.385571e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621506969       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216621508273       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216621509263       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216621509292       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216621509010       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216621509209       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216621509202       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216621509221       residual = 9.88e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.963895e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216621506969       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216621507295       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216621507543       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216621507551       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216621507481       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216621507528       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216621507527       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216621507528       residual = 9.86e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.490972e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221869 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5521e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.100480e-01 1 1  ON 0
 uu_1                 4.820578e-02 1 1  ON 1
 uu_2                -4.606466e-02 1 1  ON 2
 uu_3                -1.002727e-01 1 1  ON 3
 uu_4                -1.325320e-01 1 1  ON 4
 uu_5                -1.381520e-01 1 1  ON 5
 uu_6                -1.144786e-01 1 1  ON 6
 uu_7                -4.094342e-02 1 1  ON 7
 uu_8                 9.776440e-02 1 1  ON 8
 uu_9                 1.219065e-01 1 1  ON 9
 ud_0                 3.514170e-01 1 1  ON 10
 ud_1                 9.311903e-02 1 1  ON 11
 ud_2                -1.604871e-02 1 1  ON 12
 ud_3                -7.626372e-02 1 1  ON 13
 ud_4                -1.227725e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546710e-01 1 1  ON 16
 ud_7                -1.101598e-01 1 1  ON 17
 ud_8                 1.683590e-03 1 1  ON 18
 ud_9                 9.256638e-02 1 1  ON 19
 eO_0                -7.629481e-01 1 1  ON 20
 eO_1                -4.445604e-01 1 1  ON 21
 eO_2                -3.902339e-02 1 1  ON 22
 eO_3                 2.113677e-01 1 1  ON 23
 eO_4                 2.990304e-01 1 1  ON 24
 eO_5                 3.107316e-01 1 1  ON 25
 eO_6                 2.526607e-01 1 1  ON 26
 eO_7                 1.150661e-01 1 1  ON 27
 eO_8                 2.822355e-02 1 1  ON 28
 eO_9                 1.860287e-02 1 1  ON 29
eH1_0                -1.828543e-01 1 1  ON 30
eH1_1                -1.035508e-01 1 1  ON 31
eH1_2                -6.256490e-02 1 1  ON 32
eH1_3                -2.592184e-02 1 1  ON 33
eH1_4                 1.969682e-02 1 1  ON 34
eH1_5                 3.542945e-02 1 1  ON 35
eH1_6                 7.789549e-02 1 1  ON 36
eH1_7                 1.094605e-01 1 1  ON 37
eH1_8                 9.213612e-02 1 1  ON 38
eH1_9                 2.473127e-02 1 1  ON 39
eH2_0                -1.836421e-01 1 1  ON 40
eH2_1                -1.045871e-01 1 1  ON 41
eH2_2                -6.373142e-02 1 1  ON 42
eH2_3                -2.692903e-02 1 1  ON 43
eH2_4                 1.838386e-02 1 1  ON 44
eH2_5                 3.429439e-02 1 1  ON 45
eH2_6                 7.897725e-02 1 1  ON 46
eH2_7                 1.129399e-01 1 1  ON 47
eH2_8                 9.508037e-02 1 1  ON 48
eH2_9                 2.689054e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2368
    reference variance = 0.161154
====================================================
  Execution time = 1.9768e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3164e-01
  Total weights = 2.0000e+06
  Execution time = 1.8305e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331704749802
                                         uncertainty =       0.010148726805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331704749802
                                         uncertainty =       0.010148726805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407208170
  error estimate for blocks of size 2^( 2) =       0.000416841712
  error estimate for blocks of size 2^( 3) =       0.000425565284
  error estimate for blocks of size 2^( 4) =       0.000431510447
  error estimate for blocks of size 2^( 5) =       0.000434950137
  error estimate for blocks of size 2^( 6) =       0.000436855767
  error estimate for blocks of size 2^( 7) =       0.000437610844

      target function =                  N/A
              le_mean =     -17.216136728813
             les_mean =     296.727000686695
             stat err =       0.000435231799
             autocorr =       1.142373896096
              std dev =       0.575879316633
             le_variance =       0.331636987326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331706233684
                                         uncertainty =       0.010148782798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331706233684
                                         uncertainty =       0.010148782798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407209081
  error estimate for blocks of size 2^( 2) =       0.000416842577
  error estimate for blocks of size 2^( 3) =       0.000425566102
  error estimate for blocks of size 2^( 4) =       0.000431511229
  error estimate for blocks of size 2^( 5) =       0.000434950913
  error estimate for blocks of size 2^( 6) =       0.000436856535
  error estimate for blocks of size 2^( 7) =       0.000437611608

      target function =                  N/A
              le_mean =     -17.216136732875
             les_mean =     296.727002310058
             stat err =       0.000435232571
             autocorr =       1.142372839860
              std dev =       0.575880604656
             le_variance =       0.331638470819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331705492543
                                         uncertainty =       0.010148754836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331705492543
                                         uncertainty =       0.010148754836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407208626
  error estimate for blocks of size 2^( 2) =       0.000416842145
  error estimate for blocks of size 2^( 3) =       0.000425565693
  error estimate for blocks of size 2^( 4) =       0.000431510838
  error estimate for blocks of size 2^( 5) =       0.000434950525
  error estimate for blocks of size 2^( 6) =       0.000436856151
  error estimate for blocks of size 2^( 7) =       0.000437611226

      target function =                  N/A
              le_mean =     -17.216136730846
             les_mean =     296.727001499231
             stat err =       0.000435232185
             autocorr =       1.142373367463
              std dev =       0.575879961339
             le_variance =       0.331637729872

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331704842669
                                         uncertainty =       0.010148730310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331704842669
                                         uncertainty =       0.010148730310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407208227
  error estimate for blocks of size 2^( 2) =       0.000416841766
  error estimate for blocks of size 2^( 3) =       0.000425565335
  error estimate for blocks of size 2^( 4) =       0.000431510496
  error estimate for blocks of size 2^( 5) =       0.000434950186
  error estimate for blocks of size 2^( 6) =       0.000436855815
  error estimate for blocks of size 2^( 7) =       0.000437610892

      target function =                  N/A
              le_mean =     -17.216136729067
             les_mean =     296.727000788287
             stat err =       0.000435231847
             autocorr =       1.142373829996
              std dev =       0.575879397243
             le_variance =       0.331637080169


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216136728813        initial
     2.4414e+02     2.4414e+03             2.3856e-06       -17.216136732875  <--
     9.7656e+02     9.7656e+03             5.9639e-07       -17.216136730846
     3.9062e+03     3.9062e+04             1.4910e-07       -17.216136729067

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9031e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 2.100484e-01 1 1  ON 0
 uu_1                 4.820608e-02 1 1  ON 1
 uu_2                -4.606463e-02 1 1  ON 2
 uu_3                -1.002727e-01 1 1  ON 3
 uu_4                -1.325322e-01 1 1  ON 4
 uu_5                -1.381521e-01 1 1  ON 5
 uu_6                -1.144788e-01 1 1  ON 6
 uu_7                -4.094380e-02 1 1  ON 7
 uu_8                 9.776416e-02 1 1  ON 8
 uu_9                 1.219066e-01 1 1  ON 9
 ud_0                 3.514183e-01 1 1  ON 10
 ud_1                 9.311940e-02 1 1  ON 11
 ud_2                -1.604874e-02 1 1  ON 12
 ud_3                -7.626389e-02 1 1  ON 13
 ud_4                -1.227729e-01 1 1  ON 14
 ud_5                -1.533200e-01 1 1  ON 15
 ud_6                -1.546710e-01 1 1  ON 16
 ud_7                -1.101602e-01 1 1  ON 17
 ud_8                 1.683153e-03 1 1  ON 18
 ud_9                 9.256639e-02 1 1  ON 19
 eO_0                -7.629499e-01 1 1  ON 20
 eO_1                -4.445619e-01 1 1  ON 21
 eO_2                -3.902349e-02 1 1  ON 22
 eO_3                 2.113685e-01 1 1  ON 23
 eO_4                 2.990316e-01 1 1  ON 24
 eO_5                 3.107322e-01 1 1  ON 25
 eO_6                 2.526610e-01 1 1  ON 26
 eO_7                 1.150665e-01 1 1  ON 27
 eO_8                 2.822359e-02 1 1  ON 28
 eO_9                 1.860290e-02 1 1  ON 29
eH1_0                -1.828546e-01 1 1  ON 30
eH1_1                -1.035510e-01 1 1  ON 31
eH1_2                -6.256483e-02 1 1  ON 32
eH1_3                -2.592169e-02 1 1  ON 33
eH1_4                 1.969703e-02 1 1  ON 34
eH1_5                 3.542927e-02 1 1  ON 35
eH1_6                 7.789561e-02 1 1  ON 36
eH1_7                 1.094605e-01 1 1  ON 37
eH1_8                 9.213629e-02 1 1  ON 38
eH1_9                 2.473132e-02 1 1  ON 39
eH2_0                -1.836423e-01 1 1  ON 40
eH2_1                -1.045874e-01 1 1  ON 41
eH2_2                -6.373154e-02 1 1  ON 42
eH2_3                -2.692897e-02 1 1  ON 43
eH2_4                 1.838413e-02 1 1  ON 44
eH2_5                 3.429428e-02 1 1  ON 45
eH2_6                 7.897728e-02 1 1  ON 46
eH2_7                 1.129399e-01 1 1  ON 47
eH2_8                 9.508057e-02 1 1  ON 48
eH2_9                 2.689061e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4558e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2175
    reference variance = 0.186157
====================================================
  Execution time = 2.0169e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1471e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314818468004
                                         uncertainty =       0.004912953093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314818468004
                                         uncertainty =       0.004912953093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396682692
  error estimate for blocks of size 2^( 2) =       0.000406010434
  error estimate for blocks of size 2^( 3) =       0.000414887919
  error estimate for blocks of size 2^( 4) =       0.000420396717
  error estimate for blocks of size 2^( 5) =       0.000424904288
  error estimate for blocks of size 2^( 6) =       0.000427985166
  error estimate for blocks of size 2^( 7) =       0.000430329139

      target function =                  N/A
              le_mean =     -17.216666300122
             les_mean =     296.728312648481
             stat err =       0.000425903827
             autocorr =       1.152753852241
              std dev =       0.560994042814
             le_variance =       0.314714316073


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721666630012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216666300122       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216666310251       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216666327928       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216666314159       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216666318750       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216666318629       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216666319258       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216666319044       residual = 3.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.124621e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216666300122       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216666302661       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216666307101       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216666303664       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216666304806       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216666304766       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216666304924       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216666304872       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.814433e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216666300122       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216666300757       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216666301869       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216666301010       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216666301295       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216666301284       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216666301324       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216666301311       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 7.037891e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5929e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.100490e-01 1 1  ON 0
 uu_1                 4.820669e-02 1 1  ON 1
 uu_2                -4.606426e-02 1 1  ON 2
 uu_3                -1.002728e-01 1 1  ON 3
 uu_4                -1.325324e-01 1 1  ON 4
 uu_5                -1.381526e-01 1 1  ON 5
 uu_6                -1.144793e-01 1 1  ON 6
 uu_7                -4.094417e-02 1 1  ON 7
 uu_8                 9.776395e-02 1 1  ON 8
 uu_9                 1.219068e-01 1 1  ON 9
 ud_0                 3.514190e-01 1 1  ON 10
 ud_1                 9.311978e-02 1 1  ON 11
 ud_2                -1.604901e-02 1 1  ON 12
 ud_3                -7.626416e-02 1 1  ON 13
 ud_4                -1.227732e-01 1 1  ON 14
 ud_5                -1.533198e-01 1 1  ON 15
 ud_6                -1.546712e-01 1 1  ON 16
 ud_7                -1.101603e-01 1 1  ON 17
 ud_8                 1.682705e-03 1 1  ON 18
 ud_9                 9.256641e-02 1 1  ON 19
 eO_0                -7.629527e-01 1 1  ON 20
 eO_1                -4.445636e-01 1 1  ON 21
 eO_2                -3.902363e-02 1 1  ON 22
 eO_3                 2.113696e-01 1 1  ON 23
 eO_4                 2.990334e-01 1 1  ON 24
 eO_5                 3.107330e-01 1 1  ON 25
 eO_6                 2.526614e-01 1 1  ON 26
 eO_7                 1.150669e-01 1 1  ON 27
 eO_8                 2.822368e-02 1 1  ON 28
 eO_9                 1.860293e-02 1 1  ON 29
eH1_0                -1.828546e-01 1 1  ON 30
eH1_1                -1.035505e-01 1 1  ON 31
eH1_2                -6.256533e-02 1 1  ON 32
eH1_3                -2.592169e-02 1 1  ON 33
eH1_4                 1.969701e-02 1 1  ON 34
eH1_5                 3.542887e-02 1 1  ON 35
eH1_6                 7.789553e-02 1 1  ON 36
eH1_7                 1.094606e-01 1 1  ON 37
eH1_8                 9.213659e-02 1 1  ON 38
eH1_9                 2.473140e-02 1 1  ON 39
eH2_0                -1.836425e-01 1 1  ON 40
eH2_1                -1.045877e-01 1 1  ON 41
eH2_2                -6.373162e-02 1 1  ON 42
eH2_3                -2.692849e-02 1 1  ON 43
eH2_4                 1.838415e-02 1 1  ON 44
eH2_5                 3.429411e-02 1 1  ON 45
eH2_6                 7.897731e-02 1 1  ON 46
eH2_7                 1.129398e-01 1 1  ON 47
eH2_8                 9.508081e-02 1 1  ON 48
eH2_9                 2.689071e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2815
    reference variance = 0.26159
====================================================
  Execution time = 1.9805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1639e-01
  Total weights = 2.0000e+06
  Execution time = 1.8375e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492462612
                                         uncertainty =       0.005138160652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492462612
                                         uncertainty =       0.005138160652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397738186
  error estimate for blocks of size 2^( 2) =       0.000407844193
  error estimate for blocks of size 2^( 3) =       0.000416874400
  error estimate for blocks of size 2^( 4) =       0.000423597188
  error estimate for blocks of size 2^( 5) =       0.000427051056
  error estimate for blocks of size 2^( 6) =       0.000429702082
  error estimate for blocks of size 2^( 7) =       0.000433026797

      target function =                  N/A
              le_mean =     -17.216460221822
             les_mean =     296.722893740256
             stat err =       0.000428344281
             autocorr =       1.159822069807
              std dev =       0.562486736626
             le_variance =       0.316391328881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316496070737
                                         uncertainty =       0.005138230407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316496070737
                                         uncertainty =       0.005138230407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397740453
  error estimate for blocks of size 2^( 2) =       0.000407846311
  error estimate for blocks of size 2^( 3) =       0.000416876361
  error estimate for blocks of size 2^( 4) =       0.000423599046
  error estimate for blocks of size 2^( 5) =       0.000427052816
  error estimate for blocks of size 2^( 6) =       0.000429703840
  error estimate for blocks of size 2^( 7) =       0.000433028564

      target function =                  N/A
              le_mean =     -17.216460222285
             les_mean =     296.722897363400
             stat err =       0.000428346067
             autocorr =       1.159818516857
              std dev =       0.562489943090
             le_variance =       0.316394936077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316494271258
                                         uncertainty =       0.005138195582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316494271258
                                         uncertainty =       0.005138195582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397739322
  error estimate for blocks of size 2^( 2) =       0.000407845255
  error estimate for blocks of size 2^( 3) =       0.000416875383
  error estimate for blocks of size 2^( 4) =       0.000423598119
  error estimate for blocks of size 2^( 5) =       0.000427051938
  error estimate for blocks of size 2^( 6) =       0.000429702963
  error estimate for blocks of size 2^( 7) =       0.000433027683

      target function =                  N/A
              le_mean =     -17.216460222063
             les_mean =     296.722895556745
             stat err =       0.000428345176
             autocorr =       1.159820288444
              std dev =       0.562488343934
             le_variance =       0.316393137062

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492688830
                                         uncertainty =       0.005138165020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316492688830
                                         uncertainty =       0.005138165020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397738328
  error estimate for blocks of size 2^( 2) =       0.000407844326
  error estimate for blocks of size 2^( 3) =       0.000416874523
  error estimate for blocks of size 2^( 4) =       0.000423597304
  error estimate for blocks of size 2^( 5) =       0.000427051167
  error estimate for blocks of size 2^( 6) =       0.000429702192
  error estimate for blocks of size 2^( 7) =       0.000433026908

      target function =                  N/A
              le_mean =     -17.216460221851
             les_mean =     296.722893967433
             stat err =       0.000428344393
             autocorr =       1.159821846980
              std dev =       0.562486937662
             le_variance =       0.316391555041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216460221822        initial
     6.1035e+01     6.1035e+02             1.1246e-05       -17.216460222285  <--
     2.4414e+02     2.4414e+03             2.8144e-06       -17.216460222063
     9.7656e+02     9.7656e+03             7.0379e-07       -17.216460221851

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9084e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 2.100505e-01 1 1  ON 0
 uu_1                 4.820854e-02 1 1  ON 1
 uu_2                -4.606313e-02 1 1  ON 2
 uu_3                -1.002733e-01 1 1  ON 3
 uu_4                -1.325331e-01 1 1  ON 4
 uu_5                -1.381541e-01 1 1  ON 5
 uu_6                -1.144809e-01 1 1  ON 6
 uu_7                -4.094526e-02 1 1  ON 7
 uu_8                 9.776332e-02 1 1  ON 8
 uu_9                 1.219074e-01 1 1  ON 9
 ud_0                 3.514212e-01 1 1  ON 10
 ud_1                 9.312089e-02 1 1  ON 11
 ud_2                -1.604980e-02 1 1  ON 12
 ud_3                -7.626495e-02 1 1  ON 13
 ud_4                -1.227742e-01 1 1  ON 14
 ud_5                -1.533192e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.681363e-03 1 1  ON 18
 ud_9                 9.256647e-02 1 1  ON 19
 eO_0                -7.629612e-01 1 1  ON 20
 eO_1                -4.445685e-01 1 1  ON 21
 eO_2                -3.902406e-02 1 1  ON 22
 eO_3                 2.113726e-01 1 1  ON 23
 eO_4                 2.990388e-01 1 1  ON 24
 eO_5                 3.107354e-01 1 1  ON 25
 eO_6                 2.526624e-01 1 1  ON 26
 eO_7                 1.150683e-01 1 1  ON 27
 eO_8                 2.822394e-02 1 1  ON 28
 eO_9                 1.860302e-02 1 1  ON 29
eH1_0                -1.828546e-01 1 1  ON 30
eH1_1                -1.035491e-01 1 1  ON 31
eH1_2                -6.256684e-02 1 1  ON 32
eH1_3                -2.592171e-02 1 1  ON 33
eH1_4                 1.969694e-02 1 1  ON 34
eH1_5                 3.542769e-02 1 1  ON 35
eH1_6                 7.789529e-02 1 1  ON 36
eH1_7                 1.094609e-01 1 1  ON 37
eH1_8                 9.213747e-02 1 1  ON 38
eH1_9                 2.473164e-02 1 1  ON 39
eH2_0                -1.836431e-01 1 1  ON 40
eH2_1                -1.045888e-01 1 1  ON 41
eH2_2                -6.373186e-02 1 1  ON 42
eH2_3                -2.692706e-02 1 1  ON 43
eH2_4                 1.838422e-02 1 1  ON 44
eH2_5                 3.429359e-02 1 1  ON 45
eH2_6                 7.897743e-02 1 1  ON 46
eH2_7                 1.129395e-01 1 1  ON 47
eH2_8                 9.508154e-02 1 1  ON 48
eH2_9                 2.689101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2505
    reference variance = 0.146723
====================================================
  Execution time = 2.0290e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318048346640
                                         uncertainty =       0.003542314963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318048346640
                                         uncertainty =       0.003542314963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398696727
  error estimate for blocks of size 2^( 2) =       0.000408792971
  error estimate for blocks of size 2^( 3) =       0.000417549561
  error estimate for blocks of size 2^( 4) =       0.000423546415
  error estimate for blocks of size 2^( 5) =       0.000427269283
  error estimate for blocks of size 2^( 6) =       0.000429209433
  error estimate for blocks of size 2^( 7) =       0.000429053315

      target function =                  N/A
              le_mean =     -17.216117073038
             les_mean =     296.712605073982
             stat err =       0.000427269611
             autocorr =       1.148467395621
              std dev =       0.563842318730
             le_variance =       0.317918160390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611707304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117073038       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216117060144       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216117076639       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216117137664       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216117141519       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216117163279       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216117169928       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 4.474325e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117073038       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216117069766       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216117073913       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216117089096       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216117089935       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216117095279       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216117097055       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 1.121835e-05

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216117073038       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216117072217       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216117073255       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216117077046       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216117077248       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216117078577       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216117079028       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.806646e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.226951 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5800e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.100541e-01 1 1  ON 0
 uu_1                 4.821028e-02 1 1  ON 1
 uu_2                -4.606243e-02 1 1  ON 2
 uu_3                -1.002725e-01 1 1  ON 3
 uu_4                -1.325351e-01 1 1  ON 4
 uu_5                -1.381556e-01 1 1  ON 5
 uu_6                -1.144826e-01 1 1  ON 6
 uu_7                -4.094779e-02 1 1  ON 7
 uu_8                 9.776224e-02 1 1  ON 8
 uu_9                 1.219083e-01 1 1  ON 9
 ud_0                 3.514252e-01 1 1  ON 10
 ud_1                 9.312394e-02 1 1  ON 11
 ud_2                -1.605188e-02 1 1  ON 12
 ud_3                -7.626605e-02 1 1  ON 13
 ud_4                -1.227762e-01 1 1  ON 14
 ud_5                -1.533196e-01 1 1  ON 15
 ud_6                -1.546719e-01 1 1  ON 16
 ud_7                -1.101608e-01 1 1  ON 17
 ud_8                 1.679697e-03 1 1  ON 18
 ud_9                 9.256636e-02 1 1  ON 19
 eO_0                -7.629724e-01 1 1  ON 20
 eO_1                -4.445757e-01 1 1  ON 21
 eO_2                -3.902403e-02 1 1  ON 22
 eO_3                 2.113783e-01 1 1  ON 23
 eO_4                 2.990450e-01 1 1  ON 24
 eO_5                 3.107380e-01 1 1  ON 25
 eO_6                 2.526640e-01 1 1  ON 26
 eO_7                 1.150703e-01 1 1  ON 27
 eO_8                 2.822423e-02 1 1  ON 28
 eO_9                 1.860313e-02 1 1  ON 29
eH1_0                -1.828552e-01 1 1  ON 30
eH1_1                -1.035481e-01 1 1  ON 31
eH1_2                -6.256638e-02 1 1  ON 32
eH1_3                -2.592085e-02 1 1  ON 33
eH1_4                 1.969738e-02 1 1  ON 34
eH1_5                 3.542433e-02 1 1  ON 35
eH1_6                 7.789499e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213863e-02 1 1  ON 38
eH1_9                 2.473202e-02 1 1  ON 39
eH2_0                -1.836436e-01 1 1  ON 40
eH2_1                -1.045901e-01 1 1  ON 41
eH2_2                -6.373217e-02 1 1  ON 42
eH2_3                -2.692724e-02 1 1  ON 43
eH2_4                 1.838350e-02 1 1  ON 44
eH2_5                 3.429509e-02 1 1  ON 45
eH2_6                 7.897769e-02 1 1  ON 46
eH2_7                 1.129391e-01 1 1  ON 47
eH2_8                 9.508273e-02 1 1  ON 48
eH2_9                 2.689142e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2351
    reference variance = 0.322534
====================================================
  Execution time = 1.9745e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2102e-01
  Total weights = 2.0000e+06
  Execution time = 1.8099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321018199788
                                         uncertainty =       0.004476494012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321018199788
                                         uncertainty =       0.004476494012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400634787
  error estimate for blocks of size 2^( 2) =       0.000410312965
  error estimate for blocks of size 2^( 3) =       0.000418858559
  error estimate for blocks of size 2^( 4) =       0.000425229514
  error estimate for blocks of size 2^( 5) =       0.000429804199
  error estimate for blocks of size 2^( 6) =       0.000433235780
  error estimate for blocks of size 2^( 7) =       0.000434897530

      target function =                  N/A
              le_mean =     -17.216710643116
             les_mean =     296.736141672691
             stat err =       0.000430791756
             autocorr =       1.156211954702
              std dev =       0.566583148728
             le_variance =       0.321016464423

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321036755426
                                         uncertainty =       0.004476871390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321036755426
                                         uncertainty =       0.004476871390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400646368
  error estimate for blocks of size 2^( 2) =       0.000410323852
  error estimate for blocks of size 2^( 3) =       0.000418868777
  error estimate for blocks of size 2^( 4) =       0.000425239226
  error estimate for blocks of size 2^( 5) =       0.000429813698
  error estimate for blocks of size 2^( 6) =       0.000433245148
  error estimate for blocks of size 2^( 7) =       0.000434906876

      target function =                  N/A
              le_mean =     -17.216710623515
             les_mean =     296.736159557640
             stat err =       0.000430801237
             autocorr =       1.156196003064
              std dev =       0.566599527277
             le_variance =       0.321035024311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321027561277
                                         uncertainty =       0.004476683921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321027561277
                                         uncertainty =       0.004476683921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400640630
  error estimate for blocks of size 2^( 2) =       0.000410318457
  error estimate for blocks of size 2^( 3) =       0.000418863711
  error estimate for blocks of size 2^( 4) =       0.000425234411
  error estimate for blocks of size 2^( 5) =       0.000429808990
  error estimate for blocks of size 2^( 6) =       0.000433240507
  error estimate for blocks of size 2^( 7) =       0.000434902248

      target function =                  N/A
              le_mean =     -17.216710633113
             les_mean =     296.736150691935
             stat err =       0.000430796539
             autocorr =       1.156203904050
              std dev =       0.566591411941
             le_variance =       0.321025828086

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321019372441
                                         uncertainty =       0.004476517788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321019372441
                                         uncertainty =       0.004476517788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400635518
  error estimate for blocks of size 2^( 2) =       0.000410313653
  error estimate for blocks of size 2^( 3) =       0.000418859204
  error estimate for blocks of size 2^( 4) =       0.000425230127
  error estimate for blocks of size 2^( 5) =       0.000429804799
  error estimate for blocks of size 2^( 6) =       0.000433236372
  error estimate for blocks of size 2^( 7) =       0.000434898121

      target function =                  N/A
              le_mean =     -17.216710641838
             les_mean =     296.736142801603
             stat err =       0.000430792355
             autocorr =       1.156210945947
              std dev =       0.566584183814
             le_variance =       0.321017637349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216710643116        initial  <--
     1.5259e+01     1.5259e+02             4.4743e-05       -17.216710623515
     6.1035e+01     6.1035e+02             1.1218e-05       -17.216710633113
     2.4414e+02     2.4414e+03             2.8066e-06       -17.216710641838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9194
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 2.100505e-01 1 1  ON 0
 uu_1                 4.820854e-02 1 1  ON 1
 uu_2                -4.606313e-02 1 1  ON 2
 uu_3                -1.002733e-01 1 1  ON 3
 uu_4                -1.325331e-01 1 1  ON 4
 uu_5                -1.381541e-01 1 1  ON 5
 uu_6                -1.144809e-01 1 1  ON 6
 uu_7                -4.094526e-02 1 1  ON 7
 uu_8                 9.776332e-02 1 1  ON 8
 uu_9                 1.219074e-01 1 1  ON 9
 ud_0                 3.514212e-01 1 1  ON 10
 ud_1                 9.312089e-02 1 1  ON 11
 ud_2                -1.604980e-02 1 1  ON 12
 ud_3                -7.626495e-02 1 1  ON 13
 ud_4                -1.227742e-01 1 1  ON 14
 ud_5                -1.533192e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.681363e-03 1 1  ON 18
 ud_9                 9.256647e-02 1 1  ON 19
 eO_0                -7.629612e-01 1 1  ON 20
 eO_1                -4.445685e-01 1 1  ON 21
 eO_2                -3.902406e-02 1 1  ON 22
 eO_3                 2.113726e-01 1 1  ON 23
 eO_4                 2.990388e-01 1 1  ON 24
 eO_5                 3.107354e-01 1 1  ON 25
 eO_6                 2.526624e-01 1 1  ON 26
 eO_7                 1.150683e-01 1 1  ON 27
 eO_8                 2.822394e-02 1 1  ON 28
 eO_9                 1.860302e-02 1 1  ON 29
eH1_0                -1.828546e-01 1 1  ON 30
eH1_1                -1.035491e-01 1 1  ON 31
eH1_2                -6.256684e-02 1 1  ON 32
eH1_3                -2.592171e-02 1 1  ON 33
eH1_4                 1.969694e-02 1 1  ON 34
eH1_5                 3.542769e-02 1 1  ON 35
eH1_6                 7.789529e-02 1 1  ON 36
eH1_7                 1.094609e-01 1 1  ON 37
eH1_8                 9.213747e-02 1 1  ON 38
eH1_9                 2.473164e-02 1 1  ON 39
eH2_0                -1.836431e-01 1 1  ON 40
eH2_1                -1.045888e-01 1 1  ON 41
eH2_2                -6.373186e-02 1 1  ON 42
eH2_3                -2.692706e-02 1 1  ON 43
eH2_4                 1.838422e-02 1 1  ON 44
eH2_5                 3.429359e-02 1 1  ON 45
eH2_6                 7.897743e-02 1 1  ON 46
eH2_7                 1.129395e-01 1 1  ON 47
eH2_8                 9.508154e-02 1 1  ON 48
eH2_9                 2.689101e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4725e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.267533
====================================================
  Execution time = 2.0076e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1531e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315323784354
                                         uncertainty =       0.002665717582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315323784354
                                         uncertainty =       0.002665717582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397056902
  error estimate for blocks of size 2^( 2) =       0.000406669008
  error estimate for blocks of size 2^( 3) =       0.000415993382
  error estimate for blocks of size 2^( 4) =       0.000422576531
  error estimate for blocks of size 2^( 5) =       0.000426958747
  error estimate for blocks of size 2^( 6) =       0.000428890678
  error estimate for blocks of size 2^( 7) =       0.000429220895

      target function =                  N/A
              le_mean =     -17.216397280826
             les_mean =     296.719643539778
             stat err =       0.000426911713
             autocorr =       1.156034092505
              std dev =       0.561523255261
             le_variance =       0.315308366198


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721639728083e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216397280826       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216397280694       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216397283403       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216397291065       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216397288547       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216397289731       residual = 3.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216397290181       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 4.548231e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216397280826       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216397280793       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216397281470       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216397283386       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216397282757       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216397283051       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216397283164       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 1.137471e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216397280826       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216397280818       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216397280987       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216397281466       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216397281308       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216397281382       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216397281411       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.843936e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229161 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5670e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.100507e-01 1 1  ON 0
 uu_1                 4.820865e-02 1 1  ON 1
 uu_2                -4.606312e-02 1 1  ON 2
 uu_3                -1.002733e-01 1 1  ON 3
 uu_4                -1.325331e-01 1 1  ON 4
 uu_5                -1.381542e-01 1 1  ON 5
 uu_6                -1.144811e-01 1 1  ON 6
 uu_7                -4.094538e-02 1 1  ON 7
 uu_8                 9.776322e-02 1 1  ON 8
 uu_9                 1.219075e-01 1 1  ON 9
 ud_0                 3.514215e-01 1 1  ON 10
 ud_1                 9.312106e-02 1 1  ON 11
 ud_2                -1.604979e-02 1 1  ON 12
 ud_3                -7.626508e-02 1 1  ON 13
 ud_4                -1.227744e-01 1 1  ON 14
 ud_5                -1.533193e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.681210e-03 1 1  ON 18
 ud_9                 9.256646e-02 1 1  ON 19
 eO_0                -7.629623e-01 1 1  ON 20
 eO_1                -4.445690e-01 1 1  ON 21
 eO_2                -3.902422e-02 1 1  ON 22
 eO_3                 2.113731e-01 1 1  ON 23
 eO_4                 2.990396e-01 1 1  ON 24
 eO_5                 3.107357e-01 1 1  ON 25
 eO_6                 2.526626e-01 1 1  ON 26
 eO_7                 1.150686e-01 1 1  ON 27
 eO_8                 2.822398e-02 1 1  ON 28
 eO_9                 1.860302e-02 1 1  ON 29
eH1_0                -1.828546e-01 1 1  ON 30
eH1_1                -1.035492e-01 1 1  ON 31
eH1_2                -6.256670e-02 1 1  ON 32
eH1_3                -2.592167e-02 1 1  ON 33
eH1_4                 1.969693e-02 1 1  ON 34
eH1_5                 3.542767e-02 1 1  ON 35
eH1_6                 7.789523e-02 1 1  ON 36
eH1_7                 1.094609e-01 1 1  ON 37
eH1_8                 9.213756e-02 1 1  ON 38
eH1_9                 2.473167e-02 1 1  ON 39
eH2_0                -1.836430e-01 1 1  ON 40
eH2_1                -1.045889e-01 1 1  ON 41
eH2_2                -6.373189e-02 1 1  ON 42
eH2_3                -2.692699e-02 1 1  ON 43
eH2_4                 1.838411e-02 1 1  ON 44
eH2_5                 3.429341e-02 1 1  ON 45
eH2_6                 7.897753e-02 1 1  ON 46
eH2_7                 1.129395e-01 1 1  ON 47
eH2_8                 9.508164e-02 1 1  ON 48
eH2_9                 2.689105e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.192998
====================================================
  Execution time = 2.0085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1314e-01
  Total weights = 2.0000e+06
  Execution time = 1.8078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313101306715
                                         uncertainty =       0.002955668175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313101306715
                                         uncertainty =       0.002955668175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395689857
  error estimate for blocks of size 2^( 2) =       0.000405672234
  error estimate for blocks of size 2^( 3) =       0.000414880913
  error estimate for blocks of size 2^( 4) =       0.000421286029
  error estimate for blocks of size 2^( 5) =       0.000425319121
  error estimate for blocks of size 2^( 6) =       0.000426263122
  error estimate for blocks of size 2^( 7) =       0.000427000689

      target function =                  N/A
              le_mean =     -17.217459923449
             les_mean =     296.754066985319
             stat err =       0.000424967240
             autocorr =       1.153456097417
              std dev =       0.559589962675
             le_variance =       0.313140926327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313102271237
                                         uncertainty =       0.002955681079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313102271237
                                         uncertainty =       0.002955681079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395690467
  error estimate for blocks of size 2^( 2) =       0.000405672811
  error estimate for blocks of size 2^( 3) =       0.000414881454
  error estimate for blocks of size 2^( 4) =       0.000421286546
  error estimate for blocks of size 2^( 5) =       0.000425319624
  error estimate for blocks of size 2^( 6) =       0.000426263623
  error estimate for blocks of size 2^( 7) =       0.000427001194

      target function =                  N/A
              le_mean =     -17.217459924344
             les_mean =     296.754067980695
             stat err =       0.000424967747
             autocorr =       1.153455294086
              std dev =       0.559590824504
             le_variance =       0.313141890869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313101789303
                                         uncertainty =       0.002955674632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313101789303
                                         uncertainty =       0.002955674632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395690162
  error estimate for blocks of size 2^( 2) =       0.000405672523
  error estimate for blocks of size 2^( 3) =       0.000414881184
  error estimate for blocks of size 2^( 4) =       0.000421286288
  error estimate for blocks of size 2^( 5) =       0.000425319373
  error estimate for blocks of size 2^( 6) =       0.000426263373
  error estimate for blocks of size 2^( 7) =       0.000427000942

      target function =                  N/A
              le_mean =     -17.217459923898
             les_mean =     296.754067483394
             stat err =       0.000424967494
             autocorr =       1.153455695489
              std dev =       0.559590393882
             le_variance =       0.313141408924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313101367048
                                         uncertainty =       0.002955668982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313101367048
                                         uncertainty =       0.002955668982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395689895
  error estimate for blocks of size 2^( 2) =       0.000405672270
  error estimate for blocks of size 2^( 3) =       0.000414880947
  error estimate for blocks of size 2^( 4) =       0.000421286062
  error estimate for blocks of size 2^( 5) =       0.000425319152
  error estimate for blocks of size 2^( 6) =       0.000426263154
  error estimate for blocks of size 2^( 7) =       0.000427000721

      target function =                  N/A
              le_mean =     -17.217459923505
             les_mean =     296.754067047587
             stat err =       0.000424967272
             autocorr =       1.153456047165
              std dev =       0.559590016585
             le_variance =       0.313140986661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217459923449        initial
     1.5259e+02     1.5259e+03             4.5482e-06       -17.217459924344  <--
     6.1035e+02     6.1035e+03             1.1375e-06       -17.217459923898
     2.4414e+03     2.4414e+04             2.8439e-07       -17.217459923505

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.9233e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2932
    reference variance = 0.2545
====================================================
  Execution time = 2.2530e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0994e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309892208764
                                         uncertainty =       0.002971643576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309892208764
                                         uncertainty =       0.002971643576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393663094
  error estimate for blocks of size 2^( 2) =       0.000403872455
  error estimate for blocks of size 2^( 3) =       0.000412546910
  error estimate for blocks of size 2^( 4) =       0.000419586665
  error estimate for blocks of size 2^( 5) =       0.000422983793
  error estimate for blocks of size 2^( 6) =       0.000424490687
  error estimate for blocks of size 2^( 7) =       0.000423721482

      target function =                  N/A
              le_mean =     -17.216486249889
             les_mean =     296.717339900883
             stat err =       0.000422695657
             autocorr =       1.152938568526
              std dev =       0.556723686616
             le_variance =       0.309941263239


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721648624989e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216486249889       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486254513       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216486279430       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216486281948       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216486292978       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216486300126       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216486297568       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216486298067       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.882745e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216486249889       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486251048       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216486257314       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216486257945       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216486260713       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216486262494       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216486261841       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216486261958       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 4.714953e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216486249889       residual = 7.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216486250179       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216486251748       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216486251905       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216486252598       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216486253043       residual = 8.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216486252879       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216486252907       residual = 2.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 1.179248e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.231962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8131e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.100515e-01 1 1  ON 0
 uu_1                 4.821022e-02 1 1  ON 1
 uu_2                -4.606216e-02 1 1  ON 2
 uu_3                -1.002728e-01 1 1  ON 3
 uu_4                -1.325332e-01 1 1  ON 4
 uu_5                -1.381554e-01 1 1  ON 5
 uu_6                -1.144827e-01 1 1  ON 6
 uu_7                -4.094656e-02 1 1  ON 7
 uu_8                 9.776235e-02 1 1  ON 8
 uu_9                 1.219081e-01 1 1  ON 9
 ud_0                 3.514241e-01 1 1  ON 10
 ud_1                 9.312232e-02 1 1  ON 11
 ud_2                -1.604999e-02 1 1  ON 12
 ud_3                -7.626556e-02 1 1  ON 13
 ud_4                -1.227749e-01 1 1  ON 14
 ud_5                -1.533205e-01 1 1  ON 15
 ud_6                -1.546718e-01 1 1  ON 16
 ud_7                -1.101609e-01 1 1  ON 17
 ud_8                 1.679827e-03 1 1  ON 18
 ud_9                 9.256639e-02 1 1  ON 19
 eO_0                -7.629704e-01 1 1  ON 20
 eO_1                -4.445730e-01 1 1  ON 21
 eO_2                -3.902512e-02 1 1  ON 22
 eO_3                 2.113762e-01 1 1  ON 23
 eO_4                 2.990446e-01 1 1  ON 24
 eO_5                 3.107378e-01 1 1  ON 25
 eO_6                 2.526636e-01 1 1  ON 26
 eO_7                 1.150700e-01 1 1  ON 27
 eO_8                 2.822417e-02 1 1  ON 28
 eO_9                 1.860306e-02 1 1  ON 29
eH1_0                -1.828544e-01 1 1  ON 30
eH1_1                -1.035500e-01 1 1  ON 31
eH1_2                -6.256659e-02 1 1  ON 32
eH1_3                -2.592185e-02 1 1  ON 33
eH1_4                 1.969647e-02 1 1  ON 34
eH1_5                 3.542772e-02 1 1  ON 35
eH1_6                 7.789550e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213820e-02 1 1  ON 38
eH1_9                 2.473184e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045897e-01 1 1  ON 41
eH2_2                -6.373131e-02 1 1  ON 42
eH2_3                -2.692652e-02 1 1  ON 43
eH2_4                 1.838369e-02 1 1  ON 44
eH2_5                 3.429234e-02 1 1  ON 45
eH2_6                 7.897757e-02 1 1  ON 46
eH2_7                 1.129395e-01 1 1  ON 47
eH2_8                 9.508237e-02 1 1  ON 48
eH2_9                 2.689129e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1976
    reference variance = 0.426836
====================================================
  Execution time = 1.9780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2142e-01
  Total weights = 2.0000e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321470160928
                                         uncertainty =       0.005006294245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321470160928
                                         uncertainty =       0.005006294245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400888697
  error estimate for blocks of size 2^( 2) =       0.000410034112
  error estimate for blocks of size 2^( 3) =       0.000419011580
  error estimate for blocks of size 2^( 4) =       0.000425470030
  error estimate for blocks of size 2^( 5) =       0.000429162691
  error estimate for blocks of size 2^( 6) =       0.000430569057
  error estimate for blocks of size 2^( 7) =       0.000434192977

      target function =                  N/A
              le_mean =     -17.217159452084
             les_mean =     296.752002933212
             stat err =       0.000429848689
             autocorr =       1.149697503317
              std dev =       0.566942232905
             le_variance =       0.321423495451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321476068288
                                         uncertainty =       0.005006415944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321476068288
                                         uncertainty =       0.005006415944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400892382
  error estimate for blocks of size 2^( 2) =       0.000410037565
  error estimate for blocks of size 2^( 3) =       0.000419014779
  error estimate for blocks of size 2^( 4) =       0.000425473098
  error estimate for blocks of size 2^( 5) =       0.000429165807
  error estimate for blocks of size 2^( 6) =       0.000430572212
  error estimate for blocks of size 2^( 7) =       0.000434196147

      target function =                  N/A
              le_mean =     -17.217159414715
             les_mean =     296.752007554219
             stat err =       0.000429851816
             autocorr =       1.149693101011
              std dev =       0.566947443096
             le_variance =       0.321429403233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321473126835
                                         uncertainty =       0.005006355475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321473126835
                                         uncertainty =       0.005006355475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400890547
  error estimate for blocks of size 2^( 2) =       0.000410035846
  error estimate for blocks of size 2^( 3) =       0.000419013186
  error estimate for blocks of size 2^( 4) =       0.000425471570
  error estimate for blocks of size 2^( 5) =       0.000429164255
  error estimate for blocks of size 2^( 6) =       0.000430570641
  error estimate for blocks of size 2^( 7) =       0.000434194568

      target function =                  N/A
              le_mean =     -17.217159433342
             les_mean =     296.752005253983
             stat err =       0.000429850259
             autocorr =       1.149695292676
              std dev =       0.566944848792
             le_variance =       0.321426461572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321470532032
                                         uncertainty =       0.005006301911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321470532032
                                         uncertainty =       0.005006301911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400888929
  error estimate for blocks of size 2^( 2) =       0.000410034329
  error estimate for blocks of size 2^( 3) =       0.000419011781
  error estimate for blocks of size 2^( 4) =       0.000425470222
  error estimate for blocks of size 2^( 5) =       0.000429162887
  error estimate for blocks of size 2^( 6) =       0.000430569255
  error estimate for blocks of size 2^( 7) =       0.000434193176

      target function =                  N/A
              le_mean =     -17.217159449737
             les_mean =     296.752003223525
             stat err =       0.000429848885
             autocorr =       1.149697226689
              std dev =       0.566942560214
             le_variance =       0.321423866582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217159452084        initial  <--
     3.8147e+01     3.8147e+02             1.8827e-05       -17.217159414715
     1.5259e+02     1.5259e+03             4.7150e-06       -17.217159433342
     6.1035e+02     6.1035e+03             1.1792e-06       -17.217159449737

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9794
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1871
    reference variance = 0.403525
====================================================
  Execution time = 2.0235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1510e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315073895855
                                         uncertainty =       0.003105086395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315073895855
                                         uncertainty =       0.003105086395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396923346
  error estimate for blocks of size 2^( 2) =       0.000406830197
  error estimate for blocks of size 2^( 3) =       0.000415886518
  error estimate for blocks of size 2^( 4) =       0.000422542724
  error estimate for blocks of size 2^( 5) =       0.000426595512
  error estimate for blocks of size 2^( 6) =       0.000428523165
  error estimate for blocks of size 2^( 7) =       0.000429707382

      target function =                  N/A
              le_mean =     -17.216940519184
             les_mean =     296.738136969449
             stat err =       0.000426842196
             autocorr =       1.156435465570
              std dev =       0.561334379735
             le_variance =       0.315096285872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721694051918e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940519184       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940521624       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216940524165       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216940527814       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216940526441       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216940526818       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216940525515       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.891593e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940519184       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940519794       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216940520430       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216940521343       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216940521000       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216940521094       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216940520768       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 4.729822e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216940519184       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216940519337       residual = 9.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216940519496       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216940519724       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216940519637       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216940519666       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216940519579       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 1.182508e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234257 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5757e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.100514e-01 1 1  ON 0
 uu_1                 4.820904e-02 1 1  ON 1
 uu_2                -4.606305e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094583e-02 1 1  ON 7
 uu_8                 9.776286e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514224e-01 1 1  ON 10
 ud_1                 9.312164e-02 1 1  ON 11
 ud_2                -1.604978e-02 1 1  ON 12
 ud_3                -7.626557e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533196e-01 1 1  ON 15
 ud_6                -1.546716e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680654e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629662e-01 1 1  ON 20
 eO_1                -4.445710e-01 1 1  ON 21
 eO_2                -3.902472e-02 1 1  ON 22
 eO_3                 2.113746e-01 1 1  ON 23
 eO_4                 2.990420e-01 1 1  ON 24
 eO_5                 3.107367e-01 1 1  ON 25
 eO_6                 2.526630e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256631e-02 1 1  ON 32
eH1_3                -2.592157e-02 1 1  ON 33
eH1_4                 1.969695e-02 1 1  ON 34
eH1_5                 3.542756e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213791e-02 1 1  ON 38
eH1_9                 2.473180e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373201e-02 1 1  ON 42
eH2_3                -2.692674e-02 1 1  ON 43
eH2_4                 1.838384e-02 1 1  ON 44
eH2_5                 3.429282e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508197e-02 1 1  ON 48
eH2_9                 2.689117e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2101
    reference variance = 0.135814
====================================================
  Execution time = 1.9860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1287e-01
  Total weights = 2.0000e+06
  Execution time = 1.8150e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859384696
                                         uncertainty =       0.003032160690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859384696
                                         uncertainty =       0.003032160690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395517608
  error estimate for blocks of size 2^( 2) =       0.000405101116
  error estimate for blocks of size 2^( 3) =       0.000413478885
  error estimate for blocks of size 2^( 4) =       0.000419912521
  error estimate for blocks of size 2^( 5) =       0.000424649107
  error estimate for blocks of size 2^( 6) =       0.000425725740
  error estimate for blocks of size 2^( 7) =       0.000427319140

      target function =                  N/A
              le_mean =     -17.216673089241
             les_mean =     296.726700461702
             stat err =       0.000424401627
             autocorr =       1.151389951740
              std dev =       0.559346365273
             le_variance =       0.312868356344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859915544
                                         uncertainty =       0.003032165584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859915544
                                         uncertainty =       0.003032165584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395517943
  error estimate for blocks of size 2^( 2) =       0.000405101432
  error estimate for blocks of size 2^( 3) =       0.000413479181
  error estimate for blocks of size 2^( 4) =       0.000419912798
  error estimate for blocks of size 2^( 5) =       0.000424649381
  error estimate for blocks of size 2^( 6) =       0.000425726014
  error estimate for blocks of size 2^( 7) =       0.000427319431

      target function =                  N/A
              le_mean =     -17.216673086028
             les_mean =     296.726700881795
             stat err =       0.000424401906
             autocorr =       1.151389514180
              std dev =       0.559346839702
             le_variance =       0.312868887085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859650134
                                         uncertainty =       0.003032163137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859650134
                                         uncertainty =       0.003032163137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395517776
  error estimate for blocks of size 2^( 2) =       0.000405101274
  error estimate for blocks of size 2^( 3) =       0.000413479033
  error estimate for blocks of size 2^( 4) =       0.000419912660
  error estimate for blocks of size 2^( 5) =       0.000424649244
  error estimate for blocks of size 2^( 6) =       0.000425725877
  error estimate for blocks of size 2^( 7) =       0.000427319286

      target function =                  N/A
              le_mean =     -17.216673087634
             les_mean =     296.726700671749
             stat err =       0.000424401766
             autocorr =       1.151389732940
              std dev =       0.559346602500
             le_variance =       0.312868621728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859417876
                                         uncertainty =       0.003032160996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312859417876
                                         uncertainty =       0.003032160996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395517629
  error estimate for blocks of size 2^( 2) =       0.000405101135
  error estimate for blocks of size 2^( 3) =       0.000413478904
  error estimate for blocks of size 2^( 4) =       0.000419912538
  error estimate for blocks of size 2^( 5) =       0.000424649124
  error estimate for blocks of size 2^( 6) =       0.000425725757
  error estimate for blocks of size 2^( 7) =       0.000427319159

      target function =                  N/A
              le_mean =     -17.216673089040
             les_mean =     296.726700487957
             stat err =       0.000424401644
             autocorr =       1.151389924403
              std dev =       0.559346394926
             le_variance =       0.312868389517


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216673089241        initial  <--
     3.8147e+02     3.8147e+03             1.8916e-06       -17.216673086028
     1.5259e+03     1.5259e+04             4.7298e-07       -17.216673087634
     6.1035e+03     6.1035e+04             1.1825e-07       -17.216673089040

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0350
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1282
    reference variance = 0.146009
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2509e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5177e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325238187497
                                         uncertainty =       0.006249604200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325238187497
                                         uncertainty =       0.006249604200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403169852
  error estimate for blocks of size 2^( 2) =       0.000412455127
  error estimate for blocks of size 2^( 3) =       0.000421010551
  error estimate for blocks of size 2^( 4) =       0.000427304311
  error estimate for blocks of size 2^( 5) =       0.000430697109
  error estimate for blocks of size 2^( 6) =       0.000433372559
  error estimate for blocks of size 2^( 7) =       0.000434384637

      target function =                  N/A
              le_mean =     -17.217318622078
             les_mean =     296.761152230138
             stat err =       0.000431439654
             autocorr =       1.145154332926
              std dev =       0.570168272130
             le_variance =       0.325091858544


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731862208e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217318622078       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217318622359       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217318622452       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217318622496       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217318622457       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217318622645       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217318622563       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.911303e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217318622078       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217318622148       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217318622171       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217318622184       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217318622169       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217318622215       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217318622198       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 4.778339e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217318622078       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217318622095       residual = 7.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217318622101       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217318622124       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217318622101       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217318622113       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217318622099       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 1.194590e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.236598 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5776e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256630e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1536
    reference variance = 0.196075
====================================================
  Execution time = 1.9739e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1803e-01
  Total weights = 2.0000e+06
  Execution time = 1.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103843714
                                         uncertainty =       0.003626112507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103843714
                                         uncertainty =       0.003626112507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398765126
  error estimate for blocks of size 2^( 2) =       0.000408565887
  error estimate for blocks of size 2^( 3) =       0.000417529568
  error estimate for blocks of size 2^( 4) =       0.000424301027
  error estimate for blocks of size 2^( 5) =       0.000429260904
  error estimate for blocks of size 2^( 6) =       0.000430925551
  error estimate for blocks of size 2^( 7) =       0.000431748363

      target function =                  N/A
              le_mean =     -17.215659575721
             les_mean =     296.696961720329
             stat err =       0.000429058961
             autocorr =       1.157709541174
              std dev =       0.563939050092
             le_variance =       0.318027252219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103917522
                                         uncertainty =       0.003626113148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103917522
                                         uncertainty =       0.003626113148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398765173
  error estimate for blocks of size 2^( 2) =       0.000408565932
  error estimate for blocks of size 2^( 3) =       0.000417529610
  error estimate for blocks of size 2^( 4) =       0.000424301067
  error estimate for blocks of size 2^( 5) =       0.000429260943
  error estimate for blocks of size 2^( 6) =       0.000430925589
  error estimate for blocks of size 2^( 7) =       0.000431748400

      target function =                  N/A
              le_mean =     -17.215659575698
             les_mean =     296.696961793336
             stat err =       0.000429059000
             autocorr =       1.157709480810
              std dev =       0.563939115519
             le_variance =       0.318027326012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103880620
                                         uncertainty =       0.003626112828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103880620
                                         uncertainty =       0.003626112828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398765150
  error estimate for blocks of size 2^( 2) =       0.000408565909
  error estimate for blocks of size 2^( 3) =       0.000417529589
  error estimate for blocks of size 2^( 4) =       0.000424301047
  error estimate for blocks of size 2^( 5) =       0.000429260924
  error estimate for blocks of size 2^( 6) =       0.000430925570
  error estimate for blocks of size 2^( 7) =       0.000431748381

      target function =                  N/A
              le_mean =     -17.215659575710
             les_mean =     296.696961756834
             stat err =       0.000429058980
             autocorr =       1.157709510992
              std dev =       0.563939082807
             le_variance =       0.318027289117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103848327
                                         uncertainty =       0.003626112547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318103848327
                                         uncertainty =       0.003626112547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398765129
  error estimate for blocks of size 2^( 2) =       0.000408565890
  error estimate for blocks of size 2^( 3) =       0.000417529570
  error estimate for blocks of size 2^( 4) =       0.000424301029
  error estimate for blocks of size 2^( 5) =       0.000429260907
  error estimate for blocks of size 2^( 6) =       0.000430925553
  error estimate for blocks of size 2^( 7) =       0.000431748365

      target function =                  N/A
              le_mean =     -17.215659575720
             les_mean =     296.696961724892
             stat err =       0.000429058964
             autocorr =       1.157709537412
              std dev =       0.563939054182
             le_variance =       0.318027256831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215659575721        initial  <--
     3.8147e+03     3.8147e+04             1.9113e-07       -17.215659575698
     1.5259e+04     1.5259e+05             4.7783e-08       -17.215659575710
     6.1035e+04     6.1035e+05             1.1946e-08       -17.215659575720

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9384
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4720e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1723
    reference variance = 0.186565
====================================================
  Execution time = 2.0204e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2573e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325675457403
                                         uncertainty =       0.006616775607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325675457403
                                         uncertainty =       0.006616775607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403563030
  error estimate for blocks of size 2^( 2) =       0.000413091338
  error estimate for blocks of size 2^( 3) =       0.000421716014
  error estimate for blocks of size 2^( 4) =       0.000427853478
  error estimate for blocks of size 2^( 5) =       0.000432087766
  error estimate for blocks of size 2^( 6) =       0.000434197239
  error estimate for blocks of size 2^( 7) =       0.000434079567

      target function =                  N/A
              le_mean =     -17.216768377019
             les_mean =     296.742839423845
             stat err =       0.000432054513
             autocorr =       1.146184001094
              std dev =       0.570724310682
             le_variance =       0.325726238804


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721676837702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768377019       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768377021       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768377065       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768377044       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768377066       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768377066       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768377069       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.953699e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768377019       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768377019       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768377030       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768377056       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768376981       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768377043       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768377180       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 4.884256e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216768377019       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216768377019       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216768377021       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216768377020       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216768376983       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216768376968       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216768376936       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 1.221065e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.238868 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5869e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.24
    reference variance = 0.163744
====================================================
  Execution time = 1.9730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2500e-01
  Total weights = 2.0000e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119150434
                                         uncertainty =       0.007779046125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119150434
                                         uncertainty =       0.007779046125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403111791
  error estimate for blocks of size 2^( 2) =       0.000412489847
  error estimate for blocks of size 2^( 3) =       0.000421647716
  error estimate for blocks of size 2^( 4) =       0.000427533928
  error estimate for blocks of size 2^( 5) =       0.000431535133
  error estimate for blocks of size 2^( 6) =       0.000435072972
  error estimate for blocks of size 2^( 7) =       0.000437372063

      target function =                  N/A
              le_mean =     -17.216197303773
             les_mean =     296.722447671705
             stat err =       0.000432878524
             autocorr =       1.153137452493
              std dev =       0.570086161709
             le_variance =       0.324998231773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119158125
                                         uncertainty =       0.007779046119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119158125
                                         uncertainty =       0.007779046119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403111796
  error estimate for blocks of size 2^( 2) =       0.000412489852
  error estimate for blocks of size 2^( 3) =       0.000421647720
  error estimate for blocks of size 2^( 4) =       0.000427533932
  error estimate for blocks of size 2^( 5) =       0.000431535137
  error estimate for blocks of size 2^( 6) =       0.000435072976
  error estimate for blocks of size 2^( 7) =       0.000437372067

      target function =                  N/A
              le_mean =     -17.216197303720
             les_mean =     296.722447677569
             stat err =       0.000432878528
             autocorr =       1.153137447004
              std dev =       0.570086168453
             le_variance =       0.324998239461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119154279
                                         uncertainty =       0.007779046122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119154279
                                         uncertainty =       0.007779046122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403111793
  error estimate for blocks of size 2^( 2) =       0.000412489850
  error estimate for blocks of size 2^( 3) =       0.000421647718
  error estimate for blocks of size 2^( 4) =       0.000427533930
  error estimate for blocks of size 2^( 5) =       0.000431535135
  error estimate for blocks of size 2^( 6) =       0.000435072974
  error estimate for blocks of size 2^( 7) =       0.000437372065

      target function =                  N/A
              le_mean =     -17.216197303746
             les_mean =     296.722447674637
             stat err =       0.000432878526
             autocorr =       1.153137449745
              std dev =       0.570086165081
             le_variance =       0.324998235617

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119150914
                                         uncertainty =       0.007779046124

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325119150914
                                         uncertainty =       0.007779046124

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403111791
  error estimate for blocks of size 2^( 2) =       0.000412489848
  error estimate for blocks of size 2^( 3) =       0.000421647716
  error estimate for blocks of size 2^( 4) =       0.000427533928
  error estimate for blocks of size 2^( 5) =       0.000431535133
  error estimate for blocks of size 2^( 6) =       0.000435072973
  error estimate for blocks of size 2^( 7) =       0.000437372063

      target function =                  N/A
              le_mean =     -17.216197303769
             les_mean =     296.722447672071
             stat err =       0.000432878524
             autocorr =       1.153137452146
              std dev =       0.570086162131
             le_variance =       0.324998232253


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216197303773        initial  <--
     3.8147e+04     3.8147e+05             1.9537e-08       -17.216197303720
     1.5259e+05     1.5259e+06             4.8843e-09       -17.216197303746
     6.1035e+05     6.1035e+06             1.2211e-09       -17.216197303769

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9339
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2534
    reference variance = 0.150103
====================================================
  Execution time = 1.9948e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1948e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319522746061
                                         uncertainty =       0.002585094559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319522746061
                                         uncertainty =       0.002585094559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399674474
  error estimate for blocks of size 2^( 2) =       0.000409235471
  error estimate for blocks of size 2^( 3) =       0.000417647583
  error estimate for blocks of size 2^( 4) =       0.000423358377
  error estimate for blocks of size 2^( 5) =       0.000427642642
  error estimate for blocks of size 2^( 6) =       0.000431030903
  error estimate for blocks of size 2^( 7) =       0.000433511568

      target function =                  N/A
              le_mean =     -17.216550612571
             les_mean =     296.729094206490
             stat err =       0.000428885873
             autocorr =       1.151517802718
              std dev =       0.565225062251
             le_variance =       0.319479370996


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721655061257e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216550612571       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216550612573       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216550612572       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216550612574       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216550612574       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216550612467       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216550612470       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.773489e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216550612571       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216550612572       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216550612572       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216550612818       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216550612494       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216550612691       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216550613167       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 4.433722e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216550612571       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216550612571       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216550612571       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216550612572       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216550647303       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216550680330       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216550605253       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 1.108387e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5564e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.3324
    reference variance = 0.705043
====================================================
  Execution time = 1.9671e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2257e-01
  Total weights = 2.0000e+06
  Execution time = 1.8127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156043
                                         uncertainty =       0.005460015881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156043
                                         uncertainty =       0.005460015881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401605714
  error estimate for blocks of size 2^( 2) =       0.000411358863
  error estimate for blocks of size 2^( 3) =       0.000420188116
  error estimate for blocks of size 2^( 4) =       0.000426761552
  error estimate for blocks of size 2^( 5) =       0.000430476318
  error estimate for blocks of size 2^( 6) =       0.000434590846
  error estimate for blocks of size 2^( 7) =       0.000436572774

      target function =                  N/A
              le_mean =     -17.216220415126
             les_mean =     296.720819520463
             stat err =       0.000432100373
             autocorr =       1.157629310531
              std dev =       0.567956247903
             le_variance =       0.322574299532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156411
                                         uncertainty =       0.005460015893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156411
                                         uncertainty =       0.005460015893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401605715
  error estimate for blocks of size 2^( 2) =       0.000411358863
  error estimate for blocks of size 2^( 3) =       0.000420188116
  error estimate for blocks of size 2^( 4) =       0.000426761553
  error estimate for blocks of size 2^( 5) =       0.000430476318
  error estimate for blocks of size 2^( 6) =       0.000434590846
  error estimate for blocks of size 2^( 7) =       0.000436572774

      target function =                  N/A
              le_mean =     -17.216220415123
             les_mean =     296.720819520694
             stat err =       0.000432100373
             autocorr =       1.157629310160
              std dev =       0.567956248227
             le_variance =       0.322574299900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156227
                                         uncertainty =       0.005460015887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156227
                                         uncertainty =       0.005460015887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401605714
  error estimate for blocks of size 2^( 2) =       0.000411358863
  error estimate for blocks of size 2^( 3) =       0.000420188116
  error estimate for blocks of size 2^( 4) =       0.000426761552
  error estimate for blocks of size 2^( 5) =       0.000430476318
  error estimate for blocks of size 2^( 6) =       0.000434590846
  error estimate for blocks of size 2^( 7) =       0.000436572774

      target function =                  N/A
              le_mean =     -17.216220415125
             les_mean =     296.720819520578
             stat err =       0.000432100373
             autocorr =       1.157629310349
              std dev =       0.567956248065
             le_variance =       0.322574299716

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156066
                                         uncertainty =       0.005460015882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322660156066
                                         uncertainty =       0.005460015882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401605714
  error estimate for blocks of size 2^( 2) =       0.000411358863
  error estimate for blocks of size 2^( 3) =       0.000420188116
  error estimate for blocks of size 2^( 4) =       0.000426761552
  error estimate for blocks of size 2^( 5) =       0.000430476318
  error estimate for blocks of size 2^( 6) =       0.000434590846
  error estimate for blocks of size 2^( 7) =       0.000436572774

      target function =                  N/A
              le_mean =     -17.216220415126
             les_mean =     296.720819520477
             stat err =       0.000432100373
             autocorr =       1.157629310505
              std dev =       0.567956247923
             le_variance =       0.322574299555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216220415126        initial  <--
     3.8147e+05     3.8147e+06             1.7735e-09       -17.216220415123
     1.5259e+06     1.5259e+07             4.4337e-10       -17.216220415125
     6.1035e+06     6.1035e+07             1.1084e-10       -17.216220415126

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8495
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2294
    reference variance = 0.222765
====================================================
  Execution time = 1.9882e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1336e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313454727644
                                         uncertainty =       0.003065811675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313454727644
                                         uncertainty =       0.003065811675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395829655
  error estimate for blocks of size 2^( 2) =       0.000405746654
  error estimate for blocks of size 2^( 3) =       0.000414101157
  error estimate for blocks of size 2^( 4) =       0.000420562709
  error estimate for blocks of size 2^( 5) =       0.000423507571
  error estimate for blocks of size 2^( 6) =       0.000425251611
  error estimate for blocks of size 2^( 7) =       0.000425630991

      target function =                  N/A
              le_mean =     -17.216099102410
             les_mean =     296.707430378301
             stat err =       0.000423738221
             autocorr =       1.145984179152
              std dev =       0.559787665987
             le_variance =       0.313362230991


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721609910241e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216099102410       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216099102410       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216099102410       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216099102410       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216099104252       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216099102299       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216099103905       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.759974e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216099102410       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216099102410       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216099102410       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216099108738       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216099107053       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216099104576       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216099102410       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 4.399926e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216099102410       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216099102410       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216099102410       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216099110666       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216099102410       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216099067315       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216099026513       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 1.099999e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5418e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2506
    reference variance = 0.2335
====================================================
  Execution time = 2.1659e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1413e-01
  Total weights = 2.0000e+06
  Execution time = 1.8167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290210
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290210
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396313776
  error estimate for blocks of size 2^( 2) =       0.000405790182
  error estimate for blocks of size 2^( 3) =       0.000414354365
  error estimate for blocks of size 2^( 4) =       0.000421123882
  error estimate for blocks of size 2^( 5) =       0.000424822045
  error estimate for blocks of size 2^( 6) =       0.000426487482
  error estimate for blocks of size 2^( 7) =       0.000426364892

      target function =                  N/A
              le_mean =     -17.215972180687
             les_mean =     296.703827187960
             stat err =       0.000424699575
             autocorr =       1.148379192257
              std dev =       0.560472317629
             le_variance =       0.314129218828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290310
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290310
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396313777
  error estimate for blocks of size 2^( 2) =       0.000405790182
  error estimate for blocks of size 2^( 3) =       0.000414354365
  error estimate for blocks of size 2^( 4) =       0.000421123882
  error estimate for blocks of size 2^( 5) =       0.000424822045
  error estimate for blocks of size 2^( 6) =       0.000426487482
  error estimate for blocks of size 2^( 7) =       0.000426364892

      target function =                  N/A
              le_mean =     -17.215972180687
             les_mean =     296.703827188063
             stat err =       0.000424699575
             autocorr =       1.148379192171
              std dev =       0.560472317717
             le_variance =       0.314129218928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290260
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290260
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396313776
  error estimate for blocks of size 2^( 2) =       0.000405790182
  error estimate for blocks of size 2^( 3) =       0.000414354365
  error estimate for blocks of size 2^( 4) =       0.000421123882
  error estimate for blocks of size 2^( 5) =       0.000424822045
  error estimate for blocks of size 2^( 6) =       0.000426487482
  error estimate for blocks of size 2^( 7) =       0.000426364892

      target function =                  N/A
              le_mean =     -17.215972180687
             les_mean =     296.703827188011
             stat err =       0.000424699575
             autocorr =       1.148379192207
              std dev =       0.560472317673
             le_variance =       0.314129218878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290216
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314177290216
                                         uncertainty =       0.003603403206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396313776
  error estimate for blocks of size 2^( 2) =       0.000405790182
  error estimate for blocks of size 2^( 3) =       0.000414354365
  error estimate for blocks of size 2^( 4) =       0.000421123882
  error estimate for blocks of size 2^( 5) =       0.000424822045
  error estimate for blocks of size 2^( 6) =       0.000426487482
  error estimate for blocks of size 2^( 7) =       0.000426364892

      target function =                  N/A
              le_mean =     -17.215972180687
             les_mean =     296.703827187966
             stat err =       0.000424699575
             autocorr =       1.148379192246
              std dev =       0.560472317634
             le_variance =       0.314129218834


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215972180687        initial
     3.8147e+06     3.8147e+07             1.7600e-10       -17.215972180687  <--
     1.5259e+07     1.5259e+08             4.3999e-11       -17.215972180687
     6.1035e+07     6.1035e+08             1.1000e-11       -17.215972180687

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 3.0851e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6275e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2754
    reference variance = 0.332278
====================================================
  Execution time = 2.0457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1151e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311591561390
                                         uncertainty =       0.002660813722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311591561390
                                         uncertainty =       0.002660813722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394658738
  error estimate for blocks of size 2^( 2) =       0.000404374392
  error estimate for blocks of size 2^( 3) =       0.000413363306
  error estimate for blocks of size 2^( 4) =       0.000419778289
  error estimate for blocks of size 2^( 5) =       0.000423506310
  error estimate for blocks of size 2^( 6) =       0.000425290714
  error estimate for blocks of size 2^( 7) =       0.000426325247

      target function =                  N/A
              le_mean =     -17.217040523123
             les_mean =     296.737995258787
             stat err =       0.000423725140
             autocorr =       1.152723156119
              std dev =       0.558131740443
             le_variance =       0.311511039690


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721704052312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217040523123       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217040523123       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040523122       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217040523123       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217040523123       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217040523124       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217040523122       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 7.598720e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217040523123       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217040523123       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040523123       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217040522114       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217040523684       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217040522907       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217040522489       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.899680e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217040523123       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217040523123       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217040523123       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217040524414       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217040521374       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217040525716       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217040522447       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 4.749195e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5999e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680750e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2117
    reference variance = 0.21311
====================================================
  Execution time = 1.9646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1469e-01
  Total weights = 2.0000e+06
  Execution time = 1.8191e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019006
                                         uncertainty =       0.003745224413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019006
                                         uncertainty =       0.003745224413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396664429
  error estimate for blocks of size 2^( 2) =       0.000406636407
  error estimate for blocks of size 2^( 3) =       0.000415631286
  error estimate for blocks of size 2^( 4) =       0.000422677413
  error estimate for blocks of size 2^( 5) =       0.000427239321
  error estimate for blocks of size 2^( 6) =       0.000430516706
  error estimate for blocks of size 2^( 7) =       0.000431700901

      target function =                  N/A
              le_mean =     -17.216282075968
             les_mean =     296.715053700195
             stat err =       0.000428033585
             autocorr =       1.164418723089
              std dev =       0.560968215011
             le_variance =       0.314685338253

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019134
                                         uncertainty =       0.003745224417

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019134
                                         uncertainty =       0.003745224417

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396664429
  error estimate for blocks of size 2^( 2) =       0.000406636407
  error estimate for blocks of size 2^( 3) =       0.000415631286
  error estimate for blocks of size 2^( 4) =       0.000422677413
  error estimate for blocks of size 2^( 5) =       0.000427239321
  error estimate for blocks of size 2^( 6) =       0.000430516706
  error estimate for blocks of size 2^( 7) =       0.000431700901

      target function =                  N/A
              le_mean =     -17.216282075968
             les_mean =     296.715053700324
             stat err =       0.000428033585
             autocorr =       1.164418722933
              std dev =       0.560968215126
             le_variance =       0.314685338381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019070
                                         uncertainty =       0.003745224415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019070
                                         uncertainty =       0.003745224415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396664429
  error estimate for blocks of size 2^( 2) =       0.000406636407
  error estimate for blocks of size 2^( 3) =       0.000415631286
  error estimate for blocks of size 2^( 4) =       0.000422677413
  error estimate for blocks of size 2^( 5) =       0.000427239321
  error estimate for blocks of size 2^( 6) =       0.000430516706
  error estimate for blocks of size 2^( 7) =       0.000431700901

      target function =                  N/A
              le_mean =     -17.216282075968
             les_mean =     296.715053700260
             stat err =       0.000428033585
             autocorr =       1.164418723015
              std dev =       0.560968215068
             le_variance =       0.314685338317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019014
                                         uncertainty =       0.003745224414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314590019014
                                         uncertainty =       0.003745224414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396664429
  error estimate for blocks of size 2^( 2) =       0.000406636407
  error estimate for blocks of size 2^( 3) =       0.000415631286
  error estimate for blocks of size 2^( 4) =       0.000422677413
  error estimate for blocks of size 2^( 5) =       0.000427239321
  error estimate for blocks of size 2^( 6) =       0.000430516706
  error estimate for blocks of size 2^( 7) =       0.000431700901

      target function =                  N/A
              le_mean =     -17.216282075968
             les_mean =     296.715053700203
             stat err =       0.000428033585
             autocorr =       1.164418723069
              std dev =       0.560968215018
             le_variance =       0.314685338261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216282075968        initial
     9.5367e+05     9.5367e+06             7.5987e-10       -17.216282075968  <--
     3.8147e+06     3.8147e+07             1.8997e-10       -17.216282075968
     1.5259e+07     1.5259e+08             4.7492e-11       -17.216282075968

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 2.8859e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4863e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2598
    reference variance = 0.412453
====================================================
  Execution time = 2.0100e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2670e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326734267801
                                         uncertainty =       0.007260489156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326734267801
                                         uncertainty =       0.007260489156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404164149
  error estimate for blocks of size 2^( 2) =       0.000413592718
  error estimate for blocks of size 2^( 3) =       0.000422503090
  error estimate for blocks of size 2^( 4) =       0.000429128824
  error estimate for blocks of size 2^( 5) =       0.000432674561
  error estimate for blocks of size 2^( 6) =       0.000435569879
  error estimate for blocks of size 2^( 7) =       0.000436107461

      target function =                  N/A
              le_mean =     -17.216990757572
             les_mean =     296.751467901351
             stat err =       0.000433370181
             autocorr =       1.149747508904
              std dev =       0.571574420683
             le_variance =       0.326697318379


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721699075757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216990757572       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216990757575       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216990757580       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216990757582       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216990757567       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216990757775       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216990757702       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 2.867886e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216990757572       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216990757573       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216990757574       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216990757473       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216990757234       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216990757299       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216990757387       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 7.169717e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216990757572       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216990757572       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216990757573       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216990758039       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216990754558       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216990757645       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216990757313       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.792430e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247997 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5588e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2891
    reference variance = 0.312861
====================================================
  Execution time = 1.9550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3128e-01
  Total weights = 2.0000e+06
  Execution time = 1.8072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294582751
                                         uncertainty =       0.008316165936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294582751
                                         uncertainty =       0.008316165936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406992042
  error estimate for blocks of size 2^( 2) =       0.000416447510
  error estimate for blocks of size 2^( 3) =       0.000424970267
  error estimate for blocks of size 2^( 4) =       0.000431673037
  error estimate for blocks of size 2^( 5) =       0.000436924987
  error estimate for blocks of size 2^( 6) =       0.000438017257
  error estimate for blocks of size 2^( 7) =       0.000439079498

      target function =                  N/A
              le_mean =     -17.216520731953
             les_mean =     296.739870992644
             stat err =       0.000436423695
             autocorr =       1.149859581054
              std dev =       0.575573665593
             le_variance =       0.331285044524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294583685
                                         uncertainty =       0.008316165990

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294583685
                                         uncertainty =       0.008316165990

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406992043
  error estimate for blocks of size 2^( 2) =       0.000416447511
  error estimate for blocks of size 2^( 3) =       0.000424970268
  error estimate for blocks of size 2^( 4) =       0.000431673037
  error estimate for blocks of size 2^( 5) =       0.000436924988
  error estimate for blocks of size 2^( 6) =       0.000438017257
  error estimate for blocks of size 2^( 7) =       0.000439079498

      target function =                  N/A
              le_mean =     -17.216520731949
             les_mean =     296.739870993429
             stat err =       0.000436423695
             autocorr =       1.149859580229
              std dev =       0.575573666404
             le_variance =       0.331285045458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294583218
                                         uncertainty =       0.008316165963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294583218
                                         uncertainty =       0.008316165963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406992042
  error estimate for blocks of size 2^( 2) =       0.000416447510
  error estimate for blocks of size 2^( 3) =       0.000424970268
  error estimate for blocks of size 2^( 4) =       0.000431673037
  error estimate for blocks of size 2^( 5) =       0.000436924988
  error estimate for blocks of size 2^( 6) =       0.000438017257
  error estimate for blocks of size 2^( 7) =       0.000439079498

      target function =                  N/A
              le_mean =     -17.216520731951
             les_mean =     296.739870993036
             stat err =       0.000436423695
             autocorr =       1.149859580631
              std dev =       0.575573665998
             le_variance =       0.331285044991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294582809
                                         uncertainty =       0.008316165940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331294582809
                                         uncertainty =       0.008316165940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406992042
  error estimate for blocks of size 2^( 2) =       0.000416447510
  error estimate for blocks of size 2^( 3) =       0.000424970267
  error estimate for blocks of size 2^( 4) =       0.000431673037
  error estimate for blocks of size 2^( 5) =       0.000436924987
  error estimate for blocks of size 2^( 6) =       0.000438017257
  error estimate for blocks of size 2^( 7) =       0.000439079498

      target function =                  N/A
              le_mean =     -17.216520731953
             les_mean =     296.739870992693
             stat err =       0.000436423695
             autocorr =       1.149859581004
              std dev =       0.575573665644
             le_variance =       0.331285044582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216520731953        initial  <--
     2.3842e+05     2.3842e+06             2.8679e-09       -17.216520731949
     9.5367e+05     9.5367e+06             7.1697e-10       -17.216520731951
     3.8147e+06     3.8147e+07             1.7924e-10       -17.216520731953

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.6965
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4290e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2158
    reference variance = 0.16335
====================================================
  Execution time = 2.0294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2205e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5537e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321992449188
                                         uncertainty =       0.008456814490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321992449188
                                         uncertainty =       0.008456814490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401276410
  error estimate for blocks of size 2^( 2) =       0.000411321683
  error estimate for blocks of size 2^( 3) =       0.000419617950
  error estimate for blocks of size 2^( 4) =       0.000425778706
  error estimate for blocks of size 2^( 5) =       0.000429800627
  error estimate for blocks of size 2^( 6) =       0.000431562193
  error estimate for blocks of size 2^( 7) =       0.000430252672

      target function =                  N/A
              le_mean =     -17.216705695654
             les_mean =     296.737000363467
             stat err =       0.000429348550
             autocorr =       1.144808228904
              std dev =       0.567490540651
             le_variance =       0.322045513729


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721670569565e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216705695654       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216705695654       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216705695655       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216705695706       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216705696421       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216705695802       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216705695589       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.828133e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216705695654       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216705695654       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216705695654       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216705695578       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216705684584       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216705701491       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216705695815       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 7.070333e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216705695654       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216705695654       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216705695654       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216705689348       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216705696859       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216705696847       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216705697941       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.767583e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.250260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5858e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2535
    reference variance = 0.19234
====================================================
  Execution time = 1.9924e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1503e-01
  Total weights = 2.0000e+06
  Execution time = 1.8214e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817846961
                                         uncertainty =       0.003450760943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817846961
                                         uncertainty =       0.003450760943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396883387
  error estimate for blocks of size 2^( 2) =       0.000406555390
  error estimate for blocks of size 2^( 3) =       0.000415674157
  error estimate for blocks of size 2^( 4) =       0.000422958223
  error estimate for blocks of size 2^( 5) =       0.000427520647
  error estimate for blocks of size 2^( 6) =       0.000429751381
  error estimate for blocks of size 2^( 7) =       0.000430510342

      target function =                  N/A
              le_mean =     -17.216319560495
             les_mean =     296.716691897148
             stat err =       0.000427685148
             autocorr =       1.161241366046
              std dev =       0.561277868413
             le_variance =       0.315032845570

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817847061
                                         uncertainty =       0.003450760944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817847061
                                         uncertainty =       0.003450760944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396883387
  error estimate for blocks of size 2^( 2) =       0.000406555390
  error estimate for blocks of size 2^( 3) =       0.000415674157
  error estimate for blocks of size 2^( 4) =       0.000422958223
  error estimate for blocks of size 2^( 5) =       0.000427520647
  error estimate for blocks of size 2^( 6) =       0.000429751381
  error estimate for blocks of size 2^( 7) =       0.000430510342

      target function =                  N/A
              le_mean =     -17.216319560496
             les_mean =     296.716691897256
             stat err =       0.000427685148
             autocorr =       1.161241365974
              std dev =       0.561277868501
             le_variance =       0.315032845669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817847011
                                         uncertainty =       0.003450760943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817847011
                                         uncertainty =       0.003450760943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396883387
  error estimate for blocks of size 2^( 2) =       0.000406555390
  error estimate for blocks of size 2^( 3) =       0.000415674157
  error estimate for blocks of size 2^( 4) =       0.000422958223
  error estimate for blocks of size 2^( 5) =       0.000427520647
  error estimate for blocks of size 2^( 6) =       0.000429751381
  error estimate for blocks of size 2^( 7) =       0.000430510342

      target function =                  N/A
              le_mean =     -17.216319560495
             les_mean =     296.716691897202
             stat err =       0.000427685148
             autocorr =       1.161241366011
              std dev =       0.561277868457
             le_variance =       0.315032845620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817846967
                                         uncertainty =       0.003450760943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314817846967
                                         uncertainty =       0.003450760943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396883387
  error estimate for blocks of size 2^( 2) =       0.000406555390
  error estimate for blocks of size 2^( 3) =       0.000415674157
  error estimate for blocks of size 2^( 4) =       0.000422958223
  error estimate for blocks of size 2^( 5) =       0.000427520647
  error estimate for blocks of size 2^( 6) =       0.000429751381
  error estimate for blocks of size 2^( 7) =       0.000430510342

      target function =                  N/A
              le_mean =     -17.216319560495
             les_mean =     296.716691897155
             stat err =       0.000427685148
             autocorr =       1.161241366039
              std dev =       0.561277868418
             le_variance =       0.315032845576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216319560495        initial
     2.3842e+06     2.3842e+07             2.8281e-10       -17.216319560496  <--
     9.5367e+06     9.5367e+07             7.0703e-11       -17.216319560495
     3.8147e+07     3.8147e+08             1.7676e-11       -17.216319560495

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 2.9135e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4998e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.3535
    reference variance = 1.40055
====================================================
  Execution time = 2.0294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1781e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5534e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737215220
                                         uncertainty =       0.004573540771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317737215220
                                         uncertainty =       0.004573540771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398626979
  error estimate for blocks of size 2^( 2) =       0.000408485833
  error estimate for blocks of size 2^( 3) =       0.000417276179
  error estimate for blocks of size 2^( 4) =       0.000423715119
  error estimate for blocks of size 2^( 5) =       0.000427470721
  error estimate for blocks of size 2^( 6) =       0.000428637931
  error estimate for blocks of size 2^( 7) =       0.000430773533

      target function =                  N/A
              le_mean =     -17.216537768588
             les_mean =     296.726979514660
             stat err =       0.000427649326
             autocorr =       1.150912236929
              std dev =       0.563743679656
             le_variance =       0.317806936352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653776859e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537768588       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537768589       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537768590       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216537768589       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216537768589       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216537768296       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216537768864       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.081737e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537768588       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537768588       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537768588       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216537768588       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216537769115       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216537769305       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216537766736       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.704344e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216537768588       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216537768588       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216537768588       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216537768588       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216537766648       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216537771280       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216537774413       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 6.760848e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.252513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5857e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094573e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1489
    reference variance = 0.664433
====================================================
  Execution time = 1.9627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1347e-01
  Total weights = 2.0000e+06
  Execution time = 1.8241e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582737876
                                         uncertainty =       0.003439876116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582737876
                                         uncertainty =       0.003439876116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395895128
  error estimate for blocks of size 2^( 2) =       0.000405105021
  error estimate for blocks of size 2^( 3) =       0.000414050181
  error estimate for blocks of size 2^( 4) =       0.000421116441
  error estimate for blocks of size 2^( 5) =       0.000424800668
  error estimate for blocks of size 2^( 6) =       0.000425925729
  error estimate for blocks of size 2^( 7) =       0.000426500171

      target function =                  N/A
              le_mean =     -17.216784389591
             les_mean =     296.731130465000
             stat err =       0.000424585752
             autocorr =       1.150192469170
              std dev =       0.559880258685
             le_variance =       0.313465904065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582738263
                                         uncertainty =       0.003439876121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582738263
                                         uncertainty =       0.003439876121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395895128
  error estimate for blocks of size 2^( 2) =       0.000405105021
  error estimate for blocks of size 2^( 3) =       0.000414050182
  error estimate for blocks of size 2^( 4) =       0.000421116441
  error estimate for blocks of size 2^( 5) =       0.000424800668
  error estimate for blocks of size 2^( 6) =       0.000425925729
  error estimate for blocks of size 2^( 7) =       0.000426500172

      target function =                  N/A
              le_mean =     -17.216784389592
             les_mean =     296.731130465428
             stat err =       0.000424585753
             autocorr =       1.150192468828
              std dev =       0.559880259031
             le_variance =       0.313465904452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582738069
                                         uncertainty =       0.003439876118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582738069
                                         uncertainty =       0.003439876118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395895128
  error estimate for blocks of size 2^( 2) =       0.000405105021
  error estimate for blocks of size 2^( 3) =       0.000414050182
  error estimate for blocks of size 2^( 4) =       0.000421116441
  error estimate for blocks of size 2^( 5) =       0.000424800668
  error estimate for blocks of size 2^( 6) =       0.000425925729
  error estimate for blocks of size 2^( 7) =       0.000426500171

      target function =                  N/A
              le_mean =     -17.216784389592
             les_mean =     296.731130465214
             stat err =       0.000424585752
             autocorr =       1.150192468995
              std dev =       0.559880258858
             le_variance =       0.313465904259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582737900
                                         uncertainty =       0.003439876116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313582737900
                                         uncertainty =       0.003439876116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395895128
  error estimate for blocks of size 2^( 2) =       0.000405105021
  error estimate for blocks of size 2^( 3) =       0.000414050181
  error estimate for blocks of size 2^( 4) =       0.000421116441
  error estimate for blocks of size 2^( 5) =       0.000424800668
  error estimate for blocks of size 2^( 6) =       0.000425925729
  error estimate for blocks of size 2^( 7) =       0.000426500171

      target function =                  N/A
              le_mean =     -17.216784389591
             les_mean =     296.731130465027
             stat err =       0.000424585752
             autocorr =       1.150192469154
              std dev =       0.559880258707
             le_variance =       0.313465904090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216784389591        initial
     5.9605e+05     5.9605e+06             1.0817e-09       -17.216784389592  <--
     2.3842e+06     2.3842e+07             2.7043e-10       -17.216784389592
     9.5367e+06     9.5367e+07             6.7608e-11       -17.216784389591

*****************************************************************************
Applying the update for shift_i =   5.9605e+05     and shift_s =   5.9605e+06
*****************************************************************************

  Execution time = 2.8855e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381544e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508192e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2335
    reference variance = 0.183122
====================================================
  Execution time = 2.0004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313838971579
                                         uncertainty =       0.003652945539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313838971579
                                         uncertainty =       0.003652945539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396103641
  error estimate for blocks of size 2^( 2) =       0.000405718708
  error estimate for blocks of size 2^( 3) =       0.000414087358
  error estimate for blocks of size 2^( 4) =       0.000419994688
  error estimate for blocks of size 2^( 5) =       0.000423954133
  error estimate for blocks of size 2^( 6) =       0.000426201034
  error estimate for blocks of size 2^( 7) =       0.000427106718

      target function =                  N/A
              le_mean =     -17.216460970896
             les_mean =     296.720324393510
             stat err =       0.000424314143
             autocorr =       1.147512295435
              std dev =       0.560175140504
             le_variance =       0.313796188039


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721646097090e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460970896       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216460970906       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216460970910       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216460970918       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216460970775       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216460970906       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216460970822       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216460970684       residual = 9.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 4.216385e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460970896       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216460970898       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216460970899       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216460970932       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216460971663       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216460971615       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216460970297       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216460970898       residual = 9.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.054096e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216460970896       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216460970896       residual = 9.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216460970896       residual = 2.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216460970896       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216460971349       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216460970731       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216460971605       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216460973784       residual = 9.68e-10           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.635241e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.255218 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5581e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680749e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.32478
====================================================
  Execution time = 1.9711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2027e-01
  Total weights = 2.0000e+06
  Execution time = 1.8206e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296654508
                                         uncertainty =       0.004446721953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296654508
                                         uncertainty =       0.004446721953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170801
  error estimate for blocks of size 2^( 2) =       0.000409824637
  error estimate for blocks of size 2^( 3) =       0.000418440089
  error estimate for blocks of size 2^( 4) =       0.000424563423
  error estimate for blocks of size 2^( 5) =       0.000429387780
  error estimate for blocks of size 2^( 6) =       0.000432691681
  error estimate for blocks of size 2^( 7) =       0.000434321633

      target function =                  N/A
              le_mean =     -17.216258241980
             les_mean =     296.719821033600
             stat err =       0.000430241129
             autocorr =       1.155934051540
              std dev =       0.565926973371
             le_variance =       0.320273339189

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296656131
                                         uncertainty =       0.004446721969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296656131
                                         uncertainty =       0.004446721969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170802
  error estimate for blocks of size 2^( 2) =       0.000409824638
  error estimate for blocks of size 2^( 3) =       0.000418440090
  error estimate for blocks of size 2^( 4) =       0.000424563424
  error estimate for blocks of size 2^( 5) =       0.000429387780
  error estimate for blocks of size 2^( 6) =       0.000432691682
  error estimate for blocks of size 2^( 7) =       0.000434321634

      target function =                  N/A
              le_mean =     -17.216258241992
             les_mean =     296.719821035641
             stat err =       0.000430241130
             autocorr =       1.155934050066
              std dev =       0.565926974804
             le_variance =       0.320273340811

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296655319
                                         uncertainty =       0.004446721961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296655319
                                         uncertainty =       0.004446721961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170801
  error estimate for blocks of size 2^( 2) =       0.000409824637
  error estimate for blocks of size 2^( 3) =       0.000418440089
  error estimate for blocks of size 2^( 4) =       0.000424563424
  error estimate for blocks of size 2^( 5) =       0.000429387780
  error estimate for blocks of size 2^( 6) =       0.000432691681
  error estimate for blocks of size 2^( 7) =       0.000434321634

      target function =                  N/A
              le_mean =     -17.216258241986
             les_mean =     296.719821034620
             stat err =       0.000430241130
             autocorr =       1.155934050812
              std dev =       0.565926974088
             le_variance =       0.320273340000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296654609
                                         uncertainty =       0.004446721954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320296654609
                                         uncertainty =       0.004446721954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400170801
  error estimate for blocks of size 2^( 2) =       0.000409824637
  error estimate for blocks of size 2^( 3) =       0.000418440089
  error estimate for blocks of size 2^( 4) =       0.000424563423
  error estimate for blocks of size 2^( 5) =       0.000429387780
  error estimate for blocks of size 2^( 6) =       0.000432691681
  error estimate for blocks of size 2^( 7) =       0.000434321633

      target function =                  N/A
              le_mean =     -17.216258241981
             les_mean =     296.719821033727
             stat err =       0.000430241129
             autocorr =       1.155934051451
              std dev =       0.565926973461
             le_variance =       0.320273339290


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216258241980        initial
     1.4901e+05     1.4901e+06             4.2164e-09       -17.216258241992  <--
     5.9605e+05     5.9605e+06             1.0541e-09       -17.216258241986
     2.3842e+06     2.3842e+07             2.6352e-10       -17.216258241981

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 3.1930e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680748e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7517e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2442
    reference variance = 0.284782
====================================================
  Execution time = 1.9909e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2137e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321467053719
                                         uncertainty =       0.004274584103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321467053719
                                         uncertainty =       0.004274584103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400854844
  error estimate for blocks of size 2^( 2) =       0.000410631047
  error estimate for blocks of size 2^( 3) =       0.000419383004
  error estimate for blocks of size 2^( 4) =       0.000426057135
  error estimate for blocks of size 2^( 5) =       0.000430594226
  error estimate for blocks of size 2^( 6) =       0.000432752927
  error estimate for blocks of size 2^( 7) =       0.000434888217

      target function =                  N/A
              le_mean =     -17.216717173768
             les_mean =     296.736719292879
             stat err =       0.000431073126
             autocorr =       1.156452038787
              std dev =       0.566894357038
             le_variance =       0.321369212042


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721671717377e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717173768       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717173787       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717173827       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717173842       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717173858       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717173811       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717173850       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.766388e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717173768       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717173773       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717173783       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717173788       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717173787       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717173696       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717173773       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 4.415973e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216717173768       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216717173769       residual = 9.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216717173772       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216717173763       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216717174121       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216717173773       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216717173927       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.103993e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.257508 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5509e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680748e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150692e-01 1 1  ON 27
 eO_8                 2.822411e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789507e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2686
    reference variance = 0.236499
====================================================
  Execution time = 1.9534e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1704e-01
  Total weights = 2.0000e+06
  Execution time = 1.8280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068170978
                                         uncertainty =       0.003538762874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068170978
                                         uncertainty =       0.003538762874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143381
  error estimate for blocks of size 2^( 2) =       0.000408060415
  error estimate for blocks of size 2^( 3) =       0.000417034416
  error estimate for blocks of size 2^( 4) =       0.000424007152
  error estimate for blocks of size 2^( 5) =       0.000427536127
  error estimate for blocks of size 2^( 6) =       0.000428138710
  error estimate for blocks of size 2^( 7) =       0.000431795664

      target function =                  N/A
              le_mean =     -17.217453833477
             les_mean =     296.757752653828
             stat err =       0.000427869413
             autocorr =       1.154897608463
              std dev =       0.563059769846
             le_variance =       0.317036304419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068176758
                                         uncertainty =       0.003538762947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068176758
                                         uncertainty =       0.003538762947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143385
  error estimate for blocks of size 2^( 2) =       0.000408060418
  error estimate for blocks of size 2^( 3) =       0.000417034419
  error estimate for blocks of size 2^( 4) =       0.000424007155
  error estimate for blocks of size 2^( 5) =       0.000427536130
  error estimate for blocks of size 2^( 6) =       0.000428138713
  error estimate for blocks of size 2^( 7) =       0.000431795667

      target function =                  N/A
              le_mean =     -17.217453833489
             les_mean =     296.757752660001
             stat err =       0.000427869416
             autocorr =       1.154897603576
              std dev =       0.563059774979
             le_variance =       0.317036310199

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068173868
                                         uncertainty =       0.003538762910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068173868
                                         uncertainty =       0.003538762910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143383
  error estimate for blocks of size 2^( 2) =       0.000408060416
  error estimate for blocks of size 2^( 3) =       0.000417034418
  error estimate for blocks of size 2^( 4) =       0.000424007153
  error estimate for blocks of size 2^( 5) =       0.000427536129
  error estimate for blocks of size 2^( 6) =       0.000428138712
  error estimate for blocks of size 2^( 7) =       0.000431795666

      target function =                  N/A
              le_mean =     -17.217453833483
             les_mean =     296.757752656914
             stat err =       0.000427869415
             autocorr =       1.154897606021
              std dev =       0.563059772412
             le_variance =       0.317036307309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068171339
                                         uncertainty =       0.003538762878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317068171339
                                         uncertainty =       0.003538762878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398143382
  error estimate for blocks of size 2^( 2) =       0.000408060415
  error estimate for blocks of size 2^( 3) =       0.000417034416
  error estimate for blocks of size 2^( 4) =       0.000424007152
  error estimate for blocks of size 2^( 5) =       0.000427536127
  error estimate for blocks of size 2^( 6) =       0.000428138710
  error estimate for blocks of size 2^( 7) =       0.000431795664

      target function =                  N/A
              le_mean =     -17.217453833478
             les_mean =     296.757752654213
             stat err =       0.000427869414
             autocorr =       1.154897608154
              std dev =       0.563059770167
             le_variance =       0.317036304780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217453833477        initial
     3.7253e+04     3.7253e+05             1.7664e-08       -17.217453833489  <--
     1.4901e+05     1.4901e+06             4.4160e-09       -17.217453833483
     5.9605e+05     5.9605e+06             1.1040e-09       -17.217453833478

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.8774e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680747e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4289e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7231e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1764
    reference variance = 0.655449
====================================================
  Execution time = 2.0081e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313541205664
                                         uncertainty =       0.002188255440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313541205664
                                         uncertainty =       0.002188255440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401773294
  error estimate for blocks of size 2^( 2) =       0.000411226986
  error estimate for blocks of size 2^( 3) =       0.000419524123
  error estimate for blocks of size 2^( 4) =       0.000425976275
  error estimate for blocks of size 2^( 5) =       0.000429831632
  error estimate for blocks of size 2^( 6) =       0.000433004237
  error estimate for blocks of size 2^( 7) =       0.000433492183

      target function =                  N/A
              le_mean =     -17.216759316011
             les_mean =     296.739644743615
             stat err =       0.000430576082
             autocorr =       1.148517643391
              std dev =       0.568193241411
             le_variance =       0.322843559585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675931601e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759316011       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759315984       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216759315944       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216759315901       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216759316230       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216759316226       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216759316214       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 6.849232e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759316011       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759316004       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216759315994       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216759315983       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216759316066       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216759316058       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216759316067       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.712318e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216759316011       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216759316009       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216759316007       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216759316004       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216759316030       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216759316152       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216759315918       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 4.280802e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5609e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680744e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902472e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.189
    reference variance = 0.252786
====================================================
  Execution time = 1.9587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2006e-01
  Total weights = 2.0000e+06
  Execution time = 1.8246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078448905
                                         uncertainty =       0.006312121641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078448905
                                         uncertainty =       0.006312121641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400040341
  error estimate for blocks of size 2^( 2) =       0.000409501362
  error estimate for blocks of size 2^( 3) =       0.000418194876
  error estimate for blocks of size 2^( 4) =       0.000424999497
  error estimate for blocks of size 2^( 5) =       0.000428870448
  error estimate for blocks of size 2^( 6) =       0.000430328399
  error estimate for blocks of size 2^( 7) =       0.000430701174

      target function =                  N/A
              le_mean =     -17.216803519292
             les_mean =     296.738387810437
             stat err =       0.000428724879
             autocorr =       1.148549710191
              std dev =       0.565742475470
             le_variance =       0.320064548551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078473158
                                         uncertainty =       0.006312122600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078473158
                                         uncertainty =       0.006312122600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400040356
  error estimate for blocks of size 2^( 2) =       0.000409501376
  error estimate for blocks of size 2^( 3) =       0.000418194889
  error estimate for blocks of size 2^( 4) =       0.000424999509
  error estimate for blocks of size 2^( 5) =       0.000428870460
  error estimate for blocks of size 2^( 6) =       0.000430328411
  error estimate for blocks of size 2^( 7) =       0.000430701185

      target function =                  N/A
              le_mean =     -17.216803519130
             les_mean =     296.738387829103
             stat err =       0.000428724891
             autocorr =       1.148549685777
              std dev =       0.565742496897
             le_variance =       0.320064572795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078461032
                                         uncertainty =       0.006312122121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078461032
                                         uncertainty =       0.006312122121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400040348
  error estimate for blocks of size 2^( 2) =       0.000409501369
  error estimate for blocks of size 2^( 3) =       0.000418194883
  error estimate for blocks of size 2^( 4) =       0.000424999503
  error estimate for blocks of size 2^( 5) =       0.000428870454
  error estimate for blocks of size 2^( 6) =       0.000430328405
  error estimate for blocks of size 2^( 7) =       0.000430701179

      target function =                  N/A
              le_mean =     -17.216803519211
             les_mean =     296.738387819770
             stat err =       0.000428724885
             autocorr =       1.148549697979
              std dev =       0.565742486183
             le_variance =       0.320064560673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078450421
                                         uncertainty =       0.006312121701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320078450421
                                         uncertainty =       0.006312121701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400040342
  error estimate for blocks of size 2^( 2) =       0.000409501363
  error estimate for blocks of size 2^( 3) =       0.000418194877
  error estimate for blocks of size 2^( 4) =       0.000424999497
  error estimate for blocks of size 2^( 5) =       0.000428870449
  error estimate for blocks of size 2^( 6) =       0.000430328400
  error estimate for blocks of size 2^( 7) =       0.000430701174

      target function =                  N/A
              le_mean =     -17.216803519282
             les_mean =     296.738387811604
             stat err =       0.000428724880
             autocorr =       1.148549708668
              std dev =       0.565742476809
             le_variance =       0.320064550066


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216803519292        initial  <--
     9.3132e+03     9.3132e+04             6.8492e-08       -17.216803519130
     3.7253e+04     3.7253e+05             1.7123e-08       -17.216803519211
     1.4901e+05     1.4901e+06             4.2808e-09       -17.216803519282

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8202
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680747e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4435e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2746
    reference variance = 0.305525
====================================================
  Execution time = 2.0020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3207e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6755e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332084548980
                                         uncertainty =       0.013191761598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332084548980
                                         uncertainty =       0.013191761598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407471206
  error estimate for blocks of size 2^( 2) =       0.000416812649
  error estimate for blocks of size 2^( 3) =       0.000425423451
  error estimate for blocks of size 2^( 4) =       0.000431307456
  error estimate for blocks of size 2^( 5) =       0.000435462720
  error estimate for blocks of size 2^( 6) =       0.000438830681
  error estimate for blocks of size 2^( 7) =       0.000441368399

      target function =                  N/A
              le_mean =     -17.216382625395
             les_mean =     296.735896104598
             stat err =       0.000436742314
             autocorr =       1.148832446520
              std dev =       0.576251305106
             le_variance =       0.332065566636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721638262539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216382625395       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216382625401       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216382625420       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216382625403       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216382625453       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216382625427       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216382625421       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 7.562813e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216382625395       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216382625396       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216382625401       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216382625401       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216382625479       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216382625788       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216382624929       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.890705e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216382625395       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216382625395       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216382625396       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216382625301       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216382624588       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216382626138       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216382625760       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 4.726764e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262090 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5705e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680747e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2617
    reference variance = 0.248495
====================================================
  Execution time = 1.9653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1608e-01
  Total weights = 2.0000e+06
  Execution time = 1.8176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090148059
                                         uncertainty =       0.003090572019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090148059
                                         uncertainty =       0.003090572019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397544739
  error estimate for blocks of size 2^( 2) =       0.000407783774
  error estimate for blocks of size 2^( 3) =       0.000416283078
  error estimate for blocks of size 2^( 4) =       0.000422466296
  error estimate for blocks of size 2^( 5) =       0.000426876660
  error estimate for blocks of size 2^( 6) =       0.000428348163
  error estimate for blocks of size 2^( 7) =       0.000429959454

      target function =                  N/A
              le_mean =     -17.216446531742
             les_mean =     296.722114660832
             stat err =       0.000426912643
             autocorr =       1.153203662438
              std dev =       0.562213161112
             le_variance =       0.316083638528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090150030
                                         uncertainty =       0.003090572046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090150030
                                         uncertainty =       0.003090572046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397544740
  error estimate for blocks of size 2^( 2) =       0.000407783776
  error estimate for blocks of size 2^( 3) =       0.000416283079
  error estimate for blocks of size 2^( 4) =       0.000422466297
  error estimate for blocks of size 2^( 5) =       0.000426876661
  error estimate for blocks of size 2^( 6) =       0.000428348164
  error estimate for blocks of size 2^( 7) =       0.000429959455

      target function =                  N/A
              le_mean =     -17.216446531742
             les_mean =     296.722114662797
             stat err =       0.000426912644
             autocorr =       1.153203660501
              std dev =       0.562213162864
             le_variance =       0.316083640498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090149045
                                         uncertainty =       0.003090572033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090149045
                                         uncertainty =       0.003090572033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397544739
  error estimate for blocks of size 2^( 2) =       0.000407783775
  error estimate for blocks of size 2^( 3) =       0.000416283079
  error estimate for blocks of size 2^( 4) =       0.000422466297
  error estimate for blocks of size 2^( 5) =       0.000426876660
  error estimate for blocks of size 2^( 6) =       0.000428348163
  error estimate for blocks of size 2^( 7) =       0.000429959454

      target function =                  N/A
              le_mean =     -17.216446531742
             les_mean =     296.722114661814
             stat err =       0.000426912644
             autocorr =       1.153203661471
              std dev =       0.562213161988
             le_variance =       0.316083639513

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090148183
                                         uncertainty =       0.003090572021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316090148183
                                         uncertainty =       0.003090572021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397544739
  error estimate for blocks of size 2^( 2) =       0.000407783774
  error estimate for blocks of size 2^( 3) =       0.000416283078
  error estimate for blocks of size 2^( 4) =       0.000422466296
  error estimate for blocks of size 2^( 5) =       0.000426876660
  error estimate for blocks of size 2^( 6) =       0.000428348163
  error estimate for blocks of size 2^( 7) =       0.000429959454

      target function =                  N/A
              le_mean =     -17.216446531742
             les_mean =     296.722114660955
             stat err =       0.000426912643
             autocorr =       1.153203662319
              std dev =       0.562213161221
             le_variance =       0.316083638651


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216446531742        initial  <--
     9.3132e+04     9.3132e+05             7.5628e-09       -17.216446531742
     3.7253e+05     3.7253e+06             1.8907e-09       -17.216446531742
     1.4901e+06     1.4901e+07             4.7268e-10       -17.216446531742

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8450
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680747e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7230e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.73275
====================================================
  Execution time = 2.0213e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1252e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312480376854
                                         uncertainty =       0.003013824897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312480376854
                                         uncertainty =       0.003013824897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395295420
  error estimate for blocks of size 2^( 2) =       0.000405628516
  error estimate for blocks of size 2^( 3) =       0.000414000740
  error estimate for blocks of size 2^( 4) =       0.000420206233
  error estimate for blocks of size 2^( 5) =       0.000423659652
  error estimate for blocks of size 2^( 6) =       0.000425747397
  error estimate for blocks of size 2^( 7) =       0.000426154384

      target function =                  N/A
              le_mean =     -17.215518444038
             les_mean =     296.686592079174
             stat err =       0.000423941916
             autocorr =       1.150188846349
              std dev =       0.559032144367
             le_variance =       0.312516938435


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721551844404e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215518444038       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215518444038       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215518444039       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215518444038       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215518443992       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215518444467       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215518444054       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 7.039186e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215518444038       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215518444038       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215518444038       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215518444038       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215518446736       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215518443415       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215518445346       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.759796e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215518444038       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215518444038       residual = 6.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215518444038       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215518444038       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215518450225       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215518448206       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215518443281       residual = 7.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 4.399498e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5859e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680747e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1201
    reference variance = 0.223144
====================================================
  Execution time = 1.9635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.4437e-01
  Total weights = 2.0000e+06
  Execution time = 1.8260e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616506
                                         uncertainty =       0.021225036256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616506
                                         uncertainty =       0.021225036256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414953344
  error estimate for blocks of size 2^( 2) =       0.000424667288
  error estimate for blocks of size 2^( 3) =       0.000433250415
  error estimate for blocks of size 2^( 4) =       0.000439578639
  error estimate for blocks of size 2^( 5) =       0.000443006481
  error estimate for blocks of size 2^( 6) =       0.000445315167
  error estimate for blocks of size 2^( 7) =       0.000447105278

      target function =                  N/A
              le_mean =     -17.216420325186
             les_mean =     296.749501196425
             stat err =       0.000443751391
             autocorr =       1.143617830262
              std dev =       0.586832646614
             le_variance =       0.344372555131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616867
                                         uncertainty =       0.021225036283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616867
                                         uncertainty =       0.021225036283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414953344
  error estimate for blocks of size 2^( 2) =       0.000424667289
  error estimate for blocks of size 2^( 3) =       0.000433250415
  error estimate for blocks of size 2^( 4) =       0.000439578639
  error estimate for blocks of size 2^( 5) =       0.000443006481
  error estimate for blocks of size 2^( 6) =       0.000445315167
  error estimate for blocks of size 2^( 7) =       0.000447105278

      target function =                  N/A
              le_mean =     -17.216420325187
             les_mean =     296.749501196819
             stat err =       0.000443751391
             autocorr =       1.143617830001
              std dev =       0.586832646921
             le_variance =       0.344372555492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616687
                                         uncertainty =       0.021225036269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616687
                                         uncertainty =       0.021225036269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414953344
  error estimate for blocks of size 2^( 2) =       0.000424667288
  error estimate for blocks of size 2^( 3) =       0.000433250415
  error estimate for blocks of size 2^( 4) =       0.000439578639
  error estimate for blocks of size 2^( 5) =       0.000443006481
  error estimate for blocks of size 2^( 6) =       0.000445315167
  error estimate for blocks of size 2^( 7) =       0.000447105278

      target function =                  N/A
              le_mean =     -17.216420325187
             les_mean =     296.749501196622
             stat err =       0.000443751391
             autocorr =       1.143617830137
              std dev =       0.586832646767
             le_variance =       0.344372555312

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616529
                                         uncertainty =       0.021225036258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344435616529
                                         uncertainty =       0.021225036258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414953344
  error estimate for blocks of size 2^( 2) =       0.000424667288
  error estimate for blocks of size 2^( 3) =       0.000433250415
  error estimate for blocks of size 2^( 4) =       0.000439578639
  error estimate for blocks of size 2^( 5) =       0.000443006481
  error estimate for blocks of size 2^( 6) =       0.000445315167
  error estimate for blocks of size 2^( 7) =       0.000447105278

      target function =                  N/A
              le_mean =     -17.216420325186
             les_mean =     296.749501196450
             stat err =       0.000443751391
             autocorr =       1.143617830251
              std dev =       0.586832646633
             le_variance =       0.344372555154


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216420325186        initial
     9.3132e+05     9.3132e+06             7.0392e-10       -17.216420325187  <--
     3.7253e+06     3.7253e+07             1.7598e-10       -17.216420325187
     1.4901e+07     1.4901e+08             4.3995e-11       -17.216420325186

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 2.9743e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680747e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1172
    reference variance = 0.262342
====================================================
  Execution time = 2.0405e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1718e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317027387368
                                         uncertainty =       0.003608899207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317027387368
                                         uncertainty =       0.003608899207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398230891
  error estimate for blocks of size 2^( 2) =       0.000408374686
  error estimate for blocks of size 2^( 3) =       0.000417021915
  error estimate for blocks of size 2^( 4) =       0.000423865099
  error estimate for blocks of size 2^( 5) =       0.000427728679
  error estimate for blocks of size 2^( 6) =       0.000430444837
  error estimate for blocks of size 2^( 7) =       0.000433345865

      target function =                  N/A
              le_mean =     -17.216691533381
             les_mean =     296.731642881598
             stat err =       0.000428846120
             autocorr =       1.159666414724
              std dev =       0.563183526575
             le_variance =       0.317175684605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721669153338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216691533381       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691533384       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691533383       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691533402       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216691533510       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216691533387       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216691533567       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 2.639742e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216691533381       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691533381       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691533381       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691533382       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216691534062       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216691533381       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216691533805       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 6.599355e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216691533381       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216691533381       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216691533381       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216691533382       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216691533493       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216691534516       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216691532997       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.649838e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.266655 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5995e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680747e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.637317
====================================================
  Execution time = 1.9664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1536e-01
  Total weights = 2.0000e+06
  Execution time = 1.8224e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322259932
                                         uncertainty =       0.002927849106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322259932
                                         uncertainty =       0.002927849106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397088213
  error estimate for blocks of size 2^( 2) =       0.000406951453
  error estimate for blocks of size 2^( 3) =       0.000415957981
  error estimate for blocks of size 2^( 4) =       0.000422231881
  error estimate for blocks of size 2^( 5) =       0.000426824194
  error estimate for blocks of size 2^( 6) =       0.000428386382
  error estimate for blocks of size 2^( 7) =       0.000432068476

      target function =                  N/A
              le_mean =     -17.216680426819
             les_mean =     296.729442859488
             stat err =       0.000427377733
             autocorr =       1.158376640053
              std dev =       0.561567536428
             le_variance =       0.315358097970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322261194
                                         uncertainty =       0.002927849120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322261194
                                         uncertainty =       0.002927849120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397088214
  error estimate for blocks of size 2^( 2) =       0.000406951454
  error estimate for blocks of size 2^( 3) =       0.000415957981
  error estimate for blocks of size 2^( 4) =       0.000422231882
  error estimate for blocks of size 2^( 5) =       0.000426824195
  error estimate for blocks of size 2^( 6) =       0.000428386382
  error estimate for blocks of size 2^( 7) =       0.000432068477

      target function =                  N/A
              le_mean =     -17.216680426821
             les_mean =     296.729442860848
             stat err =       0.000427377734
             autocorr =       1.158376638923
              std dev =       0.561567537552
             le_variance =       0.315358099232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322260563
                                         uncertainty =       0.002927849113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322260563
                                         uncertainty =       0.002927849113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397088213
  error estimate for blocks of size 2^( 2) =       0.000406951453
  error estimate for blocks of size 2^( 3) =       0.000415957981
  error estimate for blocks of size 2^( 4) =       0.000422231881
  error estimate for blocks of size 2^( 5) =       0.000426824195
  error estimate for blocks of size 2^( 6) =       0.000428386382
  error estimate for blocks of size 2^( 7) =       0.000432068477

      target function =                  N/A
              le_mean =     -17.216680426820
             les_mean =     296.729442860168
             stat err =       0.000427377734
             autocorr =       1.158376639491
              std dev =       0.561567536990
             le_variance =       0.315358098601

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322260011
                                         uncertainty =       0.002927849107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315322260011
                                         uncertainty =       0.002927849107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397088213
  error estimate for blocks of size 2^( 2) =       0.000406951453
  error estimate for blocks of size 2^( 3) =       0.000415957981
  error estimate for blocks of size 2^( 4) =       0.000422231881
  error estimate for blocks of size 2^( 5) =       0.000426824194
  error estimate for blocks of size 2^( 6) =       0.000428386382
  error estimate for blocks of size 2^( 7) =       0.000432068477

      target function =                  N/A
              le_mean =     -17.216680426819
             les_mean =     296.729442859573
             stat err =       0.000427377733
             autocorr =       1.158376639989
              std dev =       0.561567536498
             le_variance =       0.315358098049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216680426819        initial
     2.3283e+05     2.3283e+06             2.6397e-09       -17.216680426821  <--
     9.3132e+05     9.3132e+06             6.5994e-10       -17.216680426820
     3.7253e+06     3.7253e+07             1.6498e-10       -17.216680426819

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 2.8875e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680746e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4875e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1901
    reference variance = 1.0599
====================================================
  Execution time = 1.9811e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2846e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0950e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328358283685
                                         uncertainty =       0.007644322136

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328358283685
                                         uncertainty =       0.007644322136

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405250100
  error estimate for blocks of size 2^( 2) =       0.000415150148
  error estimate for blocks of size 2^( 3) =       0.000423194347
  error estimate for blocks of size 2^( 4) =       0.000429838101
  error estimate for blocks of size 2^( 5) =       0.000434882872
  error estimate for blocks of size 2^( 6) =       0.000436839988
  error estimate for blocks of size 2^( 7) =       0.000439505389

      target function =                  N/A
              le_mean =     -17.216346015432
             les_mean =     296.731025245303
             stat err =       0.000435266587
             autocorr =       1.153624312995
              std dev =       0.573110187016
             le_variance =       0.328455286462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721634601543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216346015432       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216346015437       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216346015434       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216346015383       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216346015468       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216346015432       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216346015457       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 1.223002e-08

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216346015432       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216346015433       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216346015432       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216346015427       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216346015516       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216346015516       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216346015579       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 3.057507e-09

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216346015432       residual = 6.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216346015432       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216346015432       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216346015306       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216346015432       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216346015942       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216346015363       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 7.643769e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268913 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5916e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680746e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629657e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1315
    reference variance = 0.360475
====================================================
  Execution time = 1.9740e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2075e-01
  Total weights = 2.0000e+06
  Execution time = 1.8218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735263215
                                         uncertainty =       0.004904347739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735263215
                                         uncertainty =       0.004904347739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467461
  error estimate for blocks of size 2^( 2) =       0.000410383995
  error estimate for blocks of size 2^( 3) =       0.000419361651
  error estimate for blocks of size 2^( 4) =       0.000426318624
  error estimate for blocks of size 2^( 5) =       0.000429924060
  error estimate for blocks of size 2^( 6) =       0.000432041527
  error estimate for blocks of size 2^( 7) =       0.000433449649

      target function =                  N/A
              le_mean =     -17.216987119152
             les_mean =     296.745393674945
             stat err =       0.000430433465
             autocorr =       1.155254290710
              std dev =       0.566346514299
             le_variance =       0.320748374258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735266584
                                         uncertainty =       0.004904347810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735266584
                                         uncertainty =       0.004904347810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467463
  error estimate for blocks of size 2^( 2) =       0.000410383996
  error estimate for blocks of size 2^( 3) =       0.000419361653
  error estimate for blocks of size 2^( 4) =       0.000426318625
  error estimate for blocks of size 2^( 5) =       0.000429924062
  error estimate for blocks of size 2^( 6) =       0.000432041529
  error estimate for blocks of size 2^( 7) =       0.000433449651

      target function =                  N/A
              le_mean =     -17.216987119166
             les_mean =     296.745393678791
             stat err =       0.000430433467
             autocorr =       1.155254287695
              std dev =       0.566346517272
             le_variance =       0.320748377626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735264899
                                         uncertainty =       0.004904347775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735264899
                                         uncertainty =       0.004904347775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467462
  error estimate for blocks of size 2^( 2) =       0.000410383996
  error estimate for blocks of size 2^( 3) =       0.000419361652
  error estimate for blocks of size 2^( 4) =       0.000426318624
  error estimate for blocks of size 2^( 5) =       0.000429924061
  error estimate for blocks of size 2^( 6) =       0.000432041528
  error estimate for blocks of size 2^( 7) =       0.000433449650

      target function =                  N/A
              le_mean =     -17.216987119159
             les_mean =     296.745393676868
             stat err =       0.000430433466
             autocorr =       1.155254289199
              std dev =       0.566346515785
             le_variance =       0.320748375942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735263426
                                         uncertainty =       0.004904347744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320735263426
                                         uncertainty =       0.004904347744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400467461
  error estimate for blocks of size 2^( 2) =       0.000410383995
  error estimate for blocks of size 2^( 3) =       0.000419361651
  error estimate for blocks of size 2^( 4) =       0.000426318624
  error estimate for blocks of size 2^( 5) =       0.000429924060
  error estimate for blocks of size 2^( 6) =       0.000432041527
  error estimate for blocks of size 2^( 7) =       0.000433449650

      target function =                  N/A
              le_mean =     -17.216987119153
             les_mean =     296.745393675185
             stat err =       0.000430433465
             autocorr =       1.155254290524
              std dev =       0.566346514485
             le_variance =       0.320748374469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216987119152        initial
     5.8208e+04     5.8208e+05             1.2230e-08       -17.216987119166  <--
     2.3283e+05     2.3283e+06             3.0575e-09       -17.216987119159
     9.3132e+05     9.3132e+06             7.6438e-10       -17.216987119153

*****************************************************************************
Applying the update for shift_i =   5.8208e+04     and shift_s =   5.8208e+05
*****************************************************************************

  Execution time = 2.8952e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680744e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4874e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2283
    reference variance = 0.2632
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2413e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324198466405
                                         uncertainty =       0.009513016712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324198466405
                                         uncertainty =       0.009513016712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402572646
  error estimate for blocks of size 2^( 2) =       0.000412003052
  error estimate for blocks of size 2^( 3) =       0.000420513765
  error estimate for blocks of size 2^( 4) =       0.000427207040
  error estimate for blocks of size 2^( 5) =       0.000430972899
  error estimate for blocks of size 2^( 6) =       0.000433416463
  error estimate for blocks of size 2^( 7) =       0.000435327994

      target function =                  N/A
              le_mean =     -17.216740166261
             les_mean =     296.740271260303
             stat err =       0.000431731099
             autocorr =       1.150106726467
              std dev =       0.569323695113
             le_variance =       0.324129469817


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721674016626e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216740166261       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216740166189       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216740166146       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216740166246       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216740166241       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216740166250       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216740166259       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 4.846588e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216740166261       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216740166243       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216740166232       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216740166264       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216740166262       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216740166263       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216740166249       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 1.211652e-08

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216740166261       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216740166257       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216740166254       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216740166343       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216740166391       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216740166199       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216740166232       residual = 6.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 3.029134e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.271243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5437e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.100514e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680742e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902472e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429285e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1876
    reference variance = 0.190239
====================================================
  Execution time = 1.9670e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1492e-01
  Total weights = 2.0000e+06
  Execution time = 1.8207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859976654
                                         uncertainty =       0.003083112769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859976654
                                         uncertainty =       0.003083112769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396811245
  error estimate for blocks of size 2^( 2) =       0.000406643086
  error estimate for blocks of size 2^( 3) =       0.000415212663
  error estimate for blocks of size 2^( 4) =       0.000421314788
  error estimate for blocks of size 2^( 5) =       0.000426655710
  error estimate for blocks of size 2^( 6) =       0.000428425363
  error estimate for blocks of size 2^( 7) =       0.000429320163

      target function =                  N/A
              le_mean =     -17.216676105887
             les_mean =     296.728854305369
             stat err =       0.000426429006
             autocorr =       1.154849883556
              std dev =       0.561175843918
             le_variance =       0.314918327797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859985482
                                         uncertainty =       0.003083112850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859985482
                                         uncertainty =       0.003083112850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396811250
  error estimate for blocks of size 2^( 2) =       0.000406643091
  error estimate for blocks of size 2^( 3) =       0.000415212668
  error estimate for blocks of size 2^( 4) =       0.000421314793
  error estimate for blocks of size 2^( 5) =       0.000426655714
  error estimate for blocks of size 2^( 6) =       0.000428425366
  error estimate for blocks of size 2^( 7) =       0.000429320166

      target function =                  N/A
              le_mean =     -17.216676105812
             les_mean =     296.728854311607
             stat err =       0.000426429010
             autocorr =       1.154849872724
              std dev =       0.561175851785
             le_variance =       0.314918336627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859981068
                                         uncertainty =       0.003083112809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859981068
                                         uncertainty =       0.003083112809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396811247
  error estimate for blocks of size 2^( 2) =       0.000406643089
  error estimate for blocks of size 2^( 3) =       0.000415212666
  error estimate for blocks of size 2^( 4) =       0.000421314791
  error estimate for blocks of size 2^( 5) =       0.000426655712
  error estimate for blocks of size 2^( 6) =       0.000428425365
  error estimate for blocks of size 2^( 7) =       0.000429320165

      target function =                  N/A
              le_mean =     -17.216676105850
             les_mean =     296.728854308488
             stat err =       0.000426429008
             autocorr =       1.154849878139
              std dev =       0.561175847851
             le_variance =       0.314918332212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859977206
                                         uncertainty =       0.003083112774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314859977206
                                         uncertainty =       0.003083112774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396811245
  error estimate for blocks of size 2^( 2) =       0.000406643087
  error estimate for blocks of size 2^( 3) =       0.000415212664
  error estimate for blocks of size 2^( 4) =       0.000421314789
  error estimate for blocks of size 2^( 5) =       0.000426655710
  error estimate for blocks of size 2^( 6) =       0.000428425363
  error estimate for blocks of size 2^( 7) =       0.000429320163

      target function =                  N/A
              le_mean =     -17.216676105883
             les_mean =     296.728854305759
             stat err =       0.000426429006
             autocorr =       1.154849882882
              std dev =       0.561175844410
             le_variance =       0.314918328349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216676105887        initial  <--
     1.4552e+04     1.4552e+05             4.8466e-08       -17.216676105812
     5.8208e+04     5.8208e+05             1.2117e-08       -17.216676105850
     2.3283e+05     2.3283e+06             3.0291e-09       -17.216676105883

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8809
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312155e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680744e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4324e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2133
    reference variance = 0.212706
====================================================
  Execution time = 1.9762e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1972e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319710011083
                                         uncertainty =       0.004850196282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319710011083
                                         uncertainty =       0.004850196282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399823746
  error estimate for blocks of size 2^( 2) =       0.000409339748
  error estimate for blocks of size 2^( 3) =       0.000418292265
  error estimate for blocks of size 2^( 4) =       0.000425329033
  error estimate for blocks of size 2^( 5) =       0.000428931166
  error estimate for blocks of size 2^( 6) =       0.000431575103
  error estimate for blocks of size 2^( 7) =       0.000433054122

      target function =                  N/A
              le_mean =     -17.216601021444
             les_mean =     296.731068627608
             stat err =       0.000429722356
             autocorr =       1.155150918722
              std dev =       0.565436164292
             le_variance =       0.319718055889


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660102144e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601021444       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601021448       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216601021453       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216601021457       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216601021409       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216601021419       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216601021734       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 5.100679e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601021444       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601021445       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216601021446       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216601021448       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216601021413       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216601021416       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216601021451       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 1.275171e-09

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216601021444       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216601021444       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216601021444       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216601021743       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216601022735       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216601021072       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216601020825       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 3.187927e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.273565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5275e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820896e-02 1 1  ON 1
 uu_2                -4.606311e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680744e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969692e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2667
    reference variance = 0.460692
====================================================
  Execution time = 1.9691e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1951e-01
  Total weights = 2.0000e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008159
                                         uncertainty =       0.007704897812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008159
                                         uncertainty =       0.007704897812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399693000
  error estimate for blocks of size 2^( 2) =       0.000409290964
  error estimate for blocks of size 2^( 3) =       0.000417957581
  error estimate for blocks of size 2^( 4) =       0.000423893850
  error estimate for blocks of size 2^( 5) =       0.000428296286
  error estimate for blocks of size 2^( 6) =       0.000430247675
  error estimate for blocks of size 2^( 7) =       0.000433871875

      target function =                  N/A
              le_mean =     -17.216813730201
             les_mean =     296.738183849399
             stat err =       0.000429077422
             autocorr =       1.152439776650
              std dev =       0.565251261586
             le_variance =       0.319508988725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008913
                                         uncertainty =       0.007704897837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008913
                                         uncertainty =       0.007704897837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399693001
  error estimate for blocks of size 2^( 2) =       0.000409290964
  error estimate for blocks of size 2^( 3) =       0.000417957581
  error estimate for blocks of size 2^( 4) =       0.000423893851
  error estimate for blocks of size 2^( 5) =       0.000428296286
  error estimate for blocks of size 2^( 6) =       0.000430247675
  error estimate for blocks of size 2^( 7) =       0.000433871876

      target function =                  N/A
              le_mean =     -17.216813730205
             les_mean =     296.738183850310
             stat err =       0.000429077422
             autocorr =       1.152439775568
              std dev =       0.565251262254
             le_variance =       0.319508989480

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008536
                                         uncertainty =       0.007704897825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008536
                                         uncertainty =       0.007704897825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399693000
  error estimate for blocks of size 2^( 2) =       0.000409290964
  error estimate for blocks of size 2^( 3) =       0.000417957581
  error estimate for blocks of size 2^( 4) =       0.000423893850
  error estimate for blocks of size 2^( 5) =       0.000428296286
  error estimate for blocks of size 2^( 6) =       0.000430247675
  error estimate for blocks of size 2^( 7) =       0.000433871876

      target function =                  N/A
              le_mean =     -17.216813730203
             les_mean =     296.738183849855
             stat err =       0.000429077422
             autocorr =       1.152439776103
              std dev =       0.565251261920
             le_variance =       0.319508989102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008206
                                         uncertainty =       0.007704897814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319399008206
                                         uncertainty =       0.007704897814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399693000
  error estimate for blocks of size 2^( 2) =       0.000409290964
  error estimate for blocks of size 2^( 3) =       0.000417957581
  error estimate for blocks of size 2^( 4) =       0.000423893850
  error estimate for blocks of size 2^( 5) =       0.000428296286
  error estimate for blocks of size 2^( 6) =       0.000430247675
  error estimate for blocks of size 2^( 7) =       0.000433871875

      target function =                  N/A
              le_mean =     -17.216813730201
             les_mean =     296.738183849456
             stat err =       0.000429077422
             autocorr =       1.152439776582
              std dev =       0.565251261628
             le_variance =       0.319508988772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216813730201        initial
     1.4552e+05     1.4552e+06             5.1007e-09       -17.216813730205  <--
     5.8208e+05     5.8208e+06             1.2752e-09       -17.216813730203
     2.3283e+06     2.3283e+07             3.1879e-10       -17.216813730201

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 2.8885e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4166e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.185
    reference variance = 0.43463
====================================================
  Execution time = 1.9898e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4130e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6308e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341417839988
                                         uncertainty =       0.016583709796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341417839988
                                         uncertainty =       0.016583709796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413095611
  error estimate for blocks of size 2^( 2) =       0.000422337427
  error estimate for blocks of size 2^( 3) =       0.000430460718
  error estimate for blocks of size 2^( 4) =       0.000436792093
  error estimate for blocks of size 2^( 5) =       0.000439853643
  error estimate for blocks of size 2^( 6) =       0.000440108206
  error estimate for blocks of size 2^( 7) =       0.000440771576

      target function =                  N/A
              le_mean =     -17.216892936034
             les_mean =     296.762698167092
             stat err =       0.000439381379
             autocorr =       1.131311326902
              std dev =       0.584205414966
             le_variance =       0.341295966876


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721689293603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216892936034       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216892936024       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216892936009       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216892935977       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216892936031       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216892936044       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216892936066       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.984295e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216892936034       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216892936032       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216892936028       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216892935947       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216892936056       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216892936052       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216892936081       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 4.960747e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216892936034       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216892936034       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216892936033       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216892936027       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216892935952       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216892935645       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216892936029       residual = 9.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 1.240188e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.275842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5538e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680742e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902472e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1783
    reference variance = 0.129471
====================================================
  Execution time = 1.9810e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2671e-01
  Total weights = 2.0000e+06
  Execution time = 1.8252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797392717
                                         uncertainty =       0.005752409003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797392717
                                         uncertainty =       0.005752409003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404174489
  error estimate for blocks of size 2^( 2) =       0.000413777802
  error estimate for blocks of size 2^( 3) =       0.000422751055
  error estimate for blocks of size 2^( 4) =       0.000429384416
  error estimate for blocks of size 2^( 5) =       0.000433405093
  error estimate for blocks of size 2^( 6) =       0.000435062015
  error estimate for blocks of size 2^( 7) =       0.000434666992

      target function =                  N/A
              le_mean =     -17.216547391990
             les_mean =     296.736217972368
             stat err =       0.000433129629
             autocorr =       1.148412712426
              std dev =       0.571589043874
             le_variance =       0.326714035077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797396478
                                         uncertainty =       0.005752408991

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797396478
                                         uncertainty =       0.005752408991

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404174491
  error estimate for blocks of size 2^( 2) =       0.000413777805
  error estimate for blocks of size 2^( 3) =       0.000422751057
  error estimate for blocks of size 2^( 4) =       0.000429384418
  error estimate for blocks of size 2^( 5) =       0.000433405095
  error estimate for blocks of size 2^( 6) =       0.000435062016
  error estimate for blocks of size 2^( 7) =       0.000434666994

      target function =                  N/A
              le_mean =     -17.216547391971
             les_mean =     296.736217975470
             stat err =       0.000433129631
             autocorr =       1.148412707970
              std dev =       0.571589047164
             le_variance =       0.326714038838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797394597
                                         uncertainty =       0.005752408997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797394597
                                         uncertainty =       0.005752408997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404174490
  error estimate for blocks of size 2^( 2) =       0.000413777803
  error estimate for blocks of size 2^( 3) =       0.000422751056
  error estimate for blocks of size 2^( 4) =       0.000429384417
  error estimate for blocks of size 2^( 5) =       0.000433405094
  error estimate for blocks of size 2^( 6) =       0.000435062016
  error estimate for blocks of size 2^( 7) =       0.000434666993

      target function =                  N/A
              le_mean =     -17.216547391981
             les_mean =     296.736217973919
             stat err =       0.000433129630
             autocorr =       1.148412710193
              std dev =       0.571589045519
             le_variance =       0.326714036957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797392952
                                         uncertainty =       0.005752409002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326797392952
                                         uncertainty =       0.005752409002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404174489
  error estimate for blocks of size 2^( 2) =       0.000413777803
  error estimate for blocks of size 2^( 3) =       0.000422751055
  error estimate for blocks of size 2^( 4) =       0.000429384417
  error estimate for blocks of size 2^( 5) =       0.000433405093
  error estimate for blocks of size 2^( 6) =       0.000435062015
  error estimate for blocks of size 2^( 7) =       0.000434666992

      target function =                  N/A
              le_mean =     -17.216547391989
             les_mean =     296.736217972562
             stat err =       0.000433129629
             autocorr =       1.148412712138
              std dev =       0.571589044080
             le_variance =       0.326714035312


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216547391990        initial  <--
     3.6380e+04     3.6380e+05             1.9843e-08       -17.216547391971
     1.4552e+05     1.4552e+06             4.9607e-09       -17.216547391981
     5.8208e+05     5.8208e+06             1.2402e-09       -17.216547391989

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0354
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4580e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1891
    reference variance = 0.211605
====================================================
  Execution time = 1.9829e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1650e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316384236704
                                         uncertainty =       0.003093755044

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316384236704
                                         uncertainty =       0.003093755044

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397807732
  error estimate for blocks of size 2^( 2) =       0.000407723539
  error estimate for blocks of size 2^( 3) =       0.000416027683
  error estimate for blocks of size 2^( 4) =       0.000422256214
  error estimate for blocks of size 2^( 5) =       0.000426742241
  error estimate for blocks of size 2^( 6) =       0.000428244302
  error estimate for blocks of size 2^( 7) =       0.000428054039

      target function =                  N/A
              le_mean =     -17.216963394545
             les_mean =     296.740330353985
             stat err =       0.000426324199
             autocorr =       1.148506691090
              std dev =       0.562585089673
             le_variance =       0.316501983122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721696339455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963394545       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216963394545       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216963394548       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216963394549       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216963394662       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216963394491       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216963394658       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 2.090361e-09

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963394545       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216963394545       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216963394546       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216963394043       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216963394547       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216963394574       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216963394530       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 5.225903e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963394545       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216963394545       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216963394546       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216963394546       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216963393606       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216963388688       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216963392773       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 1.306476e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278138 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5356e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1268
    reference variance = 0.37606
====================================================
  Execution time = 1.9652e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1748e-01
  Total weights = 2.0000e+06
  Execution time = 1.8213e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579129
                                         uncertainty =       0.002875223016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579129
                                         uncertainty =       0.002875223016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422703
  error estimate for blocks of size 2^( 2) =       0.000408105258
  error estimate for blocks of size 2^( 3) =       0.000417168468
  error estimate for blocks of size 2^( 4) =       0.000423673845
  error estimate for blocks of size 2^( 5) =       0.000428112912
  error estimate for blocks of size 2^( 6) =       0.000430317728
  error estimate for blocks of size 2^( 7) =       0.000431999649

      target function =                  N/A
              le_mean =     -17.216946694012
             les_mean =     296.740734606878
             stat err =       0.000428526033
             autocorr =       1.156821270386
              std dev =       0.563454790706
             le_variance =       0.317481301170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579896
                                         uncertainty =       0.002875223020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579896
                                         uncertainty =       0.002875223020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422704
  error estimate for blocks of size 2^( 2) =       0.000408105258
  error estimate for blocks of size 2^( 3) =       0.000417168468
  error estimate for blocks of size 2^( 4) =       0.000423673845
  error estimate for blocks of size 2^( 5) =       0.000428112912
  error estimate for blocks of size 2^( 6) =       0.000430317728
  error estimate for blocks of size 2^( 7) =       0.000431999649

      target function =                  N/A
              le_mean =     -17.216946694008
             les_mean =     296.740734607512
             stat err =       0.000428526034
             autocorr =       1.156821269797
              std dev =       0.563454791388
             le_variance =       0.317481301938

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579513
                                         uncertainty =       0.002875223018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579513
                                         uncertainty =       0.002875223018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422704
  error estimate for blocks of size 2^( 2) =       0.000408105258
  error estimate for blocks of size 2^( 3) =       0.000417168468
  error estimate for blocks of size 2^( 4) =       0.000423673845
  error estimate for blocks of size 2^( 5) =       0.000428112912
  error estimate for blocks of size 2^( 6) =       0.000430317728
  error estimate for blocks of size 2^( 7) =       0.000431999649

      target function =                  N/A
              le_mean =     -17.216946694010
             les_mean =     296.740734607195
             stat err =       0.000428526033
             autocorr =       1.156821270091
              std dev =       0.563454791047
             le_variance =       0.317481301554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579177
                                         uncertainty =       0.002875223016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317163579177
                                         uncertainty =       0.002875223016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398422703
  error estimate for blocks of size 2^( 2) =       0.000408105258
  error estimate for blocks of size 2^( 3) =       0.000417168468
  error estimate for blocks of size 2^( 4) =       0.000423673845
  error estimate for blocks of size 2^( 5) =       0.000428112912
  error estimate for blocks of size 2^( 6) =       0.000430317728
  error estimate for blocks of size 2^( 7) =       0.000431999649

      target function =                  N/A
              le_mean =     -17.216946694012
             les_mean =     296.740734606918
             stat err =       0.000428526033
             autocorr =       1.156821270362
              std dev =       0.563454790749
             le_variance =       0.317481301218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216946694012        initial  <--
     3.6380e+05     3.6380e+06             2.0904e-09       -17.216946694008
     1.4552e+06     1.4552e+07             5.2259e-10       -17.216946694010
     5.8208e+06     5.8208e+07             1.3065e-10       -17.216946694012

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8594
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4222e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2457
    reference variance = 0.494289
====================================================
  Execution time = 1.9841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1207e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4937e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312099089212
                                         uncertainty =       0.002661817419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312099089212
                                         uncertainty =       0.002661817419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395015639
  error estimate for blocks of size 2^( 2) =       0.000404706915
  error estimate for blocks of size 2^( 3) =       0.000413294427
  error estimate for blocks of size 2^( 4) =       0.000419655919
  error estimate for blocks of size 2^( 5) =       0.000423524182
  error estimate for blocks of size 2^( 6) =       0.000425676290
  error estimate for blocks of size 2^( 7) =       0.000425380557

      target function =                  N/A
              le_mean =     -17.216776806346
             les_mean =     296.729478153087
             stat err =       0.000423559237
             autocorr =       1.149740250607
              std dev =       0.558636473572
             le_variance =       0.312074709605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677680635e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776806346       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776806346       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776806346       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776806346       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776806346       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776806346       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776807058       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.979530e-10

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776806346       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776806346       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776806346       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776811642       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776807525       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776804271       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776804009       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 4.948824e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216776806346       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216776806346       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216776806346       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216776833981       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216776806346       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216776845238       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216776780388       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 1.237191e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280427 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5345e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2184
    reference variance = 0.307251
====================================================
  Execution time = 1.9653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3127e-01
  Total weights = 2.0000e+06
  Execution time = 1.8246e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364322
                                         uncertainty =       0.021873379487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364322
                                         uncertainty =       0.021873379487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406984683
  error estimate for blocks of size 2^( 2) =       0.000416340186
  error estimate for blocks of size 2^( 3) =       0.000424935244
  error estimate for blocks of size 2^( 4) =       0.000431700336
  error estimate for blocks of size 2^( 5) =       0.000435836503
  error estimate for blocks of size 2^( 6) =       0.000438481739
  error estimate for blocks of size 2^( 7) =       0.000439226186

      target function =                  N/A
              le_mean =     -17.217047821796
             les_mean =     296.758008597088
             stat err =       0.000436311191
             autocorr =       1.149308383069
              std dev =       0.575563258643
             le_variance =       0.331273064700

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364375
                                         uncertainty =       0.021873379491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364375
                                         uncertainty =       0.021873379491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406984683
  error estimate for blocks of size 2^( 2) =       0.000416340187
  error estimate for blocks of size 2^( 3) =       0.000424935244
  error estimate for blocks of size 2^( 4) =       0.000431700336
  error estimate for blocks of size 2^( 5) =       0.000435836503
  error estimate for blocks of size 2^( 6) =       0.000438481739
  error estimate for blocks of size 2^( 7) =       0.000439226186

      target function =                  N/A
              le_mean =     -17.217047821796
             les_mean =     296.758008597142
             stat err =       0.000436311191
             autocorr =       1.149308383009
              std dev =       0.575563258689
             le_variance =       0.331273064753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364348
                                         uncertainty =       0.021873379489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364348
                                         uncertainty =       0.021873379489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406984683
  error estimate for blocks of size 2^( 2) =       0.000416340186
  error estimate for blocks of size 2^( 3) =       0.000424935244
  error estimate for blocks of size 2^( 4) =       0.000431700336
  error estimate for blocks of size 2^( 5) =       0.000435836503
  error estimate for blocks of size 2^( 6) =       0.000438481739
  error estimate for blocks of size 2^( 7) =       0.000439226186

      target function =                  N/A
              le_mean =     -17.217047821796
             les_mean =     296.758008597115
             stat err =       0.000436311191
             autocorr =       1.149308383046
              std dev =       0.575563258666
             le_variance =       0.331273064726

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364325
                                         uncertainty =       0.021873379487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331284364325
                                         uncertainty =       0.021873379487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406984683
  error estimate for blocks of size 2^( 2) =       0.000416340186
  error estimate for blocks of size 2^( 3) =       0.000424935244
  error estimate for blocks of size 2^( 4) =       0.000431700336
  error estimate for blocks of size 2^( 5) =       0.000435836503
  error estimate for blocks of size 2^( 6) =       0.000438481739
  error estimate for blocks of size 2^( 7) =       0.000439226186

      target function =                  N/A
              le_mean =     -17.217047821796
             les_mean =     296.758008597092
             stat err =       0.000436311191
             autocorr =       1.149308383052
              std dev =       0.575563258646
             le_variance =       0.331273064703


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217047821796        initial
     3.6380e+06     3.6380e+07             1.9795e-10       -17.217047821796  <--
     1.4552e+07     1.4552e+08             4.9488e-11       -17.217047821796
     5.8208e+07     5.8208e+08             1.2372e-11       -17.217047821796

*****************************************************************************
Applying the update for shift_i =   3.6380e+06     and shift_s =   3.6380e+07
*****************************************************************************

  Execution time = 3.1759e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.3095
    reference variance = 0.267414
====================================================
  Execution time = 1.9978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1710e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317170836959
                                         uncertainty =       0.003864466455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317170836959
                                         uncertainty =       0.003864466455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398180894
  error estimate for blocks of size 2^( 2) =       0.000407371091
  error estimate for blocks of size 2^( 3) =       0.000416201547
  error estimate for blocks of size 2^( 4) =       0.000423130152
  error estimate for blocks of size 2^( 5) =       0.000427401930
  error estimate for blocks of size 2^( 6) =       0.000429461007
  error estimate for blocks of size 2^( 7) =       0.000429873288

      target function =                  N/A
              le_mean =     -17.216430843228
             les_mean =     296.722586869405
             stat err =       0.000427466594
             autocorr =       1.152506883141
              std dev =       0.563112820235
             le_variance =       0.317096048313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721643084323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216430843228       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216430843229       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216430843230       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216430843229       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216430843103       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216430843220       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216430843516       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 7.178314e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216430843228       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216430843228       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216430843228       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216430843228       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216430844432       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216430841314       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216430844532       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.794579e-10

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216430843228       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216430843228       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216430843228       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216430843228       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216430935759       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216430851918       residual = 5.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216430867182       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 4.486371e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.282664 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5444e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2745
    reference variance = 0.316896
====================================================
  Execution time = 1.9712e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1622e-01
  Total weights = 2.0000e+06
  Execution time = 1.8190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401317
                                         uncertainty =       0.003711782751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401317
                                         uncertainty =       0.003711782751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630245
  error estimate for blocks of size 2^( 2) =       0.000407090649
  error estimate for blocks of size 2^( 3) =       0.000415859569
  error estimate for blocks of size 2^( 4) =       0.000422484886
  error estimate for blocks of size 2^( 5) =       0.000427213081
  error estimate for blocks of size 2^( 6) =       0.000428825213
  error estimate for blocks of size 2^( 7) =       0.000429618632

      target function =                  N/A
              le_mean =     -17.216432421801
             les_mean =     296.721764800157
             stat err =       0.000427035453
             autocorr =       1.153371039332
              std dev =       0.562334085594
             le_variance =       0.316219623821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401568
                                         uncertainty =       0.003711782755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401568
                                         uncertainty =       0.003711782755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630245
  error estimate for blocks of size 2^( 2) =       0.000407090649
  error estimate for blocks of size 2^( 3) =       0.000415859569
  error estimate for blocks of size 2^( 4) =       0.000422484886
  error estimate for blocks of size 2^( 5) =       0.000427213081
  error estimate for blocks of size 2^( 6) =       0.000428825213
  error estimate for blocks of size 2^( 7) =       0.000429618633

      target function =                  N/A
              le_mean =     -17.216432421801
             les_mean =     296.721764800403
             stat err =       0.000427035453
             autocorr =       1.153371039115
              std dev =       0.562334085817
             le_variance =       0.316219624072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401442
                                         uncertainty =       0.003711782753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401442
                                         uncertainty =       0.003711782753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630245
  error estimate for blocks of size 2^( 2) =       0.000407090649
  error estimate for blocks of size 2^( 3) =       0.000415859569
  error estimate for blocks of size 2^( 4) =       0.000422484886
  error estimate for blocks of size 2^( 5) =       0.000427213081
  error estimate for blocks of size 2^( 6) =       0.000428825213
  error estimate for blocks of size 2^( 7) =       0.000429618632

      target function =                  N/A
              le_mean =     -17.216432421801
             les_mean =     296.721764800280
             stat err =       0.000427035453
             autocorr =       1.153371039217
              std dev =       0.562334085705
             le_variance =       0.316219623946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401333
                                         uncertainty =       0.003711782751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316220401333
                                         uncertainty =       0.003711782751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397630245
  error estimate for blocks of size 2^( 2) =       0.000407090649
  error estimate for blocks of size 2^( 3) =       0.000415859569
  error estimate for blocks of size 2^( 4) =       0.000422484886
  error estimate for blocks of size 2^( 5) =       0.000427213081
  error estimate for blocks of size 2^( 6) =       0.000428825213
  error estimate for blocks of size 2^( 7) =       0.000429618632

      target function =                  N/A
              le_mean =     -17.216432421801
             les_mean =     296.721764800173
             stat err =       0.000427035453
             autocorr =       1.153371039315
              std dev =       0.562334085608
             le_variance =       0.316219623836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216432421801        initial  <--
     9.0949e+05     9.0949e+06             7.1783e-10       -17.216432421801
     3.6380e+06     3.6380e+07             1.7946e-10       -17.216432421801
     1.4552e+07     1.4552e+08             4.4864e-11       -17.216432421801

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9135
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.3703
    reference variance = 0.75396
====================================================
  Execution time = 2.0115e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4617e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342317449439
                                         uncertainty =       0.018405539487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342317449439
                                         uncertainty =       0.018405539487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413670822
  error estimate for blocks of size 2^( 2) =       0.000422730798
  error estimate for blocks of size 2^( 3) =       0.000431516673
  error estimate for blocks of size 2^( 4) =       0.000437555892
  error estimate for blocks of size 2^( 5) =       0.000441624919
  error estimate for blocks of size 2^( 6) =       0.000443611272
  error estimate for blocks of size 2^( 7) =       0.000442789845

      target function =                  N/A
              le_mean =     -17.217100042909
             les_mean =     296.770780813662
             stat err =       0.000441395482
             autocorr =       1.138533960848
              std dev =       0.585018886240
             le_variance =       0.342247097257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721710004291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217100042909       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217100042909       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217100042909       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217100065158       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217100011805       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217099988961       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217100045114       residual = 8.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 7.213713e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217100042909       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217100042909       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217100042909       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217100043213       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217100041369       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217100036695       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217100064913       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 1.803420e-11

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217100042909       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217100042909       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217100042909       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217100042909       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217100012064       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217100045670       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217100052681       residual = 8.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 4.508436e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5588e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.225711
====================================================
  Execution time = 1.9687e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2288e-01
  Total weights = 2.0000e+06
  Execution time = 1.8346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614518
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614518
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401794233
  error estimate for blocks of size 2^( 2) =       0.000411386202
  error estimate for blocks of size 2^( 3) =       0.000420172012
  error estimate for blocks of size 2^( 4) =       0.000426487406
  error estimate for blocks of size 2^( 5) =       0.000432052515
  error estimate for blocks of size 2^( 6) =       0.000435588836
  error estimate for blocks of size 2^( 7) =       0.000437836443

      target function =                  N/A
              le_mean =     -17.217099146787
             les_mean =     296.751380080261
             stat err =       0.000432991300
             autocorr =       1.161317425802
              std dev =       0.568222853640
             le_variance =       0.322877211399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614536
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614536
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401794233
  error estimate for blocks of size 2^( 2) =       0.000411386203
  error estimate for blocks of size 2^( 3) =       0.000420172012
  error estimate for blocks of size 2^( 4) =       0.000426487406
  error estimate for blocks of size 2^( 5) =       0.000432052515
  error estimate for blocks of size 2^( 6) =       0.000435588836
  error estimate for blocks of size 2^( 7) =       0.000437836443

      target function =                  N/A
              le_mean =     -17.217099146787
             les_mean =     296.751380080282
             stat err =       0.000432991300
             autocorr =       1.161317425785
              std dev =       0.568222853656
             le_variance =       0.322877211417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614527
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614527
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401794233
  error estimate for blocks of size 2^( 2) =       0.000411386203
  error estimate for blocks of size 2^( 3) =       0.000420172012
  error estimate for blocks of size 2^( 4) =       0.000426487406
  error estimate for blocks of size 2^( 5) =       0.000432052515
  error estimate for blocks of size 2^( 6) =       0.000435588836
  error estimate for blocks of size 2^( 7) =       0.000437836443

      target function =                  N/A
              le_mean =     -17.217099146787
             les_mean =     296.751380080271
             stat err =       0.000432991300
             autocorr =       1.161317425797
              std dev =       0.568222853648
             le_variance =       0.322877211408

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614519
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322955614519
                                         uncertainty =       0.005268819280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401794233
  error estimate for blocks of size 2^( 2) =       0.000411386203
  error estimate for blocks of size 2^( 3) =       0.000420172012
  error estimate for blocks of size 2^( 4) =       0.000426487406
  error estimate for blocks of size 2^( 5) =       0.000432052515
  error estimate for blocks of size 2^( 6) =       0.000435588836
  error estimate for blocks of size 2^( 7) =       0.000437836443

      target function =                  N/A
              le_mean =     -17.217099146787
             les_mean =     296.751380080262
             stat err =       0.000432991300
             autocorr =       1.161317425801
              std dev =       0.568222853641
             le_variance =       0.322877211400


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217099146787        initial
     9.0949e+06     9.0949e+07             7.2137e-11       -17.217099146787  <--
     3.6380e+07     3.6380e+08             1.8034e-11       -17.217099146787
     1.4552e+08     1.4552e+09             4.5084e-12       -17.217099146787

*****************************************************************************
Applying the update for shift_i =   9.0949e+06     and shift_s =   9.0949e+07
*****************************************************************************

  Execution time = 2.8916e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4510e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1684
    reference variance = 0.181703
====================================================
  Execution time = 1.9988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2119e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321096475222
                                         uncertainty =       0.006008776383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321096475222
                                         uncertainty =       0.006008776383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400742416
  error estimate for blocks of size 2^( 2) =       0.000410447991
  error estimate for blocks of size 2^( 3) =       0.000419845825
  error estimate for blocks of size 2^( 4) =       0.000426297641
  error estimate for blocks of size 2^( 5) =       0.000430742421
  error estimate for blocks of size 2^( 6) =       0.000432118512
  error estimate for blocks of size 2^( 7) =       0.000435069423

      target function =                  N/A
              le_mean =     -17.215736529166
             les_mean =     296.702773048888
             stat err =       0.000431057000
             autocorr =       1.157014439868
              std dev =       0.566735359606
             le_variance =       0.321188967827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721573652917e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215736529166       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215736529166       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215736529166       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215736529166       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215736529166       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215736528616       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215736529721       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+06 is 2.957577e-10

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215736529166       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215736529166       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215736529166       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215736531535       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215736534098       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215736528667       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215736531465       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 7.393937e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215736529166       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215736529166       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215736529166       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215736529166       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215736527524       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215736538787       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215736534855       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 1.848477e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5574e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2308
    reference variance = 0.366266
====================================================
  Execution time = 1.9844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2689e-01
  Total weights = 2.0000e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903404
                                         uncertainty =       0.013077101270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903404
                                         uncertainty =       0.013077101270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404282824
  error estimate for blocks of size 2^( 2) =       0.000414026622
  error estimate for blocks of size 2^( 3) =       0.000422185274
  error estimate for blocks of size 2^( 4) =       0.000428059432
  error estimate for blocks of size 2^( 5) =       0.000432690053
  error estimate for blocks of size 2^( 6) =       0.000435255539
  error estimate for blocks of size 2^( 7) =       0.000437542286

      target function =                  N/A
              le_mean =     -17.215956516208
             les_mean =     296.716047808102
             stat err =       0.000433386827
             autocorr =       1.149160878453
              std dev =       0.571742252755
             le_variance =       0.326889203586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903494
                                         uncertainty =       0.013077101271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903494
                                         uncertainty =       0.013077101271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404282824
  error estimate for blocks of size 2^( 2) =       0.000414026622
  error estimate for blocks of size 2^( 3) =       0.000422185274
  error estimate for blocks of size 2^( 4) =       0.000428059432
  error estimate for blocks of size 2^( 5) =       0.000432690053
  error estimate for blocks of size 2^( 6) =       0.000435255539
  error estimate for blocks of size 2^( 7) =       0.000437542286

      target function =                  N/A
              le_mean =     -17.215956516208
             les_mean =     296.716047808194
             stat err =       0.000433386827
             autocorr =       1.149160878382
              std dev =       0.571742252834
             le_variance =       0.326889203675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903449
                                         uncertainty =       0.013077101270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903449
                                         uncertainty =       0.013077101270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404282824
  error estimate for blocks of size 2^( 2) =       0.000414026622
  error estimate for blocks of size 2^( 3) =       0.000422185274
  error estimate for blocks of size 2^( 4) =       0.000428059432
  error estimate for blocks of size 2^( 5) =       0.000432690053
  error estimate for blocks of size 2^( 6) =       0.000435255539
  error estimate for blocks of size 2^( 7) =       0.000437542286

      target function =                  N/A
              le_mean =     -17.215956516208
             les_mean =     296.716047808148
             stat err =       0.000433386827
             autocorr =       1.149160878414
              std dev =       0.571742252795
             le_variance =       0.326889203631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903410
                                         uncertainty =       0.013077101270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326945903410
                                         uncertainty =       0.013077101270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404282824
  error estimate for blocks of size 2^( 2) =       0.000414026622
  error estimate for blocks of size 2^( 3) =       0.000422185274
  error estimate for blocks of size 2^( 4) =       0.000428059432
  error estimate for blocks of size 2^( 5) =       0.000432690053
  error estimate for blocks of size 2^( 6) =       0.000435255539
  error estimate for blocks of size 2^( 7) =       0.000437542286

      target function =                  N/A
              le_mean =     -17.215956516208
             les_mean =     296.716047808108
             stat err =       0.000433386827
             autocorr =       1.149160878453
              std dev =       0.571742252760
             le_variance =       0.326889203591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215956516208        initial
     2.2737e+06     2.2737e+07             2.9576e-10       -17.215956516208  <--
     9.0949e+06     9.0949e+07             7.3939e-11       -17.215956516208
     3.6380e+07     3.6380e+08             1.8485e-11       -17.215956516208

*****************************************************************************
Applying the update for shift_i =   2.2737e+06     and shift_s =   2.2737e+07
*****************************************************************************

  Execution time = 2.9071e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 2.100513e-01 1 1  ON 0
 uu_1                 4.820897e-02 1 1  ON 1
 uu_2                -4.606310e-02 1 1  ON 2
 uu_3                -1.002730e-01 1 1  ON 3
 uu_4                -1.325333e-01 1 1  ON 4
 uu_5                -1.381545e-01 1 1  ON 5
 uu_6                -1.144818e-01 1 1  ON 6
 uu_7                -4.094574e-02 1 1  ON 7
 uu_8                 9.776292e-02 1 1  ON 8
 uu_9                 1.219078e-01 1 1  ON 9
 ud_0                 3.514223e-01 1 1  ON 10
 ud_1                 9.312156e-02 1 1  ON 11
 ud_2                -1.604977e-02 1 1  ON 12
 ud_3                -7.626548e-02 1 1  ON 13
 ud_4                -1.227748e-01 1 1  ON 14
 ud_5                -1.533195e-01 1 1  ON 15
 ud_6                -1.546717e-01 1 1  ON 16
 ud_7                -1.101606e-01 1 1  ON 17
 ud_8                 1.680743e-03 1 1  ON 18
 ud_9                 9.256645e-02 1 1  ON 19
 eO_0                -7.629658e-01 1 1  ON 20
 eO_1                -4.445708e-01 1 1  ON 21
 eO_2                -3.902471e-02 1 1  ON 22
 eO_3                 2.113745e-01 1 1  ON 23
 eO_4                 2.990418e-01 1 1  ON 24
 eO_5                 3.107366e-01 1 1  ON 25
 eO_6                 2.526629e-01 1 1  ON 26
 eO_7                 1.150693e-01 1 1  ON 27
 eO_8                 2.822412e-02 1 1  ON 28
 eO_9                 1.860304e-02 1 1  ON 29
eH1_0                -1.828548e-01 1 1  ON 30
eH1_1                -1.035497e-01 1 1  ON 31
eH1_2                -6.256629e-02 1 1  ON 32
eH1_3                -2.592155e-02 1 1  ON 33
eH1_4                 1.969691e-02 1 1  ON 34
eH1_5                 3.542760e-02 1 1  ON 35
eH1_6                 7.789508e-02 1 1  ON 36
eH1_7                 1.094608e-01 1 1  ON 37
eH1_8                 9.213786e-02 1 1  ON 38
eH1_9                 2.473179e-02 1 1  ON 39
eH2_0                -1.836428e-01 1 1  ON 40
eH2_1                -1.045891e-01 1 1  ON 41
eH2_2                -6.373197e-02 1 1  ON 42
eH2_3                -2.692679e-02 1 1  ON 43
eH2_4                 1.838381e-02 1 1  ON 44
eH2_5                 3.429284e-02 1 1  ON 45
eH2_6                 7.897783e-02 1 1  ON 46
eH2_7                 1.129396e-01 1 1  ON 47
eH2_8                 9.508193e-02 1 1  ON 48
eH2_9                 2.689116e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4651e+01 secs
  Total Execution time = 2.2052e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
