Rank =    0  Free Memory = 90363 MB
Rank =    1  Free Memory = 90363 MB
Rank =    2  Free Memory = 90363 MB
Rank =    3  Free Memory = 90363 MB
Rank =    4  Free Memory = 90363 MB
Rank =    5  Free Memory = 90363 MB
Rank =    6  Free Memory = 90363 MB
Rank =    7  Free Memory = 90363 MB
Rank =    8  Free Memory = 90363 MB
Rank =    9  Free Memory = 90363 MB
Rank =   10  Free Memory = 90363 MB
Rank =   11  Free Memory = 90363 MB
Rank =   12  Free Memory = 90362 MB
Rank =   13  Free Memory = 90362 MB
Rank =   14  Free Memory = 90362 MB
Rank =   15  Free Memory = 90348 MB
Rank =   16  Free Memory = 90348 MB
Rank =   17  Free Memory = 90348 MB
Rank =   18  Free Memory = 90348 MB
Rank =   19  Free Memory = 90348 MB
Rank =   20  Free Memory = 90348 MB
Rank =   21  Free Memory = 90348 MB
Rank =   22  Free Memory = 90348 MB
Rank =   23  Free Memory = 90348 MB
Rank =   24  Free Memory = 90348 MB
Rank =   25  Free Memory = 90348 MB
Rank =   26  Free Memory = 90348 MB
Rank =   27  Free Memory = 90348 MB
Rank =   28  Free Memory = 90348 MB
Rank =   29  Free Memory = 90348 MB
Rank =   30  Free Memory = 90348 MB
Rank =   31  Free Memory = 90348 MB
Rank =   32  Free Memory = 90832 MB
Rank =   33  Free Memory = 90832 MB
Rank =   34  Free Memory = 90832 MB
Rank =   35  Free Memory = 90832 MB
Rank =   36  Free Memory = 90832 MB
Rank =   37  Free Memory = 90832 MB
Rank =   38  Free Memory = 90832 MB
Rank =   39  Free Memory = 90832 MB
Rank =   40  Free Memory = 90832 MB
Rank =   41  Free Memory = 90832 MB
Rank =   42  Free Memory = 90832 MB
Rank =   43  Free Memory = 90832 MB
Rank =   44  Free Memory = 90832 MB
Rank =   45  Free Memory = 90831 MB
Rank =   46  Free Memory = 90831 MB
Rank =   47  Free Memory = 90831 MB
Rank =   48  Free Memory = 90831 MB
Rank =   49  Free Memory = 90831 MB
Rank =   50  Free Memory = 90831 MB
Rank =   51  Free Memory = 90831 MB
Rank =   52  Free Memory = 90831 MB
Rank =   53  Free Memory = 90831 MB
Rank =   54  Free Memory = 90831 MB
Rank =   55  Free Memory = 90831 MB
Rank =   56  Free Memory = 90831 MB
Rank =   57  Free Memory = 90831 MB
Rank =   58  Free Memory = 90831 MB
Rank =   59  Free Memory = 90831 MB
Rank =   60  Free Memory = 90831 MB
Rank =   61  Free Memory = 90831 MB
Rank =   62  Free Memory = 90831 MB
Rank =   63  Free Memory = 90831 MB
Rank =   64  Free Memory = 90749 MB
Rank =   65  Free Memory = 90749 MB
Rank =   66  Free Memory = 90749 MB
Rank =   67  Free Memory = 90749 MB
Rank =   68  Free Memory = 90749 MB
Rank =   69  Free Memory = 90748 MB
Rank =   70  Free Memory = 90748 MB
Rank =   71  Free Memory = 90748 MB
Rank =   72  Free Memory = 90748 MB
Rank =   73  Free Memory = 90748 MB
Rank =   74  Free Memory = 90748 MB
Rank =   75  Free Memory = 90748 MB
Rank =   76  Free Memory = 90748 MB
Rank =   77  Free Memory = 90748 MB
Rank =   78  Free Memory = 90748 MB
Rank =   79  Free Memory = 90748 MB
Rank =   80  Free Memory = 90748 MB
Rank =   81  Free Memory = 90748 MB
Rank =   82  Free Memory = 90748 MB
Rank =   83  Free Memory = 90748 MB
Rank =   84  Free Memory = 90748 MB
Rank =   85  Free Memory = 90748 MB
Rank =   86  Free Memory = 90748 MB
Rank =   87  Free Memory = 90748 MB
Rank =   88  Free Memory = 90748 MB
Rank =   89  Free Memory = 90748 MB
Rank =   90  Free Memory = 90747 MB
Rank =   91  Free Memory = 90747 MB
Rank =   92  Free Memory = 90747 MB
Rank =   93  Free Memory = 90747 MB
Rank =   94  Free Memory = 90747 MB
Rank =   95  Free Memory = 90747 MB
Rank =   96  Free Memory = 90326 MB
Rank =   97  Free Memory = 90326 MB
Rank =   98  Free Memory = 90326 MB
Rank =   99  Free Memory = 90326 MB
Rank =  100  Free Memory = 90326 MB
Rank =  101  Free Memory = 90326 MB
Rank =  102  Free Memory = 90326 MB
Rank =  103  Free Memory = 90326 MB
Rank =  104  Free Memory = 90326 MB
Rank =  105  Free Memory = 90326 MB
Rank =  106  Free Memory = 90326 MB
Rank =  107  Free Memory = 90326 MB
Rank =  108  Free Memory = 90326 MB
Rank =  109  Free Memory = 90326 MB
Rank =  110  Free Memory = 90326 MB
Rank =  111  Free Memory = 90326 MB
Rank =  112  Free Memory = 90326 MB
Rank =  113  Free Memory = 90326 MB
Rank =  114  Free Memory = 90326 MB
Rank =  115  Free Memory = 90326 MB
Rank =  116  Free Memory = 90326 MB
Rank =  117  Free Memory = 90326 MB
Rank =  118  Free Memory = 90326 MB
Rank =  119  Free Memory = 90326 MB
Rank =  120  Free Memory = 90326 MB
Rank =  121  Free Memory = 90326 MB
Rank =  122  Free Memory = 90326 MB
Rank =  123  Free Memory = 90326 MB
Rank =  124  Free Memory = 90326 MB
Rank =  125  Free Memory = 90326 MB
Rank =  126  Free Memory = 90326 MB
Rank =  127  Free Memory = 90326 MB
  Input file(s): opt_h2o_gs_lmtt_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_lmtt_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:33:09 PST
  host    = n0018.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 981

  Range of prime numbers to use as seeds over processors and threads = 7753-8933


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.906895e-01    1         1  ON     0
     uu_1                 2.901761e-02    1         1  ON     1
     uu_2                -6.453992e-02    1         1  ON     2
     uu_3                -1.201449e-01    1         1  ON     3
     uu_4                -1.562723e-01    1         1  ON     4
     uu_5                -1.683375e-01    1         1  ON     5
     uu_6                -1.559905e-01    1         1  ON     6
     uu_7                -1.088719e-01    1         1  ON     7
     uu_8                -3.891836e-02    1         1  ON     8
     uu_9                 2.015996e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.486549e-01    1         1  ON     0
     ud_1                 9.358715e-02    1         1  ON     1
     ud_2                -1.121615e-02    1         1  ON     2
     ud_3                -7.116190e-02    1         1  ON     3
     ud_4                -1.230197e-01    1         1  ON     4
     ud_5                -1.633831e-01    1         1  ON     5
     ud_6                -1.786205e-01    1         1  ON     6
     ud_7                -1.585333e-01    1         1  ON     7
     ud_8                -1.109298e-01    1         1  ON     8
     ud_9                 3.267570e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -9.078755e-01    1         1  ON     0
     eO_1                -5.925756e-01    1         1  ON     1
     eO_2                -1.894135e-01    1         1  ON     2
     eO_3                 7.676001e-02    1         1  ON     3
     eO_4                 2.047135e-01    1         1  ON     4
     eO_5                 2.984119e-01    1         1  ON     5
     eO_6                 3.262834e-01    1         1  ON     6
     eO_7                 5.333091e-01    1         1  ON     7
     eO_8                 1.579161e-01    1         1  ON     8
     eO_9                 5.325131e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.212969e-01    1         1  ON     0
     eH1_1                -1.428992e-01    1         1  ON     1
     eH1_2                -1.020656e-01    1         1  ON     2
     eH1_3                -6.514821e-02    1         1  ON     3
     eH1_4                -1.850932e-02    1         1  ON     4
     eH1_5                -5.103686e-03    1         1  ON     5
     eH1_6                 3.556808e-02    1         1  ON     6
     eH1_7                 7.987248e-02    1         1  ON     7
     eH1_8                 2.645728e-01    1         1  ON     8
     eH1_9                 1.134826e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.099891e-01    1         1  ON     0
     eH2_1                -1.315924e-01    1         1  ON     1
     eH2_2                -9.070219e-02    1         1  ON     2
     eH2_3                -5.365062e-02    1         1  ON     3
     eH2_4                -7.142172e-03    1         1  ON     4
     eH2_5                 5.466077e-03    1         1  ON     5
     eH2_6                 4.814681e-02    1         1  ON     6
     eH2_7                 3.881478e-02    1         1  ON     7
     eH2_8                 2.481921e-01    1         1  ON     8
     eH2_9                 1.153591e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.711083e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.8469e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1973
    reference variance = 0.214799
====================================================
  Execution time = 2.1639e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.0972e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309677808054
                                         uncertainty =       0.002888283788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309677808054
                                         uncertainty =       0.002888283788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393521143
  error estimate for blocks of size 2^( 2) =       0.000403289309
  error estimate for blocks of size 2^( 3) =       0.000411740834
  error estimate for blocks of size 2^( 4) =       0.000418072050
  error estimate for blocks of size 2^( 5) =       0.000421363244
  error estimate for blocks of size 2^( 6) =       0.000423070239
  error estimate for blocks of size 2^( 7) =       0.000426251087

      target function =                  N/A
              le_mean =     -17.216963412837
             les_mean =     296.733546784490
             stat err =       0.000422189155
             autocorr =       1.151007102828
              std dev =       0.556522937876
             le_variance =       0.309717780383


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721696341284e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963412837       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216985530906       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216988258690       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216999381049       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217008470553       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217009840320       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217013761630       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217013476754       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217012691421       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217012928266       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217012904147       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.942425e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963412837       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216973053482       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216974158930       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216977698603       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216981141483       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216982251045       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216982922090       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216982674393       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216982687866       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 9.899997e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216963412837       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216966373254       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216966728604       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216967694050       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216968520480       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216968975046       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216969025102       residual = 9.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216968992538       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216969002474       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.737458e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7293e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.906932e-01                 1 1 ON  0
uu_1  2.901597e-02                 1 1 ON  1
uu_2  -6.464066e-02                1 1 ON  2
uu_3  -1.202007e-01                1 1 ON  3
uu_4  -1.561763e-01                1 1 ON  4
uu_5  -1.682669e-01                1 1 ON  5
uu_6  -1.559533e-01                1 1 ON  6
uu_7  -1.088958e-01                1 1 ON  7
uu_8  -3.892558e-02                1 1 ON  8
uu_9  2.015669e-01                 1 1 ON  9
ud_0  3.494903e-01                 1 1 ON  10
ud_1  9.412415e-02                 1 1 ON  11
ud_2  -1.177097e-02                1 1 ON  12
ud_3  -7.172289e-02                1 1 ON  13
ud_4  -1.232742e-01                1 1 ON  14
ud_5  -1.632688e-01                1 1 ON  15
ud_6  -1.786235e-01                1 1 ON  16
ud_7  -1.585802e-01                1 1 ON  17
ud_8  -1.109592e-01                1 1 ON  18
ud_9  3.263511e-02                 1 1 ON  19
eO_0  -9.088655e-01                1 1 ON  20
eO_1  -5.928904e-01                1 1 ON  21
eO_2  -1.885183e-01                1 1 ON  22
eO_3  7.739535e-02                 1 1 ON  23
eO_4  2.046462e-01                 1 1 ON  24
eO_5  2.982799e-01                 1 1 ON  25
eO_6  3.262776e-01                 1 1 ON  26
eO_7  5.332749e-01                 1 1 ON  27
eO_8  1.579269e-01                 1 1 ON  28
eO_9  5.325402e-02                 1 1 ON  29
eH1_0 -2.214034e-01                1 1 ON  30
eH1_1 -1.429007e-01                1 1 ON  31
eH1_2 -1.020833e-01                1 1 ON  32
eH1_3 -6.505544e-02                1 1 ON  33
eH1_4 -1.841560e-02                1 1 ON  34
eH1_5 -5.043793e-03                1 1 ON  35
eH1_6 3.554919e-02                 1 1 ON  36
eH1_7 7.979571e-02                 1 1 ON  37
eH1_8 2.645456e-01                 1 1 ON  38
eH1_9 1.134836e-01                 1 1 ON  39
eH2_0 -2.100663e-01                1 1 ON  40
eH2_1 -1.315747e-01                1 1 ON  41
eH2_2 -9.069573e-02                1 1 ON  42
eH2_3 -5.353549e-02                1 1 ON  43
eH2_4 -7.005650e-03                1 1 ON  44
eH2_5 5.357395e-03                 1 1 ON  45
eH2_6 4.805985e-02                 1 1 ON  46
eH2_7 3.882964e-02                 1 1 ON  47
eH2_8 2.481700e-01                 1 1 ON  48
eH2_9 1.153602e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2073
    reference variance = 0.248056
====================================================
  Execution time = 2.2129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1673e-01
  Total weights = 2.0000e+06
  Execution time = 1.8374e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316083380436
                                         uncertainty =       0.005093682380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316083380436
                                         uncertainty =       0.005093682380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397496121
  error estimate for blocks of size 2^( 2) =       0.000407016920
  error estimate for blocks of size 2^( 3) =       0.000415447789
  error estimate for blocks of size 2^( 4) =       0.000420837897
  error estimate for blocks of size 2^( 5) =       0.000424742899
  error estimate for blocks of size 2^( 6) =       0.000427224923
  error estimate for blocks of size 2^( 7) =       0.000429472729

      target function =                  N/A
              le_mean =     -17.217306337585
             les_mean =     296.751643696629
             stat err =       0.000425569612
             autocorr =       1.146239655730
              std dev =       0.562144405292
             le_variance =       0.316006332401

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318051360834
                                         uncertainty =       0.005123138757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318051360834
                                         uncertainty =       0.005123138757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398731575
  error estimate for blocks of size 2^( 2) =       0.000408157956
  error estimate for blocks of size 2^( 3) =       0.000416500391
  error estimate for blocks of size 2^( 4) =       0.000421843114
  error estimate for blocks of size 2^( 5) =       0.000425733368
  error estimate for blocks of size 2^( 6) =       0.000428190511
  error estimate for blocks of size 2^( 7) =       0.000430413838

      target function =                  N/A
              le_mean =     -17.217315592708
             les_mean =     296.753929798037
             stat err =       0.000426545208
             autocorr =       1.144376358509
              std dev =       0.563891601400
             le_variance =       0.317973738129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317583071316
                                         uncertainty =       0.005118221659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317583071316
                                         uncertainty =       0.005118221659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398437982
  error estimate for blocks of size 2^( 2) =       0.000407881693
  error estimate for blocks of size 2^( 3) =       0.000416240067
  error estimate for blocks of size 2^( 4) =       0.000421592710
  error estimate for blocks of size 2^( 5) =       0.000425490903
  error estimate for blocks of size 2^( 6) =       0.000427951285
  error estimate for blocks of size 2^( 7) =       0.000430185148

      target function =                  N/A
              le_mean =     -17.217310866577
             les_mean =     296.753298968746
             stat err =       0.000426305012
             autocorr =       1.144773091352
              std dev =       0.563476398045
             le_variance =       0.317505651154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316288756834
                                         uncertainty =       0.005097479117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316288756834
                                         uncertainty =       0.005097479117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397625240
  error estimate for blocks of size 2^( 2) =       0.000407133749
  error estimate for blocks of size 2^( 3) =       0.000415553117
  error estimate for blocks of size 2^( 4) =       0.000420937476
  error estimate for blocks of size 2^( 5) =       0.000424841878
  error estimate for blocks of size 2^( 6) =       0.000427320434
  error estimate for blocks of size 2^( 7) =       0.000429566712

      target function =                  N/A
              le_mean =     -17.217305229086
             les_mean =     296.751810856070
             stat err =       0.000425666625
             autocorr =       1.146017665035
              std dev =       0.562327006870
             le_variance =       0.316211662655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217306337585        initial
     2.5000e-01     2.5000e+00             2.9424e-03       -17.217315592708  <--
     1.0000e+00     1.0000e+01             9.9000e-04       -17.217310866577
     4.0000e+00     4.0000e+01             2.7375e-04       -17.217305229086

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.1427e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.908276e-01 1 1  ON 0
 uu_1                 2.903605e-02 1 1  ON 1
 uu_2                -6.478607e-02 1 1  ON 2
 uu_3                -1.203560e-01 1 1  ON 3
 uu_4                -1.561378e-01 1 1  ON 4
 uu_5                -1.681687e-01 1 1  ON 5
 uu_6                -1.558313e-01 1 1  ON 6
 uu_7                -1.089421e-01 1 1  ON 7
 uu_8                -3.893951e-02 1 1  ON 8
 uu_9                 2.014711e-01 1 1  ON 9
 ud_0                 3.508965e-01 1 1  ON 10
 ud_1                 9.479818e-02 1 1  ON 11
 ud_2                -1.235800e-02 1 1  ON 12
 ud_3                -7.271775e-02 1 1  ON 13
 ud_4                -1.238777e-01 1 1  ON 14
 ud_5                -1.631000e-01 1 1  ON 15
 ud_6                -1.784684e-01 1 1  ON 16
 ud_7                -1.586265e-01 1 1  ON 17
 ud_8                -1.110261e-01 1 1  ON 18
 ud_9                 3.251816e-02 1 1  ON 19
 eO_0                -9.108180e-01 1 1  ON 20
 eO_1                -5.935564e-01 1 1  ON 21
 eO_2                -1.871864e-01 1 1  ON 22
 eO_3                 7.892572e-02 1 1  ON 23
 eO_4                 2.047432e-01 1 1  ON 24
 eO_5                 2.979901e-01 1 1  ON 25
 eO_6                 3.262806e-01 1 1  ON 26
 eO_7                 5.331793e-01 1 1  ON 27
 eO_8                 1.579598e-01 1 1  ON 28
 eO_9                 5.326225e-02 1 1  ON 29
eH1_0                -2.216504e-01 1 1  ON 30
eH1_1                -1.429609e-01 1 1  ON 31
eH1_2                -1.020358e-01 1 1  ON 32
eH1_3                -6.489736e-02 1 1  ON 33
eH1_4                -1.826502e-02 1 1  ON 34
eH1_5                -4.817437e-03 1 1  ON 35
eH1_6                 3.555681e-02 1 1  ON 36
eH1_7                 7.958332e-02 1 1  ON 37
eH1_8                 2.644677e-01 1 1  ON 38
eH1_9                 1.134871e-01 1 1  ON 39
eH2_0                -2.102321e-01 1 1  ON 40
eH2_1                -1.315965e-01 1 1  ON 41
eH2_2                -9.059018e-02 1 1  ON 42
eH2_3                -5.331420e-02 1 1  ON 43
eH2_4                -6.767788e-03 1 1  ON 44
eH2_5                 5.167611e-03 1 1  ON 45
eH2_6                 4.786698e-02 1 1  ON 46
eH2_7                 3.888444e-02 1 1  ON 47
eH2_8                 2.481069e-01 1 1  ON 48
eH2_9                 1.153639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8726e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1924
    reference variance = 0.267969
====================================================
  Execution time = 2.0235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2119e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321328545467
                                         uncertainty =       0.008284986681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321328545467
                                         uncertainty =       0.008284986681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400741564
  error estimate for blocks of size 2^( 2) =       0.000410312678
  error estimate for blocks of size 2^( 3) =       0.000419295040
  error estimate for blocks of size 2^( 4) =       0.000425655879
  error estimate for blocks of size 2^( 5) =       0.000429626889
  error estimate for blocks of size 2^( 6) =       0.000431930154
  error estimate for blocks of size 2^( 7) =       0.000432902803

      target function =                  N/A
              le_mean =     -17.216728601454
             les_mean =     296.736931177060
             stat err =       0.000430028931
             autocorr =       1.151506974975
              std dev =       0.566734154195
             le_variance =       0.321187601531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672860145e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216728601454       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216733509794       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216733657744       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216738908444       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216746292726       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216743850176       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216742934364       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216741079179       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216740723583       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216741683494       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216741924355       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.216741478095       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -17.216741458489       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.275571e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216728601454       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216731818421       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216731928207       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216733704415       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216738965115       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216737702600       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216737360008       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216736272839       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216736444755       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216736502330       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.834303e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216728601454       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216729954049       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216730048021       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216730293418       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216732348533       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216732032158       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216732013072       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216731675479       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216731694638       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.964936e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5816e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.911227e-01 1 1  ON 0
 uu_1                 2.904714e-02 1 1  ON 1
 uu_2                -6.497279e-02 1 1  ON 2
 uu_3                -1.205171e-01 1 1  ON 3
 uu_4                -1.561237e-01 1 1  ON 4
 uu_5                -1.679657e-01 1 1  ON 5
 uu_6                -1.559175e-01 1 1  ON 6
 uu_7                -1.090426e-01 1 1  ON 7
 uu_8                -3.901143e-02 1 1  ON 8
 uu_9                 2.013548e-01 1 1  ON 9
 ud_0                 3.523073e-01 1 1  ON 10
 ud_1                 9.531772e-02 1 1  ON 11
 ud_2                -1.274736e-02 1 1  ON 12
 ud_3                -7.354161e-02 1 1  ON 13
 ud_4                -1.244284e-01 1 1  ON 14
 ud_5                -1.632483e-01 1 1  ON 15
 ud_6                -1.783552e-01 1 1  ON 16
 ud_7                -1.587609e-01 1 1  ON 17
 ud_8                -1.110777e-01 1 1  ON 18
 ud_9                 3.242615e-02 1 1  ON 19
 eO_0                -9.126523e-01 1 1  ON 20
 eO_1                -5.942264e-01 1 1  ON 21
 eO_2                -1.861186e-01 1 1  ON 22
 eO_3                 8.049914e-02 1 1  ON 23
 eO_4                 2.051008e-01 1 1  ON 24
 eO_5                 2.975771e-01 1 1  ON 25
 eO_6                 3.261942e-01 1 1  ON 26
 eO_7                 5.330460e-01 1 1  ON 27
 eO_8                 1.580430e-01 1 1  ON 28
 eO_9                 5.329605e-02 1 1  ON 29
eH1_0                -2.216405e-01 1 1  ON 30
eH1_1                -1.430087e-01 1 1  ON 31
eH1_2                -1.018513e-01 1 1  ON 32
eH1_3                -6.457540e-02 1 1  ON 33
eH1_4                -1.825649e-02 1 1  ON 34
eH1_5                -4.830018e-03 1 1  ON 35
eH1_6                 3.528402e-02 1 1  ON 36
eH1_7                 7.933636e-02 1 1  ON 37
eH1_8                 2.644518e-01 1 1  ON 38
eH1_9                 1.135168e-01 1 1  ON 39
eH2_0                -2.103197e-01 1 1  ON 40
eH2_1                -1.315801e-01 1 1  ON 41
eH2_2                -9.052266e-02 1 1  ON 42
eH2_3                -5.321112e-02 1 1  ON 43
eH2_4                -6.619977e-03 1 1  ON 44
eH2_5                 5.205738e-03 1 1  ON 45
eH2_6                 4.741577e-02 1 1  ON 46
eH2_7                 3.900954e-02 1 1  ON 47
eH2_8                 2.480718e-01 1 1  ON 48
eH2_9                 1.153952e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1216
    reference variance = 0.499553
====================================================
  Execution time = 1.9841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1420e-01
  Total weights = 2.0000e+06
  Execution time = 1.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847087295
                                         uncertainty =       0.002752312311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312847087295
                                         uncertainty =       0.002752312311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395525494
  error estimate for blocks of size 2^( 2) =       0.000405149742
  error estimate for blocks of size 2^( 3) =       0.000414120276
  error estimate for blocks of size 2^( 4) =       0.000421087165
  error estimate for blocks of size 2^( 5) =       0.000424531134
  error estimate for blocks of size 2^( 6) =       0.000428144998
  error estimate for blocks of size 2^( 7) =       0.000429710172

      target function =                  N/A
              le_mean =     -17.217124469702
             les_mean =     296.742255681418
             stat err =       0.000425868367
             autocorr =       1.159315926832
              std dev =       0.559357517742
             le_variance =       0.312880832655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315141623022
                                         uncertainty =       0.002775095061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315141623022
                                         uncertainty =       0.002775095061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396973638
  error estimate for blocks of size 2^( 2) =       0.000406518892
  error estimate for blocks of size 2^( 3) =       0.000415420101
  error estimate for blocks of size 2^( 4) =       0.000422339473
  error estimate for blocks of size 2^( 5) =       0.000425753272
  error estimate for blocks of size 2^( 6) =       0.000429360120
  error estimate for blocks of size 2^( 7) =       0.000430930092

      target function =                  N/A
              le_mean =     -17.217114986895
             les_mean =     296.744224453003
             stat err =       0.000427095739
             autocorr =       1.157516373475
              std dev =       0.561405502846
             le_variance =       0.315176138626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315530974700
                                         uncertainty =       0.002778492801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315530974700
                                         uncertainty =       0.002778492801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397218822
  error estimate for blocks of size 2^( 2) =       0.000406749486
  error estimate for blocks of size 2^( 3) =       0.000415638362
  error estimate for blocks of size 2^( 4) =       0.000422552784
  error estimate for blocks of size 2^( 5) =       0.000425960099
  error estimate for blocks of size 2^( 6) =       0.000429570334
  error estimate for blocks of size 2^( 7) =       0.000431140764

      target function =                  N/A
              le_mean =     -17.217113849753
             les_mean =     296.744574742710
             stat err =       0.000427305995
             autocorr =       1.157226403382
              std dev =       0.561752245331
             le_variance =       0.315565585134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313371189315
                                         uncertainty =       0.002757520773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313371189315
                                         uncertainty =       0.002757520773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395856728
  error estimate for blocks of size 2^( 2) =       0.000405460442
  error estimate for blocks of size 2^( 3) =       0.000414413452
  error estimate for blocks of size 2^( 4) =       0.000421369491
  error estimate for blocks of size 2^( 5) =       0.000424805631
  error estimate for blocks of size 2^( 6) =       0.000428419384
  error estimate for blocks of size 2^( 7) =       0.000429985547

      target function =                  N/A
              le_mean =     -17.217119673148
             les_mean =     296.742614781009
             stat err =       0.000426145013
             autocorr =       1.158880780166
              std dev =       0.559825953501
             le_variance =       0.313405098213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217124469702        initial  <--
     6.2500e-02     6.2500e-01             4.2756e-03       -17.217114986895
     2.5000e-01     2.5000e+00             1.8343e-03       -17.217113849753
     1.0000e+00     1.0000e+01             5.9649e-04       -17.217119673148

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1345
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.908276e-01 1 1  ON 0
 uu_1                 2.903605e-02 1 1  ON 1
 uu_2                -6.478607e-02 1 1  ON 2
 uu_3                -1.203560e-01 1 1  ON 3
 uu_4                -1.561378e-01 1 1  ON 4
 uu_5                -1.681687e-01 1 1  ON 5
 uu_6                -1.558313e-01 1 1  ON 6
 uu_7                -1.089421e-01 1 1  ON 7
 uu_8                -3.893951e-02 1 1  ON 8
 uu_9                 2.014711e-01 1 1  ON 9
 ud_0                 3.508965e-01 1 1  ON 10
 ud_1                 9.479818e-02 1 1  ON 11
 ud_2                -1.235800e-02 1 1  ON 12
 ud_3                -7.271775e-02 1 1  ON 13
 ud_4                -1.238777e-01 1 1  ON 14
 ud_5                -1.631000e-01 1 1  ON 15
 ud_6                -1.784684e-01 1 1  ON 16
 ud_7                -1.586265e-01 1 1  ON 17
 ud_8                -1.110261e-01 1 1  ON 18
 ud_9                 3.251816e-02 1 1  ON 19
 eO_0                -9.108180e-01 1 1  ON 20
 eO_1                -5.935564e-01 1 1  ON 21
 eO_2                -1.871864e-01 1 1  ON 22
 eO_3                 7.892572e-02 1 1  ON 23
 eO_4                 2.047432e-01 1 1  ON 24
 eO_5                 2.979901e-01 1 1  ON 25
 eO_6                 3.262806e-01 1 1  ON 26
 eO_7                 5.331793e-01 1 1  ON 27
 eO_8                 1.579598e-01 1 1  ON 28
 eO_9                 5.326225e-02 1 1  ON 29
eH1_0                -2.216504e-01 1 1  ON 30
eH1_1                -1.429609e-01 1 1  ON 31
eH1_2                -1.020358e-01 1 1  ON 32
eH1_3                -6.489736e-02 1 1  ON 33
eH1_4                -1.826502e-02 1 1  ON 34
eH1_5                -4.817437e-03 1 1  ON 35
eH1_6                 3.555681e-02 1 1  ON 36
eH1_7                 7.958332e-02 1 1  ON 37
eH1_8                 2.644677e-01 1 1  ON 38
eH1_9                 1.134871e-01 1 1  ON 39
eH2_0                -2.102321e-01 1 1  ON 40
eH2_1                -1.315965e-01 1 1  ON 41
eH2_2                -9.059018e-02 1 1  ON 42
eH2_3                -5.331420e-02 1 1  ON 43
eH2_4                -6.767788e-03 1 1  ON 44
eH2_5                 5.167611e-03 1 1  ON 45
eH2_6                 4.786698e-02 1 1  ON 46
eH2_7                 3.888444e-02 1 1  ON 47
eH2_8                 2.481069e-01 1 1  ON 48
eH2_9                 1.153639e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7180e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.249
    reference variance = 0.218568
====================================================
  Execution time = 2.0289e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4634e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346495332162
                                         uncertainty =       0.026474454185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346495332162
                                         uncertainty =       0.026474454185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416139711
  error estimate for blocks of size 2^( 2) =       0.000425521180
  error estimate for blocks of size 2^( 3) =       0.000433370382
  error estimate for blocks of size 2^( 4) =       0.000439290314
  error estimate for blocks of size 2^( 5) =       0.000442309415
  error estimate for blocks of size 2^( 6) =       0.000443906481
  error estimate for blocks of size 2^( 7) =       0.000443030152

      target function =                  N/A
              le_mean =     -17.216856094807
             les_mean =     296.766478133446
             stat err =       0.000442134090
             autocorr =       1.128832962966
              std dev =       0.588510422457
             le_variance =       0.346344517341


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721685609481e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856094807       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216859508956       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216859999125       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216861097148       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216861554264       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216861485762       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216862927598       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216863130997       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216863001168       residual = 7.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 8.338467e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856094807       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216857243029       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216857407160       residual = 8.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216857690420       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216857761866       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216857834328       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216858173291       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216858215468       residual = 7.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.714921e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216856094807       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216856408979       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216856454737       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216856525862       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216856535561       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216856563717       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216856644822       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216856654482       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 7.340003e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5821e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.908495e-01 1 1  ON 0
 uu_1                 2.905492e-02 1 1  ON 1
 uu_2                -6.480162e-02 1 1  ON 2
 uu_3                -1.203682e-01 1 1  ON 3
 uu_4                -1.561285e-01 1 1  ON 4
 uu_5                -1.681722e-01 1 1  ON 5
 uu_6                -1.558477e-01 1 1  ON 6
 uu_7                -1.089595e-01 1 1  ON 7
 uu_8                -3.893342e-02 1 1  ON 8
 uu_9                 2.014663e-01 1 1  ON 9
 ud_0                 3.511680e-01 1 1  ON 10
 ud_1                 9.487388e-02 1 1  ON 11
 ud_2                -1.244494e-02 1 1  ON 12
 ud_3                -7.286744e-02 1 1  ON 13
 ud_4                -1.239232e-01 1 1  ON 14
 ud_5                -1.631342e-01 1 1  ON 15
 ud_6                -1.784704e-01 1 1  ON 16
 ud_7                -1.586487e-01 1 1  ON 17
 ud_8                -1.110388e-01 1 1  ON 18
 ud_9                 3.251328e-02 1 1  ON 19
 eO_0                -9.110401e-01 1 1  ON 20
 eO_1                -5.937104e-01 1 1  ON 21
 eO_2                -1.870105e-01 1 1  ON 22
 eO_3                 7.914001e-02 1 1  ON 23
 eO_4                 2.047740e-01 1 1  ON 24
 eO_5                 2.979576e-01 1 1  ON 25
 eO_6                 3.262685e-01 1 1  ON 26
 eO_7                 5.331651e-01 1 1  ON 27
 eO_8                 1.579699e-01 1 1  ON 28
 eO_9                 5.326596e-02 1 1  ON 29
eH1_0                -2.216691e-01 1 1  ON 30
eH1_1                -1.429295e-01 1 1  ON 31
eH1_2                -1.020095e-01 1 1  ON 32
eH1_3                -6.484482e-02 1 1  ON 33
eH1_4                -1.825784e-02 1 1  ON 34
eH1_5                -4.867767e-03 1 1  ON 35
eH1_6                 3.554837e-02 1 1  ON 36
eH1_7                 7.954935e-02 1 1  ON 37
eH1_8                 2.644561e-01 1 1  ON 38
eH1_9                 1.134910e-01 1 1  ON 39
eH2_0                -2.102360e-01 1 1  ON 40
eH2_1                -1.316421e-01 1 1  ON 41
eH2_2                -9.060985e-02 1 1  ON 42
eH2_3                -5.330081e-02 1 1  ON 43
eH2_4                -6.736986e-03 1 1  ON 44
eH2_5                 5.180487e-03 1 1  ON 45
eH2_6                 4.786348e-02 1 1  ON 46
eH2_7                 3.890338e-02 1 1  ON 47
eH2_8                 2.480999e-01 1 1  ON 48
eH2_9                 1.153652e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.16
    reference variance = 0.175529
====================================================
  Execution time = 2.0124e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.0844e-01
  Total weights = 2.0000e+06
  Execution time = 1.8394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308240987402
                                         uncertainty =       0.002926509211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308240987402
                                         uncertainty =       0.002926509211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392554114
  error estimate for blocks of size 2^( 2) =       0.000402037832
  error estimate for blocks of size 2^( 3) =       0.000410981725
  error estimate for blocks of size 2^( 4) =       0.000417446968
  error estimate for blocks of size 2^( 5) =       0.000421252179
  error estimate for blocks of size 2^( 6) =       0.000424349643
  error estimate for blocks of size 2^( 7) =       0.000425070172

      target function =                  N/A
              le_mean =     -17.216336134109
             les_mean =     296.710427193409
             stat err =       0.000422029741
             autocorr =       1.155811596037
              std dev =       0.555155352032
             le_variance =       0.308197464890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308956857327
                                         uncertainty =       0.002935140638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308956857327
                                         uncertainty =       0.002935140638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393009662
  error estimate for blocks of size 2^( 2) =       0.000402467067
  error estimate for blocks of size 2^( 3) =       0.000411387060
  error estimate for blocks of size 2^( 4) =       0.000417832658
  error estimate for blocks of size 2^( 5) =       0.000421630474
  error estimate for blocks of size 2^( 6) =       0.000424729261
  error estimate for blocks of size 2^( 7) =       0.000425438438

      target function =                  N/A
              le_mean =     -17.216337117241
             les_mean =     296.711176769015
             stat err =       0.000422407708
             autocorr =       1.155200087290
              std dev =       0.555799594276
             le_variance =       0.308913188998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308718721628
                                         uncertainty =       0.002932233117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308718721628
                                         uncertainty =       0.002932233117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392858183
  error estimate for blocks of size 2^( 2) =       0.000402323995
  error estimate for blocks of size 2^( 3) =       0.000411252227
  error estimate for blocks of size 2^( 4) =       0.000417704664
  error estimate for blocks of size 2^( 5) =       0.000421505520
  error estimate for blocks of size 2^( 6) =       0.000424603432
  error estimate for blocks of size 2^( 7) =       0.000425317279

      target function =                  N/A
              le_mean =     -17.216336247776
             les_mean =     296.710908746265
             stat err =       0.000422282723
             autocorr =       1.155407067774
              std dev =       0.555585370697
             le_variance =       0.308675104133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308305608904
                                         uncertainty =       0.002927286340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.308305608904
                                         uncertainty =       0.002927286340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000392595258
  error estimate for blocks of size 2^( 2) =       0.000402076497
  error estimate for blocks of size 2^( 3) =       0.000411018241
  error estimate for blocks of size 2^( 4) =       0.000417481737
  error estimate for blocks of size 2^( 5) =       0.000421286369
  error estimate for blocks of size 2^( 6) =       0.000424383890
  error estimate for blocks of size 2^( 7) =       0.000425103533

      target function =                  N/A
              le_mean =     -17.216336068756
             les_mean =     296.710489551539
             stat err =       0.000422063882
             autocorr =       1.155756325495
              std dev =       0.555213538498
             le_variance =       0.308262073331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216336134109        initial
     6.2500e-01     6.2500e+00             8.3385e-04       -17.216337117241  <--
     2.5000e+00     2.5000e+01             2.7149e-04       -17.216336247776
     1.0000e+01     1.0000e+02             7.3400e-05       -17.216336068756

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9414e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.909103e-01 1 1  ON 0
 uu_1                 2.909302e-02 1 1  ON 1
 uu_2                -6.482881e-02 1 1  ON 2
 uu_3                -1.204144e-01 1 1  ON 3
 uu_4                -1.561249e-01 1 1  ON 4
 uu_5                -1.681613e-01 1 1  ON 5
 uu_6                -1.558844e-01 1 1  ON 6
 uu_7                -1.090072e-01 1 1  ON 7
 uu_8                -3.891512e-02 1 1  ON 8
 uu_9                 2.014526e-01 1 1  ON 9
 ud_0                 3.517248e-01 1 1  ON 10
 ud_1                 9.505747e-02 1 1  ON 11
 ud_2                -1.258674e-02 1 1  ON 12
 ud_3                -7.320081e-02 1 1  ON 13
 ud_4                -1.240725e-01 1 1  ON 14
 ud_5                -1.631980e-01 1 1  ON 15
 ud_6                -1.784519e-01 1 1  ON 16
 ud_7                -1.587032e-01 1 1  ON 17
 ud_8                -1.110731e-01 1 1  ON 18
 ud_9                 3.249960e-02 1 1  ON 19
 eO_0                -9.116518e-01 1 1  ON 20
 eO_1                -5.940706e-01 1 1  ON 21
 eO_2                -1.866433e-01 1 1  ON 22
 eO_3                 7.973277e-02 1 1  ON 23
 eO_4                 2.049001e-01 1 1  ON 24
 eO_5                 2.978762e-01 1 1  ON 25
 eO_6                 3.262356e-01 1 1  ON 26
 eO_7                 5.331246e-01 1 1  ON 27
 eO_8                 1.579990e-01 1 1  ON 28
 eO_9                 5.327670e-02 1 1  ON 29
eH1_0                -2.217129e-01 1 1  ON 30
eH1_1                -1.428533e-01 1 1  ON 31
eH1_2                -1.019345e-01 1 1  ON 32
eH1_3                -6.471349e-02 1 1  ON 33
eH1_4                -1.823470e-02 1 1  ON 34
eH1_5                -4.996002e-03 1 1  ON 35
eH1_6                 3.552894e-02 1 1  ON 36
eH1_7                 7.945234e-02 1 1  ON 37
eH1_8                 2.644229e-01 1 1  ON 38
eH1_9                 1.135020e-01 1 1  ON 39
eH2_0                -2.102625e-01 1 1  ON 40
eH2_1                -1.317597e-01 1 1  ON 41
eH2_2                -9.065677e-02 1 1  ON 42
eH2_3                -5.327811e-02 1 1  ON 43
eH2_4                -6.669871e-03 1 1  ON 44
eH2_5                 5.234953e-03 1 1  ON 45
eH2_6                 4.786276e-02 1 1  ON 46
eH2_7                 3.895983e-02 1 1  ON 47
eH2_8                 2.480800e-01 1 1  ON 48
eH2_9                 1.153692e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5241e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7188e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2862
    reference variance = 0.340801
====================================================
  Execution time = 2.0672e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2440e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6003e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324464011777
                                         uncertainty =       0.009290056830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324464011777
                                         uncertainty =       0.009290056830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402742702
  error estimate for blocks of size 2^( 2) =       0.000411973911
  error estimate for blocks of size 2^( 3) =       0.000420832668
  error estimate for blocks of size 2^( 4) =       0.000427190797
  error estimate for blocks of size 2^( 5) =       0.000430580216
  error estimate for blocks of size 2^( 6) =       0.000432074345
  error estimate for blocks of size 2^( 7) =       0.000432268651

      target function =                  N/A
              le_mean =     -17.216796850692
             les_mean =     296.742497004298
             stat err =       0.000430528502
             autocorr =       1.142742704601
              std dev =       0.569564191724
             le_variance =       0.324403368495


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679685069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216796850692       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216804660421       residual = 8.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216805203504       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216806982745       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216807740297       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216808586776       residual = 9.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216810067699       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216809623395       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216809474735       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.216809942618       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.216810025898       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.962065e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216796850692       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216800366924       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216800828484       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216801734372       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216802292185       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216802749323       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216802914862       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216802704644       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.216802722059       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.819776e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216796850692       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216797949840       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216798155839       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216798465695       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216798666826       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216798813241       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216798803308       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216798771743       residual = 3.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.917262e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6285e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.909094e-01 1 1  ON 0
 uu_1                 2.924589e-02 1 1  ON 1
 uu_2                -6.478146e-02 1 1  ON 2
 uu_3                -1.204034e-01 1 1  ON 3
 uu_4                -1.561200e-01 1 1  ON 4
 uu_5                -1.681337e-01 1 1  ON 5
 uu_6                -1.560220e-01 1 1  ON 6
 uu_7                -1.091166e-01 1 1  ON 7
 uu_8                -3.891659e-02 1 1  ON 8
 uu_9                 2.014206e-01 1 1  ON 9
 ud_0                 3.522866e-01 1 1  ON 10
 ud_1                 9.518783e-02 1 1  ON 11
 ud_2                -1.279102e-02 1 1  ON 12
 ud_3                -7.359772e-02 1 1  ON 13
 ud_4                -1.242218e-01 1 1  ON 14
 ud_5                -1.630765e-01 1 1  ON 15
 ud_6                -1.783337e-01 1 1  ON 16
 ud_7                -1.587797e-01 1 1  ON 17
 ud_8                -1.111508e-01 1 1  ON 18
 ud_9                 3.244779e-02 1 1  ON 19
 eO_0                -9.123338e-01 1 1  ON 20
 eO_1                -5.943773e-01 1 1  ON 21
 eO_2                -1.862403e-01 1 1  ON 22
 eO_3                 8.038295e-02 1 1  ON 23
 eO_4                 2.051254e-01 1 1  ON 24
 eO_5                 2.976985e-01 1 1  ON 25
 eO_6                 3.261486e-01 1 1  ON 26
 eO_7                 5.330645e-01 1 1  ON 27
 eO_8                 1.580220e-01 1 1  ON 28
 eO_9                 5.328598e-02 1 1  ON 29
eH1_0                -2.217571e-01 1 1  ON 30
eH1_1                -1.429164e-01 1 1  ON 31
eH1_2                -1.019488e-01 1 1  ON 32
eH1_3                -6.455652e-02 1 1  ON 33
eH1_4                -1.819384e-02 1 1  ON 34
eH1_5                -4.949515e-03 1 1  ON 35
eH1_6                 3.554436e-02 1 1  ON 36
eH1_7                 7.933093e-02 1 1  ON 37
eH1_8                 2.643915e-01 1 1  ON 38
eH1_9                 1.135094e-01 1 1  ON 39
eH2_0                -2.104032e-01 1 1  ON 40
eH2_1                -1.317931e-01 1 1  ON 41
eH2_2                -9.071185e-02 1 1  ON 42
eH2_3                -5.315624e-02 1 1  ON 43
eH2_4                -6.532101e-03 1 1  ON 44
eH2_5                 5.307826e-03 1 1  ON 45
eH2_6                 4.778921e-02 1 1  ON 46
eH2_7                 3.896387e-02 1 1  ON 47
eH2_8                 2.480382e-01 1 1  ON 48
eH2_9                 1.153687e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1566
    reference variance = 0.154324
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1781e-01
  Total weights = 2.0000e+06
  Execution time = 1.8396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317367333017
                                         uncertainty =       0.002852341550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317367333017
                                         uncertainty =       0.002852341550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398293050
  error estimate for blocks of size 2^( 2) =       0.000407872327
  error estimate for blocks of size 2^( 3) =       0.000416644383
  error estimate for blocks of size 2^( 4) =       0.000422677412
  error estimate for blocks of size 2^( 5) =       0.000425630890
  error estimate for blocks of size 2^( 6) =       0.000428938707
  error estimate for blocks of size 2^( 7) =       0.000427293945

      target function =                  N/A
              le_mean =     -17.217274848324
             les_mean =     296.751827752190
             stat err =       0.000426135239
             autocorr =       1.144694089408
              std dev =       0.563271433764
             le_variance =       0.317274708095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318581106516
                                         uncertainty =       0.002867286825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318581106516
                                         uncertainty =       0.002867286825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399053846
  error estimate for blocks of size 2^( 2) =       0.000408589101
  error estimate for blocks of size 2^( 3) =       0.000417323593
  error estimate for blocks of size 2^( 4) =       0.000423331105
  error estimate for blocks of size 2^( 5) =       0.000426278152
  error estimate for blocks of size 2^( 6) =       0.000429584020
  error estimate for blocks of size 2^( 7) =       0.000427937288

      target function =                  N/A
              le_mean =     -17.217282337653
             les_mean =     296.753298879089
             stat err =       0.000426782641
             autocorr =       1.143801054672
              std dev =       0.564347361002
             le_variance =       0.318487943869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318457039680
                                         uncertainty =       0.002865834510

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318457039680
                                         uncertainty =       0.002865834510

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398976179
  error estimate for blocks of size 2^( 2) =       0.000408514583
  error estimate for blocks of size 2^( 3) =       0.000417253747
  error estimate for blocks of size 2^( 4) =       0.000423266331
  error estimate for blocks of size 2^( 5) =       0.000426216872
  error estimate for blocks of size 2^( 6) =       0.000429520460
  error estimate for blocks of size 2^( 7) =       0.000427872760

      target function =                  N/A
              le_mean =     -17.217280779748
             les_mean =     296.753121272802
             stat err =       0.000426719106
             autocorr =       1.143905746962
              std dev =       0.564237523832
             le_variance =       0.318363983300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317545814104
                                         uncertainty =       0.002854550114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317545814104
                                         uncertainty =       0.002854550114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398405018
  error estimate for blocks of size 2^( 2) =       0.000407977308
  error estimate for blocks of size 2^( 3) =       0.000416743805
  error estimate for blocks of size 2^( 4) =       0.000422773549
  error estimate for blocks of size 2^( 5) =       0.000425726732
  error estimate for blocks of size 2^( 6) =       0.000429033627
  error estimate for blocks of size 2^( 7) =       0.000427388423

      target function =                  N/A
              le_mean =     -17.217275285791
             les_mean =     296.752021225155
             stat err =       0.000426230583
             autocorr =       1.144562770390
              std dev =       0.563429780166
             le_variance =       0.317453117177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217274848324        initial
     1.5625e-01     1.5625e+00             1.9621e-03       -17.217282337653  <--
     6.2500e-01     6.2500e+00             6.8198e-04       -17.217280779748
     2.5000e+00     2.5000e+01             1.9173e-04       -17.217275285791

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9442e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.911932e-01 1 1  ON 0
 uu_1                 2.951606e-02 1 1  ON 1
 uu_2                -6.464602e-02 1 1  ON 2
 uu_3                -1.204184e-01 1 1  ON 3
 uu_4                -1.562018e-01 1 1  ON 4
 uu_5                -1.681897e-01 1 1  ON 5
 uu_6                -1.563014e-01 1 1  ON 6
 uu_7                -1.093932e-01 1 1  ON 7
 uu_8                -3.891576e-02 1 1  ON 8
 uu_9                 2.013277e-01 1 1  ON 9
 ud_0                 3.529632e-01 1 1  ON 10
 ud_1                 9.539999e-02 1 1  ON 11
 ud_2                -1.296640e-02 1 1  ON 12
 ud_3                -7.410438e-02 1 1  ON 13
 ud_4                -1.245653e-01 1 1  ON 14
 ud_5                -1.629638e-01 1 1  ON 15
 ud_6                -1.779147e-01 1 1  ON 16
 ud_7                -1.588954e-01 1 1  ON 17
 ud_8                -1.113536e-01 1 1  ON 18
 ud_9                 3.229860e-02 1 1  ON 19
 eO_0                -9.136139e-01 1 1  ON 20
 eO_1                -5.950453e-01 1 1  ON 21
 eO_2                -1.857626e-01 1 1  ON 22
 eO_3                 8.167275e-02 1 1  ON 23
 eO_4                 2.059752e-01 1 1  ON 24
 eO_5                 2.973251e-01 1 1  ON 25
 eO_6                 3.259216e-01 1 1  ON 26
 eO_7                 5.328926e-01 1 1  ON 27
 eO_8                 1.580904e-01 1 1  ON 28
 eO_9                 5.331325e-02 1 1  ON 29
eH1_0                -2.218407e-01 1 1  ON 30
eH1_1                -1.430029e-01 1 1  ON 31
eH1_2                -1.019376e-01 1 1  ON 32
eH1_3                -6.433064e-02 1 1  ON 33
eH1_4                -1.811905e-02 1 1  ON 34
eH1_5                -4.818531e-03 1 1  ON 35
eH1_6                 3.565214e-02 1 1  ON 36
eH1_7                 7.899649e-02 1 1  ON 37
eH1_8                 2.643020e-01 1 1  ON 38
eH1_9                 1.135315e-01 1 1  ON 39
eH2_0                -2.106726e-01 1 1  ON 40
eH2_1                -1.318803e-01 1 1  ON 41
eH2_2                -9.075284e-02 1 1  ON 42
eH2_3                -5.299731e-02 1 1  ON 43
eH2_4                -6.340953e-03 1 1  ON 44
eH2_5                 5.545839e-03 1 1  ON 45
eH2_6                 4.766299e-02 1 1  ON 46
eH2_7                 3.899596e-02 1 1  ON 47
eH2_8                 2.479178e-01 1 1  ON 48
eH2_9                 1.153677e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.284686
====================================================
  Execution time = 2.0216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2385e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323824907412
                                         uncertainty =       0.004658558458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323824907412
                                         uncertainty =       0.004658558458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402399770
  error estimate for blocks of size 2^( 2) =       0.000411948522
  error estimate for blocks of size 2^( 3) =       0.000419933757
  error estimate for blocks of size 2^( 4) =       0.000425793904
  error estimate for blocks of size 2^( 5) =       0.000429954788
  error estimate for blocks of size 2^( 6) =       0.000431456611
  error estimate for blocks of size 2^( 7) =       0.000431027963

      target function =                  N/A
              le_mean =     -17.217615469214
             les_mean =     296.770133433039
             stat err =       0.000429558316
             autocorr =       1.139538011058
              std dev =       0.569079211750
             le_variance =       0.323851149246


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721761546921e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217615469214       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217616957803       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217623813993       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217624720878       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217622957938       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217625717332       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217624667291       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217626373698       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217626775668       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217626881985       residual = 6.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -17.217627467086       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -17.217626897118       residual = 8.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 3.943980e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217615469214       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217616575639       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217621428318       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217620673075       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217620844658       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217622335668       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217621924541       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217622558125       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217622596516       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -17.217622482210       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.823631e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217615469214       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217616015080       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217617771950       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217618048970       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217618050929       residual = 3.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217618483196       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217618631748       residual = 4.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217618533675       residual = 9.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 6.631790e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143694 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5801e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.912912e-01 1 1  ON 0
 uu_1                 2.962576e-02 1 1  ON 1
 uu_2                -6.472007e-02 1 1  ON 2
 uu_3                -1.204413e-01 1 1  ON 3
 uu_4                -1.563202e-01 1 1  ON 4
 uu_5                -1.683345e-01 1 1  ON 5
 uu_6                -1.560694e-01 1 1  ON 6
 uu_7                -1.094053e-01 1 1  ON 7
 uu_8                -3.895150e-02 1 1  ON 8
 uu_9                 2.011892e-01 1 1  ON 9
 ud_0                 3.533859e-01 1 1  ON 10
 ud_1                 9.552185e-02 1 1  ON 11
 ud_2                -1.309752e-02 1 1  ON 12
 ud_3                -7.462277e-02 1 1  ON 13
 ud_4                -1.252104e-01 1 1  ON 14
 ud_5                -1.628285e-01 1 1  ON 15
 ud_6                -1.776222e-01 1 1  ON 16
 ud_7                -1.587786e-01 1 1  ON 17
 ud_8                -1.111665e-01 1 1  ON 18
 ud_9                 3.224937e-02 1 1  ON 19
 eO_0                -9.154375e-01 1 1  ON 20
 eO_1                -5.955211e-01 1 1  ON 21
 eO_2                -1.853153e-01 1 1  ON 22
 eO_3                 8.294968e-02 1 1  ON 23
 eO_4                 2.065687e-01 1 1  ON 24
 eO_5                 2.973523e-01 1 1  ON 25
 eO_6                 3.259238e-01 1 1  ON 26
 eO_7                 5.327162e-01 1 1  ON 27
 eO_8                 1.581835e-01 1 1  ON 28
 eO_9                 5.334654e-02 1 1  ON 29
eH1_0                -2.220580e-01 1 1  ON 30
eH1_1                -1.431322e-01 1 1  ON 31
eH1_2                -1.018323e-01 1 1  ON 32
eH1_3                -6.417343e-02 1 1  ON 33
eH1_4                -1.792522e-02 1 1  ON 34
eH1_5                -4.527261e-03 1 1  ON 35
eH1_6                 3.560651e-02 1 1  ON 36
eH1_7                 7.867385e-02 1 1  ON 37
eH1_8                 2.642244e-01 1 1  ON 38
eH1_9                 1.135559e-01 1 1  ON 39
eH2_0                -2.105045e-01 1 1  ON 40
eH2_1                -1.316442e-01 1 1  ON 41
eH2_2                -9.041734e-02 1 1  ON 42
eH2_3                -5.305466e-02 1 1  ON 43
eH2_4                -6.591243e-03 1 1  ON 44
eH2_5                 5.056140e-03 1 1  ON 45
eH2_6                 4.744073e-02 1 1  ON 46
eH2_7                 3.931238e-02 1 1  ON 47
eH2_8                 2.478098e-01 1 1  ON 48
eH2_9                 1.154011e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1453
    reference variance = 0.322124
====================================================
  Execution time = 2.0122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1198e-01
  Total weights = 2.0000e+06
  Execution time = 1.8326e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311564194121
                                         uncertainty =       0.003076536699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311564194121
                                         uncertainty =       0.003076536699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394648222
  error estimate for blocks of size 2^( 2) =       0.000404097093
  error estimate for blocks of size 2^( 3) =       0.000412720304
  error estimate for blocks of size 2^( 4) =       0.000418940694
  error estimate for blocks of size 2^( 5) =       0.000422466447
  error estimate for blocks of size 2^( 6) =       0.000424135832
  error estimate for blocks of size 2^( 7) =       0.000427573930

      target function =                  N/A
              le_mean =     -17.216610657273
             les_mean =     296.723176806862
             stat err =       0.000423279226
             autocorr =       1.150359562484
              std dev =       0.558116868121
             le_variance =       0.311494438482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312471511550
                                         uncertainty =       0.003089290002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312471511550
                                         uncertainty =       0.003089290002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395222356
  error estimate for blocks of size 2^( 2) =       0.000404645204
  error estimate for blocks of size 2^( 3) =       0.000413239722
  error estimate for blocks of size 2^( 4) =       0.000419426783
  error estimate for blocks of size 2^( 5) =       0.000422936681
  error estimate for blocks of size 2^( 6) =       0.000424607209
  error estimate for blocks of size 2^( 7) =       0.000428033083

      target function =                  N/A
              le_mean =     -17.216608034614
             les_mean =     296.723993483041
             stat err =       0.000423750939
             autocorr =       1.149577730039
              std dev =       0.558928816321
             le_variance =       0.312401421714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312552050570
                                         uncertainty =       0.003090550686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312552050570
                                         uncertainty =       0.003090550686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395273283
  error estimate for blocks of size 2^( 2) =       0.000404694020
  error estimate for blocks of size 2^( 3) =       0.000413286796
  error estimate for blocks of size 2^( 4) =       0.000419471645
  error estimate for blocks of size 2^( 5) =       0.000422985222
  error estimate for blocks of size 2^( 6) =       0.000424655350
  error estimate for blocks of size 2^( 7) =       0.000428081605

      target function =                  N/A
              le_mean =     -17.216607858303
             les_mean =     296.724067926474
             stat err =       0.000423798456
             autocorr =       1.149539286299
              std dev =       0.559000837316
             le_variance =       0.312481936120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311745426905
                                         uncertainty =       0.003079226666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311745426905
                                         uncertainty =       0.003079226666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394762970
  error estimate for blocks of size 2^( 2) =       0.000404205889
  error estimate for blocks of size 2^( 3) =       0.000412823077
  error estimate for blocks of size 2^( 4) =       0.000419036613
  error estimate for blocks of size 2^( 5) =       0.000422560627
  error estimate for blocks of size 2^( 6) =       0.000424230013
  error estimate for blocks of size 2^( 7) =       0.000427665559

      target function =                  N/A
              le_mean =     -17.216609205400
             les_mean =     296.723307980248
             stat err =       0.000423373203
             autocorr =       1.150201468612
              std dev =       0.558279145798
             le_variance =       0.311675604633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216610657273        initial  <--
     3.9062e-02     3.9062e-01             3.9440e-03       -17.216608034614
     1.5625e-01     1.5625e+00             1.8236e-03       -17.216607858303
     6.2500e-01     6.2500e+00             6.6318e-04       -17.216609205400

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3808
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.911932e-01 1 1  ON 0
 uu_1                 2.951606e-02 1 1  ON 1
 uu_2                -6.464602e-02 1 1  ON 2
 uu_3                -1.204184e-01 1 1  ON 3
 uu_4                -1.562018e-01 1 1  ON 4
 uu_5                -1.681897e-01 1 1  ON 5
 uu_6                -1.563014e-01 1 1  ON 6
 uu_7                -1.093932e-01 1 1  ON 7
 uu_8                -3.891576e-02 1 1  ON 8
 uu_9                 2.013277e-01 1 1  ON 9
 ud_0                 3.529632e-01 1 1  ON 10
 ud_1                 9.539999e-02 1 1  ON 11
 ud_2                -1.296640e-02 1 1  ON 12
 ud_3                -7.410438e-02 1 1  ON 13
 ud_4                -1.245653e-01 1 1  ON 14
 ud_5                -1.629638e-01 1 1  ON 15
 ud_6                -1.779147e-01 1 1  ON 16
 ud_7                -1.588954e-01 1 1  ON 17
 ud_8                -1.113536e-01 1 1  ON 18
 ud_9                 3.229860e-02 1 1  ON 19
 eO_0                -9.136139e-01 1 1  ON 20
 eO_1                -5.950453e-01 1 1  ON 21
 eO_2                -1.857626e-01 1 1  ON 22
 eO_3                 8.167275e-02 1 1  ON 23
 eO_4                 2.059752e-01 1 1  ON 24
 eO_5                 2.973251e-01 1 1  ON 25
 eO_6                 3.259216e-01 1 1  ON 26
 eO_7                 5.328926e-01 1 1  ON 27
 eO_8                 1.580904e-01 1 1  ON 28
 eO_9                 5.331325e-02 1 1  ON 29
eH1_0                -2.218407e-01 1 1  ON 30
eH1_1                -1.430029e-01 1 1  ON 31
eH1_2                -1.019376e-01 1 1  ON 32
eH1_3                -6.433064e-02 1 1  ON 33
eH1_4                -1.811905e-02 1 1  ON 34
eH1_5                -4.818531e-03 1 1  ON 35
eH1_6                 3.565214e-02 1 1  ON 36
eH1_7                 7.899649e-02 1 1  ON 37
eH1_8                 2.643020e-01 1 1  ON 38
eH1_9                 1.135315e-01 1 1  ON 39
eH2_0                -2.106726e-01 1 1  ON 40
eH2_1                -1.318803e-01 1 1  ON 41
eH2_2                -9.075284e-02 1 1  ON 42
eH2_3                -5.299731e-02 1 1  ON 43
eH2_4                -6.340953e-03 1 1  ON 44
eH2_5                 5.545839e-03 1 1  ON 45
eH2_6                 4.766299e-02 1 1  ON 46
eH2_7                 3.899596e-02 1 1  ON 47
eH2_8                 2.479178e-01 1 1  ON 48
eH2_9                 1.153677e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5188e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7191e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2441
    reference variance = 0.400931
====================================================
  Execution time = 2.0394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333938990004
                                         uncertainty =       0.011184195010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333938990004
                                         uncertainty =       0.011184195010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408535911
  error estimate for blocks of size 2^( 2) =       0.000417782040
  error estimate for blocks of size 2^( 3) =       0.000426201005
  error estimate for blocks of size 2^( 4) =       0.000432291101
  error estimate for blocks of size 2^( 5) =       0.000436184184
  error estimate for blocks of size 2^( 6) =       0.000437266642
  error estimate for blocks of size 2^( 7) =       0.000436169906

      target function =                  N/A
              le_mean =     -17.217263172673
             les_mean =     296.767954170695
             stat err =       0.000435477958
             autocorr =       1.136244728980
              std dev =       0.577757025497
             le_variance =       0.333803180511


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721726317267e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217263172673       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217263254694       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217263037616       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217263250907       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217264477632       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217264246162       residual = 9.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217264518384       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217264466899       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -17.217264359850       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 8.561528e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217263172673       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217263199173       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217263103262       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217263194221       residual = 8.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217263522345       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217263395766       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217263487209       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217263492549       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 2.607745e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217263172673       residual = 4.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217263179820       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217263151381       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217263179845       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217263261029       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217263222703       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217263244145       residual = 8.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 6.902063e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146386 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5948e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.912721e-01 1 1  ON 0
 uu_1                 2.955236e-02 1 1  ON 1
 uu_2                -6.465839e-02 1 1  ON 2
 uu_3                -1.204350e-01 1 1  ON 3
 uu_4                -1.562480e-01 1 1  ON 4
 uu_5                -1.681676e-01 1 1  ON 5
 uu_6                -1.562974e-01 1 1  ON 6
 uu_7                -1.094249e-01 1 1  ON 7
 uu_8                -3.893255e-02 1 1  ON 8
 uu_9                 2.012968e-01 1 1  ON 9
 ud_0                 3.530036e-01 1 1  ON 10
 ud_1                 9.545216e-02 1 1  ON 11
 ud_2                -1.299210e-02 1 1  ON 12
 ud_3                -7.415285e-02 1 1  ON 13
 ud_4                -1.246617e-01 1 1  ON 14
 ud_5                -1.629438e-01 1 1  ON 15
 ud_6                -1.778372e-01 1 1  ON 16
 ud_7                -1.588880e-01 1 1  ON 17
 ud_8                -1.113599e-01 1 1  ON 18
 ud_9                 3.227188e-02 1 1  ON 19
 eO_0                -9.138746e-01 1 1  ON 20
 eO_1                -5.950799e-01 1 1  ON 21
 eO_2                -1.856562e-01 1 1  ON 22
 eO_3                 8.179412e-02 1 1  ON 23
 eO_4                 2.060687e-01 1 1  ON 24
 eO_5                 2.973291e-01 1 1  ON 25
 eO_6                 3.259095e-01 1 1  ON 26
 eO_7                 5.328654e-01 1 1  ON 27
 eO_8                 1.580990e-01 1 1  ON 28
 eO_9                 5.331366e-02 1 1  ON 29
eH1_0                -2.218793e-01 1 1  ON 30
eH1_1                -1.430396e-01 1 1  ON 31
eH1_2                -1.019451e-01 1 1  ON 32
eH1_3                -6.430724e-02 1 1  ON 33
eH1_4                -1.805362e-02 1 1  ON 34
eH1_5                -4.751787e-03 1 1  ON 35
eH1_6                 3.564831e-02 1 1  ON 36
eH1_7                 7.895282e-02 1 1  ON 37
eH1_8                 2.642729e-01 1 1  ON 38
eH1_9                 1.135323e-01 1 1  ON 39
eH2_0                -2.106373e-01 1 1  ON 40
eH2_1                -1.319158e-01 1 1  ON 41
eH2_2                -9.071306e-02 1 1  ON 42
eH2_3                -5.301531e-02 1 1  ON 43
eH2_4                -6.335537e-03 1 1  ON 44
eH2_5                 5.530040e-03 1 1  ON 45
eH2_6                 4.765460e-02 1 1  ON 46
eH2_7                 3.901257e-02 1 1  ON 47
eH2_8                 2.479004e-01 1 1  ON 48
eH2_9                 1.153648e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2076
    reference variance = 0.303484
====================================================
  Execution time = 1.9977e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4363e-01
  Total weights = 2.0000e+06
  Execution time = 1.8425e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343648143238
                                         uncertainty =       0.015958630258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343648143238
                                         uncertainty =       0.015958630258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414453314
  error estimate for blocks of size 2^( 2) =       0.000423669305
  error estimate for blocks of size 2^( 3) =       0.000431494832
  error estimate for blocks of size 2^( 4) =       0.000438471331
  error estimate for blocks of size 2^( 5) =       0.000443047387
  error estimate for blocks of size 2^( 6) =       0.000444025662
  error estimate for blocks of size 2^( 7) =       0.000444435082

      target function =                  N/A
              le_mean =     -17.216700947953
             les_mean =     296.758334457867
             stat err =       0.000442494865
             autocorr =       1.139896022859
              std dev =       0.586125497134
             le_variance =       0.343543098391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343954343018
                                         uncertainty =       0.015993881284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343954343018
                                         uncertainty =       0.015993881284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414637950
  error estimate for blocks of size 2^( 2) =       0.000423845124
  error estimate for blocks of size 2^( 3) =       0.000431659699
  error estimate for blocks of size 2^( 4) =       0.000438627262
  error estimate for blocks of size 2^( 5) =       0.000443199903
  error estimate for blocks of size 2^( 6) =       0.000444179725
  error estimate for blocks of size 2^( 7) =       0.000444585168

      target function =                  N/A
              le_mean =     -17.216700896772
             les_mean =     296.758638856461
             stat err =       0.000442648015
             autocorr =       1.139669546241
              std dev =       0.586386612640
             le_variance =       0.343849259483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822357208
                                         uncertainty =       0.015982398074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343822357208
                                         uncertainty =       0.015982398074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414558373
  error estimate for blocks of size 2^( 2) =       0.000423769168
  error estimate for blocks of size 2^( 3) =       0.000431587881
  error estimate for blocks of size 2^( 4) =       0.000438558992
  error estimate for blocks of size 2^( 5) =       0.000443133068
  error estimate for blocks of size 2^( 6) =       0.000444112593
  error estimate for blocks of size 2^( 7) =       0.000444519417

      target function =                  N/A
              le_mean =     -17.216700799710
             les_mean =     296.758503543793
             stat err =       0.000442581018
             autocorr =       1.139762027994
              std dev =       0.586274073197
             le_variance =       0.343717288903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343669206462
                                         uncertainty =       0.015961861474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343669206462
                                         uncertainty =       0.015961861474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414466018
  error estimate for blocks of size 2^( 2) =       0.000423681370
  error estimate for blocks of size 2^( 3) =       0.000431506028
  error estimate for blocks of size 2^( 4) =       0.000438481834
  error estimate for blocks of size 2^( 5) =       0.000443057630
  error estimate for blocks of size 2^( 6) =       0.000444036080
  error estimate for blocks of size 2^( 7) =       0.000444445142

      target function =                  N/A
              le_mean =     -17.216700909321
             les_mean =     296.758354189337
             stat err =       0.000442505172
             autocorr =       1.139879240175
              std dev =       0.586143463748
             le_variance =       0.343564160095


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216700947953        initial  <--
     3.9062e-01     3.9062e+00             8.5615e-04       -17.216700896772
     1.5625e+00     1.5625e+01             2.6077e-04       -17.216700799710
     6.2500e+00     6.2500e+01             6.9021e-05       -17.216700909321

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5453
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.911932e-01 1 1  ON 0
 uu_1                 2.951606e-02 1 1  ON 1
 uu_2                -6.464602e-02 1 1  ON 2
 uu_3                -1.204184e-01 1 1  ON 3
 uu_4                -1.562018e-01 1 1  ON 4
 uu_5                -1.681897e-01 1 1  ON 5
 uu_6                -1.563014e-01 1 1  ON 6
 uu_7                -1.093932e-01 1 1  ON 7
 uu_8                -3.891576e-02 1 1  ON 8
 uu_9                 2.013277e-01 1 1  ON 9
 ud_0                 3.529632e-01 1 1  ON 10
 ud_1                 9.539999e-02 1 1  ON 11
 ud_2                -1.296640e-02 1 1  ON 12
 ud_3                -7.410438e-02 1 1  ON 13
 ud_4                -1.245653e-01 1 1  ON 14
 ud_5                -1.629638e-01 1 1  ON 15
 ud_6                -1.779147e-01 1 1  ON 16
 ud_7                -1.588954e-01 1 1  ON 17
 ud_8                -1.113536e-01 1 1  ON 18
 ud_9                 3.229860e-02 1 1  ON 19
 eO_0                -9.136139e-01 1 1  ON 20
 eO_1                -5.950453e-01 1 1  ON 21
 eO_2                -1.857626e-01 1 1  ON 22
 eO_3                 8.167275e-02 1 1  ON 23
 eO_4                 2.059752e-01 1 1  ON 24
 eO_5                 2.973251e-01 1 1  ON 25
 eO_6                 3.259216e-01 1 1  ON 26
 eO_7                 5.328926e-01 1 1  ON 27
 eO_8                 1.580904e-01 1 1  ON 28
 eO_9                 5.331325e-02 1 1  ON 29
eH1_0                -2.218407e-01 1 1  ON 30
eH1_1                -1.430029e-01 1 1  ON 31
eH1_2                -1.019376e-01 1 1  ON 32
eH1_3                -6.433064e-02 1 1  ON 33
eH1_4                -1.811905e-02 1 1  ON 34
eH1_5                -4.818531e-03 1 1  ON 35
eH1_6                 3.565214e-02 1 1  ON 36
eH1_7                 7.899649e-02 1 1  ON 37
eH1_8                 2.643020e-01 1 1  ON 38
eH1_9                 1.135315e-01 1 1  ON 39
eH2_0                -2.106726e-01 1 1  ON 40
eH2_1                -1.318803e-01 1 1  ON 41
eH2_2                -9.075284e-02 1 1  ON 42
eH2_3                -5.299731e-02 1 1  ON 43
eH2_4                -6.340953e-03 1 1  ON 44
eH2_5                 5.545839e-03 1 1  ON 45
eH2_6                 4.766299e-02 1 1  ON 46
eH2_7                 3.899596e-02 1 1  ON 47
eH2_8                 2.479178e-01 1 1  ON 48
eH2_9                 1.153677e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7500e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2281
    reference variance = 0.303022
====================================================
  Execution time = 2.0201e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319211391088
                                         uncertainty =       0.005803573060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319211391088
                                         uncertainty =       0.005803573060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399475322
  error estimate for blocks of size 2^( 2) =       0.000408601664
  error estimate for blocks of size 2^( 3) =       0.000416879951
  error estimate for blocks of size 2^( 4) =       0.000423332917
  error estimate for blocks of size 2^( 5) =       0.000427561951
  error estimate for blocks of size 2^( 6) =       0.000430369171
  error estimate for blocks of size 2^( 7) =       0.000432479121

      target function =                  N/A
              le_mean =     -17.216538562320
             les_mean =     296.728360974677
             stat err =       0.000428435790
             autocorr =       1.150248230847
              std dev =       0.564943418767
             le_variance =       0.319161066408


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653856232e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538562320       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538750377       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216539290286       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216539135539       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216539106198       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216539116435       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216539115507       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216539107368       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 9.363139e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538562320       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538611121       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538754852       residual = 6.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538720297       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216538709977       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216538711171       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216538711080       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 2.369072e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216538562320       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216538574637       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216538611161       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216538602810       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216538600083       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216538600269       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216538600231       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 5.959951e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5748e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.911997e-01 1 1  ON 0
 uu_1                 2.951817e-02 1 1  ON 1
 uu_2                -6.465056e-02 1 1  ON 2
 uu_3                -1.204206e-01 1 1  ON 3
 uu_4                -1.561998e-01 1 1  ON 4
 uu_5                -1.681914e-01 1 1  ON 5
 uu_6                -1.562988e-01 1 1  ON 6
 uu_7                -1.093945e-01 1 1  ON 7
 uu_8                -3.891782e-02 1 1  ON 8
 uu_9                 2.013253e-01 1 1  ON 9
 ud_0                 3.529711e-01 1 1  ON 10
 ud_1                 9.540678e-02 1 1  ON 11
 ud_2                -1.296404e-02 1 1  ON 12
 ud_3                -7.411330e-02 1 1  ON 13
 ud_4                -1.245711e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779120e-01 1 1  ON 16
 ud_7                -1.588961e-01 1 1  ON 17
 ud_8                -1.113570e-01 1 1  ON 18
 ud_9                 3.229568e-02 1 1  ON 19
 eO_0                -9.136376e-01 1 1  ON 20
 eO_1                -5.950521e-01 1 1  ON 21
 eO_2                -1.857516e-01 1 1  ON 22
 eO_3                 8.168813e-02 1 1  ON 23
 eO_4                 2.059847e-01 1 1  ON 24
 eO_5                 2.973228e-01 1 1  ON 25
 eO_6                 3.259202e-01 1 1  ON 26
 eO_7                 5.328899e-01 1 1  ON 27
 eO_8                 1.580911e-01 1 1  ON 28
 eO_9                 5.331346e-02 1 1  ON 29
eH1_0                -2.218494e-01 1 1  ON 30
eH1_1                -1.430079e-01 1 1  ON 31
eH1_2                -1.019353e-01 1 1  ON 32
eH1_3                -6.432581e-02 1 1  ON 33
eH1_4                -1.811405e-02 1 1  ON 34
eH1_5                -4.812356e-03 1 1  ON 35
eH1_6                 3.565215e-02 1 1  ON 36
eH1_7                 7.899423e-02 1 1  ON 37
eH1_8                 2.642998e-01 1 1  ON 38
eH1_9                 1.135311e-01 1 1  ON 39
eH2_0                -2.106702e-01 1 1  ON 40
eH2_1                -1.318769e-01 1 1  ON 41
eH2_2                -9.075067e-02 1 1  ON 42
eH2_3                -5.299659e-02 1 1  ON 43
eH2_4                -6.344560e-03 1 1  ON 44
eH2_5                 5.544103e-03 1 1  ON 45
eH2_6                 4.765957e-02 1 1  ON 46
eH2_7                 3.899795e-02 1 1  ON 47
eH2_8                 2.479158e-01 1 1  ON 48
eH2_9                 1.153676e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.492818
====================================================
  Execution time = 1.9917e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1385e-01
  Total weights = 2.0000e+06
  Execution time = 1.8394e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313951264285
                                         uncertainty =       0.002279103843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313951264285
                                         uncertainty =       0.002279103843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396130684
  error estimate for blocks of size 2^( 2) =       0.000405630798
  error estimate for blocks of size 2^( 3) =       0.000413885713
  error estimate for blocks of size 2^( 4) =       0.000419797039
  error estimate for blocks of size 2^( 5) =       0.000423791493
  error estimate for blocks of size 2^( 6) =       0.000425748901
  error estimate for blocks of size 2^( 7) =       0.000426337247

      target function =                  N/A
              le_mean =     -17.216936845586
             les_mean =     296.736753225979
             stat err =       0.000423918670
             autocorr =       1.145217878626
              std dev =       0.560213386128
             le_variance =       0.313839037997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313978929782
                                         uncertainty =       0.002279394286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313978929782
                                         uncertainty =       0.002279394286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396148136
  error estimate for blocks of size 2^( 2) =       0.000405647586
  error estimate for blocks of size 2^( 3) =       0.000413901862
  error estimate for blocks of size 2^( 4) =       0.000419812755
  error estimate for blocks of size 2^( 5) =       0.000423806140
  error estimate for blocks of size 2^( 6) =       0.000425763271
  error estimate for blocks of size 2^( 7) =       0.000426350900

      target function =                  N/A
              le_mean =     -17.216936767957
             les_mean =     296.736778206361
             stat err =       0.000423933266
             autocorr =       1.145195837816
              std dev =       0.560238066787
             le_variance =       0.313866691478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313964597881
                                         uncertainty =       0.002279248610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313964597881
                                         uncertainty =       0.002279248610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396139095
  error estimate for blocks of size 2^( 2) =       0.000405638923
  error estimate for blocks of size 2^( 3) =       0.000413893560
  error estimate for blocks of size 2^( 4) =       0.000419804714
  error estimate for blocks of size 2^( 5) =       0.000423798607
  error estimate for blocks of size 2^( 6) =       0.000425755858
  error estimate for blocks of size 2^( 7) =       0.000426343784

      target function =                  N/A
              le_mean =     -17.216936808827
             les_mean =     296.736765287727
             stat err =       0.000423925741
             autocorr =       1.145207449744
              std dev =       0.560225281028
             le_variance =       0.313852365503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313952926753
                                         uncertainty =       0.002279121994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313952926753
                                         uncertainty =       0.002279121994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396131733
  error estimate for blocks of size 2^( 2) =       0.000405631812
  error estimate for blocks of size 2^( 3) =       0.000413886692
  error estimate for blocks of size 2^( 4) =       0.000419797996
  error estimate for blocks of size 2^( 5) =       0.000423792380
  error estimate for blocks of size 2^( 6) =       0.000425749767
  error estimate for blocks of size 2^( 7) =       0.000426338060

      target function =                  N/A
              le_mean =     -17.216936840756
             les_mean =     296.736754721356
             stat err =       0.000423919551
             autocorr =       1.145216575438
              std dev =       0.560214869225
             le_variance =       0.313840699700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216936845586        initial  <--
     3.9062e+00     3.9062e+01             9.3631e-05       -17.216936767957
     1.5625e+01     1.5625e+02             2.3691e-05       -17.216936808827
     6.2500e+01     6.2500e+02             5.9600e-06       -17.216936840756

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1749
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.911932e-01 1 1  ON 0
 uu_1                 2.951606e-02 1 1  ON 1
 uu_2                -6.464602e-02 1 1  ON 2
 uu_3                -1.204184e-01 1 1  ON 3
 uu_4                -1.562018e-01 1 1  ON 4
 uu_5                -1.681897e-01 1 1  ON 5
 uu_6                -1.563014e-01 1 1  ON 6
 uu_7                -1.093932e-01 1 1  ON 7
 uu_8                -3.891576e-02 1 1  ON 8
 uu_9                 2.013277e-01 1 1  ON 9
 ud_0                 3.529632e-01 1 1  ON 10
 ud_1                 9.539999e-02 1 1  ON 11
 ud_2                -1.296640e-02 1 1  ON 12
 ud_3                -7.410438e-02 1 1  ON 13
 ud_4                -1.245653e-01 1 1  ON 14
 ud_5                -1.629638e-01 1 1  ON 15
 ud_6                -1.779147e-01 1 1  ON 16
 ud_7                -1.588954e-01 1 1  ON 17
 ud_8                -1.113536e-01 1 1  ON 18
 ud_9                 3.229860e-02 1 1  ON 19
 eO_0                -9.136139e-01 1 1  ON 20
 eO_1                -5.950453e-01 1 1  ON 21
 eO_2                -1.857626e-01 1 1  ON 22
 eO_3                 8.167275e-02 1 1  ON 23
 eO_4                 2.059752e-01 1 1  ON 24
 eO_5                 2.973251e-01 1 1  ON 25
 eO_6                 3.259216e-01 1 1  ON 26
 eO_7                 5.328926e-01 1 1  ON 27
 eO_8                 1.580904e-01 1 1  ON 28
 eO_9                 5.331325e-02 1 1  ON 29
eH1_0                -2.218407e-01 1 1  ON 30
eH1_1                -1.430029e-01 1 1  ON 31
eH1_2                -1.019376e-01 1 1  ON 32
eH1_3                -6.433064e-02 1 1  ON 33
eH1_4                -1.811905e-02 1 1  ON 34
eH1_5                -4.818531e-03 1 1  ON 35
eH1_6                 3.565214e-02 1 1  ON 36
eH1_7                 7.899649e-02 1 1  ON 37
eH1_8                 2.643020e-01 1 1  ON 38
eH1_9                 1.135315e-01 1 1  ON 39
eH2_0                -2.106726e-01 1 1  ON 40
eH2_1                -1.318803e-01 1 1  ON 41
eH2_2                -9.075284e-02 1 1  ON 42
eH2_3                -5.299731e-02 1 1  ON 43
eH2_4                -6.340953e-03 1 1  ON 44
eH2_5                 5.545839e-03 1 1  ON 45
eH2_6                 4.766299e-02 1 1  ON 46
eH2_7                 3.899596e-02 1 1  ON 47
eH2_8                 2.479178e-01 1 1  ON 48
eH2_9                 1.153677e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2133
    reference variance = 0.364255
====================================================
  Execution time = 2.0305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1374e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5582e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313686491384
                                         uncertainty =       0.002525242008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313686491384
                                         uncertainty =       0.002525242008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396069423
  error estimate for blocks of size 2^( 2) =       0.000405818930
  error estimate for blocks of size 2^( 3) =       0.000414190131
  error estimate for blocks of size 2^( 4) =       0.000420050738
  error estimate for blocks of size 2^( 5) =       0.000423605461
  error estimate for blocks of size 2^( 6) =       0.000426177477
  error estimate for blocks of size 2^( 7) =       0.000429841452

      target function =                  N/A
              le_mean =     -17.216801025965
             les_mean =     296.731979387229
             stat err =       0.000424918782
             autocorr =       1.150983832145
              std dev =       0.560126750322
             le_variance =       0.313741976426


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721680102597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216801025965       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216801040759       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216801030011       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216801041660       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216801048794       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216801050639       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216801051460       residual = 6.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.068855e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216801025965       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216801029676       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216801026970       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216801029907       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216801031625       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216801032104       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216801032299       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 2.680345e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216801025965       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216801026894       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216801026216       residual = 7.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216801026952       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216801027379       residual = 6.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216801027497       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216801027545       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 6.706035e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.151031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5874e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.911935e-01 1 1  ON 0
 uu_1                 2.951710e-02 1 1  ON 1
 uu_2                -6.464655e-02 1 1  ON 2
 uu_3                -1.204182e-01 1 1  ON 3
 uu_4                -1.562021e-01 1 1  ON 4
 uu_5                -1.681902e-01 1 1  ON 5
 uu_6                -1.563013e-01 1 1  ON 6
 uu_7                -1.093934e-01 1 1  ON 7
 uu_8                -3.891578e-02 1 1  ON 8
 uu_9                 2.013276e-01 1 1  ON 9
 ud_0                 3.529638e-01 1 1  ON 10
 ud_1                 9.540037e-02 1 1  ON 11
 ud_2                -1.296621e-02 1 1  ON 12
 ud_3                -7.410533e-02 1 1  ON 13
 ud_4                -1.245657e-01 1 1  ON 14
 ud_5                -1.629635e-01 1 1  ON 15
 ud_6                -1.779144e-01 1 1  ON 16
 ud_7                -1.588956e-01 1 1  ON 17
 ud_8                -1.113538e-01 1 1  ON 18
 ud_9                 3.229843e-02 1 1  ON 19
 eO_0                -9.136165e-01 1 1  ON 20
 eO_1                -5.950456e-01 1 1  ON 21
 eO_2                -1.857613e-01 1 1  ON 22
 eO_3                 8.167383e-02 1 1  ON 23
 eO_4                 2.059766e-01 1 1  ON 24
 eO_5                 2.973245e-01 1 1  ON 25
 eO_6                 3.259214e-01 1 1  ON 26
 eO_7                 5.328924e-01 1 1  ON 27
 eO_8                 1.580905e-01 1 1  ON 28
 eO_9                 5.331328e-02 1 1  ON 29
eH1_0                -2.218411e-01 1 1  ON 30
eH1_1                -1.430029e-01 1 1  ON 31
eH1_2                -1.019371e-01 1 1  ON 32
eH1_3                -6.433060e-02 1 1  ON 33
eH1_4                -1.811868e-02 1 1  ON 34
eH1_5                -4.817873e-03 1 1  ON 35
eH1_6                 3.565164e-02 1 1  ON 36
eH1_7                 7.899592e-02 1 1  ON 37
eH1_8                 2.643018e-01 1 1  ON 38
eH1_9                 1.135315e-01 1 1  ON 39
eH2_0                -2.106721e-01 1 1  ON 40
eH2_1                -1.318805e-01 1 1  ON 41
eH2_2                -9.075317e-02 1 1  ON 42
eH2_3                -5.299738e-02 1 1  ON 43
eH2_4                -6.341395e-03 1 1  ON 44
eH2_5                 5.546317e-03 1 1  ON 45
eH2_6                 4.766284e-02 1 1  ON 46
eH2_7                 3.899627e-02 1 1  ON 47
eH2_8                 2.479177e-01 1 1  ON 48
eH2_9                 1.153677e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2791
    reference variance = 0.410329
====================================================
  Execution time = 2.0118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1094e-01
  Total weights = 2.0000e+06
  Execution time = 1.8288e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310924948506
                                         uncertainty =       0.003099901042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310924948506
                                         uncertainty =       0.003099901042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394298538
  error estimate for blocks of size 2^( 2) =       0.000403693645
  error estimate for blocks of size 2^( 3) =       0.000412234352
  error estimate for blocks of size 2^( 4) =       0.000418615014
  error estimate for blocks of size 2^( 5) =       0.000422987080
  error estimate for blocks of size 2^( 6) =       0.000425282726
  error estimate for blocks of size 2^( 7) =       0.000427976015

      target function =                  N/A
              le_mean =     -17.217124008721
             les_mean =     296.740301649642
             stat err =       0.000423715209
             autocorr =       1.154776062674
              std dev =       0.557622339429
             le_variance =       0.310942673430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310928176495
                                         uncertainty =       0.003099920242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310928176495
                                         uncertainty =       0.003099920242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394300582
  error estimate for blocks of size 2^( 2) =       0.000403695607
  error estimate for blocks of size 2^( 3) =       0.000412236189
  error estimate for blocks of size 2^( 4) =       0.000418616802
  error estimate for blocks of size 2^( 5) =       0.000422988730
  error estimate for blocks of size 2^( 6) =       0.000425284365
  error estimate for blocks of size 2^( 7) =       0.000427977612

      target function =                  N/A
              le_mean =     -17.217124026857
             les_mean =     296.740305498642
             stat err =       0.000423716877
             autocorr =       1.154773182047
              std dev =       0.557625230737
             le_variance =       0.310945897954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310926565408
                                         uncertainty =       0.003099910637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310926565408
                                         uncertainty =       0.003099910637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394299562
  error estimate for blocks of size 2^( 2) =       0.000403694628
  error estimate for blocks of size 2^( 3) =       0.000412235273
  error estimate for blocks of size 2^( 4) =       0.000418615910
  error estimate for blocks of size 2^( 5) =       0.000422987906
  error estimate for blocks of size 2^( 6) =       0.000425283547
  error estimate for blocks of size 2^( 7) =       0.000427976815

      target function =                  N/A
              le_mean =     -17.217124017887
             les_mean =     296.740303580409
             stat err =       0.000423716045
             autocorr =       1.154774620853
              std dev =       0.557623787680
             le_variance =       0.310944288587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310925150690
                                         uncertainty =       0.003099902241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310925150690
                                         uncertainty =       0.003099902241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394298666
  error estimate for blocks of size 2^( 2) =       0.000403693768
  error estimate for blocks of size 2^( 3) =       0.000412234468
  error estimate for blocks of size 2^( 4) =       0.000418615126
  error estimate for blocks of size 2^( 5) =       0.000422987183
  error estimate for blocks of size 2^( 6) =       0.000425282829
  error estimate for blocks of size 2^( 7) =       0.000427976115

      target function =                  N/A
              le_mean =     -17.217124009868
             les_mean =     296.740301891081
             stat err =       0.000423715313
             autocorr =       1.154775882390
              std dev =       0.557622520524
             le_variance =       0.310942875395


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217124008721        initial
     3.9062e+01     3.9062e+02             1.0689e-05       -17.217124026857  <--
     1.5625e+02     1.5625e+03             2.6803e-06       -17.217124017887
     6.2500e+02     6.2500e+03             6.7060e-07       -17.217124009868

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.9379e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.911943e-01 1 1  ON 0
 uu_1                 2.952018e-02 1 1  ON 1
 uu_2                -6.464812e-02 1 1  ON 2
 uu_3                -1.204179e-01 1 1  ON 3
 uu_4                -1.562030e-01 1 1  ON 4
 uu_5                -1.681916e-01 1 1  ON 5
 uu_6                -1.563010e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891584e-02 1 1  ON 8
 uu_9                 2.013271e-01 1 1  ON 9
 ud_0                 3.529657e-01 1 1  ON 10
 ud_1                 9.540149e-02 1 1  ON 11
 ud_2                -1.296564e-02 1 1  ON 12
 ud_3                -7.410816e-02 1 1  ON 13
 ud_4                -1.245672e-01 1 1  ON 14
 ud_5                -1.629627e-01 1 1  ON 15
 ud_6                -1.779133e-01 1 1  ON 16
 ud_7                -1.588960e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229793e-02 1 1  ON 19
 eO_0                -9.136246e-01 1 1  ON 20
 eO_1                -5.950464e-01 1 1  ON 21
 eO_2                -1.857576e-01 1 1  ON 22
 eO_3                 8.167705e-02 1 1  ON 23
 eO_4                 2.059807e-01 1 1  ON 24
 eO_5                 2.973225e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328920e-01 1 1  ON 27
 eO_8                 1.580909e-01 1 1  ON 28
 eO_9                 5.331337e-02 1 1  ON 29
eH1_0                -2.218422e-01 1 1  ON 30
eH1_1                -1.430028e-01 1 1  ON 31
eH1_2                -1.019356e-01 1 1  ON 32
eH1_3                -6.433047e-02 1 1  ON 33
eH1_4                -1.811759e-02 1 1  ON 34
eH1_5                -4.815902e-03 1 1  ON 35
eH1_6                 3.565012e-02 1 1  ON 36
eH1_7                 7.899421e-02 1 1  ON 37
eH1_8                 2.643012e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106707e-01 1 1  ON 40
eH2_1                -1.318811e-01 1 1  ON 41
eH2_2                -9.075414e-02 1 1  ON 42
eH2_3                -5.299759e-02 1 1  ON 43
eH2_4                -6.342714e-03 1 1  ON 44
eH2_5                 5.547749e-03 1 1  ON 45
eH2_6                 4.766239e-02 1 1  ON 46
eH2_7                 3.899719e-02 1 1  ON 47
eH2_8                 2.479174e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2348
    reference variance = 0.229369
====================================================
  Execution time = 2.0360e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2237e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322474321623
                                         uncertainty =       0.005332960428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322474321623
                                         uncertainty =       0.005332960428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401478863
  error estimate for blocks of size 2^( 2) =       0.000411004664
  error estimate for blocks of size 2^( 3) =       0.000419777871
  error estimate for blocks of size 2^( 4) =       0.000425535685
  error estimate for blocks of size 2^( 5) =       0.000429825859
  error estimate for blocks of size 2^( 6) =       0.000432065741
  error estimate for blocks of size 2^( 7) =       0.000433560459

      target function =                  N/A
              le_mean =     -17.217644492626
             les_mean =     296.769652267370
             stat err =       0.000430246936
             autocorr =       1.148445001977
              std dev =       0.567776852380
             le_variance =       0.322370554099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721764449263e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217644492626       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217644505104       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217644505425       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217644481886       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217644471584       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217644470622       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217644483061       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 4.929740e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217644492626       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217644495788       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217644495878       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217644489785       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217644487248       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217644486610       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217644489752       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.249254e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217644492626       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217644493419       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217644493442       residual = 8.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217644491906       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217644491275       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217644491090       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217644491876       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 3.133936e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5936e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.911942e-01 1 1  ON 0
 uu_1                 2.952247e-02 1 1  ON 1
 uu_2                -6.464881e-02 1 1  ON 2
 uu_3                -1.204179e-01 1 1  ON 3
 uu_4                -1.562021e-01 1 1  ON 4
 uu_5                -1.681925e-01 1 1  ON 5
 uu_6                -1.563001e-01 1 1  ON 6
 uu_7                -1.093957e-01 1 1  ON 7
 uu_8                -3.891638e-02 1 1  ON 8
 uu_9                 2.013262e-01 1 1  ON 9
 ud_0                 3.529682e-01 1 1  ON 10
 ud_1                 9.540364e-02 1 1  ON 11
 ud_2                -1.296578e-02 1 1  ON 12
 ud_3                -7.411196e-02 1 1  ON 13
 ud_4                -1.245710e-01 1 1  ON 14
 ud_5                -1.629620e-01 1 1  ON 15
 ud_6                -1.779102e-01 1 1  ON 16
 ud_7                -1.588949e-01 1 1  ON 17
 ud_8                -1.113550e-01 1 1  ON 18
 ud_9                 3.229662e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950463e-01 1 1  ON 21
 eO_2                -1.857536e-01 1 1  ON 22
 eO_3                 8.168285e-02 1 1  ON 23
 eO_4                 2.059850e-01 1 1  ON 24
 eO_5                 2.973220e-01 1 1  ON 25
 eO_6                 3.259206e-01 1 1  ON 26
 eO_7                 5.328909e-01 1 1  ON 27
 eO_8                 1.580911e-01 1 1  ON 28
 eO_9                 5.331336e-02 1 1  ON 29
eH1_0                -2.218432e-01 1 1  ON 30
eH1_1                -1.430012e-01 1 1  ON 31
eH1_2                -1.019354e-01 1 1  ON 32
eH1_3                -6.432969e-02 1 1  ON 33
eH1_4                -1.811703e-02 1 1  ON 34
eH1_5                -4.814670e-03 1 1  ON 35
eH1_6                 3.564937e-02 1 1  ON 36
eH1_7                 7.899256e-02 1 1  ON 37
eH1_8                 2.643003e-01 1 1  ON 38
eH1_9                 1.135315e-01 1 1  ON 39
eH2_0                -2.106727e-01 1 1  ON 40
eH2_1                -1.318809e-01 1 1  ON 41
eH2_2                -9.075403e-02 1 1  ON 42
eH2_3                -5.299918e-02 1 1  ON 43
eH2_4                -6.340956e-03 1 1  ON 44
eH2_5                 5.548478e-03 1 1  ON 45
eH2_6                 4.766259e-02 1 1  ON 46
eH2_7                 3.899816e-02 1 1  ON 47
eH2_8                 2.479169e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1861
    reference variance = 0.147431
====================================================
  Execution time = 1.9877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3287e-01
  Total weights = 2.0000e+06
  Execution time = 1.8360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332956844857
                                         uncertainty =       0.019043867363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332956844857
                                         uncertainty =       0.019043867363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407962972
  error estimate for blocks of size 2^( 2) =       0.000417264306
  error estimate for blocks of size 2^( 3) =       0.000424816064
  error estimate for blocks of size 2^( 4) =       0.000430985589
  error estimate for blocks of size 2^( 5) =       0.000435717250
  error estimate for blocks of size 2^( 6) =       0.000437201414
  error estimate for blocks of size 2^( 7) =       0.000437473336

      target function =                  N/A
              le_mean =     -17.216982935887
             les_mean =     296.757368820994
             stat err =       0.000435344397
             autocorr =       1.138739605286
              std dev =       0.576946767724
             le_variance =       0.332867572788

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332969529903
                                         uncertainty =       0.019044566758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332969529903
                                         uncertainty =       0.019044566758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407970744
  error estimate for blocks of size 2^( 2) =       0.000417271720
  error estimate for blocks of size 2^( 3) =       0.000424823076
  error estimate for blocks of size 2^( 4) =       0.000430992287
  error estimate for blocks of size 2^( 5) =       0.000435723612
  error estimate for blocks of size 2^( 6) =       0.000437207464
  error estimate for blocks of size 2^( 7) =       0.000437479348

      target function =                  N/A
              le_mean =     -17.216982827284
             les_mean =     296.757377764020
             stat err =       0.000435350678
             autocorr =       1.138729074414
              std dev =       0.576957758834
             le_variance =       0.332880255479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332963177372
                                         uncertainty =       0.019044219250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332963177372
                                         uncertainty =       0.019044219250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407966852
  error estimate for blocks of size 2^( 2) =       0.000417268007
  error estimate for blocks of size 2^( 3) =       0.000424819564
  error estimate for blocks of size 2^( 4) =       0.000430988931
  error estimate for blocks of size 2^( 5) =       0.000435720423
  error estimate for blocks of size 2^( 6) =       0.000437204428
  error estimate for blocks of size 2^( 7) =       0.000437476329

      target function =                  N/A
              le_mean =     -17.216982879461
             les_mean =     296.757373209352
             stat err =       0.000435347528
             autocorr =       1.138734324217
              std dev =       0.576952254647
             le_variance =       0.332873904142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332957635735
                                         uncertainty =       0.019043911408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332957635735
                                         uncertainty =       0.019043911408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407963456
  error estimate for blocks of size 2^( 2) =       0.000417264768
  error estimate for blocks of size 2^( 3) =       0.000424816501
  error estimate for blocks of size 2^( 4) =       0.000430986006
  error estimate for blocks of size 2^( 5) =       0.000435717646
  error estimate for blocks of size 2^( 6) =       0.000437201791
  error estimate for blocks of size 2^( 7) =       0.000437473709

      target function =                  N/A
              le_mean =     -17.216982928729
             les_mean =     296.757369365233
             stat err =       0.000435344788
             autocorr =       1.138738944585
              std dev =       0.576947452999
             le_variance =       0.332868363522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216982935887        initial  <--
     9.7656e+00     9.7656e+01             4.9297e-05       -17.216982827284
     3.9062e+01     3.9062e+02             1.2493e-05       -17.216982879461
     1.5625e+02     1.5625e+03             3.1339e-06       -17.216982928729

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1637
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.911943e-01 1 1  ON 0
 uu_1                 2.952018e-02 1 1  ON 1
 uu_2                -6.464812e-02 1 1  ON 2
 uu_3                -1.204179e-01 1 1  ON 3
 uu_4                -1.562030e-01 1 1  ON 4
 uu_5                -1.681916e-01 1 1  ON 5
 uu_6                -1.563010e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891584e-02 1 1  ON 8
 uu_9                 2.013271e-01 1 1  ON 9
 ud_0                 3.529657e-01 1 1  ON 10
 ud_1                 9.540149e-02 1 1  ON 11
 ud_2                -1.296564e-02 1 1  ON 12
 ud_3                -7.410816e-02 1 1  ON 13
 ud_4                -1.245672e-01 1 1  ON 14
 ud_5                -1.629627e-01 1 1  ON 15
 ud_6                -1.779133e-01 1 1  ON 16
 ud_7                -1.588960e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229793e-02 1 1  ON 19
 eO_0                -9.136246e-01 1 1  ON 20
 eO_1                -5.950464e-01 1 1  ON 21
 eO_2                -1.857576e-01 1 1  ON 22
 eO_3                 8.167705e-02 1 1  ON 23
 eO_4                 2.059807e-01 1 1  ON 24
 eO_5                 2.973225e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328920e-01 1 1  ON 27
 eO_8                 1.580909e-01 1 1  ON 28
 eO_9                 5.331337e-02 1 1  ON 29
eH1_0                -2.218422e-01 1 1  ON 30
eH1_1                -1.430028e-01 1 1  ON 31
eH1_2                -1.019356e-01 1 1  ON 32
eH1_3                -6.433047e-02 1 1  ON 33
eH1_4                -1.811759e-02 1 1  ON 34
eH1_5                -4.815902e-03 1 1  ON 35
eH1_6                 3.565012e-02 1 1  ON 36
eH1_7                 7.899421e-02 1 1  ON 37
eH1_8                 2.643012e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106707e-01 1 1  ON 40
eH2_1                -1.318811e-01 1 1  ON 41
eH2_2                -9.075414e-02 1 1  ON 42
eH2_3                -5.299759e-02 1 1  ON 43
eH2_4                -6.342714e-03 1 1  ON 44
eH2_5                 5.547749e-03 1 1  ON 45
eH2_6                 4.766239e-02 1 1  ON 46
eH2_7                 3.899719e-02 1 1  ON 47
eH2_8                 2.479174e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5106e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2719
    reference variance = 0.235783
====================================================
  Execution time = 2.0439e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1404e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5316e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314062820395
                                         uncertainty =       0.003321235508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314062820395
                                         uncertainty =       0.003321235508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396255467
  error estimate for blocks of size 2^( 2) =       0.000405999551
  error estimate for blocks of size 2^( 3) =       0.000414724256
  error estimate for blocks of size 2^( 4) =       0.000420821237
  error estimate for blocks of size 2^( 5) =       0.000424026416
  error estimate for blocks of size 2^( 6) =       0.000425529011
  error estimate for blocks of size 2^( 7) =       0.000427056499

      target function =                  N/A
              le_mean =     -17.216532587648
             les_mean =     296.723030974839
             stat err =       0.000424358291
             autocorr =       1.146871732607
              std dev =       0.560389855642
             le_variance =       0.314036790306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653258765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216532587648       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216532593138       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216532597076       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216532601897       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216532610834       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216532613037       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216532612020       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.509521e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216532587648       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216532589023       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216532590008       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216532591210       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216532593446       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216532594001       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216532593748       residual = 5.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.128444e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216532587648       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216532587992       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216532588238       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216532588538       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216532589098       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216532589236       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216532589173       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 2.821778e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155642 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5982e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.911947e-01 1 1  ON 0
 uu_1                 2.952010e-02 1 1  ON 1
 uu_2                -6.464846e-02 1 1  ON 2
 uu_3                -1.204180e-01 1 1  ON 3
 uu_4                -1.562031e-01 1 1  ON 4
 uu_5                -1.681916e-01 1 1  ON 5
 uu_6                -1.563009e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891584e-02 1 1  ON 8
 uu_9                 2.013271e-01 1 1  ON 9
 ud_0                 3.529665e-01 1 1  ON 10
 ud_1                 9.540147e-02 1 1  ON 11
 ud_2                -1.296560e-02 1 1  ON 12
 ud_3                -7.410877e-02 1 1  ON 13
 ud_4                -1.245676e-01 1 1  ON 14
 ud_5                -1.629627e-01 1 1  ON 15
 ud_6                -1.779133e-01 1 1  ON 16
 ud_7                -1.588960e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229786e-02 1 1  ON 19
 eO_0                -9.136257e-01 1 1  ON 20
 eO_1                -5.950466e-01 1 1  ON 21
 eO_2                -1.857572e-01 1 1  ON 22
 eO_3                 8.167780e-02 1 1  ON 23
 eO_4                 2.059810e-01 1 1  ON 24
 eO_5                 2.973225e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328919e-01 1 1  ON 27
 eO_8                 1.580909e-01 1 1  ON 28
 eO_9                 5.331340e-02 1 1  ON 29
eH1_0                -2.218425e-01 1 1  ON 30
eH1_1                -1.430026e-01 1 1  ON 31
eH1_2                -1.019355e-01 1 1  ON 32
eH1_3                -6.433027e-02 1 1  ON 33
eH1_4                -1.811768e-02 1 1  ON 34
eH1_5                -4.815790e-03 1 1  ON 35
eH1_6                 3.565014e-02 1 1  ON 36
eH1_7                 7.899402e-02 1 1  ON 37
eH1_8                 2.643011e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106707e-01 1 1  ON 40
eH2_1                -1.318809e-01 1 1  ON 41
eH2_2                -9.075408e-02 1 1  ON 42
eH2_3                -5.299760e-02 1 1  ON 43
eH2_4                -6.342912e-03 1 1  ON 44
eH2_5                 5.547662e-03 1 1  ON 45
eH2_6                 4.766234e-02 1 1  ON 46
eH2_7                 3.899729e-02 1 1  ON 47
eH2_8                 2.479173e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2065
    reference variance = 0.17449
====================================================
  Execution time = 2.0267e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322431752360
                                         uncertainty =       0.004446235558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322431752360
                                         uncertainty =       0.004446235558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401480664
  error estimate for blocks of size 2^( 2) =       0.000410736571
  error estimate for blocks of size 2^( 3) =       0.000418856227
  error estimate for blocks of size 2^( 4) =       0.000423982010
  error estimate for blocks of size 2^( 5) =       0.000426374634
  error estimate for blocks of size 2^( 6) =       0.000429642442
  error estimate for blocks of size 2^( 7) =       0.000431328472

      target function =                  N/A
              le_mean =     -17.217018449511
             les_mean =     296.748097576115
             stat err =       0.000427831889
             autocorr =       1.135578177471
              std dev =       0.567779399488
             le_variance =       0.322373446483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322435365976
                                         uncertainty =       0.004446312274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322435365976
                                         uncertainty =       0.004446312274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401482913
  error estimate for blocks of size 2^( 2) =       0.000410738737
  error estimate for blocks of size 2^( 3) =       0.000418858311
  error estimate for blocks of size 2^( 4) =       0.000423984045
  error estimate for blocks of size 2^( 5) =       0.000426376601
  error estimate for blocks of size 2^( 6) =       0.000429644395
  error estimate for blocks of size 2^( 7) =       0.000431330448

      target function =                  N/A
              le_mean =     -17.217018431578
             les_mean =     296.748100571549
             stat err =       0.000427833872
             autocorr =       1.135575978515
              std dev =       0.567782581146
             le_variance =       0.322377059453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322433563395
                                         uncertainty =       0.004446274023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322433563395
                                         uncertainty =       0.004446274023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401481791
  error estimate for blocks of size 2^( 2) =       0.000410737656
  error estimate for blocks of size 2^( 3) =       0.000418857272
  error estimate for blocks of size 2^( 4) =       0.000423983030
  error estimate for blocks of size 2^( 5) =       0.000426375620
  error estimate for blocks of size 2^( 6) =       0.000429643421
  error estimate for blocks of size 2^( 7) =       0.000431329462

      target function =                  N/A
              le_mean =     -17.217018440515
             les_mean =     296.748099077025
             stat err =       0.000427832883
             autocorr =       1.135577075750
              std dev =       0.567780994041
             le_variance =       0.322375257195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322431978868
                                         uncertainty =       0.004446240369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322431978868
                                         uncertainty =       0.004446240369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401480805
  error estimate for blocks of size 2^( 2) =       0.000410736707
  error estimate for blocks of size 2^( 3) =       0.000418856358
  error estimate for blocks of size 2^( 4) =       0.000423982137
  error estimate for blocks of size 2^( 5) =       0.000426374757
  error estimate for blocks of size 2^( 6) =       0.000429642564
  error estimate for blocks of size 2^( 7) =       0.000431328596

      target function =                  N/A
              le_mean =     -17.217018448385
             les_mean =     296.748097763806
             stat err =       0.000427832014
             autocorr =       1.135578039687
              std dev =       0.567779598920
             le_variance =       0.322373672950


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217018449511        initial  <--
     9.7656e+01     9.7656e+02             4.5095e-06       -17.217018431578
     3.9062e+02     3.9062e+03             1.1284e-06       -17.217018440515
     1.5625e+03     1.5625e+04             2.8218e-07       -17.217018448385

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4813
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.911943e-01 1 1  ON 0
 uu_1                 2.952018e-02 1 1  ON 1
 uu_2                -6.464812e-02 1 1  ON 2
 uu_3                -1.204179e-01 1 1  ON 3
 uu_4                -1.562030e-01 1 1  ON 4
 uu_5                -1.681916e-01 1 1  ON 5
 uu_6                -1.563010e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891584e-02 1 1  ON 8
 uu_9                 2.013271e-01 1 1  ON 9
 ud_0                 3.529657e-01 1 1  ON 10
 ud_1                 9.540149e-02 1 1  ON 11
 ud_2                -1.296564e-02 1 1  ON 12
 ud_3                -7.410816e-02 1 1  ON 13
 ud_4                -1.245672e-01 1 1  ON 14
 ud_5                -1.629627e-01 1 1  ON 15
 ud_6                -1.779133e-01 1 1  ON 16
 ud_7                -1.588960e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229793e-02 1 1  ON 19
 eO_0                -9.136246e-01 1 1  ON 20
 eO_1                -5.950464e-01 1 1  ON 21
 eO_2                -1.857576e-01 1 1  ON 22
 eO_3                 8.167705e-02 1 1  ON 23
 eO_4                 2.059807e-01 1 1  ON 24
 eO_5                 2.973225e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328920e-01 1 1  ON 27
 eO_8                 1.580909e-01 1 1  ON 28
 eO_9                 5.331337e-02 1 1  ON 29
eH1_0                -2.218422e-01 1 1  ON 30
eH1_1                -1.430028e-01 1 1  ON 31
eH1_2                -1.019356e-01 1 1  ON 32
eH1_3                -6.433047e-02 1 1  ON 33
eH1_4                -1.811759e-02 1 1  ON 34
eH1_5                -4.815902e-03 1 1  ON 35
eH1_6                 3.565012e-02 1 1  ON 36
eH1_7                 7.899421e-02 1 1  ON 37
eH1_8                 2.643012e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106707e-01 1 1  ON 40
eH2_1                -1.318811e-01 1 1  ON 41
eH2_2                -9.075414e-02 1 1  ON 42
eH2_3                -5.299759e-02 1 1  ON 43
eH2_4                -6.342714e-03 1 1  ON 44
eH2_5                 5.547749e-03 1 1  ON 45
eH2_6                 4.766239e-02 1 1  ON 46
eH2_7                 3.899719e-02 1 1  ON 47
eH2_8                 2.479174e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5485e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.3321
====================================================
  Execution time = 2.0381e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1512e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315153314020
                                         uncertainty =       0.002583943674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315153314020
                                         uncertainty =       0.002583943674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396940403
  error estimate for blocks of size 2^( 2) =       0.000406379637
  error estimate for blocks of size 2^( 3) =       0.000414967853
  error estimate for blocks of size 2^( 4) =       0.000420888324
  error estimate for blocks of size 2^( 5) =       0.000425392692
  error estimate for blocks of size 2^( 6) =       0.000425311369
  error estimate for blocks of size 2^( 7) =       0.000426376070

      target function =                  N/A
              le_mean =     -17.217308451647
             les_mean =     296.750833527936
             stat err =       0.000424492114
             autocorr =       1.143638167158
              std dev =       0.561358500724
             le_variance =       0.315123366335


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721730845165e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217308451647       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217308452048       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217308452504       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217308452927       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217308454408       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217308454368       residual = 5.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217308454318       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 4.178120e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217308451647       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217308451747       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217308451861       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217308451967       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217308452338       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217308452328       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217308452317       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.044624e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217308451647       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217308451672       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217308451701       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217308451728       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217308451824       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217308451814       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217308451814       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 2.611618e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.157921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5995e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.911943e-01 1 1  ON 0
 uu_1                 2.952018e-02 1 1  ON 1
 uu_2                -6.464812e-02 1 1  ON 2
 uu_3                -1.204179e-01 1 1  ON 3
 uu_4                -1.562031e-01 1 1  ON 4
 uu_5                -1.681916e-01 1 1  ON 5
 uu_6                -1.563010e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891584e-02 1 1  ON 8
 uu_9                 2.013271e-01 1 1  ON 9
 ud_0                 3.529657e-01 1 1  ON 10
 ud_1                 9.540151e-02 1 1  ON 11
 ud_2                -1.296566e-02 1 1  ON 12
 ud_3                -7.410819e-02 1 1  ON 13
 ud_4                -1.245672e-01 1 1  ON 14
 ud_5                -1.629627e-01 1 1  ON 15
 ud_6                -1.779133e-01 1 1  ON 16
 ud_7                -1.588960e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229793e-02 1 1  ON 19
 eO_0                -9.136247e-01 1 1  ON 20
 eO_1                -5.950464e-01 1 1  ON 21
 eO_2                -1.857576e-01 1 1  ON 22
 eO_3                 8.167713e-02 1 1  ON 23
 eO_4                 2.059807e-01 1 1  ON 24
 eO_5                 2.973225e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328920e-01 1 1  ON 27
 eO_8                 1.580909e-01 1 1  ON 28
 eO_9                 5.331338e-02 1 1  ON 29
eH1_0                -2.218422e-01 1 1  ON 30
eH1_1                -1.430028e-01 1 1  ON 31
eH1_2                -1.019356e-01 1 1  ON 32
eH1_3                -6.433048e-02 1 1  ON 33
eH1_4                -1.811758e-02 1 1  ON 34
eH1_5                -4.815883e-03 1 1  ON 35
eH1_6                 3.565014e-02 1 1  ON 36
eH1_7                 7.899420e-02 1 1  ON 37
eH1_8                 2.643012e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106707e-01 1 1  ON 40
eH2_1                -1.318811e-01 1 1  ON 41
eH2_2                -9.075414e-02 1 1  ON 42
eH2_3                -5.299758e-02 1 1  ON 43
eH2_4                -6.342708e-03 1 1  ON 44
eH2_5                 5.547754e-03 1 1  ON 45
eH2_6                 4.766238e-02 1 1  ON 46
eH2_7                 3.899720e-02 1 1  ON 47
eH2_8                 2.479174e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2106
    reference variance = 0.188001
====================================================
  Execution time = 1.9871e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2163e-01
  Total weights = 2.0000e+06
  Execution time = 1.8186e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663580374
                                         uncertainty =       0.005975765374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663580374
                                         uncertainty =       0.005975765374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401019519
  error estimate for blocks of size 2^( 2) =       0.000410541351
  error estimate for blocks of size 2^( 3) =       0.000418399682
  error estimate for blocks of size 2^( 4) =       0.000424016257
  error estimate for blocks of size 2^( 5) =       0.000429016345
  error estimate for blocks of size 2^( 6) =       0.000431486610
  error estimate for blocks of size 2^( 7) =       0.000431409979

      target function =                  N/A
              le_mean =     -17.217052462401
             les_mean =     296.748528641608
             stat err =       0.000428982298
             autocorr =       1.144320605930
              std dev =       0.567127242640
             le_variance =       0.321633309345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663733469
                                         uncertainty =       0.005975768884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663733469
                                         uncertainty =       0.005975768884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401019615
  error estimate for blocks of size 2^( 2) =       0.000410541440
  error estimate for blocks of size 2^( 3) =       0.000418399765
  error estimate for blocks of size 2^( 4) =       0.000424016334
  error estimate for blocks of size 2^( 5) =       0.000429016419
  error estimate for blocks of size 2^( 6) =       0.000431486683
  error estimate for blocks of size 2^( 7) =       0.000431410047

      target function =                  N/A
              le_mean =     -17.217052462970
             les_mean =     296.748528814329
             stat err =       0.000428982371
             autocorr =       1.144320451338
              std dev =       0.567127377659
             le_variance =       0.321633462491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663656929
                                         uncertainty =       0.005975767129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663656929
                                         uncertainty =       0.005975767129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401019567
  error estimate for blocks of size 2^( 2) =       0.000410541396
  error estimate for blocks of size 2^( 3) =       0.000418399724
  error estimate for blocks of size 2^( 4) =       0.000424016296
  error estimate for blocks of size 2^( 5) =       0.000429016382
  error estimate for blocks of size 2^( 6) =       0.000431486647
  error estimate for blocks of size 2^( 7) =       0.000431410013

      target function =                  N/A
              le_mean =     -17.217052462686
             les_mean =     296.748528727977
             stat err =       0.000428982334
             autocorr =       1.144320528622
              std dev =       0.567127310156
             le_variance =       0.321633385925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663589943
                                         uncertainty =       0.005975765593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663589943
                                         uncertainty =       0.005975765593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401019525
  error estimate for blocks of size 2^( 2) =       0.000410541356
  error estimate for blocks of size 2^( 3) =       0.000418399688
  error estimate for blocks of size 2^( 4) =       0.000424016262
  error estimate for blocks of size 2^( 5) =       0.000429016350
  error estimate for blocks of size 2^( 6) =       0.000431486614
  error estimate for blocks of size 2^( 7) =       0.000431409983

      target function =                  N/A
              le_mean =     -17.217052462437
             les_mean =     296.748528652405
             stat err =       0.000428982302
             autocorr =       1.144320596261
              std dev =       0.567127251080
             le_variance =       0.321633318917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217052462401        initial
     9.7656e+02     9.7656e+03             4.1781e-07       -17.217052462970  <--
     3.9062e+03     3.9062e+04             1.0446e-07       -17.217052462686
     1.5625e+04     1.5625e+05             2.6116e-08       -17.217052462437

*****************************************************************************
Applying the update for shift_i =   9.7656e+02     and shift_s =   9.7656e+03
*****************************************************************************

  Execution time = 2.9073e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.911942e-01 1 1  ON 0
 uu_1                 2.952021e-02 1 1  ON 1
 uu_2                -6.464810e-02 1 1  ON 2
 uu_3                -1.204179e-01 1 1  ON 3
 uu_4                -1.562031e-01 1 1  ON 4
 uu_5                -1.681917e-01 1 1  ON 5
 uu_6                -1.563009e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891581e-02 1 1  ON 8
 uu_9                 2.013271e-01 1 1  ON 9
 ud_0                 3.529658e-01 1 1  ON 10
 ud_1                 9.540158e-02 1 1  ON 11
 ud_2                -1.296571e-02 1 1  ON 12
 ud_3                -7.410829e-02 1 1  ON 13
 ud_4                -1.245674e-01 1 1  ON 14
 ud_5                -1.629626e-01 1 1  ON 15
 ud_6                -1.779132e-01 1 1  ON 16
 ud_7                -1.588960e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229792e-02 1 1  ON 19
 eO_0                -9.136250e-01 1 1  ON 20
 eO_1                -5.950466e-01 1 1  ON 21
 eO_2                -1.857574e-01 1 1  ON 22
 eO_3                 8.167735e-02 1 1  ON 23
 eO_4                 2.059808e-01 1 1  ON 24
 eO_5                 2.973225e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328920e-01 1 1  ON 27
 eO_8                 1.580909e-01 1 1  ON 28
 eO_9                 5.331338e-02 1 1  ON 29
eH1_0                -2.218422e-01 1 1  ON 30
eH1_1                -1.430028e-01 1 1  ON 31
eH1_2                -1.019356e-01 1 1  ON 32
eH1_3                -6.433052e-02 1 1  ON 33
eH1_4                -1.811755e-02 1 1  ON 34
eH1_5                -4.815828e-03 1 1  ON 35
eH1_6                 3.565017e-02 1 1  ON 36
eH1_7                 7.899416e-02 1 1  ON 37
eH1_8                 2.643011e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106708e-01 1 1  ON 40
eH2_1                -1.318811e-01 1 1  ON 41
eH2_2                -9.075415e-02 1 1  ON 42
eH2_3                -5.299757e-02 1 1  ON 43
eH2_4                -6.342690e-03 1 1  ON 44
eH2_5                 5.547769e-03 1 1  ON 45
eH2_6                 4.766235e-02 1 1  ON 46
eH2_7                 3.899723e-02 1 1  ON 47
eH2_8                 2.479174e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5073e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1333
    reference variance = 0.276904
====================================================
  Execution time = 2.2094e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1819e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318330723149
                                         uncertainty =       0.003256194681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318330723149
                                         uncertainty =       0.003256194681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398869829
  error estimate for blocks of size 2^( 2) =       0.000408294300
  error estimate for blocks of size 2^( 3) =       0.000416657453
  error estimate for blocks of size 2^( 4) =       0.000422570775
  error estimate for blocks of size 2^( 5) =       0.000426745250
  error estimate for blocks of size 2^( 6) =       0.000428257037
  error estimate for blocks of size 2^( 7) =       0.000431351635

      target function =                  N/A
              le_mean =     -17.216605799046
             les_mean =     296.729709361188
             stat err =       0.000427231174
             autocorr =       1.147264342630
              std dev =       0.564087121398
             le_variance =       0.318194280527


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721660579905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605799046       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605796563       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605797913       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605800464       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216605803473       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216605802682       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605802872       residual = 7.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.760042e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605799046       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605798425       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605798762       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605799400       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216605800154       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216605799956       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605800003       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 4.401833e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216605799046       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216605798891       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216605798975       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216605799135       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216605799320       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216605799275       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216605799283       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.100566e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160198 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7563e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.911943e-01 1 1  ON 0
 uu_1                 2.952020e-02 1 1  ON 1
 uu_2                -6.464820e-02 1 1  ON 2
 uu_3                -1.204180e-01 1 1  ON 3
 uu_4                -1.562031e-01 1 1  ON 4
 uu_5                -1.681917e-01 1 1  ON 5
 uu_6                -1.563009e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891578e-02 1 1  ON 8
 uu_9                 2.013271e-01 1 1  ON 9
 ud_0                 3.529660e-01 1 1  ON 10
 ud_1                 9.540162e-02 1 1  ON 11
 ud_2                -1.296574e-02 1 1  ON 12
 ud_3                -7.410850e-02 1 1  ON 13
 ud_4                -1.245676e-01 1 1  ON 14
 ud_5                -1.629626e-01 1 1  ON 15
 ud_6                -1.779131e-01 1 1  ON 16
 ud_7                -1.588959e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229789e-02 1 1  ON 19
 eO_0                -9.136254e-01 1 1  ON 20
 eO_1                -5.950467e-01 1 1  ON 21
 eO_2                -1.857573e-01 1 1  ON 22
 eO_3                 8.167761e-02 1 1  ON 23
 eO_4                 2.059810e-01 1 1  ON 24
 eO_5                 2.973224e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328919e-01 1 1  ON 27
 eO_8                 1.580909e-01 1 1  ON 28
 eO_9                 5.331338e-02 1 1  ON 29
eH1_0                -2.218422e-01 1 1  ON 30
eH1_1                -1.430029e-01 1 1  ON 31
eH1_2                -1.019356e-01 1 1  ON 32
eH1_3                -6.433049e-02 1 1  ON 33
eH1_4                -1.811747e-02 1 1  ON 34
eH1_5                -4.815727e-03 1 1  ON 35
eH1_6                 3.565018e-02 1 1  ON 36
eH1_7                 7.899409e-02 1 1  ON 37
eH1_8                 2.643011e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106709e-01 1 1  ON 40
eH2_1                -1.318812e-01 1 1  ON 41
eH2_2                -9.075408e-02 1 1  ON 42
eH2_3                -5.299753e-02 1 1  ON 43
eH2_4                -6.342659e-03 1 1  ON 44
eH2_5                 5.547837e-03 1 1  ON 45
eH2_6                 4.766236e-02 1 1  ON 46
eH2_7                 3.899727e-02 1 1  ON 47
eH2_8                 2.479173e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.191
    reference variance = 0.408971
====================================================
  Execution time = 1.9824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1326e-01
  Total weights = 2.0000e+06
  Execution time = 1.8164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379068438
                                         uncertainty =       0.003034583053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379068438
                                         uncertainty =       0.003034583053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395764226
  error estimate for blocks of size 2^( 2) =       0.000405072512
  error estimate for blocks of size 2^( 3) =       0.000413386360
  error estimate for blocks of size 2^( 4) =       0.000419389864
  error estimate for blocks of size 2^( 5) =       0.000422306373
  error estimate for blocks of size 2^( 6) =       0.000421172544
  error estimate for blocks of size 2^( 7) =       0.000422678581

      target function =                  N/A
              le_mean =     -17.216503989095
             les_mean =     296.721268095449
             stat err =       0.000421386841
             autocorr =       1.133675778502
              std dev =       0.559695136264
             le_variance =       0.313258645558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379943363
                                         uncertainty =       0.003034592285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379943363
                                         uncertainty =       0.003034592285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395764779
  error estimate for blocks of size 2^( 2) =       0.000405073035
  error estimate for blocks of size 2^( 3) =       0.000413386859
  error estimate for blocks of size 2^( 4) =       0.000419390336
  error estimate for blocks of size 2^( 5) =       0.000422306820
  error estimate for blocks of size 2^( 6) =       0.000421172989
  error estimate for blocks of size 2^( 7) =       0.000422679034

      target function =                  N/A
              le_mean =     -17.216503993945
             les_mean =     296.721269136845
             stat err =       0.000421387295
             autocorr =       1.133675058343
              std dev =       0.559695917405
             le_variance =       0.313259519960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379506214
                                         uncertainty =       0.003034587673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379506214
                                         uncertainty =       0.003034587673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395764503
  error estimate for blocks of size 2^( 2) =       0.000405072774
  error estimate for blocks of size 2^( 3) =       0.000413386610
  error estimate for blocks of size 2^( 4) =       0.000419390100
  error estimate for blocks of size 2^( 5) =       0.000422306597
  error estimate for blocks of size 2^( 6) =       0.000421172767
  error estimate for blocks of size 2^( 7) =       0.000422678808

      target function =                  N/A
              le_mean =     -17.216503991521
             les_mean =     296.721268616495
             stat err =       0.000421387068
             autocorr =       1.133675418172
              std dev =       0.559695527115
             le_variance =       0.313259083072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379123170
                                         uncertainty =       0.003034583631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313379123170
                                         uncertainty =       0.003034583631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395764261
  error estimate for blocks of size 2^( 2) =       0.000405072545
  error estimate for blocks of size 2^( 3) =       0.000413386392
  error estimate for blocks of size 2^( 4) =       0.000419389894
  error estimate for blocks of size 2^( 5) =       0.000422306401
  error estimate for blocks of size 2^( 6) =       0.000421172572
  error estimate for blocks of size 2^( 7) =       0.000422678609

      target function =                  N/A
              le_mean =     -17.216503989398
             les_mean =     296.721268160588
             stat err =       0.000421386869
             autocorr =       1.133675733446
              std dev =       0.559695185129
             le_variance =       0.313258700257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216503989095        initial
     2.4414e+02     2.4414e+03             1.7600e-06       -17.216503993945  <--
     9.7656e+02     9.7656e+03             4.4018e-07       -17.216503991521
     3.9062e+03     3.9062e+04             1.1006e-07       -17.216503989398

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9033e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.911947e-01 1 1  ON 0
 uu_1                 2.952019e-02 1 1  ON 1
 uu_2                -6.464850e-02 1 1  ON 2
 uu_3                -1.204180e-01 1 1  ON 3
 uu_4                -1.562031e-01 1 1  ON 4
 uu_5                -1.681919e-01 1 1  ON 5
 uu_6                -1.563009e-01 1 1  ON 6
 uu_7                -1.093941e-01 1 1  ON 7
 uu_8                -3.891570e-02 1 1  ON 8
 uu_9                 2.013270e-01 1 1  ON 9
 ud_0                 3.529667e-01 1 1  ON 10
 ud_1                 9.540176e-02 1 1  ON 11
 ud_2                -1.296585e-02 1 1  ON 12
 ud_3                -7.410911e-02 1 1  ON 13
 ud_4                -1.245681e-01 1 1  ON 14
 ud_5                -1.629627e-01 1 1  ON 15
 ud_6                -1.779128e-01 1 1  ON 16
 ud_7                -1.588957e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229782e-02 1 1  ON 19
 eO_0                -9.136267e-01 1 1  ON 20
 eO_1                -5.950470e-01 1 1  ON 21
 eO_2                -1.857568e-01 1 1  ON 22
 eO_3                 8.167837e-02 1 1  ON 23
 eO_4                 2.059815e-01 1 1  ON 24
 eO_5                 2.973222e-01 1 1  ON 25
 eO_6                 3.259210e-01 1 1  ON 26
 eO_7                 5.328919e-01 1 1  ON 27
 eO_8                 1.580910e-01 1 1  ON 28
 eO_9                 5.331340e-02 1 1  ON 29
eH1_0                -2.218424e-01 1 1  ON 30
eH1_1                -1.430033e-01 1 1  ON 31
eH1_2                -1.019355e-01 1 1  ON 32
eH1_3                -6.433042e-02 1 1  ON 33
eH1_4                -1.811722e-02 1 1  ON 34
eH1_5                -4.815425e-03 1 1  ON 35
eH1_6                 3.565019e-02 1 1  ON 36
eH1_7                 7.899390e-02 1 1  ON 37
eH1_8                 2.643011e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106712e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075386e-02 1 1  ON 42
eH2_3                -5.299740e-02 1 1  ON 43
eH2_4                -6.342567e-03 1 1  ON 44
eH2_5                 5.548041e-03 1 1  ON 45
eH2_6                 4.766241e-02 1 1  ON 46
eH2_7                 3.899740e-02 1 1  ON 47
eH2_8                 2.479173e-01 1 1  ON 48
eH2_9                 1.153678e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2341
    reference variance = 0.183381
====================================================
  Execution time = 2.0025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1084e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310796446405
                                         uncertainty =       0.003524055015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310796446405
                                         uncertainty =       0.003524055015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394236256
  error estimate for blocks of size 2^( 2) =       0.000404260797
  error estimate for blocks of size 2^( 3) =       0.000412387357
  error estimate for blocks of size 2^( 4) =       0.000418234593
  error estimate for blocks of size 2^( 5) =       0.000422267410
  error estimate for blocks of size 2^( 6) =       0.000424374939
  error estimate for blocks of size 2^( 7) =       0.000425436620

      target function =                  N/A
              le_mean =     -17.217149394327
             les_mean =     296.741077562014
             stat err =       0.000422578391
             autocorr =       1.148950838642
              std dev =       0.557534259819
             le_variance =       0.310844450872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721714939433e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217149394327       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217149402323       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217149422665       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217149426242       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217149431833       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217149433709       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217149432257       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.323662e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217149394327       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217149396332       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217149401435       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217149402332       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217149403735       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217149404210       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217149403849       residual = 7.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.832157e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217149394327       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217149394828       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217149396105       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217149396330       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217149396681       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217149396800       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217149396710       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 4.581179e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5572e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.911950e-01 1 1  ON 0
 uu_1                 2.952041e-02 1 1  ON 1
 uu_2                -6.464885e-02 1 1  ON 2
 uu_3                -1.204181e-01 1 1  ON 3
 uu_4                -1.562033e-01 1 1  ON 4
 uu_5                -1.681916e-01 1 1  ON 5
 uu_6                -1.563008e-01 1 1  ON 6
 uu_7                -1.093944e-01 1 1  ON 7
 uu_8                -3.891575e-02 1 1  ON 8
 uu_9                 2.013269e-01 1 1  ON 9
 ud_0                 3.529680e-01 1 1  ON 10
 ud_1                 9.540171e-02 1 1  ON 11
 ud_2                -1.296580e-02 1 1  ON 12
 ud_3                -7.410994e-02 1 1  ON 13
 ud_4                -1.245690e-01 1 1  ON 14
 ud_5                -1.629626e-01 1 1  ON 15
 ud_6                -1.779126e-01 1 1  ON 16
 ud_7                -1.588957e-01 1 1  ON 17
 ud_8                -1.113544e-01 1 1  ON 18
 ud_9                 3.229770e-02 1 1  ON 19
 eO_0                -9.136286e-01 1 1  ON 20
 eO_1                -5.950477e-01 1 1  ON 21
 eO_2                -1.857559e-01 1 1  ON 22
 eO_3                 8.168000e-02 1 1  ON 23
 eO_4                 2.059821e-01 1 1  ON 24
 eO_5                 2.973219e-01 1 1  ON 25
 eO_6                 3.259209e-01 1 1  ON 26
 eO_7                 5.328917e-01 1 1  ON 27
 eO_8                 1.580911e-01 1 1  ON 28
 eO_9                 5.331343e-02 1 1  ON 29
eH1_0                -2.218424e-01 1 1  ON 30
eH1_1                -1.430033e-01 1 1  ON 31
eH1_2                -1.019351e-01 1 1  ON 32
eH1_3                -6.433072e-02 1 1  ON 33
eH1_4                -1.811681e-02 1 1  ON 34
eH1_5                -4.815581e-03 1 1  ON 35
eH1_6                 3.565024e-02 1 1  ON 36
eH1_7                 7.899366e-02 1 1  ON 37
eH1_8                 2.643009e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106713e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075362e-02 1 1  ON 42
eH2_3                -5.299753e-02 1 1  ON 43
eH2_4                -6.342619e-03 1 1  ON 44
eH2_5                 5.548180e-03 1 1  ON 45
eH2_6                 4.766222e-02 1 1  ON 46
eH2_7                 3.899745e-02 1 1  ON 47
eH2_8                 2.479172e-01 1 1  ON 48
eH2_9                 1.153679e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1541
    reference variance = 0.198104
====================================================
  Execution time = 1.9915e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3077e-01
  Total weights = 2.0000e+06
  Execution time = 1.8154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330756066059
                                         uncertainty =       0.008799126892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330756066059
                                         uncertainty =       0.008799126892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406674080
  error estimate for blocks of size 2^( 2) =       0.000416069841
  error estimate for blocks of size 2^( 3) =       0.000424086098
  error estimate for blocks of size 2^( 4) =       0.000429993441
  error estimate for blocks of size 2^( 5) =       0.000434505224
  error estimate for blocks of size 2^( 6) =       0.000436657065
  error estimate for blocks of size 2^( 7) =       0.000437555131

      target function =                  N/A
              le_mean =     -17.216947870639
             les_mean =     296.754061429071
             stat err =       0.000434677715
             autocorr =       1.142462007882
              std dev =       0.575123998950
             le_variance =       0.330767614168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330761386011
                                         uncertainty =       0.008799270509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330761386011
                                         uncertainty =       0.008799270509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406677350
  error estimate for blocks of size 2^( 2) =       0.000416072986
  error estimate for blocks of size 2^( 3) =       0.000424089118
  error estimate for blocks of size 2^( 4) =       0.000429996372
  error estimate for blocks of size 2^( 5) =       0.000434508156
  error estimate for blocks of size 2^( 6) =       0.000436659968
  error estimate for blocks of size 2^( 7) =       0.000437557954

      target function =                  N/A
              le_mean =     -17.216947896499
             les_mean =     296.754067639650
             stat err =       0.000434680613
             autocorr =       1.142458861592
              std dev =       0.575128624120
             le_variance =       0.330772934282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330758736897
                                         uncertainty =       0.008799199078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330758736897
                                         uncertainty =       0.008799199078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406675722
  error estimate for blocks of size 2^( 2) =       0.000416071420
  error estimate for blocks of size 2^( 3) =       0.000424087614
  error estimate for blocks of size 2^( 4) =       0.000429994913
  error estimate for blocks of size 2^( 5) =       0.000434506696
  error estimate for blocks of size 2^( 6) =       0.000436658522
  error estimate for blocks of size 2^( 7) =       0.000437556549

      target function =                  N/A
              le_mean =     -17.216947883626
             les_mean =     296.754064547214
             stat err =       0.000434679170
             autocorr =       1.142460428803
              std dev =       0.575126320984
             le_variance =       0.330770285088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330756400243
                                         uncertainty =       0.008799135927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330756400243
                                         uncertainty =       0.008799135927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406674285
  error estimate for blocks of size 2^( 2) =       0.000416070039
  error estimate for blocks of size 2^( 3) =       0.000424086288
  error estimate for blocks of size 2^( 4) =       0.000429993625
  error estimate for blocks of size 2^( 5) =       0.000434505409
  error estimate for blocks of size 2^( 6) =       0.000436657248
  error estimate for blocks of size 2^( 7) =       0.000437555309

      target function =                  N/A
              le_mean =     -17.216947872263
             les_mean =     296.754061819190
             stat err =       0.000434677897
             autocorr =       1.142461810311
              std dev =       0.575124289491
             le_variance =       0.330767948362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216947870639        initial
     6.1035e+01     6.1035e+02             7.3237e-06       -17.216947896499  <--
     2.4414e+02     2.4414e+03             1.8322e-06       -17.216947883626
     9.7656e+02     9.7656e+03             4.5812e-07       -17.216947872263

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9091e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.911960e-01 1 1  ON 0
 uu_1                 2.952106e-02 1 1  ON 1
 uu_2                -6.464990e-02 1 1  ON 2
 uu_3                -1.204184e-01 1 1  ON 3
 uu_4                -1.562040e-01 1 1  ON 4
 uu_5                -1.681904e-01 1 1  ON 5
 uu_6                -1.563007e-01 1 1  ON 6
 uu_7                -1.093953e-01 1 1  ON 7
 uu_8                -3.891589e-02 1 1  ON 8
 uu_9                 2.013266e-01 1 1  ON 9
 ud_0                 3.529720e-01 1 1  ON 10
 ud_1                 9.540157e-02 1 1  ON 11
 ud_2                -1.296565e-02 1 1  ON 12
 ud_3                -7.411242e-02 1 1  ON 13
 ud_4                -1.245715e-01 1 1  ON 14
 ud_5                -1.629620e-01 1 1  ON 15
 ud_6                -1.779122e-01 1 1  ON 16
 ud_7                -1.588956e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229732e-02 1 1  ON 19
 eO_0                -9.136341e-01 1 1  ON 20
 eO_1                -5.950498e-01 1 1  ON 21
 eO_2                -1.857531e-01 1 1  ON 22
 eO_3                 8.168489e-02 1 1  ON 23
 eO_4                 2.059836e-01 1 1  ON 24
 eO_5                 2.973208e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328911e-01 1 1  ON 27
 eO_8                 1.580913e-01 1 1  ON 28
 eO_9                 5.331351e-02 1 1  ON 29
eH1_0                -2.218425e-01 1 1  ON 30
eH1_1                -1.430033e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433161e-02 1 1  ON 33
eH1_4                -1.811556e-02 1 1  ON 34
eH1_5                -4.816044e-03 1 1  ON 35
eH1_6                 3.565040e-02 1 1  ON 36
eH1_7                 7.899295e-02 1 1  ON 37
eH1_8                 2.643003e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106714e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075292e-02 1 1  ON 42
eH2_3                -5.299792e-02 1 1  ON 43
eH2_4                -6.342778e-03 1 1  ON 44
eH2_5                 5.548596e-03 1 1  ON 45
eH2_6                 4.766165e-02 1 1  ON 46
eH2_7                 3.899761e-02 1 1  ON 47
eH2_8                 2.479169e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4670e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2609
    reference variance = 0.208738
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1340e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6055e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313394569984
                                         uncertainty =       0.003301911802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313394569984
                                         uncertainty =       0.003301911802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395850907
  error estimate for blocks of size 2^( 2) =       0.000405767545
  error estimate for blocks of size 2^( 3) =       0.000413928206
  error estimate for blocks of size 2^( 4) =       0.000419550030
  error estimate for blocks of size 2^( 5) =       0.000423532501
  error estimate for blocks of size 2^( 6) =       0.000426442703
  error estimate for blocks of size 2^( 7) =       0.000426621893

      target function =                  N/A
              le_mean =     -17.216675225935
             les_mean =     296.727301559030
             stat err =       0.000424036782
             autocorr =       1.147476425559
              std dev =       0.559817720689
             le_variance =       0.313395880397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721667522594e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216675225935       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216675258528       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216675284871       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675264185       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216675259692       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216675272565       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216675280450       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.216675287168       residual = 1.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 3.102097e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216675225935       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216675234149       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216675240861       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675235594       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216675234423       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216675237590       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216675239590       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 7.734950e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216675225935       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216675227993       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216675229679       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216675228356       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216675228060       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216675228849       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216675229351       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 1.936597e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164813 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6227e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.911982e-01 1 1  ON 0
 uu_1                 2.952219e-02 1 1  ON 1
 uu_2                -6.465113e-02 1 1  ON 2
 uu_3                -1.204177e-01 1 1  ON 3
 uu_4                -1.562054e-01 1 1  ON 4
 uu_5                -1.681910e-01 1 1  ON 5
 uu_6                -1.563008e-01 1 1  ON 6
 uu_7                -1.093962e-01 1 1  ON 7
 uu_8                -3.891603e-02 1 1  ON 8
 uu_9                 2.013262e-01 1 1  ON 9
 ud_0                 3.529747e-01 1 1  ON 10
 ud_1                 9.540368e-02 1 1  ON 11
 ud_2                -1.296558e-02 1 1  ON 12
 ud_3                -7.411467e-02 1 1  ON 13
 ud_4                -1.245734e-01 1 1  ON 14
 ud_5                -1.629618e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588963e-01 1 1  ON 17
 ud_8                -1.113551e-01 1 1  ON 18
 ud_9                 3.229678e-02 1 1  ON 19
 eO_0                -9.136418e-01 1 1  ON 20
 eO_1                -5.950516e-01 1 1  ON 21
 eO_2                -1.857506e-01 1 1  ON 22
 eO_3                 8.169037e-02 1 1  ON 23
 eO_4                 2.059863e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259200e-01 1 1  ON 26
 eO_7                 5.328905e-01 1 1  ON 27
 eO_8                 1.580915e-01 1 1  ON 28
 eO_9                 5.331362e-02 1 1  ON 29
eH1_0                -2.218444e-01 1 1  ON 30
eH1_1                -1.430038e-01 1 1  ON 31
eH1_2                -1.019322e-01 1 1  ON 32
eH1_3                -6.433302e-02 1 1  ON 33
eH1_4                -1.811388e-02 1 1  ON 34
eH1_5                -4.814400e-03 1 1  ON 35
eH1_6                 3.565034e-02 1 1  ON 36
eH1_7                 7.899201e-02 1 1  ON 37
eH1_8                 2.642999e-01 1 1  ON 38
eH1_9                 1.135318e-01 1 1  ON 39
eH2_0                -2.106715e-01 1 1  ON 40
eH2_1                -1.318812e-01 1 1  ON 41
eH2_2                -9.075229e-02 1 1  ON 42
eH2_3                -5.299633e-02 1 1  ON 43
eH2_4                -6.343686e-03 1 1  ON 44
eH2_5                 5.548244e-03 1 1  ON 45
eH2_6                 4.766034e-02 1 1  ON 46
eH2_7                 3.899778e-02 1 1  ON 47
eH2_8                 2.479166e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2436
    reference variance = 0.262362
====================================================
  Execution time = 1.9805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2045e-01
  Total weights = 2.0000e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320471341536
                                         uncertainty =       0.004949082979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320471341536
                                         uncertainty =       0.004949082979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400276646
  error estimate for blocks of size 2^( 2) =       0.000409841333
  error estimate for blocks of size 2^( 3) =       0.000418761649
  error estimate for blocks of size 2^( 4) =       0.000425542813
  error estimate for blocks of size 2^( 5) =       0.000429884901
  error estimate for blocks of size 2^( 6) =       0.000431128084
  error estimate for blocks of size 2^( 7) =       0.000433995001

      target function =                  N/A
              le_mean =     -17.216535933594
             les_mean =     296.729552179007
             stat err =       0.000430137700
             autocorr =       1.154767394107
              std dev =       0.566076661326
             le_variance =       0.320442786498

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320482201009
                                         uncertainty =       0.004949293636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320482201009
                                         uncertainty =       0.004949293636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400283432
  error estimate for blocks of size 2^( 2) =       0.000409847773
  error estimate for blocks of size 2^( 3) =       0.000418767762
  error estimate for blocks of size 2^( 4) =       0.000425548700
  error estimate for blocks of size 2^( 5) =       0.000429890653
  error estimate for blocks of size 2^( 6) =       0.000431133700
  error estimate for blocks of size 2^( 7) =       0.000434000406

      target function =                  N/A
              le_mean =     -17.216535908483
             les_mean =     296.729562179381
             stat err =       0.000430143365
             autocorr =       1.154758658900
              std dev =       0.566086258038
             le_variance =       0.320453651539

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320476682415
                                         uncertainty =       0.004949183866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320476682415
                                         uncertainty =       0.004949183866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400279983
  error estimate for blocks of size 2^( 2) =       0.000409844501
  error estimate for blocks of size 2^( 3) =       0.000418764655
  error estimate for blocks of size 2^( 4) =       0.000425545713
  error estimate for blocks of size 2^( 5) =       0.000429887736
  error estimate for blocks of size 2^( 6) =       0.000431130847
  error estimate for blocks of size 2^( 7) =       0.000433997652

      target function =                  N/A
              le_mean =     -17.216535920998
             les_mean =     296.729557089157
             stat err =       0.000430140487
             autocorr =       1.154763103248
              std dev =       0.566081381401
             le_variance =       0.320448130369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320472009893
                                         uncertainty =       0.004949095594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320472009893
                                         uncertainty =       0.004949095594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400277064
  error estimate for blocks of size 2^( 2) =       0.000409841730
  error estimate for blocks of size 2^( 3) =       0.000418762025
  error estimate for blocks of size 2^( 4) =       0.000425543176
  error estimate for blocks of size 2^( 5) =       0.000429885256
  error estimate for blocks of size 2^( 6) =       0.000431128430
  error estimate for blocks of size 2^( 7) =       0.000433995332

      target function =                  N/A
              le_mean =     -17.216535931994
             les_mean =     296.729552792639
             stat err =       0.000430138049
             autocorr =       1.154766856751
              std dev =       0.566077251998
             le_variance =       0.320443455230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216535933594        initial  <--
     1.5259e+01     1.5259e+02             3.1021e-05       -17.216535908483
     6.1035e+01     6.1035e+02             7.7350e-06       -17.216535920998
     2.4414e+02     2.4414e+03             1.9366e-06       -17.216535931994

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9706
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.911960e-01 1 1  ON 0
 uu_1                 2.952106e-02 1 1  ON 1
 uu_2                -6.464990e-02 1 1  ON 2
 uu_3                -1.204184e-01 1 1  ON 3
 uu_4                -1.562040e-01 1 1  ON 4
 uu_5                -1.681904e-01 1 1  ON 5
 uu_6                -1.563007e-01 1 1  ON 6
 uu_7                -1.093953e-01 1 1  ON 7
 uu_8                -3.891589e-02 1 1  ON 8
 uu_9                 2.013266e-01 1 1  ON 9
 ud_0                 3.529720e-01 1 1  ON 10
 ud_1                 9.540157e-02 1 1  ON 11
 ud_2                -1.296565e-02 1 1  ON 12
 ud_3                -7.411242e-02 1 1  ON 13
 ud_4                -1.245715e-01 1 1  ON 14
 ud_5                -1.629620e-01 1 1  ON 15
 ud_6                -1.779122e-01 1 1  ON 16
 ud_7                -1.588956e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229732e-02 1 1  ON 19
 eO_0                -9.136341e-01 1 1  ON 20
 eO_1                -5.950498e-01 1 1  ON 21
 eO_2                -1.857531e-01 1 1  ON 22
 eO_3                 8.168489e-02 1 1  ON 23
 eO_4                 2.059836e-01 1 1  ON 24
 eO_5                 2.973208e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328911e-01 1 1  ON 27
 eO_8                 1.580913e-01 1 1  ON 28
 eO_9                 5.331351e-02 1 1  ON 29
eH1_0                -2.218425e-01 1 1  ON 30
eH1_1                -1.430033e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433161e-02 1 1  ON 33
eH1_4                -1.811556e-02 1 1  ON 34
eH1_5                -4.816044e-03 1 1  ON 35
eH1_6                 3.565040e-02 1 1  ON 36
eH1_7                 7.899295e-02 1 1  ON 37
eH1_8                 2.643003e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106714e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075292e-02 1 1  ON 42
eH2_3                -5.299792e-02 1 1  ON 43
eH2_4                -6.342778e-03 1 1  ON 44
eH2_5                 5.548596e-03 1 1  ON 45
eH2_6                 4.766165e-02 1 1  ON 46
eH2_7                 3.899761e-02 1 1  ON 47
eH2_8                 2.479169e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1464
    reference variance = 0.165679
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1830e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4989e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318244993290
                                         uncertainty =       0.004327446796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318244993290
                                         uncertainty =       0.004327446796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398938900
  error estimate for blocks of size 2^( 2) =       0.000408323797
  error estimate for blocks of size 2^( 3) =       0.000416762401
  error estimate for blocks of size 2^( 4) =       0.000423083312
  error estimate for blocks of size 2^( 5) =       0.000426686126
  error estimate for blocks of size 2^( 6) =       0.000428980037
  error estimate for blocks of size 2^( 7) =       0.000428913775

      target function =                  N/A
              le_mean =     -17.216502577997
             les_mean =     296.726265350906
             stat err =       0.000426915812
             autocorr =       1.145174607349
              std dev =       0.564184802951
             le_variance =       0.318304491881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721650257800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502577997       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502580069       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502580262       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502583008       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502584095       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502583392       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502582184       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.956438e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502577997       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502578515       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502578563       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502579250       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502579523       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502579347       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502579045       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 7.396358e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216502577997       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216502578127       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216502578139       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216502578308       residual = 8.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216502578379       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216502578335       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216502578259       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 1.849419e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.167093 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5690e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.911962e-01 1 1  ON 0
 uu_1                 2.952113e-02 1 1  ON 1
 uu_2                -6.465000e-02 1 1  ON 2
 uu_3                -1.204186e-01 1 1  ON 3
 uu_4                -1.562041e-01 1 1  ON 4
 uu_5                -1.681905e-01 1 1  ON 5
 uu_6                -1.563007e-01 1 1  ON 6
 uu_7                -1.093952e-01 1 1  ON 7
 uu_8                -3.891583e-02 1 1  ON 8
 uu_9                 2.013266e-01 1 1  ON 9
 ud_0                 3.529722e-01 1 1  ON 10
 ud_1                 9.540167e-02 1 1  ON 11
 ud_2                -1.296577e-02 1 1  ON 12
 ud_3                -7.411267e-02 1 1  ON 13
 ud_4                -1.245717e-01 1 1  ON 14
 ud_5                -1.629621e-01 1 1  ON 15
 ud_6                -1.779121e-01 1 1  ON 16
 ud_7                -1.588955e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229731e-02 1 1  ON 19
 eO_0                -9.136348e-01 1 1  ON 20
 eO_1                -5.950498e-01 1 1  ON 21
 eO_2                -1.857527e-01 1 1  ON 22
 eO_3                 8.168522e-02 1 1  ON 23
 eO_4                 2.059838e-01 1 1  ON 24
 eO_5                 2.973207e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328911e-01 1 1  ON 27
 eO_8                 1.580913e-01 1 1  ON 28
 eO_9                 5.331352e-02 1 1  ON 29
eH1_0                -2.218425e-01 1 1  ON 30
eH1_1                -1.430034e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433175e-02 1 1  ON 33
eH1_4                -1.811544e-02 1 1  ON 34
eH1_5                -4.815922e-03 1 1  ON 35
eH1_6                 3.565043e-02 1 1  ON 36
eH1_7                 7.899287e-02 1 1  ON 37
eH1_8                 2.643003e-01 1 1  ON 38
eH1_9                 1.135316e-01 1 1  ON 39
eH2_0                -2.106716e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075287e-02 1 1  ON 42
eH2_3                -5.299804e-02 1 1  ON 43
eH2_4                -6.342706e-03 1 1  ON 44
eH2_5                 5.548644e-03 1 1  ON 45
eH2_6                 4.766158e-02 1 1  ON 46
eH2_7                 3.899774e-02 1 1  ON 47
eH2_8                 2.479169e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2707
    reference variance = 0.316676
====================================================
  Execution time = 1.9692e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1776e-01
  Total weights = 2.0000e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317680331120
                                         uncertainty =       0.003630618641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317680331120
                                         uncertainty =       0.003630618641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398598037
  error estimate for blocks of size 2^( 2) =       0.000408021666
  error estimate for blocks of size 2^( 3) =       0.000416484172
  error estimate for blocks of size 2^( 4) =       0.000422608884
  error estimate for blocks of size 2^( 5) =       0.000425744327
  error estimate for blocks of size 2^( 6) =       0.000428531068
  error estimate for blocks of size 2^( 7) =       0.000429404546

      target function =                  N/A
              le_mean =     -17.216945008315
             les_mean =     296.740956051257
             stat err =       0.000426572206
             autocorr =       1.145288232877
              std dev =       0.563702750384
             le_variance =       0.317760790790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317681771950
                                         uncertainty =       0.003630626744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317681771950
                                         uncertainty =       0.003630626744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398598941
  error estimate for blocks of size 2^( 2) =       0.000408022523
  error estimate for blocks of size 2^( 3) =       0.000416484979
  error estimate for blocks of size 2^( 4) =       0.000422609654
  error estimate for blocks of size 2^( 5) =       0.000425745089
  error estimate for blocks of size 2^( 6) =       0.000428531812
  error estimate for blocks of size 2^( 7) =       0.000429405311

      target function =                  N/A
              le_mean =     -17.216945013009
             les_mean =     296.740957653902
             stat err =       0.000426572966
             autocorr =       1.145287120253
              std dev =       0.563704028548
             le_variance =       0.317762231802

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317681052125
                                         uncertainty =       0.003630622699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317681052125
                                         uncertainty =       0.003630622699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398598490
  error estimate for blocks of size 2^( 2) =       0.000408022095
  error estimate for blocks of size 2^( 3) =       0.000416484576
  error estimate for blocks of size 2^( 4) =       0.000422609269
  error estimate for blocks of size 2^( 5) =       0.000425744708
  error estimate for blocks of size 2^( 6) =       0.000428531441
  error estimate for blocks of size 2^( 7) =       0.000429404929

      target function =                  N/A
              le_mean =     -17.216945010663
             les_mean =     296.740956853204
             stat err =       0.000426572587
             autocorr =       1.145287676061
              std dev =       0.563703389989
             le_variance =       0.317761511886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317680421263
                                         uncertainty =       0.003630619149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317680421263
                                         uncertainty =       0.003630619149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398598094
  error estimate for blocks of size 2^( 2) =       0.000408021719
  error estimate for blocks of size 2^( 3) =       0.000416484223
  error estimate for blocks of size 2^( 4) =       0.000422608932
  error estimate for blocks of size 2^( 5) =       0.000425744375
  error estimate for blocks of size 2^( 6) =       0.000428531115
  error estimate for blocks of size 2^( 7) =       0.000429404594

      target function =                  N/A
              le_mean =     -17.216945008609
             les_mean =     296.740956151515
             stat err =       0.000426572254
             autocorr =       1.145288163259
              std dev =       0.563702830350
             le_variance =       0.317760880945


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216945008315        initial
     1.5259e+02     1.5259e+03             2.9564e-06       -17.216945013009  <--
     6.1035e+02     6.1035e+03             7.3964e-07       -17.216945010663
     2.4414e+03     2.4414e+04             1.8494e-07       -17.216945008609

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.8911e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411344e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168622e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433218e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815556e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548788e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899813e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4608e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2465
    reference variance = 0.24067
====================================================
  Execution time = 2.0821e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1644e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5812e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316437183080
                                         uncertainty =       0.002712433261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316437183080
                                         uncertainty =       0.002712433261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397766062
  error estimate for blocks of size 2^( 2) =       0.000407583822
  error estimate for blocks of size 2^( 3) =       0.000415773662
  error estimate for blocks of size 2^( 4) =       0.000422080808
  error estimate for blocks of size 2^( 5) =       0.000426853235
  error estimate for blocks of size 2^( 6) =       0.000427672714
  error estimate for blocks of size 2^( 7) =       0.000428184464

      target function =                  N/A
              le_mean =     -17.217951324372
             les_mean =     296.774283329945
             stat err =       0.000426197805
             autocorr =       1.148066294777
              std dev =       0.562526159153
             le_variance =       0.316435679731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721795132437e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217951324372       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217951340187       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217951320449       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217951323294       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217951327933       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217951323354       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217951322503       residual = 8.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.253906e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217951324372       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217951328338       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217951323380       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217951324104       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217951325269       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217951324109       residual = 3.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217951323883       residual = 8.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.144128e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217951324372       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217951325364       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217951324123       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217951324305       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217951324597       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217951324305       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217951324248       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 7.866207e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169370 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6413e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.911968e-01 1 1  ON 0
 uu_1                 2.952200e-02 1 1  ON 1
 uu_2                -6.465065e-02 1 1  ON 2
 uu_3                -1.204193e-01 1 1  ON 3
 uu_4                -1.562047e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563003e-01 1 1  ON 6
 uu_7                -1.093950e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013263e-01 1 1  ON 9
 ud_0                 3.529738e-01 1 1  ON 10
 ud_1                 9.540234e-02 1 1  ON 11
 ud_2                -1.296619e-02 1 1  ON 12
 ud_3                -7.411443e-02 1 1  ON 13
 ud_4                -1.245730e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779111e-01 1 1  ON 16
 ud_7                -1.588949e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229704e-02 1 1  ON 19
 eO_0                -9.136402e-01 1 1  ON 20
 eO_1                -5.950505e-01 1 1  ON 21
 eO_2                -1.857496e-01 1 1  ON 22
 eO_3                 8.168763e-02 1 1  ON 23
 eO_4                 2.059850e-01 1 1  ON 24
 eO_5                 2.973200e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328909e-01 1 1  ON 27
 eO_8                 1.580915e-01 1 1  ON 28
 eO_9                 5.331357e-02 1 1  ON 29
eH1_0                -2.218425e-01 1 1  ON 30
eH1_1                -1.430041e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433176e-02 1 1  ON 33
eH1_4                -1.811457e-02 1 1  ON 34
eH1_5                -4.815856e-03 1 1  ON 35
eH1_6                 3.565068e-02 1 1  ON 36
eH1_7                 7.899239e-02 1 1  ON 37
eH1_8                 2.643000e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106719e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075225e-02 1 1  ON 42
eH2_3                -5.299900e-02 1 1  ON 43
eH2_4                -6.343197e-03 1 1  ON 44
eH2_5                 5.548908e-03 1 1  ON 45
eH2_6                 4.766161e-02 1 1  ON 46
eH2_7                 3.899854e-02 1 1  ON 47
eH2_8                 2.479169e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2006
    reference variance = 0.189123
====================================================
  Execution time = 2.0028e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1867e-01
  Total weights = 2.0000e+06
  Execution time = 1.8123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318648729016
                                         uncertainty =       0.003085784350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318648729016
                                         uncertainty =       0.003085784350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399164842
  error estimate for blocks of size 2^( 2) =       0.000408771705
  error estimate for blocks of size 2^( 3) =       0.000416858570
  error estimate for blocks of size 2^( 4) =       0.000423078852
  error estimate for blocks of size 2^( 5) =       0.000426147971
  error estimate for blocks of size 2^( 6) =       0.000428666955
  error estimate for blocks of size 2^( 7) =       0.000428683924

      target function =                  N/A
              le_mean =     -17.216026683182
             les_mean =     296.710239738839
             stat err =       0.000426644425
             autocorr =       1.142424706969
              std dev =       0.564504333133
             le_variance =       0.318665142126

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318652729728
                                         uncertainty =       0.003085843260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318652729728
                                         uncertainty =       0.003085843260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399167347
  error estimate for blocks of size 2^( 2) =       0.000408774107
  error estimate for blocks of size 2^( 3) =       0.000416860807
  error estimate for blocks of size 2^( 4) =       0.000423081022
  error estimate for blocks of size 2^( 5) =       0.000426150094
  error estimate for blocks of size 2^( 6) =       0.000428669077
  error estimate for blocks of size 2^( 7) =       0.000428686149

      target function =                  N/A
              le_mean =     -17.216026654918
             les_mean =     296.710242765635
             stat err =       0.000426646586
             autocorr =       1.142421936445
              std dev =       0.564507876057
             le_variance =       0.318669142131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318650733388
                                         uncertainty =       0.003085813891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318650733388
                                         uncertainty =       0.003085813891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399166097
  error estimate for blocks of size 2^( 2) =       0.000408772908
  error estimate for blocks of size 2^( 3) =       0.000416859691
  error estimate for blocks of size 2^( 4) =       0.000423079939
  error estimate for blocks of size 2^( 5) =       0.000426149035
  error estimate for blocks of size 2^( 6) =       0.000428668018
  error estimate for blocks of size 2^( 7) =       0.000428685039

      target function =                  N/A
              le_mean =     -17.216026668986
             les_mean =     296.710241254058
             stat err =       0.000426645508
             autocorr =       1.142423317880
              std dev =       0.564506108152
             le_variance =       0.318667146140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318648979676
                                         uncertainty =       0.003085788046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318648979676
                                         uncertainty =       0.003085788046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399164999
  error estimate for blocks of size 2^( 2) =       0.000408771855
  error estimate for blocks of size 2^( 3) =       0.000416858711
  error estimate for blocks of size 2^( 4) =       0.000423078988
  error estimate for blocks of size 2^( 5) =       0.000426148104
  error estimate for blocks of size 2^( 6) =       0.000428667088
  error estimate for blocks of size 2^( 7) =       0.000428684063

      target function =                  N/A
              le_mean =     -17.216026681403
             les_mean =     296.710239928201
             stat err =       0.000426644561
             autocorr =       1.142424533198
              std dev =       0.564504555111
             le_variance =       0.318665392741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216026683182        initial  <--
     3.8147e+01     3.8147e+02             1.2539e-05       -17.216026654918
     1.5259e+02     1.5259e+03             3.1441e-06       -17.216026668986
     6.1035e+02     6.1035e+03             7.8662e-07       -17.216026681403

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1801
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411344e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168622e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433218e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815556e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548788e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899813e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5600e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1573
    reference variance = 0.378005
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1154e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311591628897
                                         uncertainty =       0.002931576850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311591628897
                                         uncertainty =       0.002931576850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394676321
  error estimate for blocks of size 2^( 2) =       0.000404408568
  error estimate for blocks of size 2^( 3) =       0.000412833841
  error estimate for blocks of size 2^( 4) =       0.000419460035
  error estimate for blocks of size 2^( 5) =       0.000423685006
  error estimate for blocks of size 2^( 6) =       0.000426082338
  error estimate for blocks of size 2^( 7) =       0.000426943787

      target function =                  N/A
              le_mean =     -17.216790699081
             les_mean =     296.729420617627
             stat err =       0.000424042792
             autocorr =       1.154349253433
              std dev =       0.558156606557
             le_variance =       0.311538797443


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679069908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790699081       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216790699496       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216790700002       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216790700772       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216790702424       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216790703321       residual = 8.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216790703120       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.188320e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790699081       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216790699185       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216790699311       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216790699504       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216790699917       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216790700141       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216790700091       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 2.971512e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216790699081       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216790699107       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216790699138       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216790699186       residual = 9.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216790699290       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216790699348       residual = 8.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216790699334       residual = 5.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 7.429226e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.171637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5628e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952138e-02 1 1  ON 1
 uu_2                -6.465030e-02 1 1  ON 2
 uu_3                -1.204189e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411353e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588953e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168641e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430036e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811509e-02 1 1  ON 34
eH1_5                -4.815493e-03 1 1  ON 35
eH1_6                 3.565054e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106719e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075270e-02 1 1  ON 42
eH2_3                -5.299846e-02 1 1  ON 43
eH2_4                -6.342445e-03 1 1  ON 44
eH2_5                 5.548748e-03 1 1  ON 45
eH2_6                 4.766133e-02 1 1  ON 46
eH2_7                 3.899817e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2056
    reference variance = 0.208741
====================================================
  Execution time = 2.1635e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.3906e-01
  Total weights = 2.0000e+06
  Execution time = 1.8769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157232734
                                         uncertainty =       0.011828973172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157232734
                                         uncertainty =       0.011828973172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411737865
  error estimate for blocks of size 2^( 2) =       0.000421049689
  error estimate for blocks of size 2^( 3) =       0.000428771632
  error estimate for blocks of size 2^( 4) =       0.000435214651
  error estimate for blocks of size 2^( 5) =       0.000439807522
  error estimate for blocks of size 2^( 6) =       0.000441006562
  error estimate for blocks of size 2^( 7) =       0.000441269178

      target function =                  N/A
              le_mean =     -17.216585882146
             les_mean =     296.749885406406
             stat err =       0.000439324478
             autocorr =       1.138489913316
              std dev =       0.582285272548
             le_variance =       0.339056138626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157506450
                                         uncertainty =       0.011828973580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157506450
                                         uncertainty =       0.011828973580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411738031
  error estimate for blocks of size 2^( 2) =       0.000421049849
  error estimate for blocks of size 2^( 3) =       0.000428771783
  error estimate for blocks of size 2^( 4) =       0.000435214792
  error estimate for blocks of size 2^( 5) =       0.000439807672
  error estimate for blocks of size 2^( 6) =       0.000441006721
  error estimate for blocks of size 2^( 7) =       0.000441269339

      target function =                  N/A
              le_mean =     -17.216585882091
             les_mean =     296.749885678167
             stat err =       0.000439324631
             autocorr =       1.138489787341
              std dev =       0.582285507517
             le_variance =       0.339056412264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157369539
                                         uncertainty =       0.011828973370

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157369539
                                         uncertainty =       0.011828973370

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411737948
  error estimate for blocks of size 2^( 2) =       0.000421049769
  error estimate for blocks of size 2^( 3) =       0.000428771707
  error estimate for blocks of size 2^( 4) =       0.000435214721
  error estimate for blocks of size 2^( 5) =       0.000439807597
  error estimate for blocks of size 2^( 6) =       0.000441006641
  error estimate for blocks of size 2^( 7) =       0.000441269258

      target function =                  N/A
              le_mean =     -17.216585882118
             les_mean =     296.749885542200
             stat err =       0.000439324554
             autocorr =       1.138489850375
              std dev =       0.582285389987
             le_variance =       0.339056275393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157249833
                                         uncertainty =       0.011828973197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339157249833
                                         uncertainty =       0.011828973197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411737875
  error estimate for blocks of size 2^( 2) =       0.000421049699
  error estimate for blocks of size 2^( 3) =       0.000428771641
  error estimate for blocks of size 2^( 4) =       0.000435214660
  error estimate for blocks of size 2^( 5) =       0.000439807531
  error estimate for blocks of size 2^( 6) =       0.000441006572
  error estimate for blocks of size 2^( 7) =       0.000441269188

      target function =                  N/A
              le_mean =     -17.216585882142
             les_mean =     296.749885423376
             stat err =       0.000439324488
             autocorr =       1.138489905453
              std dev =       0.582285287226
             le_variance =       0.339056155720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216585882146        initial  <--
     3.8147e+02     3.8147e+03             1.1883e-06       -17.216585882091
     1.5259e+03     1.5259e+04             2.9715e-07       -17.216585882118
     6.1035e+03     6.1035e+04             7.4292e-08       -17.216585882142

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8217
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411344e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168622e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433218e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815556e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548788e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899813e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6455e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1857
    reference variance = 0.223926
====================================================
  Execution time = 2.0503e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1718e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317207235671
                                         uncertainty =       0.002707595558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317207235671
                                         uncertainty =       0.002707595558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398231642
  error estimate for blocks of size 2^( 2) =       0.000407506627
  error estimate for blocks of size 2^( 3) =       0.000415743319
  error estimate for blocks of size 2^( 4) =       0.000421343898
  error estimate for blocks of size 2^( 5) =       0.000425209191
  error estimate for blocks of size 2^( 6) =       0.000426739748
  error estimate for blocks of size 2^( 7) =       0.000427621799

      target function =                  N/A
              le_mean =     -17.216771067355
             les_mean =     296.734382709215
             stat err =       0.000425228659
             autocorr =       1.140180277326
              std dev =       0.563184589710
             le_variance =       0.317176882086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721677106736e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216771067355       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216771067295       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216771067308       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216771067478       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216771067541       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216771067557       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216771067576       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.066267e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216771067355       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216771067340       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216771067343       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216771067386       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216771067402       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216771067404       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216771067412       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 2.665747e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216771067355       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216771067351       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216771067352       residual = 6.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216771067363       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216771067374       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216771067339       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216771067349       residual = 4.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 6.664417e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173903 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6026e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411346e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168623e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433217e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815550e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342490e-03 1 1  ON 44
eH2_5                 5.548781e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899814e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1132
    reference variance = 0.254607
====================================================
  Execution time = 2.0506e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2223e-01
  Total weights = 2.0000e+06
  Execution time = 1.8212e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272448459
                                         uncertainty =       0.005158523899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272448459
                                         uncertainty =       0.005158523899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401389769
  error estimate for blocks of size 2^( 2) =       0.000410707397
  error estimate for blocks of size 2^( 3) =       0.000419544108
  error estimate for blocks of size 2^( 4) =       0.000426146388
  error estimate for blocks of size 2^( 5) =       0.000429418450
  error estimate for blocks of size 2^( 6) =       0.000431635516
  error estimate for blocks of size 2^( 7) =       0.000433338731

      target function =                  N/A
              le_mean =     -17.216929230373
             les_mean =     296.744879455996
             stat err =       0.000430134771
             autocorr =       1.148355897856
              std dev =       0.567650855218
             le_variance =       0.322227493429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272483042
                                         uncertainty =       0.005158524312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272483042
                                         uncertainty =       0.005158524312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401389791
  error estimate for blocks of size 2^( 2) =       0.000410707418
  error estimate for blocks of size 2^( 3) =       0.000419544128
  error estimate for blocks of size 2^( 4) =       0.000426146406
  error estimate for blocks of size 2^( 5) =       0.000429418468
  error estimate for blocks of size 2^( 6) =       0.000431635534
  error estimate for blocks of size 2^( 7) =       0.000433338750

      target function =                  N/A
              le_mean =     -17.216929230349
             les_mean =     296.744879489753
             stat err =       0.000430134790
             autocorr =       1.148355874113
              std dev =       0.567650885673
             le_variance =       0.322227528005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272465751
                                         uncertainty =       0.005158524105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272465751
                                         uncertainty =       0.005158524105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401389780
  error estimate for blocks of size 2^( 2) =       0.000410707408
  error estimate for blocks of size 2^( 3) =       0.000419544118
  error estimate for blocks of size 2^( 4) =       0.000426146397
  error estimate for blocks of size 2^( 5) =       0.000429418459
  error estimate for blocks of size 2^( 6) =       0.000431635525
  error estimate for blocks of size 2^( 7) =       0.000433338741

      target function =                  N/A
              le_mean =     -17.216929230361
             les_mean =     296.744879472875
             stat err =       0.000430134780
             autocorr =       1.148355885986
              std dev =       0.567650870445
             le_variance =       0.322227510718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272450621
                                         uncertainty =       0.005158523925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322272450621
                                         uncertainty =       0.005158523925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401389770
  error estimate for blocks of size 2^( 2) =       0.000410707399
  error estimate for blocks of size 2^( 3) =       0.000419544109
  error estimate for blocks of size 2^( 4) =       0.000426146389
  error estimate for blocks of size 2^( 5) =       0.000429418451
  error estimate for blocks of size 2^( 6) =       0.000431635517
  error estimate for blocks of size 2^( 7) =       0.000433338732

      target function =                  N/A
              le_mean =     -17.216929230372
             les_mean =     296.744879458106
             stat err =       0.000430134772
             autocorr =       1.148355896381
              std dev =       0.567650857121
             le_variance =       0.322227495590


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216929230373        initial  <--
     3.8147e+03     3.8147e+04             1.0663e-07       -17.216929230349
     1.5259e+04     1.5259e+05             2.6657e-08       -17.216929230361
     6.1035e+04     6.1035e+05             6.6644e-09       -17.216929230372

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7176
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411344e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168622e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433218e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815556e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548788e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899813e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5750e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1922
    reference variance = 0.215484
====================================================
  Execution time = 2.0349e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1409e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314127103205
                                         uncertainty =       0.002696198567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314127103205
                                         uncertainty =       0.002696198567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396286179
  error estimate for blocks of size 2^( 2) =       0.000405789019
  error estimate for blocks of size 2^( 3) =       0.000413963272
  error estimate for blocks of size 2^( 4) =       0.000420725158
  error estimate for blocks of size 2^( 5) =       0.000424048757
  error estimate for blocks of size 2^( 6) =       0.000425281669
  error estimate for blocks of size 2^( 7) =       0.000427386116

      target function =                  N/A
              le_mean =     -17.216215370020
             les_mean =     296.712156981505
             stat err =       0.000424360425
             autocorr =       1.146705508545
              std dev =       0.560433289206
             le_variance =       0.314085471651


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721621537002e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215370020       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215370042       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215370050       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215370041       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215370073       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215370062       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215370038       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.121594e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215370020       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215370025       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215370027       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215370026       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215370028       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215369967       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215369926       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.803992e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216215370020       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216215370021       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216215370021       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216215369902       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216215369977       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216215369402       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216215369841       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 7.009985e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176167 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5884e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411345e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168622e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433218e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815556e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548788e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899813e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2193
    reference variance = 0.196154
====================================================
  Execution time = 2.0199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2914e-01
  Total weights = 2.0000e+06
  Execution time = 1.8192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176032607
                                         uncertainty =       0.009412421135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176032607
                                         uncertainty =       0.009412421135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405670737
  error estimate for blocks of size 2^( 2) =       0.000415416782
  error estimate for blocks of size 2^( 3) =       0.000423534792
  error estimate for blocks of size 2^( 4) =       0.000429617280
  error estimate for blocks of size 2^( 5) =       0.000433146449
  error estimate for blocks of size 2^( 6) =       0.000436016126
  error estimate for blocks of size 2^( 7) =       0.000436590850

      target function =                  N/A
              le_mean =     -17.216770253306
             les_mean =     296.746315283911
             stat err =       0.000433842676
             autocorr =       1.143713320804
              std dev =       0.573705057809
             le_variance =       0.329137493355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176039596
                                         uncertainty =       0.009412421397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176039596
                                         uncertainty =       0.009412421397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405670741
  error estimate for blocks of size 2^( 2) =       0.000415416786
  error estimate for blocks of size 2^( 3) =       0.000423534796
  error estimate for blocks of size 2^( 4) =       0.000429617284
  error estimate for blocks of size 2^( 5) =       0.000433146453
  error estimate for blocks of size 2^( 6) =       0.000436016130
  error estimate for blocks of size 2^( 7) =       0.000436590854

      target function =                  N/A
              le_mean =     -17.216770253329
             les_mean =     296.746315291690
             stat err =       0.000433842680
             autocorr =       1.143713316191
              std dev =       0.573705063898
             le_variance =       0.329137500342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176036102
                                         uncertainty =       0.009412421266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176036102
                                         uncertainty =       0.009412421266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405670739
  error estimate for blocks of size 2^( 2) =       0.000415416784
  error estimate for blocks of size 2^( 3) =       0.000423534794
  error estimate for blocks of size 2^( 4) =       0.000429617282
  error estimate for blocks of size 2^( 5) =       0.000433146451
  error estimate for blocks of size 2^( 6) =       0.000436016128
  error estimate for blocks of size 2^( 7) =       0.000436590852

      target function =                  N/A
              le_mean =     -17.216770253318
             les_mean =     296.746315287801
             stat err =       0.000433842678
             autocorr =       1.143713318502
              std dev =       0.573705060853
             le_variance =       0.329137496849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176033044
                                         uncertainty =       0.009412421152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329176033044
                                         uncertainty =       0.009412421152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405670737
  error estimate for blocks of size 2^( 2) =       0.000415416782
  error estimate for blocks of size 2^( 3) =       0.000423534793
  error estimate for blocks of size 2^( 4) =       0.000429617280
  error estimate for blocks of size 2^( 5) =       0.000433146450
  error estimate for blocks of size 2^( 6) =       0.000436016126
  error estimate for blocks of size 2^( 7) =       0.000436590850

      target function =                  N/A
              le_mean =     -17.216770253308
             les_mean =     296.746315284398
             stat err =       0.000433842677
             autocorr =       1.143713320517
              std dev =       0.573705058189
             le_variance =       0.329137493792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216770253306        initial
     3.8147e+04     3.8147e+05             1.1216e-08       -17.216770253329  <--
     1.5259e+05     1.5259e+06             2.8040e-09       -17.216770253318
     6.1035e+05     6.1035e+06             7.0100e-10       -17.216770253308

*****************************************************************************
Applying the update for shift_i =   3.8147e+04     and shift_s =   3.8147e+05
*****************************************************************************

  Execution time = 2.9430e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411345e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168622e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433218e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815555e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548788e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899814e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5320e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2013
    reference variance = 0.167778
====================================================
  Execution time = 2.0533e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319252295298
                                         uncertainty =       0.004062093709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319252295298
                                         uncertainty =       0.004062093709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399469970
  error estimate for blocks of size 2^( 2) =       0.000409067943
  error estimate for blocks of size 2^( 3) =       0.000417517960
  error estimate for blocks of size 2^( 4) =       0.000423618215
  error estimate for blocks of size 2^( 5) =       0.000428027352
  error estimate for blocks of size 2^( 6) =       0.000430388174
  error estimate for blocks of size 2^( 7) =       0.000430658562

      target function =                  N/A
              le_mean =     -17.216936021892
             les_mean =     296.742038336829
             stat err =       0.000428173076
             autocorr =       1.148868798544
              std dev =       0.564935849871
             le_variance =       0.319152514469


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693602189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216936021892       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216936021970       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216936022054       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216936022068       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216936022138       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216936022127       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216936022137       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 4.467307e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216936021892       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216936021912       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216936021933       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216936021937       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216936021956       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216936021945       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216936021960       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.116836e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216936021892       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216936021897       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216936021902       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216936021903       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216936021895       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216936021887       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216936021850       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 2.792095e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6032e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465028e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540197e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411346e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629622e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136370e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168623e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433218e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815554e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899266e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318817e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548790e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899814e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1883
    reference variance = 0.20761
====================================================
  Execution time = 1.9922e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1678e-01
  Total weights = 2.0000e+06
  Execution time = 1.8219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654962358
                                         uncertainty =       0.003555515314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654962358
                                         uncertainty =       0.003555515314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397985352
  error estimate for blocks of size 2^( 2) =       0.000407528398
  error estimate for blocks of size 2^( 3) =       0.000415852617
  error estimate for blocks of size 2^( 4) =       0.000421988773
  error estimate for blocks of size 2^( 5) =       0.000426505529
  error estimate for blocks of size 2^( 6) =       0.000429854379
  error estimate for blocks of size 2^( 7) =       0.000432304622

      target function =                  N/A
              le_mean =     -17.217153876855
             les_mean =     296.747172141995
             stat err =       0.000427663326
             autocorr =       1.154701796337
              std dev =       0.562836282662
             le_variance =       0.316784681081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654970146
                                         uncertainty =       0.003555515320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654970146
                                         uncertainty =       0.003555515320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397985357
  error estimate for blocks of size 2^( 2) =       0.000407528403
  error estimate for blocks of size 2^( 3) =       0.000415852622
  error estimate for blocks of size 2^( 4) =       0.000421988777
  error estimate for blocks of size 2^( 5) =       0.000426505533
  error estimate for blocks of size 2^( 6) =       0.000429854384
  error estimate for blocks of size 2^( 7) =       0.000432304626

      target function =                  N/A
              le_mean =     -17.217153876906
             les_mean =     296.747172151528
             stat err =       0.000427663330
             autocorr =       1.154701791023
              std dev =       0.562836289584
             le_variance =       0.316784688873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654966252
                                         uncertainty =       0.003555515317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654966252
                                         uncertainty =       0.003555515317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397985355
  error estimate for blocks of size 2^( 2) =       0.000407528400
  error estimate for blocks of size 2^( 3) =       0.000415852620
  error estimate for blocks of size 2^( 4) =       0.000421988775
  error estimate for blocks of size 2^( 5) =       0.000426505531
  error estimate for blocks of size 2^( 6) =       0.000429854382
  error estimate for blocks of size 2^( 7) =       0.000432304624

      target function =                  N/A
              le_mean =     -17.217153876880
             les_mean =     296.747172146761
             stat err =       0.000427663328
             autocorr =       1.154701793676
              std dev =       0.562836286123
             le_variance =       0.316784684977

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654962845
                                         uncertainty =       0.003555515314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316654962845
                                         uncertainty =       0.003555515314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397985352
  error estimate for blocks of size 2^( 2) =       0.000407528398
  error estimate for blocks of size 2^( 3) =       0.000415852618
  error estimate for blocks of size 2^( 4) =       0.000421988773
  error estimate for blocks of size 2^( 5) =       0.000426505529
  error estimate for blocks of size 2^( 6) =       0.000429854380
  error estimate for blocks of size 2^( 7) =       0.000432304622

      target function =                  N/A
              le_mean =     -17.217153876858
             les_mean =     296.747172142591
             stat err =       0.000427663326
             autocorr =       1.154701796007
              std dev =       0.562836283095
             le_variance =       0.316784681568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217153876855        initial
     9.5367e+03     9.5367e+04             4.4673e-08       -17.217153876906  <--
     3.8147e+04     3.8147e+05             1.1168e-08       -17.217153876880
     1.5259e+05     1.5259e+06             2.7921e-09       -17.217153876858

*****************************************************************************
Applying the update for shift_i =   9.5367e+03     and shift_s =   9.5367e+04
*****************************************************************************

  Execution time = 2.9138e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465030e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891563e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540199e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411347e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229725e-02 1 1  ON 19
 eO_0                -9.136371e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168625e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433219e-02 1 1  ON 33
eH1_4                -1.811507e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899265e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299838e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548796e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899814e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5175e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2134
    reference variance = 0.353316
====================================================
  Execution time = 2.0457e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1819e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238935553
                                         uncertainty =       0.003749356250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318238935553
                                         uncertainty =       0.003749356250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398867483
  error estimate for blocks of size 2^( 2) =       0.000408747123
  error estimate for blocks of size 2^( 3) =       0.000416781736
  error estimate for blocks of size 2^( 4) =       0.000423789290
  error estimate for blocks of size 2^( 5) =       0.000427073114
  error estimate for blocks of size 2^( 6) =       0.000427871829
  error estimate for blocks of size 2^( 7) =       0.000429026819

      target function =                  N/A
              le_mean =     -17.216835640688
             les_mean =     296.737619857428
             stat err =       0.000426940263
             autocorr =       1.145715954731
              std dev =       0.564083804124
             le_variance =       0.318190538075


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721683564069e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216835640688       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216835640997       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835640840       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835641032       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835641256       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835641409       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835641417       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 2.060376e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216835640688       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216835640765       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835640726       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835640774       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835640834       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835640865       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835640873       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 5.151188e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216835640688       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216835640707       residual = 6.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216835640697       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216835640709       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216835640727       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216835640747       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216835640727       residual = 6.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 1.287813e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180639 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6108e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.911966e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465031e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540200e-02 1 1  ON 11
 ud_2                -1.296611e-02 1 1  ON 12
 ud_3                -7.411349e-02 1 1  ON 13
 ud_4                -1.245722e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136371e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857514e-01 1 1  ON 22
 eO_3                 8.168628e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811505e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565052e-02 1 1  ON 36
eH1_7                 7.899265e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299839e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548787e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899815e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1744
    reference variance = 0.203278
====================================================
  Execution time = 1.9925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1719e-01
  Total weights = 2.0000e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232465739
                                         uncertainty =       0.003058886728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232465739
                                         uncertainty =       0.003058886728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398243012
  error estimate for blocks of size 2^( 2) =       0.000408054559
  error estimate for blocks of size 2^( 3) =       0.000416436979
  error estimate for blocks of size 2^( 4) =       0.000422156887
  error estimate for blocks of size 2^( 5) =       0.000426240820
  error estimate for blocks of size 2^( 6) =       0.000428248566
  error estimate for blocks of size 2^( 7) =       0.000427651381

      target function =                  N/A
              le_mean =     -17.217035254702
             les_mean =     296.743497796744
             stat err =       0.000426074413
             autocorr =       1.144654924917
              std dev =       0.563200669105
             le_variance =       0.317194993681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232522527
                                         uncertainty =       0.003058887450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232522527
                                         uncertainty =       0.003058887450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398243048
  error estimate for blocks of size 2^( 2) =       0.000408054593
  error estimate for blocks of size 2^( 3) =       0.000416437011
  error estimate for blocks of size 2^( 4) =       0.000422156916
  error estimate for blocks of size 2^( 5) =       0.000426240849
  error estimate for blocks of size 2^( 6) =       0.000428248596
  error estimate for blocks of size 2^( 7) =       0.000427651411

      target function =                  N/A
              le_mean =     -17.217035255735
             les_mean =     296.743497889065
             stat err =       0.000426074443
             autocorr =       1.144654877996
              std dev =       0.563200719503
             le_variance =       0.317195050449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232494132
                                         uncertainty =       0.003058887089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232494132
                                         uncertainty =       0.003058887089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398243030
  error estimate for blocks of size 2^( 2) =       0.000408054576
  error estimate for blocks of size 2^( 3) =       0.000416436995
  error estimate for blocks of size 2^( 4) =       0.000422156901
  error estimate for blocks of size 2^( 5) =       0.000426240835
  error estimate for blocks of size 2^( 6) =       0.000428248581
  error estimate for blocks of size 2^( 7) =       0.000427651396

      target function =                  N/A
              le_mean =     -17.217035255219
             les_mean =     296.743497842905
             stat err =       0.000426074428
             autocorr =       1.144654901466
              std dev =       0.563200694304
             le_variance =       0.317195022064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232469288
                                         uncertainty =       0.003058886774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317232469288
                                         uncertainty =       0.003058886774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398243015
  error estimate for blocks of size 2^( 2) =       0.000408054561
  error estimate for blocks of size 2^( 3) =       0.000416436981
  error estimate for blocks of size 2^( 4) =       0.000422156888
  error estimate for blocks of size 2^( 5) =       0.000426240822
  error estimate for blocks of size 2^( 6) =       0.000428248568
  error estimate for blocks of size 2^( 7) =       0.000427651383

      target function =                  N/A
              le_mean =     -17.217035254767
             les_mean =     296.743497802514
             stat err =       0.000426074415
             autocorr =       1.144654921989
              std dev =       0.563200672255
             le_variance =       0.317194997229


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217035254702        initial
     2.3842e+03     2.3842e+04             2.0604e-07       -17.217035255735  <--
     9.5367e+03     9.5367e+04             5.1512e-08       -17.217035255219
     3.8147e+04     3.8147e+05             1.2878e-08       -17.217035254767

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 2.9157e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465034e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540203e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411355e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168637e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811501e-02 1 1  ON 34
eH1_5                -4.815554e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075274e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548757e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899817e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5271e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2311
    reference variance = 0.337018
====================================================
  Execution time = 2.0589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1472e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314597358337
                                         uncertainty =       0.003318144182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314597358337
                                         uncertainty =       0.003318144182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396688635
  error estimate for blocks of size 2^( 2) =       0.000406058110
  error estimate for blocks of size 2^( 3) =       0.000414696159
  error estimate for blocks of size 2^( 4) =       0.000420518479
  error estimate for blocks of size 2^( 5) =       0.000424124367
  error estimate for blocks of size 2^( 6) =       0.000424583493
  error estimate for blocks of size 2^( 7) =       0.000426124802

      target function =                  N/A
              le_mean =     -17.216471039304
             les_mean =     296.721598635617
             stat err =       0.000423837785
             autocorr =       1.141562851452
              std dev =       0.561002447234
             le_variance =       0.314723745802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721647103930e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216471039304       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216471039726       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216471041246       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216471042151       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216471043126       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216471043183       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216471043054       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 7.424494e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216471039304       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216471039409       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216471039789       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216471040016       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216471040261       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216471040273       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216471040242       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.856426e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216471039304       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216471039330       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216471039425       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216471039482       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216471039541       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216471039545       residual = 6.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216471039557       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 4.641254e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6144e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891560e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540210e-02 1 1  ON 11
 ud_2                -1.296615e-02 1 1  ON 12
 ud_3                -7.411364e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811493e-02 1 1  ON 34
eH1_5                -4.815600e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299843e-02 1 1  ON 43
eH2_4                -6.342490e-03 1 1  ON 44
eH2_5                 5.548789e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2565
    reference variance = 0.274564
====================================================
  Execution time = 1.9719e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2066e-01
  Total weights = 2.0000e+06
  Execution time = 1.8315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690678697
                                         uncertainty =       0.003374123339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690678697
                                         uncertainty =       0.003374123339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400411000
  error estimate for blocks of size 2^( 2) =       0.000409623248
  error estimate for blocks of size 2^( 3) =       0.000417871268
  error estimate for blocks of size 2^( 4) =       0.000424321612
  error estimate for blocks of size 2^( 5) =       0.000427485359
  error estimate for blocks of size 2^( 6) =       0.000429744456
  error estimate for blocks of size 2^( 7) =       0.000432123961

      target function =                  N/A
              le_mean =     -17.216823102868
             les_mean =     296.739655532304
             stat err =       0.000428418847
             autocorr =       1.144788183102
              std dev =       0.566266666148
             le_variance =       0.320657937191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690976618
                                         uncertainty =       0.003374124232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690976618
                                         uncertainty =       0.003374124232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400411186
  error estimate for blocks of size 2^( 2) =       0.000409623423
  error estimate for blocks of size 2^( 3) =       0.000417871433
  error estimate for blocks of size 2^( 4) =       0.000424321768
  error estimate for blocks of size 2^( 5) =       0.000427485510
  error estimate for blocks of size 2^( 6) =       0.000429744600
  error estimate for blocks of size 2^( 7) =       0.000432124104

      target function =                  N/A
              le_mean =     -17.216823102737
             les_mean =     296.739655825604
             stat err =       0.000428418996
             autocorr =       1.144787913052
              std dev =       0.566266929103
             le_variance =       0.320658234996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690827664
                                         uncertainty =       0.003374123785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690827664
                                         uncertainty =       0.003374123785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400411093
  error estimate for blocks of size 2^( 2) =       0.000409623336
  error estimate for blocks of size 2^( 3) =       0.000417871350
  error estimate for blocks of size 2^( 4) =       0.000424321690
  error estimate for blocks of size 2^( 5) =       0.000427485435
  error estimate for blocks of size 2^( 6) =       0.000429744528
  error estimate for blocks of size 2^( 7) =       0.000432124032

      target function =                  N/A
              le_mean =     -17.216823102802
             les_mean =     296.739655678942
             stat err =       0.000428418921
             autocorr =       1.144788048063
              std dev =       0.566266797631
             le_variance =       0.320658086100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690697318
                                         uncertainty =       0.003374123395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320690697318
                                         uncertainty =       0.003374123395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400411011
  error estimate for blocks of size 2^( 2) =       0.000409623259
  error estimate for blocks of size 2^( 3) =       0.000417871278
  error estimate for blocks of size 2^( 4) =       0.000424321622
  error estimate for blocks of size 2^( 5) =       0.000427485369
  error estimate for blocks of size 2^( 6) =       0.000429744465
  error estimate for blocks of size 2^( 7) =       0.000432123970

      target function =                  N/A
              le_mean =     -17.216823102860
             les_mean =     296.739655550633
             stat err =       0.000428418856
             autocorr =       1.144788166213
              std dev =       0.566266682584
             le_variance =       0.320657955804


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216823102868        initial  <--
     5.9605e+02     5.9605e+03             7.4245e-07       -17.216823102737
     2.3842e+03     2.3842e+04             1.8564e-07       -17.216823102802
     9.5367e+03     9.5367e+04             4.6413e-08       -17.216823102860

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0544
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465034e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540203e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411355e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168637e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811501e-02 1 1  ON 34
eH1_5                -4.815554e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075274e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548757e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899817e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5204e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2263
    reference variance = 0.181522
====================================================
  Execution time = 2.2318e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2854e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328604453115
                                         uncertainty =       0.012939418721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328604453115
                                         uncertainty =       0.012939418721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405301497
  error estimate for blocks of size 2^( 2) =       0.000414379186
  error estimate for blocks of size 2^( 3) =       0.000422769693
  error estimate for blocks of size 2^( 4) =       0.000429339690
  error estimate for blocks of size 2^( 5) =       0.000432759059
  error estimate for blocks of size 2^( 6) =       0.000434228771
  error estimate for blocks of size 2^( 7) =       0.000434168946

      target function =                  N/A
              le_mean =     -17.217212213053
             les_mean =     296.760934831353
             stat err =       0.000432624116
             autocorr =       1.139370670546
              std dev =       0.573182873368
             le_variance =       0.328538606322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721221305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217212213053       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217212213049       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217212213165       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217212213068       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217212213292       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217212213193       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217212213198       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 6.779415e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217212213053       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217212213052       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217212213081       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217212213044       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217212213102       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217212213088       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217212213102       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.694880e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217212213053       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217212213053       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217212213060       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217212213054       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217212213068       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217212213064       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217212212977       residual = 3.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 4.237217e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185131 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7822e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465034e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529730e-01 1 1  ON 10
 ud_1                 9.540203e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411355e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168638e-02 1 1  ON 23
 eO_4                 2.059841e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811501e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342492e-03 1 1  ON 44
eH2_5                 5.548756e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899818e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.254689
====================================================
  Execution time = 2.0115e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1105e-01
  Total weights = 2.0000e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067133266
                                         uncertainty =       0.002577376636

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067133266
                                         uncertainty =       0.002577376636

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369280
  error estimate for blocks of size 2^( 2) =       0.000404065335
  error estimate for blocks of size 2^( 3) =       0.000412303431
  error estimate for blocks of size 2^( 4) =       0.000418212914
  error estimate for blocks of size 2^( 5) =       0.000423004772
  error estimate for blocks of size 2^( 6) =       0.000426233091
  error estimate for blocks of size 2^( 7) =       0.000428866105

      target function =                  N/A
              le_mean =     -17.217316560899
             les_mean =     296.747043661081
             stat err =       0.000424079221
             autocorr =       1.156346074507
              std dev =       0.557722384703
             le_variance =       0.311054258398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067147109
                                         uncertainty =       0.002577376771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067147109
                                         uncertainty =       0.002577376771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369289
  error estimate for blocks of size 2^( 2) =       0.000404065343
  error estimate for blocks of size 2^( 3) =       0.000412303439
  error estimate for blocks of size 2^( 4) =       0.000418212922
  error estimate for blocks of size 2^( 5) =       0.000423004779
  error estimate for blocks of size 2^( 6) =       0.000426233098
  error estimate for blocks of size 2^( 7) =       0.000428866113

      target function =                  N/A
              le_mean =     -17.217316560984
             les_mean =     296.747043677837
             stat err =       0.000424079228
             autocorr =       1.156346062439
              std dev =       0.557722397106
             le_variance =       0.311054272234

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067140187
                                         uncertainty =       0.002577376704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067140187
                                         uncertainty =       0.002577376704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369285
  error estimate for blocks of size 2^( 2) =       0.000404065339
  error estimate for blocks of size 2^( 3) =       0.000412303435
  error estimate for blocks of size 2^( 4) =       0.000418212918
  error estimate for blocks of size 2^( 5) =       0.000423004775
  error estimate for blocks of size 2^( 6) =       0.000426233095
  error estimate for blocks of size 2^( 7) =       0.000428866109

      target function =                  N/A
              le_mean =     -17.217316560941
             les_mean =     296.747043669459
             stat err =       0.000424079224
             autocorr =       1.156346068468
              std dev =       0.557722390904
             le_variance =       0.311054265316

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067134131
                                         uncertainty =       0.002577376645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311067134131
                                         uncertainty =       0.002577376645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394369281
  error estimate for blocks of size 2^( 2) =       0.000404065335
  error estimate for blocks of size 2^( 3) =       0.000412303432
  error estimate for blocks of size 2^( 4) =       0.000418212915
  error estimate for blocks of size 2^( 5) =       0.000423004772
  error estimate for blocks of size 2^( 6) =       0.000426233092
  error estimate for blocks of size 2^( 7) =       0.000428866106

      target function =                  N/A
              le_mean =     -17.217316560904
             les_mean =     296.747043662128
             stat err =       0.000424079221
             autocorr =       1.156346073753
              std dev =       0.557722385478
             le_variance =       0.311054259263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217316560899        initial
     5.9605e+03     5.9605e+04             6.7794e-08       -17.217316560984  <--
     2.3842e+04     2.3842e+05             1.6949e-08       -17.217316560941
     9.5367e+04     9.5367e+05             4.2372e-09       -17.217316560904

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 2.9339e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465036e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411357e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168641e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342488e-03 1 1  ON 44
eH2_5                 5.548751e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.239997
====================================================
  Execution time = 2.0300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6001e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310817825506
                                         uncertainty =       0.002795847999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.310817825506
                                         uncertainty =       0.002795847999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394459986
  error estimate for blocks of size 2^( 2) =       0.000404277046
  error estimate for blocks of size 2^( 3) =       0.000412691858
  error estimate for blocks of size 2^( 4) =       0.000419060314
  error estimate for blocks of size 2^( 5) =       0.000423515526
  error estimate for blocks of size 2^( 6) =       0.000426808130
  error estimate for blocks of size 2^( 7) =       0.000426679391

      target function =                  N/A
              le_mean =     -17.216112191399
             les_mean =     296.705716192453
             stat err =       0.000424015840
             autocorr =       1.155468878191
              std dev =       0.557850662095
             le_variance =       0.311197361200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721611219140e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216112191399       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216112191614       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216112191177       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216112191661       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216112191251       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216112191223       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216112191290       residual = 9.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 3.162201e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216112191399       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216112191453       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216112191344       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216112191468       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216112191362       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216112191351       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216112191368       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 7.905938e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216112191399       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216112191413       residual = 6.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216112191386       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216112191420       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216112191393       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216112191368       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216112191398       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.976512e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187375 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5912e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952137e-02 1 1  ON 1
 uu_2                -6.465039e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540208e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411360e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168647e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433221e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815547e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299841e-02 1 1  ON 43
eH2_4                -6.342479e-03 1 1  ON 44
eH2_5                 5.548759e-03 1 1  ON 45
eH2_6                 4.766136e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.172
    reference variance = 0.181643
====================================================
  Execution time = 2.0110e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2602e-01
  Total weights = 2.0000e+06
  Execution time = 1.8363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116658403
                                         uncertainty =       0.013308921752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116658403
                                         uncertainty =       0.013308921752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748043
  error estimate for blocks of size 2^( 2) =       0.000413148934
  error estimate for blocks of size 2^( 3) =       0.000421607127
  error estimate for blocks of size 2^( 4) =       0.000427441699
  error estimate for blocks of size 2^( 5) =       0.000431665053
  error estimate for blocks of size 2^( 6) =       0.000432587354
  error estimate for blocks of size 2^( 7) =       0.000434119685

      target function =                  N/A
              le_mean =     -17.216833925535
             les_mean =     296.745395220242
             stat err =       0.000431453448
             autocorr =       1.141949840289
              std dev =       0.570985957622
             le_variance =       0.326024963801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116792729
                                         uncertainty =       0.013308946401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116792729
                                         uncertainty =       0.013308946401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748126
  error estimate for blocks of size 2^( 2) =       0.000413149013
  error estimate for blocks of size 2^( 3) =       0.000421607202
  error estimate for blocks of size 2^( 4) =       0.000427441773
  error estimate for blocks of size 2^( 5) =       0.000431665126
  error estimate for blocks of size 2^( 6) =       0.000432587427
  error estimate for blocks of size 2^( 7) =       0.000434119762

      target function =                  N/A
              le_mean =     -17.216833924973
             les_mean =     296.745395335115
             stat err =       0.000431453522
             autocorr =       1.141949762600
              std dev =       0.570986075162
             le_variance =       0.326025098029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116725570
                                         uncertainty =       0.013308934080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116725570
                                         uncertainty =       0.013308934080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748084
  error estimate for blocks of size 2^( 2) =       0.000413148973
  error estimate for blocks of size 2^( 3) =       0.000421607164
  error estimate for blocks of size 2^( 4) =       0.000427441736
  error estimate for blocks of size 2^( 5) =       0.000431665089
  error estimate for blocks of size 2^( 6) =       0.000432587391
  error estimate for blocks of size 2^( 7) =       0.000434119724

      target function =                  N/A
              le_mean =     -17.216833925254
             les_mean =     296.745395277677
             stat err =       0.000431453485
             autocorr =       1.141949801451
              std dev =       0.570986016396
             le_variance =       0.326025030920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116666799
                                         uncertainty =       0.013308923293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326116666799
                                         uncertainty =       0.013308923293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403748048
  error estimate for blocks of size 2^( 2) =       0.000413148938
  error estimate for blocks of size 2^( 3) =       0.000421607131
  error estimate for blocks of size 2^( 4) =       0.000427441704
  error estimate for blocks of size 2^( 5) =       0.000431665057
  error estimate for blocks of size 2^( 6) =       0.000432587359
  error estimate for blocks of size 2^( 7) =       0.000434119690

      target function =                  N/A
              le_mean =     -17.216833925500
             les_mean =     296.745395227421
             stat err =       0.000431453452
             autocorr =       1.141949835437
              std dev =       0.570985964969
             le_variance =       0.326024972191


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216833925535        initial  <--
     1.4901e+03     1.4901e+04             3.1622e-07       -17.216833924973
     5.9605e+03     5.9605e+04             7.9059e-08       -17.216833925254
     2.3842e+04     2.3842e+05             1.9765e-08       -17.216833925500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3297
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465036e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411357e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168641e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342488e-03 1 1  ON 44
eH2_5                 5.548751e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2468
    reference variance = 0.19247
====================================================
  Execution time = 2.0337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2057e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320640660036
                                         uncertainty =       0.003430717147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320640660036
                                         uncertainty =       0.003430717147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400354070
  error estimate for blocks of size 2^( 2) =       0.000410152159
  error estimate for blocks of size 2^( 3) =       0.000418475117
  error estimate for blocks of size 2^( 4) =       0.000424890737
  error estimate for blocks of size 2^( 5) =       0.000428536045
  error estimate for blocks of size 2^( 6) =       0.000431204631
  error estimate for blocks of size 2^( 7) =       0.000430210934

      target function =                  N/A
              le_mean =     -17.217319450307
             les_mean =     296.756655656661
             stat err =       0.000428710587
             autocorr =       1.146673881548
              std dev =       0.566186155795
             le_variance =       0.320566763014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721731945031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217319450307       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217319450304       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217319450307       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217319450326       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217319450403       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217319450408       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217319450389       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 2.749434e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217319450307       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217319450306       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217319450307       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217319450359       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217319450274       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217319450329       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217319450274       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 6.873634e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217319450307       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217319450307       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217319450307       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217319450414       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217319450197       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217319450628       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217319450293       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.718411e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6009e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465036e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411357e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168642e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815551e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342487e-03 1 1  ON 44
eH2_5                 5.548751e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2782
    reference variance = 0.430541
====================================================
  Execution time = 1.9998e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1351e-01
  Total weights = 2.0000e+06
  Execution time = 1.8202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596359986
                                         uncertainty =       0.002439972095

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596359986
                                         uncertainty =       0.002439972095

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395924067
  error estimate for blocks of size 2^( 2) =       0.000405188215
  error estimate for blocks of size 2^( 3) =       0.000413355408
  error estimate for blocks of size 2^( 4) =       0.000419121999
  error estimate for blocks of size 2^( 5) =       0.000423236900
  error estimate for blocks of size 2^( 6) =       0.000425322186
  error estimate for blocks of size 2^( 7) =       0.000425042121

      target function =                  N/A
              le_mean =     -17.217064267504
             les_mean =     296.740813568715
             stat err =       0.000423180802
             autocorr =       1.142426080482
              std dev =       0.559921185626
             le_variance =       0.313511734113

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596364705
                                         uncertainty =       0.002439972156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596364705
                                         uncertainty =       0.002439972156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395924070
  error estimate for blocks of size 2^( 2) =       0.000405188218
  error estimate for blocks of size 2^( 3) =       0.000413355411
  error estimate for blocks of size 2^( 4) =       0.000419122002
  error estimate for blocks of size 2^( 5) =       0.000423236902
  error estimate for blocks of size 2^( 6) =       0.000425322188
  error estimate for blocks of size 2^( 7) =       0.000425042123

      target function =                  N/A
              le_mean =     -17.217064267442
             les_mean =     296.740813571296
             stat err =       0.000423180804
             autocorr =       1.142426076300
              std dev =       0.559921189838
             le_variance =       0.313511738829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596362346
                                         uncertainty =       0.002439972126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596362346
                                         uncertainty =       0.002439972126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395924069
  error estimate for blocks of size 2^( 2) =       0.000405188216
  error estimate for blocks of size 2^( 3) =       0.000413355410
  error estimate for blocks of size 2^( 4) =       0.000419122000
  error estimate for blocks of size 2^( 5) =       0.000423236901
  error estimate for blocks of size 2^( 6) =       0.000425322187
  error estimate for blocks of size 2^( 7) =       0.000425042122

      target function =                  N/A
              le_mean =     -17.217064267473
             les_mean =     296.740813570005
             stat err =       0.000423180803
             autocorr =       1.142426078379
              std dev =       0.559921187732
             le_variance =       0.313511736471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596360281
                                         uncertainty =       0.002439972099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.313596360281
                                         uncertainty =       0.002439972099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395924067
  error estimate for blocks of size 2^( 2) =       0.000405188215
  error estimate for blocks of size 2^( 3) =       0.000413355408
  error estimate for blocks of size 2^( 4) =       0.000419121999
  error estimate for blocks of size 2^( 5) =       0.000423236900
  error estimate for blocks of size 2^( 6) =       0.000425322186
  error estimate for blocks of size 2^( 7) =       0.000425042122

      target function =                  N/A
              le_mean =     -17.217064267500
             les_mean =     296.740813568876
             stat err =       0.000423180802
             autocorr =       1.142426080219
              std dev =       0.559921185889
             le_variance =       0.313511734408


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217064267504        initial  <--
     1.4901e+04     1.4901e+05             2.7494e-08       -17.217064267442
     5.9605e+04     5.9605e+05             6.8736e-09       -17.217064267473
     2.3842e+05     2.3842e+06             1.7184e-09       -17.217064267500

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2174
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465036e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411357e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168641e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342488e-03 1 1  ON 44
eH2_5                 5.548751e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1643
    reference variance = 0.282378
====================================================
  Execution time = 2.0361e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.3166e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331715402853
                                         uncertainty =       0.006653962029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331715402853
                                         uncertainty =       0.006653962029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407220291
  error estimate for blocks of size 2^( 2) =       0.000416217414
  error estimate for blocks of size 2^( 3) =       0.000424810139
  error estimate for blocks of size 2^( 4) =       0.000431018291
  error estimate for blocks of size 2^( 5) =       0.000434840875
  error estimate for blocks of size 2^( 6) =       0.000437213671
  error estimate for blocks of size 2^( 7) =       0.000437954166

      target function =                  N/A
              le_mean =     -17.215808662750
             les_mean =     296.715724477488
             stat err =       0.000435256751
             autocorr =       1.142436873994
              std dev =       0.575896458474
             le_variance =       0.331656730883


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721580866275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215808662750       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215808662750       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215808662755       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215808662761       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215808662769       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215808662779       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215808662723       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215808662678       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.009568e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215808662750       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215808662750       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215808662752       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215808662753       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215808662754       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215808662954       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215808662468       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215808662389       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 5.023921e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.215808662750       residual = 9.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.215808662750       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.215808662751       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.215808662757       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.215808662852       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.215808662448       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.215808661043       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.215808663028       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.255979e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192234 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5916e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465036e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411357e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168642e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342488e-03 1 1  ON 44
eH2_5                 5.548751e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2893
    reference variance = 0.205221
====================================================
  Execution time = 2.0006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2101e-01
  Total weights = 2.0000e+06
  Execution time = 1.8230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058443315
                                         uncertainty =       0.004747026611

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058443315
                                         uncertainty =       0.004747026611

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400633282
  error estimate for blocks of size 2^( 2) =       0.000410111236
  error estimate for blocks of size 2^( 3) =       0.000418549461
  error estimate for blocks of size 2^( 4) =       0.000424964443
  error estimate for blocks of size 2^( 5) =       0.000430156007
  error estimate for blocks of size 2^( 6) =       0.000431641421
  error estimate for blocks of size 2^( 7) =       0.000432191963

      target function =                  N/A
              le_mean =     -17.217221633478
             les_mean =     296.753734669141
             stat err =       0.000429738458
             autocorr =       1.150573569715
              std dev =       0.566581021001
             le_variance =       0.321014053358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058444946
                                         uncertainty =       0.004747026676

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058444946
                                         uncertainty =       0.004747026676

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400633283
  error estimate for blocks of size 2^( 2) =       0.000410111237
  error estimate for blocks of size 2^( 3) =       0.000418549462
  error estimate for blocks of size 2^( 4) =       0.000424964444
  error estimate for blocks of size 2^( 5) =       0.000430156008
  error estimate for blocks of size 2^( 6) =       0.000431641422
  error estimate for blocks of size 2^( 7) =       0.000432191963

      target function =                  N/A
              le_mean =     -17.217221633491
             les_mean =     296.753734671236
             stat err =       0.000429738459
             autocorr =       1.150573568604
              std dev =       0.566581022439
             le_variance =       0.321014054988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058444131
                                         uncertainty =       0.004747026644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058444131
                                         uncertainty =       0.004747026644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400633283
  error estimate for blocks of size 2^( 2) =       0.000410111237
  error estimate for blocks of size 2^( 3) =       0.000418549462
  error estimate for blocks of size 2^( 4) =       0.000424964444
  error estimate for blocks of size 2^( 5) =       0.000430156007
  error estimate for blocks of size 2^( 6) =       0.000431641422
  error estimate for blocks of size 2^( 7) =       0.000432191963

      target function =                  N/A
              le_mean =     -17.217221633484
             les_mean =     296.753734670188
             stat err =       0.000429738459
             autocorr =       1.150573569157
              std dev =       0.566581021720
             le_variance =       0.321014054173

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058443417
                                         uncertainty =       0.004747026615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321058443417
                                         uncertainty =       0.004747026615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400633282
  error estimate for blocks of size 2^( 2) =       0.000410111236
  error estimate for blocks of size 2^( 3) =       0.000418549461
  error estimate for blocks of size 2^( 4) =       0.000424964443
  error estimate for blocks of size 2^( 5) =       0.000430156007
  error estimate for blocks of size 2^( 6) =       0.000431641421
  error estimate for blocks of size 2^( 7) =       0.000432191963

      target function =                  N/A
              le_mean =     -17.217221633478
             les_mean =     296.753734669272
             stat err =       0.000429738458
             autocorr =       1.150573569649
              std dev =       0.566581021090
             le_variance =       0.321014053460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217221633478        initial
     1.4901e+05     1.4901e+06             2.0096e-09       -17.217221633491  <--
     5.9605e+05     5.9605e+06             5.0239e-10       -17.217221633484
     2.3842e+06     2.3842e+07             1.2560e-10       -17.217221633478

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 2.9239e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465036e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411357e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168642e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342488e-03 1 1  ON 44
eH2_5                 5.548751e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2419
    reference variance = 0.212748
====================================================
  Execution time = 2.0179e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1954e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5218e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319550828579
                                         uncertainty =       0.003158173566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319550828579
                                         uncertainty =       0.003158173566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399714791
  error estimate for blocks of size 2^( 2) =       0.000408885629
  error estimate for blocks of size 2^( 3) =       0.000417062455
  error estimate for blocks of size 2^( 4) =       0.000422843500
  error estimate for blocks of size 2^( 5) =       0.000427016481
  error estimate for blocks of size 2^( 6) =       0.000428681578
  error estimate for blocks of size 2^( 7) =       0.000430314745

      target function =                  N/A
              le_mean =     -17.216531294162
             les_mean =     296.728493470654
             stat err =       0.000427214076
             autocorr =       1.142327599083
              std dev =       0.565282077875
             le_variance =       0.319543827567


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721653129416e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531294162       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531294190       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531294212       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531294175       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531294226       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531294200       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531294202       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.204700e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531294162       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531294169       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531294174       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531294171       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531294218       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531294142       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531294173       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 3.011754e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216531294162       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216531294164       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216531294165       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216531294164       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216531294051       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216531294058       residual = 1.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216531294530       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 7.529384e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194477 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5712e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465036e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411357e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229724e-02 1 1  ON 19
 eO_0                -9.136373e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168642e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811500e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342489e-03 1 1  ON 44
eH2_5                 5.548752e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.136
    reference variance = 0.332107
====================================================
  Execution time = 2.0078e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2164e-01
  Total weights = 2.0000e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717812678
                                         uncertainty =       0.003699648259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717812678
                                         uncertainty =       0.003699648259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401026779
  error estimate for blocks of size 2^( 2) =       0.000410743204
  error estimate for blocks of size 2^( 3) =       0.000418784504
  error estimate for blocks of size 2^( 4) =       0.000424717037
  error estimate for blocks of size 2^( 5) =       0.000427845446
  error estimate for blocks of size 2^( 6) =       0.000429229887
  error estimate for blocks of size 2^( 7) =       0.000430342643

      target function =                  N/A
              le_mean =     -17.215574600907
             les_mean =     296.697653633110
             stat err =       0.000428033753
             autocorr =       1.139224423226
              std dev =       0.567137509382
             le_variance =       0.321644954548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717819106
                                         uncertainty =       0.003699648333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717819106
                                         uncertainty =       0.003699648333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401026783
  error estimate for blocks of size 2^( 2) =       0.000410743208
  error estimate for blocks of size 2^( 3) =       0.000418784508
  error estimate for blocks of size 2^( 4) =       0.000424717040
  error estimate for blocks of size 2^( 5) =       0.000427845450
  error estimate for blocks of size 2^( 6) =       0.000429229891
  error estimate for blocks of size 2^( 7) =       0.000430342647

      target function =                  N/A
              le_mean =     -17.215574600937
             les_mean =     296.697653640580
             stat err =       0.000428033757
             autocorr =       1.139224419581
              std dev =       0.567137515048
             le_variance =       0.321644960975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717815892
                                         uncertainty =       0.003699648296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717815892
                                         uncertainty =       0.003699648296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401026781
  error estimate for blocks of size 2^( 2) =       0.000410743206
  error estimate for blocks of size 2^( 3) =       0.000418784506
  error estimate for blocks of size 2^( 4) =       0.000424717039
  error estimate for blocks of size 2^( 5) =       0.000427845448
  error estimate for blocks of size 2^( 6) =       0.000429229889
  error estimate for blocks of size 2^( 7) =       0.000430342645

      target function =                  N/A
              le_mean =     -17.215574600922
             les_mean =     296.697653636845
             stat err =       0.000428033755
             autocorr =       1.139224421408
              std dev =       0.567137512215
             le_variance =       0.321644957761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717813080
                                         uncertainty =       0.003699648264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321717813080
                                         uncertainty =       0.003699648264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401026779
  error estimate for blocks of size 2^( 2) =       0.000410743204
  error estimate for blocks of size 2^( 3) =       0.000418784504
  error estimate for blocks of size 2^( 4) =       0.000424717037
  error estimate for blocks of size 2^( 5) =       0.000427845446
  error estimate for blocks of size 2^( 6) =       0.000429229887
  error estimate for blocks of size 2^( 7) =       0.000430342643

      target function =                  N/A
              le_mean =     -17.215574600909
             les_mean =     296.697653633577
             stat err =       0.000428033753
             autocorr =       1.139224423000
              std dev =       0.567137509736
             le_variance =       0.321644954949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215574600907        initial
     3.7253e+04     3.7253e+05             1.2047e-08       -17.215574600937  <--
     1.4901e+05     1.4901e+06             3.0118e-09       -17.215574600922
     5.9605e+05     5.9605e+06             7.5294e-10       -17.215574600909

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 2.9239e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411358e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168642e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811499e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342490e-03 1 1  ON 44
eH2_5                 5.548752e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4957e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2547
    reference variance = 0.189242
====================================================
  Execution time = 2.0606e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2240e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036117021
                                         uncertainty =       0.004443801807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322036117021
                                         uncertainty =       0.004443801807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401497704
  error estimate for blocks of size 2^( 2) =       0.000410904946
  error estimate for blocks of size 2^( 3) =       0.000418900393
  error estimate for blocks of size 2^( 4) =       0.000424979414
  error estimate for blocks of size 2^( 5) =       0.000427718469
  error estimate for blocks of size 2^( 6) =       0.000429744463
  error estimate for blocks of size 2^( 7) =       0.000430387441

      target function =                  N/A
              le_mean =     -17.217184928971
             les_mean =     296.753857529084
             stat err =       0.000428207447
             autocorr =       1.137476150942
              std dev =       0.567803497624
             le_variance =       0.322400811914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718492897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217184928971       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217184928968       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217184928903       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217184928920       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217184928933       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217184928981       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217184928971       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 4.963601e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217184928971       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217184928970       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217184928954       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217184928958       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217184928941       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217184928971       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217184928967       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 1.240911e-08

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217184928971       residual = 5.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217184928970       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217184928966       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217184928860       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217184928968       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217184929059       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217184928956       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 3.102284e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6198e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411358e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168643e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811499e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899262e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299841e-02 1 1  ON 43
eH2_4                -6.342491e-03 1 1  ON 44
eH2_5                 5.548753e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.151
    reference variance = 0.447557
====================================================
  Execution time = 2.2057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2196e-01
  Total weights = 2.0000e+06
  Execution time = 1.8353e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023040212
                                         uncertainty =       0.003421191502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023040212
                                         uncertainty =       0.003421191502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401224479
  error estimate for blocks of size 2^( 2) =       0.000410371145
  error estimate for blocks of size 2^( 3) =       0.000418777726
  error estimate for blocks of size 2^( 4) =       0.000424830238
  error estimate for blocks of size 2^( 5) =       0.000428252168
  error estimate for blocks of size 2^( 6) =       0.000429521392
  error estimate for blocks of size 2^( 7) =       0.000430748035

      target function =                  N/A
              le_mean =     -17.216902419182
             les_mean =     296.743690915334
             stat err =       0.000428337959
             autocorr =       1.139720295785
              std dev =       0.567417099375
             le_variance =       0.321962164663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023051406
                                         uncertainty =       0.003421191620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023051406
                                         uncertainty =       0.003421191620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401224486
  error estimate for blocks of size 2^( 2) =       0.000410371152
  error estimate for blocks of size 2^( 3) =       0.000418777732
  error estimate for blocks of size 2^( 4) =       0.000424830245
  error estimate for blocks of size 2^( 5) =       0.000428252174
  error estimate for blocks of size 2^( 6) =       0.000429521398
  error estimate for blocks of size 2^( 7) =       0.000430748042

      target function =                  N/A
              le_mean =     -17.216902419177
             les_mean =     296.743690926345
             stat err =       0.000428337965
             autocorr =       1.139720288571
              std dev =       0.567417109236
             le_variance =       0.321962175854

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023045809
                                         uncertainty =       0.003421191561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023045809
                                         uncertainty =       0.003421191561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401224482
  error estimate for blocks of size 2^( 2) =       0.000410371148
  error estimate for blocks of size 2^( 3) =       0.000418777729
  error estimate for blocks of size 2^( 4) =       0.000424830242
  error estimate for blocks of size 2^( 5) =       0.000428252171
  error estimate for blocks of size 2^( 6) =       0.000429521395
  error estimate for blocks of size 2^( 7) =       0.000430748039

      target function =                  N/A
              le_mean =     -17.216902419180
             les_mean =     296.743690920840
             stat err =       0.000428337962
             autocorr =       1.139720292185
              std dev =       0.567417104305
             le_variance =       0.321962170258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023040912
                                         uncertainty =       0.003421191509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322023040912
                                         uncertainty =       0.003421191509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401224479
  error estimate for blocks of size 2^( 2) =       0.000410371145
  error estimate for blocks of size 2^( 3) =       0.000418777726
  error estimate for blocks of size 2^( 4) =       0.000424830239
  error estimate for blocks of size 2^( 5) =       0.000428252169
  error estimate for blocks of size 2^( 6) =       0.000429521393
  error estimate for blocks of size 2^( 7) =       0.000430748036

      target function =                  N/A
              le_mean =     -17.216902419182
             les_mean =     296.743690916022
             stat err =       0.000428337959
             autocorr =       1.139720295331
              std dev =       0.567417099991
             le_variance =       0.321962165362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216902419182        initial  <--
     9.3132e+03     9.3132e+04             4.9636e-08       -17.216902419177
     3.7253e+04     3.7253e+05             1.2409e-08       -17.216902419180
     1.4901e+05     1.4901e+06             3.1023e-09       -17.216902419182

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3379
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411358e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168642e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811499e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342490e-03 1 1  ON 44
eH2_5                 5.548752e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7541e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1819
    reference variance = 0.216469
====================================================
  Execution time = 2.0353e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2068e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722219131
                                         uncertainty =       0.005315669099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320722219131
                                         uncertainty =       0.005315669099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400427893
  error estimate for blocks of size 2^( 2) =       0.000409624156
  error estimate for blocks of size 2^( 3) =       0.000418438925
  error estimate for blocks of size 2^( 4) =       0.000424569234
  error estimate for blocks of size 2^( 5) =       0.000429244336
  error estimate for blocks of size 2^( 6) =       0.000431387800
  error estimate for blocks of size 2^( 7) =       0.000432399364

      target function =                  N/A
              le_mean =     -17.216924639716
             les_mean =     296.743178883676
             stat err =       0.000429400184
             autocorr =       1.149941662626
              std dev =       0.566290556483
             le_variance =       0.320684994361


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692463972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216924639716       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216924639711       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216924639707       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216924639721       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216924639806       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216924639714       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216924639655       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 4.969439e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216924639716       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216924639715       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216924639714       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216924639670       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216924639414       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216924639811       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216924639778       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.242361e-09

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216924639716       residual = 6.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216924639716       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216924639715       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216924639905       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216924639915       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216924640623       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216924639101       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 3.105900e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5887e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411358e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168642e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811499e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299840e-02 1 1  ON 43
eH2_4                -6.342489e-03 1 1  ON 44
eH2_5                 5.548753e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.205686
====================================================
  Execution time = 1.9949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1727e-01
  Total weights = 2.0000e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992324999
                                         uncertainty =       0.003113967182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992324999
                                         uncertainty =       0.003113967182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398289055
  error estimate for blocks of size 2^( 2) =       0.000408051125
  error estimate for blocks of size 2^( 3) =       0.000416582481
  error estimate for blocks of size 2^( 4) =       0.000422628687
  error estimate for blocks of size 2^( 5) =       0.000425639175
  error estimate for blocks of size 2^( 6) =       0.000426716083
  error estimate for blocks of size 2^( 7) =       0.000427190023

      target function =                  N/A
              le_mean =     -17.217287488970
             les_mean =     296.752256661651
             stat err =       0.000425543492
             autocorr =       1.141540075037
              std dev =       0.563265783125
             le_variance =       0.317268342439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992325183
                                         uncertainty =       0.003113967171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992325183
                                         uncertainty =       0.003113967171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398289055
  error estimate for blocks of size 2^( 2) =       0.000408051125
  error estimate for blocks of size 2^( 3) =       0.000416582481
  error estimate for blocks of size 2^( 4) =       0.000422628687
  error estimate for blocks of size 2^( 5) =       0.000425639175
  error estimate for blocks of size 2^( 6) =       0.000426716083
  error estimate for blocks of size 2^( 7) =       0.000427190023

      target function =                  N/A
              le_mean =     -17.217287488992
             les_mean =     296.752256662577
             stat err =       0.000425543492
             autocorr =       1.141540074657
              std dev =       0.563265783292
             le_variance =       0.317268342627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992325091
                                         uncertainty =       0.003113967177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992325091
                                         uncertainty =       0.003113967177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398289055
  error estimate for blocks of size 2^( 2) =       0.000408051125
  error estimate for blocks of size 2^( 3) =       0.000416582481
  error estimate for blocks of size 2^( 4) =       0.000422628687
  error estimate for blocks of size 2^( 5) =       0.000425639175
  error estimate for blocks of size 2^( 6) =       0.000426716083
  error estimate for blocks of size 2^( 7) =       0.000427190023

      target function =                  N/A
              le_mean =     -17.217287488981
             les_mean =     296.752256662114
             stat err =       0.000425543492
             autocorr =       1.141540074843
              std dev =       0.563265783208
             le_variance =       0.317268342533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992325011
                                         uncertainty =       0.003113967182

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316992325011
                                         uncertainty =       0.003113967182

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398289055
  error estimate for blocks of size 2^( 2) =       0.000408051125
  error estimate for blocks of size 2^( 3) =       0.000416582481
  error estimate for blocks of size 2^( 4) =       0.000422628687
  error estimate for blocks of size 2^( 5) =       0.000425639175
  error estimate for blocks of size 2^( 6) =       0.000426716083
  error estimate for blocks of size 2^( 7) =       0.000427190023

      target function =                  N/A
              le_mean =     -17.217287488971
             les_mean =     296.752256661709
             stat err =       0.000425543492
             autocorr =       1.141540075009
              std dev =       0.563265783135
             le_variance =       0.317268342451


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217287488970        initial
     9.3132e+04     9.3132e+05             4.9694e-09       -17.217287488992  <--
     3.7253e+05     3.7253e+06             1.2424e-09       -17.217287488981
     1.4901e+06     1.4901e+07             3.1059e-10       -17.217287488971

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.9181e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952135e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411358e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168643e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811499e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899263e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299841e-02 1 1  ON 43
eH2_4                -6.342489e-03 1 1  ON 44
eH2_5                 5.548753e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5074e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7208e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2185
    reference variance = 0.296623
====================================================
  Execution time = 2.0475e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1890e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318839010584
                                         uncertainty =       0.003442698913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318839010584
                                         uncertainty =       0.003442698913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399312413
  error estimate for blocks of size 2^( 2) =       0.000408597600
  error estimate for blocks of size 2^( 3) =       0.000416798045
  error estimate for blocks of size 2^( 4) =       0.000423272473
  error estimate for blocks of size 2^( 5) =       0.000427675887
  error estimate for blocks of size 2^( 6) =       0.000429209882
  error estimate for blocks of size 2^( 7) =       0.000430546692

      target function =                  N/A
              le_mean =     -17.216755361621
             les_mean =     296.735565828798
             stat err =       0.000427676233
             autocorr =       1.147108799184
              std dev =       0.564713030081
             le_variance =       0.318900806343


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721675536162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755361621       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755361634       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755361645       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755361691       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216755361691       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216755361680       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216755361687       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.925536e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755361621       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755361624       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755361627       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755361638       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216755361638       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216755361720       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216755361614       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 4.813861e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216755361621       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216755361622       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216755361623       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216755361718       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216755361841       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216755361353       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216755361934       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 1.203465e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6053e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540205e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411358e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779117e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168643e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811499e-02 1 1  ON 34
eH1_5                -4.815552e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899262e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299841e-02 1 1  ON 43
eH2_4                -6.342488e-03 1 1  ON 44
eH2_5                 5.548753e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2534
    reference variance = 0.2144
====================================================
  Execution time = 2.0090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.2302e-01
  Total weights = 2.0000e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077667807
                                         uncertainty =       0.006129681910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077667807
                                         uncertainty =       0.006129681910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401885975
  error estimate for blocks of size 2^( 2) =       0.000410848061
  error estimate for blocks of size 2^( 3) =       0.000419533374
  error estimate for blocks of size 2^( 4) =       0.000425262238
  error estimate for blocks of size 2^( 5) =       0.000430040256
  error estimate for blocks of size 2^( 6) =       0.000432791509
  error estimate for blocks of size 2^( 7) =       0.000433169558

      target function =                  N/A
              le_mean =     -17.216327439667
             les_mean =     296.724955022452
             stat err =       0.000430315890
             autocorr =       1.146486817891
              std dev =       0.568352596661
             le_variance =       0.323024674131

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077678406
                                         uncertainty =       0.006129682077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077678406
                                         uncertainty =       0.006129682077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401885982
  error estimate for blocks of size 2^( 2) =       0.000410848067
  error estimate for blocks of size 2^( 3) =       0.000419533379
  error estimate for blocks of size 2^( 4) =       0.000425262243
  error estimate for blocks of size 2^( 5) =       0.000430040262
  error estimate for blocks of size 2^( 6) =       0.000432791514
  error estimate for blocks of size 2^( 7) =       0.000433169563

      target function =                  N/A
              le_mean =     -17.216327439705
             les_mean =     296.724955034366
             stat err =       0.000430315895
             autocorr =       1.146486808389
              std dev =       0.568352605983
             le_variance =       0.323024684728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077673107
                                         uncertainty =       0.006129681994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077673107
                                         uncertainty =       0.006129681994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401885978
  error estimate for blocks of size 2^( 2) =       0.000410848064
  error estimate for blocks of size 2^( 3) =       0.000419533377
  error estimate for blocks of size 2^( 4) =       0.000425262240
  error estimate for blocks of size 2^( 5) =       0.000430040259
  error estimate for blocks of size 2^( 6) =       0.000432791512
  error estimate for blocks of size 2^( 7) =       0.000433169560

      target function =                  N/A
              le_mean =     -17.216327439686
             les_mean =     296.724955028409
             stat err =       0.000430315893
             autocorr =       1.146486813126
              std dev =       0.568352601322
             le_variance =       0.323024679429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077668470
                                         uncertainty =       0.006129681921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323077668470
                                         uncertainty =       0.006129681921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401885976
  error estimate for blocks of size 2^( 2) =       0.000410848061
  error estimate for blocks of size 2^( 3) =       0.000419533374
  error estimate for blocks of size 2^( 4) =       0.000425262238
  error estimate for blocks of size 2^( 5) =       0.000430040257
  error estimate for blocks of size 2^( 6) =       0.000432791509
  error estimate for blocks of size 2^( 7) =       0.000433169558

      target function =                  N/A
              le_mean =     -17.216327439669
             les_mean =     296.724955023197
             stat err =       0.000430315891
             autocorr =       1.146486817296
              std dev =       0.568352597243
             le_variance =       0.323024674793


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216327439667        initial
     2.3283e+04     2.3283e+05             1.9255e-08       -17.216327439705  <--
     9.3132e+04     9.3132e+05             4.8139e-09       -17.216327439686
     3.7253e+05     3.7253e+06             1.2035e-09       -17.216327439669

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 2.9286e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540206e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411359e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857513e-01 1 1  ON 22
 eO_3                 8.168644e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811499e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899262e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299841e-02 1 1  ON 43
eH2_4                -6.342486e-03 1 1  ON 44
eH2_5                 5.548754e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2194
    reference variance = 0.490018
====================================================
  Execution time = 2.0432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.4019e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340297289348
                                         uncertainty =       0.024213210929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340297289348
                                         uncertainty =       0.024213210929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412424348
  error estimate for blocks of size 2^( 2) =       0.000421891985
  error estimate for blocks of size 2^( 3) =       0.000429811153
  error estimate for blocks of size 2^( 4) =       0.000435988572
  error estimate for blocks of size 2^( 5) =       0.000439484293
  error estimate for blocks of size 2^( 6) =       0.000441821449
  error estimate for blocks of size 2^( 7) =       0.000443986486

      target function =                  N/A
              le_mean =     -17.216722314381
             les_mean =     296.755714765991
             stat err =       0.000440320200
             autocorr =       1.139852419892
              std dev =       0.583256106342
             le_variance =       0.340187685585


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721672231438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722314381       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722314457       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722314403       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722314483       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722314499       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722314609       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722314585       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 8.834183e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722314381       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722314400       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722314386       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722314406       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722314412       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722314437       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722314431       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 2.208589e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216722314381       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216722314386       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216722314382       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216722314416       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216722314287       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216722314310       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216722314411       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 5.521500e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203338 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5981e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465037e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540206e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411359e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136374e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168645e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331354e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811498e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565051e-02 1 1  ON 36
eH1_7                 7.899262e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299841e-02 1 1  ON 43
eH2_4                -6.342488e-03 1 1  ON 44
eH2_5                 5.548750e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899819e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.212505
====================================================
  Execution time = 1.9975e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7216e+01
  VMC Evar = 3.1694e-01
  Total weights = 2.0000e+06
  Execution time = 1.8179e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889225620
                                         uncertainty =       0.003323562941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889225620
                                         uncertainty =       0.003323562941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398084338
  error estimate for blocks of size 2^( 2) =       0.000407970279
  error estimate for blocks of size 2^( 3) =       0.000416721902
  error estimate for blocks of size 2^( 4) =       0.000423317065
  error estimate for blocks of size 2^( 5) =       0.000427951037
  error estimate for blocks of size 2^( 6) =       0.000430118009
  error estimate for blocks of size 2^( 7) =       0.000432742831

      target function =                  N/A
              le_mean =     -17.216163450304
             les_mean =     296.713226068996
             stat err =       0.000428532236
             autocorr =       1.158822211667
              std dev =       0.562976269376
             le_variance =       0.316942279881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889277051
                                         uncertainty =       0.003323563438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889277051
                                         uncertainty =       0.003323563438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398084370
  error estimate for blocks of size 2^( 2) =       0.000407970310
  error estimate for blocks of size 2^( 3) =       0.000416721931
  error estimate for blocks of size 2^( 4) =       0.000423317093
  error estimate for blocks of size 2^( 5) =       0.000427951065
  error estimate for blocks of size 2^( 6) =       0.000430118036
  error estimate for blocks of size 2^( 7) =       0.000432742858

      target function =                  N/A
              le_mean =     -17.216163450386
             les_mean =     296.713226123264
             stat err =       0.000428532263
             autocorr =       1.158822171136
              std dev =       0.562976315080
             le_variance =       0.316942331341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889251336
                                         uncertainty =       0.003323563190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889251336
                                         uncertainty =       0.003323563190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398084354
  error estimate for blocks of size 2^( 2) =       0.000407970295
  error estimate for blocks of size 2^( 3) =       0.000416721917
  error estimate for blocks of size 2^( 4) =       0.000423317079
  error estimate for blocks of size 2^( 5) =       0.000427951051
  error estimate for blocks of size 2^( 6) =       0.000430118022
  error estimate for blocks of size 2^( 7) =       0.000432742844

      target function =                  N/A
              le_mean =     -17.216163450345
             les_mean =     296.713226096131
             stat err =       0.000428532249
             autocorr =       1.158822191405
              std dev =       0.562976292229
             le_variance =       0.316942305612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889228834
                                         uncertainty =       0.003323562972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316889228834
                                         uncertainty =       0.003323562972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398084340
  error estimate for blocks of size 2^( 2) =       0.000407970281
  error estimate for blocks of size 2^( 3) =       0.000416721904
  error estimate for blocks of size 2^( 4) =       0.000423317067
  error estimate for blocks of size 2^( 5) =       0.000427951039
  error estimate for blocks of size 2^( 6) =       0.000430118010
  error estimate for blocks of size 2^( 7) =       0.000432742833

      target function =                  N/A
              le_mean =     -17.216163450309
             les_mean =     296.713226072388
             stat err =       0.000428532237
             autocorr =       1.158822209135
              std dev =       0.562976272233
             le_variance =       0.316942283097


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216163450304        initial
     5.8208e+03     5.8208e+04             8.8342e-08       -17.216163450386  <--
     2.3283e+04     2.3283e+05             2.2086e-08       -17.216163450345
     9.3132e+04     9.3132e+05             5.5215e-09       -17.216163450309

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.9163e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465038e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296614e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811497e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342494e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5151e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2163
    reference variance = 0.168499
====================================================
  Execution time = 2.0297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.2073e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7532e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320732699876
                                         uncertainty =       0.005769161065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320732699876
                                         uncertainty =       0.005769161065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400457152
  error estimate for blocks of size 2^( 2) =       0.000409911247
  error estimate for blocks of size 2^( 3) =       0.000418324164
  error estimate for blocks of size 2^( 4) =       0.000424516583
  error estimate for blocks of size 2^( 5) =       0.000428667633
  error estimate for blocks of size 2^( 6) =       0.000430403485
  error estimate for blocks of size 2^( 7) =       0.000431375213

      target function =                  N/A
              le_mean =     -17.217790492273
             les_mean =     296.773041136401
             stat err =       0.000428740728
             autocorr =       1.146244789520
              std dev =       0.566331935317
             le_variance =       0.320731860960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721779049227e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217790492273       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217790494002       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217790494259       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217790494651       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217790494958       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217790495052       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217790494902       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 3.181561e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217790492273       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217790492705       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217790492770       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217790492865       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217790492946       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217790492968       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217790492930       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 7.954581e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217790492273       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217790492381       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217790492397       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217790492433       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217790492435       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217790492449       residual = 8.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217790492454       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.988688e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6076e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952137e-02 1 1  ON 1
 uu_2                -6.465041e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891561e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540210e-02 1 1  ON 11
 ud_2                -1.296615e-02 1 1  ON 12
 ud_3                -7.411365e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168653e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019339e-01 1 1  ON 32
eH1_3                -6.433223e-02 1 1  ON 33
eH1_4                -1.811494e-02 1 1  ON 34
eH1_5                -4.815528e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899259e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075275e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342507e-03 1 1  ON 44
eH2_5                 5.548736e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2543
    reference variance = 0.155606
====================================================
  Execution time = 1.9830e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1782e-01
  Total weights = 2.0000e+06
  Execution time = 1.8219e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849121145
                                         uncertainty =       0.003508557741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849121145
                                         uncertainty =       0.003508557741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398633509
  error estimate for blocks of size 2^( 2) =       0.000408111850
  error estimate for blocks of size 2^( 3) =       0.000417086254
  error estimate for blocks of size 2^( 4) =       0.000423265504
  error estimate for blocks of size 2^( 5) =       0.000426822394
  error estimate for blocks of size 2^( 6) =       0.000429528439
  error estimate for blocks of size 2^( 7) =       0.000430763236

      target function =                  N/A
              le_mean =     -17.217181393843
             les_mean =     296.749152338629
             stat err =       0.000427594893
             autocorr =       1.150581573213
              std dev =       0.563752914889
             le_variance =       0.317817349046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849261503
                                         uncertainty =       0.003508559096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849261503
                                         uncertainty =       0.003508559096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398633597
  error estimate for blocks of size 2^( 2) =       0.000408111934
  error estimate for blocks of size 2^( 3) =       0.000417086332
  error estimate for blocks of size 2^( 4) =       0.000423265577
  error estimate for blocks of size 2^( 5) =       0.000426822463
  error estimate for blocks of size 2^( 6) =       0.000429528505
  error estimate for blocks of size 2^( 7) =       0.000430763297

      target function =                  N/A
              le_mean =     -17.217181392708
             les_mean =     296.749152439919
             stat err =       0.000427594961
             autocorr =       1.150581427616
              std dev =       0.563753039380
             le_variance =       0.317817489410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849191327
                                         uncertainty =       0.003508558419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849191327
                                         uncertainty =       0.003508558419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398633553
  error estimate for blocks of size 2^( 2) =       0.000408111892
  error estimate for blocks of size 2^( 3) =       0.000417086293
  error estimate for blocks of size 2^( 4) =       0.000423265541
  error estimate for blocks of size 2^( 5) =       0.000426822428
  error estimate for blocks of size 2^( 6) =       0.000429528472
  error estimate for blocks of size 2^( 7) =       0.000430763266

      target function =                  N/A
              le_mean =     -17.217181393275
             les_mean =     296.749152389271
             stat err =       0.000427594927
             autocorr =       1.150581500406
              std dev =       0.563752977136
             le_variance =       0.317817419230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849129918
                                         uncertainty =       0.003508557826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317849129918
                                         uncertainty =       0.003508557826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398633515
  error estimate for blocks of size 2^( 2) =       0.000408111856
  error estimate for blocks of size 2^( 3) =       0.000417086259
  error estimate for blocks of size 2^( 4) =       0.000423265509
  error estimate for blocks of size 2^( 5) =       0.000426822398
  error estimate for blocks of size 2^( 6) =       0.000429528443
  error estimate for blocks of size 2^( 7) =       0.000430763239

      target function =                  N/A
              le_mean =     -17.217181393772
             les_mean =     296.749152344959
             stat err =       0.000427594897
             autocorr =       1.150581564119
              std dev =       0.563752922670
             le_variance =       0.317817357819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217181393843        initial  <--
     1.4552e+03     1.4552e+04             3.1816e-07       -17.217181392708
     5.8208e+03     5.8208e+04             7.9546e-08       -17.217181393275
     2.3283e+04     2.3283e+05             1.9887e-08       -17.217181393772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0319
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465038e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296614e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811497e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342494e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5114e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.193
    reference variance = 0.2452
====================================================
  Execution time = 2.0542e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2308e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323082591947
                                         uncertainty =       0.009946064269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323082591947
                                         uncertainty =       0.009946064269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401923030
  error estimate for blocks of size 2^( 2) =       0.000411040995
  error estimate for blocks of size 2^( 3) =       0.000419334653
  error estimate for blocks of size 2^( 4) =       0.000425009095
  error estimate for blocks of size 2^( 5) =       0.000428420829
  error estimate for blocks of size 2^( 6) =       0.000429307657
  error estimate for blocks of size 2^( 7) =       0.000429662183

      target function =                  N/A
              le_mean =     -17.216928540238
             les_mean =     296.745712442588
             stat err =       0.000428099941
             autocorr =       1.134500135908
              std dev =       0.568405000376
             le_variance =       0.323084244453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721692854024e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928540238       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928540220       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216928540164       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216928540145       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216928540203       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216928540218       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216928540207       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.843322e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928540238       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928540234       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216928540220       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216928540215       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216928540226       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216928540225       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216928540166       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 7.108348e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216928540238       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216928540237       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216928540234       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216928540065       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216928540118       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216928540238       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216928540603       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.777090e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207816 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6034e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465038e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296614e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811496e-02 1 1  ON 34
eH1_5                -4.815550e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342494e-03 1 1  ON 44
eH2_5                 5.548739e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2814
    reference variance = 0.310067
====================================================
  Execution time = 2.0494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1746e-01
  Total weights = 2.0000e+06
  Execution time = 1.8196e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466869081
                                         uncertainty =       0.004435525340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466869081
                                         uncertainty =       0.004435525340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398406487
  error estimate for blocks of size 2^( 2) =       0.000408444651
  error estimate for blocks of size 2^( 3) =       0.000417024087
  error estimate for blocks of size 2^( 4) =       0.000422966612
  error estimate for blocks of size 2^( 5) =       0.000426003862
  error estimate for blocks of size 2^( 6) =       0.000427599746
  error estimate for blocks of size 2^( 7) =       0.000430155035

      target function =                  N/A
              le_mean =     -17.216789003870
             les_mean =     296.735278902707
             stat err =       0.000426681314
             autocorr =       1.146976302371
              std dev =       0.563431857149
             le_variance =       0.317455457650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466879981
                                         uncertainty =       0.004435525500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466879981
                                         uncertainty =       0.004435525500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398406494
  error estimate for blocks of size 2^( 2) =       0.000408444657
  error estimate for blocks of size 2^( 3) =       0.000417024094
  error estimate for blocks of size 2^( 4) =       0.000422966619
  error estimate for blocks of size 2^( 5) =       0.000426003868
  error estimate for blocks of size 2^( 6) =       0.000427599753
  error estimate for blocks of size 2^( 7) =       0.000430155040

      target function =                  N/A
              le_mean =     -17.216789003688
             les_mean =     296.735278907337
             stat err =       0.000426681320
             autocorr =       1.146976296166
              std dev =       0.563431866818
             le_variance =       0.317455468546

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466874531
                                         uncertainty =       0.004435525420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466874531
                                         uncertainty =       0.004435525420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398406490
  error estimate for blocks of size 2^( 2) =       0.000408444654
  error estimate for blocks of size 2^( 3) =       0.000417024090
  error estimate for blocks of size 2^( 4) =       0.000422966616
  error estimate for blocks of size 2^( 5) =       0.000426003865
  error estimate for blocks of size 2^( 6) =       0.000427599750
  error estimate for blocks of size 2^( 7) =       0.000430155037

      target function =                  N/A
              le_mean =     -17.216789003779
             les_mean =     296.735278905022
             stat err =       0.000426681317
             autocorr =       1.146976299266
              std dev =       0.563431861983
             le_variance =       0.317455463098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466869763
                                         uncertainty =       0.004435525350

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317466869763
                                         uncertainty =       0.004435525350

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398406487
  error estimate for blocks of size 2^( 2) =       0.000408444651
  error estimate for blocks of size 2^( 3) =       0.000417024088
  error estimate for blocks of size 2^( 4) =       0.000422966613
  error estimate for blocks of size 2^( 5) =       0.000426003862
  error estimate for blocks of size 2^( 6) =       0.000427599747
  error estimate for blocks of size 2^( 7) =       0.000430155035

      target function =                  N/A
              le_mean =     -17.216789003859
             les_mean =     296.735278902996
             stat err =       0.000426681314
             autocorr =       1.146976301988
              std dev =       0.563431857753
             le_variance =       0.317455458331


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216789003870        initial  <--
     1.4552e+04     1.4552e+05             2.8433e-08       -17.216789003688
     5.8208e+04     5.8208e+05             7.1083e-09       -17.216789003779
     2.3283e+05     2.3283e+06             1.7771e-09       -17.216789003859

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.1849
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465038e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296614e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811497e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342494e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2652
    reference variance = 0.365611
====================================================
  Execution time = 2.0090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2868e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5806e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328659748032
                                         uncertainty =       0.008254737118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328659748032
                                         uncertainty =       0.008254737118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405391738
  error estimate for blocks of size 2^( 2) =       0.000414567071
  error estimate for blocks of size 2^( 3) =       0.000422717572
  error estimate for blocks of size 2^( 4) =       0.000429718177
  error estimate for blocks of size 2^( 5) =       0.000434046779
  error estimate for blocks of size 2^( 6) =       0.000434665258
  error estimate for blocks of size 2^( 7) =       0.000436676414

      target function =                  N/A
              le_mean =     -17.217213259153
             les_mean =     296.761117169300
             stat err =       0.000433776657
             autocorr =       1.144939577644
              std dev =       0.573310493974
             le_variance =       0.328684922501


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721721325915e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217213259153       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217213259154       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217213259156       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217213259123       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217213259078       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217213259263       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217213259149       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.952868e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217213259153       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217213259153       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217213259153       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217213259154       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217213259252       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217213259366       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217213259382       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 7.382174e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217213259153       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217213259153       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217213259153       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217213259153       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217213259153       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217213260691       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217213260218       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.845543e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.210022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5682e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465038e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296614e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811497e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342494e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2119
    reference variance = 0.308253
====================================================
  Execution time = 1.9851e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1918e-01
  Total weights = 2.0000e+06
  Execution time = 1.8240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378283
                                         uncertainty =       0.003862178201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378283
                                         uncertainty =       0.003862178201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399484621
  error estimate for blocks of size 2^( 2) =       0.000408857409
  error estimate for blocks of size 2^( 3) =       0.000416724651
  error estimate for blocks of size 2^( 4) =       0.000423294868
  error estimate for blocks of size 2^( 5) =       0.000427786860
  error estimate for blocks of size 2^( 6) =       0.000429354267
  error estimate for blocks of size 2^( 7) =       0.000432343271

      target function =                  N/A
              le_mean =     -17.216951073707
             les_mean =     296.742580040368
             stat err =       0.000428194817
             autocorr =       1.148901194623
              std dev =       0.564956569594
             le_variance =       0.319175925528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378607
                                         uncertainty =       0.003862178213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378607
                                         uncertainty =       0.003862178213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399484622
  error estimate for blocks of size 2^( 2) =       0.000408857409
  error estimate for blocks of size 2^( 3) =       0.000416724651
  error estimate for blocks of size 2^( 4) =       0.000423294868
  error estimate for blocks of size 2^( 5) =       0.000427786860
  error estimate for blocks of size 2^( 6) =       0.000429354268
  error estimate for blocks of size 2^( 7) =       0.000432343272

      target function =                  N/A
              le_mean =     -17.216951073709
             les_mean =     296.742580040766
             stat err =       0.000428194817
             autocorr =       1.148901194529
              std dev =       0.564956569881
             le_variance =       0.319175925851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378445
                                         uncertainty =       0.003862178207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378445
                                         uncertainty =       0.003862178207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399484622
  error estimate for blocks of size 2^( 2) =       0.000408857409
  error estimate for blocks of size 2^( 3) =       0.000416724651
  error estimate for blocks of size 2^( 4) =       0.000423294868
  error estimate for blocks of size 2^( 5) =       0.000427786860
  error estimate for blocks of size 2^( 6) =       0.000429354267
  error estimate for blocks of size 2^( 7) =       0.000432343271

      target function =                  N/A
              le_mean =     -17.216951073708
             les_mean =     296.742580040567
             stat err =       0.000428194817
             autocorr =       1.148901194573
              std dev =       0.564956569738
             le_variance =       0.319175925690

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378303
                                         uncertainty =       0.003862178202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319207378303
                                         uncertainty =       0.003862178202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399484621
  error estimate for blocks of size 2^( 2) =       0.000408857409
  error estimate for blocks of size 2^( 3) =       0.000416724651
  error estimate for blocks of size 2^( 4) =       0.000423294868
  error estimate for blocks of size 2^( 5) =       0.000427786860
  error estimate for blocks of size 2^( 6) =       0.000429354267
  error estimate for blocks of size 2^( 7) =       0.000432343271

      target function =                  N/A
              le_mean =     -17.216951073707
             les_mean =     296.742580040393
             stat err =       0.000428194817
             autocorr =       1.148901194611
              std dev =       0.564956569612
             le_variance =       0.319175925548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216951073707        initial
     1.4552e+05     1.4552e+06             2.9529e-09       -17.216951073709  <--
     5.8208e+05     5.8208e+06             7.3822e-10       -17.216951073708
     2.3283e+06     2.3283e+07             1.8455e-10       -17.216951073707

*****************************************************************************
Applying the update for shift_i =   1.4552e+05     and shift_s =   1.4552e+06
*****************************************************************************

  Execution time = 2.9081e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465038e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296614e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811497e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4768e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2534
    reference variance = 0.190228
====================================================
  Execution time = 2.0250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1446e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314433121849
                                         uncertainty =       0.003521013720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.314433121849
                                         uncertainty =       0.003521013720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396523964
  error estimate for blocks of size 2^( 2) =       0.000405656924
  error estimate for blocks of size 2^( 3) =       0.000414694712
  error estimate for blocks of size 2^( 4) =       0.000421057230
  error estimate for blocks of size 2^( 5) =       0.000425515476
  error estimate for blocks of size 2^( 6) =       0.000427197423
  error estimate for blocks of size 2^( 7) =       0.000427413791

      target function =                  N/A
              le_mean =     -17.216793295085
             les_mean =     296.732433717202
             stat err =       0.000425295980
             autocorr =       1.150386233610
              std dev =       0.560769568305
             le_variance =       0.314462508737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721679329509e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216793295085       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216793295093       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216793295057       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216793295058       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216793295178       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216793295169       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216793295129       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.071972e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216793295085       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216793295087       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216793295078       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216793295078       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216793295085       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216793295085       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216793295083       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 2.679935e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216793295085       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216793295086       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216793295084       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216793295128       residual = 9.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216793295070       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216793294161       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216793295228       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 6.699846e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5766e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465038e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296614e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168648e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811496e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548739e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899820e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.342
    reference variance = 0.367284
====================================================
  Execution time = 2.0123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2197e-01
  Total weights = 2.0000e+06
  Execution time = 1.8181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927339390
                                         uncertainty =       0.003542378571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927339390
                                         uncertainty =       0.003542378571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401227030
  error estimate for blocks of size 2^( 2) =       0.000410571719
  error estimate for blocks of size 2^( 3) =       0.000418582994
  error estimate for blocks of size 2^( 4) =       0.000424232840
  error estimate for blocks of size 2^( 5) =       0.000428179584
  error estimate for blocks of size 2^( 6) =       0.000428956170
  error estimate for blocks of size 2^( 7) =       0.000430348777

      target function =                  N/A
              le_mean =     -17.217190975933
             les_mean =     296.753631199213
             stat err =       0.000427929343
             autocorr =       1.137532381854
              std dev =       0.567420706762
             le_variance =       0.321966258462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927346259
                                         uncertainty =       0.003542378663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927346259
                                         uncertainty =       0.003542378663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401227034
  error estimate for blocks of size 2^( 2) =       0.000410571724
  error estimate for blocks of size 2^( 3) =       0.000418582998
  error estimate for blocks of size 2^( 4) =       0.000424232844
  error estimate for blocks of size 2^( 5) =       0.000428179588
  error estimate for blocks of size 2^( 6) =       0.000428956174
  error estimate for blocks of size 2^( 7) =       0.000430348781

      target function =                  N/A
              le_mean =     -17.217190975997
             les_mean =     296.753631208313
             stat err =       0.000427929346
             autocorr =       1.137532376983
              std dev =       0.567420712819
             le_variance =       0.321966265336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927342825
                                         uncertainty =       0.003542378617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927342825
                                         uncertainty =       0.003542378617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401227032
  error estimate for blocks of size 2^( 2) =       0.000410571722
  error estimate for blocks of size 2^( 3) =       0.000418582996
  error estimate for blocks of size 2^( 4) =       0.000424232842
  error estimate for blocks of size 2^( 5) =       0.000428179586
  error estimate for blocks of size 2^( 6) =       0.000428956172
  error estimate for blocks of size 2^( 7) =       0.000430348779

      target function =                  N/A
              le_mean =     -17.217190975965
             les_mean =     296.753631203763
             stat err =       0.000427929345
             autocorr =       1.137532379406
              std dev =       0.567420709790
             le_variance =       0.321966261899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927339819
                                         uncertainty =       0.003542378577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321927339819
                                         uncertainty =       0.003542378577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401227030
  error estimate for blocks of size 2^( 2) =       0.000410571720
  error estimate for blocks of size 2^( 3) =       0.000418582994
  error estimate for blocks of size 2^( 4) =       0.000424232840
  error estimate for blocks of size 2^( 5) =       0.000428179584
  error estimate for blocks of size 2^( 6) =       0.000428956171
  error estimate for blocks of size 2^( 7) =       0.000430348777

      target function =                  N/A
              le_mean =     -17.217190975937
             les_mean =     296.753631199782
             stat err =       0.000427929343
             autocorr =       1.137532381546
              std dev =       0.567420707141
             le_variance =       0.321966258892


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217190975933        initial
     3.6380e+04     3.6380e+05             1.0720e-08       -17.217190975997  <--
     1.4552e+05     1.4552e+06             2.6799e-09       -17.217190975965
     5.8208e+05     5.8208e+06             6.6998e-10       -17.217190975937

*****************************************************************************
Applying the update for shift_i =   3.6380e+04     and shift_s =   3.6380e+05
*****************************************************************************

  Execution time = 2.9383e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465039e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540207e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411362e-02 1 1  ON 13
 ud_4                -1.245723e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168649e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433222e-02 1 1  ON 33
eH1_4                -1.811496e-02 1 1  ON 34
eH1_5                -4.815553e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899261e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548738e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5154e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2545
    reference variance = 0.401126
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2895e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328977130894
                                         uncertainty =       0.010979189989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328977130894
                                         uncertainty =       0.010979189989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405554610
  error estimate for blocks of size 2^( 2) =       0.000415084453
  error estimate for blocks of size 2^( 3) =       0.000423650341
  error estimate for blocks of size 2^( 4) =       0.000430417518
  error estimate for blocks of size 2^( 5) =       0.000433559274
  error estimate for blocks of size 2^( 6) =       0.000436576506
  error estimate for blocks of size 2^( 7) =       0.000437844408

      target function =                  N/A
              le_mean =     -17.217220708662
             les_mean =     296.761637849928
             stat err =       0.000434599427
             autocorr =       1.148364114950
              std dev =       0.573540829958
             le_variance =       0.328949083629


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721722070866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217220708662       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217220708649       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217220708452       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217220708428       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217220708495       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217220708546       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217220708534       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217220708540       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 5.967658e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217220708662       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217220708659       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217220708609       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217220708604       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217220708621       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217220708626       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217220708635       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217220708617       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.491934e-08

solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217220708662       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217220708661       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217220708649       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217220708647       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217220708653       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217220709230       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217220708442       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -17.217220708657       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 3.729845e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5869e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465039e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540208e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411363e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950501e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168650e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433221e-02 1 1  ON 33
eH1_4                -1.811496e-02 1 1  ON 34
eH1_5                -4.815555e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075273e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342493e-03 1 1  ON 44
eH2_5                 5.548739e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.24454
====================================================
  Execution time = 1.9783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1678e-01
  Total weights = 2.0000e+06
  Execution time = 1.8165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650022664
                                         uncertainty =       0.003475589842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650022664
                                         uncertainty =       0.003475589842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397982338
  error estimate for blocks of size 2^( 2) =       0.000407850850
  error estimate for blocks of size 2^( 3) =       0.000415893560
  error estimate for blocks of size 2^( 4) =       0.000422453145
  error estimate for blocks of size 2^( 5) =       0.000426833623
  error estimate for blocks of size 2^( 6) =       0.000428172637
  error estimate for blocks of size 2^( 7) =       0.000426775027

      target function =                  N/A
              le_mean =     -17.217520979717
             les_mean =     296.759808410965
             stat err =       0.000426058608
             autocorr =       1.146069858517
              std dev =       0.562832019668
             le_variance =       0.316779882363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650036992
                                         uncertainty =       0.003475590078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650036992
                                         uncertainty =       0.003475590078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397982347
  error estimate for blocks of size 2^( 2) =       0.000407850858
  error estimate for blocks of size 2^( 3) =       0.000415893569
  error estimate for blocks of size 2^( 4) =       0.000422453153
  error estimate for blocks of size 2^( 5) =       0.000426833631
  error estimate for blocks of size 2^( 6) =       0.000428172645
  error estimate for blocks of size 2^( 7) =       0.000426775035

      target function =                  N/A
              le_mean =     -17.217520979875
             les_mean =     296.759808430768
             stat err =       0.000426058616
             autocorr =       1.146069850346
              std dev =       0.562832032415
             le_variance =       0.316779896712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650029828
                                         uncertainty =       0.003475589960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650029828
                                         uncertainty =       0.003475589960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397982342
  error estimate for blocks of size 2^( 2) =       0.000407850854
  error estimate for blocks of size 2^( 3) =       0.000415893565
  error estimate for blocks of size 2^( 4) =       0.000422453149
  error estimate for blocks of size 2^( 5) =       0.000426833627
  error estimate for blocks of size 2^( 6) =       0.000428172641
  error estimate for blocks of size 2^( 7) =       0.000426775031

      target function =                  N/A
              le_mean =     -17.217520979796
             les_mean =     296.759808420867
             stat err =       0.000426058612
             autocorr =       1.146069854424
              std dev =       0.562832026041
             le_variance =       0.316779889537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650023560
                                         uncertainty =       0.003475589857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316650023560
                                         uncertainty =       0.003475589857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397982338
  error estimate for blocks of size 2^( 2) =       0.000407850850
  error estimate for blocks of size 2^( 3) =       0.000415893561
  error estimate for blocks of size 2^( 4) =       0.000422453145
  error estimate for blocks of size 2^( 5) =       0.000426833623
  error estimate for blocks of size 2^( 6) =       0.000428172638
  error estimate for blocks of size 2^( 7) =       0.000426775028

      target function =                  N/A
              le_mean =     -17.217520979727
             les_mean =     296.759808412203
             stat err =       0.000426058609
             autocorr =       1.146069858010
              std dev =       0.562832020464
             le_variance =       0.316779883260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217520979717        initial
     9.0949e+03     9.0949e+04             5.9677e-08       -17.217520979875  <--
     3.6380e+04     3.6380e+05             1.4919e-08       -17.217520979796
     1.4552e+05     1.4552e+06             3.7298e-09       -17.217520979727

*****************************************************************************
Applying the update for shift_i =   9.0949e+03     and shift_s =   9.0949e+04
*****************************************************************************

  Execution time = 2.9016e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815561e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1983
    reference variance = 0.547204
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2113e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321155290810
                                         uncertainty =       0.004459034452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321155290810
                                         uncertainty =       0.004459034452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400704702
  error estimate for blocks of size 2^( 2) =       0.000410282509
  error estimate for blocks of size 2^( 3) =       0.000418567285
  error estimate for blocks of size 2^( 4) =       0.000424910598
  error estimate for blocks of size 2^( 5) =       0.000428882470
  error estimate for blocks of size 2^( 6) =       0.000430454398
  error estimate for blocks of size 2^( 7) =       0.000432186143

      target function =                  N/A
              le_mean =     -17.216884731042
             les_mean =     296.742248197861
             stat err =       0.000429108402
             autocorr =       1.146793333111
              std dev =       0.566682024099
             le_variance =       0.321128516437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721688473104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+03, overlap shift 2.2737e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216884731042       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216884730815       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216884730542       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216884731073       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216884731389       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216884731243       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216884731218       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+03 is 1.628924e-07

solving harmonic davidson linear method for identity shift 9.0949e+03, overlap shift 9.0949e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216884731042       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216884730985       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216884730917       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216884731047       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216884731126       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216884731087       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216884731086       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+03 is 4.072439e-08

solving harmonic davidson linear method for identity shift 3.6380e+04, overlap shift 3.6380e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216884731042       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216884731028       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216884731011       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216884731043       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216884731098       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216884731066       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216884731052       residual = 8.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+04 is 1.018118e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5730e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013264e-01 1 1  ON 9
 ud_0                 3.529732e-01 1 1  ON 10
 ud_1                 9.540210e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411367e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229722e-02 1 1  ON 19
 eO_0                -9.136376e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168654e-02 1 1  ON 23
 eO_4                 2.059843e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811493e-02 1 1  ON 34
eH1_5                -4.815556e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899259e-02 1 1  ON 37
eH1_8                 2.643001e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299841e-02 1 1  ON 43
eH2_4                -6.342489e-03 1 1  ON 44
eH2_5                 5.548742e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899822e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.170543
====================================================
  Execution time = 1.9949e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7215e+01
  VMC Evar = 3.2137e-01
  Total weights = 2.0000e+06
  Execution time = 1.8172e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485119200
                                         uncertainty =       0.003767272702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485119200
                                         uncertainty =       0.003767272702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400856625
  error estimate for blocks of size 2^( 2) =       0.000410256539
  error estimate for blocks of size 2^( 3) =       0.000419077268
  error estimate for blocks of size 2^( 4) =       0.000424860057
  error estimate for blocks of size 2^( 5) =       0.000429297089
  error estimate for blocks of size 2^( 6) =       0.000429752779
  error estimate for blocks of size 2^( 7) =       0.000432447632

      target function =                  N/A
              le_mean =     -17.215406005303
             les_mean =     296.691575834152
             stat err =       0.000429089389
             autocorr =       1.145822692039
              std dev =       0.566896875481
             le_variance =       0.321372067430

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485189618
                                         uncertainty =       0.003767273614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485189618
                                         uncertainty =       0.003767273614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400856669
  error estimate for blocks of size 2^( 2) =       0.000410256581
  error estimate for blocks of size 2^( 3) =       0.000419077308
  error estimate for blocks of size 2^( 4) =       0.000424860095
  error estimate for blocks of size 2^( 5) =       0.000429297126
  error estimate for blocks of size 2^( 6) =       0.000429752814
  error estimate for blocks of size 2^( 7) =       0.000432447664

      target function =                  N/A
              le_mean =     -17.215406005105
             les_mean =     296.691575897744
             stat err =       0.000429089425
             autocorr =       1.145822631311
              std dev =       0.566896937580
             le_variance =       0.321372137838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485154411
                                         uncertainty =       0.003767273158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485154411
                                         uncertainty =       0.003767273158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400856647
  error estimate for blocks of size 2^( 2) =       0.000410256560
  error estimate for blocks of size 2^( 3) =       0.000419077288
  error estimate for blocks of size 2^( 4) =       0.000424860076
  error estimate for blocks of size 2^( 5) =       0.000429297107
  error estimate for blocks of size 2^( 6) =       0.000429752796
  error estimate for blocks of size 2^( 7) =       0.000432447648

      target function =                  N/A
              le_mean =     -17.215406005204
             les_mean =     296.691575865949
             stat err =       0.000429089407
             autocorr =       1.145822661672
              std dev =       0.566896906532
             le_variance =       0.321372102635

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485123601
                                         uncertainty =       0.003767272759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321485123601
                                         uncertainty =       0.003767272759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400856628
  error estimate for blocks of size 2^( 2) =       0.000410256541
  error estimate for blocks of size 2^( 3) =       0.000419077270
  error estimate for blocks of size 2^( 4) =       0.000424860059
  error estimate for blocks of size 2^( 5) =       0.000429297091
  error estimate for blocks of size 2^( 6) =       0.000429752781
  error estimate for blocks of size 2^( 7) =       0.000432447634

      target function =                  N/A
              le_mean =     -17.215406005290
             les_mean =     296.691575838126
             stat err =       0.000429089391
             autocorr =       1.145822688246
              std dev =       0.566896879362
             le_variance =       0.321372071830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.215406005303        initial  <--
     2.2737e+03     2.2737e+04             1.6289e-07       -17.215406005105
     9.0949e+03     9.0949e+04             4.0724e-08       -17.215406005204
     3.6380e+04     3.6380e+05             1.0181e-08       -17.215406005290

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1958
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815561e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2852
    reference variance = 0.228271
====================================================
  Execution time = 2.0209e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.2780e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327834099296
                                         uncertainty =       0.008884213981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327834099296
                                         uncertainty =       0.008884213981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404845887
  error estimate for blocks of size 2^( 2) =       0.000413928362
  error estimate for blocks of size 2^( 3) =       0.000421910842
  error estimate for blocks of size 2^( 4) =       0.000428168182
  error estimate for blocks of size 2^( 5) =       0.000432053866
  error estimate for blocks of size 2^( 6) =       0.000435177822
  error estimate for blocks of size 2^( 7) =       0.000435745985

      target function =                  N/A
              le_mean =     -17.217189140142
             les_mean =     296.759402107251
             stat err =       0.000432786464
             autocorr =       1.142793801687
              std dev =       0.572538543453
             le_variance =       0.327800383739


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721718914014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217189140142       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217189140188       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217189140232       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217189140225       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217189140202       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217189140196       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217189140229       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 1.757795e-08

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217189140142       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217189140153       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217189140164       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217189140162       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217189140228       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217189140165       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217189140143       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 4.394505e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217189140142       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217189140145       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217189140147       residual = 8.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217189140147       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217189140521       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217189140152       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217189139955       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 1.098627e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5850e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229722e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815560e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1205
    reference variance = 0.180382
====================================================
  Execution time = 2.0060e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1583e-01
  Total weights = 2.0000e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953316417
                                         uncertainty =       0.003769475268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953316417
                                         uncertainty =       0.003769475268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397387637
  error estimate for blocks of size 2^( 2) =       0.000407149980
  error estimate for blocks of size 2^( 3) =       0.000415866090
  error estimate for blocks of size 2^( 4) =       0.000422069713
  error estimate for blocks of size 2^( 5) =       0.000426835398
  error estimate for blocks of size 2^( 6) =       0.000429293679
  error estimate for blocks of size 2^( 7) =       0.000429828456

      target function =                  N/A
              le_mean =     -17.216570250004
             les_mean =     296.726124882771
             stat err =       0.000427006812
             autocorr =       1.154624858707
              std dev =       0.561990985135
             le_variance =       0.315833867373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953318355
                                         uncertainty =       0.003769475276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953318355
                                         uncertainty =       0.003769475276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397387638
  error estimate for blocks of size 2^( 2) =       0.000407149981
  error estimate for blocks of size 2^( 3) =       0.000415866091
  error estimate for blocks of size 2^( 4) =       0.000422069714
  error estimate for blocks of size 2^( 5) =       0.000426835400
  error estimate for blocks of size 2^( 6) =       0.000429293681
  error estimate for blocks of size 2^( 7) =       0.000429828457

      target function =                  N/A
              le_mean =     -17.216570249994
             les_mean =     296.726124884377
             stat err =       0.000427006813
             autocorr =       1.154624858142
              std dev =       0.561990986859
             le_variance =       0.315833869311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953317386
                                         uncertainty =       0.003769475272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953317386
                                         uncertainty =       0.003769475272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397387637
  error estimate for blocks of size 2^( 2) =       0.000407149980
  error estimate for blocks of size 2^( 3) =       0.000415866090
  error estimate for blocks of size 2^( 4) =       0.000422069714
  error estimate for blocks of size 2^( 5) =       0.000426835399
  error estimate for blocks of size 2^( 6) =       0.000429293680
  error estimate for blocks of size 2^( 7) =       0.000429828457

      target function =                  N/A
              le_mean =     -17.216570249999
             les_mean =     296.726124883574
             stat err =       0.000427006812
             autocorr =       1.154624858423
              std dev =       0.561990985997
             le_variance =       0.315833868342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953316538
                                         uncertainty =       0.003769475268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315953316538
                                         uncertainty =       0.003769475268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397387637
  error estimate for blocks of size 2^( 2) =       0.000407149980
  error estimate for blocks of size 2^( 3) =       0.000415866090
  error estimate for blocks of size 2^( 4) =       0.000422069713
  error estimate for blocks of size 2^( 5) =       0.000426835399
  error estimate for blocks of size 2^( 6) =       0.000429293680
  error estimate for blocks of size 2^( 7) =       0.000429828456

      target function =                  N/A
              le_mean =     -17.216570250003
             les_mean =     296.726124882871
             stat err =       0.000427006812
             autocorr =       1.154624858670
              std dev =       0.561990985243
             le_variance =       0.315833867495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216570250004        initial  <--
     2.2737e+04     2.2737e+05             1.7578e-08       -17.216570249994
     9.0949e+04     9.0949e+05             4.3945e-09       -17.216570249999
     3.6380e+05     3.6380e+06             1.0986e-09       -17.216570250003

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3550
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815561e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1144
    reference variance = 0.383125
====================================================
  Execution time = 2.1979e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1667e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316745587737
                                         uncertainty =       0.003268396256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316745587737
                                         uncertainty =       0.003268396256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397914944
  error estimate for blocks of size 2^( 2) =       0.000406980178
  error estimate for blocks of size 2^( 3) =       0.000415515153
  error estimate for blocks of size 2^( 4) =       0.000421962835
  error estimate for blocks of size 2^( 5) =       0.000427020992
  error estimate for blocks of size 2^( 6) =       0.000429211008
  error estimate for blocks of size 2^( 7) =       0.000429110148

      target function =                  N/A
              le_mean =     -17.216935272224
             les_mean =     296.739532614570
             stat err =       0.000426826246
             autocorr =       1.150593018030
              std dev =       0.562736710167
             le_variance =       0.316672604970


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721693527222e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935272224       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935272224       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216935272223       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216935272257       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216935272115       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216935272178       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216935271907       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 2.225889e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935272224       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935272224       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216935272223       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216935272224       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216935272224       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216935272616       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216935272374       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 5.564724e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.216935272224       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.216935272224       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.216935272224       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.216935272157       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.216935274213       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.216935272057       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.216935270356       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 1.391180e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.221645 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7691e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815561e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2131
    reference variance = 0.283549
====================================================
  Execution time = 1.9901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1930e-01
  Total weights = 2.0000e+06
  Execution time = 1.8192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340335800
                                         uncertainty =       0.003970203857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340335800
                                         uncertainty =       0.003970203857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399562339
  error estimate for blocks of size 2^( 2) =       0.000409136187
  error estimate for blocks of size 2^( 3) =       0.000417719865
  error estimate for blocks of size 2^( 4) =       0.000424746096
  error estimate for blocks of size 2^( 5) =       0.000428806600
  error estimate for blocks of size 2^( 6) =       0.000430661867
  error estimate for blocks of size 2^( 7) =       0.000435600189

      target function =                  N/A
              le_mean =     -17.216928157781
             les_mean =     296.741915156590
             stat err =       0.000429953688
             autocorr =       1.157908556909
              std dev =       0.565066479319
             le_variance =       0.319300126050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340336664
                                         uncertainty =       0.003970203867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340336664
                                         uncertainty =       0.003970203867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399562340
  error estimate for blocks of size 2^( 2) =       0.000409136188
  error estimate for blocks of size 2^( 3) =       0.000417719865
  error estimate for blocks of size 2^( 4) =       0.000424746097
  error estimate for blocks of size 2^( 5) =       0.000428806601
  error estimate for blocks of size 2^( 6) =       0.000430661867
  error estimate for blocks of size 2^( 7) =       0.000435600190

      target function =                  N/A
              le_mean =     -17.216928157791
             les_mean =     296.741915157794
             stat err =       0.000429953689
             autocorr =       1.157908556271
              std dev =       0.565066480084
             le_variance =       0.319300126914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340336232
                                         uncertainty =       0.003970203862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340336232
                                         uncertainty =       0.003970203862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399562340
  error estimate for blocks of size 2^( 2) =       0.000409136187
  error estimate for blocks of size 2^( 3) =       0.000417719865
  error estimate for blocks of size 2^( 4) =       0.000424746097
  error estimate for blocks of size 2^( 5) =       0.000428806601
  error estimate for blocks of size 2^( 6) =       0.000430661867
  error estimate for blocks of size 2^( 7) =       0.000435600190

      target function =                  N/A
              le_mean =     -17.216928157786
             les_mean =     296.741915157192
             stat err =       0.000429953689
             autocorr =       1.157908556590
              std dev =       0.565066479701
             le_variance =       0.319300126482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340335854
                                         uncertainty =       0.003970203857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319340335854
                                         uncertainty =       0.003970203857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399562339
  error estimate for blocks of size 2^( 2) =       0.000409136187
  error estimate for blocks of size 2^( 3) =       0.000417719865
  error estimate for blocks of size 2^( 4) =       0.000424746096
  error estimate for blocks of size 2^( 5) =       0.000428806600
  error estimate for blocks of size 2^( 6) =       0.000430661867
  error estimate for blocks of size 2^( 7) =       0.000435600190

      target function =                  N/A
              le_mean =     -17.216928157782
             les_mean =     296.741915156666
             stat err =       0.000429953688
             autocorr =       1.157908556864
              std dev =       0.565066479367
             le_variance =       0.319300126104


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.216928157781        initial
     2.2737e+05     2.2737e+06             2.2259e-09       -17.216928157791  <--
     9.0949e+05     9.0949e+06             5.5647e-10       -17.216928157786
     3.6380e+06     3.6380e+07             1.3912e-10       -17.216928157782

*****************************************************************************
Applying the update for shift_i =   2.2737e+05     and shift_s =   2.2737e+06
*****************************************************************************

  Execution time = 2.9182e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815561e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6880e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2179
    reference variance = 0.259099
====================================================
  Execution time = 2.0119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7217e+01
  VMC Evar = 3.1271e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7283e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312674570781
                                         uncertainty =       0.004535823347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312674570781
                                         uncertainty =       0.004535823347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395414701
  error estimate for blocks of size 2^( 2) =       0.000405193467
  error estimate for blocks of size 2^( 3) =       0.000413926501
  error estimate for blocks of size 2^( 4) =       0.000419857973
  error estimate for blocks of size 2^( 5) =       0.000423511735
  error estimate for blocks of size 2^( 6) =       0.000425175891
  error estimate for blocks of size 2^( 7) =       0.000426369471

      target function =                  N/A
              le_mean =     -17.217354857257
             les_mean =     296.750013696661
             stat err =       0.000423728768
             autocorr =       1.148339425010
              std dev =       0.559200833589
             le_variance =       0.312705572287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721735485726e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+04, overlap shift 5.6843e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217354857257       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217354857273       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217354857277       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217354857289       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217354857285       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217354857287       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217354857265       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+04 is 9.223592e-09

solving harmonic davidson linear method for identity shift 2.2737e+05, overlap shift 2.2737e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217354857257       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217354857261       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217354857262       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217354857265       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217354856866       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217354857318       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217354857258       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+05 is 2.305904e-09

solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -17.217354857257       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -17.217354857258       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.217354857259       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -17.217354857259       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.217354857497       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -17.217354857185       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -17.217354858056       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 5.764759e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223800 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5859e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229723e-02 1 1  ON 19
 eO_0                -9.136375e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815561e-03 1 1  ON 35
eH1_6                 3.565049e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548740e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.3005
    reference variance = 0.861365
====================================================
  Execution time = 2.0285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7218e+01
  VMC Evar = 3.1785e-01
  Total weights = 2.0000e+06
  Execution time = 1.8105e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658950454
                                         uncertainty =       0.003291153583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658950454
                                         uncertainty =       0.003291153583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398653742
  error estimate for blocks of size 2^( 2) =       0.000408072825
  error estimate for blocks of size 2^( 3) =       0.000416281463
  error estimate for blocks of size 2^( 4) =       0.000422427666
  error estimate for blocks of size 2^( 5) =       0.000426067730
  error estimate for blocks of size 2^( 6) =       0.000428853619
  error estimate for blocks of size 2^( 7) =       0.000429930290

      target function =                  N/A
              le_mean =     -17.217611427475
             les_mean =     296.763992721328
             stat err =       0.000426819826
             autocorr =       1.146297852131
              std dev =       0.563781529266
             le_variance =       0.317849612741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658951723
                                         uncertainty =       0.003291153593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658951723
                                         uncertainty =       0.003291153593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398653743
  error estimate for blocks of size 2^( 2) =       0.000408072826
  error estimate for blocks of size 2^( 3) =       0.000416281464
  error estimate for blocks of size 2^( 4) =       0.000422427666
  error estimate for blocks of size 2^( 5) =       0.000426067731
  error estimate for blocks of size 2^( 6) =       0.000428853620
  error estimate for blocks of size 2^( 7) =       0.000429930291

      target function =                  N/A
              le_mean =     -17.217611427475
             les_mean =     296.763992722609
             stat err =       0.000426819827
             autocorr =       1.146297851423
              std dev =       0.563781530391
             le_variance =       0.317849614009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658951088
                                         uncertainty =       0.003291153588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658951088
                                         uncertainty =       0.003291153588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398653743
  error estimate for blocks of size 2^( 2) =       0.000408072826
  error estimate for blocks of size 2^( 3) =       0.000416281463
  error estimate for blocks of size 2^( 4) =       0.000422427666
  error estimate for blocks of size 2^( 5) =       0.000426067731
  error estimate for blocks of size 2^( 6) =       0.000428853620
  error estimate for blocks of size 2^( 7) =       0.000429930291

      target function =                  N/A
              le_mean =     -17.217611427475
             les_mean =     296.763992721968
             stat err =       0.000426819827
             autocorr =       1.146297851772
              std dev =       0.563781529828
             le_variance =       0.317849613376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658950533
                                         uncertainty =       0.003291153584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317658950533
                                         uncertainty =       0.003291153584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398653743
  error estimate for blocks of size 2^( 2) =       0.000408072825
  error estimate for blocks of size 2^( 3) =       0.000416281463
  error estimate for blocks of size 2^( 4) =       0.000422427666
  error estimate for blocks of size 2^( 5) =       0.000426067730
  error estimate for blocks of size 2^( 6) =       0.000428853619
  error estimate for blocks of size 2^( 7) =       0.000429930290

      target function =                  N/A
              le_mean =     -17.217611427475
             les_mean =     296.763992721408
             stat err =       0.000426819826
             autocorr =       1.146297852086
              std dev =       0.563781529336
             le_variance =       0.317849612821


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -17.217611427475        initial
     5.6843e+04     5.6843e+05             9.2236e-09       -17.217611427475  <--
     2.2737e+05     2.2737e+06             2.3059e-09       -17.217611427475
     9.0949e+05     9.0949e+06             5.7648e-10       -17.217611427475

*****************************************************************************
Applying the update for shift_i =   5.6843e+04     and shift_s =   5.6843e+05
*****************************************************************************

  Execution time = 2.9513e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.911967e-01 1 1  ON 0
 uu_1                 2.952136e-02 1 1  ON 1
 uu_2                -6.465040e-02 1 1  ON 2
 uu_3                -1.204190e-01 1 1  ON 3
 uu_4                -1.562044e-01 1 1  ON 4
 uu_5                -1.681909e-01 1 1  ON 5
 uu_6                -1.563004e-01 1 1  ON 6
 uu_7                -1.093951e-01 1 1  ON 7
 uu_8                -3.891562e-02 1 1  ON 8
 uu_9                 2.013265e-01 1 1  ON 9
 ud_0                 3.529731e-01 1 1  ON 10
 ud_1                 9.540209e-02 1 1  ON 11
 ud_2                -1.296613e-02 1 1  ON 12
 ud_3                -7.411366e-02 1 1  ON 13
 ud_4                -1.245724e-01 1 1  ON 14
 ud_5                -1.629623e-01 1 1  ON 15
 ud_6                -1.779116e-01 1 1  ON 16
 ud_7                -1.588952e-01 1 1  ON 17
 ud_8                -1.113543e-01 1 1  ON 18
 ud_9                 3.229722e-02 1 1  ON 19
 eO_0                -9.136376e-01 1 1  ON 20
 eO_1                -5.950502e-01 1 1  ON 21
 eO_2                -1.857512e-01 1 1  ON 22
 eO_3                 8.168652e-02 1 1  ON 23
 eO_4                 2.059842e-01 1 1  ON 24
 eO_5                 2.973205e-01 1 1  ON 25
 eO_6                 3.259205e-01 1 1  ON 26
 eO_7                 5.328910e-01 1 1  ON 27
 eO_8                 1.580914e-01 1 1  ON 28
 eO_9                 5.331355e-02 1 1  ON 29
eH1_0                -2.218423e-01 1 1  ON 30
eH1_1                -1.430037e-01 1 1  ON 31
eH1_2                -1.019338e-01 1 1  ON 32
eH1_3                -6.433220e-02 1 1  ON 33
eH1_4                -1.811495e-02 1 1  ON 34
eH1_5                -4.815560e-03 1 1  ON 35
eH1_6                 3.565050e-02 1 1  ON 36
eH1_7                 7.899260e-02 1 1  ON 37
eH1_8                 2.643002e-01 1 1  ON 38
eH1_9                 1.135317e-01 1 1  ON 39
eH2_0                -2.106720e-01 1 1  ON 40
eH2_1                -1.318816e-01 1 1  ON 41
eH2_2                -9.075272e-02 1 1  ON 42
eH2_3                -5.299842e-02 1 1  ON 43
eH2_4                -6.342495e-03 1 1  ON 44
eH2_5                 5.548739e-03 1 1  ON 45
eH2_6                 4.766135e-02 1 1  ON 46
eH2_7                 3.899821e-02 1 1  ON 47
eH2_8                 2.479170e-01 1 1  ON 48
eH2_9                 1.153680e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5376e+01 secs
  Total Execution time = 2.2248e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
